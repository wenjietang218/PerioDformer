nohup: ignoring input
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03554582595825195 GB
Epoch: 1 cost time: 2.231712818145752
Epoch: 1, Steps: 52 | Train Loss: 0.9491604 Vali Loss: 2.5829058 Test Loss: 1.8011314
Validation loss decreased (inf --> 2.582906).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 2 cost time: 0.7854251861572266
Epoch: 2, Steps: 52 | Train Loss: 0.8763375 Vali Loss: 2.2185860 Test Loss: 1.4093949
Validation loss decreased (2.582906 --> 2.218586).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 3 cost time: 0.7997453212738037
Epoch: 3, Steps: 52 | Train Loss: 0.7641033 Vali Loss: 1.9892460 Test Loss: 1.1352944
Validation loss decreased (2.218586 --> 1.989246).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 4 cost time: 0.806441068649292
Epoch: 4, Steps: 52 | Train Loss: 0.6890036 Vali Loss: 1.8112849 Test Loss: 0.9299511
Validation loss decreased (1.989246 --> 1.811285).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 5 cost time: 0.7899973392486572
Epoch: 5, Steps: 52 | Train Loss: 0.6314684 Vali Loss: 1.7031760 Test Loss: 0.7902106
Validation loss decreased (1.811285 --> 1.703176).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 6 cost time: 0.794257640838623
Epoch: 6, Steps: 52 | Train Loss: 0.5934751 Vali Loss: 1.6220961 Test Loss: 0.6924710
Validation loss decreased (1.703176 --> 1.622096).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 7 cost time: 0.7783691883087158
Epoch: 7, Steps: 52 | Train Loss: 0.5649852 Vali Loss: 1.5782126 Test Loss: 0.6252472
Validation loss decreased (1.622096 --> 1.578213).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 8 cost time: 0.7833900451660156
Epoch: 8, Steps: 52 | Train Loss: 0.5468448 Vali Loss: 1.5428568 Test Loss: 0.5786679
Validation loss decreased (1.578213 --> 1.542857).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 9 cost time: 0.8041825294494629
Epoch: 9, Steps: 52 | Train Loss: 0.5326271 Vali Loss: 1.5123476 Test Loss: 0.5467187
Validation loss decreased (1.542857 --> 1.512348).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 10 cost time: 0.7969992160797119
Epoch: 10, Steps: 52 | Train Loss: 0.5216299 Vali Loss: 1.4841598 Test Loss: 0.5216100
Validation loss decreased (1.512348 --> 1.484160).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 11 cost time: 0.8096332550048828
Epoch: 11, Steps: 52 | Train Loss: 0.5148399 Vali Loss: 1.4840121 Test Loss: 0.5060148
Validation loss decreased (1.484160 --> 1.484012).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 12 cost time: 0.8049981594085693
Epoch: 12, Steps: 52 | Train Loss: 0.5101036 Vali Loss: 1.4757708 Test Loss: 0.4931859
Validation loss decreased (1.484012 --> 1.475771).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 13 cost time: 0.8220009803771973
Epoch: 13, Steps: 52 | Train Loss: 0.5063267 Vali Loss: 1.4680138 Test Loss: 0.4838918
Validation loss decreased (1.475771 --> 1.468014).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 14 cost time: 0.8119423389434814
Epoch: 14, Steps: 52 | Train Loss: 0.4984279 Vali Loss: 1.4612062 Test Loss: 0.4739868
Validation loss decreased (1.468014 --> 1.461206).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 15 cost time: 0.818427324295044
Epoch: 15, Steps: 52 | Train Loss: 0.4953545 Vali Loss: 1.4502240 Test Loss: 0.4664109
Validation loss decreased (1.461206 --> 1.450224).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 16 cost time: 0.7592151165008545
Epoch: 16, Steps: 52 | Train Loss: 0.4919978 Vali Loss: 1.4526783 Test Loss: 0.4595045
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 17 cost time: 0.7646298408508301
Epoch: 17, Steps: 52 | Train Loss: 0.4894904 Vali Loss: 1.4393423 Test Loss: 0.4548133
Validation loss decreased (1.450224 --> 1.439342).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 18 cost time: 0.7563843727111816
Epoch: 18, Steps: 52 | Train Loss: 0.4875993 Vali Loss: 1.4446172 Test Loss: 0.4530014
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 19 cost time: 0.7509984970092773
Epoch: 19, Steps: 52 | Train Loss: 0.4883825 Vali Loss: 1.4334558 Test Loss: 0.4494391
Validation loss decreased (1.439342 --> 1.433456).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 20 cost time: 0.7536425590515137
Epoch: 20, Steps: 52 | Train Loss: 0.4850326 Vali Loss: 1.4351499 Test Loss: 0.4446440
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 21 cost time: 0.7764520645141602
Epoch: 21, Steps: 52 | Train Loss: 0.4847103 Vali Loss: 1.4332960 Test Loss: 0.4423918
Validation loss decreased (1.433456 --> 1.433296).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 22 cost time: 0.7887568473815918
Epoch: 22, Steps: 52 | Train Loss: 0.4813630 Vali Loss: 1.4298429 Test Loss: 0.4395990
Validation loss decreased (1.433296 --> 1.429843).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 23 cost time: 0.7929999828338623
Epoch: 23, Steps: 52 | Train Loss: 0.4808857 Vali Loss: 1.4237387 Test Loss: 0.4382184
Validation loss decreased (1.429843 --> 1.423739).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 24 cost time: 0.7960002422332764
Epoch: 24, Steps: 52 | Train Loss: 0.4794515 Vali Loss: 1.4306259 Test Loss: 0.4375467
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 25 cost time: 0.8046307563781738
Epoch: 25, Steps: 52 | Train Loss: 0.4785984 Vali Loss: 1.4246649 Test Loss: 0.4355744
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 26 cost time: 0.7699995040893555
Epoch: 26, Steps: 52 | Train Loss: 0.4791190 Vali Loss: 1.4151797 Test Loss: 0.4339291
Validation loss decreased (1.423739 --> 1.415180).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 27 cost time: 0.7296328544616699
Epoch: 27, Steps: 52 | Train Loss: 0.4796956 Vali Loss: 1.4245379 Test Loss: 0.4329945
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 28 cost time: 0.7316532135009766
Epoch: 28, Steps: 52 | Train Loss: 0.4774006 Vali Loss: 1.4217726 Test Loss: 0.4315404
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 29 cost time: 0.7269022464752197
Epoch: 29, Steps: 52 | Train Loss: 0.4766423 Vali Loss: 1.4241333 Test Loss: 0.4302092
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 30 cost time: 0.738210916519165
Epoch: 30, Steps: 52 | Train Loss: 0.4739109 Vali Loss: 1.4164931 Test Loss: 0.4294438
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 31 cost time: 0.7274072170257568
Epoch: 31, Steps: 52 | Train Loss: 0.4750305 Vali Loss: 1.4211749 Test Loss: 0.4288038
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 32 cost time: 0.7507619857788086
Epoch: 32, Steps: 52 | Train Loss: 0.4742418 Vali Loss: 1.4171846 Test Loss: 0.4280766
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 33 cost time: 0.7480025291442871
Epoch: 33, Steps: 52 | Train Loss: 0.4735025 Vali Loss: 1.4217787 Test Loss: 0.4274597
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 34 cost time: 0.7725293636322021
Epoch: 34, Steps: 52 | Train Loss: 0.4732509 Vali Loss: 1.4196050 Test Loss: 0.4272124
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 35 cost time: 0.7201433181762695
Epoch: 35, Steps: 52 | Train Loss: 0.4764864 Vali Loss: 1.4171482 Test Loss: 0.4273452
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 36 cost time: 0.7308309078216553
Epoch: 36, Steps: 52 | Train Loss: 0.4733444 Vali Loss: 1.4170549 Test Loss: 0.4263273
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 37 cost time: 0.7834410667419434
Epoch: 37, Steps: 52 | Train Loss: 0.4731407 Vali Loss: 1.4160769 Test Loss: 0.4263304
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 38 cost time: 0.7533400058746338
Epoch: 38, Steps: 52 | Train Loss: 0.4732428 Vali Loss: 1.4205844 Test Loss: 0.4255552
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 39 cost time: 0.7426180839538574
Epoch: 39, Steps: 52 | Train Loss: 0.4732131 Vali Loss: 1.4154671 Test Loss: 0.4245479
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 40 cost time: 0.7827394008636475
Epoch: 40, Steps: 52 | Train Loss: 0.4721497 Vali Loss: 1.4143569 Test Loss: 0.4238814
Validation loss decreased (1.415180 --> 1.414357).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 41 cost time: 0.7467598915100098
Epoch: 41, Steps: 52 | Train Loss: 0.4724731 Vali Loss: 1.4143562 Test Loss: 0.4233434
Validation loss decreased (1.414357 --> 1.414356).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 42 cost time: 0.7406387329101562
Epoch: 42, Steps: 52 | Train Loss: 0.4739349 Vali Loss: 1.4125257 Test Loss: 0.4232980
Validation loss decreased (1.414356 --> 1.412526).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 43 cost time: 0.7602951526641846
Epoch: 43, Steps: 52 | Train Loss: 0.4744154 Vali Loss: 1.4158788 Test Loss: 0.4233213
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 44 cost time: 0.7698235511779785
Epoch: 44, Steps: 52 | Train Loss: 0.4724339 Vali Loss: 1.4155120 Test Loss: 0.4232181
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 45 cost time: 0.7540016174316406
Epoch: 45, Steps: 52 | Train Loss: 0.4718561 Vali Loss: 1.4181039 Test Loss: 0.4227763
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 46 cost time: 0.7569999694824219
Epoch: 46, Steps: 52 | Train Loss: 0.4725699 Vali Loss: 1.4063101 Test Loss: 0.4234068
Validation loss decreased (1.412526 --> 1.406310).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 47 cost time: 0.7608380317687988
Epoch: 47, Steps: 52 | Train Loss: 0.4729831 Vali Loss: 1.4163100 Test Loss: 0.4232080
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 48 cost time: 0.7470018863677979
Epoch: 48, Steps: 52 | Train Loss: 0.4727794 Vali Loss: 1.4152091 Test Loss: 0.4231588
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 49 cost time: 0.7117166519165039
Epoch: 49, Steps: 52 | Train Loss: 0.4705738 Vali Loss: 1.4145572 Test Loss: 0.4224740
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 50 cost time: 0.7116892337799072
Epoch: 50, Steps: 52 | Train Loss: 0.4723871 Vali Loss: 1.4098115 Test Loss: 0.4231803
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 51 cost time: 0.7168369293212891
Epoch: 51, Steps: 52 | Train Loss: 0.4695236 Vali Loss: 1.4165440 Test Loss: 0.4223413
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 52 cost time: 0.7100000381469727
Epoch: 52, Steps: 52 | Train Loss: 0.4712294 Vali Loss: 1.4144721 Test Loss: 0.4224541
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 53 cost time: 0.7286491394042969
Epoch: 53, Steps: 52 | Train Loss: 0.4729779 Vali Loss: 1.4066174 Test Loss: 0.4219494
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 54 cost time: 0.726647138595581
Epoch: 54, Steps: 52 | Train Loss: 0.4718364 Vali Loss: 1.4156702 Test Loss: 0.4222407
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 55 cost time: 0.7389991283416748
Epoch: 55, Steps: 52 | Train Loss: 0.4710812 Vali Loss: 1.4107244 Test Loss: 0.4214974
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 56 cost time: 0.7266745567321777
Epoch: 56, Steps: 52 | Train Loss: 0.4727728 Vali Loss: 1.4162843 Test Loss: 0.4224079
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 57 cost time: 0.7109999656677246
Epoch: 57, Steps: 52 | Train Loss: 0.4710557 Vali Loss: 1.4155357 Test Loss: 0.4215182
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 58 cost time: 0.7154343128204346
Epoch: 58, Steps: 52 | Train Loss: 0.4735246 Vali Loss: 1.4164610 Test Loss: 0.4233048
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 59 cost time: 0.7480015754699707
Epoch: 59, Steps: 52 | Train Loss: 0.4717926 Vali Loss: 1.4172256 Test Loss: 0.4216922
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 60 cost time: 0.71964430809021
Epoch: 60, Steps: 52 | Train Loss: 0.4714174 Vali Loss: 1.4144384 Test Loss: 0.4209530
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.42340680956840515, mae:0.4537773132324219, rse:0.5330742597579956
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.03624725341796875 GB
Epoch: 1 cost time: 2.145629405975342
Epoch: 1, Steps: 52 | Train Loss: 0.7880067 Vali Loss: 2.2703602 Test Loss: 1.5346450
Validation loss decreased (inf --> 2.270360).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 2 cost time: 0.7570006847381592
Epoch: 2, Steps: 52 | Train Loss: 0.7275223 Vali Loss: 2.0027959 Test Loss: 1.2018619
Validation loss decreased (2.270360 --> 2.002796).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 3 cost time: 0.7556276321411133
Epoch: 3, Steps: 52 | Train Loss: 0.6411800 Vali Loss: 1.8140721 Test Loss: 0.9730118
Validation loss decreased (2.002796 --> 1.814072).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 4 cost time: 0.7677795886993408
Epoch: 4, Steps: 52 | Train Loss: 0.5805891 Vali Loss: 1.6721270 Test Loss: 0.7847652
Validation loss decreased (1.814072 --> 1.672127).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 5 cost time: 0.7743740081787109
Epoch: 5, Steps: 52 | Train Loss: 0.5383076 Vali Loss: 1.5823853 Test Loss: 0.6539690
Validation loss decreased (1.672127 --> 1.582385).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 6 cost time: 0.7644000053405762
Epoch: 6, Steps: 52 | Train Loss: 0.5116141 Vali Loss: 1.5132403 Test Loss: 0.5644006
Validation loss decreased (1.582385 --> 1.513240).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 7 cost time: 0.7436420917510986
Epoch: 7, Steps: 52 | Train Loss: 0.4907069 Vali Loss: 1.4852091 Test Loss: 0.5142026
Validation loss decreased (1.513240 --> 1.485209).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 8 cost time: 0.7306184768676758
Epoch: 8, Steps: 52 | Train Loss: 0.4819364 Vali Loss: 1.4531953 Test Loss: 0.4831894
Validation loss decreased (1.485209 --> 1.453195).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 9 cost time: 0.7475650310516357
Epoch: 9, Steps: 52 | Train Loss: 0.4730927 Vali Loss: 1.4376702 Test Loss: 0.4630512
Validation loss decreased (1.453195 --> 1.437670).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 10 cost time: 0.7354485988616943
Epoch: 10, Steps: 52 | Train Loss: 0.4682736 Vali Loss: 1.4288296 Test Loss: 0.4500653
Validation loss decreased (1.437670 --> 1.428830).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 11 cost time: 0.7359991073608398
Epoch: 11, Steps: 52 | Train Loss: 0.4633378 Vali Loss: 1.4107845 Test Loss: 0.4404107
Validation loss decreased (1.428830 --> 1.410784).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 12 cost time: 0.7715277671813965
Epoch: 12, Steps: 52 | Train Loss: 0.4590454 Vali Loss: 1.4149988 Test Loss: 0.4347476
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 13 cost time: 0.7888474464416504
Epoch: 13, Steps: 52 | Train Loss: 0.4579864 Vali Loss: 1.4093125 Test Loss: 0.4313411
Validation loss decreased (1.410784 --> 1.409312).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 14 cost time: 0.7819998264312744
Epoch: 14, Steps: 52 | Train Loss: 0.4543753 Vali Loss: 1.4046049 Test Loss: 0.4243346
Validation loss decreased (1.409312 --> 1.404605).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 15 cost time: 0.7812495231628418
Epoch: 15, Steps: 52 | Train Loss: 0.4533891 Vali Loss: 1.4057152 Test Loss: 0.4219775
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 16 cost time: 0.7786414623260498
Epoch: 16, Steps: 52 | Train Loss: 0.4528247 Vali Loss: 1.3957020 Test Loss: 0.4182290
Validation loss decreased (1.404605 --> 1.395702).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 17 cost time: 0.7759995460510254
Epoch: 17, Steps: 52 | Train Loss: 0.4499265 Vali Loss: 1.3936541 Test Loss: 0.4162882
Validation loss decreased (1.395702 --> 1.393654).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 18 cost time: 0.7676436901092529
Epoch: 18, Steps: 52 | Train Loss: 0.4501911 Vali Loss: 1.3931468 Test Loss: 0.4139573
Validation loss decreased (1.393654 --> 1.393147).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 19 cost time: 0.7584798336029053
Epoch: 19, Steps: 52 | Train Loss: 0.4462712 Vali Loss: 1.3957458 Test Loss: 0.4122186
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 20 cost time: 0.7698416709899902
Epoch: 20, Steps: 52 | Train Loss: 0.4459738 Vali Loss: 1.3980333 Test Loss: 0.4102272
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 21 cost time: 0.8556458950042725
Epoch: 21, Steps: 52 | Train Loss: 0.4478429 Vali Loss: 1.3861681 Test Loss: 0.4090624
Validation loss decreased (1.393147 --> 1.386168).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 22 cost time: 0.7792468070983887
Epoch: 22, Steps: 52 | Train Loss: 0.4436597 Vali Loss: 1.3927175 Test Loss: 0.4079708
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 23 cost time: 0.8513472080230713
Epoch: 23, Steps: 52 | Train Loss: 0.4458682 Vali Loss: 1.3867149 Test Loss: 0.4065967
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 24 cost time: 0.7803614139556885
Epoch: 24, Steps: 52 | Train Loss: 0.4449332 Vali Loss: 1.3767087 Test Loss: 0.4064057
Validation loss decreased (1.386168 --> 1.376709).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 25 cost time: 0.8006196022033691
Epoch: 25, Steps: 52 | Train Loss: 0.4431009 Vali Loss: 1.3808246 Test Loss: 0.4056543
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 26 cost time: 1.6834871768951416
Epoch: 26, Steps: 52 | Train Loss: 0.4449904 Vali Loss: 1.3882692 Test Loss: 0.4045913
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 27 cost time: 1.733027696609497
Epoch: 27, Steps: 52 | Train Loss: 0.4450499 Vali Loss: 1.3839200 Test Loss: 0.4039175
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 28 cost time: 1.6910157203674316
Epoch: 28, Steps: 52 | Train Loss: 0.4450919 Vali Loss: 1.3877352 Test Loss: 0.4031747
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 29 cost time: 1.7054331302642822
Epoch: 29, Steps: 52 | Train Loss: 0.4452078 Vali Loss: 1.3867489 Test Loss: 0.4026064
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 30 cost time: 1.7075650691986084
Epoch: 30, Steps: 52 | Train Loss: 0.4428805 Vali Loss: 1.3887399 Test Loss: 0.4023009
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 31 cost time: 1.7214303016662598
Epoch: 31, Steps: 52 | Train Loss: 0.4423866 Vali Loss: 1.3776742 Test Loss: 0.4017825
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 32 cost time: 1.7020783424377441
Epoch: 32, Steps: 52 | Train Loss: 0.4414838 Vali Loss: 1.3878760 Test Loss: 0.4010687
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 33 cost time: 1.7118406295776367
Epoch: 33, Steps: 52 | Train Loss: 0.4419285 Vali Loss: 1.3761258 Test Loss: 0.4011626
Validation loss decreased (1.376709 --> 1.376126).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 34 cost time: 1.7114450931549072
Epoch: 34, Steps: 52 | Train Loss: 0.4424357 Vali Loss: 1.3883483 Test Loss: 0.4007208
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 35 cost time: 1.7009737491607666
Epoch: 35, Steps: 52 | Train Loss: 0.4413445 Vali Loss: 1.3763391 Test Loss: 0.4005203
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 36 cost time: 1.7097103595733643
Epoch: 36, Steps: 52 | Train Loss: 0.4418750 Vali Loss: 1.3870531 Test Loss: 0.3994040
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 37 cost time: 1.7111599445343018
Epoch: 37, Steps: 52 | Train Loss: 0.4419741 Vali Loss: 1.3810315 Test Loss: 0.3993236
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 38 cost time: 1.6934027671813965
Epoch: 38, Steps: 52 | Train Loss: 0.4409677 Vali Loss: 1.3787670 Test Loss: 0.3999770
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 39 cost time: 1.7118031978607178
Epoch: 39, Steps: 52 | Train Loss: 0.4419324 Vali Loss: 1.3822801 Test Loss: 0.3994486
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 40 cost time: 1.70701265335083
Epoch: 40, Steps: 52 | Train Loss: 0.4403039 Vali Loss: 1.3787408 Test Loss: 0.3992115
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 41 cost time: 1.7159085273742676
Epoch: 41, Steps: 52 | Train Loss: 0.4407669 Vali Loss: 1.3783267 Test Loss: 0.3987112
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 42 cost time: 1.7076432704925537
Epoch: 42, Steps: 52 | Train Loss: 0.4396967 Vali Loss: 1.3800504 Test Loss: 0.3981702
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 43 cost time: 1.7109057903289795
Epoch: 43, Steps: 52 | Train Loss: 0.4410236 Vali Loss: 1.3872650 Test Loss: 0.3997720
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 44 cost time: 1.7001256942749023
Epoch: 44, Steps: 52 | Train Loss: 0.4411657 Vali Loss: 1.3855594 Test Loss: 0.3987030
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 45 cost time: 1.7145793437957764
Epoch: 45, Steps: 52 | Train Loss: 0.4408861 Vali Loss: 1.3838646 Test Loss: 0.3985024
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 46 cost time: 1.69728422164917
Epoch: 46, Steps: 52 | Train Loss: 0.4415779 Vali Loss: 1.3730202 Test Loss: 0.3982804
Validation loss decreased (1.376126 --> 1.373020).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 47 cost time: 1.7196934223175049
Epoch: 47, Steps: 52 | Train Loss: 0.4428452 Vali Loss: 1.3762008 Test Loss: 0.3982191
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 48 cost time: 1.7040891647338867
Epoch: 48, Steps: 52 | Train Loss: 0.4395869 Vali Loss: 1.3706914 Test Loss: 0.3978698
Validation loss decreased (1.373020 --> 1.370691).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 49 cost time: 1.6945469379425049
Epoch: 49, Steps: 52 | Train Loss: 0.4403558 Vali Loss: 1.3774601 Test Loss: 0.3981085
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 50 cost time: 1.7085492610931396
Epoch: 50, Steps: 52 | Train Loss: 0.4409782 Vali Loss: 1.3860056 Test Loss: 0.3978385
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 51 cost time: 1.707960605621338
Epoch: 51, Steps: 52 | Train Loss: 0.4403891 Vali Loss: 1.3675508 Test Loss: 0.3975622
Validation loss decreased (1.370691 --> 1.367551).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 52 cost time: 1.7072575092315674
Epoch: 52, Steps: 52 | Train Loss: 0.4408313 Vali Loss: 1.3778341 Test Loss: 0.3978355
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 53 cost time: 1.7071847915649414
Epoch: 53, Steps: 52 | Train Loss: 0.4400903 Vali Loss: 1.3850043 Test Loss: 0.3975354
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 54 cost time: 1.6997342109680176
Epoch: 54, Steps: 52 | Train Loss: 0.4406686 Vali Loss: 1.3842121 Test Loss: 0.3975113
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 55 cost time: 1.6982605457305908
Epoch: 55, Steps: 52 | Train Loss: 0.4399480 Vali Loss: 1.3835166 Test Loss: 0.3977990
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 56 cost time: 1.715576410293579
Epoch: 56, Steps: 52 | Train Loss: 0.4404356 Vali Loss: 1.3822989 Test Loss: 0.3986981
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 57 cost time: 1.7103180885314941
Epoch: 57, Steps: 52 | Train Loss: 0.4414769 Vali Loss: 1.3796105 Test Loss: 0.3975140
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 58 cost time: 1.7020061016082764
Epoch: 58, Steps: 52 | Train Loss: 0.4382215 Vali Loss: 1.3807120 Test Loss: 0.3970225
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 59 cost time: 1.7103359699249268
Epoch: 59, Steps: 52 | Train Loss: 0.4398414 Vali Loss: 1.3833470 Test Loss: 0.3968776
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 60 cost time: 1.7131876945495605
Epoch: 60, Steps: 52 | Train Loss: 0.4393388 Vali Loss: 1.3844135 Test Loss: 0.3984995
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3975622355937958, mae:0.432815283536911, rse:0.5165488123893738
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03681135177612305 GB
Epoch: 1 cost time: 2.180858850479126
Epoch: 1, Steps: 52 | Train Loss: 0.7649279 Vali Loss: 2.3608489 Test Loss: 1.5346122
Validation loss decreased (inf --> 2.360849).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 2 cost time: 0.7786524295806885
Epoch: 2, Steps: 52 | Train Loss: 0.7218870 Vali Loss: 2.1281090 Test Loss: 1.2922029
Validation loss decreased (2.360849 --> 2.128109).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 3 cost time: 0.7786374092102051
Epoch: 3, Steps: 52 | Train Loss: 0.6519715 Vali Loss: 1.9245617 Test Loss: 1.0705442
Validation loss decreased (2.128109 --> 1.924562).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 4 cost time: 0.793433666229248
Epoch: 4, Steps: 52 | Train Loss: 0.5882160 Vali Loss: 1.7350268 Test Loss: 0.8289289
Validation loss decreased (1.924562 --> 1.735027).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 5 cost time: 0.8604533672332764
Epoch: 5, Steps: 52 | Train Loss: 0.5325904 Vali Loss: 1.5867147 Test Loss: 0.6434870
Validation loss decreased (1.735027 --> 1.586715).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 6 cost time: 1.7559404373168945
Epoch: 6, Steps: 52 | Train Loss: 0.4997248 Vali Loss: 1.5159383 Test Loss: 0.5386670
Validation loss decreased (1.586715 --> 1.515938).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 7 cost time: 1.761807918548584
Epoch: 7, Steps: 52 | Train Loss: 0.4809165 Vali Loss: 1.4720407 Test Loss: 0.4906924
Validation loss decreased (1.515938 --> 1.472041).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 8 cost time: 1.762744426727295
Epoch: 8, Steps: 52 | Train Loss: 0.4712358 Vali Loss: 1.4579257 Test Loss: 0.4674477
Validation loss decreased (1.472041 --> 1.457926).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 9 cost time: 1.7584507465362549
Epoch: 9, Steps: 52 | Train Loss: 0.4634022 Vali Loss: 1.4412646 Test Loss: 0.4510536
Validation loss decreased (1.457926 --> 1.441265).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 10 cost time: 1.7620301246643066
Epoch: 10, Steps: 52 | Train Loss: 0.4574970 Vali Loss: 1.4255599 Test Loss: 0.4406368
Validation loss decreased (1.441265 --> 1.425560).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 11 cost time: 1.7625815868377686
Epoch: 11, Steps: 52 | Train Loss: 0.4542232 Vali Loss: 1.4215035 Test Loss: 0.4322959
Validation loss decreased (1.425560 --> 1.421504).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 12 cost time: 1.7546100616455078
Epoch: 12, Steps: 52 | Train Loss: 0.4512063 Vali Loss: 1.4207655 Test Loss: 0.4243385
Validation loss decreased (1.421504 --> 1.420766).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 13 cost time: 1.7664923667907715
Epoch: 13, Steps: 52 | Train Loss: 0.4497419 Vali Loss: 1.4108214 Test Loss: 0.4188085
Validation loss decreased (1.420766 --> 1.410821).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 14 cost time: 1.761364221572876
Epoch: 14, Steps: 52 | Train Loss: 0.4486787 Vali Loss: 1.4096153 Test Loss: 0.4145154
Validation loss decreased (1.410821 --> 1.409615).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 15 cost time: 1.7595341205596924
Epoch: 15, Steps: 52 | Train Loss: 0.4456399 Vali Loss: 1.4045789 Test Loss: 0.4123094
Validation loss decreased (1.409615 --> 1.404579).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 16 cost time: 1.7585105895996094
Epoch: 16, Steps: 52 | Train Loss: 0.4440174 Vali Loss: 1.4009500 Test Loss: 0.4078794
Validation loss decreased (1.404579 --> 1.400950).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 17 cost time: 1.76444411277771
Epoch: 17, Steps: 52 | Train Loss: 0.4423954 Vali Loss: 1.4001429 Test Loss: 0.4056193
Validation loss decreased (1.400950 --> 1.400143).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 18 cost time: 1.7768006324768066
Epoch: 18, Steps: 52 | Train Loss: 0.4420846 Vali Loss: 1.4016391 Test Loss: 0.4035389
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 19 cost time: 1.765260934829712
Epoch: 19, Steps: 52 | Train Loss: 0.4400778 Vali Loss: 1.3871152 Test Loss: 0.4009132
Validation loss decreased (1.400143 --> 1.387115).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 20 cost time: 1.7640814781188965
Epoch: 20, Steps: 52 | Train Loss: 0.4390269 Vali Loss: 1.3933399 Test Loss: 0.3995921
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 21 cost time: 1.7644522190093994
Epoch: 21, Steps: 52 | Train Loss: 0.4387952 Vali Loss: 1.3903601 Test Loss: 0.3977142
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 22 cost time: 1.7638053894042969
Epoch: 22, Steps: 52 | Train Loss: 0.4391285 Vali Loss: 1.3814036 Test Loss: 0.3973771
Validation loss decreased (1.387115 --> 1.381404).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 23 cost time: 1.7662925720214844
Epoch: 23, Steps: 52 | Train Loss: 0.4384998 Vali Loss: 1.3881340 Test Loss: 0.3955945
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 24 cost time: 1.7573480606079102
Epoch: 24, Steps: 52 | Train Loss: 0.4370873 Vali Loss: 1.3871756 Test Loss: 0.3948356
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 25 cost time: 1.7663664817810059
Epoch: 25, Steps: 52 | Train Loss: 0.4357386 Vali Loss: 1.3840839 Test Loss: 0.3940018
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 26 cost time: 1.7610504627227783
Epoch: 26, Steps: 52 | Train Loss: 0.4365799 Vali Loss: 1.3806305 Test Loss: 0.3927201
Validation loss decreased (1.381404 --> 1.380630).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 27 cost time: 1.7615880966186523
Epoch: 27, Steps: 52 | Train Loss: 0.4359949 Vali Loss: 1.3871632 Test Loss: 0.3929523
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 28 cost time: 1.7748613357543945
Epoch: 28, Steps: 52 | Train Loss: 0.4347213 Vali Loss: 1.3708243 Test Loss: 0.3913268
Validation loss decreased (1.380630 --> 1.370824).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 29 cost time: 1.7590034008026123
Epoch: 29, Steps: 52 | Train Loss: 0.4352608 Vali Loss: 1.3761876 Test Loss: 0.3920817
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 30 cost time: 1.7591009140014648
Epoch: 30, Steps: 52 | Train Loss: 0.4357018 Vali Loss: 1.3830116 Test Loss: 0.3902650
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 31 cost time: 1.7631752490997314
Epoch: 31, Steps: 52 | Train Loss: 0.4356723 Vali Loss: 1.3854990 Test Loss: 0.3898438
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 32 cost time: 1.750382900238037
Epoch: 32, Steps: 52 | Train Loss: 0.4348862 Vali Loss: 1.3808410 Test Loss: 0.3898535
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 33 cost time: 1.7560734748840332
Epoch: 33, Steps: 52 | Train Loss: 0.4347069 Vali Loss: 1.3757379 Test Loss: 0.3892609
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 34 cost time: 1.7580490112304688
Epoch: 34, Steps: 52 | Train Loss: 0.4334994 Vali Loss: 1.3714385 Test Loss: 0.3888867
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 35 cost time: 1.7571163177490234
Epoch: 35, Steps: 52 | Train Loss: 0.4341064 Vali Loss: 1.3836963 Test Loss: 0.3887662
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 36 cost time: 1.7599380016326904
Epoch: 36, Steps: 52 | Train Loss: 0.4354125 Vali Loss: 1.3813734 Test Loss: 0.3891914
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 37 cost time: 1.75954008102417
Epoch: 37, Steps: 52 | Train Loss: 0.4353659 Vali Loss: 1.3736066 Test Loss: 0.3881683
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 38 cost time: 1.7644202709197998
Epoch: 38, Steps: 52 | Train Loss: 0.4342300 Vali Loss: 1.3831751 Test Loss: 0.3884933
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 39 cost time: 1.760460615158081
Epoch: 39, Steps: 52 | Train Loss: 0.4346039 Vali Loss: 1.3781058 Test Loss: 0.3887458
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 40 cost time: 1.7621233463287354
Epoch: 40, Steps: 52 | Train Loss: 0.4319506 Vali Loss: 1.3787665 Test Loss: 0.3880208
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 41 cost time: 1.7598841190338135
Epoch: 41, Steps: 52 | Train Loss: 0.4343555 Vali Loss: 1.3734077 Test Loss: 0.3877173
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 42 cost time: 1.7595994472503662
Epoch: 42, Steps: 52 | Train Loss: 0.4342413 Vali Loss: 1.3777531 Test Loss: 0.3876240
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 43 cost time: 1.7623958587646484
Epoch: 43, Steps: 52 | Train Loss: 0.4345749 Vali Loss: 1.3739171 Test Loss: 0.3866566
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 44 cost time: 1.753838062286377
Epoch: 44, Steps: 52 | Train Loss: 0.4335109 Vali Loss: 1.3657893 Test Loss: 0.3873271
Validation loss decreased (1.370824 --> 1.365789).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 45 cost time: 1.7642252445220947
Epoch: 45, Steps: 52 | Train Loss: 0.4342266 Vali Loss: 1.3778090 Test Loss: 0.3863894
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 46 cost time: 1.7616403102874756
Epoch: 46, Steps: 52 | Train Loss: 0.4337584 Vali Loss: 1.3723595 Test Loss: 0.3872653
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 47 cost time: 1.762415885925293
Epoch: 47, Steps: 52 | Train Loss: 0.4345860 Vali Loss: 1.3780501 Test Loss: 0.3869376
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 48 cost time: 1.7609994411468506
Epoch: 48, Steps: 52 | Train Loss: 0.4328995 Vali Loss: 1.3740046 Test Loss: 0.3873763
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 49 cost time: 1.7565739154815674
Epoch: 49, Steps: 52 | Train Loss: 0.4347353 Vali Loss: 1.3791366 Test Loss: 0.3876788
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 50 cost time: 1.7664647102355957
Epoch: 50, Steps: 52 | Train Loss: 0.4339977 Vali Loss: 1.3659842 Test Loss: 0.3868859
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 51 cost time: 1.7614648342132568
Epoch: 51, Steps: 52 | Train Loss: 0.4328987 Vali Loss: 1.3706746 Test Loss: 0.3873456
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 52 cost time: 1.7615222930908203
Epoch: 52, Steps: 52 | Train Loss: 0.4331702 Vali Loss: 1.3670759 Test Loss: 0.3876558
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 53 cost time: 1.777522087097168
Epoch: 53, Steps: 52 | Train Loss: 0.4343964 Vali Loss: 1.3736230 Test Loss: 0.3872089
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 54 cost time: 1.7592928409576416
Epoch: 54, Steps: 52 | Train Loss: 0.4334003 Vali Loss: 1.3822451 Test Loss: 0.3877015
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 55 cost time: 1.7590863704681396
Epoch: 55, Steps: 52 | Train Loss: 0.4333567 Vali Loss: 1.3792986 Test Loss: 0.3870877
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 56 cost time: 1.7546870708465576
Epoch: 56, Steps: 52 | Train Loss: 0.4325297 Vali Loss: 1.3790272 Test Loss: 0.3869883
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 57 cost time: 1.7649478912353516
Epoch: 57, Steps: 52 | Train Loss: 0.4328313 Vali Loss: 1.3687457 Test Loss: 0.3866065
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 58 cost time: 1.759227991104126
Epoch: 58, Steps: 52 | Train Loss: 0.4330923 Vali Loss: 1.3750706 Test Loss: 0.3871594
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 59 cost time: 1.7515125274658203
Epoch: 59, Steps: 52 | Train Loss: 0.4326799 Vali Loss: 1.3762832 Test Loss: 0.3865436
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 60 cost time: 1.7551546096801758
Epoch: 60, Steps: 52 | Train Loss: 0.4329253 Vali Loss: 1.3741612 Test Loss: 0.3862590
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3873271644115448, mae:0.42741289734840393, rse:0.5098562836647034
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03570699691772461 GB
Epoch: 1 cost time: 2.1303422451019287
Epoch: 1, Steps: 52 | Train Loss: 0.9112761 Vali Loss: 2.4304757 Test Loss: 1.6965673
Validation loss decreased (inf --> 2.430476).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 2 cost time: 0.7407546043395996
Epoch: 2, Steps: 52 | Train Loss: 0.8398351 Vali Loss: 2.1276879 Test Loss: 1.3340268
Validation loss decreased (2.430476 --> 2.127688).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 3 cost time: 0.7394702434539795
Epoch: 3, Steps: 52 | Train Loss: 0.7384153 Vali Loss: 1.9378386 Test Loss: 1.0881219
Validation loss decreased (2.127688 --> 1.937839).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 4 cost time: 0.739434003829956
Epoch: 4, Steps: 52 | Train Loss: 0.6684832 Vali Loss: 1.7814105 Test Loss: 0.8954898
Validation loss decreased (1.937839 --> 1.781410).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 5 cost time: 0.7503941059112549
Epoch: 5, Steps: 52 | Train Loss: 0.6145020 Vali Loss: 1.6796561 Test Loss: 0.7621442
Validation loss decreased (1.781410 --> 1.679656).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 6 cost time: 1.6384873390197754
Epoch: 6, Steps: 52 | Train Loss: 0.5793794 Vali Loss: 1.6024482 Test Loss: 0.6716934
Validation loss decreased (1.679656 --> 1.602448).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 7 cost time: 1.669421911239624
Epoch: 7, Steps: 52 | Train Loss: 0.5519233 Vali Loss: 1.5576982 Test Loss: 0.6107531
Validation loss decreased (1.602448 --> 1.557698).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 8 cost time: 1.66465163230896
Epoch: 8, Steps: 52 | Train Loss: 0.5352382 Vali Loss: 1.5317849 Test Loss: 0.5679701
Validation loss decreased (1.557698 --> 1.531785).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 9 cost time: 1.6631412506103516
Epoch: 9, Steps: 52 | Train Loss: 0.5221116 Vali Loss: 1.4993207 Test Loss: 0.5390786
Validation loss decreased (1.531785 --> 1.499321).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 10 cost time: 1.6631944179534912
Epoch: 10, Steps: 52 | Train Loss: 0.5113498 Vali Loss: 1.4865669 Test Loss: 0.5166934
Validation loss decreased (1.499321 --> 1.486567).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 11 cost time: 1.6641175746917725
Epoch: 11, Steps: 52 | Train Loss: 0.5049322 Vali Loss: 1.4695283 Test Loss: 0.4990837
Validation loss decreased (1.486567 --> 1.469528).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 12 cost time: 1.6630964279174805
Epoch: 12, Steps: 52 | Train Loss: 0.4980226 Vali Loss: 1.4612385 Test Loss: 0.4867997
Validation loss decreased (1.469528 --> 1.461239).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 13 cost time: 1.661088466644287
Epoch: 13, Steps: 52 | Train Loss: 0.4940063 Vali Loss: 1.4480832 Test Loss: 0.4752102
Validation loss decreased (1.461239 --> 1.448083).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 14 cost time: 1.6568052768707275
Epoch: 14, Steps: 52 | Train Loss: 0.4898313 Vali Loss: 1.4449542 Test Loss: 0.4691585
Validation loss decreased (1.448083 --> 1.444954).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 15 cost time: 1.6617257595062256
Epoch: 15, Steps: 52 | Train Loss: 0.4856193 Vali Loss: 1.4364414 Test Loss: 0.4629295
Validation loss decreased (1.444954 --> 1.436441).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 16 cost time: 1.660379409790039
Epoch: 16, Steps: 52 | Train Loss: 0.4847761 Vali Loss: 1.4359887 Test Loss: 0.4556383
Validation loss decreased (1.436441 --> 1.435989).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 17 cost time: 1.6599977016448975
Epoch: 17, Steps: 52 | Train Loss: 0.4809198 Vali Loss: 1.4281633 Test Loss: 0.4511496
Validation loss decreased (1.435989 --> 1.428163).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 18 cost time: 1.6634941101074219
Epoch: 18, Steps: 52 | Train Loss: 0.4801680 Vali Loss: 1.4290292 Test Loss: 0.4487444
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 19 cost time: 1.662128210067749
Epoch: 19, Steps: 52 | Train Loss: 0.4766050 Vali Loss: 1.4247309 Test Loss: 0.4453804
Validation loss decreased (1.428163 --> 1.424731).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 20 cost time: 1.6707966327667236
Epoch: 20, Steps: 52 | Train Loss: 0.4755044 Vali Loss: 1.4120547 Test Loss: 0.4412932
Validation loss decreased (1.424731 --> 1.412055).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 21 cost time: 1.6608598232269287
Epoch: 21, Steps: 52 | Train Loss: 0.4730325 Vali Loss: 1.4244990 Test Loss: 0.4391342
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 22 cost time: 1.66526460647583
Epoch: 22, Steps: 52 | Train Loss: 0.4747114 Vali Loss: 1.4142510 Test Loss: 0.4365990
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 23 cost time: 1.6655497550964355
Epoch: 23, Steps: 52 | Train Loss: 0.4706435 Vali Loss: 1.4090344 Test Loss: 0.4343599
Validation loss decreased (1.412055 --> 1.409034).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 24 cost time: 1.6655583381652832
Epoch: 24, Steps: 52 | Train Loss: 0.4691719 Vali Loss: 1.4130570 Test Loss: 0.4328721
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 25 cost time: 1.66475248336792
Epoch: 25, Steps: 52 | Train Loss: 0.4714563 Vali Loss: 1.4091308 Test Loss: 0.4305861
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 26 cost time: 1.6574318408966064
Epoch: 26, Steps: 52 | Train Loss: 0.4683058 Vali Loss: 1.4106759 Test Loss: 0.4301577
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 27 cost time: 1.6666135787963867
Epoch: 27, Steps: 52 | Train Loss: 0.4676175 Vali Loss: 1.4115586 Test Loss: 0.4286637
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 28 cost time: 1.6600866317749023
Epoch: 28, Steps: 52 | Train Loss: 0.4685595 Vali Loss: 1.4022626 Test Loss: 0.4258095
Validation loss decreased (1.409034 --> 1.402263).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 29 cost time: 1.6842219829559326
Epoch: 29, Steps: 52 | Train Loss: 0.4665943 Vali Loss: 1.4115893 Test Loss: 0.4260738
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 30 cost time: 1.6811342239379883
Epoch: 30, Steps: 52 | Train Loss: 0.4660242 Vali Loss: 1.4086100 Test Loss: 0.4259544
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 31 cost time: 1.6638174057006836
Epoch: 31, Steps: 52 | Train Loss: 0.4677863 Vali Loss: 1.4122624 Test Loss: 0.4252029
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 32 cost time: 1.6602683067321777
Epoch: 32, Steps: 52 | Train Loss: 0.4660808 Vali Loss: 1.4089557 Test Loss: 0.4235370
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 33 cost time: 1.6675944328308105
Epoch: 33, Steps: 52 | Train Loss: 0.4655974 Vali Loss: 1.3952788 Test Loss: 0.4239826
Validation loss decreased (1.402263 --> 1.395279).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 34 cost time: 1.656618356704712
Epoch: 34, Steps: 52 | Train Loss: 0.4658683 Vali Loss: 1.4061316 Test Loss: 0.4224713
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 35 cost time: 1.6610832214355469
Epoch: 35, Steps: 52 | Train Loss: 0.4647998 Vali Loss: 1.4061331 Test Loss: 0.4215102
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 36 cost time: 1.668722152709961
Epoch: 36, Steps: 52 | Train Loss: 0.4651824 Vali Loss: 1.3999012 Test Loss: 0.4234377
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 37 cost time: 1.660447120666504
Epoch: 37, Steps: 52 | Train Loss: 0.4618182 Vali Loss: 1.4052577 Test Loss: 0.4217134
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 38 cost time: 1.6644976139068604
Epoch: 38, Steps: 52 | Train Loss: 0.4628639 Vali Loss: 1.4076581 Test Loss: 0.4212348
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 39 cost time: 1.6633682250976562
Epoch: 39, Steps: 52 | Train Loss: 0.4639846 Vali Loss: 1.3989005 Test Loss: 0.4215658
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 40 cost time: 1.6625149250030518
Epoch: 40, Steps: 52 | Train Loss: 0.4634563 Vali Loss: 1.4007914 Test Loss: 0.4205675
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 41 cost time: 1.669048547744751
Epoch: 41, Steps: 52 | Train Loss: 0.4654650 Vali Loss: 1.3957303 Test Loss: 0.4191658
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 42 cost time: 1.6634931564331055
Epoch: 42, Steps: 52 | Train Loss: 0.4630721 Vali Loss: 1.3973863 Test Loss: 0.4198091
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 43 cost time: 1.6628139019012451
Epoch: 43, Steps: 52 | Train Loss: 0.4635781 Vali Loss: 1.3974682 Test Loss: 0.4198335
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 44 cost time: 1.6605167388916016
Epoch: 44, Steps: 52 | Train Loss: 0.4604773 Vali Loss: 1.3965952 Test Loss: 0.4187852
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 45 cost time: 1.6573567390441895
Epoch: 45, Steps: 52 | Train Loss: 0.4634155 Vali Loss: 1.4040514 Test Loss: 0.4192913
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 46 cost time: 1.6684911251068115
Epoch: 46, Steps: 52 | Train Loss: 0.4624060 Vali Loss: 1.4029856 Test Loss: 0.4193012
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 47 cost time: 1.6629416942596436
Epoch: 47, Steps: 52 | Train Loss: 0.4616351 Vali Loss: 1.4047151 Test Loss: 0.4179636
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 48 cost time: 1.6682064533233643
Epoch: 48, Steps: 52 | Train Loss: 0.4624371 Vali Loss: 1.3982575 Test Loss: 0.4174922
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 49 cost time: 1.6631901264190674
Epoch: 49, Steps: 52 | Train Loss: 0.4607988 Vali Loss: 1.4059408 Test Loss: 0.4187995
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 50 cost time: 1.6659772396087646
Epoch: 50, Steps: 52 | Train Loss: 0.4620947 Vali Loss: 1.3989316 Test Loss: 0.4195854
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 51 cost time: 1.6660141944885254
Epoch: 51, Steps: 52 | Train Loss: 0.4611982 Vali Loss: 1.3970704 Test Loss: 0.4186167
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 52 cost time: 1.6615185737609863
Epoch: 52, Steps: 52 | Train Loss: 0.4629159 Vali Loss: 1.4035053 Test Loss: 0.4169114
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 53 cost time: 1.6636006832122803
Epoch: 53, Steps: 52 | Train Loss: 0.4616924 Vali Loss: 1.4038469 Test Loss: 0.4180793
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 54 cost time: 1.6683931350708008
Epoch: 54, Steps: 52 | Train Loss: 0.4611297 Vali Loss: 1.3967633 Test Loss: 0.4183080
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 55 cost time: 1.663658857345581
Epoch: 55, Steps: 52 | Train Loss: 0.4612785 Vali Loss: 1.3936307 Test Loss: 0.4173679
Validation loss decreased (1.395279 --> 1.393631).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 56 cost time: 1.6634104251861572
Epoch: 56, Steps: 52 | Train Loss: 0.4614257 Vali Loss: 1.3943696 Test Loss: 0.4169255
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 57 cost time: 1.6665780544281006
Epoch: 57, Steps: 52 | Train Loss: 0.4606565 Vali Loss: 1.3972560 Test Loss: 0.4183782
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 58 cost time: 1.66715669631958
Epoch: 58, Steps: 52 | Train Loss: 0.4622120 Vali Loss: 1.3973094 Test Loss: 0.4183531
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 59 cost time: 1.6625397205352783
Epoch: 59, Steps: 52 | Train Loss: 0.4620160 Vali Loss: 1.3940028 Test Loss: 0.4171141
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 60 cost time: 1.6723711490631104
Epoch: 60, Steps: 52 | Train Loss: 0.4607117 Vali Loss: 1.3950031 Test Loss: 0.4161598
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.4173678457736969, mae:0.44654402136802673, rse:0.5292590856552124
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.036408424377441406 GB
Epoch: 1 cost time: 2.154888391494751
Epoch: 1, Steps: 52 | Train Loss: 0.7479737 Vali Loss: 2.2564344 Test Loss: 1.4139956
Validation loss decreased (inf --> 2.256434).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 2 cost time: 0.7696144580841064
Epoch: 2, Steps: 52 | Train Loss: 0.6958339 Vali Loss: 1.9866765 Test Loss: 1.1193928
Validation loss decreased (2.256434 --> 1.986676).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 3 cost time: 0.7666409015655518
Epoch: 3, Steps: 52 | Train Loss: 0.6102145 Vali Loss: 1.7646105 Test Loss: 0.8594946
Validation loss decreased (1.986676 --> 1.764611).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 4 cost time: 0.763434886932373
Epoch: 4, Steps: 52 | Train Loss: 0.5488275 Vali Loss: 1.6087439 Test Loss: 0.6542718
Validation loss decreased (1.764611 --> 1.608744).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 5 cost time: 0.7672200202941895
Epoch: 5, Steps: 52 | Train Loss: 0.5074703 Vali Loss: 1.5164304 Test Loss: 0.5424672
Validation loss decreased (1.608744 --> 1.516430).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 6 cost time: 1.7305083274841309
Epoch: 6, Steps: 52 | Train Loss: 0.4870068 Vali Loss: 1.4778726 Test Loss: 0.4861291
Validation loss decreased (1.516430 --> 1.477873).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 7 cost time: 1.7271966934204102
Epoch: 7, Steps: 52 | Train Loss: 0.4718894 Vali Loss: 1.4589291 Test Loss: 0.4580076
Validation loss decreased (1.477873 --> 1.458929).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 8 cost time: 1.7424829006195068
Epoch: 8, Steps: 52 | Train Loss: 0.4629797 Vali Loss: 1.4350549 Test Loss: 0.4392300
Validation loss decreased (1.458929 --> 1.435055).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 9 cost time: 1.731105089187622
Epoch: 9, Steps: 52 | Train Loss: 0.4594863 Vali Loss: 1.4311368 Test Loss: 0.4275424
Validation loss decreased (1.435055 --> 1.431137).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 10 cost time: 1.7344048023223877
Epoch: 10, Steps: 52 | Train Loss: 0.4540629 Vali Loss: 1.4183261 Test Loss: 0.4192897
Validation loss decreased (1.431137 --> 1.418326).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 11 cost time: 1.7304563522338867
Epoch: 11, Steps: 52 | Train Loss: 0.4504309 Vali Loss: 1.4144626 Test Loss: 0.4130057
Validation loss decreased (1.418326 --> 1.414463).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 12 cost time: 1.7342336177825928
Epoch: 12, Steps: 52 | Train Loss: 0.4482939 Vali Loss: 1.4036366 Test Loss: 0.4077384
Validation loss decreased (1.414463 --> 1.403637).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 13 cost time: 1.7305071353912354
Epoch: 13, Steps: 52 | Train Loss: 0.4471076 Vali Loss: 1.4059303 Test Loss: 0.4042295
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 14 cost time: 1.728971242904663
Epoch: 14, Steps: 52 | Train Loss: 0.4421724 Vali Loss: 1.3927112 Test Loss: 0.4013285
Validation loss decreased (1.403637 --> 1.392711).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 15 cost time: 1.7301993370056152
Epoch: 15, Steps: 52 | Train Loss: 0.4409197 Vali Loss: 1.4006052 Test Loss: 0.3979673
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 16 cost time: 1.7293975353240967
Epoch: 16, Steps: 52 | Train Loss: 0.4414712 Vali Loss: 1.3952900 Test Loss: 0.3948069
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 17 cost time: 1.728788137435913
Epoch: 17, Steps: 52 | Train Loss: 0.4421537 Vali Loss: 1.3910017 Test Loss: 0.3928621
Validation loss decreased (1.392711 --> 1.391002).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 18 cost time: 1.726438045501709
Epoch: 18, Steps: 52 | Train Loss: 0.4390010 Vali Loss: 1.3871427 Test Loss: 0.3917193
Validation loss decreased (1.391002 --> 1.387143).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 19 cost time: 1.726914405822754
Epoch: 19, Steps: 52 | Train Loss: 0.4398982 Vali Loss: 1.3898783 Test Loss: 0.3898967
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 20 cost time: 1.7314565181732178
Epoch: 20, Steps: 52 | Train Loss: 0.4381960 Vali Loss: 1.3790195 Test Loss: 0.3890169
Validation loss decreased (1.387143 --> 1.379019).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 21 cost time: 1.7412269115447998
Epoch: 21, Steps: 52 | Train Loss: 0.4380853 Vali Loss: 1.3801793 Test Loss: 0.3865970
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 22 cost time: 1.732928991317749
Epoch: 22, Steps: 52 | Train Loss: 0.4384770 Vali Loss: 1.3801715 Test Loss: 0.3869175
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 23 cost time: 1.7343966960906982
Epoch: 23, Steps: 52 | Train Loss: 0.4366498 Vali Loss: 1.3679739 Test Loss: 0.3856341
Validation loss decreased (1.379019 --> 1.367974).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 24 cost time: 1.7306098937988281
Epoch: 24, Steps: 52 | Train Loss: 0.4354248 Vali Loss: 1.3751218 Test Loss: 0.3844206
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 25 cost time: 1.7296535968780518
Epoch: 25, Steps: 52 | Train Loss: 0.4361599 Vali Loss: 1.3795696 Test Loss: 0.3840272
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 26 cost time: 1.725778341293335
Epoch: 26, Steps: 52 | Train Loss: 0.4362498 Vali Loss: 1.3700078 Test Loss: 0.3826326
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 27 cost time: 1.7336390018463135
Epoch: 27, Steps: 52 | Train Loss: 0.4345283 Vali Loss: 1.3754021 Test Loss: 0.3812861
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 28 cost time: 1.7335278987884521
Epoch: 28, Steps: 52 | Train Loss: 0.4350516 Vali Loss: 1.3713318 Test Loss: 0.3816144
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 29 cost time: 1.7270023822784424
Epoch: 29, Steps: 52 | Train Loss: 0.4348454 Vali Loss: 1.3692505 Test Loss: 0.3816589
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 30 cost time: 1.7246918678283691
Epoch: 30, Steps: 52 | Train Loss: 0.4332953 Vali Loss: 1.3760462 Test Loss: 0.3806184
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 31 cost time: 1.7326009273529053
Epoch: 31, Steps: 52 | Train Loss: 0.4339943 Vali Loss: 1.3706478 Test Loss: 0.3801638
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 32 cost time: 1.72957181930542
Epoch: 32, Steps: 52 | Train Loss: 0.4336834 Vali Loss: 1.3732188 Test Loss: 0.3797399
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 33 cost time: 1.7428181171417236
Epoch: 33, Steps: 52 | Train Loss: 0.4352153 Vali Loss: 1.3717883 Test Loss: 0.3793882
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 34 cost time: 1.7314751148223877
Epoch: 34, Steps: 52 | Train Loss: 0.4318553 Vali Loss: 1.3695381 Test Loss: 0.3792706
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 35 cost time: 1.7372546195983887
Epoch: 35, Steps: 52 | Train Loss: 0.4335343 Vali Loss: 1.3714883 Test Loss: 0.3792610
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 36 cost time: 1.7321462631225586
Epoch: 36, Steps: 52 | Train Loss: 0.4336501 Vali Loss: 1.3727826 Test Loss: 0.3797244
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 37 cost time: 1.7366142272949219
Epoch: 37, Steps: 52 | Train Loss: 0.4317091 Vali Loss: 1.3666492 Test Loss: 0.3782772
Validation loss decreased (1.367974 --> 1.366649).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 38 cost time: 1.7304768562316895
Epoch: 38, Steps: 52 | Train Loss: 0.4325474 Vali Loss: 1.3643343 Test Loss: 0.3780612
Validation loss decreased (1.366649 --> 1.364334).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 39 cost time: 1.725595235824585
Epoch: 39, Steps: 52 | Train Loss: 0.4320799 Vali Loss: 1.3709328 Test Loss: 0.3784547
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 40 cost time: 1.7221171855926514
Epoch: 40, Steps: 52 | Train Loss: 0.4348611 Vali Loss: 1.3603748 Test Loss: 0.3778853
Validation loss decreased (1.364334 --> 1.360375).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 41 cost time: 1.730741262435913
Epoch: 41, Steps: 52 | Train Loss: 0.4339516 Vali Loss: 1.3660417 Test Loss: 0.3773521
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 42 cost time: 1.7325348854064941
Epoch: 42, Steps: 52 | Train Loss: 0.4330381 Vali Loss: 1.3593000 Test Loss: 0.3772069
Validation loss decreased (1.360375 --> 1.359300).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 43 cost time: 1.7320268154144287
Epoch: 43, Steps: 52 | Train Loss: 0.4316294 Vali Loss: 1.3674868 Test Loss: 0.3778939
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 44 cost time: 1.7321667671203613
Epoch: 44, Steps: 52 | Train Loss: 0.4315658 Vali Loss: 1.3717866 Test Loss: 0.3783158
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 45 cost time: 1.73356294631958
Epoch: 45, Steps: 52 | Train Loss: 0.4332704 Vali Loss: 1.3738329 Test Loss: 0.3776315
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 46 cost time: 1.7307019233703613
Epoch: 46, Steps: 52 | Train Loss: 0.4325805 Vali Loss: 1.3681474 Test Loss: 0.3772675
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 47 cost time: 1.7303650379180908
Epoch: 47, Steps: 52 | Train Loss: 0.4324774 Vali Loss: 1.3676132 Test Loss: 0.3771056
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 48 cost time: 1.7253527641296387
Epoch: 48, Steps: 52 | Train Loss: 0.4322704 Vali Loss: 1.3684705 Test Loss: 0.3774551
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 49 cost time: 1.7344691753387451
Epoch: 49, Steps: 52 | Train Loss: 0.4326631 Vali Loss: 1.3597959 Test Loss: 0.3774643
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 50 cost time: 1.7352705001831055
Epoch: 50, Steps: 52 | Train Loss: 0.4309159 Vali Loss: 1.3729460 Test Loss: 0.3769416
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 51 cost time: 1.730473279953003
Epoch: 51, Steps: 52 | Train Loss: 0.4342448 Vali Loss: 1.3625648 Test Loss: 0.3767701
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 52 cost time: 1.7389414310455322
Epoch: 52, Steps: 52 | Train Loss: 0.4324856 Vali Loss: 1.3677051 Test Loss: 0.3764893
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 53 cost time: 1.7384974956512451
Epoch: 53, Steps: 52 | Train Loss: 0.4319783 Vali Loss: 1.3724835 Test Loss: 0.3768019
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 54 cost time: 1.7319419384002686
Epoch: 54, Steps: 52 | Train Loss: 0.4334956 Vali Loss: 1.3712664 Test Loss: 0.3768038
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 55 cost time: 1.7269096374511719
Epoch: 55, Steps: 52 | Train Loss: 0.4331188 Vali Loss: 1.3665106 Test Loss: 0.3774654
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 56 cost time: 1.727409839630127
Epoch: 56, Steps: 52 | Train Loss: 0.4319488 Vali Loss: 1.3686261 Test Loss: 0.3775005
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 57 cost time: 1.729337215423584
Epoch: 57, Steps: 52 | Train Loss: 0.4329023 Vali Loss: 1.3712689 Test Loss: 0.3768907
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 58 cost time: 1.7244246006011963
Epoch: 58, Steps: 52 | Train Loss: 0.4337977 Vali Loss: 1.3714759 Test Loss: 0.3764663
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 59 cost time: 1.73689866065979
Epoch: 59, Steps: 52 | Train Loss: 0.4304655 Vali Loss: 1.3731780 Test Loss: 0.3768348
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 60 cost time: 1.7333455085754395
Epoch: 60, Steps: 52 | Train Loss: 0.4328096 Vali Loss: 1.3742068 Test Loss: 0.3765736
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3772069215774536, mae:0.41559115052223206, rse:0.5031512975692749
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.0369725227355957 GB
Epoch: 1 cost time: 2.155482053756714
Epoch: 1, Steps: 52 | Train Loss: 0.7040662 Vali Loss: 2.1655309 Test Loss: 1.4112918
Validation loss decreased (inf --> 2.165531).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 2 cost time: 0.7857701778411865
Epoch: 2, Steps: 52 | Train Loss: 0.6681084 Vali Loss: 1.9785246 Test Loss: 1.1918299
Validation loss decreased (2.165531 --> 1.978525).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 3 cost time: 0.7820000648498535
Epoch: 3, Steps: 52 | Train Loss: 0.6066230 Vali Loss: 1.7826924 Test Loss: 0.9457026
Validation loss decreased (1.978525 --> 1.782692).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 4 cost time: 0.7824263572692871
Epoch: 4, Steps: 52 | Train Loss: 0.5436078 Vali Loss: 1.6033230 Test Loss: 0.6879001
Validation loss decreased (1.782692 --> 1.603323).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 5 cost time: 0.8584742546081543
Epoch: 5, Steps: 52 | Train Loss: 0.4967955 Vali Loss: 1.4969562 Test Loss: 0.5280569
Validation loss decreased (1.603323 --> 1.496956).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 6 cost time: 1.7707204818725586
Epoch: 6, Steps: 52 | Train Loss: 0.4694272 Vali Loss: 1.4488211 Test Loss: 0.4640398
Validation loss decreased (1.496956 --> 1.448821).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 7 cost time: 1.7745938301086426
Epoch: 7, Steps: 52 | Train Loss: 0.4563382 Vali Loss: 1.4206033 Test Loss: 0.4387741
Validation loss decreased (1.448821 --> 1.420603).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 8 cost time: 1.7868168354034424
Epoch: 8, Steps: 52 | Train Loss: 0.4512586 Vali Loss: 1.4106553 Test Loss: 0.4270251
Validation loss decreased (1.420603 --> 1.410655).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 9 cost time: 1.774402379989624
Epoch: 9, Steps: 52 | Train Loss: 0.4470367 Vali Loss: 1.4111614 Test Loss: 0.4175383
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 10 cost time: 1.7679414749145508
Epoch: 10, Steps: 52 | Train Loss: 0.4420590 Vali Loss: 1.4002826 Test Loss: 0.4116962
Validation loss decreased (1.410655 --> 1.400283).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 11 cost time: 1.7750484943389893
Epoch: 11, Steps: 52 | Train Loss: 0.4393897 Vali Loss: 1.3965427 Test Loss: 0.4064481
Validation loss decreased (1.400283 --> 1.396543).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 12 cost time: 1.769423007965088
Epoch: 12, Steps: 52 | Train Loss: 0.4377851 Vali Loss: 1.3945353 Test Loss: 0.4020182
Validation loss decreased (1.396543 --> 1.394535).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 13 cost time: 1.772636890411377
Epoch: 13, Steps: 52 | Train Loss: 0.4360381 Vali Loss: 1.3752025 Test Loss: 0.3989463
Validation loss decreased (1.394535 --> 1.375203).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 14 cost time: 1.777541160583496
Epoch: 14, Steps: 52 | Train Loss: 0.4343848 Vali Loss: 1.3846390 Test Loss: 0.3971823
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 15 cost time: 1.7759006023406982
Epoch: 15, Steps: 52 | Train Loss: 0.4326139 Vali Loss: 1.3741434 Test Loss: 0.3944790
Validation loss decreased (1.375203 --> 1.374143).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 16 cost time: 1.7653801441192627
Epoch: 16, Steps: 52 | Train Loss: 0.4326327 Vali Loss: 1.3777521 Test Loss: 0.3924209
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 17 cost time: 1.7706019878387451
Epoch: 17, Steps: 52 | Train Loss: 0.4324907 Vali Loss: 1.3713636 Test Loss: 0.3900104
Validation loss decreased (1.374143 --> 1.371364).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 18 cost time: 1.772106647491455
Epoch: 18, Steps: 52 | Train Loss: 0.4314242 Vali Loss: 1.3724959 Test Loss: 0.3893582
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 19 cost time: 1.7736458778381348
Epoch: 19, Steps: 52 | Train Loss: 0.4295529 Vali Loss: 1.3724098 Test Loss: 0.3881338
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 20 cost time: 1.7792863845825195
Epoch: 20, Steps: 52 | Train Loss: 0.4296979 Vali Loss: 1.3689413 Test Loss: 0.3873602
Validation loss decreased (1.371364 --> 1.368941).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 21 cost time: 1.7718992233276367
Epoch: 21, Steps: 52 | Train Loss: 0.4293367 Vali Loss: 1.3708594 Test Loss: 0.3856615
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 22 cost time: 1.7757940292358398
Epoch: 22, Steps: 52 | Train Loss: 0.4283896 Vali Loss: 1.3674231 Test Loss: 0.3854809
Validation loss decreased (1.368941 --> 1.367423).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 23 cost time: 1.7745068073272705
Epoch: 23, Steps: 52 | Train Loss: 0.4287908 Vali Loss: 1.3635026 Test Loss: 0.3843640
Validation loss decreased (1.367423 --> 1.363503).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 24 cost time: 1.7765586376190186
Epoch: 24, Steps: 52 | Train Loss: 0.4284646 Vali Loss: 1.3543992 Test Loss: 0.3837086
Validation loss decreased (1.363503 --> 1.354399).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 25 cost time: 1.7696051597595215
Epoch: 25, Steps: 52 | Train Loss: 0.4260773 Vali Loss: 1.3570396 Test Loss: 0.3831335
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 26 cost time: 1.766124963760376
Epoch: 26, Steps: 52 | Train Loss: 0.4262663 Vali Loss: 1.3556521 Test Loss: 0.3819724
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 27 cost time: 1.7679336071014404
Epoch: 27, Steps: 52 | Train Loss: 0.4276860 Vali Loss: 1.3589201 Test Loss: 0.3820934
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 28 cost time: 1.765263557434082
Epoch: 28, Steps: 52 | Train Loss: 0.4278208 Vali Loss: 1.3658298 Test Loss: 0.3811070
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 29 cost time: 1.7694718837738037
Epoch: 29, Steps: 52 | Train Loss: 0.4267253 Vali Loss: 1.3581271 Test Loss: 0.3812115
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 30 cost time: 1.7615935802459717
Epoch: 30, Steps: 52 | Train Loss: 0.4260996 Vali Loss: 1.3432782 Test Loss: 0.3812563
Validation loss decreased (1.354399 --> 1.343278).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 31 cost time: 1.7681241035461426
Epoch: 31, Steps: 52 | Train Loss: 0.4257853 Vali Loss: 1.3527231 Test Loss: 0.3801264
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 32 cost time: 1.7666118144989014
Epoch: 32, Steps: 52 | Train Loss: 0.4261473 Vali Loss: 1.3634305 Test Loss: 0.3805333
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 33 cost time: 1.7756836414337158
Epoch: 33, Steps: 52 | Train Loss: 0.4250920 Vali Loss: 1.3604182 Test Loss: 0.3805945
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 34 cost time: 1.7679038047790527
Epoch: 34, Steps: 52 | Train Loss: 0.4271236 Vali Loss: 1.3623916 Test Loss: 0.3805083
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 35 cost time: 1.7770745754241943
Epoch: 35, Steps: 52 | Train Loss: 0.4262515 Vali Loss: 1.3615974 Test Loss: 0.3804063
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 36 cost time: 1.7684547901153564
Epoch: 36, Steps: 52 | Train Loss: 0.4261368 Vali Loss: 1.3561388 Test Loss: 0.3792424
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 37 cost time: 1.774451494216919
Epoch: 37, Steps: 52 | Train Loss: 0.4255280 Vali Loss: 1.3598835 Test Loss: 0.3797362
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 38 cost time: 1.7725765705108643
Epoch: 38, Steps: 52 | Train Loss: 0.4257821 Vali Loss: 1.3554659 Test Loss: 0.3794426
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 39 cost time: 1.7761991024017334
Epoch: 39, Steps: 52 | Train Loss: 0.4248595 Vali Loss: 1.3601300 Test Loss: 0.3791473
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 40 cost time: 1.7649874687194824
Epoch: 40, Steps: 52 | Train Loss: 0.4252715 Vali Loss: 1.3659165 Test Loss: 0.3796507
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 41 cost time: 1.7744789123535156
Epoch: 41, Steps: 52 | Train Loss: 0.4251932 Vali Loss: 1.3554271 Test Loss: 0.3787065
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 42 cost time: 1.7679641246795654
Epoch: 42, Steps: 52 | Train Loss: 0.4266281 Vali Loss: 1.3582339 Test Loss: 0.3789386
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 43 cost time: 1.7889893054962158
Epoch: 43, Steps: 52 | Train Loss: 0.4255256 Vali Loss: 1.3640822 Test Loss: 0.3793093
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 44 cost time: 1.7680258750915527
Epoch: 44, Steps: 52 | Train Loss: 0.4256844 Vali Loss: 1.3557451 Test Loss: 0.3784886
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 45 cost time: 1.776449203491211
Epoch: 45, Steps: 52 | Train Loss: 0.4246682 Vali Loss: 1.3572820 Test Loss: 0.3789735
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 46 cost time: 1.7775864601135254
Epoch: 46, Steps: 52 | Train Loss: 0.4232269 Vali Loss: 1.3559015 Test Loss: 0.3788733
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 47 cost time: 1.771841049194336
Epoch: 47, Steps: 52 | Train Loss: 0.4249390 Vali Loss: 1.3587844 Test Loss: 0.3785603
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 48 cost time: 1.7724859714508057
Epoch: 48, Steps: 52 | Train Loss: 0.4258754 Vali Loss: 1.3622091 Test Loss: 0.3790808
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 49 cost time: 1.7711222171783447
Epoch: 49, Steps: 52 | Train Loss: 0.4252537 Vali Loss: 1.3495290 Test Loss: 0.3788697
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 50 cost time: 1.7735013961791992
Epoch: 50, Steps: 52 | Train Loss: 0.4258061 Vali Loss: 1.3554778 Test Loss: 0.3793061
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 51 cost time: 1.7687928676605225
Epoch: 51, Steps: 52 | Train Loss: 0.4242519 Vali Loss: 1.3551630 Test Loss: 0.3782989
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 52 cost time: 1.7804951667785645
Epoch: 52, Steps: 52 | Train Loss: 0.4247550 Vali Loss: 1.3525727 Test Loss: 0.3783251
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 53 cost time: 1.7758588790893555
Epoch: 53, Steps: 52 | Train Loss: 0.4247162 Vali Loss: 1.3494015 Test Loss: 0.3783183
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 54 cost time: 1.7670414447784424
Epoch: 54, Steps: 52 | Train Loss: 0.4259009 Vali Loss: 1.3545191 Test Loss: 0.3783868
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 55 cost time: 1.7677035331726074
Epoch: 55, Steps: 52 | Train Loss: 0.4249590 Vali Loss: 1.3587146 Test Loss: 0.3785077
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 56 cost time: 1.7745702266693115
Epoch: 56, Steps: 52 | Train Loss: 0.4253374 Vali Loss: 1.3506684 Test Loss: 0.3781709
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 57 cost time: 1.771216630935669
Epoch: 57, Steps: 52 | Train Loss: 0.4255586 Vali Loss: 1.3495574 Test Loss: 0.3787162
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 58 cost time: 1.7684757709503174
Epoch: 58, Steps: 52 | Train Loss: 0.4251196 Vali Loss: 1.3572636 Test Loss: 0.3784077
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 59 cost time: 1.7764413356781006
Epoch: 59, Steps: 52 | Train Loss: 0.4232732 Vali Loss: 1.3551153 Test Loss: 0.3785864
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 60 cost time: 1.779616117477417
Epoch: 60, Steps: 52 | Train Loss: 0.4254548 Vali Loss: 1.3550482 Test Loss: 0.3788764
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.38125625252723694, mae:0.4205717146396637, rse:0.50584477186203
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.035868167877197266 GB
Epoch: 1 cost time: 2.15200138092041
Epoch: 1, Steps: 52 | Train Loss: 0.9228513 Vali Loss: 2.4554386 Test Loss: 1.6429838
Validation loss decreased (inf --> 2.455439).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 2 cost time: 0.7872662544250488
Epoch: 2, Steps: 52 | Train Loss: 0.8380714 Vali Loss: 2.0577226 Test Loss: 1.1761324
Validation loss decreased (2.455439 --> 2.057723).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 3 cost time: 0.7490687370300293
Epoch: 3, Steps: 52 | Train Loss: 0.7030008 Vali Loss: 1.7996926 Test Loss: 0.8601947
Validation loss decreased (2.057723 --> 1.799693).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 4 cost time: 0.7464385032653809
Epoch: 4, Steps: 52 | Train Loss: 0.6156125 Vali Loss: 1.6249318 Test Loss: 0.6584487
Validation loss decreased (1.799693 --> 1.624932).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 5 cost time: 0.7437350749969482
Epoch: 5, Steps: 52 | Train Loss: 0.5645373 Vali Loss: 1.5501393 Test Loss: 0.5572028
Validation loss decreased (1.624932 --> 1.550139).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 6 cost time: 1.6648194789886475
Epoch: 6, Steps: 52 | Train Loss: 0.5341962 Vali Loss: 1.4952037 Test Loss: 0.5050559
Validation loss decreased (1.550139 --> 1.495204).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 7 cost time: 1.6792998313903809
Epoch: 7, Steps: 52 | Train Loss: 0.5145844 Vali Loss: 1.4719398 Test Loss: 0.4715008
Validation loss decreased (1.495204 --> 1.471940).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 8 cost time: 1.6704931259155273
Epoch: 8, Steps: 52 | Train Loss: 0.5049948 Vali Loss: 1.4531875 Test Loss: 0.4514719
Validation loss decreased (1.471940 --> 1.453187).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 9 cost time: 1.6765635013580322
Epoch: 9, Steps: 52 | Train Loss: 0.4969760 Vali Loss: 1.4366847 Test Loss: 0.4382942
Validation loss decreased (1.453187 --> 1.436685).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 10 cost time: 1.6754767894744873
Epoch: 10, Steps: 52 | Train Loss: 0.4895027 Vali Loss: 1.4303595 Test Loss: 0.4275491
Validation loss decreased (1.436685 --> 1.430359).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 11 cost time: 1.6710951328277588
Epoch: 11, Steps: 52 | Train Loss: 0.4861515 Vali Loss: 1.4206754 Test Loss: 0.4192896
Validation loss decreased (1.430359 --> 1.420675).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 12 cost time: 1.674138069152832
Epoch: 12, Steps: 52 | Train Loss: 0.4800419 Vali Loss: 1.4157627 Test Loss: 0.4151583
Validation loss decreased (1.420675 --> 1.415763).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 13 cost time: 1.684140682220459
Epoch: 13, Steps: 52 | Train Loss: 0.4784493 Vali Loss: 1.4130459 Test Loss: 0.4104053
Validation loss decreased (1.415763 --> 1.413046).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 14 cost time: 1.6770155429840088
Epoch: 14, Steps: 52 | Train Loss: 0.4752262 Vali Loss: 1.4141552 Test Loss: 0.4067383
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 15 cost time: 1.677008867263794
Epoch: 15, Steps: 52 | Train Loss: 0.4723239 Vali Loss: 1.4104562 Test Loss: 0.4037785
Validation loss decreased (1.413046 --> 1.410456).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 16 cost time: 1.6817266941070557
Epoch: 16, Steps: 52 | Train Loss: 0.4693296 Vali Loss: 1.4078673 Test Loss: 0.4012931
Validation loss decreased (1.410456 --> 1.407867).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 17 cost time: 1.6855318546295166
Epoch: 17, Steps: 52 | Train Loss: 0.4682622 Vali Loss: 1.3979782 Test Loss: 0.3991837
Validation loss decreased (1.407867 --> 1.397978).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 18 cost time: 1.6717982292175293
Epoch: 18, Steps: 52 | Train Loss: 0.4681879 Vali Loss: 1.3997689 Test Loss: 0.3978990
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 19 cost time: 1.673755407333374
Epoch: 19, Steps: 52 | Train Loss: 0.4664975 Vali Loss: 1.3975976 Test Loss: 0.3968019
Validation loss decreased (1.397978 --> 1.397598).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 20 cost time: 1.667858600616455
Epoch: 20, Steps: 52 | Train Loss: 0.4656480 Vali Loss: 1.3822383 Test Loss: 0.3936773
Validation loss decreased (1.397598 --> 1.382238).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 21 cost time: 1.6694591045379639
Epoch: 21, Steps: 52 | Train Loss: 0.4658684 Vali Loss: 1.3931937 Test Loss: 0.3938919
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 22 cost time: 1.6797022819519043
Epoch: 22, Steps: 52 | Train Loss: 0.4661724 Vali Loss: 1.3937149 Test Loss: 0.3922128
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 23 cost time: 1.6811764240264893
Epoch: 23, Steps: 52 | Train Loss: 0.4642744 Vali Loss: 1.3910308 Test Loss: 0.3925950
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 24 cost time: 1.6745901107788086
Epoch: 24, Steps: 52 | Train Loss: 0.4646417 Vali Loss: 1.3948317 Test Loss: 0.3908056
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 25 cost time: 1.6829156875610352
Epoch: 25, Steps: 52 | Train Loss: 0.4616911 Vali Loss: 1.3937870 Test Loss: 0.3895535
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 26 cost time: 1.6792957782745361
Epoch: 26, Steps: 52 | Train Loss: 0.4629649 Vali Loss: 1.3891032 Test Loss: 0.3891793
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 27 cost time: 1.681488037109375
Epoch: 27, Steps: 52 | Train Loss: 0.4602598 Vali Loss: 1.3919398 Test Loss: 0.3881989
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 28 cost time: 1.6663734912872314
Epoch: 28, Steps: 52 | Train Loss: 0.4626956 Vali Loss: 1.3866647 Test Loss: 0.3872782
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 29 cost time: 1.6786539554595947
Epoch: 29, Steps: 52 | Train Loss: 0.4600284 Vali Loss: 1.3901483 Test Loss: 0.3871316
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 30 cost time: 1.6775026321411133
Epoch: 30, Steps: 52 | Train Loss: 0.4600029 Vali Loss: 1.3799657 Test Loss: 0.3871106
Validation loss decreased (1.382238 --> 1.379966).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 31 cost time: 1.6743581295013428
Epoch: 31, Steps: 52 | Train Loss: 0.4592465 Vali Loss: 1.3877641 Test Loss: 0.3861288
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 32 cost time: 1.677626371383667
Epoch: 32, Steps: 52 | Train Loss: 0.4588698 Vali Loss: 1.3902404 Test Loss: 0.3861263
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 33 cost time: 1.6736781597137451
Epoch: 33, Steps: 52 | Train Loss: 0.4597197 Vali Loss: 1.3821533 Test Loss: 0.3866927
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 34 cost time: 1.6676843166351318
Epoch: 34, Steps: 52 | Train Loss: 0.4590722 Vali Loss: 1.3845165 Test Loss: 0.3853121
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 35 cost time: 1.68208909034729
Epoch: 35, Steps: 52 | Train Loss: 0.4575554 Vali Loss: 1.3872797 Test Loss: 0.3864356
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 36 cost time: 1.6725132465362549
Epoch: 36, Steps: 52 | Train Loss: 0.4578516 Vali Loss: 1.3868397 Test Loss: 0.3854094
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 37 cost time: 1.6731560230255127
Epoch: 37, Steps: 52 | Train Loss: 0.4602913 Vali Loss: 1.3835067 Test Loss: 0.3852597
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 38 cost time: 1.6642427444458008
Epoch: 38, Steps: 52 | Train Loss: 0.4575834 Vali Loss: 1.3805425 Test Loss: 0.3853443
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 39 cost time: 1.6751751899719238
Epoch: 39, Steps: 52 | Train Loss: 0.4601819 Vali Loss: 1.3868200 Test Loss: 0.3859090
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 40 cost time: 1.6740012168884277
Epoch: 40, Steps: 52 | Train Loss: 0.4575844 Vali Loss: 1.3801985 Test Loss: 0.3847937
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 41 cost time: 1.6716246604919434
Epoch: 41, Steps: 52 | Train Loss: 0.4585251 Vali Loss: 1.3796241 Test Loss: 0.3843165
Validation loss decreased (1.379966 --> 1.379624).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 42 cost time: 1.6785516738891602
Epoch: 42, Steps: 52 | Train Loss: 0.4576275 Vali Loss: 1.3837261 Test Loss: 0.3843866
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 43 cost time: 1.6768591403961182
Epoch: 43, Steps: 52 | Train Loss: 0.4596468 Vali Loss: 1.3877010 Test Loss: 0.3844970
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 44 cost time: 1.673398494720459
Epoch: 44, Steps: 52 | Train Loss: 0.4569042 Vali Loss: 1.3799701 Test Loss: 0.3850502
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 45 cost time: 1.6736748218536377
Epoch: 45, Steps: 52 | Train Loss: 0.4582483 Vali Loss: 1.3773685 Test Loss: 0.3837935
Validation loss decreased (1.379624 --> 1.377368).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 46 cost time: 1.688352346420288
Epoch: 46, Steps: 52 | Train Loss: 0.4566722 Vali Loss: 1.3812306 Test Loss: 0.3839758
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 47 cost time: 1.6744215488433838
Epoch: 47, Steps: 52 | Train Loss: 0.4568236 Vali Loss: 1.3784214 Test Loss: 0.3841631
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 48 cost time: 1.6678709983825684
Epoch: 48, Steps: 52 | Train Loss: 0.4562782 Vali Loss: 1.3824781 Test Loss: 0.3842999
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 49 cost time: 1.6704485416412354
Epoch: 49, Steps: 52 | Train Loss: 0.4586212 Vali Loss: 1.3788214 Test Loss: 0.3850513
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 50 cost time: 1.6744532585144043
Epoch: 50, Steps: 52 | Train Loss: 0.4575734 Vali Loss: 1.3822351 Test Loss: 0.3834723
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 51 cost time: 1.6694750785827637
Epoch: 51, Steps: 52 | Train Loss: 0.4555535 Vali Loss: 1.3862917 Test Loss: 0.3833623
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 52 cost time: 1.6800172328948975
Epoch: 52, Steps: 52 | Train Loss: 0.4552281 Vali Loss: 1.3838302 Test Loss: 0.3838497
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 53 cost time: 1.6735339164733887
Epoch: 53, Steps: 52 | Train Loss: 0.4571529 Vali Loss: 1.3784341 Test Loss: 0.3836529
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 54 cost time: 1.679487943649292
Epoch: 54, Steps: 52 | Train Loss: 0.4569631 Vali Loss: 1.3778733 Test Loss: 0.3838241
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 55 cost time: 1.6679778099060059
Epoch: 55, Steps: 52 | Train Loss: 0.4573200 Vali Loss: 1.3860674 Test Loss: 0.3833061
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 56 cost time: 1.6814076900482178
Epoch: 56, Steps: 52 | Train Loss: 0.4567848 Vali Loss: 1.3826501 Test Loss: 0.3837611
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 57 cost time: 1.6678552627563477
Epoch: 57, Steps: 52 | Train Loss: 0.4549931 Vali Loss: 1.3847005 Test Loss: 0.3834281
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 58 cost time: 1.672529697418213
Epoch: 58, Steps: 52 | Train Loss: 0.4582276 Vali Loss: 1.3777597 Test Loss: 0.3839867
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 59 cost time: 1.6726889610290527
Epoch: 59, Steps: 52 | Train Loss: 0.4572851 Vali Loss: 1.3743073 Test Loss: 0.3832176
Validation loss decreased (1.377368 --> 1.374307).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 60 cost time: 1.6734492778778076
Epoch: 60, Steps: 52 | Train Loss: 0.4562116 Vali Loss: 1.3822933 Test Loss: 0.3840591
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.38321760296821594, mae:0.42008963227272034, rse:0.5071442723274231
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03656959533691406 GB
Epoch: 1 cost time: 2.1631946563720703
Epoch: 1, Steps: 52 | Train Loss: 0.7152201 Vali Loss: 2.1653433 Test Loss: 1.3685858
Validation loss decreased (inf --> 2.165343).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 2 cost time: 0.7873759269714355
Epoch: 2, Steps: 52 | Train Loss: 0.6598494 Vali Loss: 1.8616148 Test Loss: 1.0150249
Validation loss decreased (2.165343 --> 1.861615).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 3 cost time: 0.7974257469177246
Epoch: 3, Steps: 52 | Train Loss: 0.5657121 Vali Loss: 1.6185818 Test Loss: 0.6964360
Validation loss decreased (1.861615 --> 1.618582).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 4 cost time: 0.7730677127838135
Epoch: 4, Steps: 52 | Train Loss: 0.4982291 Vali Loss: 1.4775968 Test Loss: 0.5148639
Validation loss decreased (1.618582 --> 1.477597).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 5 cost time: 0.796412467956543
Epoch: 5, Steps: 52 | Train Loss: 0.4714700 Vali Loss: 1.4301792 Test Loss: 0.4581842
Validation loss decreased (1.477597 --> 1.430179).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 6 cost time: 1.7462668418884277
Epoch: 6, Steps: 52 | Train Loss: 0.4601795 Vali Loss: 1.4238129 Test Loss: 0.4331519
Validation loss decreased (1.430179 --> 1.423813).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 7 cost time: 1.741492748260498
Epoch: 7, Steps: 52 | Train Loss: 0.4539784 Vali Loss: 1.4122138 Test Loss: 0.4218462
Validation loss decreased (1.423813 --> 1.412214).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 8 cost time: 1.7454485893249512
Epoch: 8, Steps: 52 | Train Loss: 0.4480989 Vali Loss: 1.4083074 Test Loss: 0.4118031
Validation loss decreased (1.412214 --> 1.408307).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 9 cost time: 1.7261888980865479
Epoch: 9, Steps: 52 | Train Loss: 0.4448541 Vali Loss: 1.3990107 Test Loss: 0.4054592
Validation loss decreased (1.408307 --> 1.399011).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 10 cost time: 1.7457334995269775
Epoch: 10, Steps: 52 | Train Loss: 0.4422283 Vali Loss: 1.3863381 Test Loss: 0.3990998
Validation loss decreased (1.399011 --> 1.386338).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 11 cost time: 1.7381978034973145
Epoch: 11, Steps: 52 | Train Loss: 0.4400880 Vali Loss: 1.3916273 Test Loss: 0.3935192
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 12 cost time: 1.7437012195587158
Epoch: 12, Steps: 52 | Train Loss: 0.4366260 Vali Loss: 1.3829689 Test Loss: 0.3906150
Validation loss decreased (1.386338 --> 1.382969).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 13 cost time: 1.7385013103485107
Epoch: 13, Steps: 52 | Train Loss: 0.4367751 Vali Loss: 1.3786700 Test Loss: 0.3860532
Validation loss decreased (1.382969 --> 1.378670).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 14 cost time: 1.7404162883758545
Epoch: 14, Steps: 52 | Train Loss: 0.4342985 Vali Loss: 1.3776009 Test Loss: 0.3836092
Validation loss decreased (1.378670 --> 1.377601).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 15 cost time: 1.7303433418273926
Epoch: 15, Steps: 52 | Train Loss: 0.4315179 Vali Loss: 1.3724499 Test Loss: 0.3825221
Validation loss decreased (1.377601 --> 1.372450).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 16 cost time: 1.736060380935669
Epoch: 16, Steps: 52 | Train Loss: 0.4319580 Vali Loss: 1.3728206 Test Loss: 0.3793656
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 17 cost time: 1.7458593845367432
Epoch: 17, Steps: 52 | Train Loss: 0.4312694 Vali Loss: 1.3660886 Test Loss: 0.3786932
Validation loss decreased (1.372450 --> 1.366089).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 18 cost time: 1.73771071434021
Epoch: 18, Steps: 52 | Train Loss: 0.4307504 Vali Loss: 1.3638486 Test Loss: 0.3767934
Validation loss decreased (1.366089 --> 1.363849).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 19 cost time: 1.7410366535186768
Epoch: 19, Steps: 52 | Train Loss: 0.4296561 Vali Loss: 1.3683151 Test Loss: 0.3745589
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 20 cost time: 1.736457347869873
Epoch: 20, Steps: 52 | Train Loss: 0.4300460 Vali Loss: 1.3681390 Test Loss: 0.3744270
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 21 cost time: 1.7420167922973633
Epoch: 21, Steps: 52 | Train Loss: 0.4296639 Vali Loss: 1.3633448 Test Loss: 0.3738626
Validation loss decreased (1.363849 --> 1.363345).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 22 cost time: 1.7326602935791016
Epoch: 22, Steps: 52 | Train Loss: 0.4307862 Vali Loss: 1.3683901 Test Loss: 0.3726817
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 23 cost time: 1.7407763004302979
Epoch: 23, Steps: 52 | Train Loss: 0.4277980 Vali Loss: 1.3672841 Test Loss: 0.3716024
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 24 cost time: 1.734750747680664
Epoch: 24, Steps: 52 | Train Loss: 0.4276552 Vali Loss: 1.3617487 Test Loss: 0.3709516
Validation loss decreased (1.363345 --> 1.361749).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 25 cost time: 1.7304785251617432
Epoch: 25, Steps: 52 | Train Loss: 0.4263204 Vali Loss: 1.3644364 Test Loss: 0.3701260
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 26 cost time: 1.7322816848754883
Epoch: 26, Steps: 52 | Train Loss: 0.4262384 Vali Loss: 1.3662072 Test Loss: 0.3700043
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 27 cost time: 1.750009298324585
Epoch: 27, Steps: 52 | Train Loss: 0.4283869 Vali Loss: 1.3533751 Test Loss: 0.3690292
Validation loss decreased (1.361749 --> 1.353375).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 28 cost time: 1.7311348915100098
Epoch: 28, Steps: 52 | Train Loss: 0.4259354 Vali Loss: 1.3516084 Test Loss: 0.3691990
Validation loss decreased (1.353375 --> 1.351608).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 29 cost time: 1.747068166732788
Epoch: 29, Steps: 52 | Train Loss: 0.4253602 Vali Loss: 1.3629199 Test Loss: 0.3693148
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 30 cost time: 1.7270052433013916
Epoch: 30, Steps: 52 | Train Loss: 0.4261669 Vali Loss: 1.3556678 Test Loss: 0.3686343
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 31 cost time: 1.733231782913208
Epoch: 31, Steps: 52 | Train Loss: 0.4257414 Vali Loss: 1.3602216 Test Loss: 0.3678608
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 32 cost time: 1.7288711071014404
Epoch: 32, Steps: 52 | Train Loss: 0.4264406 Vali Loss: 1.3570811 Test Loss: 0.3674203
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 33 cost time: 1.7370617389678955
Epoch: 33, Steps: 52 | Train Loss: 0.4257694 Vali Loss: 1.3567249 Test Loss: 0.3672035
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 34 cost time: 1.7441227436065674
Epoch: 34, Steps: 52 | Train Loss: 0.4246997 Vali Loss: 1.3613735 Test Loss: 0.3674220
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 35 cost time: 1.7394545078277588
Epoch: 35, Steps: 52 | Train Loss: 0.4257390 Vali Loss: 1.3516796 Test Loss: 0.3670511
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 36 cost time: 1.7377820014953613
Epoch: 36, Steps: 52 | Train Loss: 0.4264514 Vali Loss: 1.3516009 Test Loss: 0.3669929
Validation loss decreased (1.351608 --> 1.351601).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 37 cost time: 1.7334911823272705
Epoch: 37, Steps: 52 | Train Loss: 0.4269109 Vali Loss: 1.3522264 Test Loss: 0.3665093
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 38 cost time: 1.7390358448028564
Epoch: 38, Steps: 52 | Train Loss: 0.4254877 Vali Loss: 1.3563905 Test Loss: 0.3660702
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 39 cost time: 1.737480878829956
Epoch: 39, Steps: 52 | Train Loss: 0.4245419 Vali Loss: 1.3534197 Test Loss: 0.3659641
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 40 cost time: 1.7434048652648926
Epoch: 40, Steps: 52 | Train Loss: 0.4251714 Vali Loss: 1.3515155 Test Loss: 0.3660820
Validation loss decreased (1.351601 --> 1.351516).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 41 cost time: 1.7371370792388916
Epoch: 41, Steps: 52 | Train Loss: 0.4261304 Vali Loss: 1.3547337 Test Loss: 0.3660439
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 42 cost time: 1.736929178237915
Epoch: 42, Steps: 52 | Train Loss: 0.4259740 Vali Loss: 1.3524485 Test Loss: 0.3660829
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 43 cost time: 1.7306571006774902
Epoch: 43, Steps: 52 | Train Loss: 0.4257122 Vali Loss: 1.3487110 Test Loss: 0.3659444
Validation loss decreased (1.351516 --> 1.348711).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 44 cost time: 1.747549295425415
Epoch: 44, Steps: 52 | Train Loss: 0.4250428 Vali Loss: 1.3508275 Test Loss: 0.3657032
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 45 cost time: 1.732602596282959
Epoch: 45, Steps: 52 | Train Loss: 0.4261086 Vali Loss: 1.3550255 Test Loss: 0.3657659
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 46 cost time: 1.7386341094970703
Epoch: 46, Steps: 52 | Train Loss: 0.4255884 Vali Loss: 1.3525202 Test Loss: 0.3661987
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 47 cost time: 1.7292757034301758
Epoch: 47, Steps: 52 | Train Loss: 0.4240769 Vali Loss: 1.3536713 Test Loss: 0.3652628
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 48 cost time: 1.7340788841247559
Epoch: 48, Steps: 52 | Train Loss: 0.4252476 Vali Loss: 1.3552485 Test Loss: 0.3653699
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 49 cost time: 1.7396152019500732
Epoch: 49, Steps: 52 | Train Loss: 0.4245332 Vali Loss: 1.3599273 Test Loss: 0.3658352
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 50 cost time: 1.7390882968902588
Epoch: 50, Steps: 52 | Train Loss: 0.4246487 Vali Loss: 1.3594716 Test Loss: 0.3657687
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 51 cost time: 1.7376577854156494
Epoch: 51, Steps: 52 | Train Loss: 0.4253836 Vali Loss: 1.3540510 Test Loss: 0.3649932
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 52 cost time: 1.731442928314209
Epoch: 52, Steps: 52 | Train Loss: 0.4240420 Vali Loss: 1.3496847 Test Loss: 0.3655649
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 53 cost time: 1.7420620918273926
Epoch: 53, Steps: 52 | Train Loss: 0.4231657 Vali Loss: 1.3547425 Test Loss: 0.3655151
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 54 cost time: 1.7404003143310547
Epoch: 54, Steps: 52 | Train Loss: 0.4240758 Vali Loss: 1.3468658 Test Loss: 0.3658567
Validation loss decreased (1.348711 --> 1.346866).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 55 cost time: 1.7332983016967773
Epoch: 55, Steps: 52 | Train Loss: 0.4238557 Vali Loss: 1.3563513 Test Loss: 0.3658049
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 56 cost time: 1.7333569526672363
Epoch: 56, Steps: 52 | Train Loss: 0.4263131 Vali Loss: 1.3444349 Test Loss: 0.3653856
Validation loss decreased (1.346866 --> 1.344435).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 57 cost time: 1.7380561828613281
Epoch: 57, Steps: 52 | Train Loss: 0.4236794 Vali Loss: 1.3513851 Test Loss: 0.3650280
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 58 cost time: 1.736267328262329
Epoch: 58, Steps: 52 | Train Loss: 0.4252358 Vali Loss: 1.3516263 Test Loss: 0.3655089
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 59 cost time: 1.7407374382019043
Epoch: 59, Steps: 52 | Train Loss: 0.4254152 Vali Loss: 1.3563207 Test Loss: 0.3657606
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 60 cost time: 1.7304744720458984
Epoch: 60, Steps: 52 | Train Loss: 0.4259314 Vali Loss: 1.3485289 Test Loss: 0.3652949
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3653855621814728, mae:0.40623846650123596, rse:0.4952043890953064
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03713369369506836 GB
Epoch: 1 cost time: 2.21049165725708
Epoch: 1, Steps: 52 | Train Loss: 0.7039666 Vali Loss: 2.1914937 Test Loss: 1.4125614
Validation loss decreased (inf --> 2.191494).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 2 cost time: 0.8110113143920898
Epoch: 2, Steps: 52 | Train Loss: 0.6759107 Vali Loss: 2.0195749 Test Loss: 1.2323694
Validation loss decreased (2.191494 --> 2.019575).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 3 cost time: 0.8078715801239014
Epoch: 3, Steps: 52 | Train Loss: 0.6255936 Vali Loss: 1.8606124 Test Loss: 1.0380837
Validation loss decreased (2.019575 --> 1.860612).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 4 cost time: 0.806999683380127
Epoch: 4, Steps: 52 | Train Loss: 0.5671094 Vali Loss: 1.6637381 Test Loss: 0.7835073
Validation loss decreased (1.860612 --> 1.663738).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 5 cost time: 1.0508754253387451
Epoch: 5, Steps: 52 | Train Loss: 0.5083150 Vali Loss: 1.5128919 Test Loss: 0.5718770
Validation loss decreased (1.663738 --> 1.512892).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 6 cost time: 1.787193775177002
Epoch: 6, Steps: 52 | Train Loss: 0.4711862 Vali Loss: 1.4355272 Test Loss: 0.4647502
Validation loss decreased (1.512892 --> 1.435527).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 7 cost time: 1.7957680225372314
Epoch: 7, Steps: 52 | Train Loss: 0.4526990 Vali Loss: 1.4057282 Test Loss: 0.4298999
Validation loss decreased (1.435527 --> 1.405728).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 8 cost time: 1.7955694198608398
Epoch: 8, Steps: 52 | Train Loss: 0.4451532 Vali Loss: 1.4056283 Test Loss: 0.4140375
Validation loss decreased (1.405728 --> 1.405628).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 9 cost time: 1.7855286598205566
Epoch: 9, Steps: 52 | Train Loss: 0.4416283 Vali Loss: 1.3987079 Test Loss: 0.4063164
Validation loss decreased (1.405628 --> 1.398708).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 10 cost time: 1.7834751605987549
Epoch: 10, Steps: 52 | Train Loss: 0.4387221 Vali Loss: 1.3849862 Test Loss: 0.3975510
Validation loss decreased (1.398708 --> 1.384986).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 11 cost time: 1.788879632949829
Epoch: 11, Steps: 52 | Train Loss: 0.4364797 Vali Loss: 1.3816702 Test Loss: 0.3915233
Validation loss decreased (1.384986 --> 1.381670).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 12 cost time: 1.7942464351654053
Epoch: 12, Steps: 52 | Train Loss: 0.4342946 Vali Loss: 1.3799849 Test Loss: 0.3872631
Validation loss decreased (1.381670 --> 1.379985).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 13 cost time: 1.7914509773254395
Epoch: 13, Steps: 52 | Train Loss: 0.4319797 Vali Loss: 1.3737619 Test Loss: 0.3843268
Validation loss decreased (1.379985 --> 1.373762).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 14 cost time: 1.7934894561767578
Epoch: 14, Steps: 52 | Train Loss: 0.4328030 Vali Loss: 1.3688767 Test Loss: 0.3812895
Validation loss decreased (1.373762 --> 1.368877).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 15 cost time: 1.7813780307769775
Epoch: 15, Steps: 52 | Train Loss: 0.4287780 Vali Loss: 1.3651156 Test Loss: 0.3783380
Validation loss decreased (1.368877 --> 1.365116).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 16 cost time: 1.7944958209991455
Epoch: 16, Steps: 52 | Train Loss: 0.4274103 Vali Loss: 1.3592088 Test Loss: 0.3757905
Validation loss decreased (1.365116 --> 1.359209).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 17 cost time: 1.7823314666748047
Epoch: 17, Steps: 52 | Train Loss: 0.4287503 Vali Loss: 1.3507164 Test Loss: 0.3744663
Validation loss decreased (1.359209 --> 1.350716).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 18 cost time: 1.7962255477905273
Epoch: 18, Steps: 52 | Train Loss: 0.4270986 Vali Loss: 1.3523954 Test Loss: 0.3733547
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 19 cost time: 1.794506311416626
Epoch: 19, Steps: 52 | Train Loss: 0.4261281 Vali Loss: 1.3539028 Test Loss: 0.3711560
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 20 cost time: 1.7908413410186768
Epoch: 20, Steps: 52 | Train Loss: 0.4260472 Vali Loss: 1.3591394 Test Loss: 0.3700928
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 21 cost time: 1.7862238883972168
Epoch: 21, Steps: 52 | Train Loss: 0.4252659 Vali Loss: 1.3496721 Test Loss: 0.3692278
Validation loss decreased (1.350716 --> 1.349672).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 22 cost time: 1.7950687408447266
Epoch: 22, Steps: 52 | Train Loss: 0.4259520 Vali Loss: 1.3538613 Test Loss: 0.3688231
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 23 cost time: 1.7888736724853516
Epoch: 23, Steps: 52 | Train Loss: 0.4254327 Vali Loss: 1.3542082 Test Loss: 0.3675307
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 24 cost time: 1.788994312286377
Epoch: 24, Steps: 52 | Train Loss: 0.4242296 Vali Loss: 1.3559705 Test Loss: 0.3670491
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 25 cost time: 1.7928121089935303
Epoch: 25, Steps: 52 | Train Loss: 0.4236168 Vali Loss: 1.3423541 Test Loss: 0.3669113
Validation loss decreased (1.349672 --> 1.342354).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 26 cost time: 1.789057731628418
Epoch: 26, Steps: 52 | Train Loss: 0.4258000 Vali Loss: 1.3372724 Test Loss: 0.3660771
Validation loss decreased (1.342354 --> 1.337272).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 27 cost time: 1.7905046939849854
Epoch: 27, Steps: 52 | Train Loss: 0.4240233 Vali Loss: 1.3532131 Test Loss: 0.3661933
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 28 cost time: 1.792377233505249
Epoch: 28, Steps: 52 | Train Loss: 0.4240751 Vali Loss: 1.3507049 Test Loss: 0.3655843
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 29 cost time: 1.7930243015289307
Epoch: 29, Steps: 52 | Train Loss: 0.4222718 Vali Loss: 1.3535397 Test Loss: 0.3653212
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 30 cost time: 1.7934069633483887
Epoch: 30, Steps: 52 | Train Loss: 0.4224040 Vali Loss: 1.3477334 Test Loss: 0.3642845
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 31 cost time: 1.7926101684570312
Epoch: 31, Steps: 52 | Train Loss: 0.4203934 Vali Loss: 1.3399398 Test Loss: 0.3644747
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 32 cost time: 1.7893197536468506
Epoch: 32, Steps: 52 | Train Loss: 0.4232577 Vali Loss: 1.3515244 Test Loss: 0.3646295
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 33 cost time: 1.789114236831665
Epoch: 33, Steps: 52 | Train Loss: 0.4236372 Vali Loss: 1.3446549 Test Loss: 0.3633409
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 34 cost time: 1.793339490890503
Epoch: 34, Steps: 52 | Train Loss: 0.4229769 Vali Loss: 1.3436532 Test Loss: 0.3646021
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 35 cost time: 1.7892858982086182
Epoch: 35, Steps: 52 | Train Loss: 0.4227434 Vali Loss: 1.3419533 Test Loss: 0.3637103
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 36 cost time: 1.8026278018951416
Epoch: 36, Steps: 52 | Train Loss: 0.4209903 Vali Loss: 1.3415852 Test Loss: 0.3640562
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 37 cost time: 1.7947235107421875
Epoch: 37, Steps: 52 | Train Loss: 0.4228469 Vali Loss: 1.3500538 Test Loss: 0.3631520
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 38 cost time: 1.8020656108856201
Epoch: 38, Steps: 52 | Train Loss: 0.4213426 Vali Loss: 1.3486549 Test Loss: 0.3636546
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 39 cost time: 1.7884466648101807
Epoch: 39, Steps: 52 | Train Loss: 0.4219490 Vali Loss: 1.3413793 Test Loss: 0.3633194
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 40 cost time: 1.7919652462005615
Epoch: 40, Steps: 52 | Train Loss: 0.4229533 Vali Loss: 1.3459964 Test Loss: 0.3630936
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 41 cost time: 1.7977828979492188
Epoch: 41, Steps: 52 | Train Loss: 0.4210514 Vali Loss: 1.3487552 Test Loss: 0.3632353
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 42 cost time: 1.7831857204437256
Epoch: 42, Steps: 52 | Train Loss: 0.4216612 Vali Loss: 1.3423920 Test Loss: 0.3631565
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 43 cost time: 1.7924652099609375
Epoch: 43, Steps: 52 | Train Loss: 0.4206375 Vali Loss: 1.3460317 Test Loss: 0.3633333
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 44 cost time: 1.7924165725708008
Epoch: 44, Steps: 52 | Train Loss: 0.4212352 Vali Loss: 1.3406570 Test Loss: 0.3626080
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 45 cost time: 1.7938849925994873
Epoch: 45, Steps: 52 | Train Loss: 0.4204916 Vali Loss: 1.3391631 Test Loss: 0.3626395
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 46 cost time: 1.7831261157989502
Epoch: 46, Steps: 52 | Train Loss: 0.4225178 Vali Loss: 1.3403267 Test Loss: 0.3629997
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 47 cost time: 1.787109375
Epoch: 47, Steps: 52 | Train Loss: 0.4215287 Vali Loss: 1.3333826 Test Loss: 0.3622215
Validation loss decreased (1.337272 --> 1.333383).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 48 cost time: 1.800992488861084
Epoch: 48, Steps: 52 | Train Loss: 0.4213692 Vali Loss: 1.3479089 Test Loss: 0.3628470
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 49 cost time: 1.7940404415130615
Epoch: 49, Steps: 52 | Train Loss: 0.4206535 Vali Loss: 1.3479347 Test Loss: 0.3629908
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 50 cost time: 1.785937786102295
Epoch: 50, Steps: 52 | Train Loss: 0.4217780 Vali Loss: 1.3410959 Test Loss: 0.3620001
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 51 cost time: 1.7973432540893555
Epoch: 51, Steps: 52 | Train Loss: 0.4216049 Vali Loss: 1.3402710 Test Loss: 0.3630732
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 52 cost time: 1.7911367416381836
Epoch: 52, Steps: 52 | Train Loss: 0.4223825 Vali Loss: 1.3464319 Test Loss: 0.3620156
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 53 cost time: 1.7874467372894287
Epoch: 53, Steps: 52 | Train Loss: 0.4223161 Vali Loss: 1.3454924 Test Loss: 0.3626426
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 54 cost time: 1.7789149284362793
Epoch: 54, Steps: 52 | Train Loss: 0.4226384 Vali Loss: 1.3432171 Test Loss: 0.3622891
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 55 cost time: 1.7834360599517822
Epoch: 55, Steps: 52 | Train Loss: 0.4218130 Vali Loss: 1.3392252 Test Loss: 0.3625952
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 56 cost time: 1.7921998500823975
Epoch: 56, Steps: 52 | Train Loss: 0.4213614 Vali Loss: 1.3451610 Test Loss: 0.3621255
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 57 cost time: 1.7874982357025146
Epoch: 57, Steps: 52 | Train Loss: 0.4204100 Vali Loss: 1.3487694 Test Loss: 0.3620537
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 58 cost time: 1.7911698818206787
Epoch: 58, Steps: 52 | Train Loss: 0.4210342 Vali Loss: 1.3435971 Test Loss: 0.3625893
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 59 cost time: 1.7765791416168213
Epoch: 59, Steps: 52 | Train Loss: 0.4231361 Vali Loss: 1.3434198 Test Loss: 0.3625671
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 60 cost time: 1.7885761260986328
Epoch: 60, Steps: 52 | Train Loss: 0.4214257 Vali Loss: 1.3401725 Test Loss: 0.3620820
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3622215688228607, mae:0.4052017033100128, rse:0.49305564165115356
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03602886199951172 GB
Epoch: 1 cost time: 2.1490159034729004
Epoch: 1, Steps: 52 | Train Loss: 0.9135898 Vali Loss: 2.4828081 Test Loss: 1.6559070
Validation loss decreased (inf --> 2.482808).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 2 cost time: 0.7746164798736572
Epoch: 2, Steps: 52 | Train Loss: 0.8315795 Vali Loss: 2.0990357 Test Loss: 1.2230791
Validation loss decreased (2.482808 --> 2.099036).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 3 cost time: 0.7673859596252441
Epoch: 3, Steps: 52 | Train Loss: 0.7067350 Vali Loss: 1.8252025 Test Loss: 0.9103913
Validation loss decreased (2.099036 --> 1.825202).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 4 cost time: 0.7597787380218506
Epoch: 4, Steps: 52 | Train Loss: 0.6202532 Vali Loss: 1.6619680 Test Loss: 0.7099766
Validation loss decreased (1.825202 --> 1.661968).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 5 cost time: 0.7650015354156494
Epoch: 5, Steps: 52 | Train Loss: 0.5680101 Vali Loss: 1.5784199 Test Loss: 0.6077939
Validation loss decreased (1.661968 --> 1.578420).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 6 cost time: 1.7030205726623535
Epoch: 6, Steps: 52 | Train Loss: 0.5402499 Vali Loss: 1.5204761 Test Loss: 0.5458558
Validation loss decreased (1.578420 --> 1.520476).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 7 cost time: 1.702385425567627
Epoch: 7, Steps: 52 | Train Loss: 0.5190072 Vali Loss: 1.4955287 Test Loss: 0.5061988
Validation loss decreased (1.520476 --> 1.495529).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 8 cost time: 1.7093799114227295
Epoch: 8, Steps: 52 | Train Loss: 0.5038119 Vali Loss: 1.4692862 Test Loss: 0.4811116
Validation loss decreased (1.495529 --> 1.469286).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 9 cost time: 1.7044036388397217
Epoch: 9, Steps: 52 | Train Loss: 0.4958497 Vali Loss: 1.4574293 Test Loss: 0.4625759
Validation loss decreased (1.469286 --> 1.457429).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 10 cost time: 1.7042694091796875
Epoch: 10, Steps: 52 | Train Loss: 0.4882768 Vali Loss: 1.4500272 Test Loss: 0.4503176
Validation loss decreased (1.457429 --> 1.450027).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 11 cost time: 1.7030870914459229
Epoch: 11, Steps: 52 | Train Loss: 0.4841600 Vali Loss: 1.4338727 Test Loss: 0.4381529
Validation loss decreased (1.450027 --> 1.433873).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 12 cost time: 1.6958420276641846
Epoch: 12, Steps: 52 | Train Loss: 0.4805387 Vali Loss: 1.4313821 Test Loss: 0.4326680
Validation loss decreased (1.433873 --> 1.431382).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 13 cost time: 1.7048556804656982
Epoch: 13, Steps: 52 | Train Loss: 0.4774566 Vali Loss: 1.4191308 Test Loss: 0.4252327
Validation loss decreased (1.431382 --> 1.419131).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 14 cost time: 1.7014997005462646
Epoch: 14, Steps: 52 | Train Loss: 0.4731504 Vali Loss: 1.4214865 Test Loss: 0.4200344
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 15 cost time: 1.7054557800292969
Epoch: 15, Steps: 52 | Train Loss: 0.4708474 Vali Loss: 1.4159895 Test Loss: 0.4150717
Validation loss decreased (1.419131 --> 1.415990).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 16 cost time: 1.6886212825775146
Epoch: 16, Steps: 52 | Train Loss: 0.4689455 Vali Loss: 1.4127516 Test Loss: 0.4096989
Validation loss decreased (1.415990 --> 1.412752).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 17 cost time: 1.7052719593048096
Epoch: 17, Steps: 52 | Train Loss: 0.4683389 Vali Loss: 1.4017086 Test Loss: 0.4084066
Validation loss decreased (1.412752 --> 1.401709).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 18 cost time: 1.688692569732666
Epoch: 18, Steps: 52 | Train Loss: 0.4638513 Vali Loss: 1.4080986 Test Loss: 0.4055108
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 19 cost time: 1.7066466808319092
Epoch: 19, Steps: 52 | Train Loss: 0.4653635 Vali Loss: 1.4045930 Test Loss: 0.4030631
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 20 cost time: 1.7014033794403076
Epoch: 20, Steps: 52 | Train Loss: 0.4631325 Vali Loss: 1.4010761 Test Loss: 0.4006162
Validation loss decreased (1.401709 --> 1.401076).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 21 cost time: 1.7066287994384766
Epoch: 21, Steps: 52 | Train Loss: 0.4631718 Vali Loss: 1.3946592 Test Loss: 0.3972227
Validation loss decreased (1.401076 --> 1.394659).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 22 cost time: 1.7024035453796387
Epoch: 22, Steps: 52 | Train Loss: 0.4605525 Vali Loss: 1.4010236 Test Loss: 0.3963758
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 23 cost time: 1.702352523803711
Epoch: 23, Steps: 52 | Train Loss: 0.4591588 Vali Loss: 1.3956207 Test Loss: 0.3959225
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 24 cost time: 1.7024974822998047
Epoch: 24, Steps: 52 | Train Loss: 0.4595125 Vali Loss: 1.3977413 Test Loss: 0.3948893
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 25 cost time: 1.7010531425476074
Epoch: 25, Steps: 52 | Train Loss: 0.4584495 Vali Loss: 1.3971355 Test Loss: 0.3930096
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 26 cost time: 1.7027170658111572
Epoch: 26, Steps: 52 | Train Loss: 0.4591346 Vali Loss: 1.3895924 Test Loss: 0.3917860
Validation loss decreased (1.394659 --> 1.389592).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 27 cost time: 1.6987295150756836
Epoch: 27, Steps: 52 | Train Loss: 0.4570661 Vali Loss: 1.3927183 Test Loss: 0.3908710
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 28 cost time: 1.6994686126708984
Epoch: 28, Steps: 52 | Train Loss: 0.4577517 Vali Loss: 1.3884361 Test Loss: 0.3899294
Validation loss decreased (1.389592 --> 1.388436).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 29 cost time: 1.7164356708526611
Epoch: 29, Steps: 52 | Train Loss: 0.4548772 Vali Loss: 1.3875921 Test Loss: 0.3885004
Validation loss decreased (1.388436 --> 1.387592).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 30 cost time: 1.6958246231079102
Epoch: 30, Steps: 52 | Train Loss: 0.4562118 Vali Loss: 1.3870001 Test Loss: 0.3886653
Validation loss decreased (1.387592 --> 1.387000).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 31 cost time: 1.699462652206421
Epoch: 31, Steps: 52 | Train Loss: 0.4536373 Vali Loss: 1.3807286 Test Loss: 0.3888801
Validation loss decreased (1.387000 --> 1.380729).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 32 cost time: 1.6984338760375977
Epoch: 32, Steps: 52 | Train Loss: 0.4532483 Vali Loss: 1.3789308 Test Loss: 0.3873684
Validation loss decreased (1.380729 --> 1.378931).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 33 cost time: 1.6925451755523682
Epoch: 33, Steps: 52 | Train Loss: 0.4528324 Vali Loss: 1.3793702 Test Loss: 0.3869554
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 34 cost time: 1.7005441188812256
Epoch: 34, Steps: 52 | Train Loss: 0.4521182 Vali Loss: 1.3858486 Test Loss: 0.3867909
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 35 cost time: 1.6963937282562256
Epoch: 35, Steps: 52 | Train Loss: 0.4525333 Vali Loss: 1.3779345 Test Loss: 0.3870704
Validation loss decreased (1.378931 --> 1.377934).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 36 cost time: 1.705026388168335
Epoch: 36, Steps: 52 | Train Loss: 0.4526309 Vali Loss: 1.3817310 Test Loss: 0.3861686
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 37 cost time: 1.7023043632507324
Epoch: 37, Steps: 52 | Train Loss: 0.4543751 Vali Loss: 1.3790386 Test Loss: 0.3854379
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 38 cost time: 1.6981861591339111
Epoch: 38, Steps: 52 | Train Loss: 0.4538788 Vali Loss: 1.3792174 Test Loss: 0.3853849
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 39 cost time: 1.7098021507263184
Epoch: 39, Steps: 52 | Train Loss: 0.4524322 Vali Loss: 1.3866845 Test Loss: 0.3854055
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 40 cost time: 1.6963255405426025
Epoch: 40, Steps: 52 | Train Loss: 0.4525506 Vali Loss: 1.3860641 Test Loss: 0.3853145
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 41 cost time: 1.6965899467468262
Epoch: 41, Steps: 52 | Train Loss: 0.4511807 Vali Loss: 1.3702016 Test Loss: 0.3843541
Validation loss decreased (1.377934 --> 1.370202).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 42 cost time: 1.7026779651641846
Epoch: 42, Steps: 52 | Train Loss: 0.4504743 Vali Loss: 1.3709632 Test Loss: 0.3843637
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 43 cost time: 1.6975080966949463
Epoch: 43, Steps: 52 | Train Loss: 0.4513617 Vali Loss: 1.3773586 Test Loss: 0.3833621
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 44 cost time: 1.6994240283966064
Epoch: 44, Steps: 52 | Train Loss: 0.4525106 Vali Loss: 1.3711023 Test Loss: 0.3837954
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 45 cost time: 1.6924965381622314
Epoch: 45, Steps: 52 | Train Loss: 0.4519967 Vali Loss: 1.3795559 Test Loss: 0.3840393
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 46 cost time: 1.7042253017425537
Epoch: 46, Steps: 52 | Train Loss: 0.4505136 Vali Loss: 1.3770932 Test Loss: 0.3836143
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 47 cost time: 1.6975977420806885
Epoch: 47, Steps: 52 | Train Loss: 0.4516226 Vali Loss: 1.3859043 Test Loss: 0.3828427
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 48 cost time: 1.7055981159210205
Epoch: 48, Steps: 52 | Train Loss: 0.4529495 Vali Loss: 1.3876191 Test Loss: 0.3839480
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 49 cost time: 1.7028656005859375
Epoch: 49, Steps: 52 | Train Loss: 0.4534890 Vali Loss: 1.3738333 Test Loss: 0.3835794
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 50 cost time: 1.7012693881988525
Epoch: 50, Steps: 52 | Train Loss: 0.4520943 Vali Loss: 1.3730192 Test Loss: 0.3831035
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 51 cost time: 1.705566644668579
Epoch: 51, Steps: 52 | Train Loss: 0.4528637 Vali Loss: 1.3843722 Test Loss: 0.3827603
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 52 cost time: 1.698455572128296
Epoch: 52, Steps: 52 | Train Loss: 0.4510811 Vali Loss: 1.3807244 Test Loss: 0.3821733
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 53 cost time: 1.7032597064971924
Epoch: 53, Steps: 52 | Train Loss: 0.4531454 Vali Loss: 1.3806798 Test Loss: 0.3832779
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 54 cost time: 1.7076561450958252
Epoch: 54, Steps: 52 | Train Loss: 0.4516544 Vali Loss: 1.3783081 Test Loss: 0.3833692
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 55 cost time: 1.701935052871704
Epoch: 55, Steps: 52 | Train Loss: 0.4504266 Vali Loss: 1.3854551 Test Loss: 0.3820704
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 56 cost time: 1.6925482749938965
Epoch: 56, Steps: 52 | Train Loss: 0.4531206 Vali Loss: 1.3778243 Test Loss: 0.3832484
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 57 cost time: 1.6911523342132568
Epoch: 57, Steps: 52 | Train Loss: 0.4526541 Vali Loss: 1.3816277 Test Loss: 0.3829590
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 58 cost time: 1.7003302574157715
Epoch: 58, Steps: 52 | Train Loss: 0.4522306 Vali Loss: 1.3799584 Test Loss: 0.3821572
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 59 cost time: 1.6962037086486816
Epoch: 59, Steps: 52 | Train Loss: 0.4526129 Vali Loss: 1.3776385 Test Loss: 0.3824728
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 60 cost time: 1.700193166732788
Epoch: 60, Steps: 52 | Train Loss: 0.4519378 Vali Loss: 1.3724285 Test Loss: 0.3829525
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3843540847301483, mae:0.41357719898223877, rse:0.5078957080841064
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.036730289459228516 GB
Epoch: 1 cost time: 2.1547954082489014
Epoch: 1, Steps: 52 | Train Loss: 0.7588847 Vali Loss: 2.2114623 Test Loss: 1.4224560
Validation loss decreased (inf --> 2.211462).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 2 cost time: 0.7886195182800293
Epoch: 2, Steps: 52 | Train Loss: 0.6899104 Vali Loss: 1.8601042 Test Loss: 1.0072467
Validation loss decreased (2.211462 --> 1.860104).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 3 cost time: 0.7776486873626709
Epoch: 3, Steps: 52 | Train Loss: 0.5843493 Vali Loss: 1.6213427 Test Loss: 0.7144806
Validation loss decreased (1.860104 --> 1.621343).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 4 cost time: 0.785327672958374
Epoch: 4, Steps: 52 | Train Loss: 0.5230697 Vali Loss: 1.5037329 Test Loss: 0.5520601
Validation loss decreased (1.621343 --> 1.503733).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 5 cost time: 0.8213934898376465
Epoch: 5, Steps: 52 | Train Loss: 0.4918619 Vali Loss: 1.4473144 Test Loss: 0.4854927
Validation loss decreased (1.503733 --> 1.447314).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 6 cost time: 1.7564079761505127
Epoch: 6, Steps: 52 | Train Loss: 0.4749923 Vali Loss: 1.4286819 Test Loss: 0.4533564
Validation loss decreased (1.447314 --> 1.428682).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 7 cost time: 1.7611746788024902
Epoch: 7, Steps: 52 | Train Loss: 0.4635332 Vali Loss: 1.4056571 Test Loss: 0.4338993
Validation loss decreased (1.428682 --> 1.405657).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 8 cost time: 1.7526719570159912
Epoch: 8, Steps: 52 | Train Loss: 0.4598103 Vali Loss: 1.4012833 Test Loss: 0.4220477
Validation loss decreased (1.405657 --> 1.401283).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 9 cost time: 1.7565960884094238
Epoch: 9, Steps: 52 | Train Loss: 0.4536338 Vali Loss: 1.3949819 Test Loss: 0.4115229
Validation loss decreased (1.401283 --> 1.394982).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 10 cost time: 1.761143445968628
Epoch: 10, Steps: 52 | Train Loss: 0.4476648 Vali Loss: 1.3873078 Test Loss: 0.4051118
Validation loss decreased (1.394982 --> 1.387308).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 11 cost time: 1.7654964923858643
Epoch: 11, Steps: 52 | Train Loss: 0.4467142 Vali Loss: 1.3773658 Test Loss: 0.3970945
Validation loss decreased (1.387308 --> 1.377366).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 12 cost time: 1.7468092441558838
Epoch: 12, Steps: 52 | Train Loss: 0.4436234 Vali Loss: 1.3743846 Test Loss: 0.3930407
Validation loss decreased (1.377366 --> 1.374385).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 13 cost time: 1.7681138515472412
Epoch: 13, Steps: 52 | Train Loss: 0.4423432 Vali Loss: 1.3706658 Test Loss: 0.3898207
Validation loss decreased (1.374385 --> 1.370666).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 14 cost time: 1.760227918624878
Epoch: 14, Steps: 52 | Train Loss: 0.4409891 Vali Loss: 1.3600229 Test Loss: 0.3855869
Validation loss decreased (1.370666 --> 1.360023).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 15 cost time: 1.7651987075805664
Epoch: 15, Steps: 52 | Train Loss: 0.4387012 Vali Loss: 1.3659468 Test Loss: 0.3825770
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 16 cost time: 1.7561695575714111
Epoch: 16, Steps: 52 | Train Loss: 0.4391698 Vali Loss: 1.3577502 Test Loss: 0.3799971
Validation loss decreased (1.360023 --> 1.357750).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 17 cost time: 1.760624885559082
Epoch: 17, Steps: 52 | Train Loss: 0.4368251 Vali Loss: 1.3610358 Test Loss: 0.3783919
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 18 cost time: 1.7579970359802246
Epoch: 18, Steps: 52 | Train Loss: 0.4364290 Vali Loss: 1.3536204 Test Loss: 0.3765304
Validation loss decreased (1.357750 --> 1.353620).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 19 cost time: 1.7550601959228516
Epoch: 19, Steps: 52 | Train Loss: 0.4351182 Vali Loss: 1.3540432 Test Loss: 0.3744418
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 20 cost time: 1.763474464416504
Epoch: 20, Steps: 52 | Train Loss: 0.4342453 Vali Loss: 1.3584797 Test Loss: 0.3733090
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 21 cost time: 1.7627778053283691
Epoch: 21, Steps: 52 | Train Loss: 0.4339957 Vali Loss: 1.3562996 Test Loss: 0.3719089
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 22 cost time: 1.7695541381835938
Epoch: 22, Steps: 52 | Train Loss: 0.4319773 Vali Loss: 1.3551384 Test Loss: 0.3706650
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 23 cost time: 1.7560484409332275
Epoch: 23, Steps: 52 | Train Loss: 0.4316516 Vali Loss: 1.3542104 Test Loss: 0.3698142
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 24 cost time: 1.7645843029022217
Epoch: 24, Steps: 52 | Train Loss: 0.4312697 Vali Loss: 1.3496525 Test Loss: 0.3695049
Validation loss decreased (1.353620 --> 1.349653).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 25 cost time: 1.7574498653411865
Epoch: 25, Steps: 52 | Train Loss: 0.4311042 Vali Loss: 1.3501512 Test Loss: 0.3694313
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 26 cost time: 1.7640058994293213
Epoch: 26, Steps: 52 | Train Loss: 0.4319184 Vali Loss: 1.3466848 Test Loss: 0.3671122
Validation loss decreased (1.349653 --> 1.346685).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 27 cost time: 1.7556214332580566
Epoch: 27, Steps: 52 | Train Loss: 0.4289474 Vali Loss: 1.3442390 Test Loss: 0.3664263
Validation loss decreased (1.346685 --> 1.344239).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 28 cost time: 1.7585639953613281
Epoch: 28, Steps: 52 | Train Loss: 0.4310879 Vali Loss: 1.3496486 Test Loss: 0.3648646
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 29 cost time: 1.7529826164245605
Epoch: 29, Steps: 52 | Train Loss: 0.4323145 Vali Loss: 1.3544044 Test Loss: 0.3654689
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 30 cost time: 1.7584002017974854
Epoch: 30, Steps: 52 | Train Loss: 0.4314101 Vali Loss: 1.3383534 Test Loss: 0.3645224
Validation loss decreased (1.344239 --> 1.338353).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 31 cost time: 1.7669084072113037
Epoch: 31, Steps: 52 | Train Loss: 0.4319476 Vali Loss: 1.3447402 Test Loss: 0.3639491
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 32 cost time: 1.7598536014556885
Epoch: 32, Steps: 52 | Train Loss: 0.4307859 Vali Loss: 1.3427302 Test Loss: 0.3643628
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 33 cost time: 1.761521339416504
Epoch: 33, Steps: 52 | Train Loss: 0.4295466 Vali Loss: 1.3451443 Test Loss: 0.3643379
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 34 cost time: 1.75636625289917
Epoch: 34, Steps: 52 | Train Loss: 0.4300766 Vali Loss: 1.3468573 Test Loss: 0.3637366
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 35 cost time: 1.7522413730621338
Epoch: 35, Steps: 52 | Train Loss: 0.4291010 Vali Loss: 1.3495827 Test Loss: 0.3640234
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 36 cost time: 1.7463912963867188
Epoch: 36, Steps: 52 | Train Loss: 0.4299583 Vali Loss: 1.3441370 Test Loss: 0.3635927
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 37 cost time: 1.7643685340881348
Epoch: 37, Steps: 52 | Train Loss: 0.4274986 Vali Loss: 1.3432051 Test Loss: 0.3637265
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 38 cost time: 1.761693000793457
Epoch: 38, Steps: 52 | Train Loss: 0.4293252 Vali Loss: 1.3456187 Test Loss: 0.3630440
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 39 cost time: 1.7628934383392334
Epoch: 39, Steps: 52 | Train Loss: 0.4294751 Vali Loss: 1.3486668 Test Loss: 0.3638431
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 40 cost time: 1.750596284866333
Epoch: 40, Steps: 52 | Train Loss: 0.4280721 Vali Loss: 1.3440206 Test Loss: 0.3630196
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 41 cost time: 1.7748932838439941
Epoch: 41, Steps: 52 | Train Loss: 0.4287300 Vali Loss: 1.3365421 Test Loss: 0.3624827
Validation loss decreased (1.338353 --> 1.336542).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 42 cost time: 1.747790813446045
Epoch: 42, Steps: 52 | Train Loss: 0.4283420 Vali Loss: 1.3359625 Test Loss: 0.3622524
Validation loss decreased (1.336542 --> 1.335963).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 43 cost time: 1.7586376667022705
Epoch: 43, Steps: 52 | Train Loss: 0.4305251 Vali Loss: 1.3448811 Test Loss: 0.3626080
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 44 cost time: 1.7598955631256104
Epoch: 44, Steps: 52 | Train Loss: 0.4277391 Vali Loss: 1.3388963 Test Loss: 0.3619194
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 45 cost time: 1.7548439502716064
Epoch: 45, Steps: 52 | Train Loss: 0.4274014 Vali Loss: 1.3458591 Test Loss: 0.3628029
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 46 cost time: 1.7626280784606934
Epoch: 46, Steps: 52 | Train Loss: 0.4285814 Vali Loss: 1.3468471 Test Loss: 0.3620713
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 47 cost time: 1.75523042678833
Epoch: 47, Steps: 52 | Train Loss: 0.4284874 Vali Loss: 1.3365946 Test Loss: 0.3608969
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 48 cost time: 1.7559394836425781
Epoch: 48, Steps: 52 | Train Loss: 0.4281173 Vali Loss: 1.3437718 Test Loss: 0.3620465
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 49 cost time: 1.758131742477417
Epoch: 49, Steps: 52 | Train Loss: 0.4284261 Vali Loss: 1.3487961 Test Loss: 0.3620837
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 50 cost time: 1.7596235275268555
Epoch: 50, Steps: 52 | Train Loss: 0.4265770 Vali Loss: 1.3458087 Test Loss: 0.3619221
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 51 cost time: 1.763244390487671
Epoch: 51, Steps: 52 | Train Loss: 0.4278705 Vali Loss: 1.3480558 Test Loss: 0.3621551
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 52 cost time: 1.7635607719421387
Epoch: 52, Steps: 52 | Train Loss: 0.4282518 Vali Loss: 1.3526541 Test Loss: 0.3613845
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 53 cost time: 1.7550599575042725
Epoch: 53, Steps: 52 | Train Loss: 0.4287684 Vali Loss: 1.3356684 Test Loss: 0.3625336
Validation loss decreased (1.335963 --> 1.335668).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 54 cost time: 1.7662343978881836
Epoch: 54, Steps: 52 | Train Loss: 0.4293445 Vali Loss: 1.3414893 Test Loss: 0.3612556
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 55 cost time: 1.7531166076660156
Epoch: 55, Steps: 52 | Train Loss: 0.4278478 Vali Loss: 1.3469169 Test Loss: 0.3616145
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 56 cost time: 1.761612892150879
Epoch: 56, Steps: 52 | Train Loss: 0.4284217 Vali Loss: 1.3433431 Test Loss: 0.3628249
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 57 cost time: 1.7632646560668945
Epoch: 57, Steps: 52 | Train Loss: 0.4296604 Vali Loss: 1.3387320 Test Loss: 0.3618505
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 58 cost time: 1.7566933631896973
Epoch: 58, Steps: 52 | Train Loss: 0.4261624 Vali Loss: 1.3485425 Test Loss: 0.3623827
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 59 cost time: 1.7591238021850586
Epoch: 59, Steps: 52 | Train Loss: 0.4291735 Vali Loss: 1.3516860 Test Loss: 0.3617252
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 60 cost time: 1.7562990188598633
Epoch: 60, Steps: 52 | Train Loss: 0.4269673 Vali Loss: 1.3494688 Test Loss: 0.3612132
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3625335693359375, mae:0.3994341194629669, rse:0.4932679831981659
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03729438781738281 GB
Epoch: 1 cost time: 2.1902122497558594
Epoch: 1, Steps: 52 | Train Loss: 0.7000621 Vali Loss: 2.1739452 Test Loss: 1.3757279
Validation loss decreased (inf --> 2.173945).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 2 cost time: 0.8180012702941895
Epoch: 2, Steps: 52 | Train Loss: 0.6612463 Vali Loss: 1.9531628 Test Loss: 1.1346195
Validation loss decreased (2.173945 --> 1.953163).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 3 cost time: 0.797614574432373
Epoch: 3, Steps: 52 | Train Loss: 0.5928163 Vali Loss: 1.7443101 Test Loss: 0.8700803
Validation loss decreased (1.953163 --> 1.744310).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 4 cost time: 0.7974822521209717
Epoch: 4, Steps: 52 | Train Loss: 0.5256867 Vali Loss: 1.5583775 Test Loss: 0.6148186
Validation loss decreased (1.744310 --> 1.558378).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 5 cost time: 1.0645275115966797
Epoch: 5, Steps: 52 | Train Loss: 0.4810272 Vali Loss: 1.4861908 Test Loss: 0.5002396
Validation loss decreased (1.558378 --> 1.486191).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 6 cost time: 1.7906508445739746
Epoch: 6, Steps: 52 | Train Loss: 0.4617251 Vali Loss: 1.4460489 Test Loss: 0.4518365
Validation loss decreased (1.486191 --> 1.446049).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 7 cost time: 1.7970805168151855
Epoch: 7, Steps: 52 | Train Loss: 0.4525871 Vali Loss: 1.4143364 Test Loss: 0.4313043
Validation loss decreased (1.446049 --> 1.414336).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 8 cost time: 1.7911419868469238
Epoch: 8, Steps: 52 | Train Loss: 0.4461770 Vali Loss: 1.4071263 Test Loss: 0.4138166
Validation loss decreased (1.414336 --> 1.407126).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 9 cost time: 1.7990565299987793
Epoch: 9, Steps: 52 | Train Loss: 0.4423628 Vali Loss: 1.3978142 Test Loss: 0.4031353
Validation loss decreased (1.407126 --> 1.397814).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 10 cost time: 1.7884666919708252
Epoch: 10, Steps: 52 | Train Loss: 0.4380691 Vali Loss: 1.3851368 Test Loss: 0.3965896
Validation loss decreased (1.397814 --> 1.385137).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 11 cost time: 1.791194200515747
Epoch: 11, Steps: 52 | Train Loss: 0.4359425 Vali Loss: 1.3791747 Test Loss: 0.3899456
Validation loss decreased (1.385137 --> 1.379175).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 12 cost time: 1.7952206134796143
Epoch: 12, Steps: 52 | Train Loss: 0.4325760 Vali Loss: 1.3766329 Test Loss: 0.3850261
Validation loss decreased (1.379175 --> 1.376633).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 13 cost time: 1.8005845546722412
Epoch: 13, Steps: 52 | Train Loss: 0.4309628 Vali Loss: 1.3698313 Test Loss: 0.3805239
Validation loss decreased (1.376633 --> 1.369831).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 14 cost time: 1.7972183227539062
Epoch: 14, Steps: 52 | Train Loss: 0.4298595 Vali Loss: 1.3643787 Test Loss: 0.3767249
Validation loss decreased (1.369831 --> 1.364379).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 15 cost time: 1.7984333038330078
Epoch: 15, Steps: 52 | Train Loss: 0.4286610 Vali Loss: 1.3610532 Test Loss: 0.3749254
Validation loss decreased (1.364379 --> 1.361053).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 16 cost time: 1.7943599224090576
Epoch: 16, Steps: 52 | Train Loss: 0.4280518 Vali Loss: 1.3521860 Test Loss: 0.3727086
Validation loss decreased (1.361053 --> 1.352186).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 17 cost time: 1.7980320453643799
Epoch: 17, Steps: 52 | Train Loss: 0.4266360 Vali Loss: 1.3561008 Test Loss: 0.3706422
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 18 cost time: 1.7958588600158691
Epoch: 18, Steps: 52 | Train Loss: 0.4267953 Vali Loss: 1.3562406 Test Loss: 0.3689847
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 19 cost time: 1.8035387992858887
Epoch: 19, Steps: 52 | Train Loss: 0.4260276 Vali Loss: 1.3494306 Test Loss: 0.3673272
Validation loss decreased (1.352186 --> 1.349431).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 20 cost time: 1.8045694828033447
Epoch: 20, Steps: 52 | Train Loss: 0.4242590 Vali Loss: 1.3548923 Test Loss: 0.3668460
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 21 cost time: 1.8088743686676025
Epoch: 21, Steps: 52 | Train Loss: 0.4248081 Vali Loss: 1.3478932 Test Loss: 0.3653553
Validation loss decreased (1.349431 --> 1.347893).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 22 cost time: 1.798452615737915
Epoch: 22, Steps: 52 | Train Loss: 0.4229246 Vali Loss: 1.3534470 Test Loss: 0.3649450
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 23 cost time: 1.800022840499878
Epoch: 23, Steps: 52 | Train Loss: 0.4236720 Vali Loss: 1.3490297 Test Loss: 0.3647779
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 24 cost time: 1.7984445095062256
Epoch: 24, Steps: 52 | Train Loss: 0.4244590 Vali Loss: 1.3508188 Test Loss: 0.3637075
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 25 cost time: 1.795384407043457
Epoch: 25, Steps: 52 | Train Loss: 0.4235550 Vali Loss: 1.3455598 Test Loss: 0.3630809
Validation loss decreased (1.347893 --> 1.345560).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 26 cost time: 1.7985031604766846
Epoch: 26, Steps: 52 | Train Loss: 0.4237089 Vali Loss: 1.3424244 Test Loss: 0.3625128
Validation loss decreased (1.345560 --> 1.342424).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 27 cost time: 1.7927801609039307
Epoch: 27, Steps: 52 | Train Loss: 0.4229367 Vali Loss: 1.3448572 Test Loss: 0.3615990
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 28 cost time: 1.8001108169555664
Epoch: 28, Steps: 52 | Train Loss: 0.4227064 Vali Loss: 1.3413988 Test Loss: 0.3612809
Validation loss decreased (1.342424 --> 1.341399).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 29 cost time: 1.8012073040008545
Epoch: 29, Steps: 52 | Train Loss: 0.4221492 Vali Loss: 1.3444986 Test Loss: 0.3618814
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 30 cost time: 1.7956147193908691
Epoch: 30, Steps: 52 | Train Loss: 0.4219640 Vali Loss: 1.3395195 Test Loss: 0.3611579
Validation loss decreased (1.341399 --> 1.339520).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 31 cost time: 1.7982072830200195
Epoch: 31, Steps: 52 | Train Loss: 0.4213644 Vali Loss: 1.3367343 Test Loss: 0.3606594
Validation loss decreased (1.339520 --> 1.336734).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 32 cost time: 1.7979063987731934
Epoch: 32, Steps: 52 | Train Loss: 0.4213048 Vali Loss: 1.3372233 Test Loss: 0.3607353
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 33 cost time: 1.7936100959777832
Epoch: 33, Steps: 52 | Train Loss: 0.4198708 Vali Loss: 1.3494012 Test Loss: 0.3611779
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 34 cost time: 1.8014068603515625
Epoch: 34, Steps: 52 | Train Loss: 0.4202227 Vali Loss: 1.3412043 Test Loss: 0.3607970
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 35 cost time: 1.7976040840148926
Epoch: 35, Steps: 52 | Train Loss: 0.4210790 Vali Loss: 1.3332579 Test Loss: 0.3602313
Validation loss decreased (1.336734 --> 1.333258).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 36 cost time: 1.8024225234985352
Epoch: 36, Steps: 52 | Train Loss: 0.4220178 Vali Loss: 1.3423394 Test Loss: 0.3600990
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 37 cost time: 1.7982184886932373
Epoch: 37, Steps: 52 | Train Loss: 0.4217601 Vali Loss: 1.3433825 Test Loss: 0.3607600
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 38 cost time: 1.7856166362762451
Epoch: 38, Steps: 52 | Train Loss: 0.4193563 Vali Loss: 1.3464258 Test Loss: 0.3602730
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 39 cost time: 1.787170648574829
Epoch: 39, Steps: 52 | Train Loss: 0.4198025 Vali Loss: 1.3398432 Test Loss: 0.3603373
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 40 cost time: 1.8009660243988037
Epoch: 40, Steps: 52 | Train Loss: 0.4209375 Vali Loss: 1.3446596 Test Loss: 0.3596874
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 41 cost time: 1.79917573928833
Epoch: 41, Steps: 52 | Train Loss: 0.4209492 Vali Loss: 1.3328135 Test Loss: 0.3594722
Validation loss decreased (1.333258 --> 1.332814).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 42 cost time: 1.795245885848999
Epoch: 42, Steps: 52 | Train Loss: 0.4205970 Vali Loss: 1.3296008 Test Loss: 0.3598034
Validation loss decreased (1.332814 --> 1.329601).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 43 cost time: 1.7982563972473145
Epoch: 43, Steps: 52 | Train Loss: 0.4207884 Vali Loss: 1.3386140 Test Loss: 0.3594378
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 44 cost time: 1.798478126525879
Epoch: 44, Steps: 52 | Train Loss: 0.4208826 Vali Loss: 1.3376265 Test Loss: 0.3595500
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 45 cost time: 1.789743185043335
Epoch: 45, Steps: 52 | Train Loss: 0.4206781 Vali Loss: 1.3366516 Test Loss: 0.3593381
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 46 cost time: 1.7966530323028564
Epoch: 46, Steps: 52 | Train Loss: 0.4186647 Vali Loss: 1.3458524 Test Loss: 0.3594708
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 47 cost time: 1.7989020347595215
Epoch: 47, Steps: 52 | Train Loss: 0.4209768 Vali Loss: 1.3362336 Test Loss: 0.3582447
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 48 cost time: 1.7999622821807861
Epoch: 48, Steps: 52 | Train Loss: 0.4189544 Vali Loss: 1.3457038 Test Loss: 0.3593452
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 49 cost time: 1.799755573272705
Epoch: 49, Steps: 52 | Train Loss: 0.4196231 Vali Loss: 1.3368134 Test Loss: 0.3588782
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 50 cost time: 1.7995491027832031
Epoch: 50, Steps: 52 | Train Loss: 0.4196352 Vali Loss: 1.3448461 Test Loss: 0.3580440
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 51 cost time: 1.7950985431671143
Epoch: 51, Steps: 52 | Train Loss: 0.4206827 Vali Loss: 1.3435720 Test Loss: 0.3587450
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 52 cost time: 1.7950820922851562
Epoch: 52, Steps: 52 | Train Loss: 0.4204630 Vali Loss: 1.3380160 Test Loss: 0.3589493
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 53 cost time: 1.7866249084472656
Epoch: 53, Steps: 52 | Train Loss: 0.4194960 Vali Loss: 1.3349870 Test Loss: 0.3592643
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 54 cost time: 1.8001487255096436
Epoch: 54, Steps: 52 | Train Loss: 0.4202813 Vali Loss: 1.3443075 Test Loss: 0.3594725
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 55 cost time: 1.7975690364837646
Epoch: 55, Steps: 52 | Train Loss: 0.4213597 Vali Loss: 1.3364176 Test Loss: 0.3590769
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 56 cost time: 1.7997970581054688
Epoch: 56, Steps: 52 | Train Loss: 0.4216799 Vali Loss: 1.3372792 Test Loss: 0.3584098
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 57 cost time: 1.7878048419952393
Epoch: 57, Steps: 52 | Train Loss: 0.4195344 Vali Loss: 1.3375936 Test Loss: 0.3589119
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 58 cost time: 1.796463966369629
Epoch: 58, Steps: 52 | Train Loss: 0.4200017 Vali Loss: 1.3331569 Test Loss: 0.3593803
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 59 cost time: 1.7921435832977295
Epoch: 59, Steps: 52 | Train Loss: 0.4196585 Vali Loss: 1.3420643 Test Loss: 0.3591959
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 60 cost time: 1.7955336570739746
Epoch: 60, Steps: 52 | Train Loss: 0.4198363 Vali Loss: 1.3350929 Test Loss: 0.3587825
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3598034083843231, mae:0.4024912416934967, rse:0.4914070963859558
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.036190032958984375 GB
Epoch: 1 cost time: 2.1483724117279053
Epoch: 1, Steps: 52 | Train Loss: 0.8607553 Vali Loss: 2.3360472 Test Loss: 1.4643183
Validation loss decreased (inf --> 2.336047).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 2 cost time: 0.7656590938568115
Epoch: 2, Steps: 52 | Train Loss: 0.7517265 Vali Loss: 1.8384045 Test Loss: 0.8910447
Validation loss decreased (2.336047 --> 1.838405).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 3 cost time: 0.7666304111480713
Epoch: 3, Steps: 52 | Train Loss: 0.6186123 Vali Loss: 1.6161721 Test Loss: 0.6570675
Validation loss decreased (1.838405 --> 1.616172).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 4 cost time: 0.7695496082305908
Epoch: 4, Steps: 52 | Train Loss: 0.5599978 Vali Loss: 1.5308059 Test Loss: 0.5557818
Validation loss decreased (1.616172 --> 1.530806).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 5 cost time: 0.7597243785858154
Epoch: 5, Steps: 52 | Train Loss: 0.5282509 Vali Loss: 1.5012504 Test Loss: 0.5085500
Validation loss decreased (1.530806 --> 1.501250).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 6 cost time: 1.7123489379882812
Epoch: 6, Steps: 52 | Train Loss: 0.5103619 Vali Loss: 1.4734302 Test Loss: 0.4812301
Validation loss decreased (1.501250 --> 1.473430).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 7 cost time: 1.7085399627685547
Epoch: 7, Steps: 52 | Train Loss: 0.4962733 Vali Loss: 1.4478965 Test Loss: 0.4649949
Validation loss decreased (1.473430 --> 1.447896).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 8 cost time: 1.7171316146850586
Epoch: 8, Steps: 52 | Train Loss: 0.4925672 Vali Loss: 1.4453287 Test Loss: 0.4528423
Validation loss decreased (1.447896 --> 1.445329).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 9 cost time: 1.7120614051818848
Epoch: 9, Steps: 52 | Train Loss: 0.4848212 Vali Loss: 1.4415684 Test Loss: 0.4452269
Validation loss decreased (1.445329 --> 1.441568).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 10 cost time: 1.7136867046356201
Epoch: 10, Steps: 52 | Train Loss: 0.4797782 Vali Loss: 1.4250226 Test Loss: 0.4373790
Validation loss decreased (1.441568 --> 1.425023).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 11 cost time: 1.7155811786651611
Epoch: 11, Steps: 52 | Train Loss: 0.4755533 Vali Loss: 1.4219342 Test Loss: 0.4326181
Validation loss decreased (1.425023 --> 1.421934).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 12 cost time: 1.707035779953003
Epoch: 12, Steps: 52 | Train Loss: 0.4707666 Vali Loss: 1.4203013 Test Loss: 0.4280387
Validation loss decreased (1.421934 --> 1.420301).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 13 cost time: 1.7033615112304688
Epoch: 13, Steps: 52 | Train Loss: 0.4679858 Vali Loss: 1.4147509 Test Loss: 0.4233810
Validation loss decreased (1.420301 --> 1.414751).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 14 cost time: 1.7121751308441162
Epoch: 14, Steps: 52 | Train Loss: 0.4674327 Vali Loss: 1.4138364 Test Loss: 0.4197851
Validation loss decreased (1.414751 --> 1.413836).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 15 cost time: 1.7197351455688477
Epoch: 15, Steps: 52 | Train Loss: 0.4615985 Vali Loss: 1.4076624 Test Loss: 0.4173039
Validation loss decreased (1.413836 --> 1.407662).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 16 cost time: 1.7105686664581299
Epoch: 16, Steps: 52 | Train Loss: 0.4634662 Vali Loss: 1.4104772 Test Loss: 0.4138430
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 17 cost time: 1.7172632217407227
Epoch: 17, Steps: 52 | Train Loss: 0.4617463 Vali Loss: 1.4009097 Test Loss: 0.4114376
Validation loss decreased (1.407662 --> 1.400910).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 18 cost time: 1.7034242153167725
Epoch: 18, Steps: 52 | Train Loss: 0.4600792 Vali Loss: 1.4037300 Test Loss: 0.4106201
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 19 cost time: 1.7180473804473877
Epoch: 19, Steps: 52 | Train Loss: 0.4600723 Vali Loss: 1.3907977 Test Loss: 0.4073144
Validation loss decreased (1.400910 --> 1.390798).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 20 cost time: 1.710392951965332
Epoch: 20, Steps: 52 | Train Loss: 0.4590515 Vali Loss: 1.3951368 Test Loss: 0.4063476
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 21 cost time: 1.7172513008117676
Epoch: 21, Steps: 52 | Train Loss: 0.4571188 Vali Loss: 1.4035487 Test Loss: 0.4051440
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 22 cost time: 1.7137365341186523
Epoch: 22, Steps: 52 | Train Loss: 0.4576631 Vali Loss: 1.3933604 Test Loss: 0.4047875
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 23 cost time: 1.7184715270996094
Epoch: 23, Steps: 52 | Train Loss: 0.4544397 Vali Loss: 1.3958020 Test Loss: 0.4026402
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 24 cost time: 1.719034194946289
Epoch: 24, Steps: 52 | Train Loss: 0.4557529 Vali Loss: 1.3967867 Test Loss: 0.4025534
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 25 cost time: 1.7118291854858398
Epoch: 25, Steps: 52 | Train Loss: 0.4540110 Vali Loss: 1.3896582 Test Loss: 0.4016698
Validation loss decreased (1.390798 --> 1.389658).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 26 cost time: 1.7151062488555908
Epoch: 26, Steps: 52 | Train Loss: 0.4545142 Vali Loss: 1.3920577 Test Loss: 0.3997391
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 27 cost time: 1.710702896118164
Epoch: 27, Steps: 52 | Train Loss: 0.4532469 Vali Loss: 1.3951454 Test Loss: 0.3994018
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 28 cost time: 1.7104854583740234
Epoch: 28, Steps: 52 | Train Loss: 0.4534493 Vali Loss: 1.3913612 Test Loss: 0.3987060
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 29 cost time: 1.7063930034637451
Epoch: 29, Steps: 52 | Train Loss: 0.4525929 Vali Loss: 1.3877378 Test Loss: 0.3991031
Validation loss decreased (1.389658 --> 1.387738).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 30 cost time: 1.7074828147888184
Epoch: 30, Steps: 52 | Train Loss: 0.4528378 Vali Loss: 1.3811297 Test Loss: 0.3979779
Validation loss decreased (1.387738 --> 1.381130).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 31 cost time: 1.712975025177002
Epoch: 31, Steps: 52 | Train Loss: 0.4512262 Vali Loss: 1.3893614 Test Loss: 0.3974952
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 32 cost time: 1.7189171314239502
Epoch: 32, Steps: 52 | Train Loss: 0.4507150 Vali Loss: 1.3923243 Test Loss: 0.3965058
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 33 cost time: 1.71244215965271
Epoch: 33, Steps: 52 | Train Loss: 0.4510107 Vali Loss: 1.3839154 Test Loss: 0.3966614
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 34 cost time: 1.704679250717163
Epoch: 34, Steps: 52 | Train Loss: 0.4507865 Vali Loss: 1.3812768 Test Loss: 0.3963344
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 35 cost time: 1.707517147064209
Epoch: 35, Steps: 52 | Train Loss: 0.4516127 Vali Loss: 1.3797349 Test Loss: 0.3955092
Validation loss decreased (1.381130 --> 1.379735).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 36 cost time: 1.716306209564209
Epoch: 36, Steps: 52 | Train Loss: 0.4505338 Vali Loss: 1.3871698 Test Loss: 0.3961050
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 37 cost time: 1.7149462699890137
Epoch: 37, Steps: 52 | Train Loss: 0.4514129 Vali Loss: 1.3871351 Test Loss: 0.3957716
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 38 cost time: 1.7214748859405518
Epoch: 38, Steps: 52 | Train Loss: 0.4505656 Vali Loss: 1.3856492 Test Loss: 0.3961664
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 39 cost time: 1.7090473175048828
Epoch: 39, Steps: 52 | Train Loss: 0.4504683 Vali Loss: 1.3883499 Test Loss: 0.3959921
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 40 cost time: 1.708362340927124
Epoch: 40, Steps: 52 | Train Loss: 0.4514602 Vali Loss: 1.3807477 Test Loss: 0.3955895
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 41 cost time: 1.7156786918640137
Epoch: 41, Steps: 52 | Train Loss: 0.4505574 Vali Loss: 1.3879151 Test Loss: 0.3946258
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 42 cost time: 1.7185626029968262
Epoch: 42, Steps: 52 | Train Loss: 0.4499872 Vali Loss: 1.3819535 Test Loss: 0.3945861
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 43 cost time: 1.7173182964324951
Epoch: 43, Steps: 52 | Train Loss: 0.4504999 Vali Loss: 1.3868922 Test Loss: 0.3936852
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 44 cost time: 1.703429937362671
Epoch: 44, Steps: 52 | Train Loss: 0.4512190 Vali Loss: 1.3721731 Test Loss: 0.3941298
Validation loss decreased (1.379735 --> 1.372173).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 45 cost time: 1.708094596862793
Epoch: 45, Steps: 52 | Train Loss: 0.4490027 Vali Loss: 1.3877137 Test Loss: 0.3941032
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 46 cost time: 1.7040455341339111
Epoch: 46, Steps: 52 | Train Loss: 0.4503769 Vali Loss: 1.3742476 Test Loss: 0.3947714
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 47 cost time: 1.7105076313018799
Epoch: 47, Steps: 52 | Train Loss: 0.4504342 Vali Loss: 1.3866844 Test Loss: 0.3937356
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 48 cost time: 1.7127034664154053
Epoch: 48, Steps: 52 | Train Loss: 0.4510317 Vali Loss: 1.3860044 Test Loss: 0.3935389
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 49 cost time: 1.7096319198608398
Epoch: 49, Steps: 52 | Train Loss: 0.4486686 Vali Loss: 1.3762106 Test Loss: 0.3937712
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 50 cost time: 1.710413932800293
Epoch: 50, Steps: 52 | Train Loss: 0.4502410 Vali Loss: 1.3853457 Test Loss: 0.3940924
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 51 cost time: 1.7183911800384521
Epoch: 51, Steps: 52 | Train Loss: 0.4483894 Vali Loss: 1.3823318 Test Loss: 0.3935928
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 52 cost time: 1.7150280475616455
Epoch: 52, Steps: 52 | Train Loss: 0.4490773 Vali Loss: 1.3717864 Test Loss: 0.3940222
Validation loss decreased (1.372173 --> 1.371786).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 53 cost time: 1.7110943794250488
Epoch: 53, Steps: 52 | Train Loss: 0.4491134 Vali Loss: 1.3835906 Test Loss: 0.3935140
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 54 cost time: 1.705664873123169
Epoch: 54, Steps: 52 | Train Loss: 0.4500973 Vali Loss: 1.3875356 Test Loss: 0.3934096
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 55 cost time: 1.713883638381958
Epoch: 55, Steps: 52 | Train Loss: 0.4498382 Vali Loss: 1.3833222 Test Loss: 0.3930818
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 56 cost time: 1.7084569931030273
Epoch: 56, Steps: 52 | Train Loss: 0.4491114 Vali Loss: 1.3790925 Test Loss: 0.3933909
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 57 cost time: 1.727907419204712
Epoch: 57, Steps: 52 | Train Loss: 0.4499507 Vali Loss: 1.3838369 Test Loss: 0.3931949
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 58 cost time: 1.7103896141052246
Epoch: 58, Steps: 52 | Train Loss: 0.4487235 Vali Loss: 1.3758264 Test Loss: 0.3935955
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 59 cost time: 1.7105920314788818
Epoch: 59, Steps: 52 | Train Loss: 0.4496755 Vali Loss: 1.3848264 Test Loss: 0.3927560
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 60 cost time: 1.70987868309021
Epoch: 60, Steps: 52 | Train Loss: 0.4467049 Vali Loss: 1.3839531 Test Loss: 0.3932142
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.39402222633361816, mae:0.4294525682926178, rse:0.5142439007759094
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.03689146041870117 GB
Epoch: 1 cost time: 2.1767871379852295
Epoch: 1, Steps: 52 | Train Loss: 0.7652099 Vali Loss: 2.2779121 Test Loss: 1.4722166
Validation loss decreased (inf --> 2.277912).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 2 cost time: 0.7752430438995361
Epoch: 2, Steps: 52 | Train Loss: 0.6872682 Vali Loss: 1.9059107 Test Loss: 1.0211084
Validation loss decreased (2.277912 --> 1.905911).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 3 cost time: 0.7774617671966553
Epoch: 3, Steps: 52 | Train Loss: 0.5764594 Vali Loss: 1.6534910 Test Loss: 0.6949936
Validation loss decreased (1.905911 --> 1.653491).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 4 cost time: 0.7760109901428223
Epoch: 4, Steps: 52 | Train Loss: 0.5074575 Vali Loss: 1.5246234 Test Loss: 0.5262758
Validation loss decreased (1.653491 --> 1.524623).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 5 cost time: 0.8543844223022461
Epoch: 5, Steps: 52 | Train Loss: 0.4793660 Vali Loss: 1.4766010 Test Loss: 0.4749556
Validation loss decreased (1.524623 --> 1.476601).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 6 cost time: 1.764796257019043
Epoch: 6, Steps: 52 | Train Loss: 0.4651371 Vali Loss: 1.4559386 Test Loss: 0.4506812
Validation loss decreased (1.476601 --> 1.455939).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 7 cost time: 1.757390022277832
Epoch: 7, Steps: 52 | Train Loss: 0.4571954 Vali Loss: 1.4470278 Test Loss: 0.4385102
Validation loss decreased (1.455939 --> 1.447028).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 8 cost time: 1.7701537609100342
Epoch: 8, Steps: 52 | Train Loss: 0.4529991 Vali Loss: 1.4351128 Test Loss: 0.4281280
Validation loss decreased (1.447028 --> 1.435113).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 9 cost time: 1.7699873447418213
Epoch: 9, Steps: 52 | Train Loss: 0.4492290 Vali Loss: 1.4230199 Test Loss: 0.4207544
Validation loss decreased (1.435113 --> 1.423020).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 10 cost time: 1.7550380229949951
Epoch: 10, Steps: 52 | Train Loss: 0.4459507 Vali Loss: 1.4085541 Test Loss: 0.4145628
Validation loss decreased (1.423020 --> 1.408554).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 11 cost time: 1.7654671669006348
Epoch: 11, Steps: 52 | Train Loss: 0.4426756 Vali Loss: 1.4125991 Test Loss: 0.4116900
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 12 cost time: 1.7571334838867188
Epoch: 12, Steps: 52 | Train Loss: 0.4394936 Vali Loss: 1.3971494 Test Loss: 0.4068591
Validation loss decreased (1.408554 --> 1.397149).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 13 cost time: 1.7721984386444092
Epoch: 13, Steps: 52 | Train Loss: 0.4392850 Vali Loss: 1.3944511 Test Loss: 0.4043891
Validation loss decreased (1.397149 --> 1.394451).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 14 cost time: 1.766404151916504
Epoch: 14, Steps: 52 | Train Loss: 0.4372618 Vali Loss: 1.3963194 Test Loss: 0.4012812
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 15 cost time: 1.7644596099853516
Epoch: 15, Steps: 52 | Train Loss: 0.4378043 Vali Loss: 1.3951260 Test Loss: 0.3992002
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 16 cost time: 1.7694556713104248
Epoch: 16, Steps: 52 | Train Loss: 0.4344006 Vali Loss: 1.3902882 Test Loss: 0.3967464
Validation loss decreased (1.394451 --> 1.390288).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 17 cost time: 1.7594387531280518
Epoch: 17, Steps: 52 | Train Loss: 0.4324823 Vali Loss: 1.3879433 Test Loss: 0.3961315
Validation loss decreased (1.390288 --> 1.387943).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 18 cost time: 1.7693631649017334
Epoch: 18, Steps: 52 | Train Loss: 0.4329937 Vali Loss: 1.3905389 Test Loss: 0.3942171
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 19 cost time: 1.7693040370941162
Epoch: 19, Steps: 52 | Train Loss: 0.4318399 Vali Loss: 1.3837030 Test Loss: 0.3923774
Validation loss decreased (1.387943 --> 1.383703).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 20 cost time: 1.768435001373291
Epoch: 20, Steps: 52 | Train Loss: 0.4322955 Vali Loss: 1.3807833 Test Loss: 0.3915303
Validation loss decreased (1.383703 --> 1.380783).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 21 cost time: 1.7612230777740479
Epoch: 21, Steps: 52 | Train Loss: 0.4312824 Vali Loss: 1.3852048 Test Loss: 0.3909474
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 22 cost time: 1.7684712409973145
Epoch: 22, Steps: 52 | Train Loss: 0.4300435 Vali Loss: 1.3837292 Test Loss: 0.3903490
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 23 cost time: 1.780829906463623
Epoch: 23, Steps: 52 | Train Loss: 0.4292823 Vali Loss: 1.3810987 Test Loss: 0.3891835
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 24 cost time: 1.7637732028961182
Epoch: 24, Steps: 52 | Train Loss: 0.4295463 Vali Loss: 1.3767650 Test Loss: 0.3880024
Validation loss decreased (1.380783 --> 1.376765).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 25 cost time: 1.7649939060211182
Epoch: 25, Steps: 52 | Train Loss: 0.4278730 Vali Loss: 1.3717489 Test Loss: 0.3872969
Validation loss decreased (1.376765 --> 1.371749).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 26 cost time: 1.7644672393798828
Epoch: 26, Steps: 52 | Train Loss: 0.4289419 Vali Loss: 1.3778956 Test Loss: 0.3867066
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 27 cost time: 1.7641854286193848
Epoch: 27, Steps: 52 | Train Loss: 0.4290790 Vali Loss: 1.3771363 Test Loss: 0.3869446
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 28 cost time: 1.7616593837738037
Epoch: 28, Steps: 52 | Train Loss: 0.4283722 Vali Loss: 1.3785162 Test Loss: 0.3865994
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 29 cost time: 1.762082576751709
Epoch: 29, Steps: 52 | Train Loss: 0.4289148 Vali Loss: 1.3789580 Test Loss: 0.3858617
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 30 cost time: 1.7660291194915771
Epoch: 30, Steps: 52 | Train Loss: 0.4284110 Vali Loss: 1.3747741 Test Loss: 0.3853322
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 31 cost time: 1.7746121883392334
Epoch: 31, Steps: 52 | Train Loss: 0.4269702 Vali Loss: 1.3699974 Test Loss: 0.3845797
Validation loss decreased (1.371749 --> 1.369997).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 32 cost time: 1.7618746757507324
Epoch: 32, Steps: 52 | Train Loss: 0.4280694 Vali Loss: 1.3696712 Test Loss: 0.3846909
Validation loss decreased (1.369997 --> 1.369671).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 33 cost time: 1.771575927734375
Epoch: 33, Steps: 52 | Train Loss: 0.4274676 Vali Loss: 1.3680806 Test Loss: 0.3841682
Validation loss decreased (1.369671 --> 1.368081).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 34 cost time: 1.7715823650360107
Epoch: 34, Steps: 52 | Train Loss: 0.4278915 Vali Loss: 1.3690779 Test Loss: 0.3842107
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 35 cost time: 1.7672450542449951
Epoch: 35, Steps: 52 | Train Loss: 0.4264087 Vali Loss: 1.3722569 Test Loss: 0.3843136
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 36 cost time: 1.765500545501709
Epoch: 36, Steps: 52 | Train Loss: 0.4271950 Vali Loss: 1.3643999 Test Loss: 0.3841359
Validation loss decreased (1.368081 --> 1.364400).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 37 cost time: 1.7697360515594482
Epoch: 37, Steps: 52 | Train Loss: 0.4279576 Vali Loss: 1.3737266 Test Loss: 0.3834345
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 38 cost time: 1.7664313316345215
Epoch: 38, Steps: 52 | Train Loss: 0.4261202 Vali Loss: 1.3721130 Test Loss: 0.3831870
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 39 cost time: 1.7618792057037354
Epoch: 39, Steps: 52 | Train Loss: 0.4270586 Vali Loss: 1.3733420 Test Loss: 0.3838796
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 40 cost time: 1.7601556777954102
Epoch: 40, Steps: 52 | Train Loss: 0.4259353 Vali Loss: 1.3763735 Test Loss: 0.3828340
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 41 cost time: 1.765458106994629
Epoch: 41, Steps: 52 | Train Loss: 0.4262416 Vali Loss: 1.3639579 Test Loss: 0.3829646
Validation loss decreased (1.364400 --> 1.363958).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 42 cost time: 1.7645082473754883
Epoch: 42, Steps: 52 | Train Loss: 0.4267190 Vali Loss: 1.3732636 Test Loss: 0.3826162
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 43 cost time: 1.762308120727539
Epoch: 43, Steps: 52 | Train Loss: 0.4272624 Vali Loss: 1.3737774 Test Loss: 0.3823274
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 44 cost time: 1.7577214241027832
Epoch: 44, Steps: 52 | Train Loss: 0.4254342 Vali Loss: 1.3659739 Test Loss: 0.3826711
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 45 cost time: 1.767061710357666
Epoch: 45, Steps: 52 | Train Loss: 0.4266731 Vali Loss: 1.3702784 Test Loss: 0.3822289
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 46 cost time: 1.7670137882232666
Epoch: 46, Steps: 52 | Train Loss: 0.4268756 Vali Loss: 1.3651259 Test Loss: 0.3826516
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 47 cost time: 1.7685139179229736
Epoch: 47, Steps: 52 | Train Loss: 0.4265131 Vali Loss: 1.3678468 Test Loss: 0.3823566
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 48 cost time: 1.7629268169403076
Epoch: 48, Steps: 52 | Train Loss: 0.4255800 Vali Loss: 1.3579226 Test Loss: 0.3824062
Validation loss decreased (1.363958 --> 1.357923).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 49 cost time: 1.763582706451416
Epoch: 49, Steps: 52 | Train Loss: 0.4245609 Vali Loss: 1.3699081 Test Loss: 0.3825441
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 50 cost time: 1.7667486667633057
Epoch: 50, Steps: 52 | Train Loss: 0.4276934 Vali Loss: 1.3649533 Test Loss: 0.3818660
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 51 cost time: 1.7709240913391113
Epoch: 51, Steps: 52 | Train Loss: 0.4269652 Vali Loss: 1.3678463 Test Loss: 0.3832479
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 52 cost time: 1.7633893489837646
Epoch: 52, Steps: 52 | Train Loss: 0.4264876 Vali Loss: 1.3672924 Test Loss: 0.3818198
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 53 cost time: 1.7724478244781494
Epoch: 53, Steps: 52 | Train Loss: 0.4272070 Vali Loss: 1.3672278 Test Loss: 0.3816171
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 54 cost time: 1.7651598453521729
Epoch: 54, Steps: 52 | Train Loss: 0.4265593 Vali Loss: 1.3668756 Test Loss: 0.3821874
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 55 cost time: 1.7659780979156494
Epoch: 55, Steps: 52 | Train Loss: 0.4261180 Vali Loss: 1.3722494 Test Loss: 0.3826192
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 56 cost time: 1.7693610191345215
Epoch: 56, Steps: 52 | Train Loss: 0.4269678 Vali Loss: 1.3753381 Test Loss: 0.3819226
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 57 cost time: 1.7601802349090576
Epoch: 57, Steps: 52 | Train Loss: 0.4265005 Vali Loss: 1.3708303 Test Loss: 0.3816898
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 58 cost time: 1.7635161876678467
Epoch: 58, Steps: 52 | Train Loss: 0.4254883 Vali Loss: 1.3705752 Test Loss: 0.3817183
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 59 cost time: 1.7713289260864258
Epoch: 59, Steps: 52 | Train Loss: 0.4260238 Vali Loss: 1.3700655 Test Loss: 0.3816540
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 60 cost time: 1.7720751762390137
Epoch: 60, Steps: 52 | Train Loss: 0.4266593 Vali Loss: 1.3661327 Test Loss: 0.3819140
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3824061453342438, mae:0.42092135548591614, rse:0.5066070556640625
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03745555877685547 GB
Epoch: 1 cost time: 2.190538167953491
Epoch: 1, Steps: 52 | Train Loss: 0.7085541 Vali Loss: 2.1829841 Test Loss: 1.4003085
Validation loss decreased (inf --> 2.182984).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 2 cost time: 0.7971148490905762
Epoch: 2, Steps: 52 | Train Loss: 0.6724522 Vali Loss: 1.9678824 Test Loss: 1.1519560
Validation loss decreased (2.182984 --> 1.967882).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 3 cost time: 0.8024988174438477
Epoch: 3, Steps: 52 | Train Loss: 0.5976444 Vali Loss: 1.7335405 Test Loss: 0.8423516
Validation loss decreased (1.967882 --> 1.733541).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 4 cost time: 0.7997889518737793
Epoch: 4, Steps: 52 | Train Loss: 0.5172175 Vali Loss: 1.5374260 Test Loss: 0.5654330
Validation loss decreased (1.733541 --> 1.537426).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 5 cost time: 1.0418837070465088
Epoch: 5, Steps: 52 | Train Loss: 0.4707757 Vali Loss: 1.4566238 Test Loss: 0.4596727
Validation loss decreased (1.537426 --> 1.456624).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 6 cost time: 1.8104567527770996
Epoch: 6, Steps: 52 | Train Loss: 0.4556989 Vali Loss: 1.4303577 Test Loss: 0.4293309
Validation loss decreased (1.456624 --> 1.430358).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 7 cost time: 1.8095531463623047
Epoch: 7, Steps: 52 | Train Loss: 0.4469756 Vali Loss: 1.4160260 Test Loss: 0.4179205
Validation loss decreased (1.430358 --> 1.416026).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 8 cost time: 1.8061881065368652
Epoch: 8, Steps: 52 | Train Loss: 0.4405379 Vali Loss: 1.4033375 Test Loss: 0.4091289
Validation loss decreased (1.416026 --> 1.403337).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 9 cost time: 1.8014369010925293
Epoch: 9, Steps: 52 | Train Loss: 0.4379963 Vali Loss: 1.3919343 Test Loss: 0.4012248
Validation loss decreased (1.403337 --> 1.391934).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 10 cost time: 1.8077704906463623
Epoch: 10, Steps: 52 | Train Loss: 0.4329680 Vali Loss: 1.3868134 Test Loss: 0.3979001
Validation loss decreased (1.391934 --> 1.386813).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 11 cost time: 1.8027279376983643
Epoch: 11, Steps: 52 | Train Loss: 0.4343794 Vali Loss: 1.3834167 Test Loss: 0.3930998
Validation loss decreased (1.386813 --> 1.383417).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 12 cost time: 1.7994427680969238
Epoch: 12, Steps: 52 | Train Loss: 0.4306119 Vali Loss: 1.3785751 Test Loss: 0.3903654
Validation loss decreased (1.383417 --> 1.378575).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 13 cost time: 1.821141004562378
Epoch: 13, Steps: 52 | Train Loss: 0.4291115 Vali Loss: 1.3725519 Test Loss: 0.3873047
Validation loss decreased (1.378575 --> 1.372552).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 14 cost time: 1.8062360286712646
Epoch: 14, Steps: 52 | Train Loss: 0.4293620 Vali Loss: 1.3700955 Test Loss: 0.3857061
Validation loss decreased (1.372552 --> 1.370095).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 15 cost time: 1.8056983947753906
Epoch: 15, Steps: 52 | Train Loss: 0.4279698 Vali Loss: 1.3629619 Test Loss: 0.3828670
Validation loss decreased (1.370095 --> 1.362962).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 16 cost time: 1.7991786003112793
Epoch: 16, Steps: 52 | Train Loss: 0.4270025 Vali Loss: 1.3729615 Test Loss: 0.3815997
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 17 cost time: 1.8116669654846191
Epoch: 17, Steps: 52 | Train Loss: 0.4243193 Vali Loss: 1.3758173 Test Loss: 0.3801149
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 18 cost time: 1.8010876178741455
Epoch: 18, Steps: 52 | Train Loss: 0.4229686 Vali Loss: 1.3724546 Test Loss: 0.3782769
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 19 cost time: 1.813084363937378
Epoch: 19, Steps: 52 | Train Loss: 0.4208784 Vali Loss: 1.3658326 Test Loss: 0.3765283
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 20 cost time: 1.8076896667480469
Epoch: 20, Steps: 52 | Train Loss: 0.4221119 Vali Loss: 1.3656149 Test Loss: 0.3761771
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 21 cost time: 1.8054521083831787
Epoch: 21, Steps: 52 | Train Loss: 0.4232211 Vali Loss: 1.3622208 Test Loss: 0.3752762
Validation loss decreased (1.362962 --> 1.362221).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 22 cost time: 1.8085660934448242
Epoch: 22, Steps: 52 | Train Loss: 0.4225233 Vali Loss: 1.3631710 Test Loss: 0.3745822
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 23 cost time: 1.8033232688903809
Epoch: 23, Steps: 52 | Train Loss: 0.4213703 Vali Loss: 1.3655663 Test Loss: 0.3738770
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 24 cost time: 1.8065636157989502
Epoch: 24, Steps: 52 | Train Loss: 0.4218531 Vali Loss: 1.3660320 Test Loss: 0.3734703
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 25 cost time: 1.8102200031280518
Epoch: 25, Steps: 52 | Train Loss: 0.4220166 Vali Loss: 1.3612527 Test Loss: 0.3725101
Validation loss decreased (1.362221 --> 1.361253).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 26 cost time: 1.798433780670166
Epoch: 26, Steps: 52 | Train Loss: 0.4218223 Vali Loss: 1.3598659 Test Loss: 0.3721483
Validation loss decreased (1.361253 --> 1.359866).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 27 cost time: 1.7928617000579834
Epoch: 27, Steps: 52 | Train Loss: 0.4204501 Vali Loss: 1.3591342 Test Loss: 0.3714588
Validation loss decreased (1.359866 --> 1.359134).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 28 cost time: 1.8081481456756592
Epoch: 28, Steps: 52 | Train Loss: 0.4221383 Vali Loss: 1.3543903 Test Loss: 0.3714474
Validation loss decreased (1.359134 --> 1.354390).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 29 cost time: 1.8011412620544434
Epoch: 29, Steps: 52 | Train Loss: 0.4208881 Vali Loss: 1.3532201 Test Loss: 0.3708999
Validation loss decreased (1.354390 --> 1.353220).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 30 cost time: 1.79243803024292
Epoch: 30, Steps: 52 | Train Loss: 0.4210847 Vali Loss: 1.3573425 Test Loss: 0.3707213
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 31 cost time: 1.8101255893707275
Epoch: 31, Steps: 52 | Train Loss: 0.4189661 Vali Loss: 1.3573239 Test Loss: 0.3709074
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 32 cost time: 1.8154492378234863
Epoch: 32, Steps: 52 | Train Loss: 0.4212889 Vali Loss: 1.3573374 Test Loss: 0.3696801
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 33 cost time: 1.8083992004394531
Epoch: 33, Steps: 52 | Train Loss: 0.4203572 Vali Loss: 1.3638000 Test Loss: 0.3710532
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 34 cost time: 1.7971181869506836
Epoch: 34, Steps: 52 | Train Loss: 0.4207336 Vali Loss: 1.3600930 Test Loss: 0.3696618
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 35 cost time: 1.8069510459899902
Epoch: 35, Steps: 52 | Train Loss: 0.4199852 Vali Loss: 1.3612657 Test Loss: 0.3698224
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 36 cost time: 1.815129280090332
Epoch: 36, Steps: 52 | Train Loss: 0.4196067 Vali Loss: 1.3616257 Test Loss: 0.3701193
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 37 cost time: 1.8128392696380615
Epoch: 37, Steps: 52 | Train Loss: 0.4192103 Vali Loss: 1.3539467 Test Loss: 0.3694516
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 38 cost time: 1.8035693168640137
Epoch: 38, Steps: 52 | Train Loss: 0.4194203 Vali Loss: 1.3556466 Test Loss: 0.3690258
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 39 cost time: 1.8074750900268555
Epoch: 39, Steps: 52 | Train Loss: 0.4213054 Vali Loss: 1.3566625 Test Loss: 0.3692505
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 40 cost time: 1.8123226165771484
Epoch: 40, Steps: 52 | Train Loss: 0.4213363 Vali Loss: 1.3546914 Test Loss: 0.3693787
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 41 cost time: 1.8064172267913818
Epoch: 41, Steps: 52 | Train Loss: 0.4209191 Vali Loss: 1.3549151 Test Loss: 0.3693973
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 42 cost time: 1.8141274452209473
Epoch: 42, Steps: 52 | Train Loss: 0.4197631 Vali Loss: 1.3543422 Test Loss: 0.3692278
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 43 cost time: 1.8049209117889404
Epoch: 43, Steps: 52 | Train Loss: 0.4201784 Vali Loss: 1.3522340 Test Loss: 0.3691174
Validation loss decreased (1.353220 --> 1.352234).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 44 cost time: 1.8165841102600098
Epoch: 44, Steps: 52 | Train Loss: 0.4198439 Vali Loss: 1.3486520 Test Loss: 0.3687892
Validation loss decreased (1.352234 --> 1.348652).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 45 cost time: 1.8003818988800049
Epoch: 45, Steps: 52 | Train Loss: 0.4193887 Vali Loss: 1.3559312 Test Loss: 0.3685644
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 46 cost time: 1.8108241558074951
Epoch: 46, Steps: 52 | Train Loss: 0.4188624 Vali Loss: 1.3591976 Test Loss: 0.3690264
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 47 cost time: 1.8019063472747803
Epoch: 47, Steps: 52 | Train Loss: 0.4199229 Vali Loss: 1.3527329 Test Loss: 0.3682289
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 48 cost time: 1.8023269176483154
Epoch: 48, Steps: 52 | Train Loss: 0.4187939 Vali Loss: 1.3573990 Test Loss: 0.3685899
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 49 cost time: 1.817183494567871
Epoch: 49, Steps: 52 | Train Loss: 0.4194203 Vali Loss: 1.3519053 Test Loss: 0.3683584
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 50 cost time: 1.8114886283874512
Epoch: 50, Steps: 52 | Train Loss: 0.4194367 Vali Loss: 1.3554734 Test Loss: 0.3688856
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 51 cost time: 1.8074264526367188
Epoch: 51, Steps: 52 | Train Loss: 0.4182159 Vali Loss: 1.3551965 Test Loss: 0.3691312
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 52 cost time: 1.8139622211456299
Epoch: 52, Steps: 52 | Train Loss: 0.4191441 Vali Loss: 1.3538957 Test Loss: 0.3684929
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 53 cost time: 1.8083510398864746
Epoch: 53, Steps: 52 | Train Loss: 0.4208826 Vali Loss: 1.3547087 Test Loss: 0.3682778
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 54 cost time: 1.7975432872772217
Epoch: 54, Steps: 52 | Train Loss: 0.4191115 Vali Loss: 1.3516209 Test Loss: 0.3682958
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 55 cost time: 1.8071467876434326
Epoch: 55, Steps: 52 | Train Loss: 0.4199858 Vali Loss: 1.3584049 Test Loss: 0.3682147
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 56 cost time: 1.8062410354614258
Epoch: 56, Steps: 52 | Train Loss: 0.4182755 Vali Loss: 1.3563564 Test Loss: 0.3685477
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 57 cost time: 1.807492733001709
Epoch: 57, Steps: 52 | Train Loss: 0.4187525 Vali Loss: 1.3596420 Test Loss: 0.3684057
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 58 cost time: 1.808377742767334
Epoch: 58, Steps: 52 | Train Loss: 0.4186630 Vali Loss: 1.3416998 Test Loss: 0.3682463
Validation loss decreased (1.348652 --> 1.341700).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 59 cost time: 1.812497615814209
Epoch: 59, Steps: 52 | Train Loss: 0.4204018 Vali Loss: 1.3553957 Test Loss: 0.3680786
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 60 cost time: 1.810441017150879
Epoch: 60, Steps: 52 | Train Loss: 0.4185369 Vali Loss: 1.3561890 Test Loss: 0.3690905
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36824631690979004, mae:0.4097284972667694, rse:0.49713921546936035
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03948259353637695 GB
Epoch: 1 cost time: 2.130624532699585
Epoch: 1, Steps: 52 | Train Loss: 0.8812710 Vali Loss: 2.3704059 Test Loss: 1.5118204
Validation loss decreased (inf --> 2.370406).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 2 cost time: 0.7464399337768555
Epoch: 2, Steps: 52 | Train Loss: 0.8150709 Vali Loss: 2.0539410 Test Loss: 1.1755725
Validation loss decreased (2.370406 --> 2.053941).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 3 cost time: 0.7437760829925537
Epoch: 3, Steps: 52 | Train Loss: 0.7078480 Vali Loss: 1.8432279 Test Loss: 0.9545580
Validation loss decreased (2.053941 --> 1.843228).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 4 cost time: 0.7410004138946533
Epoch: 4, Steps: 52 | Train Loss: 0.6396851 Vali Loss: 1.7131078 Test Loss: 0.7984576
Validation loss decreased (1.843228 --> 1.713108).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 5 cost time: 0.7433948516845703
Epoch: 5, Steps: 52 | Train Loss: 0.5932990 Vali Loss: 1.6349915 Test Loss: 0.6897274
Validation loss decreased (1.713108 --> 1.634992).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 6 cost time: 1.6204214096069336
Epoch: 6, Steps: 52 | Train Loss: 0.5605520 Vali Loss: 1.5723405 Test Loss: 0.6156716
Validation loss decreased (1.634992 --> 1.572340).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 7 cost time: 1.6610679626464844
Epoch: 7, Steps: 52 | Train Loss: 0.5400536 Vali Loss: 1.5374374 Test Loss: 0.5680684
Validation loss decreased (1.572340 --> 1.537437).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 8 cost time: 1.6570851802825928
Epoch: 8, Steps: 52 | Train Loss: 0.5252744 Vali Loss: 1.5033500 Test Loss: 0.5303566
Validation loss decreased (1.537437 --> 1.503350).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 9 cost time: 1.649104118347168
Epoch: 9, Steps: 52 | Train Loss: 0.5138733 Vali Loss: 1.4866557 Test Loss: 0.5043530
Validation loss decreased (1.503350 --> 1.486656).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 10 cost time: 1.6549127101898193
Epoch: 10, Steps: 52 | Train Loss: 0.5057572 Vali Loss: 1.4716072 Test Loss: 0.4862295
Validation loss decreased (1.486656 --> 1.471607).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 11 cost time: 1.6582579612731934
Epoch: 11, Steps: 52 | Train Loss: 0.5002182 Vali Loss: 1.4544574 Test Loss: 0.4722226
Validation loss decreased (1.471607 --> 1.454457).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 12 cost time: 1.6484179496765137
Epoch: 12, Steps: 52 | Train Loss: 0.4922732 Vali Loss: 1.4456503 Test Loss: 0.4611118
Validation loss decreased (1.454457 --> 1.445650).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 13 cost time: 1.6582300662994385
Epoch: 13, Steps: 52 | Train Loss: 0.4886549 Vali Loss: 1.4337926 Test Loss: 0.4514775
Validation loss decreased (1.445650 --> 1.433793).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 14 cost time: 1.6514041423797607
Epoch: 14, Steps: 52 | Train Loss: 0.4841276 Vali Loss: 1.4296565 Test Loss: 0.4434960
Validation loss decreased (1.433793 --> 1.429657).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 15 cost time: 1.6590898036956787
Epoch: 15, Steps: 52 | Train Loss: 0.4825265 Vali Loss: 1.4207821 Test Loss: 0.4385930
Validation loss decreased (1.429657 --> 1.420782).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 16 cost time: 1.7789580821990967
Epoch: 16, Steps: 52 | Train Loss: 0.4811254 Vali Loss: 1.4237595 Test Loss: 0.4333953
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 17 cost time: 1.6614398956298828
Epoch: 17, Steps: 52 | Train Loss: 0.4776342 Vali Loss: 1.4114121 Test Loss: 0.4283848
Validation loss decreased (1.420782 --> 1.411412).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 18 cost time: 1.6620275974273682
Epoch: 18, Steps: 52 | Train Loss: 0.4758008 Vali Loss: 1.4133966 Test Loss: 0.4251040
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 19 cost time: 1.7710139751434326
Epoch: 19, Steps: 52 | Train Loss: 0.4740799 Vali Loss: 1.3916600 Test Loss: 0.4221412
Validation loss decreased (1.411412 --> 1.391660).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 20 cost time: 1.6574687957763672
Epoch: 20, Steps: 52 | Train Loss: 0.4744005 Vali Loss: 1.4078668 Test Loss: 0.4194561
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 21 cost time: 1.6622745990753174
Epoch: 21, Steps: 52 | Train Loss: 0.4698137 Vali Loss: 1.4076042 Test Loss: 0.4162439
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 22 cost time: 1.660696029663086
Epoch: 22, Steps: 52 | Train Loss: 0.4718050 Vali Loss: 1.4040799 Test Loss: 0.4154305
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 23 cost time: 1.660759687423706
Epoch: 23, Steps: 52 | Train Loss: 0.4709823 Vali Loss: 1.4038301 Test Loss: 0.4132024
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 24 cost time: 1.6632084846496582
Epoch: 24, Steps: 52 | Train Loss: 0.4681755 Vali Loss: 1.3983409 Test Loss: 0.4109818
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 25 cost time: 1.6631016731262207
Epoch: 25, Steps: 52 | Train Loss: 0.4674625 Vali Loss: 1.3992126 Test Loss: 0.4096206
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 26 cost time: 1.6556358337402344
Epoch: 26, Steps: 52 | Train Loss: 0.4671777 Vali Loss: 1.3891212 Test Loss: 0.4085414
Validation loss decreased (1.391660 --> 1.389121).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 27 cost time: 1.652266025543213
Epoch: 27, Steps: 52 | Train Loss: 0.4656205 Vali Loss: 1.3981783 Test Loss: 0.4074450
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 28 cost time: 1.6576242446899414
Epoch: 28, Steps: 52 | Train Loss: 0.4674898 Vali Loss: 1.3903410 Test Loss: 0.4072978
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 29 cost time: 1.6612608432769775
Epoch: 29, Steps: 52 | Train Loss: 0.4669025 Vali Loss: 1.3920276 Test Loss: 0.4064709
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 30 cost time: 1.6570122241973877
Epoch: 30, Steps: 52 | Train Loss: 0.4651133 Vali Loss: 1.3907557 Test Loss: 0.4043596
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 31 cost time: 1.6575956344604492
Epoch: 31, Steps: 52 | Train Loss: 0.4648300 Vali Loss: 1.3837985 Test Loss: 0.4032547
Validation loss decreased (1.389121 --> 1.383798).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 32 cost time: 1.6600725650787354
Epoch: 32, Steps: 52 | Train Loss: 0.4645190 Vali Loss: 1.3887012 Test Loss: 0.4044474
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 33 cost time: 1.6596012115478516
Epoch: 33, Steps: 52 | Train Loss: 0.4634936 Vali Loss: 1.3846890 Test Loss: 0.4028597
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 34 cost time: 1.656559705734253
Epoch: 34, Steps: 52 | Train Loss: 0.4642717 Vali Loss: 1.3923559 Test Loss: 0.4035224
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 35 cost time: 1.6589195728302002
Epoch: 35, Steps: 52 | Train Loss: 0.4635125 Vali Loss: 1.3874233 Test Loss: 0.4021699
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 36 cost time: 1.6564886569976807
Epoch: 36, Steps: 52 | Train Loss: 0.4629344 Vali Loss: 1.3801944 Test Loss: 0.4019070
Validation loss decreased (1.383798 --> 1.380194).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 37 cost time: 1.6619410514831543
Epoch: 37, Steps: 52 | Train Loss: 0.4633135 Vali Loss: 1.3815724 Test Loss: 0.4017113
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 38 cost time: 1.661597490310669
Epoch: 38, Steps: 52 | Train Loss: 0.4630023 Vali Loss: 1.3853552 Test Loss: 0.3998249
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 39 cost time: 1.659613847732544
Epoch: 39, Steps: 52 | Train Loss: 0.4634737 Vali Loss: 1.3875747 Test Loss: 0.4006220
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 40 cost time: 1.661393642425537
Epoch: 40, Steps: 52 | Train Loss: 0.4634582 Vali Loss: 1.3812499 Test Loss: 0.4012792
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 41 cost time: 1.6644947528839111
Epoch: 41, Steps: 52 | Train Loss: 0.4632441 Vali Loss: 1.3766639 Test Loss: 0.4003170
Validation loss decreased (1.380194 --> 1.376664).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 42 cost time: 1.6620004177093506
Epoch: 42, Steps: 52 | Train Loss: 0.4618536 Vali Loss: 1.3806057 Test Loss: 0.3999853
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 43 cost time: 1.6559057235717773
Epoch: 43, Steps: 52 | Train Loss: 0.4626627 Vali Loss: 1.3886106 Test Loss: 0.3996035
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 44 cost time: 1.6632683277130127
Epoch: 44, Steps: 52 | Train Loss: 0.4636104 Vali Loss: 1.3835779 Test Loss: 0.3991723
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 45 cost time: 1.6648266315460205
Epoch: 45, Steps: 52 | Train Loss: 0.4634604 Vali Loss: 1.3887613 Test Loss: 0.3991416
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 46 cost time: 1.6594429016113281
Epoch: 46, Steps: 52 | Train Loss: 0.4623102 Vali Loss: 1.3773866 Test Loss: 0.3992869
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 47 cost time: 1.6522464752197266
Epoch: 47, Steps: 52 | Train Loss: 0.4638449 Vali Loss: 1.3799684 Test Loss: 0.3975551
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 48 cost time: 1.6624460220336914
Epoch: 48, Steps: 52 | Train Loss: 0.4607465 Vali Loss: 1.3851802 Test Loss: 0.3989403
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 49 cost time: 1.6592981815338135
Epoch: 49, Steps: 52 | Train Loss: 0.4626689 Vali Loss: 1.3831285 Test Loss: 0.3984246
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 50 cost time: 1.6554505825042725
Epoch: 50, Steps: 52 | Train Loss: 0.4615997 Vali Loss: 1.3848907 Test Loss: 0.3988076
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 51 cost time: 1.6613023281097412
Epoch: 51, Steps: 52 | Train Loss: 0.4619708 Vali Loss: 1.3850383 Test Loss: 0.3982633
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 52 cost time: 1.659660816192627
Epoch: 52, Steps: 52 | Train Loss: 0.4611471 Vali Loss: 1.3880053 Test Loss: 0.3978286
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 53 cost time: 1.6572611331939697
Epoch: 53, Steps: 52 | Train Loss: 0.4600414 Vali Loss: 1.3848038 Test Loss: 0.3995948
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 54 cost time: 1.6563608646392822
Epoch: 54, Steps: 52 | Train Loss: 0.4611325 Vali Loss: 1.3788917 Test Loss: 0.3986298
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 55 cost time: 1.6586356163024902
Epoch: 55, Steps: 52 | Train Loss: 0.4604642 Vali Loss: 1.3851082 Test Loss: 0.3988564
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 56 cost time: 1.663393497467041
Epoch: 56, Steps: 52 | Train Loss: 0.4605400 Vali Loss: 1.3822126 Test Loss: 0.3978857
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 57 cost time: 1.6589479446411133
Epoch: 57, Steps: 52 | Train Loss: 0.4616249 Vali Loss: 1.3816648 Test Loss: 0.3993048
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 58 cost time: 1.6555135250091553
Epoch: 58, Steps: 52 | Train Loss: 0.4624928 Vali Loss: 1.3888526 Test Loss: 0.3990509
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 59 cost time: 1.654141902923584
Epoch: 59, Steps: 52 | Train Loss: 0.4601086 Vali Loss: 1.3881799 Test Loss: 0.3964654
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 60 cost time: 1.657979965209961
Epoch: 60, Steps: 52 | Train Loss: 0.4609568 Vali Loss: 1.3910061 Test Loss: 0.3986981
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.40031698346138, mae:0.4355946481227875, rse:0.5183353424072266
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.04018402099609375 GB
Epoch: 1 cost time: 2.159921407699585
Epoch: 1, Steps: 52 | Train Loss: 0.7529354 Vali Loss: 2.2165937 Test Loss: 1.4231969
Validation loss decreased (inf --> 2.216594).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 2 cost time: 0.7906486988067627
Epoch: 2, Steps: 52 | Train Loss: 0.6993893 Vali Loss: 1.9305415 Test Loss: 1.0905876
Validation loss decreased (2.216594 --> 1.930542).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 3 cost time: 0.7844903469085693
Epoch: 3, Steps: 52 | Train Loss: 0.6055652 Vali Loss: 1.6941682 Test Loss: 0.8099449
Validation loss decreased (1.930542 --> 1.694168).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 4 cost time: 0.7673935890197754
Epoch: 4, Steps: 52 | Train Loss: 0.5395587 Vali Loss: 1.5630555 Test Loss: 0.6247190
Validation loss decreased (1.694168 --> 1.563056).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 5 cost time: 0.767629861831665
Epoch: 5, Steps: 52 | Train Loss: 0.5057969 Vali Loss: 1.4905550 Test Loss: 0.5447800
Validation loss decreased (1.563056 --> 1.490555).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 6 cost time: 1.717832088470459
Epoch: 6, Steps: 52 | Train Loss: 0.4865994 Vali Loss: 1.4611022 Test Loss: 0.5058749
Validation loss decreased (1.490555 --> 1.461102).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 7 cost time: 1.7380528450012207
Epoch: 7, Steps: 52 | Train Loss: 0.4782995 Vali Loss: 1.4412025 Test Loss: 0.4804438
Validation loss decreased (1.461102 --> 1.441203).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 8 cost time: 1.7259666919708252
Epoch: 8, Steps: 52 | Train Loss: 0.4681331 Vali Loss: 1.4189332 Test Loss: 0.4608416
Validation loss decreased (1.441203 --> 1.418933).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 9 cost time: 1.7203881740570068
Epoch: 9, Steps: 52 | Train Loss: 0.4650709 Vali Loss: 1.4027421 Test Loss: 0.4457217
Validation loss decreased (1.418933 --> 1.402742).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 10 cost time: 1.7284619808197021
Epoch: 10, Steps: 52 | Train Loss: 0.4596351 Vali Loss: 1.3894469 Test Loss: 0.4325393
Validation loss decreased (1.402742 --> 1.389447).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 11 cost time: 1.7253875732421875
Epoch: 11, Steps: 52 | Train Loss: 0.4525578 Vali Loss: 1.3878616 Test Loss: 0.4220881
Validation loss decreased (1.389447 --> 1.387862).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 12 cost time: 1.7222540378570557
Epoch: 12, Steps: 52 | Train Loss: 0.4496765 Vali Loss: 1.3813418 Test Loss: 0.4169304
Validation loss decreased (1.387862 --> 1.381342).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 13 cost time: 1.7236273288726807
Epoch: 13, Steps: 52 | Train Loss: 0.4481702 Vali Loss: 1.3769825 Test Loss: 0.4109514
Validation loss decreased (1.381342 --> 1.376982).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 14 cost time: 1.727088451385498
Epoch: 14, Steps: 52 | Train Loss: 0.4466357 Vali Loss: 1.3743269 Test Loss: 0.4073634
Validation loss decreased (1.376982 --> 1.374327).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 15 cost time: 1.7262547016143799
Epoch: 15, Steps: 52 | Train Loss: 0.4438650 Vali Loss: 1.3750434 Test Loss: 0.4038577
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 16 cost time: 1.724471092224121
Epoch: 16, Steps: 52 | Train Loss: 0.4434598 Vali Loss: 1.3734059 Test Loss: 0.4003650
Validation loss decreased (1.374327 --> 1.373406).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 17 cost time: 1.7207114696502686
Epoch: 17, Steps: 52 | Train Loss: 0.4432559 Vali Loss: 1.3682594 Test Loss: 0.3976145
Validation loss decreased (1.373406 --> 1.368259).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 18 cost time: 1.7251338958740234
Epoch: 18, Steps: 52 | Train Loss: 0.4395920 Vali Loss: 1.3646867 Test Loss: 0.3950861
Validation loss decreased (1.368259 --> 1.364687).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 19 cost time: 1.7288970947265625
Epoch: 19, Steps: 52 | Train Loss: 0.4394635 Vali Loss: 1.3591217 Test Loss: 0.3930589
Validation loss decreased (1.364687 --> 1.359122).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 20 cost time: 1.7221195697784424
Epoch: 20, Steps: 52 | Train Loss: 0.4388652 Vali Loss: 1.3561163 Test Loss: 0.3901574
Validation loss decreased (1.359122 --> 1.356116).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 21 cost time: 1.7261900901794434
Epoch: 21, Steps: 52 | Train Loss: 0.4386310 Vali Loss: 1.3612261 Test Loss: 0.3895782
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 22 cost time: 1.722430944442749
Epoch: 22, Steps: 52 | Train Loss: 0.4377306 Vali Loss: 1.3595102 Test Loss: 0.3872029
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 23 cost time: 1.7194507122039795
Epoch: 23, Steps: 52 | Train Loss: 0.4381479 Vali Loss: 1.3511349 Test Loss: 0.3877776
Validation loss decreased (1.356116 --> 1.351135).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 24 cost time: 1.7123897075653076
Epoch: 24, Steps: 52 | Train Loss: 0.4351622 Vali Loss: 1.3483945 Test Loss: 0.3853151
Validation loss decreased (1.351135 --> 1.348395).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 25 cost time: 1.7274188995361328
Epoch: 25, Steps: 52 | Train Loss: 0.4370351 Vali Loss: 1.3569791 Test Loss: 0.3857836
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 26 cost time: 1.713062047958374
Epoch: 26, Steps: 52 | Train Loss: 0.4358330 Vali Loss: 1.3596210 Test Loss: 0.3859649
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 27 cost time: 1.737037181854248
Epoch: 27, Steps: 52 | Train Loss: 0.4359638 Vali Loss: 1.3427584 Test Loss: 0.3836490
Validation loss decreased (1.348395 --> 1.342758).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 28 cost time: 1.7218799591064453
Epoch: 28, Steps: 52 | Train Loss: 0.4359075 Vali Loss: 1.3584461 Test Loss: 0.3839303
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 29 cost time: 1.721541404724121
Epoch: 29, Steps: 52 | Train Loss: 0.4358472 Vali Loss: 1.3527641 Test Loss: 0.3825381
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 30 cost time: 1.7263514995574951
Epoch: 30, Steps: 52 | Train Loss: 0.4350350 Vali Loss: 1.3535326 Test Loss: 0.3826537
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 31 cost time: 1.7294423580169678
Epoch: 31, Steps: 52 | Train Loss: 0.4335119 Vali Loss: 1.3527534 Test Loss: 0.3819048
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 32 cost time: 1.724113941192627
Epoch: 32, Steps: 52 | Train Loss: 0.4340278 Vali Loss: 1.3541946 Test Loss: 0.3812818
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 33 cost time: 1.7250289916992188
Epoch: 33, Steps: 52 | Train Loss: 0.4348849 Vali Loss: 1.3543781 Test Loss: 0.3811995
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 34 cost time: 1.722217082977295
Epoch: 34, Steps: 52 | Train Loss: 0.4318743 Vali Loss: 1.3403528 Test Loss: 0.3813928
Validation loss decreased (1.342758 --> 1.340353).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 35 cost time: 1.7348742485046387
Epoch: 35, Steps: 52 | Train Loss: 0.4337754 Vali Loss: 1.3517518 Test Loss: 0.3804008
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 36 cost time: 1.7265141010284424
Epoch: 36, Steps: 52 | Train Loss: 0.4331472 Vali Loss: 1.3496189 Test Loss: 0.3803890
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 37 cost time: 1.722411870956421
Epoch: 37, Steps: 52 | Train Loss: 0.4342418 Vali Loss: 1.3385739 Test Loss: 0.3804127
Validation loss decreased (1.340353 --> 1.338574).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 38 cost time: 1.7205097675323486
Epoch: 38, Steps: 52 | Train Loss: 0.4342249 Vali Loss: 1.3473921 Test Loss: 0.3801678
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 39 cost time: 1.717022180557251
Epoch: 39, Steps: 52 | Train Loss: 0.4334651 Vali Loss: 1.3477259 Test Loss: 0.3793769
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 40 cost time: 1.7253670692443848
Epoch: 40, Steps: 52 | Train Loss: 0.4333024 Vali Loss: 1.3477249 Test Loss: 0.3798987
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 41 cost time: 1.7231175899505615
Epoch: 41, Steps: 52 | Train Loss: 0.4319228 Vali Loss: 1.3492733 Test Loss: 0.3792681
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 42 cost time: 1.7264399528503418
Epoch: 42, Steps: 52 | Train Loss: 0.4329139 Vali Loss: 1.3547277 Test Loss: 0.3808609
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 43 cost time: 1.7184853553771973
Epoch: 43, Steps: 52 | Train Loss: 0.4337021 Vali Loss: 1.3510550 Test Loss: 0.3796718
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 44 cost time: 1.7133443355560303
Epoch: 44, Steps: 52 | Train Loss: 0.4330498 Vali Loss: 1.3504806 Test Loss: 0.3779646
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 45 cost time: 1.7311022281646729
Epoch: 45, Steps: 52 | Train Loss: 0.4318445 Vali Loss: 1.3415514 Test Loss: 0.3793424
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 46 cost time: 1.7297863960266113
Epoch: 46, Steps: 52 | Train Loss: 0.4300956 Vali Loss: 1.3526601 Test Loss: 0.3795233
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 47 cost time: 1.7244279384613037
Epoch: 47, Steps: 52 | Train Loss: 0.4312474 Vali Loss: 1.3482943 Test Loss: 0.3789333
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 48 cost time: 1.7342092990875244
Epoch: 48, Steps: 52 | Train Loss: 0.4324818 Vali Loss: 1.3381639 Test Loss: 0.3788222
Validation loss decreased (1.338574 --> 1.338164).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 49 cost time: 1.72678804397583
Epoch: 49, Steps: 52 | Train Loss: 0.4341383 Vali Loss: 1.3514260 Test Loss: 0.3782123
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 50 cost time: 1.726536750793457
Epoch: 50, Steps: 52 | Train Loss: 0.4341977 Vali Loss: 1.3507928 Test Loss: 0.3792287
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 51 cost time: 1.721503734588623
Epoch: 51, Steps: 52 | Train Loss: 0.4339911 Vali Loss: 1.3479774 Test Loss: 0.3780422
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 52 cost time: 1.7191863059997559
Epoch: 52, Steps: 52 | Train Loss: 0.4319280 Vali Loss: 1.3502185 Test Loss: 0.3793310
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 53 cost time: 1.718348741531372
Epoch: 53, Steps: 52 | Train Loss: 0.4328725 Vali Loss: 1.3353474 Test Loss: 0.3785174
Validation loss decreased (1.338164 --> 1.335347).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 54 cost time: 1.712371826171875
Epoch: 54, Steps: 52 | Train Loss: 0.4328233 Vali Loss: 1.3545808 Test Loss: 0.3783159
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 55 cost time: 1.7190132141113281
Epoch: 55, Steps: 52 | Train Loss: 0.4320687 Vali Loss: 1.3406351 Test Loss: 0.3784780
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 56 cost time: 1.7178599834442139
Epoch: 56, Steps: 52 | Train Loss: 0.4330415 Vali Loss: 1.3466740 Test Loss: 0.3792095
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 57 cost time: 1.715191125869751
Epoch: 57, Steps: 52 | Train Loss: 0.4322802 Vali Loss: 1.3485827 Test Loss: 0.3787887
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 58 cost time: 1.7256956100463867
Epoch: 58, Steps: 52 | Train Loss: 0.4322883 Vali Loss: 1.3467180 Test Loss: 0.3782250
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 59 cost time: 1.7179393768310547
Epoch: 59, Steps: 52 | Train Loss: 0.4324413 Vali Loss: 1.3553500 Test Loss: 0.3781439
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 60 cost time: 1.7183940410614014
Epoch: 60, Steps: 52 | Train Loss: 0.4329995 Vali Loss: 1.3466256 Test Loss: 0.3774896
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.37851738929748535, mae:0.41580554842948914, rse:0.5040246248245239
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04074811935424805 GB
Epoch: 1 cost time: 2.1922361850738525
Epoch: 1, Steps: 52 | Train Loss: 0.7542489 Vali Loss: 2.3175809 Test Loss: 1.4831767
Validation loss decreased (inf --> 2.317581).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 2 cost time: 0.7964804172515869
Epoch: 2, Steps: 52 | Train Loss: 0.7046794 Vali Loss: 2.0438995 Test Loss: 1.1838696
Validation loss decreased (2.317581 --> 2.043900).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 3 cost time: 0.7776215076446533
Epoch: 3, Steps: 52 | Train Loss: 0.6221383 Vali Loss: 1.8218782 Test Loss: 0.9073991
Validation loss decreased (2.043900 --> 1.821878).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 4 cost time: 0.7854833602905273
Epoch: 4, Steps: 52 | Train Loss: 0.5531133 Vali Loss: 1.6240766 Test Loss: 0.6783481
Validation loss decreased (1.821878 --> 1.624077).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 5 cost time: 0.8974089622497559
Epoch: 5, Steps: 52 | Train Loss: 0.5109698 Vali Loss: 1.5387961 Test Loss: 0.5588137
Validation loss decreased (1.624077 --> 1.538796).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 6 cost time: 1.7468321323394775
Epoch: 6, Steps: 52 | Train Loss: 0.4891648 Vali Loss: 1.4812977 Test Loss: 0.5038508
Validation loss decreased (1.538796 --> 1.481298).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 7 cost time: 1.7535576820373535
Epoch: 7, Steps: 52 | Train Loss: 0.4754740 Vali Loss: 1.4581568 Test Loss: 0.4737906
Validation loss decreased (1.481298 --> 1.458157).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 8 cost time: 1.7472116947174072
Epoch: 8, Steps: 52 | Train Loss: 0.4653130 Vali Loss: 1.4319482 Test Loss: 0.4523846
Validation loss decreased (1.458157 --> 1.431948).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 9 cost time: 1.7585351467132568
Epoch: 9, Steps: 52 | Train Loss: 0.4580428 Vali Loss: 1.4148374 Test Loss: 0.4374384
Validation loss decreased (1.431948 --> 1.414837).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 10 cost time: 1.750002145767212
Epoch: 10, Steps: 52 | Train Loss: 0.4554691 Vali Loss: 1.4063191 Test Loss: 0.4265388
Validation loss decreased (1.414837 --> 1.406319).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 11 cost time: 1.7489674091339111
Epoch: 11, Steps: 52 | Train Loss: 0.4502856 Vali Loss: 1.3924975 Test Loss: 0.4191029
Validation loss decreased (1.406319 --> 1.392498).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 12 cost time: 1.7485442161560059
Epoch: 12, Steps: 52 | Train Loss: 0.4459767 Vali Loss: 1.3897489 Test Loss: 0.4120094
Validation loss decreased (1.392498 --> 1.389749).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 13 cost time: 1.7527234554290771
Epoch: 13, Steps: 52 | Train Loss: 0.4449154 Vali Loss: 1.3877891 Test Loss: 0.4078814
Validation loss decreased (1.389749 --> 1.387789).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 14 cost time: 1.7480676174163818
Epoch: 14, Steps: 52 | Train Loss: 0.4449227 Vali Loss: 1.3802817 Test Loss: 0.4034435
Validation loss decreased (1.387789 --> 1.380282).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 15 cost time: 1.7519845962524414
Epoch: 15, Steps: 52 | Train Loss: 0.4430910 Vali Loss: 1.3602598 Test Loss: 0.4002963
Validation loss decreased (1.380282 --> 1.360260).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 16 cost time: 1.746509313583374
Epoch: 16, Steps: 52 | Train Loss: 0.4409995 Vali Loss: 1.3769910 Test Loss: 0.3980597
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 17 cost time: 1.7532389163970947
Epoch: 17, Steps: 52 | Train Loss: 0.4405142 Vali Loss: 1.3613427 Test Loss: 0.3951026
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 18 cost time: 1.7569477558135986
Epoch: 18, Steps: 52 | Train Loss: 0.4361768 Vali Loss: 1.3691502 Test Loss: 0.3939610
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 19 cost time: 1.7665786743164062
Epoch: 19, Steps: 52 | Train Loss: 0.4368642 Vali Loss: 1.3657553 Test Loss: 0.3920785
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 20 cost time: 1.756481647491455
Epoch: 20, Steps: 52 | Train Loss: 0.4381257 Vali Loss: 1.3653543 Test Loss: 0.3893533
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 21 cost time: 1.7584056854248047
Epoch: 21, Steps: 52 | Train Loss: 0.4371180 Vali Loss: 1.3640952 Test Loss: 0.3893715
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 22 cost time: 1.752152442932129
Epoch: 22, Steps: 52 | Train Loss: 0.4349480 Vali Loss: 1.3607774 Test Loss: 0.3884020
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 23 cost time: 1.7483265399932861
Epoch: 23, Steps: 52 | Train Loss: 0.4344264 Vali Loss: 1.3610466 Test Loss: 0.3869098
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 24 cost time: 1.759404182434082
Epoch: 24, Steps: 52 | Train Loss: 0.4360659 Vali Loss: 1.3636276 Test Loss: 0.3860435
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 25 cost time: 1.739931583404541
Epoch: 25, Steps: 52 | Train Loss: 0.4347363 Vali Loss: 1.3521503 Test Loss: 0.3859527
Validation loss decreased (1.360260 --> 1.352150).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 26 cost time: 1.7526459693908691
Epoch: 26, Steps: 52 | Train Loss: 0.4325530 Vali Loss: 1.3597485 Test Loss: 0.3845418
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 27 cost time: 1.7487032413482666
Epoch: 27, Steps: 52 | Train Loss: 0.4336730 Vali Loss: 1.3581009 Test Loss: 0.3837386
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 28 cost time: 1.7555387020111084
Epoch: 28, Steps: 52 | Train Loss: 0.4327993 Vali Loss: 1.3562857 Test Loss: 0.3827565
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 29 cost time: 1.7560675144195557
Epoch: 29, Steps: 52 | Train Loss: 0.4327158 Vali Loss: 1.3519706 Test Loss: 0.3844028
Validation loss decreased (1.352150 --> 1.351971).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 30 cost time: 1.754946231842041
Epoch: 30, Steps: 52 | Train Loss: 0.4334566 Vali Loss: 1.3495560 Test Loss: 0.3822628
Validation loss decreased (1.351971 --> 1.349556).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 31 cost time: 1.7541851997375488
Epoch: 31, Steps: 52 | Train Loss: 0.4335866 Vali Loss: 1.3571663 Test Loss: 0.3834723
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 32 cost time: 1.7510161399841309
Epoch: 32, Steps: 52 | Train Loss: 0.4326435 Vali Loss: 1.3550259 Test Loss: 0.3817437
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 33 cost time: 1.755415916442871
Epoch: 33, Steps: 52 | Train Loss: 0.4326550 Vali Loss: 1.3496666 Test Loss: 0.3817400
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 34 cost time: 1.7578604221343994
Epoch: 34, Steps: 52 | Train Loss: 0.4318785 Vali Loss: 1.3565879 Test Loss: 0.3822147
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 35 cost time: 1.7565674781799316
Epoch: 35, Steps: 52 | Train Loss: 0.4317284 Vali Loss: 1.3561146 Test Loss: 0.3809815
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 36 cost time: 1.7534763813018799
Epoch: 36, Steps: 52 | Train Loss: 0.4308862 Vali Loss: 1.3554348 Test Loss: 0.3813371
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 37 cost time: 1.752089500427246
Epoch: 37, Steps: 52 | Train Loss: 0.4309989 Vali Loss: 1.3564756 Test Loss: 0.3807667
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 38 cost time: 1.7491159439086914
Epoch: 38, Steps: 52 | Train Loss: 0.4307943 Vali Loss: 1.3565327 Test Loss: 0.3807070
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 39 cost time: 1.7528085708618164
Epoch: 39, Steps: 52 | Train Loss: 0.4321451 Vali Loss: 1.3534070 Test Loss: 0.3803492
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 40 cost time: 1.7463958263397217
Epoch: 40, Steps: 52 | Train Loss: 0.4297128 Vali Loss: 1.3592188 Test Loss: 0.3814191
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 41 cost time: 1.746837854385376
Epoch: 41, Steps: 52 | Train Loss: 0.4316066 Vali Loss: 1.3547566 Test Loss: 0.3806755
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 42 cost time: 1.749605417251587
Epoch: 42, Steps: 52 | Train Loss: 0.4310798 Vali Loss: 1.3465559 Test Loss: 0.3807462
Validation loss decreased (1.349556 --> 1.346556).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 43 cost time: 1.7514538764953613
Epoch: 43, Steps: 52 | Train Loss: 0.4310218 Vali Loss: 1.3410425 Test Loss: 0.3805944
Validation loss decreased (1.346556 --> 1.341043).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 44 cost time: 1.7556657791137695
Epoch: 44, Steps: 52 | Train Loss: 0.4299388 Vali Loss: 1.3523626 Test Loss: 0.3802207
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 45 cost time: 1.7518811225891113
Epoch: 45, Steps: 52 | Train Loss: 0.4306024 Vali Loss: 1.3560510 Test Loss: 0.3797339
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 46 cost time: 1.745412826538086
Epoch: 46, Steps: 52 | Train Loss: 0.4308901 Vali Loss: 1.3560977 Test Loss: 0.3793144
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 47 cost time: 1.7559213638305664
Epoch: 47, Steps: 52 | Train Loss: 0.4307520 Vali Loss: 1.3477888 Test Loss: 0.3802449
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 48 cost time: 1.755058765411377
Epoch: 48, Steps: 52 | Train Loss: 0.4308271 Vali Loss: 1.3520724 Test Loss: 0.3789604
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 49 cost time: 1.7580339908599854
Epoch: 49, Steps: 52 | Train Loss: 0.4310447 Vali Loss: 1.3531702 Test Loss: 0.3795832
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 50 cost time: 1.7570767402648926
Epoch: 50, Steps: 52 | Train Loss: 0.4315988 Vali Loss: 1.3408254 Test Loss: 0.3789916
Validation loss decreased (1.341043 --> 1.340825).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 51 cost time: 1.7504851818084717
Epoch: 51, Steps: 52 | Train Loss: 0.4305021 Vali Loss: 1.3463264 Test Loss: 0.3792831
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 52 cost time: 1.753481149673462
Epoch: 52, Steps: 52 | Train Loss: 0.4306440 Vali Loss: 1.3498583 Test Loss: 0.3795354
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 53 cost time: 1.7484354972839355
Epoch: 53, Steps: 52 | Train Loss: 0.4317640 Vali Loss: 1.3549483 Test Loss: 0.3794697
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 54 cost time: 1.7461471557617188
Epoch: 54, Steps: 52 | Train Loss: 0.4321544 Vali Loss: 1.3513865 Test Loss: 0.3793465
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 55 cost time: 1.7401542663574219
Epoch: 55, Steps: 52 | Train Loss: 0.4313941 Vali Loss: 1.3448415 Test Loss: 0.3791800
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 56 cost time: 1.7525529861450195
Epoch: 56, Steps: 52 | Train Loss: 0.4317827 Vali Loss: 1.3477778 Test Loss: 0.3789283
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 57 cost time: 1.7552285194396973
Epoch: 57, Steps: 52 | Train Loss: 0.4290499 Vali Loss: 1.3526926 Test Loss: 0.3790212
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 58 cost time: 1.7554030418395996
Epoch: 58, Steps: 52 | Train Loss: 0.4303751 Vali Loss: 1.3525171 Test Loss: 0.3791057
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 59 cost time: 1.7496364116668701
Epoch: 59, Steps: 52 | Train Loss: 0.4308773 Vali Loss: 1.3501775 Test Loss: 0.3788118
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 60 cost time: 1.7645413875579834
Epoch: 60, Steps: 52 | Train Loss: 0.4311411 Vali Loss: 1.3535800 Test Loss: 0.3792045
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.37899163365364075, mae:0.4234984815120697, rse:0.5043402314186096
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.03964376449584961 GB
Epoch: 1 cost time: 2.1283326148986816
Epoch: 1, Steps: 52 | Train Loss: 0.9456595 Vali Loss: 2.5522721 Test Loss: 1.7149246
Validation loss decreased (inf --> 2.552272).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 2 cost time: 0.7456231117248535
Epoch: 2, Steps: 52 | Train Loss: 0.8538924 Vali Loss: 2.1128635 Test Loss: 1.2576326
Validation loss decreased (2.552272 --> 2.112864).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 3 cost time: 0.756058931350708
Epoch: 3, Steps: 52 | Train Loss: 0.7185959 Vali Loss: 1.8390088 Test Loss: 0.9482765
Validation loss decreased (2.112864 --> 1.839009).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 4 cost time: 0.7434232234954834
Epoch: 4, Steps: 52 | Train Loss: 0.6261699 Vali Loss: 1.6716481 Test Loss: 0.7410055
Validation loss decreased (1.839009 --> 1.671648).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 5 cost time: 0.7429995536804199
Epoch: 5, Steps: 52 | Train Loss: 0.5742564 Vali Loss: 1.5767736 Test Loss: 0.6248773
Validation loss decreased (1.671648 --> 1.576774).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 6 cost time: 1.6571214199066162
Epoch: 6, Steps: 52 | Train Loss: 0.5433712 Vali Loss: 1.5272760 Test Loss: 0.5566968
Validation loss decreased (1.576774 --> 1.527276).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 7 cost time: 1.6613409519195557
Epoch: 7, Steps: 52 | Train Loss: 0.5201502 Vali Loss: 1.4834468 Test Loss: 0.5119578
Validation loss decreased (1.527276 --> 1.483447).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 8 cost time: 1.6621768474578857
Epoch: 8, Steps: 52 | Train Loss: 0.5064033 Vali Loss: 1.4706628 Test Loss: 0.4891146
Validation loss decreased (1.483447 --> 1.470663).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 9 cost time: 1.6618678569793701
Epoch: 9, Steps: 52 | Train Loss: 0.4987980 Vali Loss: 1.4584138 Test Loss: 0.4691774
Validation loss decreased (1.470663 --> 1.458414).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 10 cost time: 1.6654794216156006
Epoch: 10, Steps: 52 | Train Loss: 0.4931410 Vali Loss: 1.4426363 Test Loss: 0.4558868
Validation loss decreased (1.458414 --> 1.442636).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 11 cost time: 1.665586233139038
Epoch: 11, Steps: 52 | Train Loss: 0.4843154 Vali Loss: 1.4251451 Test Loss: 0.4465916
Validation loss decreased (1.442636 --> 1.425145).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 12 cost time: 1.6679260730743408
Epoch: 12, Steps: 52 | Train Loss: 0.4810804 Vali Loss: 1.4248757 Test Loss: 0.4374544
Validation loss decreased (1.425145 --> 1.424876).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 13 cost time: 1.6625621318817139
Epoch: 13, Steps: 52 | Train Loss: 0.4773183 Vali Loss: 1.4244772 Test Loss: 0.4308723
Validation loss decreased (1.424876 --> 1.424477).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 14 cost time: 1.664443016052246
Epoch: 14, Steps: 52 | Train Loss: 0.4754773 Vali Loss: 1.4140407 Test Loss: 0.4255723
Validation loss decreased (1.424477 --> 1.414041).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 15 cost time: 1.663365125656128
Epoch: 15, Steps: 52 | Train Loss: 0.4716268 Vali Loss: 1.4123787 Test Loss: 0.4204718
Validation loss decreased (1.414041 --> 1.412379).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 16 cost time: 1.667219877243042
Epoch: 16, Steps: 52 | Train Loss: 0.4698394 Vali Loss: 1.4126809 Test Loss: 0.4171507
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 17 cost time: 1.6604230403900146
Epoch: 17, Steps: 52 | Train Loss: 0.4693688 Vali Loss: 1.4058952 Test Loss: 0.4145634
Validation loss decreased (1.412379 --> 1.405895).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 18 cost time: 1.6646175384521484
Epoch: 18, Steps: 52 | Train Loss: 0.4631617 Vali Loss: 1.4071308 Test Loss: 0.4117727
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 19 cost time: 1.661433219909668
Epoch: 19, Steps: 52 | Train Loss: 0.4638064 Vali Loss: 1.3913404 Test Loss: 0.4085622
Validation loss decreased (1.405895 --> 1.391340).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 20 cost time: 1.6674654483795166
Epoch: 20, Steps: 52 | Train Loss: 0.4631838 Vali Loss: 1.3980649 Test Loss: 0.4065304
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 21 cost time: 1.6594030857086182
Epoch: 21, Steps: 52 | Train Loss: 0.4619039 Vali Loss: 1.4014692 Test Loss: 0.4050705
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 22 cost time: 1.6675124168395996
Epoch: 22, Steps: 52 | Train Loss: 0.4629327 Vali Loss: 1.3954470 Test Loss: 0.4033382
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 23 cost time: 1.669215202331543
Epoch: 23, Steps: 52 | Train Loss: 0.4596010 Vali Loss: 1.3896978 Test Loss: 0.4019722
Validation loss decreased (1.391340 --> 1.389698).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 24 cost time: 1.6649441719055176
Epoch: 24, Steps: 52 | Train Loss: 0.4599655 Vali Loss: 1.3889476 Test Loss: 0.4007981
Validation loss decreased (1.389698 --> 1.388948).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 25 cost time: 1.6681668758392334
Epoch: 25, Steps: 52 | Train Loss: 0.4596252 Vali Loss: 1.3937249 Test Loss: 0.3993443
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 26 cost time: 1.6698524951934814
Epoch: 26, Steps: 52 | Train Loss: 0.4586982 Vali Loss: 1.3828375 Test Loss: 0.3988931
Validation loss decreased (1.388948 --> 1.382838).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 27 cost time: 1.6637210845947266
Epoch: 27, Steps: 52 | Train Loss: 0.4585920 Vali Loss: 1.3888716 Test Loss: 0.3976104
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 28 cost time: 1.670569896697998
Epoch: 28, Steps: 52 | Train Loss: 0.4582646 Vali Loss: 1.3880513 Test Loss: 0.3972473
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 29 cost time: 1.657543659210205
Epoch: 29, Steps: 52 | Train Loss: 0.4571965 Vali Loss: 1.3838949 Test Loss: 0.3962618
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 30 cost time: 1.6675419807434082
Epoch: 30, Steps: 52 | Train Loss: 0.4575184 Vali Loss: 1.3875809 Test Loss: 0.3950994
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 31 cost time: 1.6649975776672363
Epoch: 31, Steps: 52 | Train Loss: 0.4562787 Vali Loss: 1.3882642 Test Loss: 0.3946554
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 32 cost time: 1.6674168109893799
Epoch: 32, Steps: 52 | Train Loss: 0.4569983 Vali Loss: 1.3854659 Test Loss: 0.3955505
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 33 cost time: 1.657418966293335
Epoch: 33, Steps: 52 | Train Loss: 0.4567180 Vali Loss: 1.3805001 Test Loss: 0.3940549
Validation loss decreased (1.382838 --> 1.380500).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 34 cost time: 1.6615831851959229
Epoch: 34, Steps: 52 | Train Loss: 0.4545064 Vali Loss: 1.3803154 Test Loss: 0.3937445
Validation loss decreased (1.380500 --> 1.380315).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 35 cost time: 1.6629345417022705
Epoch: 35, Steps: 52 | Train Loss: 0.4549781 Vali Loss: 1.3815653 Test Loss: 0.3932296
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 36 cost time: 1.6645865440368652
Epoch: 36, Steps: 52 | Train Loss: 0.4555130 Vali Loss: 1.3854353 Test Loss: 0.3932591
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 37 cost time: 1.6665382385253906
Epoch: 37, Steps: 52 | Train Loss: 0.4549481 Vali Loss: 1.3818741 Test Loss: 0.3916087
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 38 cost time: 1.6685316562652588
Epoch: 38, Steps: 52 | Train Loss: 0.4556660 Vali Loss: 1.3850365 Test Loss: 0.3910537
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 39 cost time: 1.6642200946807861
Epoch: 39, Steps: 52 | Train Loss: 0.4557131 Vali Loss: 1.3817914 Test Loss: 0.3915533
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 40 cost time: 1.6618876457214355
Epoch: 40, Steps: 52 | Train Loss: 0.4519486 Vali Loss: 1.3752706 Test Loss: 0.3910826
Validation loss decreased (1.380315 --> 1.375271).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 41 cost time: 1.662111520767212
Epoch: 41, Steps: 52 | Train Loss: 0.4548142 Vali Loss: 1.3834276 Test Loss: 0.3916304
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 42 cost time: 1.661116361618042
Epoch: 42, Steps: 52 | Train Loss: 0.4543265 Vali Loss: 1.3854711 Test Loss: 0.3918152
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 43 cost time: 1.6740155220031738
Epoch: 43, Steps: 52 | Train Loss: 0.4518586 Vali Loss: 1.3842759 Test Loss: 0.3903421
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 44 cost time: 1.656245231628418
Epoch: 44, Steps: 52 | Train Loss: 0.4527800 Vali Loss: 1.3756235 Test Loss: 0.3907551
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 45 cost time: 1.655463457107544
Epoch: 45, Steps: 52 | Train Loss: 0.4543911 Vali Loss: 1.3838911 Test Loss: 0.3906236
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 46 cost time: 1.6610846519470215
Epoch: 46, Steps: 52 | Train Loss: 0.4524184 Vali Loss: 1.3801003 Test Loss: 0.3913840
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 47 cost time: 1.6634466648101807
Epoch: 47, Steps: 52 | Train Loss: 0.4523511 Vali Loss: 1.3736773 Test Loss: 0.3890650
Validation loss decreased (1.375271 --> 1.373677).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 48 cost time: 1.6668879985809326
Epoch: 48, Steps: 52 | Train Loss: 0.4531042 Vali Loss: 1.3711140 Test Loss: 0.3898486
Validation loss decreased (1.373677 --> 1.371114).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 49 cost time: 1.6655359268188477
Epoch: 49, Steps: 52 | Train Loss: 0.4527040 Vali Loss: 1.3799543 Test Loss: 0.3901651
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 50 cost time: 1.66703200340271
Epoch: 50, Steps: 52 | Train Loss: 0.4534246 Vali Loss: 1.3796825 Test Loss: 0.3897309
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 51 cost time: 1.666921615600586
Epoch: 51, Steps: 52 | Train Loss: 0.4520645 Vali Loss: 1.3701570 Test Loss: 0.3897195
Validation loss decreased (1.371114 --> 1.370157).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 52 cost time: 1.6594581604003906
Epoch: 52, Steps: 52 | Train Loss: 0.4541872 Vali Loss: 1.3784924 Test Loss: 0.3889148
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 53 cost time: 1.6674656867980957
Epoch: 53, Steps: 52 | Train Loss: 0.4538953 Vali Loss: 1.3843224 Test Loss: 0.3889589
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 54 cost time: 1.6535744667053223
Epoch: 54, Steps: 52 | Train Loss: 0.4545667 Vali Loss: 1.3839563 Test Loss: 0.3900536
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 55 cost time: 1.6678731441497803
Epoch: 55, Steps: 52 | Train Loss: 0.4533407 Vali Loss: 1.3816481 Test Loss: 0.3896188
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 56 cost time: 1.6525030136108398
Epoch: 56, Steps: 52 | Train Loss: 0.4525949 Vali Loss: 1.3707855 Test Loss: 0.3895820
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 57 cost time: 1.6574645042419434
Epoch: 57, Steps: 52 | Train Loss: 0.4519096 Vali Loss: 1.3775768 Test Loss: 0.3894567
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 58 cost time: 1.6598000526428223
Epoch: 58, Steps: 52 | Train Loss: 0.4539977 Vali Loss: 1.3791509 Test Loss: 0.3901748
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 59 cost time: 1.6599645614624023
Epoch: 59, Steps: 52 | Train Loss: 0.4529637 Vali Loss: 1.3830369 Test Loss: 0.3891376
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 60 cost time: 1.658477783203125
Epoch: 60, Steps: 52 | Train Loss: 0.4547097 Vali Loss: 1.3843455 Test Loss: 0.3896775
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.38971951603889465, mae:0.4258245527744293, rse:0.5114284753799438
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.040345191955566406 GB
Epoch: 1 cost time: 2.1514835357666016
Epoch: 1, Steps: 52 | Train Loss: 0.7942404 Vali Loss: 2.3384483 Test Loss: 1.5726968
Validation loss decreased (inf --> 2.338448).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 2 cost time: 0.7753643989562988
Epoch: 2, Steps: 52 | Train Loss: 0.7307656 Vali Loss: 2.0058446 Test Loss: 1.2052355
Validation loss decreased (2.338448 --> 2.005845).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 3 cost time: 0.7741246223449707
Epoch: 3, Steps: 52 | Train Loss: 0.6298834 Vali Loss: 1.7623504 Test Loss: 0.8997153
Validation loss decreased (2.005845 --> 1.762350).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 4 cost time: 0.7686271667480469
Epoch: 4, Steps: 52 | Train Loss: 0.5554570 Vali Loss: 1.5903263 Test Loss: 0.6652577
Validation loss decreased (1.762350 --> 1.590326).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 5 cost time: 0.7770559787750244
Epoch: 5, Steps: 52 | Train Loss: 0.5084720 Vali Loss: 1.5096854 Test Loss: 0.5489873
Validation loss decreased (1.590326 --> 1.509685).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 6 cost time: 1.7319719791412354
Epoch: 6, Steps: 52 | Train Loss: 0.4833873 Vali Loss: 1.4659104 Test Loss: 0.4989260
Validation loss decreased (1.509685 --> 1.465910).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 7 cost time: 1.7225520610809326
Epoch: 7, Steps: 52 | Train Loss: 0.4729214 Vali Loss: 1.4559970 Test Loss: 0.4680131
Validation loss decreased (1.465910 --> 1.455997).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 8 cost time: 1.734914779663086
Epoch: 8, Steps: 52 | Train Loss: 0.4647923 Vali Loss: 1.4321787 Test Loss: 0.4495555
Validation loss decreased (1.455997 --> 1.432179).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 9 cost time: 1.7332656383514404
Epoch: 9, Steps: 52 | Train Loss: 0.4580166 Vali Loss: 1.4206361 Test Loss: 0.4355502
Validation loss decreased (1.432179 --> 1.420636).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 10 cost time: 1.7290170192718506
Epoch: 10, Steps: 52 | Train Loss: 0.4531788 Vali Loss: 1.4123602 Test Loss: 0.4234253
Validation loss decreased (1.420636 --> 1.412360).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 11 cost time: 1.7369332313537598
Epoch: 11, Steps: 52 | Train Loss: 0.4485664 Vali Loss: 1.3959787 Test Loss: 0.4155231
Validation loss decreased (1.412360 --> 1.395979).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 12 cost time: 1.7299296855926514
Epoch: 12, Steps: 52 | Train Loss: 0.4479478 Vali Loss: 1.3959332 Test Loss: 0.4086393
Validation loss decreased (1.395979 --> 1.395933).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 13 cost time: 1.730170726776123
Epoch: 13, Steps: 52 | Train Loss: 0.4445918 Vali Loss: 1.3856012 Test Loss: 0.4037728
Validation loss decreased (1.395933 --> 1.385601).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 14 cost time: 1.7331879138946533
Epoch: 14, Steps: 52 | Train Loss: 0.4405649 Vali Loss: 1.3718538 Test Loss: 0.3975273
Validation loss decreased (1.385601 --> 1.371854).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 15 cost time: 1.7417378425598145
Epoch: 15, Steps: 52 | Train Loss: 0.4408814 Vali Loss: 1.3790367 Test Loss: 0.3940205
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 16 cost time: 1.7260289192199707
Epoch: 16, Steps: 52 | Train Loss: 0.4392659 Vali Loss: 1.3744247 Test Loss: 0.3923236
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 17 cost time: 1.729896068572998
Epoch: 17, Steps: 52 | Train Loss: 0.4394104 Vali Loss: 1.3716639 Test Loss: 0.3892966
Validation loss decreased (1.371854 --> 1.371664).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 18 cost time: 1.7271034717559814
Epoch: 18, Steps: 52 | Train Loss: 0.4379085 Vali Loss: 1.3706355 Test Loss: 0.3867283
Validation loss decreased (1.371664 --> 1.370636).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 19 cost time: 1.7309510707855225
Epoch: 19, Steps: 52 | Train Loss: 0.4362628 Vali Loss: 1.3686335 Test Loss: 0.3850644
Validation loss decreased (1.370636 --> 1.368634).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 20 cost time: 1.721463680267334
Epoch: 20, Steps: 52 | Train Loss: 0.4349584 Vali Loss: 1.3737788 Test Loss: 0.3839377
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 21 cost time: 1.7273075580596924
Epoch: 21, Steps: 52 | Train Loss: 0.4361309 Vali Loss: 1.3673308 Test Loss: 0.3815117
Validation loss decreased (1.368634 --> 1.367331).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 22 cost time: 1.7277367115020752
Epoch: 22, Steps: 52 | Train Loss: 0.4348627 Vali Loss: 1.3574916 Test Loss: 0.3809873
Validation loss decreased (1.367331 --> 1.357492).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 23 cost time: 1.730177879333496
Epoch: 23, Steps: 52 | Train Loss: 0.4333893 Vali Loss: 1.3694265 Test Loss: 0.3796284
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 24 cost time: 1.7308011054992676
Epoch: 24, Steps: 52 | Train Loss: 0.4331893 Vali Loss: 1.3672100 Test Loss: 0.3781795
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 25 cost time: 1.72920823097229
Epoch: 25, Steps: 52 | Train Loss: 0.4333334 Vali Loss: 1.3667814 Test Loss: 0.3777344
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 26 cost time: 1.7186665534973145
Epoch: 26, Steps: 52 | Train Loss: 0.4335736 Vali Loss: 1.3502412 Test Loss: 0.3765901
Validation loss decreased (1.357492 --> 1.350241).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 27 cost time: 1.7247049808502197
Epoch: 27, Steps: 52 | Train Loss: 0.4307192 Vali Loss: 1.3591001 Test Loss: 0.3759903
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 28 cost time: 1.7284185886383057
Epoch: 28, Steps: 52 | Train Loss: 0.4316317 Vali Loss: 1.3598207 Test Loss: 0.3754109
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 29 cost time: 1.7295448780059814
Epoch: 29, Steps: 52 | Train Loss: 0.4321302 Vali Loss: 1.3480893 Test Loss: 0.3739100
Validation loss decreased (1.350241 --> 1.348089).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 30 cost time: 1.7351922988891602
Epoch: 30, Steps: 52 | Train Loss: 0.4323207 Vali Loss: 1.3629988 Test Loss: 0.3745378
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 31 cost time: 1.7289376258850098
Epoch: 31, Steps: 52 | Train Loss: 0.4312224 Vali Loss: 1.3543608 Test Loss: 0.3743083
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 32 cost time: 1.728506326675415
Epoch: 32, Steps: 52 | Train Loss: 0.4306328 Vali Loss: 1.3525202 Test Loss: 0.3732146
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 33 cost time: 1.7287569046020508
Epoch: 33, Steps: 52 | Train Loss: 0.4308508 Vali Loss: 1.3605232 Test Loss: 0.3729036
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 34 cost time: 1.732461929321289
Epoch: 34, Steps: 52 | Train Loss: 0.4298198 Vali Loss: 1.3615859 Test Loss: 0.3727301
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 35 cost time: 1.7285563945770264
Epoch: 35, Steps: 52 | Train Loss: 0.4308703 Vali Loss: 1.3550441 Test Loss: 0.3725372
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 36 cost time: 1.737105131149292
Epoch: 36, Steps: 52 | Train Loss: 0.4306343 Vali Loss: 1.3579149 Test Loss: 0.3721265
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 37 cost time: 1.7291576862335205
Epoch: 37, Steps: 52 | Train Loss: 0.4289643 Vali Loss: 1.3568122 Test Loss: 0.3716170
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 38 cost time: 1.734914779663086
Epoch: 38, Steps: 52 | Train Loss: 0.4295544 Vali Loss: 1.3570004 Test Loss: 0.3714262
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 39 cost time: 1.7226173877716064
Epoch: 39, Steps: 52 | Train Loss: 0.4290477 Vali Loss: 1.3477075 Test Loss: 0.3708452
Validation loss decreased (1.348089 --> 1.347708).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 40 cost time: 1.729710578918457
Epoch: 40, Steps: 52 | Train Loss: 0.4296680 Vali Loss: 1.3513840 Test Loss: 0.3715811
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 41 cost time: 1.7245173454284668
Epoch: 41, Steps: 52 | Train Loss: 0.4278528 Vali Loss: 1.3493798 Test Loss: 0.3708523
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 42 cost time: 1.7208912372589111
Epoch: 42, Steps: 52 | Train Loss: 0.4296487 Vali Loss: 1.3517313 Test Loss: 0.3710679
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 43 cost time: 1.7275609970092773
Epoch: 43, Steps: 52 | Train Loss: 0.4287850 Vali Loss: 1.3522918 Test Loss: 0.3709302
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 44 cost time: 1.7260775566101074
Epoch: 44, Steps: 52 | Train Loss: 0.4282027 Vali Loss: 1.3538854 Test Loss: 0.3709216
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 45 cost time: 1.7279996871948242
Epoch: 45, Steps: 52 | Train Loss: 0.4293254 Vali Loss: 1.3516333 Test Loss: 0.3702115
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 46 cost time: 1.7225570678710938
Epoch: 46, Steps: 52 | Train Loss: 0.4299344 Vali Loss: 1.3528407 Test Loss: 0.3703242
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 47 cost time: 1.7287755012512207
Epoch: 47, Steps: 52 | Train Loss: 0.4297614 Vali Loss: 1.3499360 Test Loss: 0.3699268
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 48 cost time: 1.7224113941192627
Epoch: 48, Steps: 52 | Train Loss: 0.4294990 Vali Loss: 1.3547240 Test Loss: 0.3704385
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 49 cost time: 1.7343053817749023
Epoch: 49, Steps: 52 | Train Loss: 0.4294865 Vali Loss: 1.3521173 Test Loss: 0.3708943
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 50 cost time: 1.7284812927246094
Epoch: 50, Steps: 52 | Train Loss: 0.4287707 Vali Loss: 1.3560983 Test Loss: 0.3703117
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 51 cost time: 1.7305235862731934
Epoch: 51, Steps: 52 | Train Loss: 0.4275774 Vali Loss: 1.3576753 Test Loss: 0.3702261
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 52 cost time: 1.7280027866363525
Epoch: 52, Steps: 52 | Train Loss: 0.4284340 Vali Loss: 1.3537204 Test Loss: 0.3701083
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 53 cost time: 1.7334964275360107
Epoch: 53, Steps: 52 | Train Loss: 0.4289708 Vali Loss: 1.3576909 Test Loss: 0.3695391
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 54 cost time: 1.7291805744171143
Epoch: 54, Steps: 52 | Train Loss: 0.4292444 Vali Loss: 1.3550286 Test Loss: 0.3700627
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 55 cost time: 1.731532096862793
Epoch: 55, Steps: 52 | Train Loss: 0.4291199 Vali Loss: 1.3459264 Test Loss: 0.3700002
Validation loss decreased (1.347708 --> 1.345926).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 56 cost time: 1.741978406906128
Epoch: 56, Steps: 52 | Train Loss: 0.4277968 Vali Loss: 1.3461194 Test Loss: 0.3696578
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 57 cost time: 1.7232394218444824
Epoch: 57, Steps: 52 | Train Loss: 0.4295783 Vali Loss: 1.3556085 Test Loss: 0.3703081
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 58 cost time: 1.7194745540618896
Epoch: 58, Steps: 52 | Train Loss: 0.4289990 Vali Loss: 1.3436258 Test Loss: 0.3696958
Validation loss decreased (1.345926 --> 1.343626).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 59 cost time: 1.7298822402954102
Epoch: 59, Steps: 52 | Train Loss: 0.4296448 Vali Loss: 1.3480072 Test Loss: 0.3700554
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 60 cost time: 1.7249138355255127
Epoch: 60, Steps: 52 | Train Loss: 0.4284704 Vali Loss: 1.3527360 Test Loss: 0.3696853
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.369695782661438, mae:0.41053226590156555, rse:0.4981166422367096
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.0409092903137207 GB
Epoch: 1 cost time: 2.181046724319458
Epoch: 1, Steps: 52 | Train Loss: 0.7067346 Vali Loss: 2.2010522 Test Loss: 1.3438745
Validation loss decreased (inf --> 2.201052).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 2 cost time: 0.7912278175354004
Epoch: 2, Steps: 52 | Train Loss: 0.6639886 Vali Loss: 1.9691705 Test Loss: 1.0779061
Validation loss decreased (2.201052 --> 1.969170).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 3 cost time: 0.79158616065979
Epoch: 3, Steps: 52 | Train Loss: 0.5889651 Vali Loss: 1.7418392 Test Loss: 0.8011502
Validation loss decreased (1.969170 --> 1.741839).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 4 cost time: 0.7930002212524414
Epoch: 4, Steps: 52 | Train Loss: 0.5247930 Vali Loss: 1.5734975 Test Loss: 0.5868077
Validation loss decreased (1.741839 --> 1.573498).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 5 cost time: 0.9520254135131836
Epoch: 5, Steps: 52 | Train Loss: 0.4828999 Vali Loss: 1.4980373 Test Loss: 0.4926473
Validation loss decreased (1.573498 --> 1.498037).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 6 cost time: 1.7812769412994385
Epoch: 6, Steps: 52 | Train Loss: 0.4642918 Vali Loss: 1.4525256 Test Loss: 0.4508659
Validation loss decreased (1.498037 --> 1.452526).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 7 cost time: 1.7665343284606934
Epoch: 7, Steps: 52 | Train Loss: 0.4535810 Vali Loss: 1.4317408 Test Loss: 0.4298596
Validation loss decreased (1.452526 --> 1.431741).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 8 cost time: 1.767672061920166
Epoch: 8, Steps: 52 | Train Loss: 0.4481364 Vali Loss: 1.4103658 Test Loss: 0.4159150
Validation loss decreased (1.431741 --> 1.410366).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 9 cost time: 1.7698287963867188
Epoch: 9, Steps: 52 | Train Loss: 0.4445702 Vali Loss: 1.4017799 Test Loss: 0.4072879
Validation loss decreased (1.410366 --> 1.401780).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 10 cost time: 1.7615680694580078
Epoch: 10, Steps: 52 | Train Loss: 0.4412348 Vali Loss: 1.4008790 Test Loss: 0.4018053
Validation loss decreased (1.401780 --> 1.400879).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 11 cost time: 1.7626657485961914
Epoch: 11, Steps: 52 | Train Loss: 0.4387861 Vali Loss: 1.3942722 Test Loss: 0.3968109
Validation loss decreased (1.400879 --> 1.394272).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 12 cost time: 1.7678890228271484
Epoch: 12, Steps: 52 | Train Loss: 0.4355455 Vali Loss: 1.3893585 Test Loss: 0.3915643
Validation loss decreased (1.394272 --> 1.389359).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 13 cost time: 1.7652404308319092
Epoch: 13, Steps: 52 | Train Loss: 0.4343949 Vali Loss: 1.3719369 Test Loss: 0.3894095
Validation loss decreased (1.389359 --> 1.371937).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 14 cost time: 1.759368658065796
Epoch: 14, Steps: 52 | Train Loss: 0.4299006 Vali Loss: 1.3803208 Test Loss: 0.3864155
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 15 cost time: 1.7741093635559082
Epoch: 15, Steps: 52 | Train Loss: 0.4315839 Vali Loss: 1.3746424 Test Loss: 0.3833263
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 16 cost time: 1.7748022079467773
Epoch: 16, Steps: 52 | Train Loss: 0.4289839 Vali Loss: 1.3730102 Test Loss: 0.3820904
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 17 cost time: 1.7640137672424316
Epoch: 17, Steps: 52 | Train Loss: 0.4267116 Vali Loss: 1.3738582 Test Loss: 0.3791246
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 18 cost time: 1.7703683376312256
Epoch: 18, Steps: 52 | Train Loss: 0.4266861 Vali Loss: 1.3650948 Test Loss: 0.3787869
Validation loss decreased (1.371937 --> 1.365095).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 19 cost time: 1.7614755630493164
Epoch: 19, Steps: 52 | Train Loss: 0.4276733 Vali Loss: 1.3636310 Test Loss: 0.3778564
Validation loss decreased (1.365095 --> 1.363631).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 20 cost time: 1.7616996765136719
Epoch: 20, Steps: 52 | Train Loss: 0.4252474 Vali Loss: 1.3613311 Test Loss: 0.3759028
Validation loss decreased (1.363631 --> 1.361331).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 21 cost time: 1.7604703903198242
Epoch: 21, Steps: 52 | Train Loss: 0.4249506 Vali Loss: 1.3598530 Test Loss: 0.3756727
Validation loss decreased (1.361331 --> 1.359853).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 22 cost time: 1.7621369361877441
Epoch: 22, Steps: 52 | Train Loss: 0.4266012 Vali Loss: 1.3632865 Test Loss: 0.3749221
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 23 cost time: 1.7689285278320312
Epoch: 23, Steps: 52 | Train Loss: 0.4255706 Vali Loss: 1.3584988 Test Loss: 0.3744224
Validation loss decreased (1.359853 --> 1.358499).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 24 cost time: 1.7635095119476318
Epoch: 24, Steps: 52 | Train Loss: 0.4244616 Vali Loss: 1.3545310 Test Loss: 0.3732772
Validation loss decreased (1.358499 --> 1.354531).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 25 cost time: 1.7670679092407227
Epoch: 25, Steps: 52 | Train Loss: 0.4232783 Vali Loss: 1.3570209 Test Loss: 0.3730826
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 26 cost time: 1.7625346183776855
Epoch: 26, Steps: 52 | Train Loss: 0.4252725 Vali Loss: 1.3468674 Test Loss: 0.3725131
Validation loss decreased (1.354531 --> 1.346867).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 27 cost time: 1.7654979228973389
Epoch: 27, Steps: 52 | Train Loss: 0.4236618 Vali Loss: 1.3502116 Test Loss: 0.3721904
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 28 cost time: 1.7704472541809082
Epoch: 28, Steps: 52 | Train Loss: 0.4237026 Vali Loss: 1.3588314 Test Loss: 0.3717358
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 29 cost time: 1.7628302574157715
Epoch: 29, Steps: 52 | Train Loss: 0.4213441 Vali Loss: 1.3544674 Test Loss: 0.3719692
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 30 cost time: 1.7640366554260254
Epoch: 30, Steps: 52 | Train Loss: 0.4233090 Vali Loss: 1.3541169 Test Loss: 0.3712003
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 31 cost time: 1.7664663791656494
Epoch: 31, Steps: 52 | Train Loss: 0.4228018 Vali Loss: 1.3601351 Test Loss: 0.3712015
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 32 cost time: 1.7646880149841309
Epoch: 32, Steps: 52 | Train Loss: 0.4235305 Vali Loss: 1.3550135 Test Loss: 0.3709288
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 33 cost time: 1.7622580528259277
Epoch: 33, Steps: 52 | Train Loss: 0.4239142 Vali Loss: 1.3572878 Test Loss: 0.3703774
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 34 cost time: 1.7651431560516357
Epoch: 34, Steps: 52 | Train Loss: 0.4225082 Vali Loss: 1.3603797 Test Loss: 0.3711506
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 35 cost time: 1.7649927139282227
Epoch: 35, Steps: 52 | Train Loss: 0.4215492 Vali Loss: 1.3560903 Test Loss: 0.3702261
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 36 cost time: 1.7689728736877441
Epoch: 36, Steps: 52 | Train Loss: 0.4213934 Vali Loss: 1.3565899 Test Loss: 0.3697802
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 37 cost time: 1.7716104984283447
Epoch: 37, Steps: 52 | Train Loss: 0.4228095 Vali Loss: 1.3509171 Test Loss: 0.3700213
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 38 cost time: 1.7585132122039795
Epoch: 38, Steps: 52 | Train Loss: 0.4214721 Vali Loss: 1.3496408 Test Loss: 0.3694950
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 39 cost time: 1.7655773162841797
Epoch: 39, Steps: 52 | Train Loss: 0.4217798 Vali Loss: 1.3520892 Test Loss: 0.3699448
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 40 cost time: 1.7712244987487793
Epoch: 40, Steps: 52 | Train Loss: 0.4201348 Vali Loss: 1.3588266 Test Loss: 0.3697243
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 41 cost time: 1.767331600189209
Epoch: 41, Steps: 52 | Train Loss: 0.4233380 Vali Loss: 1.3535174 Test Loss: 0.3692575
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 42 cost time: 1.7666211128234863
Epoch: 42, Steps: 52 | Train Loss: 0.4214124 Vali Loss: 1.3556131 Test Loss: 0.3696550
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 43 cost time: 1.7607381343841553
Epoch: 43, Steps: 52 | Train Loss: 0.4212552 Vali Loss: 1.3568504 Test Loss: 0.3696306
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 44 cost time: 1.7696423530578613
Epoch: 44, Steps: 52 | Train Loss: 0.4231240 Vali Loss: 1.3537607 Test Loss: 0.3705466
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 45 cost time: 1.7650513648986816
Epoch: 45, Steps: 52 | Train Loss: 0.4213035 Vali Loss: 1.3496430 Test Loss: 0.3692939
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 46 cost time: 1.779547929763794
Epoch: 46, Steps: 52 | Train Loss: 0.4216640 Vali Loss: 1.3536212 Test Loss: 0.3690262
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 47 cost time: 1.763507604598999
Epoch: 47, Steps: 52 | Train Loss: 0.4206895 Vali Loss: 1.3485961 Test Loss: 0.3688824
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 48 cost time: 1.7617864608764648
Epoch: 48, Steps: 52 | Train Loss: 0.4224906 Vali Loss: 1.3537929 Test Loss: 0.3694533
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 49 cost time: 1.7644672393798828
Epoch: 49, Steps: 52 | Train Loss: 0.4201968 Vali Loss: 1.3563092 Test Loss: 0.3696248
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 50 cost time: 1.7674987316131592
Epoch: 50, Steps: 52 | Train Loss: 0.4222645 Vali Loss: 1.3550138 Test Loss: 0.3685088
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 51 cost time: 1.7725963592529297
Epoch: 51, Steps: 52 | Train Loss: 0.4199355 Vali Loss: 1.3452908 Test Loss: 0.3686827
Validation loss decreased (1.346867 --> 1.345291).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 52 cost time: 1.7648537158966064
Epoch: 52, Steps: 52 | Train Loss: 0.4196152 Vali Loss: 1.3440417 Test Loss: 0.3693771
Validation loss decreased (1.345291 --> 1.344042).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 53 cost time: 1.7619307041168213
Epoch: 53, Steps: 52 | Train Loss: 0.4223738 Vali Loss: 1.3480599 Test Loss: 0.3683049
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 54 cost time: 1.7653765678405762
Epoch: 54, Steps: 52 | Train Loss: 0.4215962 Vali Loss: 1.3433102 Test Loss: 0.3693838
Validation loss decreased (1.344042 --> 1.343310).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 55 cost time: 1.7657129764556885
Epoch: 55, Steps: 52 | Train Loss: 0.4214160 Vali Loss: 1.3512111 Test Loss: 0.3689488
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 56 cost time: 1.7652833461761475
Epoch: 56, Steps: 52 | Train Loss: 0.4213386 Vali Loss: 1.3455603 Test Loss: 0.3689588
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 57 cost time: 1.766815185546875
Epoch: 57, Steps: 52 | Train Loss: 0.4205352 Vali Loss: 1.3564944 Test Loss: 0.3686200
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 58 cost time: 1.7618627548217773
Epoch: 58, Steps: 52 | Train Loss: 0.4216729 Vali Loss: 1.3470985 Test Loss: 0.3689008
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 59 cost time: 1.7706115245819092
Epoch: 59, Steps: 52 | Train Loss: 0.4220944 Vali Loss: 1.3469412 Test Loss: 0.3689671
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 60 cost time: 1.7611851692199707
Epoch: 60, Steps: 52 | Train Loss: 0.4221699 Vali Loss: 1.3545244 Test Loss: 0.3681931
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3693837821483612, mae:0.413065105676651, rse:0.4979063868522644
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.039804935455322266 GB
Epoch: 1 cost time: 2.14772891998291
Epoch: 1, Steps: 52 | Train Loss: 0.9682973 Vali Loss: 2.6185405 Test Loss: 1.8339770
Validation loss decreased (inf --> 2.618541).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 2 cost time: 0.7624588012695312
Epoch: 2, Steps: 52 | Train Loss: 0.8656751 Vali Loss: 2.1480083 Test Loss: 1.3371289
Validation loss decreased (2.618541 --> 2.148008).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 3 cost time: 0.7682361602783203
Epoch: 3, Steps: 52 | Train Loss: 0.7292458 Vali Loss: 1.8870262 Test Loss: 1.0347409
Validation loss decreased (2.148008 --> 1.887026).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 4 cost time: 0.7760000228881836
Epoch: 4, Steps: 52 | Train Loss: 0.6441298 Vali Loss: 1.7315288 Test Loss: 0.8315846
Validation loss decreased (1.887026 --> 1.731529).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 5 cost time: 0.7464263439178467
Epoch: 5, Steps: 52 | Train Loss: 0.5945943 Vali Loss: 1.6264824 Test Loss: 0.7006246
Validation loss decreased (1.731529 --> 1.626482).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 6 cost time: 1.6775362491607666
Epoch: 6, Steps: 52 | Train Loss: 0.5585801 Vali Loss: 1.5557956 Test Loss: 0.6146834
Validation loss decreased (1.626482 --> 1.555796).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 7 cost time: 1.6902375221252441
Epoch: 7, Steps: 52 | Train Loss: 0.5330387 Vali Loss: 1.5190861 Test Loss: 0.5570742
Validation loss decreased (1.555796 --> 1.519086).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 8 cost time: 1.6816275119781494
Epoch: 8, Steps: 52 | Train Loss: 0.5146006 Vali Loss: 1.4943087 Test Loss: 0.5138850
Validation loss decreased (1.519086 --> 1.494309).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 9 cost time: 1.6830337047576904
Epoch: 9, Steps: 52 | Train Loss: 0.5053518 Vali Loss: 1.4670269 Test Loss: 0.4863506
Validation loss decreased (1.494309 --> 1.467027).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 10 cost time: 1.6779403686523438
Epoch: 10, Steps: 52 | Train Loss: 0.4934122 Vali Loss: 1.4521532 Test Loss: 0.4625863
Validation loss decreased (1.467027 --> 1.452153).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 11 cost time: 1.685692310333252
Epoch: 11, Steps: 52 | Train Loss: 0.4897023 Vali Loss: 1.4336610 Test Loss: 0.4464138
Validation loss decreased (1.452153 --> 1.433661).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 12 cost time: 1.6760101318359375
Epoch: 12, Steps: 52 | Train Loss: 0.4810366 Vali Loss: 1.4309919 Test Loss: 0.4345344
Validation loss decreased (1.433661 --> 1.430992).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 13 cost time: 1.6875300407409668
Epoch: 13, Steps: 52 | Train Loss: 0.4764637 Vali Loss: 1.4245594 Test Loss: 0.4243267
Validation loss decreased (1.430992 --> 1.424559).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 14 cost time: 1.6759376525878906
Epoch: 14, Steps: 52 | Train Loss: 0.4730875 Vali Loss: 1.4183896 Test Loss: 0.4178288
Validation loss decreased (1.424559 --> 1.418390).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 15 cost time: 1.6746110916137695
Epoch: 15, Steps: 52 | Train Loss: 0.4715306 Vali Loss: 1.4118209 Test Loss: 0.4106501
Validation loss decreased (1.418390 --> 1.411821).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 16 cost time: 1.6723005771636963
Epoch: 16, Steps: 52 | Train Loss: 0.4687782 Vali Loss: 1.4096818 Test Loss: 0.4045499
Validation loss decreased (1.411821 --> 1.409682).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 17 cost time: 1.6834197044372559
Epoch: 17, Steps: 52 | Train Loss: 0.4673407 Vali Loss: 1.4012489 Test Loss: 0.4001620
Validation loss decreased (1.409682 --> 1.401249).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 18 cost time: 1.6805651187896729
Epoch: 18, Steps: 52 | Train Loss: 0.4655730 Vali Loss: 1.3989828 Test Loss: 0.3958458
Validation loss decreased (1.401249 --> 1.398983).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 19 cost time: 1.681992769241333
Epoch: 19, Steps: 52 | Train Loss: 0.4634500 Vali Loss: 1.3964014 Test Loss: 0.3934823
Validation loss decreased (1.398983 --> 1.396401).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 20 cost time: 1.689587116241455
Epoch: 20, Steps: 52 | Train Loss: 0.4629850 Vali Loss: 1.3978280 Test Loss: 0.3917049
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 21 cost time: 1.679657220840454
Epoch: 21, Steps: 52 | Train Loss: 0.4596395 Vali Loss: 1.3853295 Test Loss: 0.3890119
Validation loss decreased (1.396401 --> 1.385329).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 22 cost time: 1.6783666610717773
Epoch: 22, Steps: 52 | Train Loss: 0.4603475 Vali Loss: 1.3866796 Test Loss: 0.3879779
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 23 cost time: 1.6732404232025146
Epoch: 23, Steps: 52 | Train Loss: 0.4578171 Vali Loss: 1.3851941 Test Loss: 0.3855840
Validation loss decreased (1.385329 --> 1.385194).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 24 cost time: 1.682246446609497
Epoch: 24, Steps: 52 | Train Loss: 0.4578709 Vali Loss: 1.3860419 Test Loss: 0.3835640
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 25 cost time: 1.6804192066192627
Epoch: 25, Steps: 52 | Train Loss: 0.4569842 Vali Loss: 1.3885196 Test Loss: 0.3819936
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 26 cost time: 1.6790125370025635
Epoch: 26, Steps: 52 | Train Loss: 0.4574206 Vali Loss: 1.3769770 Test Loss: 0.3801345
Validation loss decreased (1.385194 --> 1.376977).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 27 cost time: 1.6804146766662598
Epoch: 27, Steps: 52 | Train Loss: 0.4538162 Vali Loss: 1.3853667 Test Loss: 0.3800797
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 28 cost time: 1.6781044006347656
Epoch: 28, Steps: 52 | Train Loss: 0.4558423 Vali Loss: 1.3798956 Test Loss: 0.3796197
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 29 cost time: 1.6788995265960693
Epoch: 29, Steps: 52 | Train Loss: 0.4539571 Vali Loss: 1.3762918 Test Loss: 0.3777063
Validation loss decreased (1.376977 --> 1.376292).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 30 cost time: 1.6860201358795166
Epoch: 30, Steps: 52 | Train Loss: 0.4550178 Vali Loss: 1.3840766 Test Loss: 0.3764059
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 31 cost time: 1.6846423149108887
Epoch: 31, Steps: 52 | Train Loss: 0.4537074 Vali Loss: 1.3806231 Test Loss: 0.3777972
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 32 cost time: 1.6851112842559814
Epoch: 32, Steps: 52 | Train Loss: 0.4552886 Vali Loss: 1.3773737 Test Loss: 0.3770909
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 33 cost time: 1.6772325038909912
Epoch: 33, Steps: 52 | Train Loss: 0.4522822 Vali Loss: 1.3784980 Test Loss: 0.3760151
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 34 cost time: 1.6810662746429443
Epoch: 34, Steps: 52 | Train Loss: 0.4520962 Vali Loss: 1.3772990 Test Loss: 0.3755047
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 35 cost time: 1.6824748516082764
Epoch: 35, Steps: 52 | Train Loss: 0.4525349 Vali Loss: 1.3796351 Test Loss: 0.3764006
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 36 cost time: 1.6778874397277832
Epoch: 36, Steps: 52 | Train Loss: 0.4545261 Vali Loss: 1.3764560 Test Loss: 0.3748451
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 37 cost time: 1.6815359592437744
Epoch: 37, Steps: 52 | Train Loss: 0.4528412 Vali Loss: 1.3702654 Test Loss: 0.3738582
Validation loss decreased (1.376292 --> 1.370265).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 38 cost time: 1.6826305389404297
Epoch: 38, Steps: 52 | Train Loss: 0.4511053 Vali Loss: 1.3740089 Test Loss: 0.3731269
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 39 cost time: 1.6804211139678955
Epoch: 39, Steps: 52 | Train Loss: 0.4526882 Vali Loss: 1.3805850 Test Loss: 0.3735010
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 40 cost time: 1.6836113929748535
Epoch: 40, Steps: 52 | Train Loss: 0.4539322 Vali Loss: 1.3765361 Test Loss: 0.3737108
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 41 cost time: 1.6823747158050537
Epoch: 41, Steps: 52 | Train Loss: 0.4524147 Vali Loss: 1.3673882 Test Loss: 0.3737549
Validation loss decreased (1.370265 --> 1.367388).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 42 cost time: 1.6733908653259277
Epoch: 42, Steps: 52 | Train Loss: 0.4514532 Vali Loss: 1.3761840 Test Loss: 0.3724747
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 43 cost time: 1.6785345077514648
Epoch: 43, Steps: 52 | Train Loss: 0.4523632 Vali Loss: 1.3738029 Test Loss: 0.3726844
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 44 cost time: 1.6785624027252197
Epoch: 44, Steps: 52 | Train Loss: 0.4515473 Vali Loss: 1.3760052 Test Loss: 0.3716986
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 45 cost time: 1.677499532699585
Epoch: 45, Steps: 52 | Train Loss: 0.4508258 Vali Loss: 1.3696780 Test Loss: 0.3728518
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 46 cost time: 1.6793651580810547
Epoch: 46, Steps: 52 | Train Loss: 0.4514907 Vali Loss: 1.3700385 Test Loss: 0.3723949
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 47 cost time: 1.6773838996887207
Epoch: 47, Steps: 52 | Train Loss: 0.4517267 Vali Loss: 1.3781509 Test Loss: 0.3716591
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 48 cost time: 1.6800274848937988
Epoch: 48, Steps: 52 | Train Loss: 0.4505116 Vali Loss: 1.3731127 Test Loss: 0.3721654
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 49 cost time: 1.685469388961792
Epoch: 49, Steps: 52 | Train Loss: 0.4513518 Vali Loss: 1.3725930 Test Loss: 0.3717781
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 50 cost time: 1.668783187866211
Epoch: 50, Steps: 52 | Train Loss: 0.4532170 Vali Loss: 1.3769825 Test Loss: 0.3715945
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 51 cost time: 1.6824219226837158
Epoch: 51, Steps: 52 | Train Loss: 0.4500994 Vali Loss: 1.3659694 Test Loss: 0.3705841
Validation loss decreased (1.367388 --> 1.365969).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 52 cost time: 1.6823933124542236
Epoch: 52, Steps: 52 | Train Loss: 0.4528180 Vali Loss: 1.3787148 Test Loss: 0.3719268
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 53 cost time: 1.6810109615325928
Epoch: 53, Steps: 52 | Train Loss: 0.4512256 Vali Loss: 1.3741112 Test Loss: 0.3713305
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 54 cost time: 1.6820080280303955
Epoch: 54, Steps: 52 | Train Loss: 0.4505460 Vali Loss: 1.3727660 Test Loss: 0.3709313
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 55 cost time: 1.6840322017669678
Epoch: 55, Steps: 52 | Train Loss: 0.4501417 Vali Loss: 1.3760926 Test Loss: 0.3715026
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 56 cost time: 1.6704137325286865
Epoch: 56, Steps: 52 | Train Loss: 0.4512617 Vali Loss: 1.3687003 Test Loss: 0.3709983
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 57 cost time: 1.678912878036499
Epoch: 57, Steps: 52 | Train Loss: 0.4496976 Vali Loss: 1.3721306 Test Loss: 0.3715280
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 58 cost time: 1.6780385971069336
Epoch: 58, Steps: 52 | Train Loss: 0.4497475 Vali Loss: 1.3776550 Test Loss: 0.3726299
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 59 cost time: 1.6735963821411133
Epoch: 59, Steps: 52 | Train Loss: 0.4509265 Vali Loss: 1.3717308 Test Loss: 0.3708656
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 60 cost time: 1.6772651672363281
Epoch: 60, Steps: 52 | Train Loss: 0.4511819 Vali Loss: 1.3714226 Test Loss: 0.3722586
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.370584100484848, mae:0.40700891613960266, rse:0.49871471524238586
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04050636291503906 GB
Epoch: 1 cost time: 2.1821792125701904
Epoch: 1, Steps: 52 | Train Loss: 0.7683042 Vali Loss: 2.2016146 Test Loss: 1.4674960
Validation loss decreased (inf --> 2.201615).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 2 cost time: 0.7790474891662598
Epoch: 2, Steps: 52 | Train Loss: 0.7034227 Vali Loss: 1.9064345 Test Loss: 1.1005380
Validation loss decreased (2.201615 --> 1.906435).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 3 cost time: 0.7887859344482422
Epoch: 3, Steps: 52 | Train Loss: 0.6059651 Vali Loss: 1.6693742 Test Loss: 0.7908940
Validation loss decreased (1.906435 --> 1.669374).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 4 cost time: 0.790388822555542
Epoch: 4, Steps: 52 | Train Loss: 0.5333268 Vali Loss: 1.5199279 Test Loss: 0.5778619
Validation loss decreased (1.669374 --> 1.519928).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 5 cost time: 0.8514206409454346
Epoch: 5, Steps: 52 | Train Loss: 0.4936025 Vali Loss: 1.4599724 Test Loss: 0.4906808
Validation loss decreased (1.519928 --> 1.459972).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 6 cost time: 1.750046968460083
Epoch: 6, Steps: 52 | Train Loss: 0.4748622 Vali Loss: 1.4261446 Test Loss: 0.4564512
Validation loss decreased (1.459972 --> 1.426145).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 7 cost time: 1.7432291507720947
Epoch: 7, Steps: 52 | Train Loss: 0.4659728 Vali Loss: 1.4165416 Test Loss: 0.4362998
Validation loss decreased (1.426145 --> 1.416542).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 8 cost time: 1.7518138885498047
Epoch: 8, Steps: 52 | Train Loss: 0.4576548 Vali Loss: 1.4004858 Test Loss: 0.4237333
Validation loss decreased (1.416542 --> 1.400486).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 9 cost time: 1.7403736114501953
Epoch: 9, Steps: 52 | Train Loss: 0.4544552 Vali Loss: 1.3960930 Test Loss: 0.4132948
Validation loss decreased (1.400486 --> 1.396093).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 10 cost time: 1.7635467052459717
Epoch: 10, Steps: 52 | Train Loss: 0.4482045 Vali Loss: 1.3796065 Test Loss: 0.4047806
Validation loss decreased (1.396093 --> 1.379606).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 11 cost time: 1.754953145980835
Epoch: 11, Steps: 52 | Train Loss: 0.4450089 Vali Loss: 1.3748602 Test Loss: 0.4004020
Validation loss decreased (1.379606 --> 1.374860).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 12 cost time: 1.7492802143096924
Epoch: 12, Steps: 52 | Train Loss: 0.4454731 Vali Loss: 1.3735373 Test Loss: 0.3942443
Validation loss decreased (1.374860 --> 1.373537).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 13 cost time: 1.749448537826538
Epoch: 13, Steps: 52 | Train Loss: 0.4422674 Vali Loss: 1.3780093 Test Loss: 0.3888521
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 14 cost time: 1.7548222541809082
Epoch: 14, Steps: 52 | Train Loss: 0.4395786 Vali Loss: 1.3697691 Test Loss: 0.3856696
Validation loss decreased (1.373537 --> 1.369769).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 15 cost time: 1.7484591007232666
Epoch: 15, Steps: 52 | Train Loss: 0.4363253 Vali Loss: 1.3696012 Test Loss: 0.3833963
Validation loss decreased (1.369769 --> 1.369601).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 16 cost time: 1.7469825744628906
Epoch: 16, Steps: 52 | Train Loss: 0.4368203 Vali Loss: 1.3650069 Test Loss: 0.3807656
Validation loss decreased (1.369601 --> 1.365007).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 17 cost time: 1.7524960041046143
Epoch: 17, Steps: 52 | Train Loss: 0.4373041 Vali Loss: 1.3560158 Test Loss: 0.3786151
Validation loss decreased (1.365007 --> 1.356016).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 18 cost time: 1.7514135837554932
Epoch: 18, Steps: 52 | Train Loss: 0.4358065 Vali Loss: 1.3627698 Test Loss: 0.3771625
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 19 cost time: 1.7523729801177979
Epoch: 19, Steps: 52 | Train Loss: 0.4346610 Vali Loss: 1.3493896 Test Loss: 0.3756551
Validation loss decreased (1.356016 --> 1.349390).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 20 cost time: 1.758580207824707
Epoch: 20, Steps: 52 | Train Loss: 0.4344052 Vali Loss: 1.3547149 Test Loss: 0.3747085
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 21 cost time: 1.7455618381500244
Epoch: 21, Steps: 52 | Train Loss: 0.4313722 Vali Loss: 1.3579755 Test Loss: 0.3729413
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 22 cost time: 1.7504479885101318
Epoch: 22, Steps: 52 | Train Loss: 0.4320204 Vali Loss: 1.3532205 Test Loss: 0.3716092
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 23 cost time: 1.7473962306976318
Epoch: 23, Steps: 52 | Train Loss: 0.4292686 Vali Loss: 1.3561425 Test Loss: 0.3712217
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 24 cost time: 1.7506992816925049
Epoch: 24, Steps: 52 | Train Loss: 0.4312477 Vali Loss: 1.3499818 Test Loss: 0.3700127
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 25 cost time: 1.7492432594299316
Epoch: 25, Steps: 52 | Train Loss: 0.4306080 Vali Loss: 1.3504832 Test Loss: 0.3703039
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 26 cost time: 1.7491416931152344
Epoch: 26, Steps: 52 | Train Loss: 0.4290711 Vali Loss: 1.3521266 Test Loss: 0.3691044
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 27 cost time: 1.7504496574401855
Epoch: 27, Steps: 52 | Train Loss: 0.4298523 Vali Loss: 1.3549979 Test Loss: 0.3688405
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 28 cost time: 1.7488434314727783
Epoch: 28, Steps: 52 | Train Loss: 0.4291576 Vali Loss: 1.3501322 Test Loss: 0.3678941
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 29 cost time: 1.7608530521392822
Epoch: 29, Steps: 52 | Train Loss: 0.4283228 Vali Loss: 1.3418839 Test Loss: 0.3676277
Validation loss decreased (1.349390 --> 1.341884).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 30 cost time: 1.7604119777679443
Epoch: 30, Steps: 52 | Train Loss: 0.4289102 Vali Loss: 1.3438052 Test Loss: 0.3669225
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 31 cost time: 1.748077630996704
Epoch: 31, Steps: 52 | Train Loss: 0.4288111 Vali Loss: 1.3468719 Test Loss: 0.3660634
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 32 cost time: 1.7451410293579102
Epoch: 32, Steps: 52 | Train Loss: 0.4306088 Vali Loss: 1.3422700 Test Loss: 0.3663861
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 33 cost time: 1.7555420398712158
Epoch: 33, Steps: 52 | Train Loss: 0.4276368 Vali Loss: 1.3486702 Test Loss: 0.3660799
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 34 cost time: 1.7563624382019043
Epoch: 34, Steps: 52 | Train Loss: 0.4292898 Vali Loss: 1.3478687 Test Loss: 0.3656571
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 35 cost time: 1.7560670375823975
Epoch: 35, Steps: 52 | Train Loss: 0.4276875 Vali Loss: 1.3533187 Test Loss: 0.3650542
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 36 cost time: 1.7572083473205566
Epoch: 36, Steps: 52 | Train Loss: 0.4291118 Vali Loss: 1.3535910 Test Loss: 0.3656578
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 37 cost time: 1.7635276317596436
Epoch: 37, Steps: 52 | Train Loss: 0.4285086 Vali Loss: 1.3408592 Test Loss: 0.3649897
Validation loss decreased (1.341884 --> 1.340859).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 38 cost time: 1.7515485286712646
Epoch: 38, Steps: 52 | Train Loss: 0.4273820 Vali Loss: 1.3473570 Test Loss: 0.3651142
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 39 cost time: 1.752713680267334
Epoch: 39, Steps: 52 | Train Loss: 0.4273553 Vali Loss: 1.3520311 Test Loss: 0.3650216
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 40 cost time: 1.7544727325439453
Epoch: 40, Steps: 52 | Train Loss: 0.4278716 Vali Loss: 1.3441923 Test Loss: 0.3651693
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 41 cost time: 1.7532234191894531
Epoch: 41, Steps: 52 | Train Loss: 0.4276595 Vali Loss: 1.3443999 Test Loss: 0.3644319
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 42 cost time: 1.7473812103271484
Epoch: 42, Steps: 52 | Train Loss: 0.4270636 Vali Loss: 1.3425535 Test Loss: 0.3651350
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 43 cost time: 1.7524712085723877
Epoch: 43, Steps: 52 | Train Loss: 0.4270033 Vali Loss: 1.3437626 Test Loss: 0.3645212
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 44 cost time: 1.7475013732910156
Epoch: 44, Steps: 52 | Train Loss: 0.4268758 Vali Loss: 1.3509579 Test Loss: 0.3642875
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 45 cost time: 1.7446401119232178
Epoch: 45, Steps: 52 | Train Loss: 0.4271012 Vali Loss: 1.3496926 Test Loss: 0.3641866
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 46 cost time: 1.753485918045044
Epoch: 46, Steps: 52 | Train Loss: 0.4268655 Vali Loss: 1.3470720 Test Loss: 0.3641738
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 47 cost time: 1.755481481552124
Epoch: 47, Steps: 52 | Train Loss: 0.4272204 Vali Loss: 1.3437948 Test Loss: 0.3639725
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 48 cost time: 1.760420560836792
Epoch: 48, Steps: 52 | Train Loss: 0.4269286 Vali Loss: 1.3464491 Test Loss: 0.3642049
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 49 cost time: 1.7526230812072754
Epoch: 49, Steps: 52 | Train Loss: 0.4283944 Vali Loss: 1.3410143 Test Loss: 0.3641116
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 50 cost time: 1.7575228214263916
Epoch: 50, Steps: 52 | Train Loss: 0.4254189 Vali Loss: 1.3496959 Test Loss: 0.3643807
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 51 cost time: 1.7426378726959229
Epoch: 51, Steps: 52 | Train Loss: 0.4267155 Vali Loss: 1.3365154 Test Loss: 0.3637429
Validation loss decreased (1.340859 --> 1.336515).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 52 cost time: 1.7583198547363281
Epoch: 52, Steps: 52 | Train Loss: 0.4259405 Vali Loss: 1.3444390 Test Loss: 0.3645112
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 53 cost time: 1.740462303161621
Epoch: 53, Steps: 52 | Train Loss: 0.4260111 Vali Loss: 1.3441955 Test Loss: 0.3636939
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 54 cost time: 1.7548754215240479
Epoch: 54, Steps: 52 | Train Loss: 0.4274004 Vali Loss: 1.3457350 Test Loss: 0.3641515
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 55 cost time: 1.747140884399414
Epoch: 55, Steps: 52 | Train Loss: 0.4279839 Vali Loss: 1.3416213 Test Loss: 0.3636030
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 56 cost time: 1.7490878105163574
Epoch: 56, Steps: 52 | Train Loss: 0.4269062 Vali Loss: 1.3369278 Test Loss: 0.3634235
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 57 cost time: 1.7495946884155273
Epoch: 57, Steps: 52 | Train Loss: 0.4291447 Vali Loss: 1.3490819 Test Loss: 0.3640738
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 58 cost time: 1.7540082931518555
Epoch: 58, Steps: 52 | Train Loss: 0.4273306 Vali Loss: 1.3454930 Test Loss: 0.3636037
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 59 cost time: 1.7552049160003662
Epoch: 59, Steps: 52 | Train Loss: 0.4285713 Vali Loss: 1.3380597 Test Loss: 0.3636396
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 60 cost time: 1.746042013168335
Epoch: 60, Steps: 52 | Train Loss: 0.4265099 Vali Loss: 1.3401431 Test Loss: 0.3635722
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3637429177761078, mae:0.404237300157547, rse:0.4940900206565857
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04107046127319336 GB
Epoch: 1 cost time: 2.189861297607422
Epoch: 1, Steps: 52 | Train Loss: 0.7230106 Vali Loss: 2.1912541 Test Loss: 1.4554552
Validation loss decreased (inf --> 2.191254).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 2 cost time: 0.7936177253723145
Epoch: 2, Steps: 52 | Train Loss: 0.6723600 Vali Loss: 1.9196641 Test Loss: 1.1290455
Validation loss decreased (2.191254 --> 1.919664).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 3 cost time: 0.7933740615844727
Epoch: 3, Steps: 52 | Train Loss: 0.5851859 Vali Loss: 1.6598454 Test Loss: 0.7975761
Validation loss decreased (1.919664 --> 1.659845).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 4 cost time: 0.7929222583770752
Epoch: 4, Steps: 52 | Train Loss: 0.5088156 Vali Loss: 1.4941561 Test Loss: 0.5484500
Validation loss decreased (1.659845 --> 1.494156).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 5 cost time: 1.0052664279937744
Epoch: 5, Steps: 52 | Train Loss: 0.4706512 Vali Loss: 1.4328506 Test Loss: 0.4640777
Validation loss decreased (1.494156 --> 1.432851).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 6 cost time: 1.7841124534606934
Epoch: 6, Steps: 52 | Train Loss: 0.4582222 Vali Loss: 1.4098022 Test Loss: 0.4357396
Validation loss decreased (1.432851 --> 1.409802).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 7 cost time: 1.7840678691864014
Epoch: 7, Steps: 52 | Train Loss: 0.4492949 Vali Loss: 1.4012351 Test Loss: 0.4176348
Validation loss decreased (1.409802 --> 1.401235).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 8 cost time: 1.789400339126587
Epoch: 8, Steps: 52 | Train Loss: 0.4447562 Vali Loss: 1.3878212 Test Loss: 0.4098798
Validation loss decreased (1.401235 --> 1.387821).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 9 cost time: 1.7866661548614502
Epoch: 9, Steps: 52 | Train Loss: 0.4390531 Vali Loss: 1.3767478 Test Loss: 0.3986419
Validation loss decreased (1.387821 --> 1.376748).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 10 cost time: 1.783334732055664
Epoch: 10, Steps: 52 | Train Loss: 0.4399351 Vali Loss: 1.3753004 Test Loss: 0.3922833
Validation loss decreased (1.376748 --> 1.375300).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 11 cost time: 1.7916781902313232
Epoch: 11, Steps: 52 | Train Loss: 0.4356213 Vali Loss: 1.3631499 Test Loss: 0.3872251
Validation loss decreased (1.375300 --> 1.363150).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 12 cost time: 1.7779567241668701
Epoch: 12, Steps: 52 | Train Loss: 0.4346797 Vali Loss: 1.3658721 Test Loss: 0.3834506
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 13 cost time: 1.781306266784668
Epoch: 13, Steps: 52 | Train Loss: 0.4328489 Vali Loss: 1.3605747 Test Loss: 0.3809103
Validation loss decreased (1.363150 --> 1.360575).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 14 cost time: 1.78047513961792
Epoch: 14, Steps: 52 | Train Loss: 0.4284476 Vali Loss: 1.3632567 Test Loss: 0.3778644
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 15 cost time: 1.7811338901519775
Epoch: 15, Steps: 52 | Train Loss: 0.4294714 Vali Loss: 1.3513088 Test Loss: 0.3755074
Validation loss decreased (1.360575 --> 1.351309).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 16 cost time: 1.7782878875732422
Epoch: 16, Steps: 52 | Train Loss: 0.4282393 Vali Loss: 1.3548625 Test Loss: 0.3741627
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 17 cost time: 1.7772274017333984
Epoch: 17, Steps: 52 | Train Loss: 0.4272099 Vali Loss: 1.3486065 Test Loss: 0.3712912
Validation loss decreased (1.351309 --> 1.348606).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 18 cost time: 1.7848494052886963
Epoch: 18, Steps: 52 | Train Loss: 0.4257432 Vali Loss: 1.3479956 Test Loss: 0.3703943
Validation loss decreased (1.348606 --> 1.347996).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 19 cost time: 1.7768397331237793
Epoch: 19, Steps: 52 | Train Loss: 0.4263722 Vali Loss: 1.3463604 Test Loss: 0.3692255
Validation loss decreased (1.347996 --> 1.346360).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 20 cost time: 1.7801477909088135
Epoch: 20, Steps: 52 | Train Loss: 0.4249345 Vali Loss: 1.3494108 Test Loss: 0.3685539
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 21 cost time: 1.7860591411590576
Epoch: 21, Steps: 52 | Train Loss: 0.4247351 Vali Loss: 1.3514295 Test Loss: 0.3676673
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 22 cost time: 1.7836358547210693
Epoch: 22, Steps: 52 | Train Loss: 0.4250141 Vali Loss: 1.3503149 Test Loss: 0.3657307
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 23 cost time: 1.7820796966552734
Epoch: 23, Steps: 52 | Train Loss: 0.4240744 Vali Loss: 1.3394052 Test Loss: 0.3651251
Validation loss decreased (1.346360 --> 1.339405).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 24 cost time: 1.7789602279663086
Epoch: 24, Steps: 52 | Train Loss: 0.4246187 Vali Loss: 1.3348632 Test Loss: 0.3646059
Validation loss decreased (1.339405 --> 1.334863).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 25 cost time: 1.7804186344146729
Epoch: 25, Steps: 52 | Train Loss: 0.4225178 Vali Loss: 1.3467941 Test Loss: 0.3643352
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 26 cost time: 1.7804675102233887
Epoch: 26, Steps: 52 | Train Loss: 0.4215814 Vali Loss: 1.3420554 Test Loss: 0.3629712
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 27 cost time: 1.7803680896759033
Epoch: 27, Steps: 52 | Train Loss: 0.4219581 Vali Loss: 1.3421326 Test Loss: 0.3628342
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 28 cost time: 1.7734375
Epoch: 28, Steps: 52 | Train Loss: 0.4215647 Vali Loss: 1.3399148 Test Loss: 0.3619093
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 29 cost time: 1.777904987335205
Epoch: 29, Steps: 52 | Train Loss: 0.4218256 Vali Loss: 1.3353099 Test Loss: 0.3615561
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 30 cost time: 1.7822422981262207
Epoch: 30, Steps: 52 | Train Loss: 0.4237675 Vali Loss: 1.3421769 Test Loss: 0.3612106
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 31 cost time: 1.775134801864624
Epoch: 31, Steps: 52 | Train Loss: 0.4208204 Vali Loss: 1.3356392 Test Loss: 0.3612765
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 32 cost time: 1.773146629333496
Epoch: 32, Steps: 52 | Train Loss: 0.4215083 Vali Loss: 1.3331614 Test Loss: 0.3616091
Validation loss decreased (1.334863 --> 1.333161).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 33 cost time: 1.7832238674163818
Epoch: 33, Steps: 52 | Train Loss: 0.4219078 Vali Loss: 1.3371133 Test Loss: 0.3606271
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 34 cost time: 1.7841167449951172
Epoch: 34, Steps: 52 | Train Loss: 0.4203227 Vali Loss: 1.3362944 Test Loss: 0.3605329
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 35 cost time: 1.7765586376190186
Epoch: 35, Steps: 52 | Train Loss: 0.4212717 Vali Loss: 1.3415910 Test Loss: 0.3600918
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 36 cost time: 1.7795226573944092
Epoch: 36, Steps: 52 | Train Loss: 0.4195849 Vali Loss: 1.3419123 Test Loss: 0.3606037
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 37 cost time: 1.783583164215088
Epoch: 37, Steps: 52 | Train Loss: 0.4202106 Vali Loss: 1.3381575 Test Loss: 0.3599673
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 38 cost time: 1.779433012008667
Epoch: 38, Steps: 52 | Train Loss: 0.4214331 Vali Loss: 1.3359876 Test Loss: 0.3599479
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 39 cost time: 1.7778496742248535
Epoch: 39, Steps: 52 | Train Loss: 0.4191842 Vali Loss: 1.3309886 Test Loss: 0.3600109
Validation loss decreased (1.333161 --> 1.330989).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 40 cost time: 1.7760529518127441
Epoch: 40, Steps: 52 | Train Loss: 0.4209284 Vali Loss: 1.3357230 Test Loss: 0.3601208
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 41 cost time: 1.7736127376556396
Epoch: 41, Steps: 52 | Train Loss: 0.4211044 Vali Loss: 1.3349402 Test Loss: 0.3592000
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 42 cost time: 1.775953769683838
Epoch: 42, Steps: 52 | Train Loss: 0.4209543 Vali Loss: 1.3384846 Test Loss: 0.3593063
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 43 cost time: 1.7819654941558838
Epoch: 43, Steps: 52 | Train Loss: 0.4193626 Vali Loss: 1.3342316 Test Loss: 0.3596199
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 44 cost time: 1.7889442443847656
Epoch: 44, Steps: 52 | Train Loss: 0.4188452 Vali Loss: 1.3238080 Test Loss: 0.3603586
Validation loss decreased (1.330989 --> 1.323808).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 45 cost time: 1.7739219665527344
Epoch: 45, Steps: 52 | Train Loss: 0.4203418 Vali Loss: 1.3358874 Test Loss: 0.3602280
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 46 cost time: 1.7836651802062988
Epoch: 46, Steps: 52 | Train Loss: 0.4194844 Vali Loss: 1.3346188 Test Loss: 0.3592167
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 47 cost time: 1.7807962894439697
Epoch: 47, Steps: 52 | Train Loss: 0.4192167 Vali Loss: 1.3315065 Test Loss: 0.3592896
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 48 cost time: 1.7833325862884521
Epoch: 48, Steps: 52 | Train Loss: 0.4208646 Vali Loss: 1.3371921 Test Loss: 0.3593722
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 49 cost time: 1.7826402187347412
Epoch: 49, Steps: 52 | Train Loss: 0.4208041 Vali Loss: 1.3329775 Test Loss: 0.3591399
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 50 cost time: 1.78401517868042
Epoch: 50, Steps: 52 | Train Loss: 0.4191097 Vali Loss: 1.3293092 Test Loss: 0.3591677
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 51 cost time: 1.7840123176574707
Epoch: 51, Steps: 52 | Train Loss: 0.4178052 Vali Loss: 1.3368700 Test Loss: 0.3599313
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 52 cost time: 1.7797214984893799
Epoch: 52, Steps: 52 | Train Loss: 0.4182660 Vali Loss: 1.3329186 Test Loss: 0.3596036
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 53 cost time: 1.7904613018035889
Epoch: 53, Steps: 52 | Train Loss: 0.4208452 Vali Loss: 1.3257256 Test Loss: 0.3590029
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 54 cost time: 1.786482572555542
Epoch: 54, Steps: 52 | Train Loss: 0.4202040 Vali Loss: 1.3300552 Test Loss: 0.3590219
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 55 cost time: 1.7791101932525635
Epoch: 55, Steps: 52 | Train Loss: 0.4192202 Vali Loss: 1.3375881 Test Loss: 0.3587734
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 56 cost time: 1.7693448066711426
Epoch: 56, Steps: 52 | Train Loss: 0.4198753 Vali Loss: 1.3296165 Test Loss: 0.3584055
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 57 cost time: 1.7814557552337646
Epoch: 57, Steps: 52 | Train Loss: 0.4194869 Vali Loss: 1.3398724 Test Loss: 0.3592823
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 58 cost time: 1.7825124263763428
Epoch: 58, Steps: 52 | Train Loss: 0.4209762 Vali Loss: 1.3361210 Test Loss: 0.3590325
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 59 cost time: 1.7815566062927246
Epoch: 59, Steps: 52 | Train Loss: 0.4201474 Vali Loss: 1.3384944 Test Loss: 0.3591547
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 60 cost time: 1.785982608795166
Epoch: 60, Steps: 52 | Train Loss: 0.4185584 Vali Loss: 1.3298714 Test Loss: 0.3591589
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3603585660457611, mae:0.405746728181839, rse:0.49178603291511536
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.03996562957763672 GB
Epoch: 1 cost time: 2.1470484733581543
Epoch: 1, Steps: 52 | Train Loss: 0.9166107 Vali Loss: 2.4477527 Test Loss: 1.5291462
Validation loss decreased (inf --> 2.447753).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 2 cost time: 0.7596347332000732
Epoch: 2, Steps: 52 | Train Loss: 0.8180198 Vali Loss: 1.9582376 Test Loss: 1.0619520
Validation loss decreased (2.447753 --> 1.958238).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 3 cost time: 0.7607688903808594
Epoch: 3, Steps: 52 | Train Loss: 0.6814752 Vali Loss: 1.7200012 Test Loss: 0.7983093
Validation loss decreased (1.958238 --> 1.720001).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 4 cost time: 0.7542316913604736
Epoch: 4, Steps: 52 | Train Loss: 0.6035143 Vali Loss: 1.5860828 Test Loss: 0.6368817
Validation loss decreased (1.720001 --> 1.586083).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 5 cost time: 0.7716383934020996
Epoch: 5, Steps: 52 | Train Loss: 0.5560877 Vali Loss: 1.5122354 Test Loss: 0.5534655
Validation loss decreased (1.586083 --> 1.512235).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 6 cost time: 1.688490867614746
Epoch: 6, Steps: 52 | Train Loss: 0.5276167 Vali Loss: 1.4709952 Test Loss: 0.5054147
Validation loss decreased (1.512235 --> 1.470995).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 7 cost time: 1.6919581890106201
Epoch: 7, Steps: 52 | Train Loss: 0.5105934 Vali Loss: 1.4528781 Test Loss: 0.4778427
Validation loss decreased (1.470995 --> 1.452878).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 8 cost time: 1.696063756942749
Epoch: 8, Steps: 52 | Train Loss: 0.4991754 Vali Loss: 1.4351596 Test Loss: 0.4592479
Validation loss decreased (1.452878 --> 1.435160).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 9 cost time: 1.694331407546997
Epoch: 9, Steps: 52 | Train Loss: 0.4901224 Vali Loss: 1.4305340 Test Loss: 0.4441860
Validation loss decreased (1.435160 --> 1.430534).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 10 cost time: 1.6907761096954346
Epoch: 10, Steps: 52 | Train Loss: 0.4821511 Vali Loss: 1.4163043 Test Loss: 0.4347072
Validation loss decreased (1.430534 --> 1.416304).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 11 cost time: 1.6941473484039307
Epoch: 11, Steps: 52 | Train Loss: 0.4795386 Vali Loss: 1.4094481 Test Loss: 0.4257988
Validation loss decreased (1.416304 --> 1.409448).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 12 cost time: 1.6840813159942627
Epoch: 12, Steps: 52 | Train Loss: 0.4751913 Vali Loss: 1.4095571 Test Loss: 0.4200172
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 13 cost time: 1.690276861190796
Epoch: 13, Steps: 52 | Train Loss: 0.4703123 Vali Loss: 1.4048177 Test Loss: 0.4141541
Validation loss decreased (1.409448 --> 1.404818).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 14 cost time: 1.6921944618225098
Epoch: 14, Steps: 52 | Train Loss: 0.4668474 Vali Loss: 1.3951874 Test Loss: 0.4091741
Validation loss decreased (1.404818 --> 1.395187).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 15 cost time: 1.6961874961853027
Epoch: 15, Steps: 52 | Train Loss: 0.4657789 Vali Loss: 1.3895463 Test Loss: 0.4045129
Validation loss decreased (1.395187 --> 1.389546).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 16 cost time: 1.6977670192718506
Epoch: 16, Steps: 52 | Train Loss: 0.4622997 Vali Loss: 1.3841057 Test Loss: 0.4014693
Validation loss decreased (1.389546 --> 1.384106).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 17 cost time: 1.713111162185669
Epoch: 17, Steps: 52 | Train Loss: 0.4638429 Vali Loss: 1.3873440 Test Loss: 0.3985022
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 18 cost time: 1.698470115661621
Epoch: 18, Steps: 52 | Train Loss: 0.4588268 Vali Loss: 1.3808000 Test Loss: 0.3956645
Validation loss decreased (1.384106 --> 1.380800).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 19 cost time: 1.7022693157196045
Epoch: 19, Steps: 52 | Train Loss: 0.4565288 Vali Loss: 1.3713408 Test Loss: 0.3937203
Validation loss decreased (1.380800 --> 1.371341).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 20 cost time: 1.707355260848999
Epoch: 20, Steps: 52 | Train Loss: 0.4567492 Vali Loss: 1.3803470 Test Loss: 0.3909282
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 21 cost time: 1.6934585571289062
Epoch: 21, Steps: 52 | Train Loss: 0.4573186 Vali Loss: 1.3809028 Test Loss: 0.3900126
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 22 cost time: 1.7138776779174805
Epoch: 22, Steps: 52 | Train Loss: 0.4563344 Vali Loss: 1.3800954 Test Loss: 0.3884467
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 23 cost time: 1.6935691833496094
Epoch: 23, Steps: 52 | Train Loss: 0.4537922 Vali Loss: 1.3813970 Test Loss: 0.3871551
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 24 cost time: 1.7018029689788818
Epoch: 24, Steps: 52 | Train Loss: 0.4541477 Vali Loss: 1.3654034 Test Loss: 0.3860559
Validation loss decreased (1.371341 --> 1.365403).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 25 cost time: 1.6976797580718994
Epoch: 25, Steps: 52 | Train Loss: 0.4520263 Vali Loss: 1.3752334 Test Loss: 0.3841203
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 26 cost time: 1.6972250938415527
Epoch: 26, Steps: 52 | Train Loss: 0.4499097 Vali Loss: 1.3702583 Test Loss: 0.3831719
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 27 cost time: 1.6914854049682617
Epoch: 27, Steps: 52 | Train Loss: 0.4533544 Vali Loss: 1.3707428 Test Loss: 0.3828116
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 28 cost time: 1.6932780742645264
Epoch: 28, Steps: 52 | Train Loss: 0.4508327 Vali Loss: 1.3748537 Test Loss: 0.3824899
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 29 cost time: 1.6861381530761719
Epoch: 29, Steps: 52 | Train Loss: 0.4497931 Vali Loss: 1.3649068 Test Loss: 0.3812058
Validation loss decreased (1.365403 --> 1.364907).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 30 cost time: 1.6945407390594482
Epoch: 30, Steps: 52 | Train Loss: 0.4513923 Vali Loss: 1.3722724 Test Loss: 0.3808405
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 31 cost time: 1.701678991317749
Epoch: 31, Steps: 52 | Train Loss: 0.4502289 Vali Loss: 1.3742709 Test Loss: 0.3803722
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 32 cost time: 1.702434778213501
Epoch: 32, Steps: 52 | Train Loss: 0.4496129 Vali Loss: 1.3733151 Test Loss: 0.3783576
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 33 cost time: 1.6953632831573486
Epoch: 33, Steps: 52 | Train Loss: 0.4503676 Vali Loss: 1.3656962 Test Loss: 0.3788412
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 34 cost time: 1.6955416202545166
Epoch: 34, Steps: 52 | Train Loss: 0.4484981 Vali Loss: 1.3691322 Test Loss: 0.3791108
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 35 cost time: 1.6913979053497314
Epoch: 35, Steps: 52 | Train Loss: 0.4486153 Vali Loss: 1.3681322 Test Loss: 0.3785855
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 36 cost time: 1.6953253746032715
Epoch: 36, Steps: 52 | Train Loss: 0.4470823 Vali Loss: 1.3736994 Test Loss: 0.3787682
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 37 cost time: 1.6925995349884033
Epoch: 37, Steps: 52 | Train Loss: 0.4483262 Vali Loss: 1.3682048 Test Loss: 0.3770295
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 38 cost time: 1.7059710025787354
Epoch: 38, Steps: 52 | Train Loss: 0.4485075 Vali Loss: 1.3725915 Test Loss: 0.3773702
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 39 cost time: 1.698786973953247
Epoch: 39, Steps: 52 | Train Loss: 0.4469606 Vali Loss: 1.3711019 Test Loss: 0.3777096
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 40 cost time: 1.6971495151519775
Epoch: 40, Steps: 52 | Train Loss: 0.4502317 Vali Loss: 1.3668990 Test Loss: 0.3773663
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 41 cost time: 1.6873717308044434
Epoch: 41, Steps: 52 | Train Loss: 0.4477387 Vali Loss: 1.3691304 Test Loss: 0.3776313
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 42 cost time: 1.6897838115692139
Epoch: 42, Steps: 52 | Train Loss: 0.4503610 Vali Loss: 1.3637717 Test Loss: 0.3767207
Validation loss decreased (1.364907 --> 1.363772).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 43 cost time: 1.6950128078460693
Epoch: 43, Steps: 52 | Train Loss: 0.4474348 Vali Loss: 1.3484099 Test Loss: 0.3772203
Validation loss decreased (1.363772 --> 1.348410).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 44 cost time: 1.6934568881988525
Epoch: 44, Steps: 52 | Train Loss: 0.4485298 Vali Loss: 1.3737571 Test Loss: 0.3763296
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 45 cost time: 1.6932475566864014
Epoch: 45, Steps: 52 | Train Loss: 0.4466414 Vali Loss: 1.3701375 Test Loss: 0.3759906
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 46 cost time: 1.6925086975097656
Epoch: 46, Steps: 52 | Train Loss: 0.4484291 Vali Loss: 1.3612504 Test Loss: 0.3763436
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 47 cost time: 1.6910698413848877
Epoch: 47, Steps: 52 | Train Loss: 0.4479987 Vali Loss: 1.3641379 Test Loss: 0.3767484
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 48 cost time: 1.6964893341064453
Epoch: 48, Steps: 52 | Train Loss: 0.4478025 Vali Loss: 1.3710408 Test Loss: 0.3762850
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 49 cost time: 1.6954677104949951
Epoch: 49, Steps: 52 | Train Loss: 0.4469874 Vali Loss: 1.3605911 Test Loss: 0.3756930
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 50 cost time: 1.6925609111785889
Epoch: 50, Steps: 52 | Train Loss: 0.4466643 Vali Loss: 1.3696804 Test Loss: 0.3763551
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 51 cost time: 1.6944398880004883
Epoch: 51, Steps: 52 | Train Loss: 0.4481341 Vali Loss: 1.3737189 Test Loss: 0.3753965
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 52 cost time: 1.689577579498291
Epoch: 52, Steps: 52 | Train Loss: 0.4472327 Vali Loss: 1.3688719 Test Loss: 0.3749562
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 53 cost time: 1.7063848972320557
Epoch: 53, Steps: 52 | Train Loss: 0.4472832 Vali Loss: 1.3591983 Test Loss: 0.3751499
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 54 cost time: 1.6930105686187744
Epoch: 54, Steps: 52 | Train Loss: 0.4468437 Vali Loss: 1.3616190 Test Loss: 0.3757771
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 55 cost time: 1.697087287902832
Epoch: 55, Steps: 52 | Train Loss: 0.4458791 Vali Loss: 1.3627162 Test Loss: 0.3750379
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 56 cost time: 1.6860952377319336
Epoch: 56, Steps: 52 | Train Loss: 0.4473844 Vali Loss: 1.3715757 Test Loss: 0.3749164
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 57 cost time: 1.692469835281372
Epoch: 57, Steps: 52 | Train Loss: 0.4474014 Vali Loss: 1.3657098 Test Loss: 0.3753696
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 58 cost time: 1.6916780471801758
Epoch: 58, Steps: 52 | Train Loss: 0.4458198 Vali Loss: 1.3679742 Test Loss: 0.3752564
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 59 cost time: 1.6959013938903809
Epoch: 59, Steps: 52 | Train Loss: 0.4475375 Vali Loss: 1.3647933 Test Loss: 0.3758754
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 60 cost time: 1.6915559768676758
Epoch: 60, Steps: 52 | Train Loss: 0.4460137 Vali Loss: 1.3585167 Test Loss: 0.3761235
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3772203028202057, mae:0.41210508346557617, rse:0.503160297870636
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.040667057037353516 GB
Epoch: 1 cost time: 2.184098243713379
Epoch: 1, Steps: 52 | Train Loss: 0.7462852 Vali Loss: 2.1685281 Test Loss: 1.3606038
Validation loss decreased (inf --> 2.168528).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 2 cost time: 0.8034374713897705
Epoch: 2, Steps: 52 | Train Loss: 0.6789044 Vali Loss: 1.8543401 Test Loss: 0.9996700
Validation loss decreased (2.168528 --> 1.854340).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 3 cost time: 0.7977328300476074
Epoch: 3, Steps: 52 | Train Loss: 0.5805031 Vali Loss: 1.6292002 Test Loss: 0.7018298
Validation loss decreased (1.854340 --> 1.629200).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 4 cost time: 0.8090004920959473
Epoch: 4, Steps: 52 | Train Loss: 0.5123044 Vali Loss: 1.4976439 Test Loss: 0.5185580
Validation loss decreased (1.629200 --> 1.497644).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 5 cost time: 0.9028289318084717
Epoch: 5, Steps: 52 | Train Loss: 0.4771483 Vali Loss: 1.4533793 Test Loss: 0.4554770
Validation loss decreased (1.497644 --> 1.453379).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 6 cost time: 1.7431612014770508
Epoch: 6, Steps: 52 | Train Loss: 0.4660081 Vali Loss: 1.4277160 Test Loss: 0.4345177
Validation loss decreased (1.453379 --> 1.427716).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 7 cost time: 1.7439658641815186
Epoch: 7, Steps: 52 | Train Loss: 0.4548161 Vali Loss: 1.4117608 Test Loss: 0.4199921
Validation loss decreased (1.427716 --> 1.411761).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 8 cost time: 1.7447948455810547
Epoch: 8, Steps: 52 | Train Loss: 0.4513300 Vali Loss: 1.3972456 Test Loss: 0.4094787
Validation loss decreased (1.411761 --> 1.397246).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 9 cost time: 1.7515804767608643
Epoch: 9, Steps: 52 | Train Loss: 0.4449410 Vali Loss: 1.3941927 Test Loss: 0.4008845
Validation loss decreased (1.397246 --> 1.394193).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 10 cost time: 1.752607822418213
Epoch: 10, Steps: 52 | Train Loss: 0.4428378 Vali Loss: 1.3907484 Test Loss: 0.3931800
Validation loss decreased (1.394193 --> 1.390748).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 11 cost time: 1.760634183883667
Epoch: 11, Steps: 52 | Train Loss: 0.4405430 Vali Loss: 1.3880343 Test Loss: 0.3886461
Validation loss decreased (1.390748 --> 1.388034).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 12 cost time: 1.7554001808166504
Epoch: 12, Steps: 52 | Train Loss: 0.4383420 Vali Loss: 1.3804014 Test Loss: 0.3845803
Validation loss decreased (1.388034 --> 1.380401).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 13 cost time: 1.756136417388916
Epoch: 13, Steps: 52 | Train Loss: 0.4358995 Vali Loss: 1.3775240 Test Loss: 0.3822892
Validation loss decreased (1.380401 --> 1.377524).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 14 cost time: 1.7586312294006348
Epoch: 14, Steps: 52 | Train Loss: 0.4327888 Vali Loss: 1.3691927 Test Loss: 0.3784537
Validation loss decreased (1.377524 --> 1.369193).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 15 cost time: 1.7500007152557373
Epoch: 15, Steps: 52 | Train Loss: 0.4341593 Vali Loss: 1.3685446 Test Loss: 0.3767437
Validation loss decreased (1.369193 --> 1.368545).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 16 cost time: 1.7553784847259521
Epoch: 16, Steps: 52 | Train Loss: 0.4302642 Vali Loss: 1.3667099 Test Loss: 0.3747981
Validation loss decreased (1.368545 --> 1.366710).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 17 cost time: 1.7522718906402588
Epoch: 17, Steps: 52 | Train Loss: 0.4313875 Vali Loss: 1.3659028 Test Loss: 0.3725319
Validation loss decreased (1.366710 --> 1.365903).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 18 cost time: 1.7529308795928955
Epoch: 18, Steps: 52 | Train Loss: 0.4303187 Vali Loss: 1.3572021 Test Loss: 0.3716812
Validation loss decreased (1.365903 --> 1.357202).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 19 cost time: 1.747469186782837
Epoch: 19, Steps: 52 | Train Loss: 0.4290546 Vali Loss: 1.3631113 Test Loss: 0.3705448
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 20 cost time: 1.745865821838379
Epoch: 20, Steps: 52 | Train Loss: 0.4284346 Vali Loss: 1.3592600 Test Loss: 0.3688511
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 21 cost time: 1.7474374771118164
Epoch: 21, Steps: 52 | Train Loss: 0.4285831 Vali Loss: 1.3549068 Test Loss: 0.3677219
Validation loss decreased (1.357202 --> 1.354907).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 22 cost time: 1.7458031177520752
Epoch: 22, Steps: 52 | Train Loss: 0.4274783 Vali Loss: 1.3493128 Test Loss: 0.3670176
Validation loss decreased (1.354907 --> 1.349313).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 23 cost time: 1.758293867111206
Epoch: 23, Steps: 52 | Train Loss: 0.4291008 Vali Loss: 1.3577546 Test Loss: 0.3664351
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 24 cost time: 1.7495098114013672
Epoch: 24, Steps: 52 | Train Loss: 0.4266637 Vali Loss: 1.3486226 Test Loss: 0.3662181
Validation loss decreased (1.349313 --> 1.348623).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 25 cost time: 1.739382266998291
Epoch: 25, Steps: 52 | Train Loss: 0.4261046 Vali Loss: 1.3606230 Test Loss: 0.3652748
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 26 cost time: 1.7514359951019287
Epoch: 26, Steps: 52 | Train Loss: 0.4257224 Vali Loss: 1.3573418 Test Loss: 0.3648978
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 27 cost time: 1.7568094730377197
Epoch: 27, Steps: 52 | Train Loss: 0.4247528 Vali Loss: 1.3577943 Test Loss: 0.3639353
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 28 cost time: 1.7515869140625
Epoch: 28, Steps: 52 | Train Loss: 0.4277826 Vali Loss: 1.3467059 Test Loss: 0.3638387
Validation loss decreased (1.348623 --> 1.346706).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 29 cost time: 1.7494823932647705
Epoch: 29, Steps: 52 | Train Loss: 0.4253570 Vali Loss: 1.3580008 Test Loss: 0.3639351
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 30 cost time: 1.7473547458648682
Epoch: 30, Steps: 52 | Train Loss: 0.4250594 Vali Loss: 1.3513817 Test Loss: 0.3634548
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 31 cost time: 1.755479097366333
Epoch: 31, Steps: 52 | Train Loss: 0.4258747 Vali Loss: 1.3477743 Test Loss: 0.3631940
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 32 cost time: 1.7514417171478271
Epoch: 32, Steps: 52 | Train Loss: 0.4253354 Vali Loss: 1.3502504 Test Loss: 0.3628870
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 33 cost time: 1.7554237842559814
Epoch: 33, Steps: 52 | Train Loss: 0.4253861 Vali Loss: 1.3422658 Test Loss: 0.3620437
Validation loss decreased (1.346706 --> 1.342266).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 34 cost time: 1.7614047527313232
Epoch: 34, Steps: 52 | Train Loss: 0.4240397 Vali Loss: 1.3419416 Test Loss: 0.3624336
Validation loss decreased (1.342266 --> 1.341942).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 35 cost time: 1.750211238861084
Epoch: 35, Steps: 52 | Train Loss: 0.4266967 Vali Loss: 1.3495718 Test Loss: 0.3624788
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 36 cost time: 1.750948190689087
Epoch: 36, Steps: 52 | Train Loss: 0.4241761 Vali Loss: 1.3453240 Test Loss: 0.3628830
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 37 cost time: 1.7571659088134766
Epoch: 37, Steps: 52 | Train Loss: 0.4246962 Vali Loss: 1.3462303 Test Loss: 0.3621290
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 38 cost time: 1.7561976909637451
Epoch: 38, Steps: 52 | Train Loss: 0.4235199 Vali Loss: 1.3522692 Test Loss: 0.3620611
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 39 cost time: 1.750441074371338
Epoch: 39, Steps: 52 | Train Loss: 0.4240993 Vali Loss: 1.3482652 Test Loss: 0.3622556
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 40 cost time: 1.755319595336914
Epoch: 40, Steps: 52 | Train Loss: 0.4232856 Vali Loss: 1.3520341 Test Loss: 0.3616599
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 41 cost time: 1.746436357498169
Epoch: 41, Steps: 52 | Train Loss: 0.4247132 Vali Loss: 1.3530829 Test Loss: 0.3616730
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 42 cost time: 1.7472450733184814
Epoch: 42, Steps: 52 | Train Loss: 0.4238241 Vali Loss: 1.3432286 Test Loss: 0.3618348
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 43 cost time: 1.7548325061798096
Epoch: 43, Steps: 52 | Train Loss: 0.4246718 Vali Loss: 1.3490043 Test Loss: 0.3621547
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 44 cost time: 1.7536253929138184
Epoch: 44, Steps: 52 | Train Loss: 0.4236530 Vali Loss: 1.3513778 Test Loss: 0.3609799
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 45 cost time: 1.7499399185180664
Epoch: 45, Steps: 52 | Train Loss: 0.4254645 Vali Loss: 1.3462969 Test Loss: 0.3614069
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 46 cost time: 1.7464542388916016
Epoch: 46, Steps: 52 | Train Loss: 0.4235768 Vali Loss: 1.3506516 Test Loss: 0.3618969
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 47 cost time: 1.744476318359375
Epoch: 47, Steps: 52 | Train Loss: 0.4229954 Vali Loss: 1.3431575 Test Loss: 0.3609840
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 48 cost time: 1.7414219379425049
Epoch: 48, Steps: 52 | Train Loss: 0.4227200 Vali Loss: 1.3463624 Test Loss: 0.3610955
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 49 cost time: 1.7485010623931885
Epoch: 49, Steps: 52 | Train Loss: 0.4236333 Vali Loss: 1.3496649 Test Loss: 0.3617404
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 50 cost time: 1.748563289642334
Epoch: 50, Steps: 52 | Train Loss: 0.4238124 Vali Loss: 1.3475587 Test Loss: 0.3610636
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 51 cost time: 1.7604897022247314
Epoch: 51, Steps: 52 | Train Loss: 0.4246938 Vali Loss: 1.3316171 Test Loss: 0.3615923
Validation loss decreased (1.341942 --> 1.331617).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 52 cost time: 1.7501726150512695
Epoch: 52, Steps: 52 | Train Loss: 0.4238085 Vali Loss: 1.3459064 Test Loss: 0.3619069
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 53 cost time: 1.75736665725708
Epoch: 53, Steps: 52 | Train Loss: 0.4229019 Vali Loss: 1.3479860 Test Loss: 0.3608434
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 54 cost time: 1.7335457801818848
Epoch: 54, Steps: 52 | Train Loss: 0.4228924 Vali Loss: 1.3501071 Test Loss: 0.3609237
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 55 cost time: 1.7520158290863037
Epoch: 55, Steps: 52 | Train Loss: 0.4231153 Vali Loss: 1.3475348 Test Loss: 0.3611784
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 56 cost time: 1.7445015907287598
Epoch: 56, Steps: 52 | Train Loss: 0.4225136 Vali Loss: 1.3433502 Test Loss: 0.3613128
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 57 cost time: 1.745786428451538
Epoch: 57, Steps: 52 | Train Loss: 0.4240978 Vali Loss: 1.3498409 Test Loss: 0.3610453
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 58 cost time: 1.7463393211364746
Epoch: 58, Steps: 52 | Train Loss: 0.4253334 Vali Loss: 1.3487864 Test Loss: 0.3615291
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 59 cost time: 1.7570197582244873
Epoch: 59, Steps: 52 | Train Loss: 0.4230202 Vali Loss: 1.3445346 Test Loss: 0.3612176
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 60 cost time: 1.7533740997314453
Epoch: 60, Steps: 52 | Train Loss: 0.4227097 Vali Loss: 1.3493971 Test Loss: 0.3608668
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36159229278564453, mae:0.40315547585487366, rse:0.49262717366218567
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04123115539550781 GB
Epoch: 1 cost time: 2.215789556503296
Epoch: 1, Steps: 52 | Train Loss: 0.7043565 Vali Loss: 2.1763442 Test Loss: 1.4044387
Validation loss decreased (inf --> 2.176344).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 2 cost time: 0.8181016445159912
Epoch: 2, Steps: 52 | Train Loss: 0.6662517 Vali Loss: 1.9599488 Test Loss: 1.1527913
Validation loss decreased (2.176344 --> 1.959949).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 3 cost time: 0.8072645664215088
Epoch: 3, Steps: 52 | Train Loss: 0.5938105 Vali Loss: 1.7303903 Test Loss: 0.8525727
Validation loss decreased (1.959949 --> 1.730390).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 4 cost time: 0.806999683380127
Epoch: 4, Steps: 52 | Train Loss: 0.5217537 Vali Loss: 1.5454428 Test Loss: 0.6013360
Validation loss decreased (1.730390 --> 1.545443).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 5 cost time: 1.1296334266662598
Epoch: 5, Steps: 52 | Train Loss: 0.4745557 Vali Loss: 1.4621005 Test Loss: 0.4788338
Validation loss decreased (1.545443 --> 1.462101).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 6 cost time: 1.8043861389160156
Epoch: 6, Steps: 52 | Train Loss: 0.4522639 Vali Loss: 1.4179854 Test Loss: 0.4289892
Validation loss decreased (1.462101 --> 1.417985).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 7 cost time: 1.8080294132232666
Epoch: 7, Steps: 52 | Train Loss: 0.4407707 Vali Loss: 1.3990839 Test Loss: 0.4061388
Validation loss decreased (1.417985 --> 1.399084).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 8 cost time: 1.8147330284118652
Epoch: 8, Steps: 52 | Train Loss: 0.4366952 Vali Loss: 1.3841246 Test Loss: 0.3935324
Validation loss decreased (1.399084 --> 1.384125).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 9 cost time: 1.8124077320098877
Epoch: 9, Steps: 52 | Train Loss: 0.4343301 Vali Loss: 1.3763723 Test Loss: 0.3848148
Validation loss decreased (1.384125 --> 1.376372).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 10 cost time: 1.8033862113952637
Epoch: 10, Steps: 52 | Train Loss: 0.4313860 Vali Loss: 1.3729792 Test Loss: 0.3783139
Validation loss decreased (1.376372 --> 1.372979).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 11 cost time: 1.8077671527862549
Epoch: 11, Steps: 52 | Train Loss: 0.4281586 Vali Loss: 1.3589294 Test Loss: 0.3730815
Validation loss decreased (1.372979 --> 1.358929).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 12 cost time: 1.8055393695831299
Epoch: 12, Steps: 52 | Train Loss: 0.4275266 Vali Loss: 1.3543671 Test Loss: 0.3692500
Validation loss decreased (1.358929 --> 1.354367).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 13 cost time: 1.808354139328003
Epoch: 13, Steps: 52 | Train Loss: 0.4253657 Vali Loss: 1.3524294 Test Loss: 0.3664890
Validation loss decreased (1.354367 --> 1.352429).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 14 cost time: 1.8184325695037842
Epoch: 14, Steps: 52 | Train Loss: 0.4236611 Vali Loss: 1.3543124 Test Loss: 0.3636962
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 15 cost time: 1.8026669025421143
Epoch: 15, Steps: 52 | Train Loss: 0.4237144 Vali Loss: 1.3461547 Test Loss: 0.3614692
Validation loss decreased (1.352429 --> 1.346155).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 16 cost time: 1.8086528778076172
Epoch: 16, Steps: 52 | Train Loss: 0.4228646 Vali Loss: 1.3451991 Test Loss: 0.3601071
Validation loss decreased (1.346155 --> 1.345199).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 17 cost time: 1.8112623691558838
Epoch: 17, Steps: 52 | Train Loss: 0.4210529 Vali Loss: 1.3481660 Test Loss: 0.3583418
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 18 cost time: 1.8104948997497559
Epoch: 18, Steps: 52 | Train Loss: 0.4206412 Vali Loss: 1.3460765 Test Loss: 0.3578212
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 19 cost time: 1.8108835220336914
Epoch: 19, Steps: 52 | Train Loss: 0.4195193 Vali Loss: 1.3464398 Test Loss: 0.3566073
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 20 cost time: 1.8101131916046143
Epoch: 20, Steps: 52 | Train Loss: 0.4197684 Vali Loss: 1.3432274 Test Loss: 0.3550285
Validation loss decreased (1.345199 --> 1.343227).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 21 cost time: 1.8091444969177246
Epoch: 21, Steps: 52 | Train Loss: 0.4174649 Vali Loss: 1.3350836 Test Loss: 0.3552455
Validation loss decreased (1.343227 --> 1.335084).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 22 cost time: 1.8099277019500732
Epoch: 22, Steps: 52 | Train Loss: 0.4184997 Vali Loss: 1.3291417 Test Loss: 0.3540938
Validation loss decreased (1.335084 --> 1.329142).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 23 cost time: 1.8087999820709229
Epoch: 23, Steps: 52 | Train Loss: 0.4184241 Vali Loss: 1.3358786 Test Loss: 0.3531452
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 24 cost time: 1.8100686073303223
Epoch: 24, Steps: 52 | Train Loss: 0.4169121 Vali Loss: 1.3288560 Test Loss: 0.3526943
Validation loss decreased (1.329142 --> 1.328856).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 25 cost time: 1.799323320388794
Epoch: 25, Steps: 52 | Train Loss: 0.4168078 Vali Loss: 1.3392158 Test Loss: 0.3527892
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 26 cost time: 1.803008794784546
Epoch: 26, Steps: 52 | Train Loss: 0.4183227 Vali Loss: 1.3301756 Test Loss: 0.3521180
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 27 cost time: 1.8043911457061768
Epoch: 27, Steps: 52 | Train Loss: 0.4171838 Vali Loss: 1.3374727 Test Loss: 0.3516355
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 28 cost time: 1.8091919422149658
Epoch: 28, Steps: 52 | Train Loss: 0.4171749 Vali Loss: 1.3300905 Test Loss: 0.3521214
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 29 cost time: 1.7955949306488037
Epoch: 29, Steps: 52 | Train Loss: 0.4165879 Vali Loss: 1.3307869 Test Loss: 0.3515039
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 30 cost time: 1.8152101039886475
Epoch: 30, Steps: 52 | Train Loss: 0.4176379 Vali Loss: 1.3371274 Test Loss: 0.3511388
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 31 cost time: 1.8421058654785156
Epoch: 31, Steps: 52 | Train Loss: 0.4152249 Vali Loss: 1.3309582 Test Loss: 0.3509706
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 32 cost time: 1.8051249980926514
Epoch: 32, Steps: 52 | Train Loss: 0.4158700 Vali Loss: 1.3206139 Test Loss: 0.3505886
Validation loss decreased (1.328856 --> 1.320614).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 33 cost time: 1.8083984851837158
Epoch: 33, Steps: 52 | Train Loss: 0.4167029 Vali Loss: 1.3312477 Test Loss: 0.3508859
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 34 cost time: 1.805626392364502
Epoch: 34, Steps: 52 | Train Loss: 0.4179909 Vali Loss: 1.3216720 Test Loss: 0.3504924
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 35 cost time: 1.8104114532470703
Epoch: 35, Steps: 52 | Train Loss: 0.4168336 Vali Loss: 1.3313915 Test Loss: 0.3503276
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 36 cost time: 1.8014812469482422
Epoch: 36, Steps: 52 | Train Loss: 0.4179658 Vali Loss: 1.3326387 Test Loss: 0.3508632
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 37 cost time: 1.807718276977539
Epoch: 37, Steps: 52 | Train Loss: 0.4171576 Vali Loss: 1.3312948 Test Loss: 0.3504515
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 38 cost time: 1.799638271331787
Epoch: 38, Steps: 52 | Train Loss: 0.4147281 Vali Loss: 1.3227956 Test Loss: 0.3503752
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 39 cost time: 1.8062107563018799
Epoch: 39, Steps: 52 | Train Loss: 0.4164995 Vali Loss: 1.3354599 Test Loss: 0.3501687
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 40 cost time: 1.8073468208312988
Epoch: 40, Steps: 52 | Train Loss: 0.4162521 Vali Loss: 1.3298889 Test Loss: 0.3499683
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 41 cost time: 1.8086133003234863
Epoch: 41, Steps: 52 | Train Loss: 0.4163198 Vali Loss: 1.3345330 Test Loss: 0.3500017
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 42 cost time: 1.801173210144043
Epoch: 42, Steps: 52 | Train Loss: 0.4163963 Vali Loss: 1.3265212 Test Loss: 0.3495773
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 43 cost time: 1.8003923892974854
Epoch: 43, Steps: 52 | Train Loss: 0.4167739 Vali Loss: 1.3334939 Test Loss: 0.3496971
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 44 cost time: 1.806964635848999
Epoch: 44, Steps: 52 | Train Loss: 0.4166232 Vali Loss: 1.3253467 Test Loss: 0.3495503
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 45 cost time: 1.803720474243164
Epoch: 45, Steps: 52 | Train Loss: 0.4159576 Vali Loss: 1.3267317 Test Loss: 0.3494908
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 46 cost time: 1.8044984340667725
Epoch: 46, Steps: 52 | Train Loss: 0.4161056 Vali Loss: 1.3286934 Test Loss: 0.3493209
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 47 cost time: 1.8064608573913574
Epoch: 47, Steps: 52 | Train Loss: 0.4159648 Vali Loss: 1.3315411 Test Loss: 0.3494591
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 48 cost time: 1.7977099418640137
Epoch: 48, Steps: 52 | Train Loss: 0.4152675 Vali Loss: 1.3245589 Test Loss: 0.3497257
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 49 cost time: 1.8063008785247803
Epoch: 49, Steps: 52 | Train Loss: 0.4150349 Vali Loss: 1.3333826 Test Loss: 0.3497251
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 50 cost time: 1.8033115863800049
Epoch: 50, Steps: 52 | Train Loss: 0.4161744 Vali Loss: 1.3271813 Test Loss: 0.3489009
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 51 cost time: 1.806337833404541
Epoch: 51, Steps: 52 | Train Loss: 0.4145999 Vali Loss: 1.3308423 Test Loss: 0.3494771
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 52 cost time: 1.8083202838897705
Epoch: 52, Steps: 52 | Train Loss: 0.4164002 Vali Loss: 1.3228502 Test Loss: 0.3498486
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 53 cost time: 1.8170921802520752
Epoch: 53, Steps: 52 | Train Loss: 0.4143626 Vali Loss: 1.3295782 Test Loss: 0.3489514
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 54 cost time: 1.8081200122833252
Epoch: 54, Steps: 52 | Train Loss: 0.4167291 Vali Loss: 1.3349246 Test Loss: 0.3494967
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 55 cost time: 1.8018455505371094
Epoch: 55, Steps: 52 | Train Loss: 0.4156255 Vali Loss: 1.3286321 Test Loss: 0.3491569
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 56 cost time: 1.7985894680023193
Epoch: 56, Steps: 52 | Train Loss: 0.4145227 Vali Loss: 1.3293592 Test Loss: 0.3491283
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 57 cost time: 1.8083362579345703
Epoch: 57, Steps: 52 | Train Loss: 0.4154203 Vali Loss: 1.3328964 Test Loss: 0.3491837
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 58 cost time: 1.7967772483825684
Epoch: 58, Steps: 52 | Train Loss: 0.4172865 Vali Loss: 1.3313372 Test Loss: 0.3499808
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 59 cost time: 1.811894178390503
Epoch: 59, Steps: 52 | Train Loss: 0.4153166 Vali Loss: 1.3310084 Test Loss: 0.3486837
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 60 cost time: 1.8071653842926025
Epoch: 60, Steps: 52 | Train Loss: 0.4152235 Vali Loss: 1.3341299 Test Loss: 0.3490483
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3505886495113373, mae:0.39188024401664734, rse:0.4850737154483795
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.040126800537109375 GB
Epoch: 1 cost time: 2.18296480178833
Epoch: 1, Steps: 52 | Train Loss: 0.7698106 Vali Loss: 2.0546145 Test Loss: 1.1347740
Validation loss decreased (inf --> 2.054615).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 2 cost time: 0.7830002307891846
Epoch: 2, Steps: 52 | Train Loss: 0.6893339 Vali Loss: 1.7164547 Test Loss: 0.7757414
Validation loss decreased (2.054615 --> 1.716455).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 3 cost time: 0.7786169052124023
Epoch: 3, Steps: 52 | Train Loss: 0.5935200 Vali Loss: 1.5745978 Test Loss: 0.6233743
Validation loss decreased (1.716455 --> 1.574598).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 4 cost time: 0.7932586669921875
Epoch: 4, Steps: 52 | Train Loss: 0.5438994 Vali Loss: 1.5181134 Test Loss: 0.5406626
Validation loss decreased (1.574598 --> 1.518113).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 5 cost time: 0.815443754196167
Epoch: 5, Steps: 52 | Train Loss: 0.5168218 Vali Loss: 1.4802997 Test Loss: 0.4995472
Validation loss decreased (1.518113 --> 1.480300).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 6 cost time: 1.7174921035766602
Epoch: 6, Steps: 52 | Train Loss: 0.5017015 Vali Loss: 1.4576573 Test Loss: 0.4737563
Validation loss decreased (1.480300 --> 1.457657).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 7 cost time: 1.7222950458526611
Epoch: 7, Steps: 52 | Train Loss: 0.4875499 Vali Loss: 1.4501953 Test Loss: 0.4553275
Validation loss decreased (1.457657 --> 1.450195).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 8 cost time: 1.7185401916503906
Epoch: 8, Steps: 52 | Train Loss: 0.4826756 Vali Loss: 1.4360856 Test Loss: 0.4443572
Validation loss decreased (1.450195 --> 1.436086).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 9 cost time: 1.7194819450378418
Epoch: 9, Steps: 52 | Train Loss: 0.4768621 Vali Loss: 1.4311018 Test Loss: 0.4343827
Validation loss decreased (1.436086 --> 1.431102).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 10 cost time: 1.7144837379455566
Epoch: 10, Steps: 52 | Train Loss: 0.4715176 Vali Loss: 1.4220625 Test Loss: 0.4257176
Validation loss decreased (1.431102 --> 1.422063).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 11 cost time: 1.7074315547943115
Epoch: 11, Steps: 52 | Train Loss: 0.4638144 Vali Loss: 1.4024668 Test Loss: 0.4204384
Validation loss decreased (1.422063 --> 1.402467).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 12 cost time: 1.7051050662994385
Epoch: 12, Steps: 52 | Train Loss: 0.4609275 Vali Loss: 1.4018826 Test Loss: 0.4133452
Validation loss decreased (1.402467 --> 1.401883).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 13 cost time: 1.7239670753479004
Epoch: 13, Steps: 52 | Train Loss: 0.4610006 Vali Loss: 1.4000516 Test Loss: 0.4094922
Validation loss decreased (1.401883 --> 1.400052).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 14 cost time: 1.7186279296875
Epoch: 14, Steps: 52 | Train Loss: 0.4579531 Vali Loss: 1.3961073 Test Loss: 0.4038211
Validation loss decreased (1.400052 --> 1.396107).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 15 cost time: 1.7130413055419922
Epoch: 15, Steps: 52 | Train Loss: 0.4554190 Vali Loss: 1.3896276 Test Loss: 0.4007526
Validation loss decreased (1.396107 --> 1.389628).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 16 cost time: 1.7214984893798828
Epoch: 16, Steps: 52 | Train Loss: 0.4546777 Vali Loss: 1.3902476 Test Loss: 0.3985552
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 17 cost time: 1.711733341217041
Epoch: 17, Steps: 52 | Train Loss: 0.4538622 Vali Loss: 1.3880016 Test Loss: 0.3965488
Validation loss decreased (1.389628 --> 1.388002).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 18 cost time: 1.7143893241882324
Epoch: 18, Steps: 52 | Train Loss: 0.4511832 Vali Loss: 1.3858951 Test Loss: 0.3940096
Validation loss decreased (1.388002 --> 1.385895).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 19 cost time: 1.7176148891448975
Epoch: 19, Steps: 52 | Train Loss: 0.4504209 Vali Loss: 1.3796682 Test Loss: 0.3909755
Validation loss decreased (1.385895 --> 1.379668).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 20 cost time: 1.720470666885376
Epoch: 20, Steps: 52 | Train Loss: 0.4476433 Vali Loss: 1.3767926 Test Loss: 0.3902455
Validation loss decreased (1.379668 --> 1.376793).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 21 cost time: 1.7165334224700928
Epoch: 21, Steps: 52 | Train Loss: 0.4487203 Vali Loss: 1.3776312 Test Loss: 0.3870515
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 22 cost time: 1.7259950637817383
Epoch: 22, Steps: 52 | Train Loss: 0.4453224 Vali Loss: 1.3796462 Test Loss: 0.3862611
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 23 cost time: 1.7308270931243896
Epoch: 23, Steps: 52 | Train Loss: 0.4471192 Vali Loss: 1.3790817 Test Loss: 0.3857567
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 24 cost time: 1.717320442199707
Epoch: 24, Steps: 52 | Train Loss: 0.4461320 Vali Loss: 1.3642650 Test Loss: 0.3835092
Validation loss decreased (1.376793 --> 1.364265).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 25 cost time: 1.7153265476226807
Epoch: 25, Steps: 52 | Train Loss: 0.4448814 Vali Loss: 1.3661982 Test Loss: 0.3826224
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 26 cost time: 1.7174084186553955
Epoch: 26, Steps: 52 | Train Loss: 0.4452482 Vali Loss: 1.3736949 Test Loss: 0.3812922
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 27 cost time: 1.6986932754516602
Epoch: 27, Steps: 52 | Train Loss: 0.4424157 Vali Loss: 1.3694897 Test Loss: 0.3800530
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 28 cost time: 1.7183563709259033
Epoch: 28, Steps: 52 | Train Loss: 0.4441063 Vali Loss: 1.3735764 Test Loss: 0.3814539
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 29 cost time: 1.7200400829315186
Epoch: 29, Steps: 52 | Train Loss: 0.4420312 Vali Loss: 1.3672718 Test Loss: 0.3796861
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 30 cost time: 1.7224373817443848
Epoch: 30, Steps: 52 | Train Loss: 0.4437229 Vali Loss: 1.3661563 Test Loss: 0.3800628
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 31 cost time: 1.7130131721496582
Epoch: 31, Steps: 52 | Train Loss: 0.4404985 Vali Loss: 1.3650794 Test Loss: 0.3786119
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 32 cost time: 1.7122013568878174
Epoch: 32, Steps: 52 | Train Loss: 0.4404238 Vali Loss: 1.3657601 Test Loss: 0.3787294
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 33 cost time: 1.7178750038146973
Epoch: 33, Steps: 52 | Train Loss: 0.4426085 Vali Loss: 1.3643500 Test Loss: 0.3780510
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 34 cost time: 1.721036434173584
Epoch: 34, Steps: 52 | Train Loss: 0.4419312 Vali Loss: 1.3635378 Test Loss: 0.3767537
Validation loss decreased (1.364265 --> 1.363538).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 35 cost time: 1.7214372158050537
Epoch: 35, Steps: 52 | Train Loss: 0.4417374 Vali Loss: 1.3632798 Test Loss: 0.3760019
Validation loss decreased (1.363538 --> 1.363280).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 36 cost time: 1.715817928314209
Epoch: 36, Steps: 52 | Train Loss: 0.4418796 Vali Loss: 1.3629935 Test Loss: 0.3766189
Validation loss decreased (1.363280 --> 1.362993).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 37 cost time: 1.7224547863006592
Epoch: 37, Steps: 52 | Train Loss: 0.4421031 Vali Loss: 1.3581994 Test Loss: 0.3761712
Validation loss decreased (1.362993 --> 1.358199).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 38 cost time: 1.7220878601074219
Epoch: 38, Steps: 52 | Train Loss: 0.4417379 Vali Loss: 1.3623040 Test Loss: 0.3766673
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 39 cost time: 1.7198781967163086
Epoch: 39, Steps: 52 | Train Loss: 0.4406347 Vali Loss: 1.3658453 Test Loss: 0.3760022
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 40 cost time: 1.7144222259521484
Epoch: 40, Steps: 52 | Train Loss: 0.4403739 Vali Loss: 1.3566631 Test Loss: 0.3764486
Validation loss decreased (1.358199 --> 1.356663).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 41 cost time: 1.719468116760254
Epoch: 41, Steps: 52 | Train Loss: 0.4414028 Vali Loss: 1.3590770 Test Loss: 0.3749121
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 42 cost time: 1.7152659893035889
Epoch: 42, Steps: 52 | Train Loss: 0.4402358 Vali Loss: 1.3637785 Test Loss: 0.3743072
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 43 cost time: 1.7179813385009766
Epoch: 43, Steps: 52 | Train Loss: 0.4403491 Vali Loss: 1.3662441 Test Loss: 0.3748632
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 44 cost time: 1.715820550918579
Epoch: 44, Steps: 52 | Train Loss: 0.4408569 Vali Loss: 1.3644309 Test Loss: 0.3740864
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 45 cost time: 1.7192151546478271
Epoch: 45, Steps: 52 | Train Loss: 0.4411510 Vali Loss: 1.3539892 Test Loss: 0.3758701
Validation loss decreased (1.356663 --> 1.353989).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 46 cost time: 1.7121307849884033
Epoch: 46, Steps: 52 | Train Loss: 0.4415073 Vali Loss: 1.3552697 Test Loss: 0.3751927
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 47 cost time: 1.7124996185302734
Epoch: 47, Steps: 52 | Train Loss: 0.4406717 Vali Loss: 1.3607304 Test Loss: 0.3743196
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 48 cost time: 1.721381425857544
Epoch: 48, Steps: 52 | Train Loss: 0.4387580 Vali Loss: 1.3600624 Test Loss: 0.3742128
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 49 cost time: 1.7124505043029785
Epoch: 49, Steps: 52 | Train Loss: 0.4403795 Vali Loss: 1.3632658 Test Loss: 0.3740683
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 50 cost time: 1.717944860458374
Epoch: 50, Steps: 52 | Train Loss: 0.4407456 Vali Loss: 1.3565454 Test Loss: 0.3742909
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 51 cost time: 1.7205841541290283
Epoch: 51, Steps: 52 | Train Loss: 0.4405678 Vali Loss: 1.3639754 Test Loss: 0.3750254
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 52 cost time: 1.711944580078125
Epoch: 52, Steps: 52 | Train Loss: 0.4394258 Vali Loss: 1.3617787 Test Loss: 0.3735228
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 53 cost time: 1.7165520191192627
Epoch: 53, Steps: 52 | Train Loss: 0.4408360 Vali Loss: 1.3542811 Test Loss: 0.3737390
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 54 cost time: 1.7153122425079346
Epoch: 54, Steps: 52 | Train Loss: 0.4409335 Vali Loss: 1.3643941 Test Loss: 0.3740362
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 55 cost time: 1.7144241333007812
Epoch: 55, Steps: 52 | Train Loss: 0.4387257 Vali Loss: 1.3577648 Test Loss: 0.3743186
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 56 cost time: 1.7164452075958252
Epoch: 56, Steps: 52 | Train Loss: 0.4396879 Vali Loss: 1.3605626 Test Loss: 0.3743359
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 57 cost time: 1.7161641120910645
Epoch: 57, Steps: 52 | Train Loss: 0.4391721 Vali Loss: 1.3548319 Test Loss: 0.3743640
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 58 cost time: 1.7221572399139404
Epoch: 58, Steps: 52 | Train Loss: 0.4388707 Vali Loss: 1.3645096 Test Loss: 0.3739387
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 59 cost time: 1.7038683891296387
Epoch: 59, Steps: 52 | Train Loss: 0.4390292 Vali Loss: 1.3622253 Test Loss: 0.3730581
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 60 cost time: 1.7270729541778564
Epoch: 60, Steps: 52 | Train Loss: 0.4400690 Vali Loss: 1.3643548 Test Loss: 0.3739544
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.37587013840675354, mae:0.4122348129749298, rse:0.5022589564323425
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.04082822799682617 GB
Epoch: 1 cost time: 2.1730806827545166
Epoch: 1, Steps: 52 | Train Loss: 0.7516521 Vali Loss: 2.2243042 Test Loss: 1.4358935
Validation loss decreased (inf --> 2.224304).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 2 cost time: 0.7883014678955078
Epoch: 2, Steps: 52 | Train Loss: 0.6764102 Vali Loss: 1.8385016 Test Loss: 0.9894041
Validation loss decreased (2.224304 --> 1.838502).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 3 cost time: 0.7937941551208496
Epoch: 3, Steps: 52 | Train Loss: 0.5663941 Vali Loss: 1.5830990 Test Loss: 0.6635636
Validation loss decreased (1.838502 --> 1.583099).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 4 cost time: 0.7770025730133057
Epoch: 4, Steps: 52 | Train Loss: 0.5007111 Vali Loss: 1.4756849 Test Loss: 0.4994885
Validation loss decreased (1.583099 --> 1.475685).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 5 cost time: 0.8901021480560303
Epoch: 5, Steps: 52 | Train Loss: 0.4688042 Vali Loss: 1.4386159 Test Loss: 0.4485210
Validation loss decreased (1.475685 --> 1.438616).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 6 cost time: 1.7650904655456543
Epoch: 6, Steps: 52 | Train Loss: 0.4549310 Vali Loss: 1.4203219 Test Loss: 0.4269056
Validation loss decreased (1.438616 --> 1.420322).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 7 cost time: 1.7633740901947021
Epoch: 7, Steps: 52 | Train Loss: 0.4510914 Vali Loss: 1.4089202 Test Loss: 0.4156415
Validation loss decreased (1.420322 --> 1.408920).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 8 cost time: 1.7544562816619873
Epoch: 8, Steps: 52 | Train Loss: 0.4442061 Vali Loss: 1.3996243 Test Loss: 0.4062302
Validation loss decreased (1.408920 --> 1.399624).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 9 cost time: 1.7562646865844727
Epoch: 9, Steps: 52 | Train Loss: 0.4397078 Vali Loss: 1.3939437 Test Loss: 0.3991786
Validation loss decreased (1.399624 --> 1.393944).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 10 cost time: 1.7678430080413818
Epoch: 10, Steps: 52 | Train Loss: 0.4379216 Vali Loss: 1.3844676 Test Loss: 0.3934106
Validation loss decreased (1.393944 --> 1.384468).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 11 cost time: 1.773144245147705
Epoch: 11, Steps: 52 | Train Loss: 0.4367281 Vali Loss: 1.3769411 Test Loss: 0.3899164
Validation loss decreased (1.384468 --> 1.376941).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 12 cost time: 1.7604386806488037
Epoch: 12, Steps: 52 | Train Loss: 0.4346029 Vali Loss: 1.3711090 Test Loss: 0.3865726
Validation loss decreased (1.376941 --> 1.371109).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 13 cost time: 1.767310619354248
Epoch: 13, Steps: 52 | Train Loss: 0.4349341 Vali Loss: 1.3747311 Test Loss: 0.3825919
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 14 cost time: 1.7636151313781738
Epoch: 14, Steps: 52 | Train Loss: 0.4318629 Vali Loss: 1.3651597 Test Loss: 0.3808768
Validation loss decreased (1.371109 --> 1.365160).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 15 cost time: 1.7665846347808838
Epoch: 15, Steps: 52 | Train Loss: 0.4291961 Vali Loss: 1.3613725 Test Loss: 0.3783480
Validation loss decreased (1.365160 --> 1.361372).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 16 cost time: 1.7616424560546875
Epoch: 16, Steps: 52 | Train Loss: 0.4301563 Vali Loss: 1.3626838 Test Loss: 0.3770054
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 17 cost time: 1.7704026699066162
Epoch: 17, Steps: 52 | Train Loss: 0.4291426 Vali Loss: 1.3538898 Test Loss: 0.3754942
Validation loss decreased (1.361372 --> 1.353890).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 18 cost time: 1.7622663974761963
Epoch: 18, Steps: 52 | Train Loss: 0.4288512 Vali Loss: 1.3629509 Test Loss: 0.3746365
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 19 cost time: 1.7653164863586426
Epoch: 19, Steps: 52 | Train Loss: 0.4262203 Vali Loss: 1.3585560 Test Loss: 0.3730716
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 20 cost time: 1.7657864093780518
Epoch: 20, Steps: 52 | Train Loss: 0.4264251 Vali Loss: 1.3610930 Test Loss: 0.3720143
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 21 cost time: 1.7649948596954346
Epoch: 21, Steps: 52 | Train Loss: 0.4261873 Vali Loss: 1.3574135 Test Loss: 0.3708178
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 22 cost time: 1.771303415298462
Epoch: 22, Steps: 52 | Train Loss: 0.4255587 Vali Loss: 1.3635049 Test Loss: 0.3709171
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 23 cost time: 1.7666399478912354
Epoch: 23, Steps: 52 | Train Loss: 0.4265411 Vali Loss: 1.3525779 Test Loss: 0.3698405
Validation loss decreased (1.353890 --> 1.352578).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 24 cost time: 1.7741210460662842
Epoch: 24, Steps: 52 | Train Loss: 0.4241359 Vali Loss: 1.3487864 Test Loss: 0.3696752
Validation loss decreased (1.352578 --> 1.348786).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 25 cost time: 1.7651550769805908
Epoch: 25, Steps: 52 | Train Loss: 0.4247419 Vali Loss: 1.3499435 Test Loss: 0.3689397
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 26 cost time: 1.7684400081634521
Epoch: 26, Steps: 52 | Train Loss: 0.4246481 Vali Loss: 1.3541667 Test Loss: 0.3684028
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 27 cost time: 1.7595152854919434
Epoch: 27, Steps: 52 | Train Loss: 0.4258246 Vali Loss: 1.3557242 Test Loss: 0.3675899
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 28 cost time: 1.7651591300964355
Epoch: 28, Steps: 52 | Train Loss: 0.4237007 Vali Loss: 1.3570139 Test Loss: 0.3671925
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 29 cost time: 1.7675042152404785
Epoch: 29, Steps: 52 | Train Loss: 0.4242534 Vali Loss: 1.3540671 Test Loss: 0.3675123
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 30 cost time: 1.765821933746338
Epoch: 30, Steps: 52 | Train Loss: 0.4226917 Vali Loss: 1.3410237 Test Loss: 0.3667827
Validation loss decreased (1.348786 --> 1.341024).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 31 cost time: 1.7643916606903076
Epoch: 31, Steps: 52 | Train Loss: 0.4232418 Vali Loss: 1.3418586 Test Loss: 0.3670738
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 32 cost time: 1.7624716758728027
Epoch: 32, Steps: 52 | Train Loss: 0.4236563 Vali Loss: 1.3495058 Test Loss: 0.3662168
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 33 cost time: 1.7630400657653809
Epoch: 33, Steps: 52 | Train Loss: 0.4224958 Vali Loss: 1.3523214 Test Loss: 0.3667322
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 34 cost time: 1.764394760131836
Epoch: 34, Steps: 52 | Train Loss: 0.4215895 Vali Loss: 1.3487425 Test Loss: 0.3655693
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 35 cost time: 1.7708334922790527
Epoch: 35, Steps: 52 | Train Loss: 0.4234598 Vali Loss: 1.3503904 Test Loss: 0.3656189
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 36 cost time: 1.7698476314544678
Epoch: 36, Steps: 52 | Train Loss: 0.4219752 Vali Loss: 1.3522465 Test Loss: 0.3658883
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 37 cost time: 1.7684376239776611
Epoch: 37, Steps: 52 | Train Loss: 0.4224591 Vali Loss: 1.3468094 Test Loss: 0.3655398
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 38 cost time: 1.7763793468475342
Epoch: 38, Steps: 52 | Train Loss: 0.4236693 Vali Loss: 1.3507459 Test Loss: 0.3655751
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 39 cost time: 1.7653074264526367
Epoch: 39, Steps: 52 | Train Loss: 0.4220307 Vali Loss: 1.3550574 Test Loss: 0.3653051
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 40 cost time: 1.7639713287353516
Epoch: 40, Steps: 52 | Train Loss: 0.4240554 Vali Loss: 1.3538326 Test Loss: 0.3653167
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 41 cost time: 1.7638425827026367
Epoch: 41, Steps: 52 | Train Loss: 0.4238609 Vali Loss: 1.3456306 Test Loss: 0.3652869
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 42 cost time: 1.759490728378296
Epoch: 42, Steps: 52 | Train Loss: 0.4207126 Vali Loss: 1.3441236 Test Loss: 0.3650271
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 43 cost time: 1.7544705867767334
Epoch: 43, Steps: 52 | Train Loss: 0.4229733 Vali Loss: 1.3505857 Test Loss: 0.3650407
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 44 cost time: 1.776742935180664
Epoch: 44, Steps: 52 | Train Loss: 0.4219312 Vali Loss: 1.3437703 Test Loss: 0.3646904
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 45 cost time: 1.7665462493896484
Epoch: 45, Steps: 52 | Train Loss: 0.4211528 Vali Loss: 1.3478246 Test Loss: 0.3648586
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 46 cost time: 1.7590985298156738
Epoch: 46, Steps: 52 | Train Loss: 0.4232317 Vali Loss: 1.3496008 Test Loss: 0.3650155
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 47 cost time: 1.7660768032073975
Epoch: 47, Steps: 52 | Train Loss: 0.4219851 Vali Loss: 1.3470453 Test Loss: 0.3648778
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 48 cost time: 1.7664623260498047
Epoch: 48, Steps: 52 | Train Loss: 0.4231945 Vali Loss: 1.3518504 Test Loss: 0.3644024
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 49 cost time: 1.7701048851013184
Epoch: 49, Steps: 52 | Train Loss: 0.4214973 Vali Loss: 1.3532562 Test Loss: 0.3647801
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 50 cost time: 1.7644188404083252
Epoch: 50, Steps: 52 | Train Loss: 0.4223314 Vali Loss: 1.3491304 Test Loss: 0.3643581
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 51 cost time: 1.7648863792419434
Epoch: 51, Steps: 52 | Train Loss: 0.4226792 Vali Loss: 1.3467408 Test Loss: 0.3642835
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 52 cost time: 1.7744495868682861
Epoch: 52, Steps: 52 | Train Loss: 0.4215330 Vali Loss: 1.3401334 Test Loss: 0.3642211
Validation loss decreased (1.341024 --> 1.340133).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 53 cost time: 1.769577980041504
Epoch: 53, Steps: 52 | Train Loss: 0.4217096 Vali Loss: 1.3466320 Test Loss: 0.3647278
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 54 cost time: 1.7791359424591064
Epoch: 54, Steps: 52 | Train Loss: 0.4206222 Vali Loss: 1.3459190 Test Loss: 0.3646367
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 55 cost time: 1.7539215087890625
Epoch: 55, Steps: 52 | Train Loss: 0.4216479 Vali Loss: 1.3440387 Test Loss: 0.3644716
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 56 cost time: 1.756188154220581
Epoch: 56, Steps: 52 | Train Loss: 0.4216594 Vali Loss: 1.3522394 Test Loss: 0.3649481
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 57 cost time: 1.7678487300872803
Epoch: 57, Steps: 52 | Train Loss: 0.4233415 Vali Loss: 1.3502274 Test Loss: 0.3647624
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 58 cost time: 1.7633740901947021
Epoch: 58, Steps: 52 | Train Loss: 0.4227974 Vali Loss: 1.3512983 Test Loss: 0.3644122
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 59 cost time: 1.767503261566162
Epoch: 59, Steps: 52 | Train Loss: 0.4226329 Vali Loss: 1.3454297 Test Loss: 0.3643814
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 60 cost time: 1.767730951309204
Epoch: 60, Steps: 52 | Train Loss: 0.4227686 Vali Loss: 1.3376074 Test Loss: 0.3646491
Validation loss decreased (1.340133 --> 1.337607).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3646491467952728, mae:0.40701380372047424, rse:0.49470511078834534
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04139232635498047 GB
Epoch: 1 cost time: 2.211251735687256
Epoch: 1, Steps: 52 | Train Loss: 0.7291981 Vali Loss: 2.2304239 Test Loss: 1.4478142
Validation loss decreased (inf --> 2.230424).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 2 cost time: 0.8134582042694092
Epoch: 2, Steps: 52 | Train Loss: 0.6683508 Vali Loss: 1.8917191 Test Loss: 1.0478425
Validation loss decreased (2.230424 --> 1.891719).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 3 cost time: 0.8110005855560303
Epoch: 3, Steps: 52 | Train Loss: 0.5685015 Vali Loss: 1.6334656 Test Loss: 0.7124827
Validation loss decreased (1.891719 --> 1.633466).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 4 cost time: 0.8110876083374023
Epoch: 4, Steps: 52 | Train Loss: 0.5056322 Vali Loss: 1.5103282 Test Loss: 0.5348964
Validation loss decreased (1.633466 --> 1.510328).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 5 cost time: 1.212367296218872
Epoch: 5, Steps: 52 | Train Loss: 0.4756460 Vali Loss: 1.4668207 Test Loss: 0.4767894
Validation loss decreased (1.510328 --> 1.466821).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 6 cost time: 1.8205881118774414
Epoch: 6, Steps: 52 | Train Loss: 0.4613250 Vali Loss: 1.4396501 Test Loss: 0.4467468
Validation loss decreased (1.466821 --> 1.439650).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 7 cost time: 1.818143606185913
Epoch: 7, Steps: 52 | Train Loss: 0.4525333 Vali Loss: 1.4165981 Test Loss: 0.4289401
Validation loss decreased (1.439650 --> 1.416598).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 8 cost time: 1.8134684562683105
Epoch: 8, Steps: 52 | Train Loss: 0.4462412 Vali Loss: 1.4055305 Test Loss: 0.4144160
Validation loss decreased (1.416598 --> 1.405530).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 9 cost time: 1.8187012672424316
Epoch: 9, Steps: 52 | Train Loss: 0.4402654 Vali Loss: 1.3968613 Test Loss: 0.4049679
Validation loss decreased (1.405530 --> 1.396861).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 10 cost time: 1.8211166858673096
Epoch: 10, Steps: 52 | Train Loss: 0.4371944 Vali Loss: 1.3815247 Test Loss: 0.3975834
Validation loss decreased (1.396861 --> 1.381525).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 11 cost time: 1.8194141387939453
Epoch: 11, Steps: 52 | Train Loss: 0.4358291 Vali Loss: 1.3739762 Test Loss: 0.3918281
Validation loss decreased (1.381525 --> 1.373976).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 12 cost time: 1.818514108657837
Epoch: 12, Steps: 52 | Train Loss: 0.4328838 Vali Loss: 1.3661242 Test Loss: 0.3881084
Validation loss decreased (1.373976 --> 1.366124).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 13 cost time: 1.8238344192504883
Epoch: 13, Steps: 52 | Train Loss: 0.4309682 Vali Loss: 1.3707554 Test Loss: 0.3847234
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 14 cost time: 1.8283145427703857
Epoch: 14, Steps: 52 | Train Loss: 0.4288298 Vali Loss: 1.3629857 Test Loss: 0.3825333
Validation loss decreased (1.366124 --> 1.362986).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 15 cost time: 1.8203849792480469
Epoch: 15, Steps: 52 | Train Loss: 0.4271911 Vali Loss: 1.3622429 Test Loss: 0.3796636
Validation loss decreased (1.362986 --> 1.362243).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 16 cost time: 1.812992811203003
Epoch: 16, Steps: 52 | Train Loss: 0.4286226 Vali Loss: 1.3630087 Test Loss: 0.3775622
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 17 cost time: 1.817429542541504
Epoch: 17, Steps: 52 | Train Loss: 0.4280512 Vali Loss: 1.3591442 Test Loss: 0.3762531
Validation loss decreased (1.362243 --> 1.359144).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 18 cost time: 1.8224077224731445
Epoch: 18, Steps: 52 | Train Loss: 0.4270059 Vali Loss: 1.3545308 Test Loss: 0.3743460
Validation loss decreased (1.359144 --> 1.354531).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 19 cost time: 1.825317144393921
Epoch: 19, Steps: 52 | Train Loss: 0.4262082 Vali Loss: 1.3510110 Test Loss: 0.3732473
Validation loss decreased (1.354531 --> 1.351011).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 20 cost time: 1.8249306678771973
Epoch: 20, Steps: 52 | Train Loss: 0.4264900 Vali Loss: 1.3525012 Test Loss: 0.3724675
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 21 cost time: 1.8213715553283691
Epoch: 21, Steps: 52 | Train Loss: 0.4221704 Vali Loss: 1.3518968 Test Loss: 0.3723879
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 22 cost time: 1.8291115760803223
Epoch: 22, Steps: 52 | Train Loss: 0.4245102 Vali Loss: 1.3524230 Test Loss: 0.3718193
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 23 cost time: 1.8214068412780762
Epoch: 23, Steps: 52 | Train Loss: 0.4226082 Vali Loss: 1.3347785 Test Loss: 0.3711029
Validation loss decreased (1.351011 --> 1.334779).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 24 cost time: 1.8255577087402344
Epoch: 24, Steps: 52 | Train Loss: 0.4231040 Vali Loss: 1.3533872 Test Loss: 0.3702167
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 25 cost time: 1.8210947513580322
Epoch: 25, Steps: 52 | Train Loss: 0.4231202 Vali Loss: 1.3520947 Test Loss: 0.3695897
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 26 cost time: 1.8146185874938965
Epoch: 26, Steps: 52 | Train Loss: 0.4244937 Vali Loss: 1.3487117 Test Loss: 0.3701954
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 27 cost time: 1.8089985847473145
Epoch: 27, Steps: 52 | Train Loss: 0.4210633 Vali Loss: 1.3424599 Test Loss: 0.3688318
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 28 cost time: 1.8280506134033203
Epoch: 28, Steps: 52 | Train Loss: 0.4207945 Vali Loss: 1.3490822 Test Loss: 0.3694798
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 29 cost time: 1.8178529739379883
Epoch: 29, Steps: 52 | Train Loss: 0.4207225 Vali Loss: 1.3387823 Test Loss: 0.3684143
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 30 cost time: 1.8293845653533936
Epoch: 30, Steps: 52 | Train Loss: 0.4231874 Vali Loss: 1.3356404 Test Loss: 0.3683929
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 31 cost time: 1.816110372543335
Epoch: 31, Steps: 52 | Train Loss: 0.4223416 Vali Loss: 1.3437073 Test Loss: 0.3674609
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 32 cost time: 1.8203456401824951
Epoch: 32, Steps: 52 | Train Loss: 0.4210055 Vali Loss: 1.3373330 Test Loss: 0.3675063
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 33 cost time: 1.8316235542297363
Epoch: 33, Steps: 52 | Train Loss: 0.4219984 Vali Loss: 1.3456372 Test Loss: 0.3681432
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 34 cost time: 1.8257827758789062
Epoch: 34, Steps: 52 | Train Loss: 0.4217387 Vali Loss: 1.3409052 Test Loss: 0.3674651
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 35 cost time: 1.8303465843200684
Epoch: 35, Steps: 52 | Train Loss: 0.4205472 Vali Loss: 1.3443449 Test Loss: 0.3674719
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 36 cost time: 1.8189678192138672
Epoch: 36, Steps: 52 | Train Loss: 0.4221640 Vali Loss: 1.3338696 Test Loss: 0.3678263
Validation loss decreased (1.334779 --> 1.333870).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 37 cost time: 1.8280479907989502
Epoch: 37, Steps: 52 | Train Loss: 0.4210817 Vali Loss: 1.3432693 Test Loss: 0.3673546
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 38 cost time: 1.8225266933441162
Epoch: 38, Steps: 52 | Train Loss: 0.4207225 Vali Loss: 1.3388083 Test Loss: 0.3671612
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 39 cost time: 1.8193769454956055
Epoch: 39, Steps: 52 | Train Loss: 0.4223889 Vali Loss: 1.3431838 Test Loss: 0.3670268
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 40 cost time: 1.816810131072998
Epoch: 40, Steps: 52 | Train Loss: 0.4189295 Vali Loss: 1.3452771 Test Loss: 0.3671188
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 41 cost time: 1.8233025074005127
Epoch: 41, Steps: 52 | Train Loss: 0.4185132 Vali Loss: 1.3443464 Test Loss: 0.3677718
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 42 cost time: 1.827981948852539
Epoch: 42, Steps: 52 | Train Loss: 0.4224161 Vali Loss: 1.3427222 Test Loss: 0.3665935
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 43 cost time: 1.8141124248504639
Epoch: 43, Steps: 52 | Train Loss: 0.4222314 Vali Loss: 1.3445250 Test Loss: 0.3670509
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 44 cost time: 1.8192052841186523
Epoch: 44, Steps: 52 | Train Loss: 0.4209943 Vali Loss: 1.3368223 Test Loss: 0.3661452
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 45 cost time: 1.8204429149627686
Epoch: 45, Steps: 52 | Train Loss: 0.4215178 Vali Loss: 1.3419662 Test Loss: 0.3664922
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 46 cost time: 1.8130199909210205
Epoch: 46, Steps: 52 | Train Loss: 0.4210869 Vali Loss: 1.3418567 Test Loss: 0.3662533
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 47 cost time: 1.811805009841919
Epoch: 47, Steps: 52 | Train Loss: 0.4205188 Vali Loss: 1.3367138 Test Loss: 0.3663932
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 48 cost time: 1.8235135078430176
Epoch: 48, Steps: 52 | Train Loss: 0.4213475 Vali Loss: 1.3413069 Test Loss: 0.3657948
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 49 cost time: 1.820260763168335
Epoch: 49, Steps: 52 | Train Loss: 0.4211859 Vali Loss: 1.3421041 Test Loss: 0.3664070
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 50 cost time: 1.8244116306304932
Epoch: 50, Steps: 52 | Train Loss: 0.4198495 Vali Loss: 1.3440888 Test Loss: 0.3672951
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 51 cost time: 1.822516679763794
Epoch: 51, Steps: 52 | Train Loss: 0.4209026 Vali Loss: 1.3383253 Test Loss: 0.3667638
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 52 cost time: 1.8300244808197021
Epoch: 52, Steps: 52 | Train Loss: 0.4211153 Vali Loss: 1.3431642 Test Loss: 0.3665855
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 53 cost time: 1.8158128261566162
Epoch: 53, Steps: 52 | Train Loss: 0.4201614 Vali Loss: 1.3384576 Test Loss: 0.3665388
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 54 cost time: 1.8024768829345703
Epoch: 54, Steps: 52 | Train Loss: 0.4211480 Vali Loss: 1.3344095 Test Loss: 0.3664799
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 55 cost time: 1.8171217441558838
Epoch: 55, Steps: 52 | Train Loss: 0.4210095 Vali Loss: 1.3410149 Test Loss: 0.3667959
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 56 cost time: 1.8154401779174805
Epoch: 56, Steps: 52 | Train Loss: 0.4200066 Vali Loss: 1.3372204 Test Loss: 0.3661283
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 57 cost time: 1.815565824508667
Epoch: 57, Steps: 52 | Train Loss: 0.4193067 Vali Loss: 1.3395176 Test Loss: 0.3658234
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 58 cost time: 1.8166980743408203
Epoch: 58, Steps: 52 | Train Loss: 0.4213259 Vali Loss: 1.3387688 Test Loss: 0.3667369
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 59 cost time: 1.8246448040008545
Epoch: 59, Steps: 52 | Train Loss: 0.4202300 Vali Loss: 1.3368756 Test Loss: 0.3661718
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 60 cost time: 1.814077377319336
Epoch: 60, Steps: 52 | Train Loss: 0.4215884 Vali Loss: 1.3401525 Test Loss: 0.3664953
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36782631278038025, mae:0.41165515780448914, rse:0.49685561656951904
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04735612869262695 GB
Epoch: 1 cost time: 2.1389667987823486
Epoch: 1, Steps: 52 | Train Loss: 0.8181787 Vali Loss: 2.1358728 Test Loss: 1.3271041
Validation loss decreased (inf --> 2.135873).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 2 cost time: 0.7556138038635254
Epoch: 2, Steps: 52 | Train Loss: 0.7249934 Vali Loss: 1.7857019 Test Loss: 0.8845052
Validation loss decreased (2.135873 --> 1.785702).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 3 cost time: 0.7534406185150146
Epoch: 3, Steps: 52 | Train Loss: 0.6130484 Vali Loss: 1.6309299 Test Loss: 0.6867276
Validation loss decreased (1.785702 --> 1.630930).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 4 cost time: 0.7597897052764893
Epoch: 4, Steps: 52 | Train Loss: 0.5572973 Vali Loss: 1.5419468 Test Loss: 0.5784534
Validation loss decreased (1.630930 --> 1.541947).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 5 cost time: 0.7469997406005859
Epoch: 5, Steps: 52 | Train Loss: 0.5283465 Vali Loss: 1.4890301 Test Loss: 0.5256728
Validation loss decreased (1.541947 --> 1.489030).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 6 cost time: 1.6456451416015625
Epoch: 6, Steps: 52 | Train Loss: 0.5067122 Vali Loss: 1.4615502 Test Loss: 0.4905051
Validation loss decreased (1.489030 --> 1.461550).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 7 cost time: 1.6584770679473877
Epoch: 7, Steps: 52 | Train Loss: 0.4976646 Vali Loss: 1.4431448 Test Loss: 0.4684331
Validation loss decreased (1.461550 --> 1.443145).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 8 cost time: 1.6526861190795898
Epoch: 8, Steps: 52 | Train Loss: 0.4864365 Vali Loss: 1.4330854 Test Loss: 0.4512254
Validation loss decreased (1.443145 --> 1.433085).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 9 cost time: 1.6566720008850098
Epoch: 9, Steps: 52 | Train Loss: 0.4805946 Vali Loss: 1.4191500 Test Loss: 0.4391536
Validation loss decreased (1.433085 --> 1.419150).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 10 cost time: 1.6540238857269287
Epoch: 10, Steps: 52 | Train Loss: 0.4753205 Vali Loss: 1.4050416 Test Loss: 0.4303447
Validation loss decreased (1.419150 --> 1.405042).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 11 cost time: 1.6552128791809082
Epoch: 11, Steps: 52 | Train Loss: 0.4707336 Vali Loss: 1.4009649 Test Loss: 0.4221860
Validation loss decreased (1.405042 --> 1.400965).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 12 cost time: 1.6478524208068848
Epoch: 12, Steps: 52 | Train Loss: 0.4690068 Vali Loss: 1.3898747 Test Loss: 0.4157050
Validation loss decreased (1.400965 --> 1.389875).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 13 cost time: 1.6635606288909912
Epoch: 13, Steps: 52 | Train Loss: 0.4645123 Vali Loss: 1.3847797 Test Loss: 0.4101046
Validation loss decreased (1.389875 --> 1.384780).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 14 cost time: 1.6491968631744385
Epoch: 14, Steps: 52 | Train Loss: 0.4623520 Vali Loss: 1.3878707 Test Loss: 0.4055119
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 15 cost time: 1.6494839191436768
Epoch: 15, Steps: 52 | Train Loss: 0.4621393 Vali Loss: 1.3792386 Test Loss: 0.4002290
Validation loss decreased (1.384780 --> 1.379239).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 16 cost time: 1.6494276523590088
Epoch: 16, Steps: 52 | Train Loss: 0.4581600 Vali Loss: 1.3805013 Test Loss: 0.3996079
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 17 cost time: 1.6545581817626953
Epoch: 17, Steps: 52 | Train Loss: 0.4567863 Vali Loss: 1.3805293 Test Loss: 0.3965170
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 18 cost time: 1.6547799110412598
Epoch: 18, Steps: 52 | Train Loss: 0.4556055 Vali Loss: 1.3737365 Test Loss: 0.3937832
Validation loss decreased (1.379239 --> 1.373737).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 19 cost time: 1.6625189781188965
Epoch: 19, Steps: 52 | Train Loss: 0.4547829 Vali Loss: 1.3695016 Test Loss: 0.3911597
Validation loss decreased (1.373737 --> 1.369502).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 20 cost time: 1.6614494323730469
Epoch: 20, Steps: 52 | Train Loss: 0.4534950 Vali Loss: 1.3716350 Test Loss: 0.3900296
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 21 cost time: 1.6623988151550293
Epoch: 21, Steps: 52 | Train Loss: 0.4517145 Vali Loss: 1.3732169 Test Loss: 0.3887318
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 22 cost time: 1.6534652709960938
Epoch: 22, Steps: 52 | Train Loss: 0.4523230 Vali Loss: 1.3695066 Test Loss: 0.3867146
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 23 cost time: 1.6603922843933105
Epoch: 23, Steps: 52 | Train Loss: 0.4499124 Vali Loss: 1.3626041 Test Loss: 0.3854336
Validation loss decreased (1.369502 --> 1.362604).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 24 cost time: 1.655646562576294
Epoch: 24, Steps: 52 | Train Loss: 0.4500483 Vali Loss: 1.3657883 Test Loss: 0.3849388
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 25 cost time: 1.661773920059204
Epoch: 25, Steps: 52 | Train Loss: 0.4488048 Vali Loss: 1.3626198 Test Loss: 0.3835311
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 26 cost time: 1.6546170711517334
Epoch: 26, Steps: 52 | Train Loss: 0.4488519 Vali Loss: 1.3670398 Test Loss: 0.3817906
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 27 cost time: 1.6502001285552979
Epoch: 27, Steps: 52 | Train Loss: 0.4492280 Vali Loss: 1.3560207 Test Loss: 0.3819984
Validation loss decreased (1.362604 --> 1.356021).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 28 cost time: 1.6550378799438477
Epoch: 28, Steps: 52 | Train Loss: 0.4488784 Vali Loss: 1.3587537 Test Loss: 0.3817198
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 29 cost time: 1.6589090824127197
Epoch: 29, Steps: 52 | Train Loss: 0.4454304 Vali Loss: 1.3567202 Test Loss: 0.3797008
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 30 cost time: 1.6554920673370361
Epoch: 30, Steps: 52 | Train Loss: 0.4478551 Vali Loss: 1.3606701 Test Loss: 0.3802628
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 31 cost time: 1.6582419872283936
Epoch: 31, Steps: 52 | Train Loss: 0.4471233 Vali Loss: 1.3595160 Test Loss: 0.3784310
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 32 cost time: 1.6565368175506592
Epoch: 32, Steps: 52 | Train Loss: 0.4468923 Vali Loss: 1.3600414 Test Loss: 0.3782127
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 33 cost time: 1.6627545356750488
Epoch: 33, Steps: 52 | Train Loss: 0.4447309 Vali Loss: 1.3529346 Test Loss: 0.3781424
Validation loss decreased (1.356021 --> 1.352935).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 34 cost time: 1.6555132865905762
Epoch: 34, Steps: 52 | Train Loss: 0.4469024 Vali Loss: 1.3625107 Test Loss: 0.3781373
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 35 cost time: 1.6607551574707031
Epoch: 35, Steps: 52 | Train Loss: 0.4471187 Vali Loss: 1.3495889 Test Loss: 0.3771886
Validation loss decreased (1.352935 --> 1.349589).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 36 cost time: 1.6693878173828125
Epoch: 36, Steps: 52 | Train Loss: 0.4461220 Vali Loss: 1.3627437 Test Loss: 0.3781545
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 37 cost time: 1.6589961051940918
Epoch: 37, Steps: 52 | Train Loss: 0.4471518 Vali Loss: 1.3583498 Test Loss: 0.3775836
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 38 cost time: 1.6629762649536133
Epoch: 38, Steps: 52 | Train Loss: 0.4449058 Vali Loss: 1.3564323 Test Loss: 0.3762960
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 39 cost time: 1.6571354866027832
Epoch: 39, Steps: 52 | Train Loss: 0.4442280 Vali Loss: 1.3512409 Test Loss: 0.3767633
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 40 cost time: 1.657081127166748
Epoch: 40, Steps: 52 | Train Loss: 0.4450210 Vali Loss: 1.3519006 Test Loss: 0.3759277
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 41 cost time: 1.6600275039672852
Epoch: 41, Steps: 52 | Train Loss: 0.4455826 Vali Loss: 1.3532484 Test Loss: 0.3763230
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 42 cost time: 1.6482477188110352
Epoch: 42, Steps: 52 | Train Loss: 0.4437879 Vali Loss: 1.3448422 Test Loss: 0.3761052
Validation loss decreased (1.349589 --> 1.344842).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 43 cost time: 1.6634972095489502
Epoch: 43, Steps: 52 | Train Loss: 0.4449587 Vali Loss: 1.3568797 Test Loss: 0.3751240
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 44 cost time: 1.6534833908081055
Epoch: 44, Steps: 52 | Train Loss: 0.4452090 Vali Loss: 1.3621784 Test Loss: 0.3766730
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 45 cost time: 1.6692533493041992
Epoch: 45, Steps: 52 | Train Loss: 0.4436747 Vali Loss: 1.3581312 Test Loss: 0.3757270
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 46 cost time: 1.6504549980163574
Epoch: 46, Steps: 52 | Train Loss: 0.4439561 Vali Loss: 1.3593088 Test Loss: 0.3762976
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 47 cost time: 1.644775390625
Epoch: 47, Steps: 52 | Train Loss: 0.4431661 Vali Loss: 1.3576723 Test Loss: 0.3752396
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 48 cost time: 1.653646469116211
Epoch: 48, Steps: 52 | Train Loss: 0.4455882 Vali Loss: 1.3571962 Test Loss: 0.3746254
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 49 cost time: 1.6550970077514648
Epoch: 49, Steps: 52 | Train Loss: 0.4442148 Vali Loss: 1.3582031 Test Loss: 0.3747560
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 50 cost time: 1.6566476821899414
Epoch: 50, Steps: 52 | Train Loss: 0.4431891 Vali Loss: 1.3606260 Test Loss: 0.3758526
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 51 cost time: 1.6556735038757324
Epoch: 51, Steps: 52 | Train Loss: 0.4440882 Vali Loss: 1.3533890 Test Loss: 0.3753099
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 52 cost time: 1.6498544216156006
Epoch: 52, Steps: 52 | Train Loss: 0.4429782 Vali Loss: 1.3484540 Test Loss: 0.3752208
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 53 cost time: 1.6594538688659668
Epoch: 53, Steps: 52 | Train Loss: 0.4456352 Vali Loss: 1.3519758 Test Loss: 0.3748185
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 54 cost time: 1.6565217971801758
Epoch: 54, Steps: 52 | Train Loss: 0.4439633 Vali Loss: 1.3512247 Test Loss: 0.3748989
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 55 cost time: 1.6657538414001465
Epoch: 55, Steps: 52 | Train Loss: 0.4459888 Vali Loss: 1.3611813 Test Loss: 0.3751194
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 56 cost time: 1.6584224700927734
Epoch: 56, Steps: 52 | Train Loss: 0.4442924 Vali Loss: 1.3613430 Test Loss: 0.3755122
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 57 cost time: 1.653479814529419
Epoch: 57, Steps: 52 | Train Loss: 0.4442619 Vali Loss: 1.3581724 Test Loss: 0.3753775
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 58 cost time: 1.6574428081512451
Epoch: 58, Steps: 52 | Train Loss: 0.4439714 Vali Loss: 1.3556855 Test Loss: 0.3746752
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 59 cost time: 1.656559705734253
Epoch: 59, Steps: 52 | Train Loss: 0.4432267 Vali Loss: 1.3600473 Test Loss: 0.3746308
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 60 cost time: 1.6599960327148438
Epoch: 60, Steps: 52 | Train Loss: 0.4445740 Vali Loss: 1.3569138 Test Loss: 0.3754579
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3761051893234253, mae:0.4144144058227539, rse:0.5024160146713257
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.04805755615234375 GB
Epoch: 1 cost time: 2.1701927185058594
Epoch: 1, Steps: 52 | Train Loss: 0.7590920 Vali Loss: 2.2343178 Test Loss: 1.4619193
Validation loss decreased (inf --> 2.234318).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 2 cost time: 0.7839987277984619
Epoch: 2, Steps: 52 | Train Loss: 0.6948666 Vali Loss: 1.9157468 Test Loss: 1.0829787
Validation loss decreased (2.234318 --> 1.915747).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 3 cost time: 0.7846441268920898
Epoch: 3, Steps: 52 | Train Loss: 0.5920020 Vali Loss: 1.6709018 Test Loss: 0.7512807
Validation loss decreased (1.915747 --> 1.670902).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 4 cost time: 0.7644467353820801
Epoch: 4, Steps: 52 | Train Loss: 0.5194444 Vali Loss: 1.5302825 Test Loss: 0.5608851
Validation loss decreased (1.670902 --> 1.530282).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 5 cost time: 0.7677342891693115
Epoch: 5, Steps: 52 | Train Loss: 0.4876460 Vali Loss: 1.4724795 Test Loss: 0.4914583
Validation loss decreased (1.530282 --> 1.472479).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 6 cost time: 1.7267365455627441
Epoch: 6, Steps: 52 | Train Loss: 0.4732802 Vali Loss: 1.4468324 Test Loss: 0.4562308
Validation loss decreased (1.472479 --> 1.446832).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 7 cost time: 1.724515438079834
Epoch: 7, Steps: 52 | Train Loss: 0.4633746 Vali Loss: 1.4244630 Test Loss: 0.4341531
Validation loss decreased (1.446832 --> 1.424463).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 8 cost time: 1.7234506607055664
Epoch: 8, Steps: 52 | Train Loss: 0.4575999 Vali Loss: 1.4137843 Test Loss: 0.4207308
Validation loss decreased (1.424463 --> 1.413784).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 9 cost time: 1.7115540504455566
Epoch: 9, Steps: 52 | Train Loss: 0.4526337 Vali Loss: 1.3943031 Test Loss: 0.4089943
Validation loss decreased (1.413784 --> 1.394303).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 10 cost time: 1.7124197483062744
Epoch: 10, Steps: 52 | Train Loss: 0.4479139 Vali Loss: 1.3922725 Test Loss: 0.4007060
Validation loss decreased (1.394303 --> 1.392272).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 11 cost time: 1.7135169506072998
Epoch: 11, Steps: 52 | Train Loss: 0.4468807 Vali Loss: 1.3835087 Test Loss: 0.3961569
Validation loss decreased (1.392272 --> 1.383509).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 12 cost time: 1.715482473373413
Epoch: 12, Steps: 52 | Train Loss: 0.4441474 Vali Loss: 1.3819983 Test Loss: 0.3910060
Validation loss decreased (1.383509 --> 1.381998).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 13 cost time: 1.7154390811920166
Epoch: 13, Steps: 52 | Train Loss: 0.4413458 Vali Loss: 1.3778362 Test Loss: 0.3863797
Validation loss decreased (1.381998 --> 1.377836).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 14 cost time: 1.7170336246490479
Epoch: 14, Steps: 52 | Train Loss: 0.4405585 Vali Loss: 1.3593587 Test Loss: 0.3829723
Validation loss decreased (1.377836 --> 1.359359).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 15 cost time: 1.7144460678100586
Epoch: 15, Steps: 52 | Train Loss: 0.4389428 Vali Loss: 1.3732139 Test Loss: 0.3804778
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 16 cost time: 1.7201671600341797
Epoch: 16, Steps: 52 | Train Loss: 0.4377008 Vali Loss: 1.3713095 Test Loss: 0.3780838
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 17 cost time: 1.7234997749328613
Epoch: 17, Steps: 52 | Train Loss: 0.4353681 Vali Loss: 1.3664110 Test Loss: 0.3765453
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 18 cost time: 1.7204539775848389
Epoch: 18, Steps: 52 | Train Loss: 0.4337721 Vali Loss: 1.3505675 Test Loss: 0.3747799
Validation loss decreased (1.359359 --> 1.350567).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 19 cost time: 1.7209594249725342
Epoch: 19, Steps: 52 | Train Loss: 0.4348605 Vali Loss: 1.3569021 Test Loss: 0.3730409
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 20 cost time: 1.718545913696289
Epoch: 20, Steps: 52 | Train Loss: 0.4344865 Vali Loss: 1.3571308 Test Loss: 0.3729690
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 21 cost time: 1.7315123081207275
Epoch: 21, Steps: 52 | Train Loss: 0.4333712 Vali Loss: 1.3564329 Test Loss: 0.3713347
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 22 cost time: 1.7162761688232422
Epoch: 22, Steps: 52 | Train Loss: 0.4322605 Vali Loss: 1.3539121 Test Loss: 0.3709056
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 23 cost time: 1.733173131942749
Epoch: 23, Steps: 52 | Train Loss: 0.4313350 Vali Loss: 1.3557323 Test Loss: 0.3705389
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 24 cost time: 1.710615873336792
Epoch: 24, Steps: 52 | Train Loss: 0.4324871 Vali Loss: 1.3548653 Test Loss: 0.3691187
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 25 cost time: 1.7326395511627197
Epoch: 25, Steps: 52 | Train Loss: 0.4305406 Vali Loss: 1.3592441 Test Loss: 0.3687542
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 26 cost time: 1.7298505306243896
Epoch: 26, Steps: 52 | Train Loss: 0.4319324 Vali Loss: 1.3536177 Test Loss: 0.3669233
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 27 cost time: 1.7342803478240967
Epoch: 27, Steps: 52 | Train Loss: 0.4292799 Vali Loss: 1.3497746 Test Loss: 0.3673514
Validation loss decreased (1.350567 --> 1.349775).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 28 cost time: 1.716933012008667
Epoch: 28, Steps: 52 | Train Loss: 0.4311231 Vali Loss: 1.3558273 Test Loss: 0.3672746
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 29 cost time: 1.7260305881500244
Epoch: 29, Steps: 52 | Train Loss: 0.4302711 Vali Loss: 1.3455665 Test Loss: 0.3662986
Validation loss decreased (1.349775 --> 1.345567).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 30 cost time: 1.7230675220489502
Epoch: 30, Steps: 52 | Train Loss: 0.4289024 Vali Loss: 1.3546169 Test Loss: 0.3666174
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 31 cost time: 1.7221105098724365
Epoch: 31, Steps: 52 | Train Loss: 0.4284371 Vali Loss: 1.3545499 Test Loss: 0.3659444
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 32 cost time: 1.719501256942749
Epoch: 32, Steps: 52 | Train Loss: 0.4290676 Vali Loss: 1.3491530 Test Loss: 0.3655278
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 33 cost time: 1.725884199142456
Epoch: 33, Steps: 52 | Train Loss: 0.4287246 Vali Loss: 1.3549778 Test Loss: 0.3651406
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 34 cost time: 1.720909833908081
Epoch: 34, Steps: 52 | Train Loss: 0.4278243 Vali Loss: 1.3534546 Test Loss: 0.3645922
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 35 cost time: 1.7149202823638916
Epoch: 35, Steps: 52 | Train Loss: 0.4276188 Vali Loss: 1.3524368 Test Loss: 0.3649927
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 36 cost time: 1.7264859676361084
Epoch: 36, Steps: 52 | Train Loss: 0.4292961 Vali Loss: 1.3498402 Test Loss: 0.3646122
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 37 cost time: 1.7280890941619873
Epoch: 37, Steps: 52 | Train Loss: 0.4295398 Vali Loss: 1.3453804 Test Loss: 0.3648067
Validation loss decreased (1.345567 --> 1.345380).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 38 cost time: 1.7201974391937256
Epoch: 38, Steps: 52 | Train Loss: 0.4280151 Vali Loss: 1.3500365 Test Loss: 0.3635155
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 39 cost time: 1.7263946533203125
Epoch: 39, Steps: 52 | Train Loss: 0.4275547 Vali Loss: 1.3444743 Test Loss: 0.3643219
Validation loss decreased (1.345380 --> 1.344474).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 40 cost time: 1.72222900390625
Epoch: 40, Steps: 52 | Train Loss: 0.4288203 Vali Loss: 1.3460037 Test Loss: 0.3642214
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 41 cost time: 1.714827537536621
Epoch: 41, Steps: 52 | Train Loss: 0.4268543 Vali Loss: 1.3480599 Test Loss: 0.3645968
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 42 cost time: 1.7189033031463623
Epoch: 42, Steps: 52 | Train Loss: 0.4278655 Vali Loss: 1.3460827 Test Loss: 0.3638890
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 43 cost time: 1.7255353927612305
Epoch: 43, Steps: 52 | Train Loss: 0.4267413 Vali Loss: 1.3360434 Test Loss: 0.3639315
Validation loss decreased (1.344474 --> 1.336043).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 44 cost time: 1.7230916023254395
Epoch: 44, Steps: 52 | Train Loss: 0.4279734 Vali Loss: 1.3465004 Test Loss: 0.3644232
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 45 cost time: 1.7182579040527344
Epoch: 45, Steps: 52 | Train Loss: 0.4280630 Vali Loss: 1.3441017 Test Loss: 0.3640922
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 46 cost time: 1.7293822765350342
Epoch: 46, Steps: 52 | Train Loss: 0.4266352 Vali Loss: 1.3525970 Test Loss: 0.3635477
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 47 cost time: 1.7203552722930908
Epoch: 47, Steps: 52 | Train Loss: 0.4269325 Vali Loss: 1.3473449 Test Loss: 0.3639469
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 48 cost time: 1.7158706188201904
Epoch: 48, Steps: 52 | Train Loss: 0.4266169 Vali Loss: 1.3463689 Test Loss: 0.3637767
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 49 cost time: 1.7283811569213867
Epoch: 49, Steps: 52 | Train Loss: 0.4277303 Vali Loss: 1.3458200 Test Loss: 0.3636968
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 50 cost time: 1.730112075805664
Epoch: 50, Steps: 52 | Train Loss: 0.4280627 Vali Loss: 1.3480234 Test Loss: 0.3637734
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 51 cost time: 1.723052978515625
Epoch: 51, Steps: 52 | Train Loss: 0.4267644 Vali Loss: 1.3401328 Test Loss: 0.3631653
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 52 cost time: 1.7283847332000732
Epoch: 52, Steps: 52 | Train Loss: 0.4272906 Vali Loss: 1.3447354 Test Loss: 0.3634646
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 53 cost time: 1.7204794883728027
Epoch: 53, Steps: 52 | Train Loss: 0.4278503 Vali Loss: 1.3431605 Test Loss: 0.3632643
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 54 cost time: 1.7245113849639893
Epoch: 54, Steps: 52 | Train Loss: 0.4282258 Vali Loss: 1.3451074 Test Loss: 0.3633460
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 55 cost time: 1.7237873077392578
Epoch: 55, Steps: 52 | Train Loss: 0.4267063 Vali Loss: 1.3482131 Test Loss: 0.3632714
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 56 cost time: 1.7272348403930664
Epoch: 56, Steps: 52 | Train Loss: 0.4264753 Vali Loss: 1.3541409 Test Loss: 0.3631911
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 57 cost time: 1.7271440029144287
Epoch: 57, Steps: 52 | Train Loss: 0.4283473 Vali Loss: 1.3494425 Test Loss: 0.3634962
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 58 cost time: 1.7160427570343018
Epoch: 58, Steps: 52 | Train Loss: 0.4293925 Vali Loss: 1.3464893 Test Loss: 0.3639338
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 59 cost time: 1.7166736125946045
Epoch: 59, Steps: 52 | Train Loss: 0.4277469 Vali Loss: 1.3479787 Test Loss: 0.3635525
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 60 cost time: 1.7130165100097656
Epoch: 60, Steps: 52 | Train Loss: 0.4278817 Vali Loss: 1.3388103 Test Loss: 0.3629438
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3639315366744995, mae:0.4084439277648926, rse:0.4942181408405304
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.04862165451049805 GB
Epoch: 1 cost time: 2.1680490970611572
Epoch: 1, Steps: 52 | Train Loss: 0.7207923 Vali Loss: 2.1819470 Test Loss: 1.4642167
Validation loss decreased (inf --> 2.181947).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 2 cost time: 0.7930328845977783
Epoch: 2, Steps: 52 | Train Loss: 0.6692409 Vali Loss: 1.9062325 Test Loss: 1.1201910
Validation loss decreased (2.181947 --> 1.906232).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 3 cost time: 0.7878110408782959
Epoch: 3, Steps: 52 | Train Loss: 0.5792075 Vali Loss: 1.6469853 Test Loss: 0.7751624
Validation loss decreased (1.906232 --> 1.646985).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 4 cost time: 0.798633337020874
Epoch: 4, Steps: 52 | Train Loss: 0.5092656 Vali Loss: 1.4970164 Test Loss: 0.5370351
Validation loss decreased (1.646985 --> 1.497016).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 5 cost time: 0.9083783626556396
Epoch: 5, Steps: 52 | Train Loss: 0.4726777 Vali Loss: 1.4414067 Test Loss: 0.4602540
Validation loss decreased (1.497016 --> 1.441407).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 6 cost time: 1.7685351371765137
Epoch: 6, Steps: 52 | Train Loss: 0.4575122 Vali Loss: 1.4170058 Test Loss: 0.4329755
Validation loss decreased (1.441407 --> 1.417006).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 7 cost time: 1.7699429988861084
Epoch: 7, Steps: 52 | Train Loss: 0.4525078 Vali Loss: 1.4038541 Test Loss: 0.4195034
Validation loss decreased (1.417006 --> 1.403854).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 8 cost time: 1.7765285968780518
Epoch: 8, Steps: 52 | Train Loss: 0.4453005 Vali Loss: 1.3977927 Test Loss: 0.4103367
Validation loss decreased (1.403854 --> 1.397793).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 9 cost time: 1.7672936916351318
Epoch: 9, Steps: 52 | Train Loss: 0.4424340 Vali Loss: 1.3841285 Test Loss: 0.4018071
Validation loss decreased (1.397793 --> 1.384128).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 10 cost time: 1.7692656517028809
Epoch: 10, Steps: 52 | Train Loss: 0.4399963 Vali Loss: 1.3790673 Test Loss: 0.3953925
Validation loss decreased (1.384128 --> 1.379067).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 11 cost time: 1.7634656429290771
Epoch: 11, Steps: 52 | Train Loss: 0.4355342 Vali Loss: 1.3680162 Test Loss: 0.3914701
Validation loss decreased (1.379067 --> 1.368016).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 12 cost time: 1.7631075382232666
Epoch: 12, Steps: 52 | Train Loss: 0.4359417 Vali Loss: 1.3665645 Test Loss: 0.3870710
Validation loss decreased (1.368016 --> 1.366565).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 13 cost time: 1.768359899520874
Epoch: 13, Steps: 52 | Train Loss: 0.4324221 Vali Loss: 1.3594110 Test Loss: 0.3843616
Validation loss decreased (1.366565 --> 1.359411).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 14 cost time: 1.7658166885375977
Epoch: 14, Steps: 52 | Train Loss: 0.4320922 Vali Loss: 1.3597307 Test Loss: 0.3824425
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 15 cost time: 1.7564022541046143
Epoch: 15, Steps: 52 | Train Loss: 0.4319951 Vali Loss: 1.3624687 Test Loss: 0.3800358
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 16 cost time: 1.7699599266052246
Epoch: 16, Steps: 52 | Train Loss: 0.4309487 Vali Loss: 1.3593116 Test Loss: 0.3783281
Validation loss decreased (1.359411 --> 1.359312).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 17 cost time: 1.7612125873565674
Epoch: 17, Steps: 52 | Train Loss: 0.4298049 Vali Loss: 1.3420138 Test Loss: 0.3766243
Validation loss decreased (1.359312 --> 1.342014).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 18 cost time: 1.7793903350830078
Epoch: 18, Steps: 52 | Train Loss: 0.4286831 Vali Loss: 1.3544819 Test Loss: 0.3749331
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 19 cost time: 1.7652769088745117
Epoch: 19, Steps: 52 | Train Loss: 0.4272347 Vali Loss: 1.3470573 Test Loss: 0.3735286
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 20 cost time: 1.7674834728240967
Epoch: 20, Steps: 52 | Train Loss: 0.4278629 Vali Loss: 1.3507795 Test Loss: 0.3727133
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 21 cost time: 1.7540249824523926
Epoch: 21, Steps: 52 | Train Loss: 0.4254864 Vali Loss: 1.3495238 Test Loss: 0.3710054
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 22 cost time: 1.7694389820098877
Epoch: 22, Steps: 52 | Train Loss: 0.4261149 Vali Loss: 1.3507540 Test Loss: 0.3707914
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 23 cost time: 1.764345645904541
Epoch: 23, Steps: 52 | Train Loss: 0.4269781 Vali Loss: 1.3505702 Test Loss: 0.3704704
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 24 cost time: 1.7649304866790771
Epoch: 24, Steps: 52 | Train Loss: 0.4251859 Vali Loss: 1.3489941 Test Loss: 0.3697141
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 25 cost time: 1.7665398120880127
Epoch: 25, Steps: 52 | Train Loss: 0.4246518 Vali Loss: 1.3432262 Test Loss: 0.3688759
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 26 cost time: 1.7715017795562744
Epoch: 26, Steps: 52 | Train Loss: 0.4238187 Vali Loss: 1.3443850 Test Loss: 0.3684922
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 27 cost time: 1.7683360576629639
Epoch: 27, Steps: 52 | Train Loss: 0.4247381 Vali Loss: 1.3408189 Test Loss: 0.3681827
Validation loss decreased (1.342014 --> 1.340819).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 28 cost time: 1.7714438438415527
Epoch: 28, Steps: 52 | Train Loss: 0.4246853 Vali Loss: 1.3315384 Test Loss: 0.3678584
Validation loss decreased (1.340819 --> 1.331538).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 29 cost time: 1.7688305377960205
Epoch: 29, Steps: 52 | Train Loss: 0.4253081 Vali Loss: 1.3473213 Test Loss: 0.3668790
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 30 cost time: 1.7670798301696777
Epoch: 30, Steps: 52 | Train Loss: 0.4237253 Vali Loss: 1.3470639 Test Loss: 0.3672020
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 31 cost time: 1.7638206481933594
Epoch: 31, Steps: 52 | Train Loss: 0.4257831 Vali Loss: 1.3370715 Test Loss: 0.3667935
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 32 cost time: 1.7694776058197021
Epoch: 32, Steps: 52 | Train Loss: 0.4233618 Vali Loss: 1.3393970 Test Loss: 0.3663182
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 33 cost time: 1.7561123371124268
Epoch: 33, Steps: 52 | Train Loss: 0.4240758 Vali Loss: 1.3359511 Test Loss: 0.3664772
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 34 cost time: 1.7659013271331787
Epoch: 34, Steps: 52 | Train Loss: 0.4226457 Vali Loss: 1.3438716 Test Loss: 0.3656020
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 35 cost time: 1.7724273204803467
Epoch: 35, Steps: 52 | Train Loss: 0.4242235 Vali Loss: 1.3391317 Test Loss: 0.3660926
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 36 cost time: 1.7684333324432373
Epoch: 36, Steps: 52 | Train Loss: 0.4241307 Vali Loss: 1.3369253 Test Loss: 0.3653219
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 37 cost time: 1.7699825763702393
Epoch: 37, Steps: 52 | Train Loss: 0.4230086 Vali Loss: 1.3344381 Test Loss: 0.3653764
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 38 cost time: 1.7724475860595703
Epoch: 38, Steps: 52 | Train Loss: 0.4218968 Vali Loss: 1.3387580 Test Loss: 0.3656893
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 39 cost time: 1.7715613842010498
Epoch: 39, Steps: 52 | Train Loss: 0.4241520 Vali Loss: 1.3359073 Test Loss: 0.3653868
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 40 cost time: 1.7685534954071045
Epoch: 40, Steps: 52 | Train Loss: 0.4231899 Vali Loss: 1.3375015 Test Loss: 0.3652604
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 41 cost time: 1.7674553394317627
Epoch: 41, Steps: 52 | Train Loss: 0.4230408 Vali Loss: 1.3420966 Test Loss: 0.3655999
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 42 cost time: 1.7681999206542969
Epoch: 42, Steps: 52 | Train Loss: 0.4232111 Vali Loss: 1.3297381 Test Loss: 0.3652738
Validation loss decreased (1.331538 --> 1.329738).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 43 cost time: 1.7604408264160156
Epoch: 43, Steps: 52 | Train Loss: 0.4222150 Vali Loss: 1.3383169 Test Loss: 0.3654729
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 44 cost time: 1.7625463008880615
Epoch: 44, Steps: 52 | Train Loss: 0.4227942 Vali Loss: 1.3391929 Test Loss: 0.3657016
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 45 cost time: 1.7675185203552246
Epoch: 45, Steps: 52 | Train Loss: 0.4210705 Vali Loss: 1.3405557 Test Loss: 0.3647225
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 46 cost time: 1.7572152614593506
Epoch: 46, Steps: 52 | Train Loss: 0.4219097 Vali Loss: 1.3279555 Test Loss: 0.3651286
Validation loss decreased (1.329738 --> 1.327955).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 47 cost time: 1.7711267471313477
Epoch: 47, Steps: 52 | Train Loss: 0.4218902 Vali Loss: 1.3409984 Test Loss: 0.3649741
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 48 cost time: 1.7644782066345215
Epoch: 48, Steps: 52 | Train Loss: 0.4206527 Vali Loss: 1.3385150 Test Loss: 0.3649120
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 49 cost time: 1.7675459384918213
Epoch: 49, Steps: 52 | Train Loss: 0.4232525 Vali Loss: 1.3436543 Test Loss: 0.3649404
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 50 cost time: 1.7575814723968506
Epoch: 50, Steps: 52 | Train Loss: 0.4224161 Vali Loss: 1.3329799 Test Loss: 0.3648278
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 51 cost time: 1.7694385051727295
Epoch: 51, Steps: 52 | Train Loss: 0.4208415 Vali Loss: 1.3353884 Test Loss: 0.3647030
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 52 cost time: 1.7695131301879883
Epoch: 52, Steps: 52 | Train Loss: 0.4216426 Vali Loss: 1.3431699 Test Loss: 0.3652431
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 53 cost time: 1.7654879093170166
Epoch: 53, Steps: 52 | Train Loss: 0.4225947 Vali Loss: 1.3385712 Test Loss: 0.3648704
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 54 cost time: 1.7680597305297852
Epoch: 54, Steps: 52 | Train Loss: 0.4223091 Vali Loss: 1.3420277 Test Loss: 0.3652475
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 55 cost time: 1.7664313316345215
Epoch: 55, Steps: 52 | Train Loss: 0.4212360 Vali Loss: 1.3436838 Test Loss: 0.3649921
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 56 cost time: 1.7718336582183838
Epoch: 56, Steps: 52 | Train Loss: 0.4222037 Vali Loss: 1.3409295 Test Loss: 0.3647630
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 57 cost time: 1.7806997299194336
Epoch: 57, Steps: 52 | Train Loss: 0.4229918 Vali Loss: 1.3386676 Test Loss: 0.3643730
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 58 cost time: 1.7670674324035645
Epoch: 58, Steps: 52 | Train Loss: 0.4236541 Vali Loss: 1.3394809 Test Loss: 0.3644808
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 59 cost time: 1.7640678882598877
Epoch: 59, Steps: 52 | Train Loss: 0.4230283 Vali Loss: 1.3416476 Test Loss: 0.3647601
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 60 cost time: 1.7675204277038574
Epoch: 60, Steps: 52 | Train Loss: 0.4210912 Vali Loss: 1.3348250 Test Loss: 0.3643466
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36512860655784607, mae:0.40959131717681885, rse:0.4950302243232727
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04751729965209961 GB
Epoch: 1 cost time: 2.147590398788452
Epoch: 1, Steps: 52 | Train Loss: 0.8587915 Vali Loss: 2.2521234 Test Loss: 1.4238086
Validation loss decreased (inf --> 2.252123).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 2 cost time: 0.7589998245239258
Epoch: 2, Steps: 52 | Train Loss: 0.7522623 Vali Loss: 1.8062212 Test Loss: 0.9300954
Validation loss decreased (2.252123 --> 1.806221).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 3 cost time: 0.7573904991149902
Epoch: 3, Steps: 52 | Train Loss: 0.6288466 Vali Loss: 1.6428064 Test Loss: 0.7256193
Validation loss decreased (1.806221 --> 1.642806).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 4 cost time: 0.7424054145812988
Epoch: 4, Steps: 52 | Train Loss: 0.5680073 Vali Loss: 1.5543668 Test Loss: 0.6071959
Validation loss decreased (1.642806 --> 1.554367).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 5 cost time: 0.7399985790252686
Epoch: 5, Steps: 52 | Train Loss: 0.5324188 Vali Loss: 1.5018258 Test Loss: 0.5452649
Validation loss decreased (1.554367 --> 1.501826).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 6 cost time: 1.687669277191162
Epoch: 6, Steps: 52 | Train Loss: 0.5121861 Vali Loss: 1.4607646 Test Loss: 0.5008838
Validation loss decreased (1.501826 --> 1.460765).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 7 cost time: 1.6855931282043457
Epoch: 7, Steps: 52 | Train Loss: 0.4975400 Vali Loss: 1.4353316 Test Loss: 0.4734138
Validation loss decreased (1.460765 --> 1.435332).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 8 cost time: 1.6823911666870117
Epoch: 8, Steps: 52 | Train Loss: 0.4849478 Vali Loss: 1.4262521 Test Loss: 0.4515514
Validation loss decreased (1.435332 --> 1.426252).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 9 cost time: 1.6842899322509766
Epoch: 9, Steps: 52 | Train Loss: 0.4793219 Vali Loss: 1.4155015 Test Loss: 0.4391809
Validation loss decreased (1.426252 --> 1.415501).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 10 cost time: 1.6791033744812012
Epoch: 10, Steps: 52 | Train Loss: 0.4718157 Vali Loss: 1.4038384 Test Loss: 0.4281356
Validation loss decreased (1.415501 --> 1.403838).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 11 cost time: 1.6793360710144043
Epoch: 11, Steps: 52 | Train Loss: 0.4695277 Vali Loss: 1.3958578 Test Loss: 0.4197482
Validation loss decreased (1.403838 --> 1.395858).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 12 cost time: 1.6815881729125977
Epoch: 12, Steps: 52 | Train Loss: 0.4644049 Vali Loss: 1.3861361 Test Loss: 0.4140038
Validation loss decreased (1.395858 --> 1.386136).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 13 cost time: 1.6836884021759033
Epoch: 13, Steps: 52 | Train Loss: 0.4633035 Vali Loss: 1.3910638 Test Loss: 0.4070327
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 14 cost time: 1.6847455501556396
Epoch: 14, Steps: 52 | Train Loss: 0.4616084 Vali Loss: 1.3803675 Test Loss: 0.4034046
Validation loss decreased (1.386136 --> 1.380368).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 15 cost time: 1.6830039024353027
Epoch: 15, Steps: 52 | Train Loss: 0.4562489 Vali Loss: 1.3808236 Test Loss: 0.3991815
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 16 cost time: 1.684556245803833
Epoch: 16, Steps: 52 | Train Loss: 0.4554571 Vali Loss: 1.3788531 Test Loss: 0.3957946
Validation loss decreased (1.380368 --> 1.378853).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 17 cost time: 1.6853854656219482
Epoch: 17, Steps: 52 | Train Loss: 0.4570555 Vali Loss: 1.3695779 Test Loss: 0.3933560
Validation loss decreased (1.378853 --> 1.369578).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 18 cost time: 1.6875460147857666
Epoch: 18, Steps: 52 | Train Loss: 0.4542001 Vali Loss: 1.3691261 Test Loss: 0.3911985
Validation loss decreased (1.369578 --> 1.369126).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 19 cost time: 1.6855251789093018
Epoch: 19, Steps: 52 | Train Loss: 0.4506234 Vali Loss: 1.3679448 Test Loss: 0.3895524
Validation loss decreased (1.369126 --> 1.367945).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 20 cost time: 1.6987786293029785
Epoch: 20, Steps: 52 | Train Loss: 0.4522451 Vali Loss: 1.3684531 Test Loss: 0.3876384
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 21 cost time: 1.6854279041290283
Epoch: 21, Steps: 52 | Train Loss: 0.4507162 Vali Loss: 1.3615282 Test Loss: 0.3867987
Validation loss decreased (1.367945 --> 1.361528).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 22 cost time: 1.6879494190216064
Epoch: 22, Steps: 52 | Train Loss: 0.4502112 Vali Loss: 1.3663483 Test Loss: 0.3858566
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 23 cost time: 1.6746208667755127
Epoch: 23, Steps: 52 | Train Loss: 0.4494806 Vali Loss: 1.3654304 Test Loss: 0.3844120
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 24 cost time: 1.6870579719543457
Epoch: 24, Steps: 52 | Train Loss: 0.4466328 Vali Loss: 1.3610885 Test Loss: 0.3834898
Validation loss decreased (1.361528 --> 1.361089).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 25 cost time: 1.685896396636963
Epoch: 25, Steps: 52 | Train Loss: 0.4456761 Vali Loss: 1.3638647 Test Loss: 0.3821745
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 26 cost time: 1.6822915077209473
Epoch: 26, Steps: 52 | Train Loss: 0.4477890 Vali Loss: 1.3629826 Test Loss: 0.3812254
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 27 cost time: 1.6830604076385498
Epoch: 27, Steps: 52 | Train Loss: 0.4455118 Vali Loss: 1.3517712 Test Loss: 0.3810846
Validation loss decreased (1.361089 --> 1.351771).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 28 cost time: 1.6853821277618408
Epoch: 28, Steps: 52 | Train Loss: 0.4456790 Vali Loss: 1.3547245 Test Loss: 0.3806401
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 29 cost time: 1.6859302520751953
Epoch: 29, Steps: 52 | Train Loss: 0.4450762 Vali Loss: 1.3567808 Test Loss: 0.3809256
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 30 cost time: 1.6855010986328125
Epoch: 30, Steps: 52 | Train Loss: 0.4461941 Vali Loss: 1.3613907 Test Loss: 0.3797040
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 31 cost time: 1.6885099411010742
Epoch: 31, Steps: 52 | Train Loss: 0.4441008 Vali Loss: 1.3584840 Test Loss: 0.3789009
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 32 cost time: 1.681946039199829
Epoch: 32, Steps: 52 | Train Loss: 0.4462373 Vali Loss: 1.3540487 Test Loss: 0.3784763
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 33 cost time: 1.6822574138641357
Epoch: 33, Steps: 52 | Train Loss: 0.4441134 Vali Loss: 1.3510568 Test Loss: 0.3784407
Validation loss decreased (1.351771 --> 1.351057).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 34 cost time: 1.6750471591949463
Epoch: 34, Steps: 52 | Train Loss: 0.4449519 Vali Loss: 1.3540351 Test Loss: 0.3776554
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 35 cost time: 1.6851732730865479
Epoch: 35, Steps: 52 | Train Loss: 0.4435923 Vali Loss: 1.3602594 Test Loss: 0.3776303
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 36 cost time: 1.6853821277618408
Epoch: 36, Steps: 52 | Train Loss: 0.4427568 Vali Loss: 1.3631864 Test Loss: 0.3778916
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 37 cost time: 1.6761431694030762
Epoch: 37, Steps: 52 | Train Loss: 0.4453094 Vali Loss: 1.3524430 Test Loss: 0.3769202
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 38 cost time: 1.686873197555542
Epoch: 38, Steps: 52 | Train Loss: 0.4420617 Vali Loss: 1.3548350 Test Loss: 0.3768796
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 39 cost time: 1.6899487972259521
Epoch: 39, Steps: 52 | Train Loss: 0.4450365 Vali Loss: 1.3537416 Test Loss: 0.3770378
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 40 cost time: 1.6794507503509521
Epoch: 40, Steps: 52 | Train Loss: 0.4440359 Vali Loss: 1.3389380 Test Loss: 0.3768944
Validation loss decreased (1.351057 --> 1.338938).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 41 cost time: 1.687896728515625
Epoch: 41, Steps: 52 | Train Loss: 0.4438076 Vali Loss: 1.3608774 Test Loss: 0.3762432
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 42 cost time: 1.686434268951416
Epoch: 42, Steps: 52 | Train Loss: 0.4436949 Vali Loss: 1.3521924 Test Loss: 0.3762137
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 43 cost time: 1.685455083847046
Epoch: 43, Steps: 52 | Train Loss: 0.4443840 Vali Loss: 1.3589981 Test Loss: 0.3761736
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 44 cost time: 1.6754982471466064
Epoch: 44, Steps: 52 | Train Loss: 0.4436725 Vali Loss: 1.3604510 Test Loss: 0.3754425
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 45 cost time: 1.6926302909851074
Epoch: 45, Steps: 52 | Train Loss: 0.4432592 Vali Loss: 1.3527079 Test Loss: 0.3759344
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 46 cost time: 1.6754541397094727
Epoch: 46, Steps: 52 | Train Loss: 0.4418991 Vali Loss: 1.3575850 Test Loss: 0.3756779
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 47 cost time: 1.678398609161377
Epoch: 47, Steps: 52 | Train Loss: 0.4425382 Vali Loss: 1.3573334 Test Loss: 0.3758545
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 48 cost time: 1.6851520538330078
Epoch: 48, Steps: 52 | Train Loss: 0.4429847 Vali Loss: 1.3602593 Test Loss: 0.3759611
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 49 cost time: 1.6894125938415527
Epoch: 49, Steps: 52 | Train Loss: 0.4407414 Vali Loss: 1.3602076 Test Loss: 0.3750992
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 50 cost time: 1.6864638328552246
Epoch: 50, Steps: 52 | Train Loss: 0.4424392 Vali Loss: 1.3579451 Test Loss: 0.3750148
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 51 cost time: 1.6943483352661133
Epoch: 51, Steps: 52 | Train Loss: 0.4417445 Vali Loss: 1.3566384 Test Loss: 0.3749942
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 52 cost time: 1.6985225677490234
Epoch: 52, Steps: 52 | Train Loss: 0.4420416 Vali Loss: 1.3428314 Test Loss: 0.3766016
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 53 cost time: 1.6897969245910645
Epoch: 53, Steps: 52 | Train Loss: 0.4419369 Vali Loss: 1.3477185 Test Loss: 0.3752194
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 54 cost time: 1.6885347366333008
Epoch: 54, Steps: 52 | Train Loss: 0.4412381 Vali Loss: 1.3560994 Test Loss: 0.3750229
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 55 cost time: 1.6821789741516113
Epoch: 55, Steps: 52 | Train Loss: 0.4415478 Vali Loss: 1.3522078 Test Loss: 0.3753165
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 56 cost time: 1.6809930801391602
Epoch: 56, Steps: 52 | Train Loss: 0.4414088 Vali Loss: 1.3455875 Test Loss: 0.3752597
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 57 cost time: 1.6788065433502197
Epoch: 57, Steps: 52 | Train Loss: 0.4424818 Vali Loss: 1.3551139 Test Loss: 0.3747233
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 58 cost time: 1.681147575378418
Epoch: 58, Steps: 52 | Train Loss: 0.4437513 Vali Loss: 1.3531866 Test Loss: 0.3755906
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 59 cost time: 1.6870918273925781
Epoch: 59, Steps: 52 | Train Loss: 0.4419696 Vali Loss: 1.3537049 Test Loss: 0.3754568
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 60 cost time: 1.6893174648284912
Epoch: 60, Steps: 52 | Train Loss: 0.4434094 Vali Loss: 1.3560801 Test Loss: 0.3759058
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.37689438462257385, mae:0.41218748688697815, rse:0.5029428601264954
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.048218727111816406 GB
Epoch: 1 cost time: 2.1719725131988525
Epoch: 1, Steps: 52 | Train Loss: 0.8237476 Vali Loss: 2.4258168 Test Loss: 1.6464815
Validation loss decreased (inf --> 2.425817).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 2 cost time: 0.7776176929473877
Epoch: 2, Steps: 52 | Train Loss: 0.7485402 Vali Loss: 2.0610032 Test Loss: 1.2550354
Validation loss decreased (2.425817 --> 2.061003).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 3 cost time: 0.7674233913421631
Epoch: 3, Steps: 52 | Train Loss: 0.6415071 Vali Loss: 1.8024852 Test Loss: 0.9365962
Validation loss decreased (2.061003 --> 1.802485).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 4 cost time: 0.7808048725128174
Epoch: 4, Steps: 52 | Train Loss: 0.5579067 Vali Loss: 1.6032537 Test Loss: 0.6705840
Validation loss decreased (1.802485 --> 1.603254).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 5 cost time: 0.7746305465698242
Epoch: 5, Steps: 52 | Train Loss: 0.5090488 Vali Loss: 1.5132477 Test Loss: 0.5434096
Validation loss decreased (1.603254 --> 1.513248).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 6 cost time: 1.7430899143218994
Epoch: 6, Steps: 52 | Train Loss: 0.4841245 Vali Loss: 1.4623370 Test Loss: 0.4893840
Validation loss decreased (1.513248 --> 1.462337).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 7 cost time: 1.747300386428833
Epoch: 7, Steps: 52 | Train Loss: 0.4702415 Vali Loss: 1.4484863 Test Loss: 0.4616774
Validation loss decreased (1.462337 --> 1.448486).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 8 cost time: 1.7296438217163086
Epoch: 8, Steps: 52 | Train Loss: 0.4623169 Vali Loss: 1.4267375 Test Loss: 0.4441248
Validation loss decreased (1.448486 --> 1.426738).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 9 cost time: 1.736140251159668
Epoch: 9, Steps: 52 | Train Loss: 0.4576601 Vali Loss: 1.4102838 Test Loss: 0.4307020
Validation loss decreased (1.426738 --> 1.410284).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 10 cost time: 1.7388250827789307
Epoch: 10, Steps: 52 | Train Loss: 0.4548886 Vali Loss: 1.3977324 Test Loss: 0.4198968
Validation loss decreased (1.410284 --> 1.397732).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 11 cost time: 1.741455316543579
Epoch: 11, Steps: 52 | Train Loss: 0.4496615 Vali Loss: 1.3945673 Test Loss: 0.4130619
Validation loss decreased (1.397732 --> 1.394567).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 12 cost time: 1.7571911811828613
Epoch: 12, Steps: 52 | Train Loss: 0.4468248 Vali Loss: 1.3836817 Test Loss: 0.4072112
Validation loss decreased (1.394567 --> 1.383682).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 13 cost time: 1.7370669841766357
Epoch: 13, Steps: 52 | Train Loss: 0.4438576 Vali Loss: 1.3879561 Test Loss: 0.4038237
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 14 cost time: 1.7392942905426025
Epoch: 14, Steps: 52 | Train Loss: 0.4427704 Vali Loss: 1.3810515 Test Loss: 0.3995271
Validation loss decreased (1.383682 --> 1.381052).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 15 cost time: 1.7370851039886475
Epoch: 15, Steps: 52 | Train Loss: 0.4413249 Vali Loss: 1.3807298 Test Loss: 0.3965085
Validation loss decreased (1.381052 --> 1.380730).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 16 cost time: 1.7381134033203125
Epoch: 16, Steps: 52 | Train Loss: 0.4398061 Vali Loss: 1.3716495 Test Loss: 0.3940504
Validation loss decreased (1.380730 --> 1.371650).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 17 cost time: 1.7406842708587646
Epoch: 17, Steps: 52 | Train Loss: 0.4375232 Vali Loss: 1.3633813 Test Loss: 0.3919457
Validation loss decreased (1.371650 --> 1.363381).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 18 cost time: 1.734630823135376
Epoch: 18, Steps: 52 | Train Loss: 0.4373368 Vali Loss: 1.3684201 Test Loss: 0.3897765
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 19 cost time: 1.7359213829040527
Epoch: 19, Steps: 52 | Train Loss: 0.4353690 Vali Loss: 1.3722250 Test Loss: 0.3884332
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 20 cost time: 1.7361865043640137
Epoch: 20, Steps: 52 | Train Loss: 0.4344807 Vali Loss: 1.3588283 Test Loss: 0.3870497
Validation loss decreased (1.363381 --> 1.358828).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 21 cost time: 1.737487554550171
Epoch: 21, Steps: 52 | Train Loss: 0.4346590 Vali Loss: 1.3556833 Test Loss: 0.3859980
Validation loss decreased (1.358828 --> 1.355683).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 22 cost time: 1.7489013671875
Epoch: 22, Steps: 52 | Train Loss: 0.4324397 Vali Loss: 1.3663688 Test Loss: 0.3846197
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 23 cost time: 1.7347469329833984
Epoch: 23, Steps: 52 | Train Loss: 0.4333274 Vali Loss: 1.3505056 Test Loss: 0.3840426
Validation loss decreased (1.355683 --> 1.350506).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 24 cost time: 1.7397823333740234
Epoch: 24, Steps: 52 | Train Loss: 0.4323955 Vali Loss: 1.3578043 Test Loss: 0.3830891
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 25 cost time: 1.7424054145812988
Epoch: 25, Steps: 52 | Train Loss: 0.4328768 Vali Loss: 1.3560970 Test Loss: 0.3825774
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 26 cost time: 1.742563247680664
Epoch: 26, Steps: 52 | Train Loss: 0.4337180 Vali Loss: 1.3598244 Test Loss: 0.3815456
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 27 cost time: 1.7388951778411865
Epoch: 27, Steps: 52 | Train Loss: 0.4328140 Vali Loss: 1.3537213 Test Loss: 0.3818228
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 28 cost time: 1.7253894805908203
Epoch: 28, Steps: 52 | Train Loss: 0.4324370 Vali Loss: 1.3583648 Test Loss: 0.3803140
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 29 cost time: 1.7456817626953125
Epoch: 29, Steps: 52 | Train Loss: 0.4312677 Vali Loss: 1.3569503 Test Loss: 0.3801421
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 30 cost time: 1.7434232234954834
Epoch: 30, Steps: 52 | Train Loss: 0.4300550 Vali Loss: 1.3502680 Test Loss: 0.3802269
Validation loss decreased (1.350506 --> 1.350268).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 31 cost time: 1.7490637302398682
Epoch: 31, Steps: 52 | Train Loss: 0.4307759 Vali Loss: 1.3544528 Test Loss: 0.3796866
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 32 cost time: 1.7313816547393799
Epoch: 32, Steps: 52 | Train Loss: 0.4324366 Vali Loss: 1.3486179 Test Loss: 0.3795933
Validation loss decreased (1.350268 --> 1.348618).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 33 cost time: 1.7461886405944824
Epoch: 33, Steps: 52 | Train Loss: 0.4298512 Vali Loss: 1.3494304 Test Loss: 0.3787777
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 34 cost time: 1.7364516258239746
Epoch: 34, Steps: 52 | Train Loss: 0.4282221 Vali Loss: 1.3494070 Test Loss: 0.3787180
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 35 cost time: 1.7494654655456543
Epoch: 35, Steps: 52 | Train Loss: 0.4302076 Vali Loss: 1.3545860 Test Loss: 0.3782917
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 36 cost time: 1.7456004619598389
Epoch: 36, Steps: 52 | Train Loss: 0.4300424 Vali Loss: 1.3538839 Test Loss: 0.3786972
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 37 cost time: 1.7384231090545654
Epoch: 37, Steps: 52 | Train Loss: 0.4291981 Vali Loss: 1.3535790 Test Loss: 0.3780988
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 38 cost time: 1.7424345016479492
Epoch: 38, Steps: 52 | Train Loss: 0.4305604 Vali Loss: 1.3497312 Test Loss: 0.3786300
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 39 cost time: 1.740565538406372
Epoch: 39, Steps: 52 | Train Loss: 0.4297526 Vali Loss: 1.3524284 Test Loss: 0.3777948
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 40 cost time: 1.7402734756469727
Epoch: 40, Steps: 52 | Train Loss: 0.4296108 Vali Loss: 1.3549407 Test Loss: 0.3776786
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 41 cost time: 1.733184814453125
Epoch: 41, Steps: 52 | Train Loss: 0.4299699 Vali Loss: 1.3468219 Test Loss: 0.3775528
Validation loss decreased (1.348618 --> 1.346822).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 42 cost time: 1.7544186115264893
Epoch: 42, Steps: 52 | Train Loss: 0.4297092 Vali Loss: 1.3543733 Test Loss: 0.3775840
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 43 cost time: 1.7438161373138428
Epoch: 43, Steps: 52 | Train Loss: 0.4282055 Vali Loss: 1.3557508 Test Loss: 0.3778137
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 44 cost time: 1.7382206916809082
Epoch: 44, Steps: 52 | Train Loss: 0.4287904 Vali Loss: 1.3499813 Test Loss: 0.3772898
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 45 cost time: 1.7343556880950928
Epoch: 45, Steps: 52 | Train Loss: 0.4293405 Vali Loss: 1.3481200 Test Loss: 0.3771079
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 46 cost time: 1.7386741638183594
Epoch: 46, Steps: 52 | Train Loss: 0.4302368 Vali Loss: 1.3501421 Test Loss: 0.3769160
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 47 cost time: 1.7361834049224854
Epoch: 47, Steps: 52 | Train Loss: 0.4284473 Vali Loss: 1.3511301 Test Loss: 0.3768160
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 48 cost time: 1.7420239448547363
Epoch: 48, Steps: 52 | Train Loss: 0.4285338 Vali Loss: 1.3470331 Test Loss: 0.3770134
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 49 cost time: 1.742358684539795
Epoch: 49, Steps: 52 | Train Loss: 0.4279431 Vali Loss: 1.3456926 Test Loss: 0.3770927
Validation loss decreased (1.346822 --> 1.345693).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 50 cost time: 1.743875503540039
Epoch: 50, Steps: 52 | Train Loss: 0.4269830 Vali Loss: 1.3462795 Test Loss: 0.3774335
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 51 cost time: 1.731860637664795
Epoch: 51, Steps: 52 | Train Loss: 0.4287495 Vali Loss: 1.3536634 Test Loss: 0.3766865
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 52 cost time: 1.7415146827697754
Epoch: 52, Steps: 52 | Train Loss: 0.4296440 Vali Loss: 1.3475825 Test Loss: 0.3766094
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 53 cost time: 1.7300214767456055
Epoch: 53, Steps: 52 | Train Loss: 0.4280524 Vali Loss: 1.3425143 Test Loss: 0.3770382
Validation loss decreased (1.345693 --> 1.342514).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 54 cost time: 1.734985589981079
Epoch: 54, Steps: 52 | Train Loss: 0.4288714 Vali Loss: 1.3388622 Test Loss: 0.3769442
Validation loss decreased (1.342514 --> 1.338862).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 55 cost time: 1.733104944229126
Epoch: 55, Steps: 52 | Train Loss: 0.4280559 Vali Loss: 1.3412684 Test Loss: 0.3763031
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 56 cost time: 1.7369139194488525
Epoch: 56, Steps: 52 | Train Loss: 0.4291516 Vali Loss: 1.3447690 Test Loss: 0.3772930
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 57 cost time: 1.7363359928131104
Epoch: 57, Steps: 52 | Train Loss: 0.4277846 Vali Loss: 1.3405566 Test Loss: 0.3764984
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 58 cost time: 1.7360742092132568
Epoch: 58, Steps: 52 | Train Loss: 0.4287322 Vali Loss: 1.3405507 Test Loss: 0.3765747
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 59 cost time: 1.734480381011963
Epoch: 59, Steps: 52 | Train Loss: 0.4285737 Vali Loss: 1.3523707 Test Loss: 0.3762328
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 60 cost time: 1.7376163005828857
Epoch: 60, Steps: 52 | Train Loss: 0.4297969 Vali Loss: 1.3487158 Test Loss: 0.3771002
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3769441843032837, mae:0.41650620102882385, rse:0.5029760599136353
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.0487828254699707 GB
Epoch: 1 cost time: 2.1871588230133057
Epoch: 1, Steps: 52 | Train Loss: 0.6877886 Vali Loss: 2.1180172 Test Loss: 1.3494176
Validation loss decreased (inf --> 2.118017).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 2 cost time: 0.7943868637084961
Epoch: 2, Steps: 52 | Train Loss: 0.6416566 Vali Loss: 1.8715777 Test Loss: 1.0569013
Validation loss decreased (2.118017 --> 1.871578).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 3 cost time: 0.79341721534729
Epoch: 3, Steps: 52 | Train Loss: 0.5667201 Vali Loss: 1.6405487 Test Loss: 0.7590995
Validation loss decreased (1.871578 --> 1.640549).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 4 cost time: 0.7940008640289307
Epoch: 4, Steps: 52 | Train Loss: 0.5012556 Vali Loss: 1.4746585 Test Loss: 0.5346372
Validation loss decreased (1.640549 --> 1.474658).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 5 cost time: 0.9721179008483887
Epoch: 5, Steps: 52 | Train Loss: 0.4615419 Vali Loss: 1.4138808 Test Loss: 0.4451914
Validation loss decreased (1.474658 --> 1.413881).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 6 cost time: 1.791621446609497
Epoch: 6, Steps: 52 | Train Loss: 0.4487704 Vali Loss: 1.3910512 Test Loss: 0.4129663
Validation loss decreased (1.413881 --> 1.391051).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 7 cost time: 1.7943451404571533
Epoch: 7, Steps: 52 | Train Loss: 0.4420877 Vali Loss: 1.3843486 Test Loss: 0.3997382
Validation loss decreased (1.391051 --> 1.384349).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 8 cost time: 1.7904181480407715
Epoch: 8, Steps: 52 | Train Loss: 0.4345845 Vali Loss: 1.3680800 Test Loss: 0.3937534
Validation loss decreased (1.384349 --> 1.368080).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 9 cost time: 1.792278528213501
Epoch: 9, Steps: 52 | Train Loss: 0.4335401 Vali Loss: 1.3692493 Test Loss: 0.3878760
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 10 cost time: 1.7914133071899414
Epoch: 10, Steps: 52 | Train Loss: 0.4302809 Vali Loss: 1.3611050 Test Loss: 0.3823423
Validation loss decreased (1.368080 --> 1.361105).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 11 cost time: 1.7887935638427734
Epoch: 11, Steps: 52 | Train Loss: 0.4302814 Vali Loss: 1.3522294 Test Loss: 0.3785616
Validation loss decreased (1.361105 --> 1.352229).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 12 cost time: 1.7939887046813965
Epoch: 12, Steps: 52 | Train Loss: 0.4280891 Vali Loss: 1.3376530 Test Loss: 0.3750069
Validation loss decreased (1.352229 --> 1.337653).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 13 cost time: 1.7843959331512451
Epoch: 13, Steps: 52 | Train Loss: 0.4263545 Vali Loss: 1.3497998 Test Loss: 0.3726037
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 14 cost time: 1.7827539443969727
Epoch: 14, Steps: 52 | Train Loss: 0.4233078 Vali Loss: 1.3438995 Test Loss: 0.3713977
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 15 cost time: 1.7949552536010742
Epoch: 15, Steps: 52 | Train Loss: 0.4234638 Vali Loss: 1.3315750 Test Loss: 0.3691832
Validation loss decreased (1.337653 --> 1.331575).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 16 cost time: 1.7904317378997803
Epoch: 16, Steps: 52 | Train Loss: 0.4227707 Vali Loss: 1.3358910 Test Loss: 0.3675112
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 17 cost time: 1.7880635261535645
Epoch: 17, Steps: 52 | Train Loss: 0.4224434 Vali Loss: 1.3398726 Test Loss: 0.3660412
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 18 cost time: 1.7978050708770752
Epoch: 18, Steps: 52 | Train Loss: 0.4214489 Vali Loss: 1.3378820 Test Loss: 0.3654968
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 19 cost time: 1.7865045070648193
Epoch: 19, Steps: 52 | Train Loss: 0.4223643 Vali Loss: 1.3292525 Test Loss: 0.3637893
Validation loss decreased (1.331575 --> 1.329252).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 20 cost time: 1.788841724395752
Epoch: 20, Steps: 52 | Train Loss: 0.4187076 Vali Loss: 1.3372962 Test Loss: 0.3632244
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 21 cost time: 1.786431074142456
Epoch: 21, Steps: 52 | Train Loss: 0.4183905 Vali Loss: 1.3353333 Test Loss: 0.3629948
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 22 cost time: 1.793588638305664
Epoch: 22, Steps: 52 | Train Loss: 0.4177805 Vali Loss: 1.3241701 Test Loss: 0.3614244
Validation loss decreased (1.329252 --> 1.324170).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 23 cost time: 1.791142463684082
Epoch: 23, Steps: 52 | Train Loss: 0.4178216 Vali Loss: 1.3271905 Test Loss: 0.3611136
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 24 cost time: 1.7903563976287842
Epoch: 24, Steps: 52 | Train Loss: 0.4206781 Vali Loss: 1.3322001 Test Loss: 0.3610066
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 25 cost time: 1.7854061126708984
Epoch: 25, Steps: 52 | Train Loss: 0.4184189 Vali Loss: 1.3268583 Test Loss: 0.3595496
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 26 cost time: 1.7883453369140625
Epoch: 26, Steps: 52 | Train Loss: 0.4175852 Vali Loss: 1.3226461 Test Loss: 0.3597742
Validation loss decreased (1.324170 --> 1.322646).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 27 cost time: 1.7893168926239014
Epoch: 27, Steps: 52 | Train Loss: 0.4193783 Vali Loss: 1.3285024 Test Loss: 0.3595095
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 28 cost time: 1.7810072898864746
Epoch: 28, Steps: 52 | Train Loss: 0.4181004 Vali Loss: 1.3233805 Test Loss: 0.3592305
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 29 cost time: 1.7804341316223145
Epoch: 29, Steps: 52 | Train Loss: 0.4185586 Vali Loss: 1.3187338 Test Loss: 0.3591825
Validation loss decreased (1.322646 --> 1.318734).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 30 cost time: 1.7880980968475342
Epoch: 30, Steps: 52 | Train Loss: 0.4178977 Vali Loss: 1.3275373 Test Loss: 0.3589548
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 31 cost time: 1.7885551452636719
Epoch: 31, Steps: 52 | Train Loss: 0.4172096 Vali Loss: 1.3284931 Test Loss: 0.3581840
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 32 cost time: 1.7864234447479248
Epoch: 32, Steps: 52 | Train Loss: 0.4179684 Vali Loss: 1.3205304 Test Loss: 0.3583325
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 33 cost time: 1.8023788928985596
Epoch: 33, Steps: 52 | Train Loss: 0.4186438 Vali Loss: 1.3199404 Test Loss: 0.3580008
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 34 cost time: 1.783707618713379
Epoch: 34, Steps: 52 | Train Loss: 0.4165077 Vali Loss: 1.3280594 Test Loss: 0.3576766
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 35 cost time: 1.7875404357910156
Epoch: 35, Steps: 52 | Train Loss: 0.4147601 Vali Loss: 1.3195279 Test Loss: 0.3580892
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 36 cost time: 1.795893907546997
Epoch: 36, Steps: 52 | Train Loss: 0.4157002 Vali Loss: 1.3241343 Test Loss: 0.3577897
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 37 cost time: 1.7834501266479492
Epoch: 37, Steps: 52 | Train Loss: 0.4168984 Vali Loss: 1.3271284 Test Loss: 0.3568788
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 38 cost time: 1.790090799331665
Epoch: 38, Steps: 52 | Train Loss: 0.4169117 Vali Loss: 1.3264663 Test Loss: 0.3575855
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 39 cost time: 1.7779030799865723
Epoch: 39, Steps: 52 | Train Loss: 0.4166445 Vali Loss: 1.3219156 Test Loss: 0.3575530
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 40 cost time: 1.7775776386260986
Epoch: 40, Steps: 52 | Train Loss: 0.4168569 Vali Loss: 1.3250694 Test Loss: 0.3569819
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 41 cost time: 1.7894346714019775
Epoch: 41, Steps: 52 | Train Loss: 0.4155742 Vali Loss: 1.3231869 Test Loss: 0.3570994
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 42 cost time: 1.7901122570037842
Epoch: 42, Steps: 52 | Train Loss: 0.4175296 Vali Loss: 1.3292389 Test Loss: 0.3567822
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 43 cost time: 1.7957875728607178
Epoch: 43, Steps: 52 | Train Loss: 0.4168865 Vali Loss: 1.3225831 Test Loss: 0.3572155
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 44 cost time: 1.7861135005950928
Epoch: 44, Steps: 52 | Train Loss: 0.4145776 Vali Loss: 1.3204587 Test Loss: 0.3568378
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 45 cost time: 1.7880465984344482
Epoch: 45, Steps: 52 | Train Loss: 0.4160624 Vali Loss: 1.3217885 Test Loss: 0.3573944
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 46 cost time: 1.7855424880981445
Epoch: 46, Steps: 52 | Train Loss: 0.4184798 Vali Loss: 1.3231003 Test Loss: 0.3569335
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 47 cost time: 1.791949987411499
Epoch: 47, Steps: 52 | Train Loss: 0.4166683 Vali Loss: 1.3230686 Test Loss: 0.3566265
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 48 cost time: 1.7909801006317139
Epoch: 48, Steps: 52 | Train Loss: 0.4176829 Vali Loss: 1.3279915 Test Loss: 0.3567853
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 49 cost time: 1.7925677299499512
Epoch: 49, Steps: 52 | Train Loss: 0.4165646 Vali Loss: 1.3232062 Test Loss: 0.3563794
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 50 cost time: 1.7942850589752197
Epoch: 50, Steps: 52 | Train Loss: 0.4170621 Vali Loss: 1.3297629 Test Loss: 0.3568238
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 51 cost time: 1.7924346923828125
Epoch: 51, Steps: 52 | Train Loss: 0.4182838 Vali Loss: 1.3174174 Test Loss: 0.3566307
Validation loss decreased (1.318734 --> 1.317417).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 52 cost time: 1.7943124771118164
Epoch: 52, Steps: 52 | Train Loss: 0.4174059 Vali Loss: 1.3252223 Test Loss: 0.3562598
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 53 cost time: 1.7897355556488037
Epoch: 53, Steps: 52 | Train Loss: 0.4164328 Vali Loss: 1.3225989 Test Loss: 0.3561676
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 54 cost time: 1.7954270839691162
Epoch: 54, Steps: 52 | Train Loss: 0.4154037 Vali Loss: 1.3169277 Test Loss: 0.3559995
Validation loss decreased (1.317417 --> 1.316928).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 55 cost time: 1.7931244373321533
Epoch: 55, Steps: 52 | Train Loss: 0.4172537 Vali Loss: 1.3287501 Test Loss: 0.3568592
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 56 cost time: 1.7899246215820312
Epoch: 56, Steps: 52 | Train Loss: 0.4170332 Vali Loss: 1.3276750 Test Loss: 0.3563938
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 57 cost time: 1.7808036804199219
Epoch: 57, Steps: 52 | Train Loss: 0.4174861 Vali Loss: 1.3222740 Test Loss: 0.3566192
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 58 cost time: 1.786815881729126
Epoch: 58, Steps: 52 | Train Loss: 0.4179466 Vali Loss: 1.3179826 Test Loss: 0.3568664
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 59 cost time: 1.7924761772155762
Epoch: 59, Steps: 52 | Train Loss: 0.4177014 Vali Loss: 1.3247547 Test Loss: 0.3564393
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 60 cost time: 1.7805824279785156
Epoch: 60, Steps: 52 | Train Loss: 0.4158313 Vali Loss: 1.3185480 Test Loss: 0.3567829
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3559994697570801, mae:0.403656929731369, rse:0.48880258202552795
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.047678470611572266 GB
Epoch: 1 cost time: 2.185080051422119
Epoch: 1, Steps: 52 | Train Loss: 0.8548246 Vali Loss: 2.2590709 Test Loss: 1.3779460
Validation loss decreased (inf --> 2.259071).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 2 cost time: 0.7692697048187256
Epoch: 2, Steps: 52 | Train Loss: 0.7439344 Vali Loss: 1.7565337 Test Loss: 0.8217500
Validation loss decreased (2.259071 --> 1.756534).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 3 cost time: 0.7694542407989502
Epoch: 3, Steps: 52 | Train Loss: 0.6059071 Vali Loss: 1.5355580 Test Loss: 0.5679840
Validation loss decreased (1.756534 --> 1.535558).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 4 cost time: 0.770582914352417
Epoch: 4, Steps: 52 | Train Loss: 0.5409065 Vali Loss: 1.4624499 Test Loss: 0.4773211
Validation loss decreased (1.535558 --> 1.462450).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 5 cost time: 0.7503612041473389
Epoch: 5, Steps: 52 | Train Loss: 0.5101124 Vali Loss: 1.4252144 Test Loss: 0.4417140
Validation loss decreased (1.462450 --> 1.425214).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 6 cost time: 1.688063144683838
Epoch: 6, Steps: 52 | Train Loss: 0.4928031 Vali Loss: 1.4116583 Test Loss: 0.4236899
Validation loss decreased (1.425214 --> 1.411658).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 7 cost time: 1.6942291259765625
Epoch: 7, Steps: 52 | Train Loss: 0.4837459 Vali Loss: 1.3898594 Test Loss: 0.4095934
Validation loss decreased (1.411658 --> 1.389859).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 8 cost time: 1.6880123615264893
Epoch: 8, Steps: 52 | Train Loss: 0.4721235 Vali Loss: 1.3819684 Test Loss: 0.3989958
Validation loss decreased (1.389859 --> 1.381968).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 9 cost time: 1.6850297451019287
Epoch: 9, Steps: 52 | Train Loss: 0.4687977 Vali Loss: 1.3672869 Test Loss: 0.3933429
Validation loss decreased (1.381968 --> 1.367287).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 10 cost time: 1.6940336227416992
Epoch: 10, Steps: 52 | Train Loss: 0.4637401 Vali Loss: 1.3733674 Test Loss: 0.3866120
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 11 cost time: 1.6838810443878174
Epoch: 11, Steps: 52 | Train Loss: 0.4593697 Vali Loss: 1.3574404 Test Loss: 0.3823391
Validation loss decreased (1.367287 --> 1.357440).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 12 cost time: 1.6924335956573486
Epoch: 12, Steps: 52 | Train Loss: 0.4582154 Vali Loss: 1.3559130 Test Loss: 0.3783580
Validation loss decreased (1.357440 --> 1.355913).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 13 cost time: 1.6779778003692627
Epoch: 13, Steps: 52 | Train Loss: 0.4530865 Vali Loss: 1.3596630 Test Loss: 0.3753205
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 14 cost time: 1.6956331729888916
Epoch: 14, Steps: 52 | Train Loss: 0.4520064 Vali Loss: 1.3580375 Test Loss: 0.3723152
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 15 cost time: 1.6914002895355225
Epoch: 15, Steps: 52 | Train Loss: 0.4503231 Vali Loss: 1.3530271 Test Loss: 0.3707725
Validation loss decreased (1.355913 --> 1.353027).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 16 cost time: 1.690960168838501
Epoch: 16, Steps: 52 | Train Loss: 0.4460743 Vali Loss: 1.3499765 Test Loss: 0.3683320
Validation loss decreased (1.353027 --> 1.349977).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 17 cost time: 1.6880111694335938
Epoch: 17, Steps: 52 | Train Loss: 0.4444612 Vali Loss: 1.3456666 Test Loss: 0.3650138
Validation loss decreased (1.349977 --> 1.345667).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 18 cost time: 1.6957645416259766
Epoch: 18, Steps: 52 | Train Loss: 0.4448757 Vali Loss: 1.3491291 Test Loss: 0.3645108
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 19 cost time: 1.687842607498169
Epoch: 19, Steps: 52 | Train Loss: 0.4447653 Vali Loss: 1.3455001 Test Loss: 0.3623053
Validation loss decreased (1.345667 --> 1.345500).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 20 cost time: 1.6954615116119385
Epoch: 20, Steps: 52 | Train Loss: 0.4455178 Vali Loss: 1.3378782 Test Loss: 0.3613350
Validation loss decreased (1.345500 --> 1.337878).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 21 cost time: 1.6910560131072998
Epoch: 21, Steps: 52 | Train Loss: 0.4428999 Vali Loss: 1.3382524 Test Loss: 0.3605783
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 22 cost time: 1.6938996315002441
Epoch: 22, Steps: 52 | Train Loss: 0.4430043 Vali Loss: 1.3371778 Test Loss: 0.3588436
Validation loss decreased (1.337878 --> 1.337178).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 23 cost time: 1.6900379657745361
Epoch: 23, Steps: 52 | Train Loss: 0.4410811 Vali Loss: 1.3307964 Test Loss: 0.3591264
Validation loss decreased (1.337178 --> 1.330796).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 24 cost time: 1.684401512145996
Epoch: 24, Steps: 52 | Train Loss: 0.4427623 Vali Loss: 1.3383186 Test Loss: 0.3580465
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 25 cost time: 1.68025803565979
Epoch: 25, Steps: 52 | Train Loss: 0.4404725 Vali Loss: 1.3395376 Test Loss: 0.3572495
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 26 cost time: 1.686004877090454
Epoch: 26, Steps: 52 | Train Loss: 0.4386319 Vali Loss: 1.3322803 Test Loss: 0.3565254
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 27 cost time: 1.671485185623169
Epoch: 27, Steps: 52 | Train Loss: 0.4382668 Vali Loss: 1.3348624 Test Loss: 0.3567366
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 28 cost time: 1.673781394958496
Epoch: 28, Steps: 52 | Train Loss: 0.4383123 Vali Loss: 1.3347089 Test Loss: 0.3549418
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 29 cost time: 1.6873741149902344
Epoch: 29, Steps: 52 | Train Loss: 0.4388770 Vali Loss: 1.3328459 Test Loss: 0.3553118
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 30 cost time: 1.6840379238128662
Epoch: 30, Steps: 52 | Train Loss: 0.4372464 Vali Loss: 1.3348563 Test Loss: 0.3557243
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 31 cost time: 1.682382583618164
Epoch: 31, Steps: 52 | Train Loss: 0.4374201 Vali Loss: 1.3343817 Test Loss: 0.3540775
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 32 cost time: 1.6944382190704346
Epoch: 32, Steps: 52 | Train Loss: 0.4360519 Vali Loss: 1.3201766 Test Loss: 0.3542718
Validation loss decreased (1.330796 --> 1.320177).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 33 cost time: 1.685340166091919
Epoch: 33, Steps: 52 | Train Loss: 0.4366771 Vali Loss: 1.3229337 Test Loss: 0.3537917
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 34 cost time: 1.7148265838623047
Epoch: 34, Steps: 52 | Train Loss: 0.4372169 Vali Loss: 1.3336339 Test Loss: 0.3540892
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 35 cost time: 1.6930427551269531
Epoch: 35, Steps: 52 | Train Loss: 0.4372054 Vali Loss: 1.3293241 Test Loss: 0.3530741
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 36 cost time: 1.6904168128967285
Epoch: 36, Steps: 52 | Train Loss: 0.4339767 Vali Loss: 1.3217260 Test Loss: 0.3520845
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 37 cost time: 1.6840806007385254
Epoch: 37, Steps: 52 | Train Loss: 0.4357067 Vali Loss: 1.3310616 Test Loss: 0.3525380
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 38 cost time: 1.6943793296813965
Epoch: 38, Steps: 52 | Train Loss: 0.4367079 Vali Loss: 1.3297944 Test Loss: 0.3535008
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 39 cost time: 1.6900439262390137
Epoch: 39, Steps: 52 | Train Loss: 0.4376909 Vali Loss: 1.3272982 Test Loss: 0.3527340
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 40 cost time: 1.6902260780334473
Epoch: 40, Steps: 52 | Train Loss: 0.4366245 Vali Loss: 1.3310115 Test Loss: 0.3523784
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 41 cost time: 1.6920347213745117
Epoch: 41, Steps: 52 | Train Loss: 0.4341993 Vali Loss: 1.3332412 Test Loss: 0.3524558
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 42 cost time: 1.6779367923736572
Epoch: 42, Steps: 52 | Train Loss: 0.4340489 Vali Loss: 1.3262968 Test Loss: 0.3526671
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 43 cost time: 1.6854143142700195
Epoch: 43, Steps: 52 | Train Loss: 0.4354308 Vali Loss: 1.3307693 Test Loss: 0.3518186
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 44 cost time: 1.6901838779449463
Epoch: 44, Steps: 52 | Train Loss: 0.4369123 Vali Loss: 1.3259165 Test Loss: 0.3517411
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 45 cost time: 1.684605598449707
Epoch: 45, Steps: 52 | Train Loss: 0.4359129 Vali Loss: 1.3325257 Test Loss: 0.3525298
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 46 cost time: 1.6970100402832031
Epoch: 46, Steps: 52 | Train Loss: 0.4369914 Vali Loss: 1.3304248 Test Loss: 0.3521993
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 47 cost time: 1.696838617324829
Epoch: 47, Steps: 52 | Train Loss: 0.4366202 Vali Loss: 1.3288535 Test Loss: 0.3519751
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 48 cost time: 1.6880474090576172
Epoch: 48, Steps: 52 | Train Loss: 0.4364434 Vali Loss: 1.3174245 Test Loss: 0.3510586
Validation loss decreased (1.320177 --> 1.317425).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 49 cost time: 1.6937541961669922
Epoch: 49, Steps: 52 | Train Loss: 0.4339275 Vali Loss: 1.3296983 Test Loss: 0.3515599
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 50 cost time: 1.692418098449707
Epoch: 50, Steps: 52 | Train Loss: 0.4358608 Vali Loss: 1.3340609 Test Loss: 0.3521519
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 51 cost time: 1.6894359588623047
Epoch: 51, Steps: 52 | Train Loss: 0.4345433 Vali Loss: 1.3298198 Test Loss: 0.3515555
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 52 cost time: 1.6945180892944336
Epoch: 52, Steps: 52 | Train Loss: 0.4348346 Vali Loss: 1.3318400 Test Loss: 0.3514964
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 53 cost time: 1.6956541538238525
Epoch: 53, Steps: 52 | Train Loss: 0.4352451 Vali Loss: 1.3221600 Test Loss: 0.3514648
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 54 cost time: 1.680431604385376
Epoch: 54, Steps: 52 | Train Loss: 0.4372968 Vali Loss: 1.3263819 Test Loss: 0.3510361
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 55 cost time: 1.6911625862121582
Epoch: 55, Steps: 52 | Train Loss: 0.4348021 Vali Loss: 1.3194451 Test Loss: 0.3517614
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 56 cost time: 1.6764562129974365
Epoch: 56, Steps: 52 | Train Loss: 0.4352250 Vali Loss: 1.3246713 Test Loss: 0.3505864
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 57 cost time: 1.695737361907959
Epoch: 57, Steps: 52 | Train Loss: 0.4353365 Vali Loss: 1.3220849 Test Loss: 0.3518340
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 58 cost time: 1.6824960708618164
Epoch: 58, Steps: 52 | Train Loss: 0.4358574 Vali Loss: 1.3326120 Test Loss: 0.3519321
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 59 cost time: 1.6890647411346436
Epoch: 59, Steps: 52 | Train Loss: 0.4348652 Vali Loss: 1.3287941 Test Loss: 0.3507945
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 60 cost time: 1.6814775466918945
Epoch: 60, Steps: 52 | Train Loss: 0.4360301 Vali Loss: 1.3240023 Test Loss: 0.3518488
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35105860233306885, mae:0.3936915099620819, rse:0.48539870977401733
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04837989807128906 GB
Epoch: 1 cost time: 2.1905083656311035
Epoch: 1, Steps: 52 | Train Loss: 0.7561143 Vali Loss: 2.2322388 Test Loss: 1.4372823
Validation loss decreased (inf --> 2.232239).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 2 cost time: 0.7839999198913574
Epoch: 2, Steps: 52 | Train Loss: 0.6854117 Vali Loss: 1.8807749 Test Loss: 1.0395377
Validation loss decreased (2.232239 --> 1.880775).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 3 cost time: 0.7787513732910156
Epoch: 3, Steps: 52 | Train Loss: 0.5884991 Vali Loss: 1.6829611 Test Loss: 0.7837083
Validation loss decreased (1.880775 --> 1.682961).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 4 cost time: 0.7793803215026855
Epoch: 4, Steps: 52 | Train Loss: 0.5286144 Vali Loss: 1.5377562 Test Loss: 0.5842763
Validation loss decreased (1.682961 --> 1.537756).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 5 cost time: 0.8407909870147705
Epoch: 5, Steps: 52 | Train Loss: 0.4859608 Vali Loss: 1.4623917 Test Loss: 0.4779762
Validation loss decreased (1.537756 --> 1.462392).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 6 cost time: 1.756493091583252
Epoch: 6, Steps: 52 | Train Loss: 0.4637628 Vali Loss: 1.4201596 Test Loss: 0.4320861
Validation loss decreased (1.462392 --> 1.420160).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 7 cost time: 1.754098653793335
Epoch: 7, Steps: 52 | Train Loss: 0.4517472 Vali Loss: 1.4097791 Test Loss: 0.4127684
Validation loss decreased (1.420160 --> 1.409779).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 8 cost time: 1.7496051788330078
Epoch: 8, Steps: 52 | Train Loss: 0.4460230 Vali Loss: 1.3884865 Test Loss: 0.4004206
Validation loss decreased (1.409779 --> 1.388487).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 9 cost time: 1.753016710281372
Epoch: 9, Steps: 52 | Train Loss: 0.4414487 Vali Loss: 1.3850949 Test Loss: 0.3899290
Validation loss decreased (1.388487 --> 1.385095).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 10 cost time: 1.745171308517456
Epoch: 10, Steps: 52 | Train Loss: 0.4377736 Vali Loss: 1.3714466 Test Loss: 0.3845589
Validation loss decreased (1.385095 --> 1.371447).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 11 cost time: 1.7479240894317627
Epoch: 11, Steps: 52 | Train Loss: 0.4337195 Vali Loss: 1.3725662 Test Loss: 0.3782332
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 12 cost time: 1.760101318359375
Epoch: 12, Steps: 52 | Train Loss: 0.4337646 Vali Loss: 1.3592021 Test Loss: 0.3750590
Validation loss decreased (1.371447 --> 1.359202).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 13 cost time: 1.7421841621398926
Epoch: 13, Steps: 52 | Train Loss: 0.4326281 Vali Loss: 1.3578124 Test Loss: 0.3719198
Validation loss decreased (1.359202 --> 1.357812).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 14 cost time: 1.7544217109680176
Epoch: 14, Steps: 52 | Train Loss: 0.4308184 Vali Loss: 1.3557351 Test Loss: 0.3689827
Validation loss decreased (1.357812 --> 1.355735).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 15 cost time: 1.7614314556121826
Epoch: 15, Steps: 52 | Train Loss: 0.4277535 Vali Loss: 1.3434529 Test Loss: 0.3666715
Validation loss decreased (1.355735 --> 1.343453).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 16 cost time: 1.7600374221801758
Epoch: 16, Steps: 52 | Train Loss: 0.4274223 Vali Loss: 1.3478668 Test Loss: 0.3652014
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 17 cost time: 1.7564697265625
Epoch: 17, Steps: 52 | Train Loss: 0.4271798 Vali Loss: 1.3532995 Test Loss: 0.3638953
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 18 cost time: 1.7577741146087646
Epoch: 18, Steps: 52 | Train Loss: 0.4259617 Vali Loss: 1.3474416 Test Loss: 0.3612956
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 19 cost time: 1.7564725875854492
Epoch: 19, Steps: 52 | Train Loss: 0.4232241 Vali Loss: 1.3309298 Test Loss: 0.3606066
Validation loss decreased (1.343453 --> 1.330930).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 20 cost time: 1.7479791641235352
Epoch: 20, Steps: 52 | Train Loss: 0.4211750 Vali Loss: 1.3455653 Test Loss: 0.3595473
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 21 cost time: 1.7594833374023438
Epoch: 21, Steps: 52 | Train Loss: 0.4239172 Vali Loss: 1.3398325 Test Loss: 0.3589875
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 22 cost time: 1.7505581378936768
Epoch: 22, Steps: 52 | Train Loss: 0.4222923 Vali Loss: 1.3334070 Test Loss: 0.3586031
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 23 cost time: 1.7543697357177734
Epoch: 23, Steps: 52 | Train Loss: 0.4218325 Vali Loss: 1.3362308 Test Loss: 0.3573996
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 24 cost time: 1.7494397163391113
Epoch: 24, Steps: 52 | Train Loss: 0.4219459 Vali Loss: 1.3426746 Test Loss: 0.3567828
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 25 cost time: 1.7564785480499268
Epoch: 25, Steps: 52 | Train Loss: 0.4215027 Vali Loss: 1.3412838 Test Loss: 0.3560850
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 26 cost time: 1.7514050006866455
Epoch: 26, Steps: 52 | Train Loss: 0.4225933 Vali Loss: 1.3377271 Test Loss: 0.3557222
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 27 cost time: 1.749392032623291
Epoch: 27, Steps: 52 | Train Loss: 0.4209288 Vali Loss: 1.3373491 Test Loss: 0.3558535
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 28 cost time: 1.7417919635772705
Epoch: 28, Steps: 52 | Train Loss: 0.4187760 Vali Loss: 1.3332131 Test Loss: 0.3555483
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 29 cost time: 1.759300708770752
Epoch: 29, Steps: 52 | Train Loss: 0.4196768 Vali Loss: 1.3344376 Test Loss: 0.3551065
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 30 cost time: 1.752173900604248
Epoch: 30, Steps: 52 | Train Loss: 0.4207008 Vali Loss: 1.3279583 Test Loss: 0.3543500
Validation loss decreased (1.330930 --> 1.327958).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 31 cost time: 1.7625138759613037
Epoch: 31, Steps: 52 | Train Loss: 0.4197769 Vali Loss: 1.3316131 Test Loss: 0.3541027
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 32 cost time: 1.7560899257659912
Epoch: 32, Steps: 52 | Train Loss: 0.4199573 Vali Loss: 1.3330712 Test Loss: 0.3544249
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 33 cost time: 1.751028060913086
Epoch: 33, Steps: 52 | Train Loss: 0.4207361 Vali Loss: 1.3331690 Test Loss: 0.3539097
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 34 cost time: 1.7546331882476807
Epoch: 34, Steps: 52 | Train Loss: 0.4195945 Vali Loss: 1.3300960 Test Loss: 0.3542626
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 35 cost time: 1.7593960762023926
Epoch: 35, Steps: 52 | Train Loss: 0.4199021 Vali Loss: 1.3318211 Test Loss: 0.3533437
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 36 cost time: 1.7417347431182861
Epoch: 36, Steps: 52 | Train Loss: 0.4199880 Vali Loss: 1.3300500 Test Loss: 0.3539725
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 37 cost time: 1.7594234943389893
Epoch: 37, Steps: 52 | Train Loss: 0.4196330 Vali Loss: 1.3307831 Test Loss: 0.3532617
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 38 cost time: 1.7605290412902832
Epoch: 38, Steps: 52 | Train Loss: 0.4195501 Vali Loss: 1.3283067 Test Loss: 0.3530051
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 39 cost time: 1.7464838027954102
Epoch: 39, Steps: 52 | Train Loss: 0.4181205 Vali Loss: 1.3325870 Test Loss: 0.3530555
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 40 cost time: 1.7551631927490234
Epoch: 40, Steps: 52 | Train Loss: 0.4205003 Vali Loss: 1.3334758 Test Loss: 0.3531592
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 41 cost time: 1.7510271072387695
Epoch: 41, Steps: 52 | Train Loss: 0.4212783 Vali Loss: 1.3273916 Test Loss: 0.3524760
Validation loss decreased (1.327958 --> 1.327392).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 42 cost time: 1.7656285762786865
Epoch: 42, Steps: 52 | Train Loss: 0.4189953 Vali Loss: 1.3298705 Test Loss: 0.3528149
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 43 cost time: 1.7572765350341797
Epoch: 43, Steps: 52 | Train Loss: 0.4187873 Vali Loss: 1.3361709 Test Loss: 0.3531404
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 44 cost time: 1.756044626235962
Epoch: 44, Steps: 52 | Train Loss: 0.4172459 Vali Loss: 1.3315122 Test Loss: 0.3527097
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 45 cost time: 1.746201515197754
Epoch: 45, Steps: 52 | Train Loss: 0.4192746 Vali Loss: 1.3353729 Test Loss: 0.3526610
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 46 cost time: 1.759526014328003
Epoch: 46, Steps: 52 | Train Loss: 0.4186761 Vali Loss: 1.3350918 Test Loss: 0.3532057
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 47 cost time: 1.7523691654205322
Epoch: 47, Steps: 52 | Train Loss: 0.4206523 Vali Loss: 1.3368034 Test Loss: 0.3525409
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 48 cost time: 1.752073049545288
Epoch: 48, Steps: 52 | Train Loss: 0.4185918 Vali Loss: 1.3255668 Test Loss: 0.3538018
Validation loss decreased (1.327392 --> 1.325567).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 49 cost time: 1.7566578388214111
Epoch: 49, Steps: 52 | Train Loss: 0.4195361 Vali Loss: 1.3363702 Test Loss: 0.3529181
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 50 cost time: 1.7449431419372559
Epoch: 50, Steps: 52 | Train Loss: 0.4169721 Vali Loss: 1.3326914 Test Loss: 0.3525866
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 51 cost time: 1.756471872329712
Epoch: 51, Steps: 52 | Train Loss: 0.4175889 Vali Loss: 1.3313475 Test Loss: 0.3526169
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 52 cost time: 1.7509474754333496
Epoch: 52, Steps: 52 | Train Loss: 0.4196805 Vali Loss: 1.3268757 Test Loss: 0.3527951
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 53 cost time: 1.7570233345031738
Epoch: 53, Steps: 52 | Train Loss: 0.4185684 Vali Loss: 1.3322443 Test Loss: 0.3526772
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 54 cost time: 1.7443697452545166
Epoch: 54, Steps: 52 | Train Loss: 0.4173561 Vali Loss: 1.3291531 Test Loss: 0.3527404
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 55 cost time: 1.7418198585510254
Epoch: 55, Steps: 52 | Train Loss: 0.4187792 Vali Loss: 1.3234789 Test Loss: 0.3526866
Validation loss decreased (1.325567 --> 1.323479).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 56 cost time: 1.7564082145690918
Epoch: 56, Steps: 52 | Train Loss: 0.4184096 Vali Loss: 1.3318280 Test Loss: 0.3525741
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 57 cost time: 1.753953456878662
Epoch: 57, Steps: 52 | Train Loss: 0.4180775 Vali Loss: 1.3310103 Test Loss: 0.3526559
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 58 cost time: 1.7486224174499512
Epoch: 58, Steps: 52 | Train Loss: 0.4191137 Vali Loss: 1.3268809 Test Loss: 0.3521579
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 59 cost time: 1.7578001022338867
Epoch: 59, Steps: 52 | Train Loss: 0.4179379 Vali Loss: 1.3234875 Test Loss: 0.3520868
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 60 cost time: 1.7587692737579346
Epoch: 60, Steps: 52 | Train Loss: 0.4192484 Vali Loss: 1.3289514 Test Loss: 0.3517984
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35268664360046387, mae:0.39612388610839844, rse:0.486522912979126
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.04894399642944336 GB
Epoch: 1 cost time: 2.188105583190918
Epoch: 1, Steps: 52 | Train Loss: 0.7243168 Vali Loss: 2.2281489 Test Loss: 1.4793789
Validation loss decreased (inf --> 2.228149).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 2 cost time: 0.797621488571167
Epoch: 2, Steps: 52 | Train Loss: 0.6735414 Vali Loss: 1.9777191 Test Loss: 1.1821905
Validation loss decreased (2.228149 --> 1.977719).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 3 cost time: 0.8003923892974854
Epoch: 3, Steps: 52 | Train Loss: 0.5957216 Vali Loss: 1.7250341 Test Loss: 0.8453977
Validation loss decreased (1.977719 --> 1.725034).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 4 cost time: 0.8033695220947266
Epoch: 4, Steps: 52 | Train Loss: 0.5178482 Vali Loss: 1.5140252 Test Loss: 0.5555006
Validation loss decreased (1.725034 --> 1.514025).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 5 cost time: 1.022674798965454
Epoch: 5, Steps: 52 | Train Loss: 0.4698753 Vali Loss: 1.4556956 Test Loss: 0.4609905
Validation loss decreased (1.514025 --> 1.455696).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 6 cost time: 1.8093006610870361
Epoch: 6, Steps: 52 | Train Loss: 0.4532428 Vali Loss: 1.4163837 Test Loss: 0.4284940
Validation loss decreased (1.455696 --> 1.416384).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 7 cost time: 1.8051674365997314
Epoch: 7, Steps: 52 | Train Loss: 0.4444350 Vali Loss: 1.4053822 Test Loss: 0.4148074
Validation loss decreased (1.416384 --> 1.405382).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 8 cost time: 1.8023872375488281
Epoch: 8, Steps: 52 | Train Loss: 0.4392691 Vali Loss: 1.3954246 Test Loss: 0.4022858
Validation loss decreased (1.405382 --> 1.395425).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 9 cost time: 1.798518180847168
Epoch: 9, Steps: 52 | Train Loss: 0.4364346 Vali Loss: 1.3782580 Test Loss: 0.3936657
Validation loss decreased (1.395425 --> 1.378258).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 10 cost time: 1.7988553047180176
Epoch: 10, Steps: 52 | Train Loss: 0.4321221 Vali Loss: 1.3737874 Test Loss: 0.3871876
Validation loss decreased (1.378258 --> 1.373787).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 11 cost time: 1.8013298511505127
Epoch: 11, Steps: 52 | Train Loss: 0.4305138 Vali Loss: 1.3655126 Test Loss: 0.3810313
Validation loss decreased (1.373787 --> 1.365513).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 12 cost time: 1.8065581321716309
Epoch: 12, Steps: 52 | Train Loss: 0.4268749 Vali Loss: 1.3572989 Test Loss: 0.3775503
Validation loss decreased (1.365513 --> 1.357299).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 13 cost time: 1.791337251663208
Epoch: 13, Steps: 52 | Train Loss: 0.4254855 Vali Loss: 1.3587781 Test Loss: 0.3729348
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 14 cost time: 1.7920026779174805
Epoch: 14, Steps: 52 | Train Loss: 0.4234123 Vali Loss: 1.3553944 Test Loss: 0.3699796
Validation loss decreased (1.357299 --> 1.355394).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 15 cost time: 1.7869067192077637
Epoch: 15, Steps: 52 | Train Loss: 0.4229085 Vali Loss: 1.3453147 Test Loss: 0.3678074
Validation loss decreased (1.355394 --> 1.345315).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 16 cost time: 1.8073890209197998
Epoch: 16, Steps: 52 | Train Loss: 0.4237327 Vali Loss: 1.3423548 Test Loss: 0.3654080
Validation loss decreased (1.345315 --> 1.342355).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 17 cost time: 1.8009402751922607
Epoch: 17, Steps: 52 | Train Loss: 0.4209412 Vali Loss: 1.3421010 Test Loss: 0.3629993
Validation loss decreased (1.342355 --> 1.342101).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 18 cost time: 1.8046152591705322
Epoch: 18, Steps: 52 | Train Loss: 0.4208565 Vali Loss: 1.3357984 Test Loss: 0.3624040
Validation loss decreased (1.342101 --> 1.335798).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 19 cost time: 1.8014256954193115
Epoch: 19, Steps: 52 | Train Loss: 0.4201436 Vali Loss: 1.3434227 Test Loss: 0.3614194
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 20 cost time: 1.802741527557373
Epoch: 20, Steps: 52 | Train Loss: 0.4191175 Vali Loss: 1.3378116 Test Loss: 0.3595548
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 21 cost time: 1.7991924285888672
Epoch: 21, Steps: 52 | Train Loss: 0.4179255 Vali Loss: 1.3369155 Test Loss: 0.3590260
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 22 cost time: 1.7951362133026123
Epoch: 22, Steps: 52 | Train Loss: 0.4161534 Vali Loss: 1.3348404 Test Loss: 0.3583614
Validation loss decreased (1.335798 --> 1.334840).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 23 cost time: 1.798565149307251
Epoch: 23, Steps: 52 | Train Loss: 0.4169097 Vali Loss: 1.3327155 Test Loss: 0.3573711
Validation loss decreased (1.334840 --> 1.332716).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 24 cost time: 1.7990269660949707
Epoch: 24, Steps: 52 | Train Loss: 0.4182142 Vali Loss: 1.3246373 Test Loss: 0.3570031
Validation loss decreased (1.332716 --> 1.324637).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 25 cost time: 1.8010296821594238
Epoch: 25, Steps: 52 | Train Loss: 0.4161286 Vali Loss: 1.3273249 Test Loss: 0.3567891
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 26 cost time: 1.8006994724273682
Epoch: 26, Steps: 52 | Train Loss: 0.4152910 Vali Loss: 1.3298644 Test Loss: 0.3559371
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 27 cost time: 1.7914409637451172
Epoch: 27, Steps: 52 | Train Loss: 0.4159429 Vali Loss: 1.3325481 Test Loss: 0.3555947
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 28 cost time: 1.796525001525879
Epoch: 28, Steps: 52 | Train Loss: 0.4162139 Vali Loss: 1.3298757 Test Loss: 0.3544154
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 29 cost time: 1.799717664718628
Epoch: 29, Steps: 52 | Train Loss: 0.4160007 Vali Loss: 1.3249627 Test Loss: 0.3547505
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 30 cost time: 1.8009207248687744
Epoch: 30, Steps: 52 | Train Loss: 0.4158125 Vali Loss: 1.3239722 Test Loss: 0.3544947
Validation loss decreased (1.324637 --> 1.323972).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 31 cost time: 1.7950189113616943
Epoch: 31, Steps: 52 | Train Loss: 0.4155919 Vali Loss: 1.3211219 Test Loss: 0.3539825
Validation loss decreased (1.323972 --> 1.321122).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 32 cost time: 1.8057100772857666
Epoch: 32, Steps: 52 | Train Loss: 0.4155309 Vali Loss: 1.3247039 Test Loss: 0.3539588
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 33 cost time: 1.7994000911712646
Epoch: 33, Steps: 52 | Train Loss: 0.4153776 Vali Loss: 1.3246734 Test Loss: 0.3539478
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 34 cost time: 1.802037239074707
Epoch: 34, Steps: 52 | Train Loss: 0.4155833 Vali Loss: 1.3234606 Test Loss: 0.3535960
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 35 cost time: 1.8010718822479248
Epoch: 35, Steps: 52 | Train Loss: 0.4164046 Vali Loss: 1.3222126 Test Loss: 0.3541990
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 36 cost time: 1.8021461963653564
Epoch: 36, Steps: 52 | Train Loss: 0.4138846 Vali Loss: 1.3188367 Test Loss: 0.3533567
Validation loss decreased (1.321122 --> 1.318837).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 37 cost time: 1.8024230003356934
Epoch: 37, Steps: 52 | Train Loss: 0.4138185 Vali Loss: 1.3242803 Test Loss: 0.3530713
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 38 cost time: 1.7896618843078613
Epoch: 38, Steps: 52 | Train Loss: 0.4150172 Vali Loss: 1.3221717 Test Loss: 0.3529492
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 39 cost time: 1.801382064819336
Epoch: 39, Steps: 52 | Train Loss: 0.4143316 Vali Loss: 1.3286266 Test Loss: 0.3532465
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 40 cost time: 1.7970428466796875
Epoch: 40, Steps: 52 | Train Loss: 0.4134696 Vali Loss: 1.3190510 Test Loss: 0.3523339
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 41 cost time: 1.817889928817749
Epoch: 41, Steps: 52 | Train Loss: 0.4125169 Vali Loss: 1.3197240 Test Loss: 0.3524984
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 42 cost time: 1.8790550231933594
Epoch: 42, Steps: 52 | Train Loss: 0.4142914 Vali Loss: 1.3234160 Test Loss: 0.3529084
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 43 cost time: 1.7928733825683594
Epoch: 43, Steps: 52 | Train Loss: 0.4140804 Vali Loss: 1.3208319 Test Loss: 0.3528147
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 44 cost time: 1.796123743057251
Epoch: 44, Steps: 52 | Train Loss: 0.4138548 Vali Loss: 1.3216648 Test Loss: 0.3519471
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 45 cost time: 1.808039903640747
Epoch: 45, Steps: 52 | Train Loss: 0.4142735 Vali Loss: 1.3085246 Test Loss: 0.3525869
Validation loss decreased (1.318837 --> 1.308525).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 46 cost time: 1.7914724349975586
Epoch: 46, Steps: 52 | Train Loss: 0.4130866 Vali Loss: 1.3181701 Test Loss: 0.3533076
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 47 cost time: 1.7953064441680908
Epoch: 47, Steps: 52 | Train Loss: 0.4119946 Vali Loss: 1.3287067 Test Loss: 0.3525800
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 48 cost time: 1.8025453090667725
Epoch: 48, Steps: 52 | Train Loss: 0.4147160 Vali Loss: 1.3259621 Test Loss: 0.3523574
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 49 cost time: 1.7961196899414062
Epoch: 49, Steps: 52 | Train Loss: 0.4142950 Vali Loss: 1.3242993 Test Loss: 0.3521531
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 50 cost time: 1.8013553619384766
Epoch: 50, Steps: 52 | Train Loss: 0.4136365 Vali Loss: 1.3222995 Test Loss: 0.3521994
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 51 cost time: 1.7965021133422852
Epoch: 51, Steps: 52 | Train Loss: 0.4135274 Vali Loss: 1.3207117 Test Loss: 0.3526105
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 52 cost time: 1.792104959487915
Epoch: 52, Steps: 52 | Train Loss: 0.4141575 Vali Loss: 1.3171639 Test Loss: 0.3519735
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 53 cost time: 1.7961108684539795
Epoch: 53, Steps: 52 | Train Loss: 0.4132483 Vali Loss: 1.3248366 Test Loss: 0.3524253
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 54 cost time: 1.7969510555267334
Epoch: 54, Steps: 52 | Train Loss: 0.4134141 Vali Loss: 1.3222433 Test Loss: 0.3520996
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 55 cost time: 1.7962934970855713
Epoch: 55, Steps: 52 | Train Loss: 0.4123147 Vali Loss: 1.3228490 Test Loss: 0.3523658
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 56 cost time: 1.8011717796325684
Epoch: 56, Steps: 52 | Train Loss: 0.4137443 Vali Loss: 1.3244780 Test Loss: 0.3517261
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 57 cost time: 1.788358211517334
Epoch: 57, Steps: 52 | Train Loss: 0.4135797 Vali Loss: 1.3227837 Test Loss: 0.3518383
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 58 cost time: 1.7937893867492676
Epoch: 58, Steps: 52 | Train Loss: 0.4132642 Vali Loss: 1.3236325 Test Loss: 0.3518211
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 59 cost time: 1.7953050136566162
Epoch: 59, Steps: 52 | Train Loss: 0.4136928 Vali Loss: 1.3209420 Test Loss: 0.3515160
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 60 cost time: 1.7892837524414062
Epoch: 60, Steps: 52 | Train Loss: 0.4135215 Vali Loss: 1.3240802 Test Loss: 0.3520257
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35258686542510986, mae:0.39795565605163574, rse:0.4864541292190552
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04783916473388672 GB
Epoch: 1 cost time: 2.1579174995422363
Epoch: 1, Steps: 52 | Train Loss: 1.0311712 Vali Loss: 2.7782660 Test Loss: 1.9568094
Validation loss decreased (inf --> 2.778266).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 2 cost time: 0.758512020111084
Epoch: 2, Steps: 52 | Train Loss: 0.8672378 Vali Loss: 2.0137711 Test Loss: 1.1008542
Validation loss decreased (2.778266 --> 2.013771).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 3 cost time: 0.7584240436553955
Epoch: 3, Steps: 52 | Train Loss: 0.6618118 Vali Loss: 1.6754410 Test Loss: 0.6964515
Validation loss decreased (2.013771 --> 1.675441).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 4 cost time: 0.7510013580322266
Epoch: 4, Steps: 52 | Train Loss: 0.5662874 Vali Loss: 1.5411882 Test Loss: 0.5389531
Validation loss decreased (1.675441 --> 1.541188).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 5 cost time: 0.7566311359405518
Epoch: 5, Steps: 52 | Train Loss: 0.5241536 Vali Loss: 1.4807414 Test Loss: 0.4777763
Validation loss decreased (1.541188 --> 1.480741).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 6 cost time: 1.7170658111572266
Epoch: 6, Steps: 52 | Train Loss: 0.5007231 Vali Loss: 1.4474947 Test Loss: 0.4513410
Validation loss decreased (1.480741 --> 1.447495).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 7 cost time: 1.7024900913238525
Epoch: 7, Steps: 52 | Train Loss: 0.4890251 Vali Loss: 1.4326638 Test Loss: 0.4324803
Validation loss decreased (1.447495 --> 1.432664).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 8 cost time: 1.7075436115264893
Epoch: 8, Steps: 52 | Train Loss: 0.4815412 Vali Loss: 1.4201770 Test Loss: 0.4215648
Validation loss decreased (1.432664 --> 1.420177).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 9 cost time: 1.7129485607147217
Epoch: 9, Steps: 52 | Train Loss: 0.4736291 Vali Loss: 1.4095073 Test Loss: 0.4142253
Validation loss decreased (1.420177 --> 1.409507).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 10 cost time: 1.7020268440246582
Epoch: 10, Steps: 52 | Train Loss: 0.4653963 Vali Loss: 1.4006397 Test Loss: 0.4062533
Validation loss decreased (1.409507 --> 1.400640).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 11 cost time: 1.708911657333374
Epoch: 11, Steps: 52 | Train Loss: 0.4626950 Vali Loss: 1.3847363 Test Loss: 0.4005508
Validation loss decreased (1.400640 --> 1.384736).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 12 cost time: 1.7045152187347412
Epoch: 12, Steps: 52 | Train Loss: 0.4617753 Vali Loss: 1.3948531 Test Loss: 0.3973037
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 13 cost time: 1.6969881057739258
Epoch: 13, Steps: 52 | Train Loss: 0.4572845 Vali Loss: 1.3887883 Test Loss: 0.3927695
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 14 cost time: 1.7071168422698975
Epoch: 14, Steps: 52 | Train Loss: 0.4560386 Vali Loss: 1.3781788 Test Loss: 0.3907685
Validation loss decreased (1.384736 --> 1.378179).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 15 cost time: 1.7001585960388184
Epoch: 15, Steps: 52 | Train Loss: 0.4549432 Vali Loss: 1.3771392 Test Loss: 0.3873764
Validation loss decreased (1.378179 --> 1.377139).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 16 cost time: 1.7131121158599854
Epoch: 16, Steps: 52 | Train Loss: 0.4520265 Vali Loss: 1.3787347 Test Loss: 0.3846533
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 17 cost time: 1.713390827178955
Epoch: 17, Steps: 52 | Train Loss: 0.4501156 Vali Loss: 1.3675694 Test Loss: 0.3836566
Validation loss decreased (1.377139 --> 1.367569).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 18 cost time: 1.7068414688110352
Epoch: 18, Steps: 52 | Train Loss: 0.4498520 Vali Loss: 1.3690259 Test Loss: 0.3813062
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 19 cost time: 1.7104449272155762
Epoch: 19, Steps: 52 | Train Loss: 0.4489145 Vali Loss: 1.3523731 Test Loss: 0.3807151
Validation loss decreased (1.367569 --> 1.352373).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 20 cost time: 1.7122533321380615
Epoch: 20, Steps: 52 | Train Loss: 0.4461704 Vali Loss: 1.3638697 Test Loss: 0.3788558
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 21 cost time: 1.7074000835418701
Epoch: 21, Steps: 52 | Train Loss: 0.4461166 Vali Loss: 1.3650347 Test Loss: 0.3777023
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 22 cost time: 1.705376386642456
Epoch: 22, Steps: 52 | Train Loss: 0.4437357 Vali Loss: 1.3690723 Test Loss: 0.3770532
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 23 cost time: 1.7125625610351562
Epoch: 23, Steps: 52 | Train Loss: 0.4452120 Vali Loss: 1.3659518 Test Loss: 0.3760360
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 24 cost time: 1.710580587387085
Epoch: 24, Steps: 52 | Train Loss: 0.4440460 Vali Loss: 1.3588245 Test Loss: 0.3759158
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 25 cost time: 1.697566270828247
Epoch: 25, Steps: 52 | Train Loss: 0.4419661 Vali Loss: 1.3564208 Test Loss: 0.3739099
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 26 cost time: 1.7020342350006104
Epoch: 26, Steps: 52 | Train Loss: 0.4434805 Vali Loss: 1.3579174 Test Loss: 0.3744312
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 27 cost time: 1.7077009677886963
Epoch: 27, Steps: 52 | Train Loss: 0.4433108 Vali Loss: 1.3483528 Test Loss: 0.3739997
Validation loss decreased (1.352373 --> 1.348353).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 28 cost time: 1.7139921188354492
Epoch: 28, Steps: 52 | Train Loss: 0.4413345 Vali Loss: 1.3550636 Test Loss: 0.3732706
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 29 cost time: 1.7090661525726318
Epoch: 29, Steps: 52 | Train Loss: 0.4430256 Vali Loss: 1.3622677 Test Loss: 0.3721747
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 30 cost time: 1.713043451309204
Epoch: 30, Steps: 52 | Train Loss: 0.4404085 Vali Loss: 1.3488133 Test Loss: 0.3729157
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 31 cost time: 1.6968860626220703
Epoch: 31, Steps: 52 | Train Loss: 0.4403675 Vali Loss: 1.3548019 Test Loss: 0.3717643
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 32 cost time: 1.7031762599945068
Epoch: 32, Steps: 52 | Train Loss: 0.4413770 Vali Loss: 1.3524518 Test Loss: 0.3713095
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 33 cost time: 1.7235617637634277
Epoch: 33, Steps: 52 | Train Loss: 0.4401379 Vali Loss: 1.3471265 Test Loss: 0.3705751
Validation loss decreased (1.348353 --> 1.347126).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 34 cost time: 1.7215776443481445
Epoch: 34, Steps: 52 | Train Loss: 0.4418190 Vali Loss: 1.3463066 Test Loss: 0.3706020
Validation loss decreased (1.347126 --> 1.346307).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 35 cost time: 1.70881986618042
Epoch: 35, Steps: 52 | Train Loss: 0.4412308 Vali Loss: 1.3595084 Test Loss: 0.3708551
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 36 cost time: 1.7062058448791504
Epoch: 36, Steps: 52 | Train Loss: 0.4386128 Vali Loss: 1.3572439 Test Loss: 0.3703671
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 37 cost time: 1.718430757522583
Epoch: 37, Steps: 52 | Train Loss: 0.4402105 Vali Loss: 1.3513768 Test Loss: 0.3701390
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 38 cost time: 1.7074782848358154
Epoch: 38, Steps: 52 | Train Loss: 0.4409999 Vali Loss: 1.3554879 Test Loss: 0.3701914
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 39 cost time: 1.7151479721069336
Epoch: 39, Steps: 52 | Train Loss: 0.4402369 Vali Loss: 1.3493068 Test Loss: 0.3706452
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 40 cost time: 1.7050776481628418
Epoch: 40, Steps: 52 | Train Loss: 0.4380865 Vali Loss: 1.3515744 Test Loss: 0.3694168
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 41 cost time: 1.7017943859100342
Epoch: 41, Steps: 52 | Train Loss: 0.4399890 Vali Loss: 1.3546560 Test Loss: 0.3690404
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 42 cost time: 1.7070202827453613
Epoch: 42, Steps: 52 | Train Loss: 0.4396273 Vali Loss: 1.3547382 Test Loss: 0.3700266
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 43 cost time: 1.7113163471221924
Epoch: 43, Steps: 52 | Train Loss: 0.4385829 Vali Loss: 1.3535556 Test Loss: 0.3695603
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 44 cost time: 1.6984148025512695
Epoch: 44, Steps: 52 | Train Loss: 0.4392601 Vali Loss: 1.3518016 Test Loss: 0.3690052
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 45 cost time: 1.7060301303863525
Epoch: 45, Steps: 52 | Train Loss: 0.4398267 Vali Loss: 1.3533899 Test Loss: 0.3694485
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 46 cost time: 1.7111341953277588
Epoch: 46, Steps: 52 | Train Loss: 0.4397285 Vali Loss: 1.3465350 Test Loss: 0.3691431
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 47 cost time: 1.7094569206237793
Epoch: 47, Steps: 52 | Train Loss: 0.4389573 Vali Loss: 1.3575563 Test Loss: 0.3699182
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 48 cost time: 1.702807903289795
Epoch: 48, Steps: 52 | Train Loss: 0.4395113 Vali Loss: 1.3547332 Test Loss: 0.3689944
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 49 cost time: 1.7025034427642822
Epoch: 49, Steps: 52 | Train Loss: 0.4380763 Vali Loss: 1.3437428 Test Loss: 0.3691327
Validation loss decreased (1.346307 --> 1.343743).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 50 cost time: 1.7090506553649902
Epoch: 50, Steps: 52 | Train Loss: 0.4382915 Vali Loss: 1.3455776 Test Loss: 0.3679353
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 51 cost time: 1.7083854675292969
Epoch: 51, Steps: 52 | Train Loss: 0.4395621 Vali Loss: 1.3488634 Test Loss: 0.3684469
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 52 cost time: 1.706634521484375
Epoch: 52, Steps: 52 | Train Loss: 0.4370182 Vali Loss: 1.3502102 Test Loss: 0.3688757
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 53 cost time: 1.7173900604248047
Epoch: 53, Steps: 52 | Train Loss: 0.4368048 Vali Loss: 1.3475089 Test Loss: 0.3680799
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 54 cost time: 1.6993961334228516
Epoch: 54, Steps: 52 | Train Loss: 0.4395163 Vali Loss: 1.3569806 Test Loss: 0.3680257
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 55 cost time: 1.7018320560455322
Epoch: 55, Steps: 52 | Train Loss: 0.4391968 Vali Loss: 1.3496767 Test Loss: 0.3684496
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 56 cost time: 1.7004153728485107
Epoch: 56, Steps: 52 | Train Loss: 0.4393482 Vali Loss: 1.3492913 Test Loss: 0.3687091
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 57 cost time: 1.7152788639068604
Epoch: 57, Steps: 52 | Train Loss: 0.4388084 Vali Loss: 1.3463924 Test Loss: 0.3684850
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 58 cost time: 1.7040541172027588
Epoch: 58, Steps: 52 | Train Loss: 0.4391918 Vali Loss: 1.3429159 Test Loss: 0.3679733
Validation loss decreased (1.343743 --> 1.342916).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 59 cost time: 1.7154126167297363
Epoch: 59, Steps: 52 | Train Loss: 0.4384600 Vali Loss: 1.3460948 Test Loss: 0.3684750
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 60 cost time: 1.7092523574829102
Epoch: 60, Steps: 52 | Train Loss: 0.4372942 Vali Loss: 1.3540843 Test Loss: 0.3690159
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36797329783439636, mae:0.4079878032207489, rse:0.49695485830307007
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.048540592193603516 GB
Epoch: 1 cost time: 2.1729438304901123
Epoch: 1, Steps: 52 | Train Loss: 0.7473807 Vali Loss: 2.2118073 Test Loss: 1.4272933
Validation loss decreased (inf --> 2.211807).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 2 cost time: 0.7764623165130615
Epoch: 2, Steps: 52 | Train Loss: 0.6749827 Vali Loss: 1.8335605 Test Loss: 0.9900534
Validation loss decreased (2.211807 --> 1.833560).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 3 cost time: 0.7810020446777344
Epoch: 3, Steps: 52 | Train Loss: 0.5611775 Vali Loss: 1.5657337 Test Loss: 0.6460972
Validation loss decreased (1.833560 --> 1.565734).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 4 cost time: 0.78542160987854
Epoch: 4, Steps: 52 | Train Loss: 0.4920931 Vali Loss: 1.4487851 Test Loss: 0.4752278
Validation loss decreased (1.565734 --> 1.448785).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 5 cost time: 0.8421623706817627
Epoch: 5, Steps: 52 | Train Loss: 0.4632809 Vali Loss: 1.4081488 Test Loss: 0.4266874
Validation loss decreased (1.448785 --> 1.408149).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 6 cost time: 1.755336046218872
Epoch: 6, Steps: 52 | Train Loss: 0.4513791 Vali Loss: 1.3921895 Test Loss: 0.4052972
Validation loss decreased (1.408149 --> 1.392190).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 7 cost time: 1.7639422416687012
Epoch: 7, Steps: 52 | Train Loss: 0.4458499 Vali Loss: 1.3774718 Test Loss: 0.3926827
Validation loss decreased (1.392190 --> 1.377472).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 8 cost time: 1.7640957832336426
Epoch: 8, Steps: 52 | Train Loss: 0.4397852 Vali Loss: 1.3690490 Test Loss: 0.3834016
Validation loss decreased (1.377472 --> 1.369049).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 9 cost time: 1.7622601985931396
Epoch: 9, Steps: 52 | Train Loss: 0.4353705 Vali Loss: 1.3599253 Test Loss: 0.3775547
Validation loss decreased (1.369049 --> 1.359925).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 10 cost time: 1.7590453624725342
Epoch: 10, Steps: 52 | Train Loss: 0.4316355 Vali Loss: 1.3554904 Test Loss: 0.3718179
Validation loss decreased (1.359925 --> 1.355490).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 11 cost time: 1.7604963779449463
Epoch: 11, Steps: 52 | Train Loss: 0.4317334 Vali Loss: 1.3482587 Test Loss: 0.3681135
Validation loss decreased (1.355490 --> 1.348259).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 12 cost time: 1.7617921829223633
Epoch: 12, Steps: 52 | Train Loss: 0.4292053 Vali Loss: 1.3484380 Test Loss: 0.3651090
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 13 cost time: 1.754814863204956
Epoch: 13, Steps: 52 | Train Loss: 0.4276855 Vali Loss: 1.3276246 Test Loss: 0.3629601
Validation loss decreased (1.348259 --> 1.327625).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 14 cost time: 1.7679224014282227
Epoch: 14, Steps: 52 | Train Loss: 0.4260573 Vali Loss: 1.3422315 Test Loss: 0.3597006
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 15 cost time: 1.7504291534423828
Epoch: 15, Steps: 52 | Train Loss: 0.4249912 Vali Loss: 1.3409373 Test Loss: 0.3585248
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 16 cost time: 1.7601535320281982
Epoch: 16, Steps: 52 | Train Loss: 0.4247031 Vali Loss: 1.3303621 Test Loss: 0.3569738
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 17 cost time: 1.7654376029968262
Epoch: 17, Steps: 52 | Train Loss: 0.4231526 Vali Loss: 1.3261139 Test Loss: 0.3555298
Validation loss decreased (1.327625 --> 1.326114).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 18 cost time: 1.7631053924560547
Epoch: 18, Steps: 52 | Train Loss: 0.4227425 Vali Loss: 1.3274341 Test Loss: 0.3547492
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 19 cost time: 1.759263515472412
Epoch: 19, Steps: 52 | Train Loss: 0.4215368 Vali Loss: 1.3330953 Test Loss: 0.3540427
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 20 cost time: 1.7635736465454102
Epoch: 20, Steps: 52 | Train Loss: 0.4215558 Vali Loss: 1.3325917 Test Loss: 0.3525310
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 21 cost time: 1.758312702178955
Epoch: 21, Steps: 52 | Train Loss: 0.4203623 Vali Loss: 1.3252263 Test Loss: 0.3526327
Validation loss decreased (1.326114 --> 1.325226).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 22 cost time: 1.7575726509094238
Epoch: 22, Steps: 52 | Train Loss: 0.4194112 Vali Loss: 1.3259387 Test Loss: 0.3517485
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 23 cost time: 1.7589783668518066
Epoch: 23, Steps: 52 | Train Loss: 0.4207220 Vali Loss: 1.3293426 Test Loss: 0.3512419
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 24 cost time: 1.7465488910675049
Epoch: 24, Steps: 52 | Train Loss: 0.4163602 Vali Loss: 1.3217694 Test Loss: 0.3506933
Validation loss decreased (1.325226 --> 1.321769).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 25 cost time: 1.758542776107788
Epoch: 25, Steps: 52 | Train Loss: 0.4190832 Vali Loss: 1.3058376 Test Loss: 0.3504561
Validation loss decreased (1.321769 --> 1.305838).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 26 cost time: 1.762427806854248
Epoch: 26, Steps: 52 | Train Loss: 0.4184216 Vali Loss: 1.3224157 Test Loss: 0.3497175
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 27 cost time: 1.769134521484375
Epoch: 27, Steps: 52 | Train Loss: 0.4177484 Vali Loss: 1.3196605 Test Loss: 0.3489443
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 28 cost time: 1.7577931880950928
Epoch: 28, Steps: 52 | Train Loss: 0.4174588 Vali Loss: 1.3078755 Test Loss: 0.3492368
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 29 cost time: 1.7600202560424805
Epoch: 29, Steps: 52 | Train Loss: 0.4176617 Vali Loss: 1.3121612 Test Loss: 0.3486500
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 30 cost time: 1.7583708763122559
Epoch: 30, Steps: 52 | Train Loss: 0.4176456 Vali Loss: 1.3184361 Test Loss: 0.3488644
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 31 cost time: 1.7665956020355225
Epoch: 31, Steps: 52 | Train Loss: 0.4176994 Vali Loss: 1.3178582 Test Loss: 0.3481780
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 32 cost time: 1.7557525634765625
Epoch: 32, Steps: 52 | Train Loss: 0.4161893 Vali Loss: 1.3254547 Test Loss: 0.3490734
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 33 cost time: 1.760385274887085
Epoch: 33, Steps: 52 | Train Loss: 0.4176829 Vali Loss: 1.3136888 Test Loss: 0.3483018
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 34 cost time: 1.7596540451049805
Epoch: 34, Steps: 52 | Train Loss: 0.4190126 Vali Loss: 1.3237575 Test Loss: 0.3476874
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 35 cost time: 1.751011610031128
Epoch: 35, Steps: 52 | Train Loss: 0.4169940 Vali Loss: 1.3179352 Test Loss: 0.3478217
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 36 cost time: 1.758122205734253
Epoch: 36, Steps: 52 | Train Loss: 0.4172859 Vali Loss: 1.3214166 Test Loss: 0.3485021
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 37 cost time: 1.7579052448272705
Epoch: 37, Steps: 52 | Train Loss: 0.4187456 Vali Loss: 1.3213307 Test Loss: 0.3476116
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 38 cost time: 1.7504191398620605
Epoch: 38, Steps: 52 | Train Loss: 0.4170114 Vali Loss: 1.3215654 Test Loss: 0.3476397
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 39 cost time: 1.7556431293487549
Epoch: 39, Steps: 52 | Train Loss: 0.4160908 Vali Loss: 1.3165498 Test Loss: 0.3479615
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 40 cost time: 1.7498130798339844
Epoch: 40, Steps: 52 | Train Loss: 0.4166206 Vali Loss: 1.3143657 Test Loss: 0.3468348
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 41 cost time: 1.7461113929748535
Epoch: 41, Steps: 52 | Train Loss: 0.4176592 Vali Loss: 1.3159910 Test Loss: 0.3470591
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 42 cost time: 1.7601525783538818
Epoch: 42, Steps: 52 | Train Loss: 0.4163385 Vali Loss: 1.3194730 Test Loss: 0.3473594
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 43 cost time: 1.7566583156585693
Epoch: 43, Steps: 52 | Train Loss: 0.4161037 Vali Loss: 1.3213065 Test Loss: 0.3475878
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 44 cost time: 1.7821893692016602
Epoch: 44, Steps: 52 | Train Loss: 0.4139608 Vali Loss: 1.3217677 Test Loss: 0.3477875
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 45 cost time: 1.7581896781921387
Epoch: 45, Steps: 52 | Train Loss: 0.4156061 Vali Loss: 1.3245317 Test Loss: 0.3471076
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 46 cost time: 1.762444257736206
Epoch: 46, Steps: 52 | Train Loss: 0.4164074 Vali Loss: 1.3227820 Test Loss: 0.3475915
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 47 cost time: 1.7622747421264648
Epoch: 47, Steps: 52 | Train Loss: 0.4156431 Vali Loss: 1.3214566 Test Loss: 0.3477633
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 48 cost time: 1.7598676681518555
Epoch: 48, Steps: 52 | Train Loss: 0.4157878 Vali Loss: 1.3188480 Test Loss: 0.3470759
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 49 cost time: 1.7526819705963135
Epoch: 49, Steps: 52 | Train Loss: 0.4174655 Vali Loss: 1.3212692 Test Loss: 0.3470898
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 50 cost time: 1.7556490898132324
Epoch: 50, Steps: 52 | Train Loss: 0.4165970 Vali Loss: 1.3154230 Test Loss: 0.3465641
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 51 cost time: 1.7504334449768066
Epoch: 51, Steps: 52 | Train Loss: 0.4156762 Vali Loss: 1.3125083 Test Loss: 0.3474165
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 52 cost time: 1.7548129558563232
Epoch: 52, Steps: 52 | Train Loss: 0.4163108 Vali Loss: 1.3203120 Test Loss: 0.3469864
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 53 cost time: 1.7563929557800293
Epoch: 53, Steps: 52 | Train Loss: 0.4164966 Vali Loss: 1.3181632 Test Loss: 0.3469805
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 54 cost time: 1.7566659450531006
Epoch: 54, Steps: 52 | Train Loss: 0.4155788 Vali Loss: 1.3206451 Test Loss: 0.3471394
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 55 cost time: 1.7536022663116455
Epoch: 55, Steps: 52 | Train Loss: 0.4163698 Vali Loss: 1.3225818 Test Loss: 0.3468868
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 56 cost time: 1.7513742446899414
Epoch: 56, Steps: 52 | Train Loss: 0.4152028 Vali Loss: 1.3131906 Test Loss: 0.3470960
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 57 cost time: 1.7699024677276611
Epoch: 57, Steps: 52 | Train Loss: 0.4164674 Vali Loss: 1.3155899 Test Loss: 0.3465780
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 58 cost time: 1.754183292388916
Epoch: 58, Steps: 52 | Train Loss: 0.4144651 Vali Loss: 1.3202487 Test Loss: 0.3471636
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 59 cost time: 1.7591114044189453
Epoch: 59, Steps: 52 | Train Loss: 0.4146170 Vali Loss: 1.3198472 Test Loss: 0.3470864
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 60 cost time: 1.7582550048828125
Epoch: 60, Steps: 52 | Train Loss: 0.4183189 Vali Loss: 1.3144538 Test Loss: 0.3456576
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3504560887813568, mae:0.3959014117717743, rse:0.4849819839000702
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.04910469055175781 GB
Epoch: 1 cost time: 2.2132601737976074
Epoch: 1, Steps: 52 | Train Loss: 0.7361617 Vali Loss: 2.2271893 Test Loss: 1.4926423
Validation loss decreased (inf --> 2.227189).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 2 cost time: 0.8027887344360352
Epoch: 2, Steps: 52 | Train Loss: 0.6861075 Vali Loss: 1.9633169 Test Loss: 1.1816604
Validation loss decreased (2.227189 --> 1.963317).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 3 cost time: 0.7999992370605469
Epoch: 3, Steps: 52 | Train Loss: 0.6006457 Vali Loss: 1.7143233 Test Loss: 0.8583341
Validation loss decreased (1.963317 --> 1.714323).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 4 cost time: 0.813359260559082
Epoch: 4, Steps: 52 | Train Loss: 0.5201095 Vali Loss: 1.5250466 Test Loss: 0.5889436
Validation loss decreased (1.714323 --> 1.525047).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 5 cost time: 1.0904078483581543
Epoch: 5, Steps: 52 | Train Loss: 0.4709705 Vali Loss: 1.4324104 Test Loss: 0.4762895
Validation loss decreased (1.525047 --> 1.432410).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 6 cost time: 1.810431957244873
Epoch: 6, Steps: 52 | Train Loss: 0.4530279 Vali Loss: 1.4009384 Test Loss: 0.4297737
Validation loss decreased (1.432410 --> 1.400938).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 7 cost time: 1.8125159740447998
Epoch: 7, Steps: 52 | Train Loss: 0.4454856 Vali Loss: 1.3788096 Test Loss: 0.4073965
Validation loss decreased (1.400938 --> 1.378810).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 8 cost time: 1.807922601699829
Epoch: 8, Steps: 52 | Train Loss: 0.4378049 Vali Loss: 1.3707592 Test Loss: 0.3951874
Validation loss decreased (1.378810 --> 1.370759).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 9 cost time: 1.8094747066497803
Epoch: 9, Steps: 52 | Train Loss: 0.4344090 Vali Loss: 1.3675483 Test Loss: 0.3858097
Validation loss decreased (1.370759 --> 1.367548).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 10 cost time: 1.8084211349487305
Epoch: 10, Steps: 52 | Train Loss: 0.4292901 Vali Loss: 1.3643421 Test Loss: 0.3806949
Validation loss decreased (1.367548 --> 1.364342).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 11 cost time: 1.8115417957305908
Epoch: 11, Steps: 52 | Train Loss: 0.4269949 Vali Loss: 1.3558114 Test Loss: 0.3760970
Validation loss decreased (1.364342 --> 1.355811).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 12 cost time: 1.8064830303192139
Epoch: 12, Steps: 52 | Train Loss: 0.4266548 Vali Loss: 1.3547502 Test Loss: 0.3722090
Validation loss decreased (1.355811 --> 1.354750).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 13 cost time: 1.8139166831970215
Epoch: 13, Steps: 52 | Train Loss: 0.4258776 Vali Loss: 1.3435903 Test Loss: 0.3693497
Validation loss decreased (1.354750 --> 1.343590).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 14 cost time: 1.8148634433746338
Epoch: 14, Steps: 52 | Train Loss: 0.4256511 Vali Loss: 1.3416981 Test Loss: 0.3672696
Validation loss decreased (1.343590 --> 1.341698).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 15 cost time: 1.8108150959014893
Epoch: 15, Steps: 52 | Train Loss: 0.4224970 Vali Loss: 1.3415060 Test Loss: 0.3658854
Validation loss decreased (1.341698 --> 1.341506).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 16 cost time: 1.812439203262329
Epoch: 16, Steps: 52 | Train Loss: 0.4219875 Vali Loss: 1.3388844 Test Loss: 0.3643605
Validation loss decreased (1.341506 --> 1.338884).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 17 cost time: 1.8184850215911865
Epoch: 17, Steps: 52 | Train Loss: 0.4211766 Vali Loss: 1.3351562 Test Loss: 0.3631265
Validation loss decreased (1.338884 --> 1.335156).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 18 cost time: 1.815753698348999
Epoch: 18, Steps: 52 | Train Loss: 0.4200105 Vali Loss: 1.3387166 Test Loss: 0.3621502
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 19 cost time: 1.8158175945281982
Epoch: 19, Steps: 52 | Train Loss: 0.4178046 Vali Loss: 1.3404711 Test Loss: 0.3616347
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 20 cost time: 1.8162939548492432
Epoch: 20, Steps: 52 | Train Loss: 0.4194490 Vali Loss: 1.3320408 Test Loss: 0.3607111
Validation loss decreased (1.335156 --> 1.332041).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 21 cost time: 1.8054471015930176
Epoch: 21, Steps: 52 | Train Loss: 0.4176928 Vali Loss: 1.3286741 Test Loss: 0.3597905
Validation loss decreased (1.332041 --> 1.328674).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 22 cost time: 1.8094351291656494
Epoch: 22, Steps: 52 | Train Loss: 0.4188940 Vali Loss: 1.3278682 Test Loss: 0.3596793
Validation loss decreased (1.328674 --> 1.327868).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 23 cost time: 1.8099431991577148
Epoch: 23, Steps: 52 | Train Loss: 0.4169124 Vali Loss: 1.3271476 Test Loss: 0.3588832
Validation loss decreased (1.327868 --> 1.327148).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 24 cost time: 1.8100028038024902
Epoch: 24, Steps: 52 | Train Loss: 0.4159096 Vali Loss: 1.3357604 Test Loss: 0.3592348
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 25 cost time: 1.8065705299377441
Epoch: 25, Steps: 52 | Train Loss: 0.4171258 Vali Loss: 1.3302002 Test Loss: 0.3586965
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 26 cost time: 1.8117783069610596
Epoch: 26, Steps: 52 | Train Loss: 0.4182741 Vali Loss: 1.3298392 Test Loss: 0.3573544
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 27 cost time: 1.8081960678100586
Epoch: 27, Steps: 52 | Train Loss: 0.4169305 Vali Loss: 1.3346447 Test Loss: 0.3576440
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 28 cost time: 1.8119938373565674
Epoch: 28, Steps: 52 | Train Loss: 0.4169764 Vali Loss: 1.3267484 Test Loss: 0.3565521
Validation loss decreased (1.327148 --> 1.326748).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 29 cost time: 1.8124113082885742
Epoch: 29, Steps: 52 | Train Loss: 0.4177284 Vali Loss: 1.3272696 Test Loss: 0.3567313
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 30 cost time: 1.8110475540161133
Epoch: 30, Steps: 52 | Train Loss: 0.4159293 Vali Loss: 1.3209358 Test Loss: 0.3573718
Validation loss decreased (1.326748 --> 1.320936).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 31 cost time: 1.8024537563323975
Epoch: 31, Steps: 52 | Train Loss: 0.4156417 Vali Loss: 1.3258078 Test Loss: 0.3564022
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 32 cost time: 1.818084716796875
Epoch: 32, Steps: 52 | Train Loss: 0.4163344 Vali Loss: 1.3327510 Test Loss: 0.3563459
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 33 cost time: 1.8094840049743652
Epoch: 33, Steps: 52 | Train Loss: 0.4158005 Vali Loss: 1.3240827 Test Loss: 0.3558593
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 34 cost time: 1.8085074424743652
Epoch: 34, Steps: 52 | Train Loss: 0.4149880 Vali Loss: 1.3210037 Test Loss: 0.3563082
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 35 cost time: 1.8170688152313232
Epoch: 35, Steps: 52 | Train Loss: 0.4151871 Vali Loss: 1.3278301 Test Loss: 0.3562772
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 36 cost time: 1.8204448223114014
Epoch: 36, Steps: 52 | Train Loss: 0.4157655 Vali Loss: 1.3273787 Test Loss: 0.3554395
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 37 cost time: 1.8140246868133545
Epoch: 37, Steps: 52 | Train Loss: 0.4162805 Vali Loss: 1.3185923 Test Loss: 0.3557538
Validation loss decreased (1.320936 --> 1.318592).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 38 cost time: 1.8035540580749512
Epoch: 38, Steps: 52 | Train Loss: 0.4157870 Vali Loss: 1.3185875 Test Loss: 0.3549740
Validation loss decreased (1.318592 --> 1.318588).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 39 cost time: 1.8132033348083496
Epoch: 39, Steps: 52 | Train Loss: 0.4148441 Vali Loss: 1.3240813 Test Loss: 0.3553155
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 40 cost time: 1.809844732284546
Epoch: 40, Steps: 52 | Train Loss: 0.4141558 Vali Loss: 1.3285131 Test Loss: 0.3555764
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 41 cost time: 1.8101534843444824
Epoch: 41, Steps: 52 | Train Loss: 0.4137354 Vali Loss: 1.3164502 Test Loss: 0.3555400
Validation loss decreased (1.318588 --> 1.316450).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 42 cost time: 1.8093531131744385
Epoch: 42, Steps: 52 | Train Loss: 0.4134597 Vali Loss: 1.3247559 Test Loss: 0.3562308
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 43 cost time: 1.8104493618011475
Epoch: 43, Steps: 52 | Train Loss: 0.4164679 Vali Loss: 1.3265047 Test Loss: 0.3561713
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 44 cost time: 1.8101136684417725
Epoch: 44, Steps: 52 | Train Loss: 0.4137799 Vali Loss: 1.3247820 Test Loss: 0.3551450
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 45 cost time: 1.8110377788543701
Epoch: 45, Steps: 52 | Train Loss: 0.4155180 Vali Loss: 1.3255912 Test Loss: 0.3557128
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 46 cost time: 1.8245291709899902
Epoch: 46, Steps: 52 | Train Loss: 0.4149552 Vali Loss: 1.3164901 Test Loss: 0.3550767
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 47 cost time: 1.8178870677947998
Epoch: 47, Steps: 52 | Train Loss: 0.4151646 Vali Loss: 1.3183247 Test Loss: 0.3551050
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 48 cost time: 1.8137364387512207
Epoch: 48, Steps: 52 | Train Loss: 0.4148395 Vali Loss: 1.3314526 Test Loss: 0.3547907
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 49 cost time: 1.8125715255737305
Epoch: 49, Steps: 52 | Train Loss: 0.4141756 Vali Loss: 1.3258048 Test Loss: 0.3547727
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 50 cost time: 1.812145471572876
Epoch: 50, Steps: 52 | Train Loss: 0.4138714 Vali Loss: 1.3262365 Test Loss: 0.3544023
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 51 cost time: 1.8127691745758057
Epoch: 51, Steps: 52 | Train Loss: 0.4144589 Vali Loss: 1.3205993 Test Loss: 0.3555101
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 52 cost time: 1.806485891342163
Epoch: 52, Steps: 52 | Train Loss: 0.4139234 Vali Loss: 1.3303554 Test Loss: 0.3555863
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 53 cost time: 1.813678503036499
Epoch: 53, Steps: 52 | Train Loss: 0.4141301 Vali Loss: 1.3238124 Test Loss: 0.3548663
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 54 cost time: 1.81174635887146
Epoch: 54, Steps: 52 | Train Loss: 0.4145781 Vali Loss: 1.3238503 Test Loss: 0.3557301
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 55 cost time: 1.8125171661376953
Epoch: 55, Steps: 52 | Train Loss: 0.4147228 Vali Loss: 1.3261471 Test Loss: 0.3551523
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 56 cost time: 1.8092079162597656
Epoch: 56, Steps: 52 | Train Loss: 0.4145179 Vali Loss: 1.3176355 Test Loss: 0.3550671
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 57 cost time: 1.8104712963104248
Epoch: 57, Steps: 52 | Train Loss: 0.4137336 Vali Loss: 1.3291963 Test Loss: 0.3548343
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 58 cost time: 1.8104987144470215
Epoch: 58, Steps: 52 | Train Loss: 0.4135228 Vali Loss: 1.3250625 Test Loss: 0.3545111
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 59 cost time: 1.8110835552215576
Epoch: 59, Steps: 52 | Train Loss: 0.4146765 Vali Loss: 1.3258113 Test Loss: 0.3554457
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 60 cost time: 1.809192180633545
Epoch: 60, Steps: 52 | Train Loss: 0.4141626 Vali Loss: 1.3255100 Test Loss: 0.3547379
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35554003715515137, mae:0.4025692641735077, rse:0.4884870648384094
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.048000335693359375 GB
Epoch: 1 cost time: 2.1649937629699707
Epoch: 1, Steps: 52 | Train Loss: 0.8894617 Vali Loss: 2.3260667 Test Loss: 1.5037007
Validation loss decreased (inf --> 2.326067).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 2 cost time: 0.7556438446044922
Epoch: 2, Steps: 52 | Train Loss: 0.7452553 Vali Loss: 1.7530894 Test Loss: 0.8274201
Validation loss decreased (2.326067 --> 1.753089).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 3 cost time: 0.7629961967468262
Epoch: 3, Steps: 52 | Train Loss: 0.5893802 Vali Loss: 1.5573871 Test Loss: 0.5857335
Validation loss decreased (1.753089 --> 1.557387).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 4 cost time: 0.7683966159820557
Epoch: 4, Steps: 52 | Train Loss: 0.5264593 Vali Loss: 1.4889627 Test Loss: 0.5019961
Validation loss decreased (1.557387 --> 1.488963).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 5 cost time: 0.7580001354217529
Epoch: 5, Steps: 52 | Train Loss: 0.4992430 Vali Loss: 1.4587471 Test Loss: 0.4645375
Validation loss decreased (1.488963 --> 1.458747).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 6 cost time: 1.7210371494293213
Epoch: 6, Steps: 52 | Train Loss: 0.4859247 Vali Loss: 1.4352745 Test Loss: 0.4421344
Validation loss decreased (1.458747 --> 1.435274).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 7 cost time: 1.7274796962738037
Epoch: 7, Steps: 52 | Train Loss: 0.4748683 Vali Loss: 1.4131691 Test Loss: 0.4256584
Validation loss decreased (1.435274 --> 1.413169).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 8 cost time: 1.7220919132232666
Epoch: 8, Steps: 52 | Train Loss: 0.4690602 Vali Loss: 1.4070418 Test Loss: 0.4143824
Validation loss decreased (1.413169 --> 1.407042).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 9 cost time: 1.718090295791626
Epoch: 9, Steps: 52 | Train Loss: 0.4628514 Vali Loss: 1.3844068 Test Loss: 0.4051223
Validation loss decreased (1.407042 --> 1.384407).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 10 cost time: 1.7128863334655762
Epoch: 10, Steps: 52 | Train Loss: 0.4584857 Vali Loss: 1.3883071 Test Loss: 0.3978199
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 11 cost time: 1.7135100364685059
Epoch: 11, Steps: 52 | Train Loss: 0.4563575 Vali Loss: 1.3809017 Test Loss: 0.3916644
Validation loss decreased (1.384407 --> 1.380902).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 12 cost time: 1.716468095779419
Epoch: 12, Steps: 52 | Train Loss: 0.4513893 Vali Loss: 1.3710583 Test Loss: 0.3871303
Validation loss decreased (1.380902 --> 1.371058).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 13 cost time: 1.705092191696167
Epoch: 13, Steps: 52 | Train Loss: 0.4481276 Vali Loss: 1.3735816 Test Loss: 0.3835246
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 14 cost time: 1.7178614139556885
Epoch: 14, Steps: 52 | Train Loss: 0.4473415 Vali Loss: 1.3753695 Test Loss: 0.3798503
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 15 cost time: 1.7104496955871582
Epoch: 15, Steps: 52 | Train Loss: 0.4453522 Vali Loss: 1.3731050 Test Loss: 0.3772206
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 16 cost time: 1.7231738567352295
Epoch: 16, Steps: 52 | Train Loss: 0.4463766 Vali Loss: 1.3597238 Test Loss: 0.3744598
Validation loss decreased (1.371058 --> 1.359724).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 17 cost time: 1.7148878574371338
Epoch: 17, Steps: 52 | Train Loss: 0.4446743 Vali Loss: 1.3598230 Test Loss: 0.3730427
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 18 cost time: 1.7226226329803467
Epoch: 18, Steps: 52 | Train Loss: 0.4415924 Vali Loss: 1.3622420 Test Loss: 0.3708910
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 19 cost time: 1.7170634269714355
Epoch: 19, Steps: 52 | Train Loss: 0.4410857 Vali Loss: 1.3541830 Test Loss: 0.3705465
Validation loss decreased (1.359724 --> 1.354183).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 20 cost time: 1.733201026916504
Epoch: 20, Steps: 52 | Train Loss: 0.4377427 Vali Loss: 1.3526057 Test Loss: 0.3685040
Validation loss decreased (1.354183 --> 1.352606).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 21 cost time: 1.7260968685150146
Epoch: 21, Steps: 52 | Train Loss: 0.4392771 Vali Loss: 1.3515234 Test Loss: 0.3667906
Validation loss decreased (1.352606 --> 1.351523).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 22 cost time: 1.7175028324127197
Epoch: 22, Steps: 52 | Train Loss: 0.4378826 Vali Loss: 1.3597418 Test Loss: 0.3663954
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 23 cost time: 1.716456413269043
Epoch: 23, Steps: 52 | Train Loss: 0.4380030 Vali Loss: 1.3486689 Test Loss: 0.3648393
Validation loss decreased (1.351523 --> 1.348669).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 24 cost time: 1.7212727069854736
Epoch: 24, Steps: 52 | Train Loss: 0.4374974 Vali Loss: 1.3426173 Test Loss: 0.3649701
Validation loss decreased (1.348669 --> 1.342617).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 25 cost time: 1.7216989994049072
Epoch: 25, Steps: 52 | Train Loss: 0.4359803 Vali Loss: 1.3509558 Test Loss: 0.3636867
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 26 cost time: 1.7099924087524414
Epoch: 26, Steps: 52 | Train Loss: 0.4375702 Vali Loss: 1.3507881 Test Loss: 0.3637065
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 27 cost time: 1.71795654296875
Epoch: 27, Steps: 52 | Train Loss: 0.4358042 Vali Loss: 1.3498337 Test Loss: 0.3628907
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 28 cost time: 1.7114098072052002
Epoch: 28, Steps: 52 | Train Loss: 0.4355420 Vali Loss: 1.3434873 Test Loss: 0.3624548
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 29 cost time: 1.7162344455718994
Epoch: 29, Steps: 52 | Train Loss: 0.4350595 Vali Loss: 1.3381798 Test Loss: 0.3621237
Validation loss decreased (1.342617 --> 1.338180).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 30 cost time: 1.7204017639160156
Epoch: 30, Steps: 52 | Train Loss: 0.4343700 Vali Loss: 1.3436430 Test Loss: 0.3620299
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 31 cost time: 1.7248330116271973
Epoch: 31, Steps: 52 | Train Loss: 0.4359012 Vali Loss: 1.3510908 Test Loss: 0.3610985
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 32 cost time: 1.7186565399169922
Epoch: 32, Steps: 52 | Train Loss: 0.4348032 Vali Loss: 1.3418937 Test Loss: 0.3609610
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 33 cost time: 1.7244036197662354
Epoch: 33, Steps: 52 | Train Loss: 0.4344869 Vali Loss: 1.3491532 Test Loss: 0.3612076
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 34 cost time: 1.715749740600586
Epoch: 34, Steps: 52 | Train Loss: 0.4344081 Vali Loss: 1.3460395 Test Loss: 0.3610069
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 35 cost time: 1.7144594192504883
Epoch: 35, Steps: 52 | Train Loss: 0.4360191 Vali Loss: 1.3436804 Test Loss: 0.3604480
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 36 cost time: 1.735976219177246
Epoch: 36, Steps: 52 | Train Loss: 0.4337686 Vali Loss: 1.3428975 Test Loss: 0.3594581
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 37 cost time: 1.709031105041504
Epoch: 37, Steps: 52 | Train Loss: 0.4314841 Vali Loss: 1.3486065 Test Loss: 0.3592096
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 38 cost time: 1.7192161083221436
Epoch: 38, Steps: 52 | Train Loss: 0.4327038 Vali Loss: 1.3375053 Test Loss: 0.3598503
Validation loss decreased (1.338180 --> 1.337505).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 39 cost time: 1.7174346446990967
Epoch: 39, Steps: 52 | Train Loss: 0.4340480 Vali Loss: 1.3432093 Test Loss: 0.3594082
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 40 cost time: 1.7147941589355469
Epoch: 40, Steps: 52 | Train Loss: 0.4323346 Vali Loss: 1.3439394 Test Loss: 0.3592536
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 41 cost time: 1.71877121925354
Epoch: 41, Steps: 52 | Train Loss: 0.4336196 Vali Loss: 1.3436898 Test Loss: 0.3592398
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 42 cost time: 1.7134191989898682
Epoch: 42, Steps: 52 | Train Loss: 0.4337455 Vali Loss: 1.3508209 Test Loss: 0.3601736
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 43 cost time: 1.7179646492004395
Epoch: 43, Steps: 52 | Train Loss: 0.4325466 Vali Loss: 1.3466856 Test Loss: 0.3593707
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 44 cost time: 1.7104473114013672
Epoch: 44, Steps: 52 | Train Loss: 0.4313121 Vali Loss: 1.3485587 Test Loss: 0.3592805
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 45 cost time: 1.7154598236083984
Epoch: 45, Steps: 52 | Train Loss: 0.4334546 Vali Loss: 1.3389857 Test Loss: 0.3592993
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 46 cost time: 1.7163007259368896
Epoch: 46, Steps: 52 | Train Loss: 0.4338368 Vali Loss: 1.3454118 Test Loss: 0.3592583
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 47 cost time: 1.718510389328003
Epoch: 47, Steps: 52 | Train Loss: 0.4335120 Vali Loss: 1.3471836 Test Loss: 0.3587175
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 48 cost time: 1.7185494899749756
Epoch: 48, Steps: 52 | Train Loss: 0.4322255 Vali Loss: 1.3470061 Test Loss: 0.3585567
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 49 cost time: 1.7175588607788086
Epoch: 49, Steps: 52 | Train Loss: 0.4312785 Vali Loss: 1.3315310 Test Loss: 0.3582444
Validation loss decreased (1.337505 --> 1.331531).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 50 cost time: 1.7214980125427246
Epoch: 50, Steps: 52 | Train Loss: 0.4334839 Vali Loss: 1.3386135 Test Loss: 0.3589586
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 51 cost time: 1.721632719039917
Epoch: 51, Steps: 52 | Train Loss: 0.4335387 Vali Loss: 1.3464108 Test Loss: 0.3585629
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 52 cost time: 1.7186169624328613
Epoch: 52, Steps: 52 | Train Loss: 0.4317612 Vali Loss: 1.3382518 Test Loss: 0.3587222
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 53 cost time: 1.7152080535888672
Epoch: 53, Steps: 52 | Train Loss: 0.4326355 Vali Loss: 1.3385782 Test Loss: 0.3584536
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 54 cost time: 1.7263972759246826
Epoch: 54, Steps: 52 | Train Loss: 0.4327533 Vali Loss: 1.3436208 Test Loss: 0.3580356
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 55 cost time: 1.7156825065612793
Epoch: 55, Steps: 52 | Train Loss: 0.4340115 Vali Loss: 1.3444023 Test Loss: 0.3582236
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 56 cost time: 1.7164828777313232
Epoch: 56, Steps: 52 | Train Loss: 0.4319446 Vali Loss: 1.3346709 Test Loss: 0.3583336
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 57 cost time: 1.7273714542388916
Epoch: 57, Steps: 52 | Train Loss: 0.4326565 Vali Loss: 1.3450058 Test Loss: 0.3579290
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 58 cost time: 1.721329689025879
Epoch: 58, Steps: 52 | Train Loss: 0.4323254 Vali Loss: 1.3422835 Test Loss: 0.3581875
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 59 cost time: 1.722505807876587
Epoch: 59, Steps: 52 | Train Loss: 0.4328392 Vali Loss: 1.3469220 Test Loss: 0.3580427
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 60 cost time: 1.7185704708099365
Epoch: 60, Steps: 52 | Train Loss: 0.4322547 Vali Loss: 1.3480166 Test Loss: 0.3586141
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3582444489002228, mae:0.39808371663093567, rse:0.4903413653373718
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.04870176315307617 GB
Epoch: 1 cost time: 2.1804518699645996
Epoch: 1, Steps: 52 | Train Loss: 0.7324992 Vali Loss: 2.1651187 Test Loss: 1.3780003
Validation loss decreased (inf --> 2.165119).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 2 cost time: 0.7931103706359863
Epoch: 2, Steps: 52 | Train Loss: 0.6584468 Vali Loss: 1.7857927 Test Loss: 0.9136862
Validation loss decreased (2.165119 --> 1.785793).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 3 cost time: 0.7869975566864014
Epoch: 3, Steps: 52 | Train Loss: 0.5449331 Vali Loss: 1.5511622 Test Loss: 0.6018652
Validation loss decreased (1.785793 --> 1.551162).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 4 cost time: 0.812446117401123
Epoch: 4, Steps: 52 | Train Loss: 0.4863025 Vali Loss: 1.4598055 Test Loss: 0.4895486
Validation loss decreased (1.551162 --> 1.459805).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 5 cost time: 0.9655044078826904
Epoch: 5, Steps: 52 | Train Loss: 0.4627651 Vali Loss: 1.4281068 Test Loss: 0.4493317
Validation loss decreased (1.459805 --> 1.428107).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 6 cost time: 1.7752740383148193
Epoch: 6, Steps: 52 | Train Loss: 0.4537968 Vali Loss: 1.4086001 Test Loss: 0.4264120
Validation loss decreased (1.428107 --> 1.408600).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 7 cost time: 1.791086196899414
Epoch: 7, Steps: 52 | Train Loss: 0.4480665 Vali Loss: 1.4018420 Test Loss: 0.4131678
Validation loss decreased (1.408600 --> 1.401842).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 8 cost time: 1.7661008834838867
Epoch: 8, Steps: 52 | Train Loss: 0.4404512 Vali Loss: 1.3829527 Test Loss: 0.4033253
Validation loss decreased (1.401842 --> 1.382953).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 9 cost time: 1.773517370223999
Epoch: 9, Steps: 52 | Train Loss: 0.4393874 Vali Loss: 1.3724170 Test Loss: 0.3935406
Validation loss decreased (1.382953 --> 1.372417).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 10 cost time: 1.7746062278747559
Epoch: 10, Steps: 52 | Train Loss: 0.4351336 Vali Loss: 1.3714161 Test Loss: 0.3885162
Validation loss decreased (1.372417 --> 1.371416).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 11 cost time: 1.775104284286499
Epoch: 11, Steps: 52 | Train Loss: 0.4329592 Vali Loss: 1.3671041 Test Loss: 0.3837115
Validation loss decreased (1.371416 --> 1.367104).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 12 cost time: 1.7743639945983887
Epoch: 12, Steps: 52 | Train Loss: 0.4299308 Vali Loss: 1.3571267 Test Loss: 0.3791780
Validation loss decreased (1.367104 --> 1.357127).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 13 cost time: 1.7803943157196045
Epoch: 13, Steps: 52 | Train Loss: 0.4292469 Vali Loss: 1.3560872 Test Loss: 0.3745134
Validation loss decreased (1.357127 --> 1.356087).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 14 cost time: 1.7706890106201172
Epoch: 14, Steps: 52 | Train Loss: 0.4265628 Vali Loss: 1.3416855 Test Loss: 0.3720685
Validation loss decreased (1.356087 --> 1.341686).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 15 cost time: 1.7733912467956543
Epoch: 15, Steps: 52 | Train Loss: 0.4261607 Vali Loss: 1.3460891 Test Loss: 0.3691853
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 16 cost time: 1.7744743824005127
Epoch: 16, Steps: 52 | Train Loss: 0.4235016 Vali Loss: 1.3512093 Test Loss: 0.3674641
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 17 cost time: 1.782144546508789
Epoch: 17, Steps: 52 | Train Loss: 0.4229029 Vali Loss: 1.3389156 Test Loss: 0.3661398
Validation loss decreased (1.341686 --> 1.338916).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 18 cost time: 1.7748377323150635
Epoch: 18, Steps: 52 | Train Loss: 0.4225910 Vali Loss: 1.3468418 Test Loss: 0.3635300
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 19 cost time: 1.7805852890014648
Epoch: 19, Steps: 52 | Train Loss: 0.4233903 Vali Loss: 1.3474761 Test Loss: 0.3636543
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 20 cost time: 1.7801518440246582
Epoch: 20, Steps: 52 | Train Loss: 0.4201634 Vali Loss: 1.3253312 Test Loss: 0.3624397
Validation loss decreased (1.338916 --> 1.325331).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 21 cost time: 1.7724735736846924
Epoch: 21, Steps: 52 | Train Loss: 0.4211063 Vali Loss: 1.3396041 Test Loss: 0.3612924
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 22 cost time: 1.7871296405792236
Epoch: 22, Steps: 52 | Train Loss: 0.4202638 Vali Loss: 1.3409879 Test Loss: 0.3605882
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 23 cost time: 1.7842609882354736
Epoch: 23, Steps: 52 | Train Loss: 0.4209523 Vali Loss: 1.3398898 Test Loss: 0.3594689
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 24 cost time: 1.788785457611084
Epoch: 24, Steps: 52 | Train Loss: 0.4190937 Vali Loss: 1.3353021 Test Loss: 0.3587931
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 25 cost time: 1.7696950435638428
Epoch: 25, Steps: 52 | Train Loss: 0.4202164 Vali Loss: 1.3405445 Test Loss: 0.3580832
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 26 cost time: 1.779104471206665
Epoch: 26, Steps: 52 | Train Loss: 0.4193072 Vali Loss: 1.3336258 Test Loss: 0.3578819
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 27 cost time: 1.7924387454986572
Epoch: 27, Steps: 52 | Train Loss: 0.4174650 Vali Loss: 1.3316212 Test Loss: 0.3573830
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 28 cost time: 1.775113821029663
Epoch: 28, Steps: 52 | Train Loss: 0.4188954 Vali Loss: 1.3379068 Test Loss: 0.3571815
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 29 cost time: 1.7744441032409668
Epoch: 29, Steps: 52 | Train Loss: 0.4169564 Vali Loss: 1.3292093 Test Loss: 0.3563540
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 30 cost time: 1.7932415008544922
Epoch: 30, Steps: 52 | Train Loss: 0.4177247 Vali Loss: 1.3324957 Test Loss: 0.3562042
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 31 cost time: 1.7888917922973633
Epoch: 31, Steps: 52 | Train Loss: 0.4174746 Vali Loss: 1.3192651 Test Loss: 0.3554381
Validation loss decreased (1.325331 --> 1.319265).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 32 cost time: 1.7871174812316895
Epoch: 32, Steps: 52 | Train Loss: 0.4184959 Vali Loss: 1.3360267 Test Loss: 0.3558744
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 33 cost time: 1.7874739170074463
Epoch: 33, Steps: 52 | Train Loss: 0.4185812 Vali Loss: 1.3284879 Test Loss: 0.3555540
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 34 cost time: 1.7841777801513672
Epoch: 34, Steps: 52 | Train Loss: 0.4184503 Vali Loss: 1.3330832 Test Loss: 0.3552571
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 35 cost time: 1.7778041362762451
Epoch: 35, Steps: 52 | Train Loss: 0.4173487 Vali Loss: 1.3280746 Test Loss: 0.3549603
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 36 cost time: 1.7861886024475098
Epoch: 36, Steps: 52 | Train Loss: 0.4183620 Vali Loss: 1.3230119 Test Loss: 0.3547317
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 37 cost time: 1.7874743938446045
Epoch: 37, Steps: 52 | Train Loss: 0.4170378 Vali Loss: 1.3325515 Test Loss: 0.3550122
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 38 cost time: 1.773425579071045
Epoch: 38, Steps: 52 | Train Loss: 0.4168978 Vali Loss: 1.3266425 Test Loss: 0.3547876
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 39 cost time: 1.783679485321045
Epoch: 39, Steps: 52 | Train Loss: 0.4188733 Vali Loss: 1.3338600 Test Loss: 0.3546478
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 40 cost time: 1.7805180549621582
Epoch: 40, Steps: 52 | Train Loss: 0.4154181 Vali Loss: 1.3280456 Test Loss: 0.3542916
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 41 cost time: 1.7734143733978271
Epoch: 41, Steps: 52 | Train Loss: 0.4172045 Vali Loss: 1.3330722 Test Loss: 0.3542953
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 42 cost time: 1.7820408344268799
Epoch: 42, Steps: 52 | Train Loss: 0.4176121 Vali Loss: 1.3275995 Test Loss: 0.3545015
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 43 cost time: 1.781388759613037
Epoch: 43, Steps: 52 | Train Loss: 0.4166372 Vali Loss: 1.3256509 Test Loss: 0.3540908
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 44 cost time: 1.7831828594207764
Epoch: 44, Steps: 52 | Train Loss: 0.4158769 Vali Loss: 1.3344486 Test Loss: 0.3540750
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 45 cost time: 1.7904343605041504
Epoch: 45, Steps: 52 | Train Loss: 0.4155766 Vali Loss: 1.3247421 Test Loss: 0.3544542
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 46 cost time: 1.8064212799072266
Epoch: 46, Steps: 52 | Train Loss: 0.4170626 Vali Loss: 1.3306681 Test Loss: 0.3538330
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 47 cost time: 1.7714478969573975
Epoch: 47, Steps: 52 | Train Loss: 0.4174992 Vali Loss: 1.3327818 Test Loss: 0.3540950
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 48 cost time: 1.7709028720855713
Epoch: 48, Steps: 52 | Train Loss: 0.4178474 Vali Loss: 1.3291147 Test Loss: 0.3533637
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 49 cost time: 1.7835218906402588
Epoch: 49, Steps: 52 | Train Loss: 0.4167862 Vali Loss: 1.3186719 Test Loss: 0.3537493
Validation loss decreased (1.319265 --> 1.318672).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 50 cost time: 1.7818591594696045
Epoch: 50, Steps: 52 | Train Loss: 0.4176467 Vali Loss: 1.3260825 Test Loss: 0.3534693
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 51 cost time: 1.7813105583190918
Epoch: 51, Steps: 52 | Train Loss: 0.4158433 Vali Loss: 1.3337119 Test Loss: 0.3541240
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 52 cost time: 1.7815303802490234
Epoch: 52, Steps: 52 | Train Loss: 0.4160876 Vali Loss: 1.3278363 Test Loss: 0.3538584
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 53 cost time: 1.782209873199463
Epoch: 53, Steps: 52 | Train Loss: 0.4183260 Vali Loss: 1.3322377 Test Loss: 0.3534391
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 54 cost time: 1.7833456993103027
Epoch: 54, Steps: 52 | Train Loss: 0.4165359 Vali Loss: 1.3325404 Test Loss: 0.3538754
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 55 cost time: 1.7774064540863037
Epoch: 55, Steps: 52 | Train Loss: 0.4178854 Vali Loss: 1.3278185 Test Loss: 0.3530704
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 56 cost time: 1.7808377742767334
Epoch: 56, Steps: 52 | Train Loss: 0.4183291 Vali Loss: 1.3269266 Test Loss: 0.3536504
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 57 cost time: 1.7780382633209229
Epoch: 57, Steps: 52 | Train Loss: 0.4163496 Vali Loss: 1.3268615 Test Loss: 0.3536264
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 58 cost time: 1.7800467014312744
Epoch: 58, Steps: 52 | Train Loss: 0.4169187 Vali Loss: 1.3315427 Test Loss: 0.3537528
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 59 cost time: 1.7792108058929443
Epoch: 59, Steps: 52 | Train Loss: 0.4164903 Vali Loss: 1.3342736 Test Loss: 0.3536486
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 60 cost time: 1.7826955318450928
Epoch: 60, Steps: 52 | Train Loss: 0.4172310 Vali Loss: 1.3308210 Test Loss: 0.3533378
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35374918580055237, mae:0.3957465589046478, rse:0.4872552752494812
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.04926586151123047 GB
Epoch: 1 cost time: 2.198014974594116
Epoch: 1, Steps: 52 | Train Loss: 0.7094523 Vali Loss: 2.1294205 Test Loss: 1.3490996
Validation loss decreased (inf --> 2.129421).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 2 cost time: 0.8132736682891846
Epoch: 2, Steps: 52 | Train Loss: 0.6411457 Vali Loss: 1.7800281 Test Loss: 0.9277282
Validation loss decreased (2.129421 --> 1.780028).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 3 cost time: 0.8110430240631104
Epoch: 3, Steps: 52 | Train Loss: 0.5434598 Vali Loss: 1.5604584 Test Loss: 0.6282162
Validation loss decreased (1.780028 --> 1.560458).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 4 cost time: 0.8137612342834473
Epoch: 4, Steps: 52 | Train Loss: 0.4862373 Vali Loss: 1.4721704 Test Loss: 0.4961098
Validation loss decreased (1.560458 --> 1.472170).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 5 cost time: 1.1764774322509766
Epoch: 5, Steps: 52 | Train Loss: 0.4601054 Vali Loss: 1.4355769 Test Loss: 0.4454623
Validation loss decreased (1.472170 --> 1.435577).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 6 cost time: 1.828139305114746
Epoch: 6, Steps: 52 | Train Loss: 0.4512047 Vali Loss: 1.4061611 Test Loss: 0.4239624
Validation loss decreased (1.435577 --> 1.406161).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 7 cost time: 1.8322007656097412
Epoch: 7, Steps: 52 | Train Loss: 0.4414994 Vali Loss: 1.3986429 Test Loss: 0.4110709
Validation loss decreased (1.406161 --> 1.398643).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 8 cost time: 1.8270421028137207
Epoch: 8, Steps: 52 | Train Loss: 0.4381085 Vali Loss: 1.3796861 Test Loss: 0.3994905
Validation loss decreased (1.398643 --> 1.379686).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 9 cost time: 1.8294148445129395
Epoch: 9, Steps: 52 | Train Loss: 0.4341370 Vali Loss: 1.3755248 Test Loss: 0.3939838
Validation loss decreased (1.379686 --> 1.375525).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 10 cost time: 1.8337492942810059
Epoch: 10, Steps: 52 | Train Loss: 0.4332227 Vali Loss: 1.3658179 Test Loss: 0.3871156
Validation loss decreased (1.375525 --> 1.365818).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 11 cost time: 1.8308448791503906
Epoch: 11, Steps: 52 | Train Loss: 0.4307541 Vali Loss: 1.3660691 Test Loss: 0.3843711
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 12 cost time: 1.8307690620422363
Epoch: 12, Steps: 52 | Train Loss: 0.4277341 Vali Loss: 1.3584106 Test Loss: 0.3786272
Validation loss decreased (1.365818 --> 1.358411).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 13 cost time: 1.837404727935791
Epoch: 13, Steps: 52 | Train Loss: 0.4257277 Vali Loss: 1.3601389 Test Loss: 0.3764639
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 14 cost time: 1.8300502300262451
Epoch: 14, Steps: 52 | Train Loss: 0.4262086 Vali Loss: 1.3460455 Test Loss: 0.3734010
Validation loss decreased (1.358411 --> 1.346045).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 15 cost time: 1.8303651809692383
Epoch: 15, Steps: 52 | Train Loss: 0.4237759 Vali Loss: 1.3445036 Test Loss: 0.3704603
Validation loss decreased (1.346045 --> 1.344504).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 16 cost time: 1.8333468437194824
Epoch: 16, Steps: 52 | Train Loss: 0.4236630 Vali Loss: 1.3519387 Test Loss: 0.3692378
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 17 cost time: 1.8280184268951416
Epoch: 17, Steps: 52 | Train Loss: 0.4221249 Vali Loss: 1.3438559 Test Loss: 0.3671971
Validation loss decreased (1.344504 --> 1.343856).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 18 cost time: 1.8262262344360352
Epoch: 18, Steps: 52 | Train Loss: 0.4212606 Vali Loss: 1.3374023 Test Loss: 0.3652050
Validation loss decreased (1.343856 --> 1.337402).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 19 cost time: 1.8300871849060059
Epoch: 19, Steps: 52 | Train Loss: 0.4208067 Vali Loss: 1.3343140 Test Loss: 0.3647171
Validation loss decreased (1.337402 --> 1.334314).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 20 cost time: 1.8285541534423828
Epoch: 20, Steps: 52 | Train Loss: 0.4204420 Vali Loss: 1.3406138 Test Loss: 0.3634480
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 21 cost time: 1.8287746906280518
Epoch: 21, Steps: 52 | Train Loss: 0.4207031 Vali Loss: 1.3378313 Test Loss: 0.3631448
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 22 cost time: 1.8343966007232666
Epoch: 22, Steps: 52 | Train Loss: 0.4204414 Vali Loss: 1.3323200 Test Loss: 0.3626481
Validation loss decreased (1.334314 --> 1.332320).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 23 cost time: 1.8197295665740967
Epoch: 23, Steps: 52 | Train Loss: 0.4180180 Vali Loss: 1.3403800 Test Loss: 0.3613934
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 24 cost time: 1.8298850059509277
Epoch: 24, Steps: 52 | Train Loss: 0.4190219 Vali Loss: 1.3252550 Test Loss: 0.3616220
Validation loss decreased (1.332320 --> 1.325255).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 25 cost time: 1.8272442817687988
Epoch: 25, Steps: 52 | Train Loss: 0.4174217 Vali Loss: 1.3293718 Test Loss: 0.3604299
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 26 cost time: 1.8370082378387451
Epoch: 26, Steps: 52 | Train Loss: 0.4171360 Vali Loss: 1.3357930 Test Loss: 0.3602071
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 27 cost time: 1.8181350231170654
Epoch: 27, Steps: 52 | Train Loss: 0.4164853 Vali Loss: 1.3290528 Test Loss: 0.3597172
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 28 cost time: 1.8303771018981934
Epoch: 28, Steps: 52 | Train Loss: 0.4158297 Vali Loss: 1.3344126 Test Loss: 0.3596947
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 29 cost time: 1.8255083560943604
Epoch: 29, Steps: 52 | Train Loss: 0.4170032 Vali Loss: 1.3361797 Test Loss: 0.3592553
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 30 cost time: 1.8265576362609863
Epoch: 30, Steps: 52 | Train Loss: 0.4156117 Vali Loss: 1.3261745 Test Loss: 0.3590415
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 31 cost time: 1.8324344158172607
Epoch: 31, Steps: 52 | Train Loss: 0.4174947 Vali Loss: 1.3310068 Test Loss: 0.3581314
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 32 cost time: 1.828833818435669
Epoch: 32, Steps: 52 | Train Loss: 0.4155782 Vali Loss: 1.3320143 Test Loss: 0.3578199
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 33 cost time: 1.8370811939239502
Epoch: 33, Steps: 52 | Train Loss: 0.4159479 Vali Loss: 1.3272562 Test Loss: 0.3576712
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 34 cost time: 1.8324837684631348
Epoch: 34, Steps: 52 | Train Loss: 0.4164695 Vali Loss: 1.3225787 Test Loss: 0.3581615
Validation loss decreased (1.325255 --> 1.322579).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 35 cost time: 1.8295059204101562
Epoch: 35, Steps: 52 | Train Loss: 0.4155482 Vali Loss: 1.3292487 Test Loss: 0.3585841
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 36 cost time: 1.8288404941558838
Epoch: 36, Steps: 52 | Train Loss: 0.4151927 Vali Loss: 1.3248103 Test Loss: 0.3575204
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 37 cost time: 1.8261537551879883
Epoch: 37, Steps: 52 | Train Loss: 0.4168194 Vali Loss: 1.3270223 Test Loss: 0.3577974
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 38 cost time: 1.8276453018188477
Epoch: 38, Steps: 52 | Train Loss: 0.4172042 Vali Loss: 1.3213754 Test Loss: 0.3572680
Validation loss decreased (1.322579 --> 1.321375).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 39 cost time: 1.8302125930786133
Epoch: 39, Steps: 52 | Train Loss: 0.4164079 Vali Loss: 1.3286097 Test Loss: 0.3569475
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 40 cost time: 1.8265726566314697
Epoch: 40, Steps: 52 | Train Loss: 0.4152999 Vali Loss: 1.3309370 Test Loss: 0.3576843
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 41 cost time: 1.8261628150939941
Epoch: 41, Steps: 52 | Train Loss: 0.4174615 Vali Loss: 1.3334658 Test Loss: 0.3571614
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 42 cost time: 1.8260467052459717
Epoch: 42, Steps: 52 | Train Loss: 0.4150188 Vali Loss: 1.3331158 Test Loss: 0.3574033
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 43 cost time: 1.8222436904907227
Epoch: 43, Steps: 52 | Train Loss: 0.4157951 Vali Loss: 1.3223927 Test Loss: 0.3565444
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 44 cost time: 1.8264110088348389
Epoch: 44, Steps: 52 | Train Loss: 0.4137596 Vali Loss: 1.3333409 Test Loss: 0.3567258
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 45 cost time: 1.8440537452697754
Epoch: 45, Steps: 52 | Train Loss: 0.4163219 Vali Loss: 1.3279378 Test Loss: 0.3570704
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 46 cost time: 1.8134520053863525
Epoch: 46, Steps: 52 | Train Loss: 0.4138545 Vali Loss: 1.3209993 Test Loss: 0.3569743
Validation loss decreased (1.321375 --> 1.320999).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 47 cost time: 1.8274409770965576
Epoch: 47, Steps: 52 | Train Loss: 0.4133389 Vali Loss: 1.3338315 Test Loss: 0.3567616
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 48 cost time: 1.8255500793457031
Epoch: 48, Steps: 52 | Train Loss: 0.4172535 Vali Loss: 1.3178890 Test Loss: 0.3565577
Validation loss decreased (1.320999 --> 1.317889).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 49 cost time: 1.8349528312683105
Epoch: 49, Steps: 52 | Train Loss: 0.4146672 Vali Loss: 1.3267741 Test Loss: 0.3564063
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 50 cost time: 1.8153984546661377
Epoch: 50, Steps: 52 | Train Loss: 0.4178179 Vali Loss: 1.3320870 Test Loss: 0.3565893
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 51 cost time: 1.828061819076538
Epoch: 51, Steps: 52 | Train Loss: 0.4151442 Vali Loss: 1.3333656 Test Loss: 0.3567614
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 52 cost time: 1.8233046531677246
Epoch: 52, Steps: 52 | Train Loss: 0.4159942 Vali Loss: 1.3277357 Test Loss: 0.3565638
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 53 cost time: 1.827909231185913
Epoch: 53, Steps: 52 | Train Loss: 0.4155510 Vali Loss: 1.3309393 Test Loss: 0.3570656
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 54 cost time: 1.8331701755523682
Epoch: 54, Steps: 52 | Train Loss: 0.4159574 Vali Loss: 1.3259758 Test Loss: 0.3566972
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 55 cost time: 1.8138244152069092
Epoch: 55, Steps: 52 | Train Loss: 0.4152499 Vali Loss: 1.3279674 Test Loss: 0.3561338
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 56 cost time: 1.8335456848144531
Epoch: 56, Steps: 52 | Train Loss: 0.4160829 Vali Loss: 1.3243972 Test Loss: 0.3560302
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 57 cost time: 1.830132246017456
Epoch: 57, Steps: 52 | Train Loss: 0.4161955 Vali Loss: 1.3261728 Test Loss: 0.3566473
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 58 cost time: 1.8317489624023438
Epoch: 58, Steps: 52 | Train Loss: 0.4157607 Vali Loss: 1.3299329 Test Loss: 0.3571473
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 59 cost time: 1.826735496520996
Epoch: 59, Steps: 52 | Train Loss: 0.4162025 Vali Loss: 1.3326812 Test Loss: 0.3563983
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 60 cost time: 1.8313660621643066
Epoch: 60, Steps: 52 | Train Loss: 0.4140858 Vali Loss: 1.3196838 Test Loss: 0.3562425
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.356557697057724, mae:0.4036620557308197, rse:0.4891856610774994
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045186519622802734 GB
Epoch: 1 cost time: 2.1204001903533936
Epoch: 1, Steps: 52 | Train Loss: 0.9194797 Vali Loss: 2.4978292 Test Loss: 1.6788162
Validation loss decreased (inf --> 2.497829).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 2 cost time: 0.7423803806304932
Epoch: 2, Steps: 52 | Train Loss: 0.8082239 Vali Loss: 1.9673303 Test Loss: 1.1015685
Validation loss decreased (2.497829 --> 1.967330).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 3 cost time: 0.7357463836669922
Epoch: 3, Steps: 52 | Train Loss: 0.6701672 Vali Loss: 1.7113943 Test Loss: 0.7901323
Validation loss decreased (1.967330 --> 1.711394).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 4 cost time: 0.7360000610351562
Epoch: 4, Steps: 52 | Train Loss: 0.5926040 Vali Loss: 1.5716357 Test Loss: 0.5964314
Validation loss decreased (1.711394 --> 1.571636).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 5 cost time: 0.7433698177337646
Epoch: 5, Steps: 52 | Train Loss: 0.5471530 Vali Loss: 1.4941957 Test Loss: 0.4984454
Validation loss decreased (1.571636 --> 1.494196).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 6 cost time: 1.5971672534942627
Epoch: 6, Steps: 52 | Train Loss: 0.5205282 Vali Loss: 1.4524727 Test Loss: 0.4483909
Validation loss decreased (1.494196 --> 1.452473).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 7 cost time: 1.6505985260009766
Epoch: 7, Steps: 52 | Train Loss: 0.5046611 Vali Loss: 1.4326868 Test Loss: 0.4212663
Validation loss decreased (1.452473 --> 1.432687).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 8 cost time: 1.6553733348846436
Epoch: 8, Steps: 52 | Train Loss: 0.4925795 Vali Loss: 1.4194058 Test Loss: 0.4060939
Validation loss decreased (1.432687 --> 1.419406).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 9 cost time: 1.6539890766143799
Epoch: 9, Steps: 52 | Train Loss: 0.4843039 Vali Loss: 1.4077368 Test Loss: 0.3952361
Validation loss decreased (1.419406 --> 1.407737).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 10 cost time: 1.6524057388305664
Epoch: 10, Steps: 52 | Train Loss: 0.4783817 Vali Loss: 1.3985268 Test Loss: 0.3862971
Validation loss decreased (1.407737 --> 1.398527).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 11 cost time: 1.6365211009979248
Epoch: 11, Steps: 52 | Train Loss: 0.4721996 Vali Loss: 1.3908986 Test Loss: 0.3814180
Validation loss decreased (1.398527 --> 1.390899).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 12 cost time: 1.6576738357543945
Epoch: 12, Steps: 52 | Train Loss: 0.4683945 Vali Loss: 1.3822030 Test Loss: 0.3764402
Validation loss decreased (1.390899 --> 1.382203).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 13 cost time: 1.6514592170715332
Epoch: 13, Steps: 52 | Train Loss: 0.4631985 Vali Loss: 1.3789277 Test Loss: 0.3727198
Validation loss decreased (1.382203 --> 1.378928).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 14 cost time: 1.649031400680542
Epoch: 14, Steps: 52 | Train Loss: 0.4626721 Vali Loss: 1.3783369 Test Loss: 0.3698772
Validation loss decreased (1.378928 --> 1.378337).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 15 cost time: 1.6444892883300781
Epoch: 15, Steps: 52 | Train Loss: 0.4590683 Vali Loss: 1.3750360 Test Loss: 0.3669702
Validation loss decreased (1.378337 --> 1.375036).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 16 cost time: 1.6576237678527832
Epoch: 16, Steps: 52 | Train Loss: 0.4573841 Vali Loss: 1.3751394 Test Loss: 0.3649813
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 17 cost time: 1.65049147605896
Epoch: 17, Steps: 52 | Train Loss: 0.4547962 Vali Loss: 1.3673475 Test Loss: 0.3634754
Validation loss decreased (1.375036 --> 1.367347).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 18 cost time: 1.6593942642211914
Epoch: 18, Steps: 52 | Train Loss: 0.4526629 Vali Loss: 1.3590589 Test Loss: 0.3622185
Validation loss decreased (1.367347 --> 1.359059).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 19 cost time: 1.6525657176971436
Epoch: 19, Steps: 52 | Train Loss: 0.4510968 Vali Loss: 1.3694566 Test Loss: 0.3606576
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 20 cost time: 1.6515812873840332
Epoch: 20, Steps: 52 | Train Loss: 0.4506329 Vali Loss: 1.3591051 Test Loss: 0.3593547
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 21 cost time: 1.6568520069122314
Epoch: 21, Steps: 52 | Train Loss: 0.4495585 Vali Loss: 1.3623087 Test Loss: 0.3582260
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 22 cost time: 1.6614141464233398
Epoch: 22, Steps: 52 | Train Loss: 0.4492679 Vali Loss: 1.3595694 Test Loss: 0.3578721
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 23 cost time: 1.6507937908172607
Epoch: 23, Steps: 52 | Train Loss: 0.4484573 Vali Loss: 1.3618071 Test Loss: 0.3570761
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 24 cost time: 1.6594958305358887
Epoch: 24, Steps: 52 | Train Loss: 0.4478756 Vali Loss: 1.3581808 Test Loss: 0.3560187
Validation loss decreased (1.359059 --> 1.358181).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 25 cost time: 1.651062250137329
Epoch: 25, Steps: 52 | Train Loss: 0.4471025 Vali Loss: 1.3541756 Test Loss: 0.3559934
Validation loss decreased (1.358181 --> 1.354176).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 26 cost time: 1.6483509540557861
Epoch: 26, Steps: 52 | Train Loss: 0.4454354 Vali Loss: 1.3576946 Test Loss: 0.3555230
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 27 cost time: 1.6635444164276123
Epoch: 27, Steps: 52 | Train Loss: 0.4445251 Vali Loss: 1.3574414 Test Loss: 0.3550333
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 28 cost time: 1.651212453842163
Epoch: 28, Steps: 52 | Train Loss: 0.4445026 Vali Loss: 1.3560660 Test Loss: 0.3548556
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 29 cost time: 1.6523962020874023
Epoch: 29, Steps: 52 | Train Loss: 0.4436412 Vali Loss: 1.3493910 Test Loss: 0.3538595
Validation loss decreased (1.354176 --> 1.349391).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 30 cost time: 1.6481025218963623
Epoch: 30, Steps: 52 | Train Loss: 0.4440700 Vali Loss: 1.3555074 Test Loss: 0.3538741
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 31 cost time: 1.6549646854400635
Epoch: 31, Steps: 52 | Train Loss: 0.4421148 Vali Loss: 1.3496909 Test Loss: 0.3536348
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 32 cost time: 1.6549787521362305
Epoch: 32, Steps: 52 | Train Loss: 0.4439928 Vali Loss: 1.3466532 Test Loss: 0.3536724
Validation loss decreased (1.349391 --> 1.346653).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 33 cost time: 1.6535027027130127
Epoch: 33, Steps: 52 | Train Loss: 0.4411543 Vali Loss: 1.3573217 Test Loss: 0.3528404
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 34 cost time: 1.6521871089935303
Epoch: 34, Steps: 52 | Train Loss: 0.4414259 Vali Loss: 1.3521420 Test Loss: 0.3527849
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 35 cost time: 1.6514663696289062
Epoch: 35, Steps: 52 | Train Loss: 0.4416315 Vali Loss: 1.3511896 Test Loss: 0.3522897
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 36 cost time: 1.655038833618164
Epoch: 36, Steps: 52 | Train Loss: 0.4416424 Vali Loss: 1.3501630 Test Loss: 0.3524427
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 37 cost time: 1.6543831825256348
Epoch: 37, Steps: 52 | Train Loss: 0.4430136 Vali Loss: 1.3478999 Test Loss: 0.3525503
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 38 cost time: 1.6593971252441406
Epoch: 38, Steps: 52 | Train Loss: 0.4406346 Vali Loss: 1.3465062 Test Loss: 0.3523923
Validation loss decreased (1.346653 --> 1.346506).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 39 cost time: 1.6526994705200195
Epoch: 39, Steps: 52 | Train Loss: 0.4397819 Vali Loss: 1.3497841 Test Loss: 0.3521188
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 40 cost time: 1.6530365943908691
Epoch: 40, Steps: 52 | Train Loss: 0.4417817 Vali Loss: 1.3449223 Test Loss: 0.3518780
Validation loss decreased (1.346506 --> 1.344922).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 41 cost time: 1.6474812030792236
Epoch: 41, Steps: 52 | Train Loss: 0.4422232 Vali Loss: 1.3507779 Test Loss: 0.3522508
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 42 cost time: 1.6513288021087646
Epoch: 42, Steps: 52 | Train Loss: 0.4388518 Vali Loss: 1.3576190 Test Loss: 0.3517809
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 43 cost time: 1.6541175842285156
Epoch: 43, Steps: 52 | Train Loss: 0.4396667 Vali Loss: 1.3554158 Test Loss: 0.3518407
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 44 cost time: 1.6525342464447021
Epoch: 44, Steps: 52 | Train Loss: 0.4402321 Vali Loss: 1.3427675 Test Loss: 0.3514872
Validation loss decreased (1.344922 --> 1.342767).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 45 cost time: 1.6544604301452637
Epoch: 45, Steps: 52 | Train Loss: 0.4403535 Vali Loss: 1.3513952 Test Loss: 0.3519563
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 46 cost time: 1.6548256874084473
Epoch: 46, Steps: 52 | Train Loss: 0.4421111 Vali Loss: 1.3495151 Test Loss: 0.3514473
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 47 cost time: 1.6505076885223389
Epoch: 47, Steps: 52 | Train Loss: 0.4422964 Vali Loss: 1.3416005 Test Loss: 0.3517995
Validation loss decreased (1.342767 --> 1.341601).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 48 cost time: 1.6507422924041748
Epoch: 48, Steps: 52 | Train Loss: 0.4410349 Vali Loss: 1.3355258 Test Loss: 0.3512061
Validation loss decreased (1.341601 --> 1.335526).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 49 cost time: 1.6494262218475342
Epoch: 49, Steps: 52 | Train Loss: 0.4392900 Vali Loss: 1.3486006 Test Loss: 0.3513498
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 50 cost time: 1.6463842391967773
Epoch: 50, Steps: 52 | Train Loss: 0.4389055 Vali Loss: 1.3495743 Test Loss: 0.3511234
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 51 cost time: 1.6504290103912354
Epoch: 51, Steps: 52 | Train Loss: 0.4392351 Vali Loss: 1.3501081 Test Loss: 0.3516124
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 52 cost time: 1.6541590690612793
Epoch: 52, Steps: 52 | Train Loss: 0.4403440 Vali Loss: 1.3477108 Test Loss: 0.3515044
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 53 cost time: 1.6564483642578125
Epoch: 53, Steps: 52 | Train Loss: 0.4399207 Vali Loss: 1.3483965 Test Loss: 0.3512558
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 54 cost time: 1.649420976638794
Epoch: 54, Steps: 52 | Train Loss: 0.4403851 Vali Loss: 1.3529997 Test Loss: 0.3513242
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 55 cost time: 1.6448462009429932
Epoch: 55, Steps: 52 | Train Loss: 0.4422639 Vali Loss: 1.3464011 Test Loss: 0.3509578
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 56 cost time: 1.6510963439941406
Epoch: 56, Steps: 52 | Train Loss: 0.4394740 Vali Loss: 1.3450291 Test Loss: 0.3509819
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 57 cost time: 1.6503875255584717
Epoch: 57, Steps: 52 | Train Loss: 0.4407146 Vali Loss: 1.3505491 Test Loss: 0.3513752
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 58 cost time: 1.6508221626281738
Epoch: 58, Steps: 52 | Train Loss: 0.4399512 Vali Loss: 1.3533463 Test Loss: 0.3511945
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 59 cost time: 1.6594598293304443
Epoch: 59, Steps: 52 | Train Loss: 0.4395577 Vali Loss: 1.3477800 Test Loss: 0.3511549
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 60 cost time: 1.6523640155792236
Epoch: 60, Steps: 52 | Train Loss: 0.4397194 Vali Loss: 1.3496505 Test Loss: 0.3513892
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35120609402656555, mae:0.39112186431884766, rse:0.48550066351890564
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.04661846160888672 GB
Epoch: 1 cost time: 2.1240739822387695
Epoch: 1, Steps: 52 | Train Loss: 0.7181290 Vali Loss: 2.0842540 Test Loss: 1.2915065
Validation loss decreased (inf --> 2.084254).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 2 cost time: 0.7710034847259521
Epoch: 2, Steps: 52 | Train Loss: 0.6293738 Vali Loss: 1.6867981 Test Loss: 0.7798513
Validation loss decreased (2.084254 --> 1.686798).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 3 cost time: 0.7669117450714111
Epoch: 3, Steps: 52 | Train Loss: 0.5226110 Vali Loss: 1.4956551 Test Loss: 0.5165780
Validation loss decreased (1.686798 --> 1.495655).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 4 cost time: 0.7667398452758789
Epoch: 4, Steps: 52 | Train Loss: 0.4762807 Vali Loss: 1.4223423 Test Loss: 0.4298052
Validation loss decreased (1.495655 --> 1.422342).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 5 cost time: 0.7682936191558838
Epoch: 5, Steps: 52 | Train Loss: 0.4533375 Vali Loss: 1.3962239 Test Loss: 0.4029294
Validation loss decreased (1.422342 --> 1.396224).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 6 cost time: 1.706536054611206
Epoch: 6, Steps: 52 | Train Loss: 0.4447025 Vali Loss: 1.3851495 Test Loss: 0.3878895
Validation loss decreased (1.396224 --> 1.385149).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 7 cost time: 1.7084300518035889
Epoch: 7, Steps: 52 | Train Loss: 0.4364804 Vali Loss: 1.3694885 Test Loss: 0.3762114
Validation loss decreased (1.385149 --> 1.369488).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 8 cost time: 1.7145969867706299
Epoch: 8, Steps: 52 | Train Loss: 0.4334181 Vali Loss: 1.3639903 Test Loss: 0.3689060
Validation loss decreased (1.369488 --> 1.363990).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 9 cost time: 1.7096409797668457
Epoch: 9, Steps: 52 | Train Loss: 0.4298521 Vali Loss: 1.3516631 Test Loss: 0.3624184
Validation loss decreased (1.363990 --> 1.351663).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 10 cost time: 1.717108964920044
Epoch: 10, Steps: 52 | Train Loss: 0.4288437 Vali Loss: 1.3524158 Test Loss: 0.3576226
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 11 cost time: 1.704179286956787
Epoch: 11, Steps: 52 | Train Loss: 0.4251413 Vali Loss: 1.3438741 Test Loss: 0.3548362
Validation loss decreased (1.351663 --> 1.343874).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 12 cost time: 1.701158046722412
Epoch: 12, Steps: 52 | Train Loss: 0.4227948 Vali Loss: 1.3471670 Test Loss: 0.3520224
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 13 cost time: 1.7114043235778809
Epoch: 13, Steps: 52 | Train Loss: 0.4224786 Vali Loss: 1.3302770 Test Loss: 0.3498597
Validation loss decreased (1.343874 --> 1.330277).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 14 cost time: 1.7043654918670654
Epoch: 14, Steps: 52 | Train Loss: 0.4190290 Vali Loss: 1.3347930 Test Loss: 0.3485565
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 15 cost time: 1.712268352508545
Epoch: 15, Steps: 52 | Train Loss: 0.4206064 Vali Loss: 1.3329659 Test Loss: 0.3466343
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 16 cost time: 1.7112538814544678
Epoch: 16, Steps: 52 | Train Loss: 0.4184841 Vali Loss: 1.3323859 Test Loss: 0.3458970
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 17 cost time: 1.7220778465270996
Epoch: 17, Steps: 52 | Train Loss: 0.4184902 Vali Loss: 1.3269451 Test Loss: 0.3445233
Validation loss decreased (1.330277 --> 1.326945).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 18 cost time: 1.7123770713806152
Epoch: 18, Steps: 52 | Train Loss: 0.4169795 Vali Loss: 1.3294601 Test Loss: 0.3441273
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 19 cost time: 1.7177906036376953
Epoch: 19, Steps: 52 | Train Loss: 0.4162560 Vali Loss: 1.3322260 Test Loss: 0.3439819
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 20 cost time: 1.712846279144287
Epoch: 20, Steps: 52 | Train Loss: 0.4142618 Vali Loss: 1.3255616 Test Loss: 0.3434851
Validation loss decreased (1.326945 --> 1.325562).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 21 cost time: 1.7097163200378418
Epoch: 21, Steps: 52 | Train Loss: 0.4147000 Vali Loss: 1.3227687 Test Loss: 0.3426143
Validation loss decreased (1.325562 --> 1.322769).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 22 cost time: 1.7130036354064941
Epoch: 22, Steps: 52 | Train Loss: 0.4149680 Vali Loss: 1.3223327 Test Loss: 0.3421345
Validation loss decreased (1.322769 --> 1.322333).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 23 cost time: 1.7130250930786133
Epoch: 23, Steps: 52 | Train Loss: 0.4136138 Vali Loss: 1.3176935 Test Loss: 0.3414399
Validation loss decreased (1.322333 --> 1.317693).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 24 cost time: 1.7002604007720947
Epoch: 24, Steps: 52 | Train Loss: 0.4144939 Vali Loss: 1.3257174 Test Loss: 0.3413890
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 25 cost time: 1.706366777420044
Epoch: 25, Steps: 52 | Train Loss: 0.4146931 Vali Loss: 1.3241994 Test Loss: 0.3411000
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 26 cost time: 1.696824550628662
Epoch: 26, Steps: 52 | Train Loss: 0.4148037 Vali Loss: 1.3292913 Test Loss: 0.3408480
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 27 cost time: 1.7124454975128174
Epoch: 27, Steps: 52 | Train Loss: 0.4143201 Vali Loss: 1.3232126 Test Loss: 0.3407612
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 28 cost time: 1.709113597869873
Epoch: 28, Steps: 52 | Train Loss: 0.4134126 Vali Loss: 1.3220295 Test Loss: 0.3402421
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 29 cost time: 1.7145097255706787
Epoch: 29, Steps: 52 | Train Loss: 0.4129935 Vali Loss: 1.3227800 Test Loss: 0.3400274
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 30 cost time: 1.709073543548584
Epoch: 30, Steps: 52 | Train Loss: 0.4125627 Vali Loss: 1.3185744 Test Loss: 0.3400738
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 31 cost time: 1.7213969230651855
Epoch: 31, Steps: 52 | Train Loss: 0.4122795 Vali Loss: 1.3165295 Test Loss: 0.3399328
Validation loss decreased (1.317693 --> 1.316530).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 32 cost time: 1.709486722946167
Epoch: 32, Steps: 52 | Train Loss: 0.4147881 Vali Loss: 1.3224069 Test Loss: 0.3392217
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 33 cost time: 1.7135531902313232
Epoch: 33, Steps: 52 | Train Loss: 0.4103201 Vali Loss: 1.3135853 Test Loss: 0.3395089
Validation loss decreased (1.316530 --> 1.313585).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 34 cost time: 1.7134945392608643
Epoch: 34, Steps: 52 | Train Loss: 0.4129485 Vali Loss: 1.3033763 Test Loss: 0.3393834
Validation loss decreased (1.313585 --> 1.303376).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 35 cost time: 1.7240877151489258
Epoch: 35, Steps: 52 | Train Loss: 0.4119981 Vali Loss: 1.3246636 Test Loss: 0.3388640
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 36 cost time: 1.7049384117126465
Epoch: 36, Steps: 52 | Train Loss: 0.4115899 Vali Loss: 1.3202564 Test Loss: 0.3393121
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 37 cost time: 1.706507921218872
Epoch: 37, Steps: 52 | Train Loss: 0.4129084 Vali Loss: 1.3166227 Test Loss: 0.3387610
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 38 cost time: 1.7090437412261963
Epoch: 38, Steps: 52 | Train Loss: 0.4114810 Vali Loss: 1.3254285 Test Loss: 0.3386323
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 39 cost time: 1.7104418277740479
Epoch: 39, Steps: 52 | Train Loss: 0.4112887 Vali Loss: 1.3180463 Test Loss: 0.3391099
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 40 cost time: 1.691850185394287
Epoch: 40, Steps: 52 | Train Loss: 0.4129406 Vali Loss: 1.3222270 Test Loss: 0.3389253
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 41 cost time: 1.711449384689331
Epoch: 41, Steps: 52 | Train Loss: 0.4108047 Vali Loss: 1.3174798 Test Loss: 0.3388632
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 42 cost time: 1.7187237739562988
Epoch: 42, Steps: 52 | Train Loss: 0.4142057 Vali Loss: 1.3237824 Test Loss: 0.3396937
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 43 cost time: 1.7116281986236572
Epoch: 43, Steps: 52 | Train Loss: 0.4098477 Vali Loss: 1.3201239 Test Loss: 0.3392969
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 44 cost time: 1.7004303932189941
Epoch: 44, Steps: 52 | Train Loss: 0.4106405 Vali Loss: 1.3153214 Test Loss: 0.3392992
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 45 cost time: 1.7121093273162842
Epoch: 45, Steps: 52 | Train Loss: 0.4120639 Vali Loss: 1.3152177 Test Loss: 0.3390047
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 46 cost time: 1.7057688236236572
Epoch: 46, Steps: 52 | Train Loss: 0.4114633 Vali Loss: 1.3234587 Test Loss: 0.3388514
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 47 cost time: 1.6955270767211914
Epoch: 47, Steps: 52 | Train Loss: 0.4115888 Vali Loss: 1.3173501 Test Loss: 0.3382345
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 48 cost time: 1.7095816135406494
Epoch: 48, Steps: 52 | Train Loss: 0.4118456 Vali Loss: 1.3233730 Test Loss: 0.3390237
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 49 cost time: 1.706427812576294
Epoch: 49, Steps: 52 | Train Loss: 0.4104665 Vali Loss: 1.3169397 Test Loss: 0.3390029
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 50 cost time: 1.7061822414398193
Epoch: 50, Steps: 52 | Train Loss: 0.4120006 Vali Loss: 1.3160257 Test Loss: 0.3390294
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 51 cost time: 1.7001049518585205
Epoch: 51, Steps: 52 | Train Loss: 0.4117802 Vali Loss: 1.3172424 Test Loss: 0.3384561
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 52 cost time: 1.7035877704620361
Epoch: 52, Steps: 52 | Train Loss: 0.4112571 Vali Loss: 1.3210897 Test Loss: 0.3384072
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 53 cost time: 1.698249340057373
Epoch: 53, Steps: 52 | Train Loss: 0.4111740 Vali Loss: 1.3192867 Test Loss: 0.3388121
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 54 cost time: 1.6954247951507568
Epoch: 54, Steps: 52 | Train Loss: 0.4125226 Vali Loss: 1.3227419 Test Loss: 0.3390630
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 55 cost time: 1.687021017074585
Epoch: 55, Steps: 52 | Train Loss: 0.4117537 Vali Loss: 1.3186421 Test Loss: 0.3390929
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 56 cost time: 1.6967272758483887
Epoch: 56, Steps: 52 | Train Loss: 0.4106931 Vali Loss: 1.3111658 Test Loss: 0.3388816
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 57 cost time: 1.697230339050293
Epoch: 57, Steps: 52 | Train Loss: 0.4116862 Vali Loss: 1.3144592 Test Loss: 0.3393958
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 58 cost time: 1.7061567306518555
Epoch: 58, Steps: 52 | Train Loss: 0.4115395 Vali Loss: 1.3198987 Test Loss: 0.3385702
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 59 cost time: 1.7024149894714355
Epoch: 59, Steps: 52 | Train Loss: 0.4103575 Vali Loss: 1.3212414 Test Loss: 0.3390930
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 60 cost time: 1.6984543800354004
Epoch: 60, Steps: 52 | Train Loss: 0.4111559 Vali Loss: 1.3166883 Test Loss: 0.3395011
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33938339352607727, mae:0.38805732131004333, rse:0.47725898027420044
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04773855209350586 GB
Epoch: 1 cost time: 2.1644668579101562
Epoch: 1, Steps: 52 | Train Loss: 0.7316785 Vali Loss: 2.2413430 Test Loss: 1.4872727
Validation loss decreased (inf --> 2.241343).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 2 cost time: 0.7836377620697021
Epoch: 2, Steps: 52 | Train Loss: 0.6599999 Vali Loss: 1.8584418 Test Loss: 1.0249755
Validation loss decreased (2.241343 --> 1.858442).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 3 cost time: 0.7806169986724854
Epoch: 3, Steps: 52 | Train Loss: 0.5458034 Vali Loss: 1.5747647 Test Loss: 0.6159898
Validation loss decreased (1.858442 --> 1.574765).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 4 cost time: 0.777442455291748
Epoch: 4, Steps: 52 | Train Loss: 0.4711045 Vali Loss: 1.4428089 Test Loss: 0.4324186
Validation loss decreased (1.574765 --> 1.442809).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 5 cost time: 0.852741003036499
Epoch: 5, Steps: 52 | Train Loss: 0.4485305 Vali Loss: 1.4096670 Test Loss: 0.4054190
Validation loss decreased (1.442809 --> 1.409667).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 6 cost time: 1.757028579711914
Epoch: 6, Steps: 52 | Train Loss: 0.4382649 Vali Loss: 1.3845861 Test Loss: 0.3870467
Validation loss decreased (1.409667 --> 1.384586).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 7 cost time: 1.7561185359954834
Epoch: 7, Steps: 52 | Train Loss: 0.4313791 Vali Loss: 1.3640100 Test Loss: 0.3768364
Validation loss decreased (1.384586 --> 1.364010).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 8 cost time: 1.762864589691162
Epoch: 8, Steps: 52 | Train Loss: 0.4282039 Vali Loss: 1.3638180 Test Loss: 0.3703769
Validation loss decreased (1.364010 --> 1.363818).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 9 cost time: 1.7562894821166992
Epoch: 9, Steps: 52 | Train Loss: 0.4240473 Vali Loss: 1.3570753 Test Loss: 0.3645875
Validation loss decreased (1.363818 --> 1.357075).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 10 cost time: 1.7531814575195312
Epoch: 10, Steps: 52 | Train Loss: 0.4233830 Vali Loss: 1.3447721 Test Loss: 0.3614011
Validation loss decreased (1.357075 --> 1.344772).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 11 cost time: 1.7484698295593262
Epoch: 11, Steps: 52 | Train Loss: 0.4219144 Vali Loss: 1.3464706 Test Loss: 0.3584391
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 12 cost time: 1.749800682067871
Epoch: 12, Steps: 52 | Train Loss: 0.4192394 Vali Loss: 1.3449864 Test Loss: 0.3561903
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 13 cost time: 1.75242280960083
Epoch: 13, Steps: 52 | Train Loss: 0.4178157 Vali Loss: 1.3393136 Test Loss: 0.3545849
Validation loss decreased (1.344772 --> 1.339314).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 14 cost time: 1.7564685344696045
Epoch: 14, Steps: 52 | Train Loss: 0.4176961 Vali Loss: 1.3375199 Test Loss: 0.3528477
Validation loss decreased (1.339314 --> 1.337520).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 15 cost time: 1.7525408267974854
Epoch: 15, Steps: 52 | Train Loss: 0.4172500 Vali Loss: 1.3421791 Test Loss: 0.3520828
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 16 cost time: 1.761878252029419
Epoch: 16, Steps: 52 | Train Loss: 0.4160214 Vali Loss: 1.3349154 Test Loss: 0.3506320
Validation loss decreased (1.337520 --> 1.334915).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 17 cost time: 1.7600610256195068
Epoch: 17, Steps: 52 | Train Loss: 0.4172159 Vali Loss: 1.3324926 Test Loss: 0.3503875
Validation loss decreased (1.334915 --> 1.332493).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 18 cost time: 1.7530124187469482
Epoch: 18, Steps: 52 | Train Loss: 0.4161671 Vali Loss: 1.3340683 Test Loss: 0.3493346
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 19 cost time: 1.7674529552459717
Epoch: 19, Steps: 52 | Train Loss: 0.4158047 Vali Loss: 1.3322825 Test Loss: 0.3484774
Validation loss decreased (1.332493 --> 1.332283).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 20 cost time: 1.7567853927612305
Epoch: 20, Steps: 52 | Train Loss: 0.4144744 Vali Loss: 1.3305486 Test Loss: 0.3476495
Validation loss decreased (1.332283 --> 1.330549).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 21 cost time: 1.7614161968231201
Epoch: 21, Steps: 52 | Train Loss: 0.4125843 Vali Loss: 1.3240943 Test Loss: 0.3476954
Validation loss decreased (1.330549 --> 1.324094).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 22 cost time: 1.7534756660461426
Epoch: 22, Steps: 52 | Train Loss: 0.4110569 Vali Loss: 1.3245717 Test Loss: 0.3477282
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 23 cost time: 1.7643909454345703
Epoch: 23, Steps: 52 | Train Loss: 0.4125923 Vali Loss: 1.3299001 Test Loss: 0.3474116
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 24 cost time: 1.743652582168579
Epoch: 24, Steps: 52 | Train Loss: 0.4110383 Vali Loss: 1.3274027 Test Loss: 0.3466523
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 25 cost time: 1.7550835609436035
Epoch: 25, Steps: 52 | Train Loss: 0.4106323 Vali Loss: 1.3252122 Test Loss: 0.3461512
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 26 cost time: 1.7565011978149414
Epoch: 26, Steps: 52 | Train Loss: 0.4105457 Vali Loss: 1.3285989 Test Loss: 0.3459623
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 27 cost time: 1.7571074962615967
Epoch: 27, Steps: 52 | Train Loss: 0.4108903 Vali Loss: 1.3310695 Test Loss: 0.3458155
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 28 cost time: 1.7565827369689941
Epoch: 28, Steps: 52 | Train Loss: 0.4113506 Vali Loss: 1.3235136 Test Loss: 0.3454617
Validation loss decreased (1.324094 --> 1.323514).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 29 cost time: 1.751793384552002
Epoch: 29, Steps: 52 | Train Loss: 0.4107033 Vali Loss: 1.3245533 Test Loss: 0.3459848
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 30 cost time: 1.7555367946624756
Epoch: 30, Steps: 52 | Train Loss: 0.4105903 Vali Loss: 1.3283947 Test Loss: 0.3453257
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 31 cost time: 1.7478232383728027
Epoch: 31, Steps: 52 | Train Loss: 0.4108938 Vali Loss: 1.3241625 Test Loss: 0.3453075
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 32 cost time: 1.7571167945861816
Epoch: 32, Steps: 52 | Train Loss: 0.4104022 Vali Loss: 1.3262756 Test Loss: 0.3449911
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 33 cost time: 1.763566493988037
Epoch: 33, Steps: 52 | Train Loss: 0.4111711 Vali Loss: 1.3245492 Test Loss: 0.3446109
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 34 cost time: 1.7519595623016357
Epoch: 34, Steps: 52 | Train Loss: 0.4123647 Vali Loss: 1.3249221 Test Loss: 0.3452441
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 35 cost time: 1.7552130222320557
Epoch: 35, Steps: 52 | Train Loss: 0.4101686 Vali Loss: 1.3276720 Test Loss: 0.3454715
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 36 cost time: 1.7524290084838867
Epoch: 36, Steps: 52 | Train Loss: 0.4095243 Vali Loss: 1.3218752 Test Loss: 0.3449335
Validation loss decreased (1.323514 --> 1.321875).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 37 cost time: 1.7521450519561768
Epoch: 37, Steps: 52 | Train Loss: 0.4103241 Vali Loss: 1.3257746 Test Loss: 0.3447054
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 38 cost time: 1.7485687732696533
Epoch: 38, Steps: 52 | Train Loss: 0.4099287 Vali Loss: 1.3162518 Test Loss: 0.3445600
Validation loss decreased (1.321875 --> 1.316252).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 39 cost time: 1.7581424713134766
Epoch: 39, Steps: 52 | Train Loss: 0.4102605 Vali Loss: 1.3203820 Test Loss: 0.3439281
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 40 cost time: 1.747549057006836
Epoch: 40, Steps: 52 | Train Loss: 0.4090244 Vali Loss: 1.3128443 Test Loss: 0.3450465
Validation loss decreased (1.316252 --> 1.312844).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 41 cost time: 1.7489013671875
Epoch: 41, Steps: 52 | Train Loss: 0.4110853 Vali Loss: 1.3125343 Test Loss: 0.3448005
Validation loss decreased (1.312844 --> 1.312534).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 42 cost time: 1.7505226135253906
Epoch: 42, Steps: 52 | Train Loss: 0.4108392 Vali Loss: 1.3300303 Test Loss: 0.3452072
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 43 cost time: 1.7815330028533936
Epoch: 43, Steps: 52 | Train Loss: 0.4090045 Vali Loss: 1.3224008 Test Loss: 0.3451674
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 44 cost time: 1.7525112628936768
Epoch: 44, Steps: 52 | Train Loss: 0.4092749 Vali Loss: 1.3217958 Test Loss: 0.3448256
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 45 cost time: 1.7522735595703125
Epoch: 45, Steps: 52 | Train Loss: 0.4104636 Vali Loss: 1.3234280 Test Loss: 0.3437269
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 46 cost time: 1.75685715675354
Epoch: 46, Steps: 52 | Train Loss: 0.4118819 Vali Loss: 1.3264107 Test Loss: 0.3443015
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 47 cost time: 1.7614409923553467
Epoch: 47, Steps: 52 | Train Loss: 0.4080249 Vali Loss: 1.3208292 Test Loss: 0.3448773
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 48 cost time: 1.7474894523620605
Epoch: 48, Steps: 52 | Train Loss: 0.4112715 Vali Loss: 1.3220139 Test Loss: 0.3438906
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 49 cost time: 1.7587571144104004
Epoch: 49, Steps: 52 | Train Loss: 0.4101317 Vali Loss: 1.3274630 Test Loss: 0.3441957
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 50 cost time: 1.7573330402374268
Epoch: 50, Steps: 52 | Train Loss: 0.4087377 Vali Loss: 1.3220079 Test Loss: 0.3432928
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 51 cost time: 1.759019374847412
Epoch: 51, Steps: 52 | Train Loss: 0.4112287 Vali Loss: 1.3201531 Test Loss: 0.3447565
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 52 cost time: 1.7564516067504883
Epoch: 52, Steps: 52 | Train Loss: 0.4109211 Vali Loss: 1.3259144 Test Loss: 0.3448765
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 53 cost time: 1.7629168033599854
Epoch: 53, Steps: 52 | Train Loss: 0.4086482 Vali Loss: 1.3255022 Test Loss: 0.3448170
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 54 cost time: 1.7409427165985107
Epoch: 54, Steps: 52 | Train Loss: 0.4076679 Vali Loss: 1.3225600 Test Loss: 0.3444088
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 55 cost time: 1.7462084293365479
Epoch: 55, Steps: 52 | Train Loss: 0.4107532 Vali Loss: 1.3117177 Test Loss: 0.3442549
Validation loss decreased (1.312534 --> 1.311718).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 56 cost time: 1.750532865524292
Epoch: 56, Steps: 52 | Train Loss: 0.4097176 Vali Loss: 1.3261287 Test Loss: 0.3440381
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 57 cost time: 1.7631418704986572
Epoch: 57, Steps: 52 | Train Loss: 0.4098545 Vali Loss: 1.3199813 Test Loss: 0.3451748
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 58 cost time: 1.762103796005249
Epoch: 58, Steps: 52 | Train Loss: 0.4088142 Vali Loss: 1.3248700 Test Loss: 0.3443192
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 59 cost time: 1.7577323913574219
Epoch: 59, Steps: 52 | Train Loss: 0.4098171 Vali Loss: 1.3125229 Test Loss: 0.3442589
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 60 cost time: 1.7586674690246582
Epoch: 60, Steps: 52 | Train Loss: 0.4092996 Vali Loss: 1.3242950 Test Loss: 0.3445851
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34425482153892517, mae:0.3936564028263092, rse:0.4806719720363617
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.045348167419433594 GB
Epoch: 1 cost time: 2.141120672225952
Epoch: 1, Steps: 52 | Train Loss: 0.8699002 Vali Loss: 2.2978454 Test Loss: 1.5318359
Validation loss decreased (inf --> 2.297845).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 2 cost time: 0.7376298904418945
Epoch: 2, Steps: 52 | Train Loss: 0.7514502 Vali Loss: 1.7613034 Test Loss: 0.8727576
Validation loss decreased (2.297845 --> 1.761303).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 3 cost time: 0.7306365966796875
Epoch: 3, Steps: 52 | Train Loss: 0.6105226 Vali Loss: 1.5191864 Test Loss: 0.5692192
Validation loss decreased (1.761303 --> 1.519186).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 4 cost time: 0.7459640502929688
Epoch: 4, Steps: 52 | Train Loss: 0.5456040 Vali Loss: 1.4423273 Test Loss: 0.4537728
Validation loss decreased (1.519186 --> 1.442327).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 5 cost time: 0.7416360378265381
Epoch: 5, Steps: 52 | Train Loss: 0.5139773 Vali Loss: 1.4114962 Test Loss: 0.4220189
Validation loss decreased (1.442327 --> 1.411496).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 6 cost time: 1.6632792949676514
Epoch: 6, Steps: 52 | Train Loss: 0.4966282 Vali Loss: 1.4013522 Test Loss: 0.4054407
Validation loss decreased (1.411496 --> 1.401352).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 7 cost time: 1.664494514465332
Epoch: 7, Steps: 52 | Train Loss: 0.4846221 Vali Loss: 1.3865675 Test Loss: 0.3965611
Validation loss decreased (1.401352 --> 1.386567).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 8 cost time: 1.6701853275299072
Epoch: 8, Steps: 52 | Train Loss: 0.4769946 Vali Loss: 1.3850248 Test Loss: 0.3899966
Validation loss decreased (1.386567 --> 1.385025).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 9 cost time: 1.666551113128662
Epoch: 9, Steps: 52 | Train Loss: 0.4701823 Vali Loss: 1.3828993 Test Loss: 0.3849877
Validation loss decreased (1.385025 --> 1.382899).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 10 cost time: 1.6674890518188477
Epoch: 10, Steps: 52 | Train Loss: 0.4671548 Vali Loss: 1.3734672 Test Loss: 0.3803150
Validation loss decreased (1.382899 --> 1.373467).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 11 cost time: 1.6698064804077148
Epoch: 11, Steps: 52 | Train Loss: 0.4626833 Vali Loss: 1.3775241 Test Loss: 0.3767484
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 12 cost time: 1.6654722690582275
Epoch: 12, Steps: 52 | Train Loss: 0.4593499 Vali Loss: 1.3691416 Test Loss: 0.3737748
Validation loss decreased (1.373467 --> 1.369142).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 13 cost time: 1.6660377979278564
Epoch: 13, Steps: 52 | Train Loss: 0.4563509 Vali Loss: 1.3682778 Test Loss: 0.3714518
Validation loss decreased (1.369142 --> 1.368278).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 14 cost time: 1.6743183135986328
Epoch: 14, Steps: 52 | Train Loss: 0.4547462 Vali Loss: 1.3661888 Test Loss: 0.3694031
Validation loss decreased (1.368278 --> 1.366189).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 15 cost time: 1.669994831085205
Epoch: 15, Steps: 52 | Train Loss: 0.4530434 Vali Loss: 1.3634127 Test Loss: 0.3676974
Validation loss decreased (1.366189 --> 1.363413).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 16 cost time: 1.6761441230773926
Epoch: 16, Steps: 52 | Train Loss: 0.4493843 Vali Loss: 1.3642361 Test Loss: 0.3665990
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 17 cost time: 1.6688930988311768
Epoch: 17, Steps: 52 | Train Loss: 0.4472688 Vali Loss: 1.3650305 Test Loss: 0.3647540
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 18 cost time: 1.6701912879943848
Epoch: 18, Steps: 52 | Train Loss: 0.4465071 Vali Loss: 1.3556705 Test Loss: 0.3635392
Validation loss decreased (1.363413 --> 1.355670).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 19 cost time: 1.6761441230773926
Epoch: 19, Steps: 52 | Train Loss: 0.4463399 Vali Loss: 1.3632033 Test Loss: 0.3625675
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 20 cost time: 1.6684763431549072
Epoch: 20, Steps: 52 | Train Loss: 0.4444369 Vali Loss: 1.3646902 Test Loss: 0.3615350
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 21 cost time: 1.662522792816162
Epoch: 21, Steps: 52 | Train Loss: 0.4431007 Vali Loss: 1.3573481 Test Loss: 0.3605777
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 22 cost time: 1.6714255809783936
Epoch: 22, Steps: 52 | Train Loss: 0.4411453 Vali Loss: 1.3576481 Test Loss: 0.3597494
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 23 cost time: 1.6729893684387207
Epoch: 23, Steps: 52 | Train Loss: 0.4444970 Vali Loss: 1.3559409 Test Loss: 0.3591063
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 24 cost time: 1.66400146484375
Epoch: 24, Steps: 52 | Train Loss: 0.4397735 Vali Loss: 1.3565419 Test Loss: 0.3586198
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 25 cost time: 1.6721324920654297
Epoch: 25, Steps: 52 | Train Loss: 0.4402674 Vali Loss: 1.3520267 Test Loss: 0.3584520
Validation loss decreased (1.355670 --> 1.352027).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 26 cost time: 1.67128324508667
Epoch: 26, Steps: 52 | Train Loss: 0.4404784 Vali Loss: 1.3578968 Test Loss: 0.3579814
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 27 cost time: 1.6624395847320557
Epoch: 27, Steps: 52 | Train Loss: 0.4370987 Vali Loss: 1.3533168 Test Loss: 0.3581446
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 28 cost time: 1.6686797142028809
Epoch: 28, Steps: 52 | Train Loss: 0.4389657 Vali Loss: 1.3562500 Test Loss: 0.3570113
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 29 cost time: 1.6564686298370361
Epoch: 29, Steps: 52 | Train Loss: 0.4387935 Vali Loss: 1.3552144 Test Loss: 0.3571121
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 30 cost time: 1.6689481735229492
Epoch: 30, Steps: 52 | Train Loss: 0.4389809 Vali Loss: 1.3554561 Test Loss: 0.3570165
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 31 cost time: 1.6660826206207275
Epoch: 31, Steps: 52 | Train Loss: 0.4386625 Vali Loss: 1.3438864 Test Loss: 0.3575346
Validation loss decreased (1.352027 --> 1.343886).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 32 cost time: 1.6607487201690674
Epoch: 32, Steps: 52 | Train Loss: 0.4370075 Vali Loss: 1.3530838 Test Loss: 0.3559584
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 33 cost time: 1.665459394454956
Epoch: 33, Steps: 52 | Train Loss: 0.4360092 Vali Loss: 1.3553703 Test Loss: 0.3561805
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 34 cost time: 1.6660757064819336
Epoch: 34, Steps: 52 | Train Loss: 0.4388650 Vali Loss: 1.3522669 Test Loss: 0.3555580
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 35 cost time: 1.6703102588653564
Epoch: 35, Steps: 52 | Train Loss: 0.4374382 Vali Loss: 1.3541754 Test Loss: 0.3552732
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 36 cost time: 1.6712627410888672
Epoch: 36, Steps: 52 | Train Loss: 0.4363984 Vali Loss: 1.3539516 Test Loss: 0.3556130
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 37 cost time: 1.6675074100494385
Epoch: 37, Steps: 52 | Train Loss: 0.4372561 Vali Loss: 1.3492324 Test Loss: 0.3556409
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 38 cost time: 1.6695263385772705
Epoch: 38, Steps: 52 | Train Loss: 0.4358153 Vali Loss: 1.3472888 Test Loss: 0.3547051
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 39 cost time: 1.6695189476013184
Epoch: 39, Steps: 52 | Train Loss: 0.4355217 Vali Loss: 1.3479077 Test Loss: 0.3550227
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 40 cost time: 1.6704611778259277
Epoch: 40, Steps: 52 | Train Loss: 0.4364234 Vali Loss: 1.3540928 Test Loss: 0.3547864
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 41 cost time: 1.6697125434875488
Epoch: 41, Steps: 52 | Train Loss: 0.4356994 Vali Loss: 1.3473576 Test Loss: 0.3550020
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 42 cost time: 1.6625134944915771
Epoch: 42, Steps: 52 | Train Loss: 0.4354005 Vali Loss: 1.3441161 Test Loss: 0.3538924
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 43 cost time: 1.6559607982635498
Epoch: 43, Steps: 52 | Train Loss: 0.4364129 Vali Loss: 1.3533244 Test Loss: 0.3546237
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 44 cost time: 1.677488088607788
Epoch: 44, Steps: 52 | Train Loss: 0.4341102 Vali Loss: 1.3443134 Test Loss: 0.3548887
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 45 cost time: 1.6708717346191406
Epoch: 45, Steps: 52 | Train Loss: 0.4363815 Vali Loss: 1.3508065 Test Loss: 0.3549787
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 46 cost time: 1.6691930294036865
Epoch: 46, Steps: 52 | Train Loss: 0.4365563 Vali Loss: 1.3432649 Test Loss: 0.3551968
Validation loss decreased (1.343886 --> 1.343265).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 47 cost time: 1.6776163578033447
Epoch: 47, Steps: 52 | Train Loss: 0.4353495 Vali Loss: 1.3502367 Test Loss: 0.3547018
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 48 cost time: 1.6752338409423828
Epoch: 48, Steps: 52 | Train Loss: 0.4360245 Vali Loss: 1.3380525 Test Loss: 0.3537292
Validation loss decreased (1.343265 --> 1.338053).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 49 cost time: 1.669731855392456
Epoch: 49, Steps: 52 | Train Loss: 0.4348677 Vali Loss: 1.3458724 Test Loss: 0.3543521
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 50 cost time: 1.6643681526184082
Epoch: 50, Steps: 52 | Train Loss: 0.4351089 Vali Loss: 1.3483326 Test Loss: 0.3540874
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 51 cost time: 1.6627857685089111
Epoch: 51, Steps: 52 | Train Loss: 0.4361322 Vali Loss: 1.3436319 Test Loss: 0.3539222
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 52 cost time: 1.6704270839691162
Epoch: 52, Steps: 52 | Train Loss: 0.4340340 Vali Loss: 1.3450048 Test Loss: 0.3537779
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 53 cost time: 1.6691038608551025
Epoch: 53, Steps: 52 | Train Loss: 0.4349700 Vali Loss: 1.3365127 Test Loss: 0.3543171
Validation loss decreased (1.338053 --> 1.336513).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 54 cost time: 1.672553300857544
Epoch: 54, Steps: 52 | Train Loss: 0.4343584 Vali Loss: 1.3453252 Test Loss: 0.3539864
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 55 cost time: 1.673435926437378
Epoch: 55, Steps: 52 | Train Loss: 0.4359082 Vali Loss: 1.3535235 Test Loss: 0.3540981
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 56 cost time: 1.6675615310668945
Epoch: 56, Steps: 52 | Train Loss: 0.4363319 Vali Loss: 1.3417515 Test Loss: 0.3535836
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 57 cost time: 1.6633424758911133
Epoch: 57, Steps: 52 | Train Loss: 0.4328227 Vali Loss: 1.3435540 Test Loss: 0.3536620
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 58 cost time: 1.6664352416992188
Epoch: 58, Steps: 52 | Train Loss: 0.4353327 Vali Loss: 1.3471290 Test Loss: 0.3542329
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 59 cost time: 1.6625158786773682
Epoch: 59, Steps: 52 | Train Loss: 0.4349034 Vali Loss: 1.3511394 Test Loss: 0.3541840
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 60 cost time: 1.6664226055145264
Epoch: 60, Steps: 52 | Train Loss: 0.4342239 Vali Loss: 1.3433800 Test Loss: 0.3541268
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3543170988559723, mae:0.39154013991355896, rse:0.4876461923122406
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04678010940551758 GB
Epoch: 1 cost time: 2.162958860397339
Epoch: 1, Steps: 52 | Train Loss: 0.7503585 Vali Loss: 2.2339969 Test Loss: 1.4533319
Validation loss decreased (inf --> 2.233997).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 2 cost time: 0.7809991836547852
Epoch: 2, Steps: 52 | Train Loss: 0.6453724 Vali Loss: 1.6998537 Test Loss: 0.8053248
Validation loss decreased (2.233997 --> 1.699854).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 3 cost time: 0.7676301002502441
Epoch: 3, Steps: 52 | Train Loss: 0.5196342 Vali Loss: 1.4799588 Test Loss: 0.4936118
Validation loss decreased (1.699854 --> 1.479959).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 4 cost time: 0.7684495449066162
Epoch: 4, Steps: 52 | Train Loss: 0.4698907 Vali Loss: 1.4230917 Test Loss: 0.4211348
Validation loss decreased (1.479959 --> 1.423092).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 5 cost time: 0.7677373886108398
Epoch: 5, Steps: 52 | Train Loss: 0.4511395 Vali Loss: 1.4067230 Test Loss: 0.4002232
Validation loss decreased (1.423092 --> 1.406723).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 6 cost time: 1.7230861186981201
Epoch: 6, Steps: 52 | Train Loss: 0.4428252 Vali Loss: 1.3924010 Test Loss: 0.3873317
Validation loss decreased (1.406723 --> 1.392401).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 7 cost time: 1.7349915504455566
Epoch: 7, Steps: 52 | Train Loss: 0.4364713 Vali Loss: 1.3816369 Test Loss: 0.3781381
Validation loss decreased (1.392401 --> 1.381637).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 8 cost time: 1.7285125255584717
Epoch: 8, Steps: 52 | Train Loss: 0.4311082 Vali Loss: 1.3652117 Test Loss: 0.3715540
Validation loss decreased (1.381637 --> 1.365212).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 9 cost time: 1.714059829711914
Epoch: 9, Steps: 52 | Train Loss: 0.4293180 Vali Loss: 1.3739543 Test Loss: 0.3665661
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 10 cost time: 1.7257230281829834
Epoch: 10, Steps: 52 | Train Loss: 0.4266189 Vali Loss: 1.3646457 Test Loss: 0.3628696
Validation loss decreased (1.365212 --> 1.364646).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 11 cost time: 1.7246508598327637
Epoch: 11, Steps: 52 | Train Loss: 0.4246276 Vali Loss: 1.3503773 Test Loss: 0.3594315
Validation loss decreased (1.364646 --> 1.350377).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 12 cost time: 1.7269091606140137
Epoch: 12, Steps: 52 | Train Loss: 0.4239316 Vali Loss: 1.3603421 Test Loss: 0.3574845
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 13 cost time: 1.7304294109344482
Epoch: 13, Steps: 52 | Train Loss: 0.4205066 Vali Loss: 1.3489013 Test Loss: 0.3557339
Validation loss decreased (1.350377 --> 1.348901).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 14 cost time: 1.7200403213500977
Epoch: 14, Steps: 52 | Train Loss: 0.4192474 Vali Loss: 1.3492358 Test Loss: 0.3534859
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 15 cost time: 1.7271678447723389
Epoch: 15, Steps: 52 | Train Loss: 0.4192741 Vali Loss: 1.3558712 Test Loss: 0.3520817
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 16 cost time: 1.7254514694213867
Epoch: 16, Steps: 52 | Train Loss: 0.4180915 Vali Loss: 1.3560317 Test Loss: 0.3514179
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 17 cost time: 1.7405574321746826
Epoch: 17, Steps: 52 | Train Loss: 0.4178444 Vali Loss: 1.3491757 Test Loss: 0.3498195
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 18 cost time: 1.727484941482544
Epoch: 18, Steps: 52 | Train Loss: 0.4160612 Vali Loss: 1.3420599 Test Loss: 0.3495222
Validation loss decreased (1.348901 --> 1.342060).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 19 cost time: 1.7200937271118164
Epoch: 19, Steps: 52 | Train Loss: 0.4155067 Vali Loss: 1.3474152 Test Loss: 0.3486117
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 20 cost time: 1.7283923625946045
Epoch: 20, Steps: 52 | Train Loss: 0.4149882 Vali Loss: 1.3429804 Test Loss: 0.3475706
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 21 cost time: 1.727410078048706
Epoch: 21, Steps: 52 | Train Loss: 0.4159597 Vali Loss: 1.3434095 Test Loss: 0.3471215
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 22 cost time: 1.7204704284667969
Epoch: 22, Steps: 52 | Train Loss: 0.4143695 Vali Loss: 1.3450751 Test Loss: 0.3468694
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 23 cost time: 1.7284314632415771
Epoch: 23, Steps: 52 | Train Loss: 0.4123879 Vali Loss: 1.3436537 Test Loss: 0.3466044
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 24 cost time: 1.7240207195281982
Epoch: 24, Steps: 52 | Train Loss: 0.4139417 Vali Loss: 1.3437772 Test Loss: 0.3457307
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 25 cost time: 1.7304015159606934
Epoch: 25, Steps: 52 | Train Loss: 0.4125244 Vali Loss: 1.3365080 Test Loss: 0.3452506
Validation loss decreased (1.342060 --> 1.336508).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 26 cost time: 1.7276098728179932
Epoch: 26, Steps: 52 | Train Loss: 0.4133091 Vali Loss: 1.3437355 Test Loss: 0.3454781
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 27 cost time: 1.7240726947784424
Epoch: 27, Steps: 52 | Train Loss: 0.4131693 Vali Loss: 1.3401527 Test Loss: 0.3447590
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 28 cost time: 1.7090966701507568
Epoch: 28, Steps: 52 | Train Loss: 0.4128537 Vali Loss: 1.3433580 Test Loss: 0.3446387
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 29 cost time: 1.715026617050171
Epoch: 29, Steps: 52 | Train Loss: 0.4126242 Vali Loss: 1.3304456 Test Loss: 0.3446130
Validation loss decreased (1.336508 --> 1.330446).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 30 cost time: 1.7205288410186768
Epoch: 30, Steps: 52 | Train Loss: 0.4130703 Vali Loss: 1.3394145 Test Loss: 0.3444263
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 31 cost time: 1.7193491458892822
Epoch: 31, Steps: 52 | Train Loss: 0.4122209 Vali Loss: 1.3430912 Test Loss: 0.3440422
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 32 cost time: 1.7176251411437988
Epoch: 32, Steps: 52 | Train Loss: 0.4122050 Vali Loss: 1.3375506 Test Loss: 0.3440571
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 33 cost time: 1.710184097290039
Epoch: 33, Steps: 52 | Train Loss: 0.4123352 Vali Loss: 1.3283281 Test Loss: 0.3434792
Validation loss decreased (1.330446 --> 1.328328).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 34 cost time: 1.718374252319336
Epoch: 34, Steps: 52 | Train Loss: 0.4120906 Vali Loss: 1.3286946 Test Loss: 0.3439175
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 35 cost time: 1.7063281536102295
Epoch: 35, Steps: 52 | Train Loss: 0.4140346 Vali Loss: 1.3226871 Test Loss: 0.3438312
Validation loss decreased (1.328328 --> 1.322687).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 36 cost time: 1.7158987522125244
Epoch: 36, Steps: 52 | Train Loss: 0.4124044 Vali Loss: 1.3314149 Test Loss: 0.3432796
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 37 cost time: 1.7177717685699463
Epoch: 37, Steps: 52 | Train Loss: 0.4114555 Vali Loss: 1.3321030 Test Loss: 0.3427701
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 38 cost time: 1.7282662391662598
Epoch: 38, Steps: 52 | Train Loss: 0.4111499 Vali Loss: 1.3303673 Test Loss: 0.3434101
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 39 cost time: 1.7125709056854248
Epoch: 39, Steps: 52 | Train Loss: 0.4115434 Vali Loss: 1.3329620 Test Loss: 0.3427057
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 40 cost time: 1.7112655639648438
Epoch: 40, Steps: 52 | Train Loss: 0.4110589 Vali Loss: 1.3346752 Test Loss: 0.3430067
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 41 cost time: 1.717839002609253
Epoch: 41, Steps: 52 | Train Loss: 0.4108945 Vali Loss: 1.3358145 Test Loss: 0.3433623
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 42 cost time: 1.719113826751709
Epoch: 42, Steps: 52 | Train Loss: 0.4115922 Vali Loss: 1.3393188 Test Loss: 0.3427367
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 43 cost time: 1.7158446311950684
Epoch: 43, Steps: 52 | Train Loss: 0.4114771 Vali Loss: 1.3369646 Test Loss: 0.3428706
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 44 cost time: 1.7174694538116455
Epoch: 44, Steps: 52 | Train Loss: 0.4115781 Vali Loss: 1.3281295 Test Loss: 0.3424499
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 45 cost time: 1.7203869819641113
Epoch: 45, Steps: 52 | Train Loss: 0.4122117 Vali Loss: 1.3353764 Test Loss: 0.3432796
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 46 cost time: 1.7245984077453613
Epoch: 46, Steps: 52 | Train Loss: 0.4108045 Vali Loss: 1.3390951 Test Loss: 0.3427510
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 47 cost time: 1.7232208251953125
Epoch: 47, Steps: 52 | Train Loss: 0.4104485 Vali Loss: 1.3318992 Test Loss: 0.3433679
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 48 cost time: 1.7208950519561768
Epoch: 48, Steps: 52 | Train Loss: 0.4098698 Vali Loss: 1.3355434 Test Loss: 0.3425725
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 49 cost time: 1.7209055423736572
Epoch: 49, Steps: 52 | Train Loss: 0.4116220 Vali Loss: 1.3395913 Test Loss: 0.3429560
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 50 cost time: 1.7237310409545898
Epoch: 50, Steps: 52 | Train Loss: 0.4101694 Vali Loss: 1.3301349 Test Loss: 0.3429584
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 51 cost time: 1.725459337234497
Epoch: 51, Steps: 52 | Train Loss: 0.4104049 Vali Loss: 1.3362261 Test Loss: 0.3420369
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 52 cost time: 1.718414545059204
Epoch: 52, Steps: 52 | Train Loss: 0.4110581 Vali Loss: 1.3323925 Test Loss: 0.3421656
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 53 cost time: 1.7275431156158447
Epoch: 53, Steps: 52 | Train Loss: 0.4088622 Vali Loss: 1.3393886 Test Loss: 0.3428879
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 54 cost time: 1.718885898590088
Epoch: 54, Steps: 52 | Train Loss: 0.4115220 Vali Loss: 1.3320842 Test Loss: 0.3426349
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 55 cost time: 1.7048254013061523
Epoch: 55, Steps: 52 | Train Loss: 0.4108143 Vali Loss: 1.3367753 Test Loss: 0.3423580
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 56 cost time: 1.7118475437164307
Epoch: 56, Steps: 52 | Train Loss: 0.4104755 Vali Loss: 1.3355081 Test Loss: 0.3423216
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 57 cost time: 1.7138702869415283
Epoch: 57, Steps: 52 | Train Loss: 0.4100851 Vali Loss: 1.3295403 Test Loss: 0.3431191
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 58 cost time: 1.72662353515625
Epoch: 58, Steps: 52 | Train Loss: 0.4108962 Vali Loss: 1.3354914 Test Loss: 0.3427715
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 59 cost time: 1.7222654819488525
Epoch: 59, Steps: 52 | Train Loss: 0.4112686 Vali Loss: 1.3297464 Test Loss: 0.3428039
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 60 cost time: 1.7073285579681396
Epoch: 60, Steps: 52 | Train Loss: 0.4105594 Vali Loss: 1.3380340 Test Loss: 0.3419231
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3438311815261841, mae:0.38569748401641846, rse:0.4803761839866638
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04790019989013672 GB
Epoch: 1 cost time: 2.1765174865722656
Epoch: 1, Steps: 52 | Train Loss: 0.7139307 Vali Loss: 2.1651084 Test Loss: 1.4032556
Validation loss decreased (inf --> 2.165108).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 2 cost time: 0.7916357517242432
Epoch: 2, Steps: 52 | Train Loss: 0.6300256 Vali Loss: 1.7098622 Test Loss: 0.8463622
Validation loss decreased (2.165108 --> 1.709862).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 3 cost time: 0.793060302734375
Epoch: 3, Steps: 52 | Train Loss: 0.5058105 Vali Loss: 1.4630075 Test Loss: 0.4876574
Validation loss decreased (1.709862 --> 1.463007).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 4 cost time: 0.7874269485473633
Epoch: 4, Steps: 52 | Train Loss: 0.4559656 Vali Loss: 1.4111750 Test Loss: 0.4182271
Validation loss decreased (1.463007 --> 1.411175).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 5 cost time: 0.9400022029876709
Epoch: 5, Steps: 52 | Train Loss: 0.4421452 Vali Loss: 1.3975915 Test Loss: 0.3999026
Validation loss decreased (1.411175 --> 1.397591).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 6 cost time: 1.782644510269165
Epoch: 6, Steps: 52 | Train Loss: 0.4329646 Vali Loss: 1.3767773 Test Loss: 0.3857414
Validation loss decreased (1.397591 --> 1.376777).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 7 cost time: 1.7932848930358887
Epoch: 7, Steps: 52 | Train Loss: 0.4293544 Vali Loss: 1.3725260 Test Loss: 0.3780286
Validation loss decreased (1.376777 --> 1.372526).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 8 cost time: 1.7795207500457764
Epoch: 8, Steps: 52 | Train Loss: 0.4252044 Vali Loss: 1.3686825 Test Loss: 0.3707749
Validation loss decreased (1.372526 --> 1.368683).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 9 cost time: 1.7866754531860352
Epoch: 9, Steps: 52 | Train Loss: 0.4222868 Vali Loss: 1.3474306 Test Loss: 0.3664772
Validation loss decreased (1.368683 --> 1.347431).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 10 cost time: 1.7790522575378418
Epoch: 10, Steps: 52 | Train Loss: 0.4211919 Vali Loss: 1.3580549 Test Loss: 0.3622562
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 11 cost time: 1.777538537979126
Epoch: 11, Steps: 52 | Train Loss: 0.4176618 Vali Loss: 1.3454981 Test Loss: 0.3589871
Validation loss decreased (1.347431 --> 1.345498).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 12 cost time: 1.7922945022583008
Epoch: 12, Steps: 52 | Train Loss: 0.4188220 Vali Loss: 1.3438427 Test Loss: 0.3564941
Validation loss decreased (1.345498 --> 1.343843).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 13 cost time: 1.7894341945648193
Epoch: 13, Steps: 52 | Train Loss: 0.4156193 Vali Loss: 1.3448931 Test Loss: 0.3557079
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 14 cost time: 1.78822922706604
Epoch: 14, Steps: 52 | Train Loss: 0.4145146 Vali Loss: 1.3385909 Test Loss: 0.3528522
Validation loss decreased (1.343843 --> 1.338591).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 15 cost time: 1.792985439300537
Epoch: 15, Steps: 52 | Train Loss: 0.4146754 Vali Loss: 1.3356836 Test Loss: 0.3519272
Validation loss decreased (1.338591 --> 1.335684).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 16 cost time: 1.803393840789795
Epoch: 16, Steps: 52 | Train Loss: 0.4123997 Vali Loss: 1.3362337 Test Loss: 0.3501436
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 17 cost time: 1.7874422073364258
Epoch: 17, Steps: 52 | Train Loss: 0.4114045 Vali Loss: 1.3377148 Test Loss: 0.3499887
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 18 cost time: 1.794558048248291
Epoch: 18, Steps: 52 | Train Loss: 0.4122998 Vali Loss: 1.3342497 Test Loss: 0.3492232
Validation loss decreased (1.335684 --> 1.334250).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 19 cost time: 1.792217493057251
Epoch: 19, Steps: 52 | Train Loss: 0.4100712 Vali Loss: 1.3328779 Test Loss: 0.3485208
Validation loss decreased (1.334250 --> 1.332878).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 20 cost time: 1.7870595455169678
Epoch: 20, Steps: 52 | Train Loss: 0.4113477 Vali Loss: 1.3314295 Test Loss: 0.3471344
Validation loss decreased (1.332878 --> 1.331429).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 21 cost time: 1.783552885055542
Epoch: 21, Steps: 52 | Train Loss: 0.4114012 Vali Loss: 1.3258514 Test Loss: 0.3472472
Validation loss decreased (1.331429 --> 1.325851).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 22 cost time: 1.7877216339111328
Epoch: 22, Steps: 52 | Train Loss: 0.4103960 Vali Loss: 1.3289353 Test Loss: 0.3468581
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 23 cost time: 1.7924954891204834
Epoch: 23, Steps: 52 | Train Loss: 0.4105800 Vali Loss: 1.3276250 Test Loss: 0.3462707
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 24 cost time: 1.7815628051757812
Epoch: 24, Steps: 52 | Train Loss: 0.4092850 Vali Loss: 1.3280020 Test Loss: 0.3464972
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 25 cost time: 1.787456750869751
Epoch: 25, Steps: 52 | Train Loss: 0.4098794 Vali Loss: 1.3230543 Test Loss: 0.3460136
Validation loss decreased (1.325851 --> 1.323054).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 26 cost time: 1.7881147861480713
Epoch: 26, Steps: 52 | Train Loss: 0.4097358 Vali Loss: 1.3273975 Test Loss: 0.3459827
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 27 cost time: 1.790215015411377
Epoch: 27, Steps: 52 | Train Loss: 0.4092894 Vali Loss: 1.3250782 Test Loss: 0.3457936
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 28 cost time: 1.7860462665557861
Epoch: 28, Steps: 52 | Train Loss: 0.4079841 Vali Loss: 1.3268491 Test Loss: 0.3449758
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 29 cost time: 1.7992889881134033
Epoch: 29, Steps: 52 | Train Loss: 0.4096039 Vali Loss: 1.3235116 Test Loss: 0.3458685
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 30 cost time: 1.7899866104125977
Epoch: 30, Steps: 52 | Train Loss: 0.4108350 Vali Loss: 1.3263271 Test Loss: 0.3451290
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 31 cost time: 1.7941784858703613
Epoch: 31, Steps: 52 | Train Loss: 0.4088377 Vali Loss: 1.3264860 Test Loss: 0.3450671
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 32 cost time: 1.7910211086273193
Epoch: 32, Steps: 52 | Train Loss: 0.4092224 Vali Loss: 1.3159547 Test Loss: 0.3443773
Validation loss decreased (1.323054 --> 1.315955).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 33 cost time: 1.7867810726165771
Epoch: 33, Steps: 52 | Train Loss: 0.4080794 Vali Loss: 1.3289826 Test Loss: 0.3454884
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 34 cost time: 1.7967162132263184
Epoch: 34, Steps: 52 | Train Loss: 0.4077208 Vali Loss: 1.3205525 Test Loss: 0.3456382
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 35 cost time: 1.7893486022949219
Epoch: 35, Steps: 52 | Train Loss: 0.4084525 Vali Loss: 1.3225918 Test Loss: 0.3452869
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 36 cost time: 1.787306785583496
Epoch: 36, Steps: 52 | Train Loss: 0.4090387 Vali Loss: 1.3274164 Test Loss: 0.3440953
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 37 cost time: 1.7789802551269531
Epoch: 37, Steps: 52 | Train Loss: 0.4089464 Vali Loss: 1.3182656 Test Loss: 0.3443276
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 38 cost time: 1.784017562866211
Epoch: 38, Steps: 52 | Train Loss: 0.4088059 Vali Loss: 1.3251965 Test Loss: 0.3443977
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 39 cost time: 1.7904009819030762
Epoch: 39, Steps: 52 | Train Loss: 0.4081005 Vali Loss: 1.3238862 Test Loss: 0.3447529
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 40 cost time: 1.786431074142456
Epoch: 40, Steps: 52 | Train Loss: 0.4084332 Vali Loss: 1.3212653 Test Loss: 0.3448303
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 41 cost time: 1.7875316143035889
Epoch: 41, Steps: 52 | Train Loss: 0.4082788 Vali Loss: 1.3223848 Test Loss: 0.3438826
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 42 cost time: 1.783911943435669
Epoch: 42, Steps: 52 | Train Loss: 0.4065743 Vali Loss: 1.3215282 Test Loss: 0.3441462
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 43 cost time: 1.7794241905212402
Epoch: 43, Steps: 52 | Train Loss: 0.4072564 Vali Loss: 1.3245608 Test Loss: 0.3445764
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 44 cost time: 1.7943060398101807
Epoch: 44, Steps: 52 | Train Loss: 0.4071186 Vali Loss: 1.3235024 Test Loss: 0.3445377
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 45 cost time: 1.7916648387908936
Epoch: 45, Steps: 52 | Train Loss: 0.4096805 Vali Loss: 1.3179817 Test Loss: 0.3441090
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 46 cost time: 1.7903766632080078
Epoch: 46, Steps: 52 | Train Loss: 0.4091718 Vali Loss: 1.3223007 Test Loss: 0.3442641
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 47 cost time: 1.7880382537841797
Epoch: 47, Steps: 52 | Train Loss: 0.4083801 Vali Loss: 1.3136781 Test Loss: 0.3444905
Validation loss decreased (1.315955 --> 1.313678).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 48 cost time: 1.7937304973602295
Epoch: 48, Steps: 52 | Train Loss: 0.4074410 Vali Loss: 1.3261178 Test Loss: 0.3439788
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 49 cost time: 1.7926619052886963
Epoch: 49, Steps: 52 | Train Loss: 0.4093145 Vali Loss: 1.3260403 Test Loss: 0.3448807
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 50 cost time: 1.7931103706359863
Epoch: 50, Steps: 52 | Train Loss: 0.4087684 Vali Loss: 1.3274479 Test Loss: 0.3447026
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 51 cost time: 1.7911081314086914
Epoch: 51, Steps: 52 | Train Loss: 0.4065139 Vali Loss: 1.3276852 Test Loss: 0.3448520
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 52 cost time: 1.7863855361938477
Epoch: 52, Steps: 52 | Train Loss: 0.4084287 Vali Loss: 1.3225188 Test Loss: 0.3444672
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 53 cost time: 1.786686658859253
Epoch: 53, Steps: 52 | Train Loss: 0.4073800 Vali Loss: 1.3140748 Test Loss: 0.3444743
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 54 cost time: 1.7764642238616943
Epoch: 54, Steps: 52 | Train Loss: 0.4071996 Vali Loss: 1.3188671 Test Loss: 0.3451176
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 55 cost time: 1.7884800434112549
Epoch: 55, Steps: 52 | Train Loss: 0.4058067 Vali Loss: 1.3279936 Test Loss: 0.3448098
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 56 cost time: 1.7874455451965332
Epoch: 56, Steps: 52 | Train Loss: 0.4094547 Vali Loss: 1.3138915 Test Loss: 0.3439766
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 57 cost time: 1.7843503952026367
Epoch: 57, Steps: 52 | Train Loss: 0.4073561 Vali Loss: 1.3196509 Test Loss: 0.3439055
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 58 cost time: 1.7827322483062744
Epoch: 58, Steps: 52 | Train Loss: 0.4070326 Vali Loss: 1.3227506 Test Loss: 0.3443054
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 59 cost time: 1.7884376049041748
Epoch: 59, Steps: 52 | Train Loss: 0.4076637 Vali Loss: 1.3200200 Test Loss: 0.3434524
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 60 cost time: 1.7900071144104004
Epoch: 60, Steps: 52 | Train Loss: 0.4080397 Vali Loss: 1.3174763 Test Loss: 0.3439655
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3444904386997223, mae:0.3892801105976105, rse:0.4808364808559418
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.045510292053222656 GB
Epoch: 1 cost time: 2.1521873474121094
Epoch: 1, Steps: 52 | Train Loss: 0.9077505 Vali Loss: 2.4053557 Test Loss: 1.6169438
Validation loss decreased (inf --> 2.405356).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 2 cost time: 0.7603640556335449
Epoch: 2, Steps: 52 | Train Loss: 0.7904824 Vali Loss: 1.8562171 Test Loss: 0.9945564
Validation loss decreased (2.405356 --> 1.856217).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 3 cost time: 0.7657740116119385
Epoch: 3, Steps: 52 | Train Loss: 0.6414730 Vali Loss: 1.5972990 Test Loss: 0.6666040
Validation loss decreased (1.856217 --> 1.597299).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 4 cost time: 0.7519984245300293
Epoch: 4, Steps: 52 | Train Loss: 0.5595493 Vali Loss: 1.4763496 Test Loss: 0.5034951
Validation loss decreased (1.597299 --> 1.476350).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 5 cost time: 0.7552471160888672
Epoch: 5, Steps: 52 | Train Loss: 0.5178625 Vali Loss: 1.4210006 Test Loss: 0.4406676
Validation loss decreased (1.476350 --> 1.421001).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 6 cost time: 1.6949684619903564
Epoch: 6, Steps: 52 | Train Loss: 0.4967382 Vali Loss: 1.4082561 Test Loss: 0.4120309
Validation loss decreased (1.421001 --> 1.408256).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 7 cost time: 1.6930971145629883
Epoch: 7, Steps: 52 | Train Loss: 0.4847746 Vali Loss: 1.3909118 Test Loss: 0.3969816
Validation loss decreased (1.408256 --> 1.390912).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 8 cost time: 1.7051305770874023
Epoch: 8, Steps: 52 | Train Loss: 0.4759881 Vali Loss: 1.3698072 Test Loss: 0.3866938
Validation loss decreased (1.390912 --> 1.369807).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 9 cost time: 1.6893930435180664
Epoch: 9, Steps: 52 | Train Loss: 0.4690587 Vali Loss: 1.3676994 Test Loss: 0.3802973
Validation loss decreased (1.369807 --> 1.367699).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 10 cost time: 1.6964263916015625
Epoch: 10, Steps: 52 | Train Loss: 0.4619793 Vali Loss: 1.3699453 Test Loss: 0.3751943
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 11 cost time: 1.6914384365081787
Epoch: 11, Steps: 52 | Train Loss: 0.4576058 Vali Loss: 1.3657479 Test Loss: 0.3705476
Validation loss decreased (1.367699 --> 1.365748).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 12 cost time: 1.6933345794677734
Epoch: 12, Steps: 52 | Train Loss: 0.4552447 Vali Loss: 1.3602101 Test Loss: 0.3674883
Validation loss decreased (1.365748 --> 1.360210).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 13 cost time: 1.691366195678711
Epoch: 13, Steps: 52 | Train Loss: 0.4517369 Vali Loss: 1.3505613 Test Loss: 0.3648958
Validation loss decreased (1.360210 --> 1.350561).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 14 cost time: 1.6935880184173584
Epoch: 14, Steps: 52 | Train Loss: 0.4496618 Vali Loss: 1.3577287 Test Loss: 0.3629535
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 15 cost time: 1.6886377334594727
Epoch: 15, Steps: 52 | Train Loss: 0.4478146 Vali Loss: 1.3507168 Test Loss: 0.3606359
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 16 cost time: 1.6914911270141602
Epoch: 16, Steps: 52 | Train Loss: 0.4465547 Vali Loss: 1.3477323 Test Loss: 0.3590003
Validation loss decreased (1.350561 --> 1.347732).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 17 cost time: 1.6933014392852783
Epoch: 17, Steps: 52 | Train Loss: 0.4433121 Vali Loss: 1.3420484 Test Loss: 0.3577525
Validation loss decreased (1.347732 --> 1.342048).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 18 cost time: 1.6874611377716064
Epoch: 18, Steps: 52 | Train Loss: 0.4430845 Vali Loss: 1.3486025 Test Loss: 0.3568099
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 19 cost time: 1.6941912174224854
Epoch: 19, Steps: 52 | Train Loss: 0.4432620 Vali Loss: 1.3505642 Test Loss: 0.3559368
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 20 cost time: 1.7096619606018066
Epoch: 20, Steps: 52 | Train Loss: 0.4411006 Vali Loss: 1.3489542 Test Loss: 0.3544832
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 21 cost time: 1.6941897869110107
Epoch: 21, Steps: 52 | Train Loss: 0.4407353 Vali Loss: 1.3431925 Test Loss: 0.3535622
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 22 cost time: 1.6984829902648926
Epoch: 22, Steps: 52 | Train Loss: 0.4392704 Vali Loss: 1.3453786 Test Loss: 0.3527845
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 23 cost time: 1.6954436302185059
Epoch: 23, Steps: 52 | Train Loss: 0.4376528 Vali Loss: 1.3381522 Test Loss: 0.3517587
Validation loss decreased (1.342048 --> 1.338152).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 24 cost time: 1.6980946063995361
Epoch: 24, Steps: 52 | Train Loss: 0.4377830 Vali Loss: 1.3270729 Test Loss: 0.3513018
Validation loss decreased (1.338152 --> 1.327073).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 25 cost time: 1.6845569610595703
Epoch: 25, Steps: 52 | Train Loss: 0.4387457 Vali Loss: 1.3438499 Test Loss: 0.3509870
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 26 cost time: 1.6835103034973145
Epoch: 26, Steps: 52 | Train Loss: 0.4370272 Vali Loss: 1.3388078 Test Loss: 0.3503616
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 27 cost time: 1.6934747695922852
Epoch: 27, Steps: 52 | Train Loss: 0.4367739 Vali Loss: 1.3410282 Test Loss: 0.3499258
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 28 cost time: 1.6940231323242188
Epoch: 28, Steps: 52 | Train Loss: 0.4359578 Vali Loss: 1.3341417 Test Loss: 0.3492634
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 29 cost time: 1.6944591999053955
Epoch: 29, Steps: 52 | Train Loss: 0.4368209 Vali Loss: 1.3348875 Test Loss: 0.3490388
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 30 cost time: 1.7004940509796143
Epoch: 30, Steps: 52 | Train Loss: 0.4348853 Vali Loss: 1.3357974 Test Loss: 0.3485643
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 31 cost time: 1.6992642879486084
Epoch: 31, Steps: 52 | Train Loss: 0.4351998 Vali Loss: 1.3405037 Test Loss: 0.3486331
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 32 cost time: 1.6933841705322266
Epoch: 32, Steps: 52 | Train Loss: 0.4330997 Vali Loss: 1.3386034 Test Loss: 0.3483178
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 33 cost time: 1.6924326419830322
Epoch: 33, Steps: 52 | Train Loss: 0.4332468 Vali Loss: 1.3338343 Test Loss: 0.3483468
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 34 cost time: 1.690861463546753
Epoch: 34, Steps: 52 | Train Loss: 0.4346147 Vali Loss: 1.3261516 Test Loss: 0.3476299
Validation loss decreased (1.327073 --> 1.326152).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 35 cost time: 1.6920740604400635
Epoch: 35, Steps: 52 | Train Loss: 0.4334076 Vali Loss: 1.3341751 Test Loss: 0.3477274
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 36 cost time: 1.6914079189300537
Epoch: 36, Steps: 52 | Train Loss: 0.4328823 Vali Loss: 1.3297254 Test Loss: 0.3475781
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 37 cost time: 1.696073293685913
Epoch: 37, Steps: 52 | Train Loss: 0.4341177 Vali Loss: 1.3398356 Test Loss: 0.3471449
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 38 cost time: 1.6951029300689697
Epoch: 38, Steps: 52 | Train Loss: 0.4322803 Vali Loss: 1.3341217 Test Loss: 0.3475230
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 39 cost time: 1.696434497833252
Epoch: 39, Steps: 52 | Train Loss: 0.4338032 Vali Loss: 1.3323574 Test Loss: 0.3468066
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 40 cost time: 1.6876029968261719
Epoch: 40, Steps: 52 | Train Loss: 0.4334262 Vali Loss: 1.3370209 Test Loss: 0.3470010
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 41 cost time: 1.692826271057129
Epoch: 41, Steps: 52 | Train Loss: 0.4332720 Vali Loss: 1.3388741 Test Loss: 0.3471998
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 42 cost time: 1.6872813701629639
Epoch: 42, Steps: 52 | Train Loss: 0.4334364 Vali Loss: 1.3392828 Test Loss: 0.3468208
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 43 cost time: 1.6876800060272217
Epoch: 43, Steps: 52 | Train Loss: 0.4322350 Vali Loss: 1.3335009 Test Loss: 0.3468896
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 44 cost time: 1.6930184364318848
Epoch: 44, Steps: 52 | Train Loss: 0.4324259 Vali Loss: 1.3353003 Test Loss: 0.3471313
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 45 cost time: 1.6874053478240967
Epoch: 45, Steps: 52 | Train Loss: 0.4354240 Vali Loss: 1.3374780 Test Loss: 0.3463337
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 46 cost time: 1.6901001930236816
Epoch: 46, Steps: 52 | Train Loss: 0.4322322 Vali Loss: 1.3296390 Test Loss: 0.3463983
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 47 cost time: 1.6983790397644043
Epoch: 47, Steps: 52 | Train Loss: 0.4325162 Vali Loss: 1.3265445 Test Loss: 0.3465500
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 48 cost time: 1.685905933380127
Epoch: 48, Steps: 52 | Train Loss: 0.4329985 Vali Loss: 1.3367016 Test Loss: 0.3462599
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 49 cost time: 1.6933574676513672
Epoch: 49, Steps: 52 | Train Loss: 0.4316550 Vali Loss: 1.3342094 Test Loss: 0.3464631
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 50 cost time: 1.6910791397094727
Epoch: 50, Steps: 52 | Train Loss: 0.4322849 Vali Loss: 1.3394308 Test Loss: 0.3463100
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 51 cost time: 1.6922554969787598
Epoch: 51, Steps: 52 | Train Loss: 0.4312682 Vali Loss: 1.3306913 Test Loss: 0.3465047
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 52 cost time: 1.6914536952972412
Epoch: 52, Steps: 52 | Train Loss: 0.4319152 Vali Loss: 1.3398147 Test Loss: 0.3465382
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 53 cost time: 1.6912553310394287
Epoch: 53, Steps: 52 | Train Loss: 0.4324511 Vali Loss: 1.3371353 Test Loss: 0.3465379
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 54 cost time: 1.6945092678070068
Epoch: 54, Steps: 52 | Train Loss: 0.4324952 Vali Loss: 1.3385774 Test Loss: 0.3463626
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 55 cost time: 1.688443660736084
Epoch: 55, Steps: 52 | Train Loss: 0.4304891 Vali Loss: 1.3389223 Test Loss: 0.3466127
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 56 cost time: 1.6885669231414795
Epoch: 56, Steps: 52 | Train Loss: 0.4309538 Vali Loss: 1.3344611 Test Loss: 0.3468139
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 57 cost time: 1.6921966075897217
Epoch: 57, Steps: 52 | Train Loss: 0.4328394 Vali Loss: 1.3295190 Test Loss: 0.3459660
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 58 cost time: 1.6904444694519043
Epoch: 58, Steps: 52 | Train Loss: 0.4335736 Vali Loss: 1.3300482 Test Loss: 0.3461056
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 59 cost time: 1.685072898864746
Epoch: 59, Steps: 52 | Train Loss: 0.4317560 Vali Loss: 1.3384297 Test Loss: 0.3464004
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 60 cost time: 1.695223093032837
Epoch: 60, Steps: 52 | Train Loss: 0.4322044 Vali Loss: 1.3381832 Test Loss: 0.3462871
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3476299047470093, mae:0.38594913482666016, rse:0.4830225110054016
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04694223403930664 GB
Epoch: 1 cost time: 2.1571617126464844
Epoch: 1, Steps: 52 | Train Loss: 0.7625712 Vali Loss: 2.2349222 Test Loss: 1.4675663
Validation loss decreased (inf --> 2.234922).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 2 cost time: 0.785614013671875
Epoch: 2, Steps: 52 | Train Loss: 0.6499311 Vali Loss: 1.6939976 Test Loss: 0.8288555
Validation loss decreased (2.234922 --> 1.693998).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 3 cost time: 0.7896561622619629
Epoch: 3, Steps: 52 | Train Loss: 0.5143932 Vali Loss: 1.4343423 Test Loss: 0.4865043
Validation loss decreased (1.693998 --> 1.434342).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 4 cost time: 0.7784523963928223
Epoch: 4, Steps: 52 | Train Loss: 0.4620678 Vali Loss: 1.3903890 Test Loss: 0.4123096
Validation loss decreased (1.434342 --> 1.390389).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 5 cost time: 0.8207838535308838
Epoch: 5, Steps: 52 | Train Loss: 0.4492654 Vali Loss: 1.3750657 Test Loss: 0.3965466
Validation loss decreased (1.390389 --> 1.375066).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 6 cost time: 1.7253963947296143
Epoch: 6, Steps: 52 | Train Loss: 0.4386925 Vali Loss: 1.3695865 Test Loss: 0.3846388
Validation loss decreased (1.375066 --> 1.369586).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 7 cost time: 1.7350225448608398
Epoch: 7, Steps: 52 | Train Loss: 0.4350320 Vali Loss: 1.3659382 Test Loss: 0.3760662
Validation loss decreased (1.369586 --> 1.365938).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 8 cost time: 1.7394418716430664
Epoch: 8, Steps: 52 | Train Loss: 0.4308511 Vali Loss: 1.3541980 Test Loss: 0.3691620
Validation loss decreased (1.365938 --> 1.354198).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 9 cost time: 1.7315106391906738
Epoch: 9, Steps: 52 | Train Loss: 0.4274139 Vali Loss: 1.3497785 Test Loss: 0.3651654
Validation loss decreased (1.354198 --> 1.349779).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 10 cost time: 1.7402381896972656
Epoch: 10, Steps: 52 | Train Loss: 0.4251632 Vali Loss: 1.3394654 Test Loss: 0.3616257
Validation loss decreased (1.349779 --> 1.339465).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 11 cost time: 1.7295033931732178
Epoch: 11, Steps: 52 | Train Loss: 0.4234112 Vali Loss: 1.3464381 Test Loss: 0.3580828
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 12 cost time: 1.7314400672912598
Epoch: 12, Steps: 52 | Train Loss: 0.4220506 Vali Loss: 1.3441503 Test Loss: 0.3558560
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 13 cost time: 1.731449842453003
Epoch: 13, Steps: 52 | Train Loss: 0.4196018 Vali Loss: 1.3436105 Test Loss: 0.3539264
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 14 cost time: 1.7331256866455078
Epoch: 14, Steps: 52 | Train Loss: 0.4183620 Vali Loss: 1.3320231 Test Loss: 0.3520988
Validation loss decreased (1.339465 --> 1.332023).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 15 cost time: 1.7263422012329102
Epoch: 15, Steps: 52 | Train Loss: 0.4172939 Vali Loss: 1.3351554 Test Loss: 0.3505758
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 16 cost time: 1.7353663444519043
Epoch: 16, Steps: 52 | Train Loss: 0.4166414 Vali Loss: 1.3264930 Test Loss: 0.3492178
Validation loss decreased (1.332023 --> 1.326493).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 17 cost time: 1.732898235321045
Epoch: 17, Steps: 52 | Train Loss: 0.4162091 Vali Loss: 1.3262951 Test Loss: 0.3481187
Validation loss decreased (1.326493 --> 1.326295).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 18 cost time: 1.7445836067199707
Epoch: 18, Steps: 52 | Train Loss: 0.4132944 Vali Loss: 1.3301959 Test Loss: 0.3477374
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 19 cost time: 1.7398195266723633
Epoch: 19, Steps: 52 | Train Loss: 0.4128641 Vali Loss: 1.3316121 Test Loss: 0.3473239
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 20 cost time: 1.7351748943328857
Epoch: 20, Steps: 52 | Train Loss: 0.4143369 Vali Loss: 1.3299751 Test Loss: 0.3466391
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 21 cost time: 1.7479736804962158
Epoch: 21, Steps: 52 | Train Loss: 0.4119657 Vali Loss: 1.3230395 Test Loss: 0.3454670
Validation loss decreased (1.326295 --> 1.323040).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 22 cost time: 1.7387537956237793
Epoch: 22, Steps: 52 | Train Loss: 0.4143373 Vali Loss: 1.3287914 Test Loss: 0.3452346
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 23 cost time: 1.7271442413330078
Epoch: 23, Steps: 52 | Train Loss: 0.4123136 Vali Loss: 1.3224599 Test Loss: 0.3449598
Validation loss decreased (1.323040 --> 1.322460).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 24 cost time: 1.7391431331634521
Epoch: 24, Steps: 52 | Train Loss: 0.4109842 Vali Loss: 1.3266082 Test Loss: 0.3452028
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 25 cost time: 1.7234151363372803
Epoch: 25, Steps: 52 | Train Loss: 0.4124285 Vali Loss: 1.3220354 Test Loss: 0.3445987
Validation loss decreased (1.322460 --> 1.322035).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 26 cost time: 1.731186866760254
Epoch: 26, Steps: 52 | Train Loss: 0.4112104 Vali Loss: 1.3150065 Test Loss: 0.3448815
Validation loss decreased (1.322035 --> 1.315006).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 27 cost time: 1.7319085597991943
Epoch: 27, Steps: 52 | Train Loss: 0.4108666 Vali Loss: 1.3175368 Test Loss: 0.3438516
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 28 cost time: 1.74086594581604
Epoch: 28, Steps: 52 | Train Loss: 0.4102445 Vali Loss: 1.3278575 Test Loss: 0.3440759
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 29 cost time: 1.7370736598968506
Epoch: 29, Steps: 52 | Train Loss: 0.4114452 Vali Loss: 1.3210949 Test Loss: 0.3441262
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 30 cost time: 1.7304785251617432
Epoch: 30, Steps: 52 | Train Loss: 0.4119620 Vali Loss: 1.3143541 Test Loss: 0.3431928
Validation loss decreased (1.315006 --> 1.314354).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 31 cost time: 1.739034652709961
Epoch: 31, Steps: 52 | Train Loss: 0.4116227 Vali Loss: 1.3266497 Test Loss: 0.3435939
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 32 cost time: 1.7372405529022217
Epoch: 32, Steps: 52 | Train Loss: 0.4109737 Vali Loss: 1.3167716 Test Loss: 0.3439730
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 33 cost time: 1.7355074882507324
Epoch: 33, Steps: 52 | Train Loss: 0.4111235 Vali Loss: 1.3219856 Test Loss: 0.3437179
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 34 cost time: 1.7353639602661133
Epoch: 34, Steps: 52 | Train Loss: 0.4092605 Vali Loss: 1.3161201 Test Loss: 0.3436360
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 35 cost time: 1.7345654964447021
Epoch: 35, Steps: 52 | Train Loss: 0.4112675 Vali Loss: 1.3203918 Test Loss: 0.3424721
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 36 cost time: 1.7403514385223389
Epoch: 36, Steps: 52 | Train Loss: 0.4103661 Vali Loss: 1.3234764 Test Loss: 0.3433903
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 37 cost time: 1.7380285263061523
Epoch: 37, Steps: 52 | Train Loss: 0.4101388 Vali Loss: 1.3247532 Test Loss: 0.3427604
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 38 cost time: 1.7395339012145996
Epoch: 38, Steps: 52 | Train Loss: 0.4094242 Vali Loss: 1.3211468 Test Loss: 0.3433524
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 39 cost time: 1.7368664741516113
Epoch: 39, Steps: 52 | Train Loss: 0.4098661 Vali Loss: 1.3224936 Test Loss: 0.3422377
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 40 cost time: 1.7326197624206543
Epoch: 40, Steps: 52 | Train Loss: 0.4107746 Vali Loss: 1.3150887 Test Loss: 0.3433870
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 41 cost time: 1.7294950485229492
Epoch: 41, Steps: 52 | Train Loss: 0.4087793 Vali Loss: 1.3159859 Test Loss: 0.3422976
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 42 cost time: 1.7434227466583252
Epoch: 42, Steps: 52 | Train Loss: 0.4105562 Vali Loss: 1.3144584 Test Loss: 0.3421541
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 43 cost time: 1.7344977855682373
Epoch: 43, Steps: 52 | Train Loss: 0.4110505 Vali Loss: 1.3188398 Test Loss: 0.3427661
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 44 cost time: 1.727738618850708
Epoch: 44, Steps: 52 | Train Loss: 0.4096695 Vali Loss: 1.3239133 Test Loss: 0.3428676
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 45 cost time: 1.7316052913665771
Epoch: 45, Steps: 52 | Train Loss: 0.4099367 Vali Loss: 1.3238308 Test Loss: 0.3431080
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 46 cost time: 1.729478120803833
Epoch: 46, Steps: 52 | Train Loss: 0.4103339 Vali Loss: 1.3121868 Test Loss: 0.3428020
Validation loss decreased (1.314354 --> 1.312187).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 47 cost time: 1.7374348640441895
Epoch: 47, Steps: 52 | Train Loss: 0.4108204 Vali Loss: 1.3221613 Test Loss: 0.3420950
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 48 cost time: 1.738081693649292
Epoch: 48, Steps: 52 | Train Loss: 0.4096863 Vali Loss: 1.3205485 Test Loss: 0.3432050
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 49 cost time: 1.734574556350708
Epoch: 49, Steps: 52 | Train Loss: 0.4069560 Vali Loss: 1.3212856 Test Loss: 0.3427162
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 50 cost time: 1.7365174293518066
Epoch: 50, Steps: 52 | Train Loss: 0.4095332 Vali Loss: 1.3132443 Test Loss: 0.3422917
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 51 cost time: 1.741088628768921
Epoch: 51, Steps: 52 | Train Loss: 0.4104617 Vali Loss: 1.3195966 Test Loss: 0.3425114
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 52 cost time: 1.736459493637085
Epoch: 52, Steps: 52 | Train Loss: 0.4084636 Vali Loss: 1.3146333 Test Loss: 0.3426895
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 53 cost time: 1.7448654174804688
Epoch: 53, Steps: 52 | Train Loss: 0.4093035 Vali Loss: 1.3232667 Test Loss: 0.3424301
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 54 cost time: 1.7388460636138916
Epoch: 54, Steps: 52 | Train Loss: 0.4091605 Vali Loss: 1.3221505 Test Loss: 0.3420820
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 55 cost time: 1.7310962677001953
Epoch: 55, Steps: 52 | Train Loss: 0.4100148 Vali Loss: 1.3148190 Test Loss: 0.3424015
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 56 cost time: 1.740879774093628
Epoch: 56, Steps: 52 | Train Loss: 0.4091136 Vali Loss: 1.3100111 Test Loss: 0.3431540
Validation loss decreased (1.312187 --> 1.310011).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 57 cost time: 1.7385530471801758
Epoch: 57, Steps: 52 | Train Loss: 0.4083470 Vali Loss: 1.3197825 Test Loss: 0.3423726
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 58 cost time: 1.7465238571166992
Epoch: 58, Steps: 52 | Train Loss: 0.4101624 Vali Loss: 1.3216646 Test Loss: 0.3424174
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 59 cost time: 1.736635684967041
Epoch: 59, Steps: 52 | Train Loss: 0.4074734 Vali Loss: 1.3235973 Test Loss: 0.3431382
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 60 cost time: 1.734682559967041
Epoch: 60, Steps: 52 | Train Loss: 0.4091163 Vali Loss: 1.3151340 Test Loss: 0.3420325
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34315404295921326, mae:0.3880862295627594, rse:0.47990289330482483
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.04806232452392578 GB
Epoch: 1 cost time: 2.1989147663116455
Epoch: 1, Steps: 52 | Train Loss: 0.7199213 Vali Loss: 2.2050514 Test Loss: 1.4389448
Validation loss decreased (inf --> 2.205051).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 2 cost time: 0.8043830394744873
Epoch: 2, Steps: 52 | Train Loss: 0.6475734 Vali Loss: 1.8052318 Test Loss: 0.9826813
Validation loss decreased (2.205051 --> 1.805232).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 3 cost time: 0.7980232238769531
Epoch: 3, Steps: 52 | Train Loss: 0.5321436 Vali Loss: 1.5041730 Test Loss: 0.5734023
Validation loss decreased (1.805232 --> 1.504173).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 4 cost time: 0.7997264862060547
Epoch: 4, Steps: 52 | Train Loss: 0.4629521 Vali Loss: 1.4155130 Test Loss: 0.4275229
Validation loss decreased (1.504173 --> 1.415513).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 5 cost time: 1.0346989631652832
Epoch: 5, Steps: 52 | Train Loss: 0.4443065 Vali Loss: 1.3896720 Test Loss: 0.4081827
Validation loss decreased (1.415513 --> 1.389672).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 6 cost time: 1.7860701084136963
Epoch: 6, Steps: 52 | Train Loss: 0.4359747 Vali Loss: 1.3740270 Test Loss: 0.3898583
Validation loss decreased (1.389672 --> 1.374027).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 7 cost time: 1.8072504997253418
Epoch: 7, Steps: 52 | Train Loss: 0.4299947 Vali Loss: 1.3665578 Test Loss: 0.3793526
Validation loss decreased (1.374027 --> 1.366558).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 8 cost time: 1.8039522171020508
Epoch: 8, Steps: 52 | Train Loss: 0.4270891 Vali Loss: 1.3663785 Test Loss: 0.3701352
Validation loss decreased (1.366558 --> 1.366379).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 9 cost time: 1.797480583190918
Epoch: 9, Steps: 52 | Train Loss: 0.4224020 Vali Loss: 1.3599350 Test Loss: 0.3644865
Validation loss decreased (1.366379 --> 1.359935).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 10 cost time: 1.7982361316680908
Epoch: 10, Steps: 52 | Train Loss: 0.4195305 Vali Loss: 1.3490422 Test Loss: 0.3594071
Validation loss decreased (1.359935 --> 1.349042).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 11 cost time: 1.7976763248443604
Epoch: 11, Steps: 52 | Train Loss: 0.4186688 Vali Loss: 1.3508128 Test Loss: 0.3565225
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 12 cost time: 1.7963783740997314
Epoch: 12, Steps: 52 | Train Loss: 0.4166762 Vali Loss: 1.3443789 Test Loss: 0.3531151
Validation loss decreased (1.349042 --> 1.344379).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 13 cost time: 1.8030247688293457
Epoch: 13, Steps: 52 | Train Loss: 0.4143034 Vali Loss: 1.3441031 Test Loss: 0.3519156
Validation loss decreased (1.344379 --> 1.344103).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 14 cost time: 1.7967851161956787
Epoch: 14, Steps: 52 | Train Loss: 0.4137587 Vali Loss: 1.3384082 Test Loss: 0.3499656
Validation loss decreased (1.344103 --> 1.338408).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 15 cost time: 1.793504238128662
Epoch: 15, Steps: 52 | Train Loss: 0.4118725 Vali Loss: 1.3380437 Test Loss: 0.3487106
Validation loss decreased (1.338408 --> 1.338044).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 16 cost time: 1.7948839664459229
Epoch: 16, Steps: 52 | Train Loss: 0.4098382 Vali Loss: 1.3295157 Test Loss: 0.3490799
Validation loss decreased (1.338044 --> 1.329516).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 17 cost time: 1.7940707206726074
Epoch: 17, Steps: 52 | Train Loss: 0.4113939 Vali Loss: 1.3378391 Test Loss: 0.3474041
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 18 cost time: 1.7934086322784424
Epoch: 18, Steps: 52 | Train Loss: 0.4117427 Vali Loss: 1.3269713 Test Loss: 0.3467518
Validation loss decreased (1.329516 --> 1.326971).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 19 cost time: 1.7986607551574707
Epoch: 19, Steps: 52 | Train Loss: 0.4087398 Vali Loss: 1.3238976 Test Loss: 0.3464649
Validation loss decreased (1.326971 --> 1.323898).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 20 cost time: 1.8005142211914062
Epoch: 20, Steps: 52 | Train Loss: 0.4088368 Vali Loss: 1.3344629 Test Loss: 0.3458602
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 21 cost time: 1.7985153198242188
Epoch: 21, Steps: 52 | Train Loss: 0.4095902 Vali Loss: 1.3320599 Test Loss: 0.3445049
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 22 cost time: 1.7942476272583008
Epoch: 22, Steps: 52 | Train Loss: 0.4069747 Vali Loss: 1.3225956 Test Loss: 0.3453504
Validation loss decreased (1.323898 --> 1.322596).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 23 cost time: 1.8020029067993164
Epoch: 23, Steps: 52 | Train Loss: 0.4074525 Vali Loss: 1.3222706 Test Loss: 0.3455234
Validation loss decreased (1.322596 --> 1.322271).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 24 cost time: 1.7930002212524414
Epoch: 24, Steps: 52 | Train Loss: 0.4097725 Vali Loss: 1.3245311 Test Loss: 0.3446766
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 25 cost time: 1.7955188751220703
Epoch: 25, Steps: 52 | Train Loss: 0.4081292 Vali Loss: 1.3251998 Test Loss: 0.3443880
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 26 cost time: 1.7964138984680176
Epoch: 26, Steps: 52 | Train Loss: 0.4080639 Vali Loss: 1.3314248 Test Loss: 0.3452527
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 27 cost time: 1.7961623668670654
Epoch: 27, Steps: 52 | Train Loss: 0.4081411 Vali Loss: 1.3294189 Test Loss: 0.3440571
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 28 cost time: 1.7980504035949707
Epoch: 28, Steps: 52 | Train Loss: 0.4076767 Vali Loss: 1.3273258 Test Loss: 0.3446423
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 29 cost time: 1.802541732788086
Epoch: 29, Steps: 52 | Train Loss: 0.4083188 Vali Loss: 1.3223863 Test Loss: 0.3440965
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 30 cost time: 1.7941689491271973
Epoch: 30, Steps: 52 | Train Loss: 0.4070216 Vali Loss: 1.3230679 Test Loss: 0.3431043
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 31 cost time: 1.8034217357635498
Epoch: 31, Steps: 52 | Train Loss: 0.4070717 Vali Loss: 1.3185446 Test Loss: 0.3429797
Validation loss decreased (1.322271 --> 1.318545).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 32 cost time: 1.79646635055542
Epoch: 32, Steps: 52 | Train Loss: 0.4055185 Vali Loss: 1.3203518 Test Loss: 0.3440790
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 33 cost time: 1.8003933429718018
Epoch: 33, Steps: 52 | Train Loss: 0.4068461 Vali Loss: 1.3276219 Test Loss: 0.3442491
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 34 cost time: 1.7996764183044434
Epoch: 34, Steps: 52 | Train Loss: 0.4072147 Vali Loss: 1.3126481 Test Loss: 0.3425171
Validation loss decreased (1.318545 --> 1.312648).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 35 cost time: 1.79103684425354
Epoch: 35, Steps: 52 | Train Loss: 0.4066659 Vali Loss: 1.3247900 Test Loss: 0.3434637
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 36 cost time: 1.799583911895752
Epoch: 36, Steps: 52 | Train Loss: 0.4057157 Vali Loss: 1.3147554 Test Loss: 0.3444468
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 37 cost time: 1.8059499263763428
Epoch: 37, Steps: 52 | Train Loss: 0.4068654 Vali Loss: 1.3200932 Test Loss: 0.3424132
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 38 cost time: 1.7771241664886475
Epoch: 38, Steps: 52 | Train Loss: 0.4054939 Vali Loss: 1.3207333 Test Loss: 0.3441382
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 39 cost time: 1.785048246383667
Epoch: 39, Steps: 52 | Train Loss: 0.4070424 Vali Loss: 1.3105221 Test Loss: 0.3432264
Validation loss decreased (1.312648 --> 1.310522).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 40 cost time: 1.790968656539917
Epoch: 40, Steps: 52 | Train Loss: 0.4069440 Vali Loss: 1.3248358 Test Loss: 0.3441105
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 41 cost time: 1.7920596599578857
Epoch: 41, Steps: 52 | Train Loss: 0.4065005 Vali Loss: 1.3247919 Test Loss: 0.3427101
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 42 cost time: 1.8310699462890625
Epoch: 42, Steps: 52 | Train Loss: 0.4057636 Vali Loss: 1.3115976 Test Loss: 0.3424103
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 43 cost time: 1.7985577583312988
Epoch: 43, Steps: 52 | Train Loss: 0.4049530 Vali Loss: 1.3259349 Test Loss: 0.3442312
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 44 cost time: 1.7974741458892822
Epoch: 44, Steps: 52 | Train Loss: 0.4053605 Vali Loss: 1.3248370 Test Loss: 0.3434735
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 45 cost time: 1.793632984161377
Epoch: 45, Steps: 52 | Train Loss: 0.4053578 Vali Loss: 1.3198283 Test Loss: 0.3444799
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 46 cost time: 1.8040263652801514
Epoch: 46, Steps: 52 | Train Loss: 0.4049758 Vali Loss: 1.3183578 Test Loss: 0.3426378
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 47 cost time: 1.792328119277954
Epoch: 47, Steps: 52 | Train Loss: 0.4063805 Vali Loss: 1.3183329 Test Loss: 0.3443868
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 48 cost time: 1.7956697940826416
Epoch: 48, Steps: 52 | Train Loss: 0.4078074 Vali Loss: 1.3150811 Test Loss: 0.3442271
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 49 cost time: 1.797295093536377
Epoch: 49, Steps: 52 | Train Loss: 0.4066422 Vali Loss: 1.3130199 Test Loss: 0.3437561
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 50 cost time: 1.7943410873413086
Epoch: 50, Steps: 52 | Train Loss: 0.4046450 Vali Loss: 1.3166856 Test Loss: 0.3435249
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 51 cost time: 1.7963099479675293
Epoch: 51, Steps: 52 | Train Loss: 0.4073165 Vali Loss: 1.3220563 Test Loss: 0.3427636
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 52 cost time: 1.803584337234497
Epoch: 52, Steps: 52 | Train Loss: 0.4063001 Vali Loss: 1.3153501 Test Loss: 0.3433736
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 53 cost time: 1.790548324584961
Epoch: 53, Steps: 52 | Train Loss: 0.4050884 Vali Loss: 1.3224956 Test Loss: 0.3432042
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 54 cost time: 1.7943789958953857
Epoch: 54, Steps: 52 | Train Loss: 0.4070150 Vali Loss: 1.3182034 Test Loss: 0.3423406
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 55 cost time: 1.8011474609375
Epoch: 55, Steps: 52 | Train Loss: 0.4059712 Vali Loss: 1.3136824 Test Loss: 0.3434084
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 56 cost time: 1.7986011505126953
Epoch: 56, Steps: 52 | Train Loss: 0.4050309 Vali Loss: 1.3237331 Test Loss: 0.3434561
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 57 cost time: 1.792759656906128
Epoch: 57, Steps: 52 | Train Loss: 0.4048587 Vali Loss: 1.3255689 Test Loss: 0.3434085
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 58 cost time: 1.7990262508392334
Epoch: 58, Steps: 52 | Train Loss: 0.4046303 Vali Loss: 1.3212295 Test Loss: 0.3437710
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 59 cost time: 1.7978134155273438
Epoch: 59, Steps: 52 | Train Loss: 0.4071376 Vali Loss: 1.3229907 Test Loss: 0.3432140
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 60 cost time: 1.8056676387786865
Epoch: 60, Steps: 52 | Train Loss: 0.4051139 Vali Loss: 1.3098929 Test Loss: 0.3426703
Validation loss decreased (1.310522 --> 1.309893).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3426703214645386, mae:0.39222946763038635, rse:0.47956451773643494
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.045671939849853516 GB
Epoch: 1 cost time: 2.159820079803467
Epoch: 1, Steps: 52 | Train Loss: 0.7627740 Vali Loss: 1.9990460 Test Loss: 1.0376183
Validation loss decreased (inf --> 1.999046).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 2 cost time: 0.7690019607543945
Epoch: 2, Steps: 52 | Train Loss: 0.6772213 Vali Loss: 1.6312861 Test Loss: 0.6611431
Validation loss decreased (1.999046 --> 1.631286).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 3 cost time: 0.7616117000579834
Epoch: 3, Steps: 52 | Train Loss: 0.5827155 Vali Loss: 1.4887524 Test Loss: 0.5133901
Validation loss decreased (1.631286 --> 1.488752).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 4 cost time: 0.7579984664916992
Epoch: 4, Steps: 52 | Train Loss: 0.5339431 Vali Loss: 1.4239187 Test Loss: 0.4427963
Validation loss decreased (1.488752 --> 1.423919).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 5 cost time: 0.7544715404510498
Epoch: 5, Steps: 52 | Train Loss: 0.5073394 Vali Loss: 1.4031584 Test Loss: 0.4101501
Validation loss decreased (1.423919 --> 1.403158).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 6 cost time: 1.6991009712219238
Epoch: 6, Steps: 52 | Train Loss: 0.4905500 Vali Loss: 1.3832754 Test Loss: 0.3939713
Validation loss decreased (1.403158 --> 1.383275).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 7 cost time: 1.699859619140625
Epoch: 7, Steps: 52 | Train Loss: 0.4778329 Vali Loss: 1.3667327 Test Loss: 0.3848655
Validation loss decreased (1.383275 --> 1.366733).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 8 cost time: 1.7049622535705566
Epoch: 8, Steps: 52 | Train Loss: 0.4704283 Vali Loss: 1.3619275 Test Loss: 0.3775532
Validation loss decreased (1.366733 --> 1.361928).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 9 cost time: 1.7006299495697021
Epoch: 9, Steps: 52 | Train Loss: 0.4658606 Vali Loss: 1.3668185 Test Loss: 0.3723667
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 10 cost time: 1.703174352645874
Epoch: 10, Steps: 52 | Train Loss: 0.4614054 Vali Loss: 1.3601737 Test Loss: 0.3677448
Validation loss decreased (1.361928 --> 1.360174).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 11 cost time: 1.7016270160675049
Epoch: 11, Steps: 52 | Train Loss: 0.4589501 Vali Loss: 1.3552378 Test Loss: 0.3639942
Validation loss decreased (1.360174 --> 1.355238).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 12 cost time: 1.6992876529693604
Epoch: 12, Steps: 52 | Train Loss: 0.4551650 Vali Loss: 1.3516164 Test Loss: 0.3613691
Validation loss decreased (1.355238 --> 1.351616).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 13 cost time: 1.7273828983306885
Epoch: 13, Steps: 52 | Train Loss: 0.4508140 Vali Loss: 1.3563523 Test Loss: 0.3591666
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 14 cost time: 1.6665308475494385
Epoch: 14, Steps: 52 | Train Loss: 0.4476701 Vali Loss: 1.3541471 Test Loss: 0.3571298
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 15 cost time: 1.6642820835113525
Epoch: 15, Steps: 52 | Train Loss: 0.4469193 Vali Loss: 1.3468919 Test Loss: 0.3545605
Validation loss decreased (1.351616 --> 1.346892).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 16 cost time: 1.6602022647857666
Epoch: 16, Steps: 52 | Train Loss: 0.4459034 Vali Loss: 1.3451227 Test Loss: 0.3538036
Validation loss decreased (1.346892 --> 1.345123).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 17 cost time: 1.665083885192871
Epoch: 17, Steps: 52 | Train Loss: 0.4441682 Vali Loss: 1.3474170 Test Loss: 0.3523897
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 18 cost time: 1.6675429344177246
Epoch: 18, Steps: 52 | Train Loss: 0.4424926 Vali Loss: 1.3411008 Test Loss: 0.3506544
Validation loss decreased (1.345123 --> 1.341101).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 19 cost time: 1.6766223907470703
Epoch: 19, Steps: 52 | Train Loss: 0.4442826 Vali Loss: 1.3396288 Test Loss: 0.3501942
Validation loss decreased (1.341101 --> 1.339629).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 20 cost time: 1.6704466342926025
Epoch: 20, Steps: 52 | Train Loss: 0.4404394 Vali Loss: 1.3416991 Test Loss: 0.3494699
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 21 cost time: 1.6701605319976807
Epoch: 21, Steps: 52 | Train Loss: 0.4388924 Vali Loss: 1.3396664 Test Loss: 0.3483036
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 22 cost time: 1.6648664474487305
Epoch: 22, Steps: 52 | Train Loss: 0.4381657 Vali Loss: 1.3410964 Test Loss: 0.3475549
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 23 cost time: 1.6720943450927734
Epoch: 23, Steps: 52 | Train Loss: 0.4360142 Vali Loss: 1.3426819 Test Loss: 0.3470432
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 24 cost time: 1.6637945175170898
Epoch: 24, Steps: 52 | Train Loss: 0.4367323 Vali Loss: 1.3398769 Test Loss: 0.3464500
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 25 cost time: 1.670419454574585
Epoch: 25, Steps: 52 | Train Loss: 0.4371561 Vali Loss: 1.3341720 Test Loss: 0.3460400
Validation loss decreased (1.339629 --> 1.334172).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 26 cost time: 1.6681594848632812
Epoch: 26, Steps: 52 | Train Loss: 0.4369238 Vali Loss: 1.3400093 Test Loss: 0.3462499
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 27 cost time: 1.6685457229614258
Epoch: 27, Steps: 52 | Train Loss: 0.4337669 Vali Loss: 1.3396385 Test Loss: 0.3453007
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 28 cost time: 1.6647493839263916
Epoch: 28, Steps: 52 | Train Loss: 0.4333900 Vali Loss: 1.3333827 Test Loss: 0.3445932
Validation loss decreased (1.334172 --> 1.333383).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 29 cost time: 1.664677381515503
Epoch: 29, Steps: 52 | Train Loss: 0.4342592 Vali Loss: 1.3350531 Test Loss: 0.3449126
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 30 cost time: 1.6701815128326416
Epoch: 30, Steps: 52 | Train Loss: 0.4335618 Vali Loss: 1.3357787 Test Loss: 0.3439347
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 31 cost time: 1.6690309047698975
Epoch: 31, Steps: 52 | Train Loss: 0.4330310 Vali Loss: 1.3335567 Test Loss: 0.3433668
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 32 cost time: 1.6668469905853271
Epoch: 32, Steps: 52 | Train Loss: 0.4343227 Vali Loss: 1.3281027 Test Loss: 0.3437518
Validation loss decreased (1.333383 --> 1.328103).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 33 cost time: 1.6718642711639404
Epoch: 33, Steps: 52 | Train Loss: 0.4344011 Vali Loss: 1.3293664 Test Loss: 0.3434838
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 34 cost time: 1.668846607208252
Epoch: 34, Steps: 52 | Train Loss: 0.4321625 Vali Loss: 1.3383400 Test Loss: 0.3437794
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 35 cost time: 1.6692101955413818
Epoch: 35, Steps: 52 | Train Loss: 0.4333298 Vali Loss: 1.3303157 Test Loss: 0.3429913
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 36 cost time: 1.6645901203155518
Epoch: 36, Steps: 52 | Train Loss: 0.4323871 Vali Loss: 1.3384135 Test Loss: 0.3428563
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 37 cost time: 1.6682512760162354
Epoch: 37, Steps: 52 | Train Loss: 0.4337244 Vali Loss: 1.3376148 Test Loss: 0.3431716
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 38 cost time: 1.664163589477539
Epoch: 38, Steps: 52 | Train Loss: 0.4319953 Vali Loss: 1.3363996 Test Loss: 0.3427972
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 39 cost time: 1.6708099842071533
Epoch: 39, Steps: 52 | Train Loss: 0.4329727 Vali Loss: 1.3276494 Test Loss: 0.3426173
Validation loss decreased (1.328103 --> 1.327649).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 40 cost time: 1.6643774509429932
Epoch: 40, Steps: 52 | Train Loss: 0.4336097 Vali Loss: 1.3271523 Test Loss: 0.3425219
Validation loss decreased (1.327649 --> 1.327152).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 41 cost time: 1.669618844985962
Epoch: 41, Steps: 52 | Train Loss: 0.4339324 Vali Loss: 1.3275098 Test Loss: 0.3425269
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 42 cost time: 1.6632308959960938
Epoch: 42, Steps: 52 | Train Loss: 0.4318322 Vali Loss: 1.3273736 Test Loss: 0.3425473
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 43 cost time: 1.6801667213439941
Epoch: 43, Steps: 52 | Train Loss: 0.4329420 Vali Loss: 1.3316031 Test Loss: 0.3424824
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 44 cost time: 1.6839444637298584
Epoch: 44, Steps: 52 | Train Loss: 0.4308741 Vali Loss: 1.3281107 Test Loss: 0.3423784
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 45 cost time: 1.6695423126220703
Epoch: 45, Steps: 52 | Train Loss: 0.4320925 Vali Loss: 1.3294215 Test Loss: 0.3423903
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 46 cost time: 1.669954776763916
Epoch: 46, Steps: 52 | Train Loss: 0.4322562 Vali Loss: 1.3297927 Test Loss: 0.3422141
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 47 cost time: 1.6749775409698486
Epoch: 47, Steps: 52 | Train Loss: 0.4326385 Vali Loss: 1.3325524 Test Loss: 0.3420141
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 48 cost time: 1.665187120437622
Epoch: 48, Steps: 52 | Train Loss: 0.4321262 Vali Loss: 1.3307872 Test Loss: 0.3423988
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 49 cost time: 1.6729826927185059
Epoch: 49, Steps: 52 | Train Loss: 0.4333924 Vali Loss: 1.3227711 Test Loss: 0.3423628
Validation loss decreased (1.327152 --> 1.322771).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 50 cost time: 1.666405439376831
Epoch: 50, Steps: 52 | Train Loss: 0.4321550 Vali Loss: 1.3308260 Test Loss: 0.3420496
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 51 cost time: 1.6684775352478027
Epoch: 51, Steps: 52 | Train Loss: 0.4330559 Vali Loss: 1.3355844 Test Loss: 0.3422199
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 52 cost time: 1.673142433166504
Epoch: 52, Steps: 52 | Train Loss: 0.4309656 Vali Loss: 1.3277545 Test Loss: 0.3423269
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 53 cost time: 1.665865182876587
Epoch: 53, Steps: 52 | Train Loss: 0.4320856 Vali Loss: 1.3288095 Test Loss: 0.3420224
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 54 cost time: 1.6695547103881836
Epoch: 54, Steps: 52 | Train Loss: 0.4314207 Vali Loss: 1.3369402 Test Loss: 0.3421796
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 55 cost time: 1.6810569763183594
Epoch: 55, Steps: 52 | Train Loss: 0.4311604 Vali Loss: 1.3277643 Test Loss: 0.3418628
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 56 cost time: 1.6718473434448242
Epoch: 56, Steps: 52 | Train Loss: 0.4305682 Vali Loss: 1.3259016 Test Loss: 0.3415364
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 57 cost time: 1.66871976852417
Epoch: 57, Steps: 52 | Train Loss: 0.4326206 Vali Loss: 1.3254383 Test Loss: 0.3417147
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 58 cost time: 1.6911239624023438
Epoch: 58, Steps: 52 | Train Loss: 0.4300117 Vali Loss: 1.3317096 Test Loss: 0.3419794
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 59 cost time: 1.6825504302978516
Epoch: 59, Steps: 52 | Train Loss: 0.4315668 Vali Loss: 1.3266103 Test Loss: 0.3417600
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 60 cost time: 1.6853828430175781
Epoch: 60, Steps: 52 | Train Loss: 0.4320410 Vali Loss: 1.3299397 Test Loss: 0.3415069
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34236279129981995, mae:0.3841211795806885, rse:0.4793493151664734
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.0471038818359375 GB
Epoch: 1 cost time: 2.1482479572296143
Epoch: 1, Steps: 52 | Train Loss: 0.7801633 Vali Loss: 2.2938657 Test Loss: 1.5115759
Validation loss decreased (inf --> 2.293866).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 2 cost time: 0.7752814292907715
Epoch: 2, Steps: 52 | Train Loss: 0.6554889 Vali Loss: 1.6993334 Test Loss: 0.7938020
Validation loss decreased (2.293866 --> 1.699333).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 3 cost time: 0.7749977111816406
Epoch: 3, Steps: 52 | Train Loss: 0.5184313 Vali Loss: 1.4775137 Test Loss: 0.4917009
Validation loss decreased (1.699333 --> 1.477514).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 4 cost time: 0.7936313152313232
Epoch: 4, Steps: 52 | Train Loss: 0.4700249 Vali Loss: 1.4240034 Test Loss: 0.4286210
Validation loss decreased (1.477514 --> 1.424003).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 5 cost time: 0.7784469127655029
Epoch: 5, Steps: 52 | Train Loss: 0.4511259 Vali Loss: 1.4040854 Test Loss: 0.4066263
Validation loss decreased (1.424003 --> 1.404085).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 6 cost time: 1.7360541820526123
Epoch: 6, Steps: 52 | Train Loss: 0.4423487 Vali Loss: 1.3817976 Test Loss: 0.3925847
Validation loss decreased (1.404085 --> 1.381798).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 7 cost time: 1.728553295135498
Epoch: 7, Steps: 52 | Train Loss: 0.4370131 Vali Loss: 1.3804500 Test Loss: 0.3826787
Validation loss decreased (1.381798 --> 1.380450).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 8 cost time: 1.7359466552734375
Epoch: 8, Steps: 52 | Train Loss: 0.4291221 Vali Loss: 1.3699694 Test Loss: 0.3749398
Validation loss decreased (1.380450 --> 1.369969).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 9 cost time: 1.7289941310882568
Epoch: 9, Steps: 52 | Train Loss: 0.4277682 Vali Loss: 1.3689698 Test Loss: 0.3694507
Validation loss decreased (1.369969 --> 1.368970).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 10 cost time: 1.7338480949401855
Epoch: 10, Steps: 52 | Train Loss: 0.4250659 Vali Loss: 1.3635204 Test Loss: 0.3650090
Validation loss decreased (1.368970 --> 1.363520).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 11 cost time: 1.7295200824737549
Epoch: 11, Steps: 52 | Train Loss: 0.4226015 Vali Loss: 1.3562150 Test Loss: 0.3614700
Validation loss decreased (1.363520 --> 1.356215).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 12 cost time: 1.7324600219726562
Epoch: 12, Steps: 52 | Train Loss: 0.4203789 Vali Loss: 1.3532608 Test Loss: 0.3586235
Validation loss decreased (1.356215 --> 1.353261).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 13 cost time: 1.7260239124298096
Epoch: 13, Steps: 52 | Train Loss: 0.4181995 Vali Loss: 1.3424766 Test Loss: 0.3570518
Validation loss decreased (1.353261 --> 1.342477).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 14 cost time: 1.7316875457763672
Epoch: 14, Steps: 52 | Train Loss: 0.4177792 Vali Loss: 1.3421562 Test Loss: 0.3551049
Validation loss decreased (1.342477 --> 1.342156).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 15 cost time: 1.7219734191894531
Epoch: 15, Steps: 52 | Train Loss: 0.4169808 Vali Loss: 1.3460901 Test Loss: 0.3535583
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 16 cost time: 1.7373111248016357
Epoch: 16, Steps: 52 | Train Loss: 0.4156519 Vali Loss: 1.3326364 Test Loss: 0.3524855
Validation loss decreased (1.342156 --> 1.332636).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 17 cost time: 1.7280912399291992
Epoch: 17, Steps: 52 | Train Loss: 0.4160654 Vali Loss: 1.3368576 Test Loss: 0.3511784
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 18 cost time: 1.7309679985046387
Epoch: 18, Steps: 52 | Train Loss: 0.4140633 Vali Loss: 1.3415003 Test Loss: 0.3504786
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 19 cost time: 1.73032808303833
Epoch: 19, Steps: 52 | Train Loss: 0.4145164 Vali Loss: 1.3368430 Test Loss: 0.3493221
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 20 cost time: 1.7319860458374023
Epoch: 20, Steps: 52 | Train Loss: 0.4138226 Vali Loss: 1.3342769 Test Loss: 0.3486605
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 21 cost time: 1.7275316715240479
Epoch: 21, Steps: 52 | Train Loss: 0.4137980 Vali Loss: 1.3365579 Test Loss: 0.3477934
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 22 cost time: 1.7302501201629639
Epoch: 22, Steps: 52 | Train Loss: 0.4119780 Vali Loss: 1.3313925 Test Loss: 0.3470834
Validation loss decreased (1.332636 --> 1.331393).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 23 cost time: 1.7302160263061523
Epoch: 23, Steps: 52 | Train Loss: 0.4113337 Vali Loss: 1.3277242 Test Loss: 0.3462489
Validation loss decreased (1.331393 --> 1.327724).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 24 cost time: 1.7256138324737549
Epoch: 24, Steps: 52 | Train Loss: 0.4132478 Vali Loss: 1.3300182 Test Loss: 0.3465751
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 25 cost time: 1.728830337524414
Epoch: 25, Steps: 52 | Train Loss: 0.4118010 Vali Loss: 1.3246686 Test Loss: 0.3456847
Validation loss decreased (1.327724 --> 1.324669).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 26 cost time: 1.7361772060394287
Epoch: 26, Steps: 52 | Train Loss: 0.4114154 Vali Loss: 1.3284150 Test Loss: 0.3458269
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 27 cost time: 1.7312121391296387
Epoch: 27, Steps: 52 | Train Loss: 0.4095652 Vali Loss: 1.3303603 Test Loss: 0.3453614
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 28 cost time: 1.7254283428192139
Epoch: 28, Steps: 52 | Train Loss: 0.4112772 Vali Loss: 1.3326042 Test Loss: 0.3453968
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 29 cost time: 1.728468894958496
Epoch: 29, Steps: 52 | Train Loss: 0.4088621 Vali Loss: 1.3229713 Test Loss: 0.3447691
Validation loss decreased (1.324669 --> 1.322971).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 30 cost time: 1.729794979095459
Epoch: 30, Steps: 52 | Train Loss: 0.4113773 Vali Loss: 1.3309475 Test Loss: 0.3450169
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 31 cost time: 1.7314553260803223
Epoch: 31, Steps: 52 | Train Loss: 0.4110669 Vali Loss: 1.3238096 Test Loss: 0.3446995
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 32 cost time: 1.7229242324829102
Epoch: 32, Steps: 52 | Train Loss: 0.4106423 Vali Loss: 1.3319210 Test Loss: 0.3449183
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 33 cost time: 1.7194328308105469
Epoch: 33, Steps: 52 | Train Loss: 0.4105839 Vali Loss: 1.3246479 Test Loss: 0.3444976
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 34 cost time: 1.727114200592041
Epoch: 34, Steps: 52 | Train Loss: 0.4106812 Vali Loss: 1.3276998 Test Loss: 0.3445772
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 35 cost time: 1.739231824874878
Epoch: 35, Steps: 52 | Train Loss: 0.4097947 Vali Loss: 1.3247569 Test Loss: 0.3442323
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 36 cost time: 1.7306475639343262
Epoch: 36, Steps: 52 | Train Loss: 0.4107135 Vali Loss: 1.3268616 Test Loss: 0.3442678
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 37 cost time: 1.731682538986206
Epoch: 37, Steps: 52 | Train Loss: 0.4097121 Vali Loss: 1.3278949 Test Loss: 0.3438783
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 38 cost time: 1.7247934341430664
Epoch: 38, Steps: 52 | Train Loss: 0.4100572 Vali Loss: 1.3160450 Test Loss: 0.3440493
Validation loss decreased (1.322971 --> 1.316045).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 39 cost time: 1.727081298828125
Epoch: 39, Steps: 52 | Train Loss: 0.4096911 Vali Loss: 1.3226359 Test Loss: 0.3435032
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 40 cost time: 1.7283604145050049
Epoch: 40, Steps: 52 | Train Loss: 0.4110243 Vali Loss: 1.3183964 Test Loss: 0.3437358
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 41 cost time: 1.7312602996826172
Epoch: 41, Steps: 52 | Train Loss: 0.4100340 Vali Loss: 1.3287082 Test Loss: 0.3437006
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 42 cost time: 1.7341563701629639
Epoch: 42, Steps: 52 | Train Loss: 0.4093555 Vali Loss: 1.3264629 Test Loss: 0.3437135
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 43 cost time: 1.7332990169525146
Epoch: 43, Steps: 52 | Train Loss: 0.4067978 Vali Loss: 1.3266839 Test Loss: 0.3434051
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 44 cost time: 1.7370893955230713
Epoch: 44, Steps: 52 | Train Loss: 0.4079878 Vali Loss: 1.3233356 Test Loss: 0.3426653
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 45 cost time: 1.7375285625457764
Epoch: 45, Steps: 52 | Train Loss: 0.4088477 Vali Loss: 1.3253860 Test Loss: 0.3435774
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 46 cost time: 1.734710454940796
Epoch: 46, Steps: 52 | Train Loss: 0.4095460 Vali Loss: 1.3223488 Test Loss: 0.3434865
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 47 cost time: 1.7315089702606201
Epoch: 47, Steps: 52 | Train Loss: 0.4103669 Vali Loss: 1.3240025 Test Loss: 0.3430158
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 48 cost time: 1.7313928604125977
Epoch: 48, Steps: 52 | Train Loss: 0.4097422 Vali Loss: 1.3205280 Test Loss: 0.3432169
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 49 cost time: 1.7304623126983643
Epoch: 49, Steps: 52 | Train Loss: 0.4087793 Vali Loss: 1.3214972 Test Loss: 0.3437009
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 50 cost time: 1.7373237609863281
Epoch: 50, Steps: 52 | Train Loss: 0.4086998 Vali Loss: 1.3182210 Test Loss: 0.3427295
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 51 cost time: 1.7386870384216309
Epoch: 51, Steps: 52 | Train Loss: 0.4095055 Vali Loss: 1.3205544 Test Loss: 0.3430590
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 52 cost time: 1.7411751747131348
Epoch: 52, Steps: 52 | Train Loss: 0.4086094 Vali Loss: 1.3218627 Test Loss: 0.3429460
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 53 cost time: 1.7386095523834229
Epoch: 53, Steps: 52 | Train Loss: 0.4100077 Vali Loss: 1.3221335 Test Loss: 0.3430090
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 54 cost time: 1.73203444480896
Epoch: 54, Steps: 52 | Train Loss: 0.4084308 Vali Loss: 1.3233681 Test Loss: 0.3434858
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 55 cost time: 1.7320053577423096
Epoch: 55, Steps: 52 | Train Loss: 0.4080759 Vali Loss: 1.3214500 Test Loss: 0.3439499
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 56 cost time: 1.7327983379364014
Epoch: 56, Steps: 52 | Train Loss: 0.4093086 Vali Loss: 1.3280852 Test Loss: 0.3434904
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 57 cost time: 1.7346556186676025
Epoch: 57, Steps: 52 | Train Loss: 0.4091676 Vali Loss: 1.3088870 Test Loss: 0.3426892
Validation loss decreased (1.316045 --> 1.308887).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 58 cost time: 1.733377456665039
Epoch: 58, Steps: 52 | Train Loss: 0.4092426 Vali Loss: 1.3239893 Test Loss: 0.3430879
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 59 cost time: 1.7355856895446777
Epoch: 59, Steps: 52 | Train Loss: 0.4065127 Vali Loss: 1.3214893 Test Loss: 0.3429274
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 60 cost time: 1.7272419929504395
Epoch: 60, Steps: 52 | Train Loss: 0.4095600 Vali Loss: 1.3244859 Test Loss: 0.3435106
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34268918633461, mae:0.3877233564853668, rse:0.4795777201652527
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.04822397232055664 GB
Epoch: 1 cost time: 2.186089515686035
Epoch: 1, Steps: 52 | Train Loss: 0.7411159 Vali Loss: 2.2364688 Test Loss: 1.5077953
Validation loss decreased (inf --> 2.236469).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 2 cost time: 0.8059999942779541
Epoch: 2, Steps: 52 | Train Loss: 0.6553404 Vali Loss: 1.7819009 Test Loss: 0.9543169
Validation loss decreased (2.236469 --> 1.781901).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 3 cost time: 0.8062310218811035
Epoch: 3, Steps: 52 | Train Loss: 0.5202264 Vali Loss: 1.4682242 Test Loss: 0.5109760
Validation loss decreased (1.781901 --> 1.468224).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 4 cost time: 0.8043479919433594
Epoch: 4, Steps: 52 | Train Loss: 0.4549815 Vali Loss: 1.3910480 Test Loss: 0.4077475
Validation loss decreased (1.468224 --> 1.391048).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 5 cost time: 1.007218599319458
Epoch: 5, Steps: 52 | Train Loss: 0.4370660 Vali Loss: 1.3746247 Test Loss: 0.3876333
Validation loss decreased (1.391048 --> 1.374625).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 6 cost time: 1.7771713733673096
Epoch: 6, Steps: 52 | Train Loss: 0.4277612 Vali Loss: 1.3693861 Test Loss: 0.3728638
Validation loss decreased (1.374625 --> 1.369386).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 7 cost time: 1.7842602729797363
Epoch: 7, Steps: 52 | Train Loss: 0.4226736 Vali Loss: 1.3573856 Test Loss: 0.3642655
Validation loss decreased (1.369386 --> 1.357386).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 8 cost time: 1.77561354637146
Epoch: 8, Steps: 52 | Train Loss: 0.4181394 Vali Loss: 1.3525661 Test Loss: 0.3599480
Validation loss decreased (1.357386 --> 1.352566).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 9 cost time: 1.7852239608764648
Epoch: 9, Steps: 52 | Train Loss: 0.4177645 Vali Loss: 1.3441575 Test Loss: 0.3557801
Validation loss decreased (1.352566 --> 1.344157).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 10 cost time: 1.7807369232177734
Epoch: 10, Steps: 52 | Train Loss: 0.4161937 Vali Loss: 1.3448907 Test Loss: 0.3529871
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 11 cost time: 1.7778289318084717
Epoch: 11, Steps: 52 | Train Loss: 0.4134887 Vali Loss: 1.3477252 Test Loss: 0.3509179
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 12 cost time: 1.7789413928985596
Epoch: 12, Steps: 52 | Train Loss: 0.4109936 Vali Loss: 1.3323200 Test Loss: 0.3488396
Validation loss decreased (1.344157 --> 1.332320).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 13 cost time: 1.785630702972412
Epoch: 13, Steps: 52 | Train Loss: 0.4104695 Vali Loss: 1.3321536 Test Loss: 0.3475082
Validation loss decreased (1.332320 --> 1.332154).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 14 cost time: 1.7827861309051514
Epoch: 14, Steps: 52 | Train Loss: 0.4105227 Vali Loss: 1.3370435 Test Loss: 0.3467944
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 15 cost time: 1.7793900966644287
Epoch: 15, Steps: 52 | Train Loss: 0.4084056 Vali Loss: 1.3310611 Test Loss: 0.3451183
Validation loss decreased (1.332154 --> 1.331061).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 16 cost time: 1.783738613128662
Epoch: 16, Steps: 52 | Train Loss: 0.4078639 Vali Loss: 1.3178513 Test Loss: 0.3451913
Validation loss decreased (1.331061 --> 1.317851).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 17 cost time: 1.7899878025054932
Epoch: 17, Steps: 52 | Train Loss: 0.4090032 Vali Loss: 1.3310728 Test Loss: 0.3434942
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 18 cost time: 1.7833073139190674
Epoch: 18, Steps: 52 | Train Loss: 0.4080932 Vali Loss: 1.3314452 Test Loss: 0.3431870
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 19 cost time: 1.7832751274108887
Epoch: 19, Steps: 52 | Train Loss: 0.4067312 Vali Loss: 1.3209219 Test Loss: 0.3432435
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 20 cost time: 1.7841296195983887
Epoch: 20, Steps: 52 | Train Loss: 0.4046256 Vali Loss: 1.3309575 Test Loss: 0.3427610
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 21 cost time: 1.7810430526733398
Epoch: 21, Steps: 52 | Train Loss: 0.4051171 Vali Loss: 1.3269796 Test Loss: 0.3420625
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 22 cost time: 1.7832202911376953
Epoch: 22, Steps: 52 | Train Loss: 0.4063981 Vali Loss: 1.3331975 Test Loss: 0.3420918
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 23 cost time: 1.7756664752960205
Epoch: 23, Steps: 52 | Train Loss: 0.4051898 Vali Loss: 1.3298137 Test Loss: 0.3415866
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 24 cost time: 1.776641607284546
Epoch: 24, Steps: 52 | Train Loss: 0.4062839 Vali Loss: 1.3280027 Test Loss: 0.3409474
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 25 cost time: 1.7766780853271484
Epoch: 25, Steps: 52 | Train Loss: 0.4041526 Vali Loss: 1.3235135 Test Loss: 0.3409509
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 26 cost time: 1.7742867469787598
Epoch: 26, Steps: 52 | Train Loss: 0.4050890 Vali Loss: 1.3297819 Test Loss: 0.3406573
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 27 cost time: 1.7932255268096924
Epoch: 27, Steps: 52 | Train Loss: 0.4052681 Vali Loss: 1.3317339 Test Loss: 0.3404660
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 28 cost time: 1.7864720821380615
Epoch: 28, Steps: 52 | Train Loss: 0.4050810 Vali Loss: 1.3199502 Test Loss: 0.3398926
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 29 cost time: 1.7771341800689697
Epoch: 29, Steps: 52 | Train Loss: 0.4060026 Vali Loss: 1.3210437 Test Loss: 0.3396934
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 30 cost time: 1.7694315910339355
Epoch: 30, Steps: 52 | Train Loss: 0.4029213 Vali Loss: 1.3245898 Test Loss: 0.3394420
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 31 cost time: 1.773416519165039
Epoch: 31, Steps: 52 | Train Loss: 0.4035788 Vali Loss: 1.3244407 Test Loss: 0.3399585
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 32 cost time: 1.772270917892456
Epoch: 32, Steps: 52 | Train Loss: 0.4049181 Vali Loss: 1.3244938 Test Loss: 0.3391289
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 33 cost time: 1.7780659198760986
Epoch: 33, Steps: 52 | Train Loss: 0.4038612 Vali Loss: 1.3264048 Test Loss: 0.3392749
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 34 cost time: 1.7777009010314941
Epoch: 34, Steps: 52 | Train Loss: 0.4041161 Vali Loss: 1.3211125 Test Loss: 0.3388595
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 35 cost time: 1.7784926891326904
Epoch: 35, Steps: 52 | Train Loss: 0.4044068 Vali Loss: 1.3241805 Test Loss: 0.3391539
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 36 cost time: 1.7767574787139893
Epoch: 36, Steps: 52 | Train Loss: 0.4038732 Vali Loss: 1.3263365 Test Loss: 0.3388610
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 37 cost time: 1.7864935398101807
Epoch: 37, Steps: 52 | Train Loss: 0.4027593 Vali Loss: 1.3204579 Test Loss: 0.3388101
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 38 cost time: 1.781794548034668
Epoch: 38, Steps: 52 | Train Loss: 0.4040516 Vali Loss: 1.3204709 Test Loss: 0.3386382
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 39 cost time: 1.7728991508483887
Epoch: 39, Steps: 52 | Train Loss: 0.4023934 Vali Loss: 1.3292470 Test Loss: 0.3392333
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 40 cost time: 1.7755279541015625
Epoch: 40, Steps: 52 | Train Loss: 0.4043033 Vali Loss: 1.3182459 Test Loss: 0.3387786
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 41 cost time: 1.7780022621154785
Epoch: 41, Steps: 52 | Train Loss: 0.4043190 Vali Loss: 1.3131857 Test Loss: 0.3378567
Validation loss decreased (1.317851 --> 1.313186).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 42 cost time: 1.7764520645141602
Epoch: 42, Steps: 52 | Train Loss: 0.4032986 Vali Loss: 1.3233929 Test Loss: 0.3382427
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 43 cost time: 1.7764315605163574
Epoch: 43, Steps: 52 | Train Loss: 0.4033482 Vali Loss: 1.3230505 Test Loss: 0.3384822
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 44 cost time: 1.7745542526245117
Epoch: 44, Steps: 52 | Train Loss: 0.4043464 Vali Loss: 1.3095772 Test Loss: 0.3385437
Validation loss decreased (1.313186 --> 1.309577).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 45 cost time: 1.7721810340881348
Epoch: 45, Steps: 52 | Train Loss: 0.4037295 Vali Loss: 1.3157787 Test Loss: 0.3380194
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 46 cost time: 1.7782225608825684
Epoch: 46, Steps: 52 | Train Loss: 0.4026771 Vali Loss: 1.3270441 Test Loss: 0.3386706
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 47 cost time: 1.7771720886230469
Epoch: 47, Steps: 52 | Train Loss: 0.4032533 Vali Loss: 1.3200088 Test Loss: 0.3389701
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 48 cost time: 1.7739009857177734
Epoch: 48, Steps: 52 | Train Loss: 0.4043317 Vali Loss: 1.3224193 Test Loss: 0.3383448
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 49 cost time: 1.7799901962280273
Epoch: 49, Steps: 52 | Train Loss: 0.4033455 Vali Loss: 1.3174591 Test Loss: 0.3385519
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 50 cost time: 1.7759578227996826
Epoch: 50, Steps: 52 | Train Loss: 0.4034175 Vali Loss: 1.3183991 Test Loss: 0.3388267
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 51 cost time: 1.7834291458129883
Epoch: 51, Steps: 52 | Train Loss: 0.4028264 Vali Loss: 1.3230131 Test Loss: 0.3382227
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 52 cost time: 1.777494192123413
Epoch: 52, Steps: 52 | Train Loss: 0.4027220 Vali Loss: 1.3275957 Test Loss: 0.3384985
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 53 cost time: 1.786916732788086
Epoch: 53, Steps: 52 | Train Loss: 0.4041910 Vali Loss: 1.3223479 Test Loss: 0.3386663
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 54 cost time: 1.777184009552002
Epoch: 54, Steps: 52 | Train Loss: 0.4044174 Vali Loss: 1.3087803 Test Loss: 0.3385062
Validation loss decreased (1.309577 --> 1.308780).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 55 cost time: 1.7814791202545166
Epoch: 55, Steps: 52 | Train Loss: 0.4036538 Vali Loss: 1.3248545 Test Loss: 0.3382317
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 56 cost time: 1.7785096168518066
Epoch: 56, Steps: 52 | Train Loss: 0.4038009 Vali Loss: 1.3237065 Test Loss: 0.3389489
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 57 cost time: 1.7781169414520264
Epoch: 57, Steps: 52 | Train Loss: 0.4031366 Vali Loss: 1.3195964 Test Loss: 0.3384587
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 58 cost time: 1.7763748168945312
Epoch: 58, Steps: 52 | Train Loss: 0.4032480 Vali Loss: 1.3269628 Test Loss: 0.3378508
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 59 cost time: 1.7823448181152344
Epoch: 59, Steps: 52 | Train Loss: 0.4049720 Vali Loss: 1.3230815 Test Loss: 0.3384902
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 60 cost time: 1.7826340198516846
Epoch: 60, Steps: 52 | Train Loss: 0.4030807 Vali Loss: 1.3257970 Test Loss: 0.3381781
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33850619196891785, mae:0.38359424471855164, rse:0.47664177417755127
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04583406448364258 GB
Epoch: 1 cost time: 2.1317529678344727
Epoch: 1, Steps: 52 | Train Loss: 0.8952711 Vali Loss: 2.4233212 Test Loss: 1.5533242
Validation loss decreased (inf --> 2.423321).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 2 cost time: 0.7556362152099609
Epoch: 2, Steps: 52 | Train Loss: 0.7464498 Vali Loss: 1.7688733 Test Loss: 0.8232768
Validation loss decreased (2.423321 --> 1.768873).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 3 cost time: 0.7624285221099854
Epoch: 3, Steps: 52 | Train Loss: 0.5920288 Vali Loss: 1.5462307 Test Loss: 0.5667822
Validation loss decreased (1.768873 --> 1.546231).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 4 cost time: 0.7649731636047363
Epoch: 4, Steps: 52 | Train Loss: 0.5332099 Vali Loss: 1.4560740 Test Loss: 0.4657061
Validation loss decreased (1.546231 --> 1.456074).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 5 cost time: 0.7461061477661133
Epoch: 5, Steps: 52 | Train Loss: 0.5005833 Vali Loss: 1.4115598 Test Loss: 0.4272249
Validation loss decreased (1.456074 --> 1.411560).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 6 cost time: 1.6862077713012695
Epoch: 6, Steps: 52 | Train Loss: 0.4837372 Vali Loss: 1.3963808 Test Loss: 0.4053151
Validation loss decreased (1.411560 --> 1.396381).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 7 cost time: 1.702392578125
Epoch: 7, Steps: 52 | Train Loss: 0.4744628 Vali Loss: 1.3780925 Test Loss: 0.3920043
Validation loss decreased (1.396381 --> 1.378093).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 8 cost time: 1.6878445148468018
Epoch: 8, Steps: 52 | Train Loss: 0.4649922 Vali Loss: 1.3618524 Test Loss: 0.3808558
Validation loss decreased (1.378093 --> 1.361852).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 9 cost time: 1.6904339790344238
Epoch: 9, Steps: 52 | Train Loss: 0.4603998 Vali Loss: 1.3613632 Test Loss: 0.3735381
Validation loss decreased (1.361852 --> 1.361363).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 10 cost time: 1.6839661598205566
Epoch: 10, Steps: 52 | Train Loss: 0.4531015 Vali Loss: 1.3553867 Test Loss: 0.3680717
Validation loss decreased (1.361363 --> 1.355387).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 11 cost time: 1.6813092231750488
Epoch: 11, Steps: 52 | Train Loss: 0.4523314 Vali Loss: 1.3545069 Test Loss: 0.3637379
Validation loss decreased (1.355387 --> 1.354507).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 12 cost time: 1.6894659996032715
Epoch: 12, Steps: 52 | Train Loss: 0.4471708 Vali Loss: 1.3479885 Test Loss: 0.3596414
Validation loss decreased (1.354507 --> 1.347988).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 13 cost time: 1.6906359195709229
Epoch: 13, Steps: 52 | Train Loss: 0.4444003 Vali Loss: 1.3493166 Test Loss: 0.3573306
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 14 cost time: 1.6909215450286865
Epoch: 14, Steps: 52 | Train Loss: 0.4420497 Vali Loss: 1.3447568 Test Loss: 0.3549103
Validation loss decreased (1.347988 --> 1.344757).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 15 cost time: 1.6848328113555908
Epoch: 15, Steps: 52 | Train Loss: 0.4424119 Vali Loss: 1.3475981 Test Loss: 0.3530892
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 16 cost time: 1.6936163902282715
Epoch: 16, Steps: 52 | Train Loss: 0.4372871 Vali Loss: 1.3507878 Test Loss: 0.3516815
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 17 cost time: 1.6905097961425781
Epoch: 17, Steps: 52 | Train Loss: 0.4364185 Vali Loss: 1.3391089 Test Loss: 0.3497838
Validation loss decreased (1.344757 --> 1.339109).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 18 cost time: 1.7017607688903809
Epoch: 18, Steps: 52 | Train Loss: 0.4356593 Vali Loss: 1.3393985 Test Loss: 0.3489000
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 19 cost time: 1.707385778427124
Epoch: 19, Steps: 52 | Train Loss: 0.4358491 Vali Loss: 1.3398733 Test Loss: 0.3480979
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 20 cost time: 1.6949381828308105
Epoch: 20, Steps: 52 | Train Loss: 0.4356064 Vali Loss: 1.3391969 Test Loss: 0.3474064
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 21 cost time: 1.6814508438110352
Epoch: 21, Steps: 52 | Train Loss: 0.4343223 Vali Loss: 1.3417221 Test Loss: 0.3467070
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 22 cost time: 1.695913553237915
Epoch: 22, Steps: 52 | Train Loss: 0.4331220 Vali Loss: 1.3334415 Test Loss: 0.3458496
Validation loss decreased (1.339109 --> 1.333441).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 23 cost time: 1.7976486682891846
Epoch: 23, Steps: 52 | Train Loss: 0.4323015 Vali Loss: 1.3373582 Test Loss: 0.3452848
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 24 cost time: 1.689279317855835
Epoch: 24, Steps: 52 | Train Loss: 0.4314633 Vali Loss: 1.3264806 Test Loss: 0.3447816
Validation loss decreased (1.333441 --> 1.326481).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 25 cost time: 1.6831154823303223
Epoch: 25, Steps: 52 | Train Loss: 0.4303559 Vali Loss: 1.3294703 Test Loss: 0.3442504
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 26 cost time: 1.6889421939849854
Epoch: 26, Steps: 52 | Train Loss: 0.4319430 Vali Loss: 1.3348814 Test Loss: 0.3438166
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 27 cost time: 1.6811883449554443
Epoch: 27, Steps: 52 | Train Loss: 0.4306486 Vali Loss: 1.3366036 Test Loss: 0.3437446
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 28 cost time: 1.6847591400146484
Epoch: 28, Steps: 52 | Train Loss: 0.4289225 Vali Loss: 1.3344259 Test Loss: 0.3433806
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 29 cost time: 1.688887596130371
Epoch: 29, Steps: 52 | Train Loss: 0.4298435 Vali Loss: 1.3353200 Test Loss: 0.3429208
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 30 cost time: 1.6901249885559082
Epoch: 30, Steps: 52 | Train Loss: 0.4301641 Vali Loss: 1.3384855 Test Loss: 0.3424113
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 31 cost time: 1.679225206375122
Epoch: 31, Steps: 52 | Train Loss: 0.4294252 Vali Loss: 1.3341291 Test Loss: 0.3425144
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 32 cost time: 1.688328742980957
Epoch: 32, Steps: 52 | Train Loss: 0.4296795 Vali Loss: 1.3391355 Test Loss: 0.3423645
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 33 cost time: 1.6948106288909912
Epoch: 33, Steps: 52 | Train Loss: 0.4281383 Vali Loss: 1.3360972 Test Loss: 0.3419193
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 34 cost time: 1.6903655529022217
Epoch: 34, Steps: 52 | Train Loss: 0.4261305 Vali Loss: 1.3363097 Test Loss: 0.3424128
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 35 cost time: 1.691802740097046
Epoch: 35, Steps: 52 | Train Loss: 0.4280167 Vali Loss: 1.3271031 Test Loss: 0.3418175
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 36 cost time: 1.6801486015319824
Epoch: 36, Steps: 52 | Train Loss: 0.4260211 Vali Loss: 1.3341211 Test Loss: 0.3414854
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 37 cost time: 1.6837265491485596
Epoch: 37, Steps: 52 | Train Loss: 0.4275305 Vali Loss: 1.3273921 Test Loss: 0.3418412
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 38 cost time: 1.697080135345459
Epoch: 38, Steps: 52 | Train Loss: 0.4275047 Vali Loss: 1.3259906 Test Loss: 0.3412795
Validation loss decreased (1.326481 --> 1.325991).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 39 cost time: 1.688692569732666
Epoch: 39, Steps: 52 | Train Loss: 0.4265700 Vali Loss: 1.3220460 Test Loss: 0.3408842
Validation loss decreased (1.325991 --> 1.322046).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 40 cost time: 1.680659532546997
Epoch: 40, Steps: 52 | Train Loss: 0.4272140 Vali Loss: 1.3297335 Test Loss: 0.3412676
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 41 cost time: 1.689162254333496
Epoch: 41, Steps: 52 | Train Loss: 0.4277670 Vali Loss: 1.3243659 Test Loss: 0.3410636
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 42 cost time: 1.6808648109436035
Epoch: 42, Steps: 52 | Train Loss: 0.4277359 Vali Loss: 1.3323061 Test Loss: 0.3409843
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 43 cost time: 1.6883251667022705
Epoch: 43, Steps: 52 | Train Loss: 0.4269136 Vali Loss: 1.3306780 Test Loss: 0.3415498
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 44 cost time: 1.6876928806304932
Epoch: 44, Steps: 52 | Train Loss: 0.4271997 Vali Loss: 1.3358848 Test Loss: 0.3407246
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 45 cost time: 1.690894603729248
Epoch: 45, Steps: 52 | Train Loss: 0.4270004 Vali Loss: 1.3257742 Test Loss: 0.3410999
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 46 cost time: 1.6806635856628418
Epoch: 46, Steps: 52 | Train Loss: 0.4236184 Vali Loss: 1.3332239 Test Loss: 0.3408507
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 47 cost time: 1.6807515621185303
Epoch: 47, Steps: 52 | Train Loss: 0.4248150 Vali Loss: 1.3204119 Test Loss: 0.3406898
Validation loss decreased (1.322046 --> 1.320412).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 48 cost time: 1.6775743961334229
Epoch: 48, Steps: 52 | Train Loss: 0.4250241 Vali Loss: 1.3285149 Test Loss: 0.3402216
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 49 cost time: 1.6823806762695312
Epoch: 49, Steps: 52 | Train Loss: 0.4258326 Vali Loss: 1.3321598 Test Loss: 0.3405488
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 50 cost time: 1.685027837753296
Epoch: 50, Steps: 52 | Train Loss: 0.4267494 Vali Loss: 1.3310881 Test Loss: 0.3410185
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 51 cost time: 1.70798921585083
Epoch: 51, Steps: 52 | Train Loss: 0.4281128 Vali Loss: 1.3282290 Test Loss: 0.3404837
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 52 cost time: 1.761298656463623
Epoch: 52, Steps: 52 | Train Loss: 0.4271387 Vali Loss: 1.3350990 Test Loss: 0.3406668
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 53 cost time: 1.6824243068695068
Epoch: 53, Steps: 52 | Train Loss: 0.4262391 Vali Loss: 1.3345864 Test Loss: 0.3407055
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 54 cost time: 1.6831018924713135
Epoch: 54, Steps: 52 | Train Loss: 0.4253926 Vali Loss: 1.3254025 Test Loss: 0.3401348
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 55 cost time: 1.6823158264160156
Epoch: 55, Steps: 52 | Train Loss: 0.4256943 Vali Loss: 1.3342218 Test Loss: 0.3399230
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 56 cost time: 1.6844027042388916
Epoch: 56, Steps: 52 | Train Loss: 0.4261601 Vali Loss: 1.3309104 Test Loss: 0.3402423
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 57 cost time: 1.681114673614502
Epoch: 57, Steps: 52 | Train Loss: 0.4250878 Vali Loss: 1.3259637 Test Loss: 0.3405037
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 58 cost time: 1.6880276203155518
Epoch: 58, Steps: 52 | Train Loss: 0.4264978 Vali Loss: 1.3304868 Test Loss: 0.3405213
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 59 cost time: 1.6970796585083008
Epoch: 59, Steps: 52 | Train Loss: 0.4247030 Vali Loss: 1.3242351 Test Loss: 0.3407684
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 60 cost time: 1.6892726421356201
Epoch: 60, Steps: 52 | Train Loss: 0.4260730 Vali Loss: 1.3268379 Test Loss: 0.3399812
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3406898081302643, mae:0.3822607696056366, rse:0.47817668318748474
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.04726600646972656 GB
Epoch: 1 cost time: 2.176614284515381
Epoch: 1, Steps: 52 | Train Loss: 0.7580882 Vali Loss: 2.2373869 Test Loss: 1.4643027
Validation loss decreased (inf --> 2.237387).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 2 cost time: 0.7812783718109131
Epoch: 2, Steps: 52 | Train Loss: 0.6370471 Vali Loss: 1.6149125 Test Loss: 0.7242104
Validation loss decreased (2.237387 --> 1.614913).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 3 cost time: 0.7851109504699707
Epoch: 3, Steps: 52 | Train Loss: 0.4936248 Vali Loss: 1.4378493 Test Loss: 0.4505786
Validation loss decreased (1.614913 --> 1.437849).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 4 cost time: 0.7769997119903564
Epoch: 4, Steps: 52 | Train Loss: 0.4583005 Vali Loss: 1.4110894 Test Loss: 0.4143338
Validation loss decreased (1.437849 --> 1.411089).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 5 cost time: 0.8152668476104736
Epoch: 5, Steps: 52 | Train Loss: 0.4439169 Vali Loss: 1.3941090 Test Loss: 0.3996487
Validation loss decreased (1.411089 --> 1.394109).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 6 cost time: 1.7430169582366943
Epoch: 6, Steps: 52 | Train Loss: 0.4363299 Vali Loss: 1.3714859 Test Loss: 0.3850899
Validation loss decreased (1.394109 --> 1.371486).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 7 cost time: 1.7432751655578613
Epoch: 7, Steps: 52 | Train Loss: 0.4302031 Vali Loss: 1.3745427 Test Loss: 0.3759989
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 8 cost time: 1.7424180507659912
Epoch: 8, Steps: 52 | Train Loss: 0.4276483 Vali Loss: 1.3665146 Test Loss: 0.3694316
Validation loss decreased (1.371486 --> 1.366515).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 9 cost time: 1.7387645244598389
Epoch: 9, Steps: 52 | Train Loss: 0.4250008 Vali Loss: 1.3639789 Test Loss: 0.3642795
Validation loss decreased (1.366515 --> 1.363979).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 10 cost time: 1.7405645847320557
Epoch: 10, Steps: 52 | Train Loss: 0.4211939 Vali Loss: 1.3472772 Test Loss: 0.3598152
Validation loss decreased (1.363979 --> 1.347277).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 11 cost time: 1.7414543628692627
Epoch: 11, Steps: 52 | Train Loss: 0.4189835 Vali Loss: 1.3555924 Test Loss: 0.3571907
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 12 cost time: 1.7343156337738037
Epoch: 12, Steps: 52 | Train Loss: 0.4186313 Vali Loss: 1.3447232 Test Loss: 0.3544141
Validation loss decreased (1.347277 --> 1.344723).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 13 cost time: 1.7337672710418701
Epoch: 13, Steps: 52 | Train Loss: 0.4172699 Vali Loss: 1.3408828 Test Loss: 0.3514959
Validation loss decreased (1.344723 --> 1.340883).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 14 cost time: 1.746739387512207
Epoch: 14, Steps: 52 | Train Loss: 0.4146190 Vali Loss: 1.3422688 Test Loss: 0.3500941
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 15 cost time: 1.744624376296997
Epoch: 15, Steps: 52 | Train Loss: 0.4157553 Vali Loss: 1.3351088 Test Loss: 0.3485059
Validation loss decreased (1.340883 --> 1.335109).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 16 cost time: 1.743398904800415
Epoch: 16, Steps: 52 | Train Loss: 0.4134445 Vali Loss: 1.3410089 Test Loss: 0.3476266
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 17 cost time: 1.7374224662780762
Epoch: 17, Steps: 52 | Train Loss: 0.4117022 Vali Loss: 1.3309753 Test Loss: 0.3468806
Validation loss decreased (1.335109 --> 1.330975).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 18 cost time: 1.7467131614685059
Epoch: 18, Steps: 52 | Train Loss: 0.4129087 Vali Loss: 1.3381205 Test Loss: 0.3461310
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 19 cost time: 1.7414486408233643
Epoch: 19, Steps: 52 | Train Loss: 0.4106840 Vali Loss: 1.3368691 Test Loss: 0.3450573
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 20 cost time: 1.9177610874176025
Epoch: 20, Steps: 52 | Train Loss: 0.4114682 Vali Loss: 1.3373917 Test Loss: 0.3442913
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 21 cost time: 1.7487003803253174
Epoch: 21, Steps: 52 | Train Loss: 0.4125712 Vali Loss: 1.3347313 Test Loss: 0.3441216
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 22 cost time: 1.7469220161437988
Epoch: 22, Steps: 52 | Train Loss: 0.4081820 Vali Loss: 1.3307431 Test Loss: 0.3434260
Validation loss decreased (1.330975 --> 1.330743).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 23 cost time: 1.7293140888214111
Epoch: 23, Steps: 52 | Train Loss: 0.4103925 Vali Loss: 1.3251940 Test Loss: 0.3430303
Validation loss decreased (1.330743 --> 1.325194).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 24 cost time: 1.721055030822754
Epoch: 24, Steps: 52 | Train Loss: 0.4090321 Vali Loss: 1.3297960 Test Loss: 0.3427760
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 25 cost time: 1.726043939590454
Epoch: 25, Steps: 52 | Train Loss: 0.4099950 Vali Loss: 1.3244364 Test Loss: 0.3424635
Validation loss decreased (1.325194 --> 1.324436).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 26 cost time: 1.7234103679656982
Epoch: 26, Steps: 52 | Train Loss: 0.4096108 Vali Loss: 1.3222704 Test Loss: 0.3427519
Validation loss decreased (1.324436 --> 1.322270).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 27 cost time: 1.720883846282959
Epoch: 27, Steps: 52 | Train Loss: 0.4078622 Vali Loss: 1.3325913 Test Loss: 0.3421248
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 28 cost time: 1.720520257949829
Epoch: 28, Steps: 52 | Train Loss: 0.4080621 Vali Loss: 1.3287394 Test Loss: 0.3419201
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 29 cost time: 1.7186708450317383
Epoch: 29, Steps: 52 | Train Loss: 0.4079975 Vali Loss: 1.3288301 Test Loss: 0.3418602
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 30 cost time: 1.7131836414337158
Epoch: 30, Steps: 52 | Train Loss: 0.4083569 Vali Loss: 1.3178707 Test Loss: 0.3413838
Validation loss decreased (1.322270 --> 1.317871).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 31 cost time: 1.7211430072784424
Epoch: 31, Steps: 52 | Train Loss: 0.4077917 Vali Loss: 1.3148193 Test Loss: 0.3410372
Validation loss decreased (1.317871 --> 1.314819).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 32 cost time: 1.7171473503112793
Epoch: 32, Steps: 52 | Train Loss: 0.4091874 Vali Loss: 1.3317655 Test Loss: 0.3412685
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 33 cost time: 1.7129504680633545
Epoch: 33, Steps: 52 | Train Loss: 0.4069642 Vali Loss: 1.3311102 Test Loss: 0.3408170
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 34 cost time: 1.72011137008667
Epoch: 34, Steps: 52 | Train Loss: 0.4081143 Vali Loss: 1.3228080 Test Loss: 0.3414904
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 35 cost time: 1.7142858505249023
Epoch: 35, Steps: 52 | Train Loss: 0.4094882 Vali Loss: 1.3244264 Test Loss: 0.3416746
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 36 cost time: 1.7201309204101562
Epoch: 36, Steps: 52 | Train Loss: 0.4081635 Vali Loss: 1.3233135 Test Loss: 0.3408009
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 37 cost time: 1.719130039215088
Epoch: 37, Steps: 52 | Train Loss: 0.4091797 Vali Loss: 1.3309219 Test Loss: 0.3411249
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 38 cost time: 1.7303707599639893
Epoch: 38, Steps: 52 | Train Loss: 0.4071967 Vali Loss: 1.3294253 Test Loss: 0.3412469
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 39 cost time: 1.7177128791809082
Epoch: 39, Steps: 52 | Train Loss: 0.4083650 Vali Loss: 1.3287363 Test Loss: 0.3415447
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 40 cost time: 1.7202401161193848
Epoch: 40, Steps: 52 | Train Loss: 0.4066825 Vali Loss: 1.3207221 Test Loss: 0.3407962
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 41 cost time: 1.7168076038360596
Epoch: 41, Steps: 52 | Train Loss: 0.4080724 Vali Loss: 1.3244154 Test Loss: 0.3405870
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 42 cost time: 1.718909740447998
Epoch: 42, Steps: 52 | Train Loss: 0.4073079 Vali Loss: 1.3198456 Test Loss: 0.3410129
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 43 cost time: 1.7169818878173828
Epoch: 43, Steps: 52 | Train Loss: 0.4078822 Vali Loss: 1.3311949 Test Loss: 0.3412299
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 44 cost time: 1.716113805770874
Epoch: 44, Steps: 52 | Train Loss: 0.4081670 Vali Loss: 1.3314723 Test Loss: 0.3406482
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 45 cost time: 1.7201015949249268
Epoch: 45, Steps: 52 | Train Loss: 0.4063036 Vali Loss: 1.3273290 Test Loss: 0.3406060
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 46 cost time: 1.7167291641235352
Epoch: 46, Steps: 52 | Train Loss: 0.4072635 Vali Loss: 1.3236766 Test Loss: 0.3399358
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 47 cost time: 1.7158539295196533
Epoch: 47, Steps: 52 | Train Loss: 0.4074235 Vali Loss: 1.3228290 Test Loss: 0.3402477
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 48 cost time: 1.724745750427246
Epoch: 48, Steps: 52 | Train Loss: 0.4073949 Vali Loss: 1.3222425 Test Loss: 0.3407477
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 49 cost time: 1.7144975662231445
Epoch: 49, Steps: 52 | Train Loss: 0.4073836 Vali Loss: 1.3266165 Test Loss: 0.3401262
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 50 cost time: 1.719144582748413
Epoch: 50, Steps: 52 | Train Loss: 0.4067548 Vali Loss: 1.3266325 Test Loss: 0.3408635
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 51 cost time: 1.7176053524017334
Epoch: 51, Steps: 52 | Train Loss: 0.4070361 Vali Loss: 1.3221110 Test Loss: 0.3408510
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 52 cost time: 1.7220938205718994
Epoch: 52, Steps: 52 | Train Loss: 0.4082165 Vali Loss: 1.3184898 Test Loss: 0.3411275
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 53 cost time: 1.7208106517791748
Epoch: 53, Steps: 52 | Train Loss: 0.4071157 Vali Loss: 1.3210758 Test Loss: 0.3407774
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 54 cost time: 1.7212259769439697
Epoch: 54, Steps: 52 | Train Loss: 0.4054150 Vali Loss: 1.3261948 Test Loss: 0.3411558
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 55 cost time: 1.7241322994232178
Epoch: 55, Steps: 52 | Train Loss: 0.4077931 Vali Loss: 1.3209028 Test Loss: 0.3406288
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 56 cost time: 1.715491533279419
Epoch: 56, Steps: 52 | Train Loss: 0.4075412 Vali Loss: 1.3247701 Test Loss: 0.3410999
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 57 cost time: 1.7202813625335693
Epoch: 57, Steps: 52 | Train Loss: 0.4072183 Vali Loss: 1.3233554 Test Loss: 0.3402634
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 58 cost time: 1.7190001010894775
Epoch: 58, Steps: 52 | Train Loss: 0.4055010 Vali Loss: 1.3304167 Test Loss: 0.3405340
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 59 cost time: 1.7233405113220215
Epoch: 59, Steps: 52 | Train Loss: 0.4078803 Vali Loss: 1.3231766 Test Loss: 0.3410727
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 60 cost time: 1.712709665298462
Epoch: 60, Steps: 52 | Train Loss: 0.4050870 Vali Loss: 1.3198147 Test Loss: 0.3401170
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34103724360466003, mae:0.38515910506248474, rse:0.4784204363822937
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.0483860969543457 GB
Epoch: 1 cost time: 2.198460578918457
Epoch: 1, Steps: 52 | Train Loss: 0.6736680 Vali Loss: 2.0483177 Test Loss: 1.2870320
Validation loss decreased (inf --> 2.048318).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 2 cost time: 0.794029712677002
Epoch: 2, Steps: 52 | Train Loss: 0.5841820 Vali Loss: 1.5827665 Test Loss: 0.6643388
Validation loss decreased (2.048318 --> 1.582767).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 3 cost time: 0.7952132225036621
Epoch: 3, Steps: 52 | Train Loss: 0.4724604 Vali Loss: 1.4333382 Test Loss: 0.4339509
Validation loss decreased (1.582767 --> 1.433338).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 4 cost time: 0.8000001907348633
Epoch: 4, Steps: 52 | Train Loss: 0.4420181 Vali Loss: 1.3930838 Test Loss: 0.4042185
Validation loss decreased (1.433338 --> 1.393084).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 5 cost time: 0.9114944934844971
Epoch: 5, Steps: 52 | Train Loss: 0.4308691 Vali Loss: 1.3854229 Test Loss: 0.3865530
Validation loss decreased (1.393084 --> 1.385423).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 6 cost time: 1.7607271671295166
Epoch: 6, Steps: 52 | Train Loss: 0.4258082 Vali Loss: 1.3760235 Test Loss: 0.3748170
Validation loss decreased (1.385423 --> 1.376024).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 7 cost time: 1.7727277278900146
Epoch: 7, Steps: 52 | Train Loss: 0.4204707 Vali Loss: 1.3657049 Test Loss: 0.3687372
Validation loss decreased (1.376024 --> 1.365705).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 8 cost time: 1.7678842544555664
Epoch: 8, Steps: 52 | Train Loss: 0.4178684 Vali Loss: 1.3605912 Test Loss: 0.3630310
Validation loss decreased (1.365705 --> 1.360591).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 9 cost time: 1.776402235031128
Epoch: 9, Steps: 52 | Train Loss: 0.4161691 Vali Loss: 1.3499420 Test Loss: 0.3588143
Validation loss decreased (1.360591 --> 1.349942).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 10 cost time: 1.7672297954559326
Epoch: 10, Steps: 52 | Train Loss: 0.4148167 Vali Loss: 1.3503566 Test Loss: 0.3560352
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 11 cost time: 1.7696223258972168
Epoch: 11, Steps: 52 | Train Loss: 0.4126159 Vali Loss: 1.3393978 Test Loss: 0.3528125
Validation loss decreased (1.349942 --> 1.339398).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 12 cost time: 1.7790007591247559
Epoch: 12, Steps: 52 | Train Loss: 0.4107275 Vali Loss: 1.3462245 Test Loss: 0.3510631
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 13 cost time: 1.7694218158721924
Epoch: 13, Steps: 52 | Train Loss: 0.4095936 Vali Loss: 1.3423855 Test Loss: 0.3493063
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 14 cost time: 1.7726054191589355
Epoch: 14, Steps: 52 | Train Loss: 0.4072796 Vali Loss: 1.3355243 Test Loss: 0.3476279
Validation loss decreased (1.339398 --> 1.335524).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 15 cost time: 1.7722480297088623
Epoch: 15, Steps: 52 | Train Loss: 0.4059506 Vali Loss: 1.3284342 Test Loss: 0.3464747
Validation loss decreased (1.335524 --> 1.328434).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 16 cost time: 1.7760210037231445
Epoch: 16, Steps: 52 | Train Loss: 0.4067343 Vali Loss: 1.3391097 Test Loss: 0.3457447
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 17 cost time: 1.7644858360290527
Epoch: 17, Steps: 52 | Train Loss: 0.4071113 Vali Loss: 1.3378389 Test Loss: 0.3452335
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 18 cost time: 1.7865560054779053
Epoch: 18, Steps: 52 | Train Loss: 0.4084760 Vali Loss: 1.3350866 Test Loss: 0.3447245
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 19 cost time: 1.7668304443359375
Epoch: 19, Steps: 52 | Train Loss: 0.4059939 Vali Loss: 1.3340790 Test Loss: 0.3437936
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 20 cost time: 1.7725188732147217
Epoch: 20, Steps: 52 | Train Loss: 0.4058450 Vali Loss: 1.3284749 Test Loss: 0.3433143
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 21 cost time: 1.7650916576385498
Epoch: 21, Steps: 52 | Train Loss: 0.4052176 Vali Loss: 1.3227468 Test Loss: 0.3428093
Validation loss decreased (1.328434 --> 1.322747).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 22 cost time: 1.7675666809082031
Epoch: 22, Steps: 52 | Train Loss: 0.4059055 Vali Loss: 1.3254580 Test Loss: 0.3416490
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 23 cost time: 1.7645032405853271
Epoch: 23, Steps: 52 | Train Loss: 0.4044754 Vali Loss: 1.3278024 Test Loss: 0.3427499
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 24 cost time: 1.7743120193481445
Epoch: 24, Steps: 52 | Train Loss: 0.4065125 Vali Loss: 1.3327470 Test Loss: 0.3420157
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 25 cost time: 1.7730085849761963
Epoch: 25, Steps: 52 | Train Loss: 0.4032166 Vali Loss: 1.3329146 Test Loss: 0.3418618
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 26 cost time: 1.7647056579589844
Epoch: 26, Steps: 52 | Train Loss: 0.4038193 Vali Loss: 1.3341939 Test Loss: 0.3413529
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 27 cost time: 1.7695913314819336
Epoch: 27, Steps: 52 | Train Loss: 0.4047083 Vali Loss: 1.3294750 Test Loss: 0.3407923
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 28 cost time: 1.7661840915679932
Epoch: 28, Steps: 52 | Train Loss: 0.4036390 Vali Loss: 1.3264014 Test Loss: 0.3408524
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 29 cost time: 1.7634966373443604
Epoch: 29, Steps: 52 | Train Loss: 0.4040937 Vali Loss: 1.3326638 Test Loss: 0.3413394
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 30 cost time: 1.7637486457824707
Epoch: 30, Steps: 52 | Train Loss: 0.4031763 Vali Loss: 1.3235770 Test Loss: 0.3407005
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 31 cost time: 1.7732043266296387
Epoch: 31, Steps: 52 | Train Loss: 0.4052490 Vali Loss: 1.3273482 Test Loss: 0.3403808
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 32 cost time: 1.7617859840393066
Epoch: 32, Steps: 52 | Train Loss: 0.4029986 Vali Loss: 1.3245596 Test Loss: 0.3403508
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 33 cost time: 1.7642483711242676
Epoch: 33, Steps: 52 | Train Loss: 0.4026109 Vali Loss: 1.3184693 Test Loss: 0.3403893
Validation loss decreased (1.322747 --> 1.318469).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 34 cost time: 1.7677018642425537
Epoch: 34, Steps: 52 | Train Loss: 0.4033544 Vali Loss: 1.3319216 Test Loss: 0.3411288
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 35 cost time: 1.7674322128295898
Epoch: 35, Steps: 52 | Train Loss: 0.4015247 Vali Loss: 1.3220246 Test Loss: 0.3406203
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 36 cost time: 1.7684681415557861
Epoch: 36, Steps: 52 | Train Loss: 0.4021356 Vali Loss: 1.3306204 Test Loss: 0.3405809
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 37 cost time: 1.7702357769012451
Epoch: 37, Steps: 52 | Train Loss: 0.4020700 Vali Loss: 1.3257403 Test Loss: 0.3406126
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 38 cost time: 1.7687394618988037
Epoch: 38, Steps: 52 | Train Loss: 0.4032791 Vali Loss: 1.3213440 Test Loss: 0.3399405
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 39 cost time: 1.7681238651275635
Epoch: 39, Steps: 52 | Train Loss: 0.4038117 Vali Loss: 1.3242294 Test Loss: 0.3396472
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 40 cost time: 1.7727999687194824
Epoch: 40, Steps: 52 | Train Loss: 0.4013758 Vali Loss: 1.3261756 Test Loss: 0.3398367
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 41 cost time: 1.7629716396331787
Epoch: 41, Steps: 52 | Train Loss: 0.4017398 Vali Loss: 1.3260037 Test Loss: 0.3396396
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 42 cost time: 1.7718288898468018
Epoch: 42, Steps: 52 | Train Loss: 0.4029213 Vali Loss: 1.3201115 Test Loss: 0.3402484
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 43 cost time: 1.766922950744629
Epoch: 43, Steps: 52 | Train Loss: 0.4017877 Vali Loss: 1.3249054 Test Loss: 0.3394777
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 44 cost time: 1.7727699279785156
Epoch: 44, Steps: 52 | Train Loss: 0.4039242 Vali Loss: 1.3191053 Test Loss: 0.3400080
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 45 cost time: 1.761643648147583
Epoch: 45, Steps: 52 | Train Loss: 0.4023064 Vali Loss: 1.3218021 Test Loss: 0.3394030
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 46 cost time: 1.7707998752593994
Epoch: 46, Steps: 52 | Train Loss: 0.4033152 Vali Loss: 1.3107108 Test Loss: 0.3394011
Validation loss decreased (1.318469 --> 1.310711).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 47 cost time: 1.7643663883209229
Epoch: 47, Steps: 52 | Train Loss: 0.4036616 Vali Loss: 1.3171830 Test Loss: 0.3400909
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 48 cost time: 1.7656185626983643
Epoch: 48, Steps: 52 | Train Loss: 0.4028737 Vali Loss: 1.3222772 Test Loss: 0.3398702
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 49 cost time: 1.7661445140838623
Epoch: 49, Steps: 52 | Train Loss: 0.4025280 Vali Loss: 1.3226247 Test Loss: 0.3404476
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 50 cost time: 1.7659742832183838
Epoch: 50, Steps: 52 | Train Loss: 0.4038726 Vali Loss: 1.3227787 Test Loss: 0.3395789
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 51 cost time: 1.7724084854125977
Epoch: 51, Steps: 52 | Train Loss: 0.4035594 Vali Loss: 1.3201991 Test Loss: 0.3397616
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 52 cost time: 1.7701480388641357
Epoch: 52, Steps: 52 | Train Loss: 0.4034265 Vali Loss: 1.3252189 Test Loss: 0.3396704
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 53 cost time: 1.7734119892120361
Epoch: 53, Steps: 52 | Train Loss: 0.4024481 Vali Loss: 1.3151900 Test Loss: 0.3401221
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 54 cost time: 1.768320083618164
Epoch: 54, Steps: 52 | Train Loss: 0.4020165 Vali Loss: 1.3206055 Test Loss: 0.3395333
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 55 cost time: 1.7700462341308594
Epoch: 55, Steps: 52 | Train Loss: 0.4021011 Vali Loss: 1.3232900 Test Loss: 0.3387559
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 56 cost time: 1.7658421993255615
Epoch: 56, Steps: 52 | Train Loss: 0.4036118 Vali Loss: 1.3277555 Test Loss: 0.3394330
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 57 cost time: 1.7673852443695068
Epoch: 57, Steps: 52 | Train Loss: 0.4027583 Vali Loss: 1.3241599 Test Loss: 0.3399071
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 58 cost time: 1.7616028785705566
Epoch: 58, Steps: 52 | Train Loss: 0.4012330 Vali Loss: 1.3232635 Test Loss: 0.3405819
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 59 cost time: 1.761429786682129
Epoch: 59, Steps: 52 | Train Loss: 0.4023502 Vali Loss: 1.3206263 Test Loss: 0.3396503
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 60 cost time: 1.764404535293579
Epoch: 60, Steps: 52 | Train Loss: 0.4020536 Vali Loss: 1.3241661 Test Loss: 0.3399752
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3394010365009308, mae:0.38555482029914856, rse:0.4772713780403137
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049146175384521484 GB
Epoch: 1 cost time: 2.100893974304199
Epoch: 1, Steps: 52 | Train Loss: 1.0075835 Vali Loss: 2.6507311 Test Loss: 1.9264579
Validation loss decreased (inf --> 2.650731).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 2 cost time: 0.7369997501373291
Epoch: 2, Steps: 52 | Train Loss: 0.8578098 Vali Loss: 1.9983523 Test Loss: 1.1822618
Validation loss decreased (2.650731 --> 1.998352).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 3 cost time: 0.7414216995239258
Epoch: 3, Steps: 52 | Train Loss: 0.6828900 Vali Loss: 1.7032400 Test Loss: 0.8085915
Validation loss decreased (1.998352 --> 1.703240).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 4 cost time: 0.7447328567504883
Epoch: 4, Steps: 52 | Train Loss: 0.5896186 Vali Loss: 1.5436420 Test Loss: 0.5828398
Validation loss decreased (1.703240 --> 1.543642).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 5 cost time: 0.7360000610351562
Epoch: 5, Steps: 52 | Train Loss: 0.5395908 Vali Loss: 1.4516389 Test Loss: 0.4690784
Validation loss decreased (1.543642 --> 1.451639).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 6 cost time: 1.4470102787017822
Epoch: 6, Steps: 52 | Train Loss: 0.5088372 Vali Loss: 1.4241517 Test Loss: 0.4221397
Validation loss decreased (1.451639 --> 1.424152).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 7 cost time: 1.6262054443359375
Epoch: 7, Steps: 52 | Train Loss: 0.4938027 Vali Loss: 1.4043972 Test Loss: 0.4003394
Validation loss decreased (1.424152 --> 1.404397).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 8 cost time: 1.6312839984893799
Epoch: 8, Steps: 52 | Train Loss: 0.4829766 Vali Loss: 1.3931074 Test Loss: 0.3873880
Validation loss decreased (1.404397 --> 1.393107).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 9 cost time: 1.633019208908081
Epoch: 9, Steps: 52 | Train Loss: 0.4748854 Vali Loss: 1.3801497 Test Loss: 0.3790079
Validation loss decreased (1.393107 --> 1.380150).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 10 cost time: 1.6286392211914062
Epoch: 10, Steps: 52 | Train Loss: 0.4676423 Vali Loss: 1.3811474 Test Loss: 0.3721247
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 11 cost time: 1.6287226676940918
Epoch: 11, Steps: 52 | Train Loss: 0.4667942 Vali Loss: 1.3688815 Test Loss: 0.3686469
Validation loss decreased (1.380150 --> 1.368881).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 12 cost time: 1.6290290355682373
Epoch: 12, Steps: 52 | Train Loss: 0.4611720 Vali Loss: 1.3637402 Test Loss: 0.3647918
Validation loss decreased (1.368881 --> 1.363740).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 13 cost time: 1.6327202320098877
Epoch: 13, Steps: 52 | Train Loss: 0.4565657 Vali Loss: 1.3600349 Test Loss: 0.3614558
Validation loss decreased (1.363740 --> 1.360035).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 14 cost time: 1.631324291229248
Epoch: 14, Steps: 52 | Train Loss: 0.4559892 Vali Loss: 1.3658601 Test Loss: 0.3596631
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 15 cost time: 1.6284747123718262
Epoch: 15, Steps: 52 | Train Loss: 0.4511958 Vali Loss: 1.3570904 Test Loss: 0.3576138
Validation loss decreased (1.360035 --> 1.357090).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 16 cost time: 1.6281530857086182
Epoch: 16, Steps: 52 | Train Loss: 0.4511600 Vali Loss: 1.3553326 Test Loss: 0.3558587
Validation loss decreased (1.357090 --> 1.355333).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 17 cost time: 1.6279690265655518
Epoch: 17, Steps: 52 | Train Loss: 0.4504209 Vali Loss: 1.3501396 Test Loss: 0.3545581
Validation loss decreased (1.355333 --> 1.350140).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 18 cost time: 1.6231675148010254
Epoch: 18, Steps: 52 | Train Loss: 0.4469596 Vali Loss: 1.3541278 Test Loss: 0.3531126
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 19 cost time: 1.6281788349151611
Epoch: 19, Steps: 52 | Train Loss: 0.4479264 Vali Loss: 1.3549159 Test Loss: 0.3518119
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 20 cost time: 1.6298253536224365
Epoch: 20, Steps: 52 | Train Loss: 0.4462844 Vali Loss: 1.3495450 Test Loss: 0.3516974
Validation loss decreased (1.350140 --> 1.349545).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 21 cost time: 1.630096197128296
Epoch: 21, Steps: 52 | Train Loss: 0.4448964 Vali Loss: 1.3527218 Test Loss: 0.3506231
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 22 cost time: 1.6308581829071045
Epoch: 22, Steps: 52 | Train Loss: 0.4432099 Vali Loss: 1.3464158 Test Loss: 0.3494023
Validation loss decreased (1.349545 --> 1.346416).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 23 cost time: 1.6297354698181152
Epoch: 23, Steps: 52 | Train Loss: 0.4437355 Vali Loss: 1.3494627 Test Loss: 0.3488706
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 24 cost time: 1.626715898513794
Epoch: 24, Steps: 52 | Train Loss: 0.4416381 Vali Loss: 1.3497299 Test Loss: 0.3491946
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 25 cost time: 1.630131721496582
Epoch: 25, Steps: 52 | Train Loss: 0.4417834 Vali Loss: 1.3486588 Test Loss: 0.3481334
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 26 cost time: 1.628129005432129
Epoch: 26, Steps: 52 | Train Loss: 0.4406199 Vali Loss: 1.3408408 Test Loss: 0.3479368
Validation loss decreased (1.346416 --> 1.340841).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 27 cost time: 1.6295454502105713
Epoch: 27, Steps: 52 | Train Loss: 0.4414807 Vali Loss: 1.3450664 Test Loss: 0.3472664
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 28 cost time: 1.6273391246795654
Epoch: 28, Steps: 52 | Train Loss: 0.4388150 Vali Loss: 1.3425114 Test Loss: 0.3465160
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 29 cost time: 1.6271586418151855
Epoch: 29, Steps: 52 | Train Loss: 0.4417480 Vali Loss: 1.3321435 Test Loss: 0.3464673
Validation loss decreased (1.340841 --> 1.332144).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 30 cost time: 1.6269574165344238
Epoch: 30, Steps: 52 | Train Loss: 0.4358774 Vali Loss: 1.3406968 Test Loss: 0.3466130
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 31 cost time: 1.6350977420806885
Epoch: 31, Steps: 52 | Train Loss: 0.4409230 Vali Loss: 1.3431627 Test Loss: 0.3457899
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 32 cost time: 1.6269004344940186
Epoch: 32, Steps: 52 | Train Loss: 0.4394784 Vali Loss: 1.3407665 Test Loss: 0.3459748
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 33 cost time: 1.6370182037353516
Epoch: 33, Steps: 52 | Train Loss: 0.4405298 Vali Loss: 1.3389417 Test Loss: 0.3457466
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 34 cost time: 1.6316134929656982
Epoch: 34, Steps: 52 | Train Loss: 0.4387958 Vali Loss: 1.3345119 Test Loss: 0.3453590
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 35 cost time: 1.632150411605835
Epoch: 35, Steps: 52 | Train Loss: 0.4387220 Vali Loss: 1.3411263 Test Loss: 0.3451914
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 36 cost time: 1.6301243305206299
Epoch: 36, Steps: 52 | Train Loss: 0.4354711 Vali Loss: 1.3439088 Test Loss: 0.3453597
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 37 cost time: 1.630218744277954
Epoch: 37, Steps: 52 | Train Loss: 0.4375658 Vali Loss: 1.3325374 Test Loss: 0.3452141
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 38 cost time: 1.6283390522003174
Epoch: 38, Steps: 52 | Train Loss: 0.4381562 Vali Loss: 1.3368140 Test Loss: 0.3448395
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 39 cost time: 1.6294069290161133
Epoch: 39, Steps: 52 | Train Loss: 0.4360961 Vali Loss: 1.3397619 Test Loss: 0.3445622
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 40 cost time: 1.6266789436340332
Epoch: 40, Steps: 52 | Train Loss: 0.4365280 Vali Loss: 1.3348663 Test Loss: 0.3444750
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 41 cost time: 1.6323397159576416
Epoch: 41, Steps: 52 | Train Loss: 0.4374979 Vali Loss: 1.3373603 Test Loss: 0.3444256
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 42 cost time: 1.624906063079834
Epoch: 42, Steps: 52 | Train Loss: 0.4377063 Vali Loss: 1.3389111 Test Loss: 0.3447244
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 43 cost time: 1.6335704326629639
Epoch: 43, Steps: 52 | Train Loss: 0.4367774 Vali Loss: 1.3352891 Test Loss: 0.3445890
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 44 cost time: 1.6280360221862793
Epoch: 44, Steps: 52 | Train Loss: 0.4373822 Vali Loss: 1.3386526 Test Loss: 0.3436099
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 45 cost time: 1.6315584182739258
Epoch: 45, Steps: 52 | Train Loss: 0.4361239 Vali Loss: 1.3392282 Test Loss: 0.3437501
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 46 cost time: 1.6334004402160645
Epoch: 46, Steps: 52 | Train Loss: 0.4365413 Vali Loss: 1.3408831 Test Loss: 0.3437817
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 47 cost time: 1.649421215057373
Epoch: 47, Steps: 52 | Train Loss: 0.4375583 Vali Loss: 1.3355361 Test Loss: 0.3441834
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 48 cost time: 1.6346511840820312
Epoch: 48, Steps: 52 | Train Loss: 0.4344588 Vali Loss: 1.3445560 Test Loss: 0.3446689
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 49 cost time: 1.638397216796875
Epoch: 49, Steps: 52 | Train Loss: 0.4380457 Vali Loss: 1.3411624 Test Loss: 0.3445770
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 50 cost time: 1.6304450035095215
Epoch: 50, Steps: 52 | Train Loss: 0.4351610 Vali Loss: 1.3316441 Test Loss: 0.3437270
Validation loss decreased (1.332144 --> 1.331644).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 51 cost time: 1.6375501155853271
Epoch: 51, Steps: 52 | Train Loss: 0.4362492 Vali Loss: 1.3361897 Test Loss: 0.3440323
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 52 cost time: 1.630079746246338
Epoch: 52, Steps: 52 | Train Loss: 0.4362174 Vali Loss: 1.3369437 Test Loss: 0.3439753
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 53 cost time: 1.6375551223754883
Epoch: 53, Steps: 52 | Train Loss: 0.4374816 Vali Loss: 1.3332858 Test Loss: 0.3437379
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 54 cost time: 1.631396770477295
Epoch: 54, Steps: 52 | Train Loss: 0.4370330 Vali Loss: 1.3348333 Test Loss: 0.3436265
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 55 cost time: 1.634897232055664
Epoch: 55, Steps: 52 | Train Loss: 0.4349161 Vali Loss: 1.3349482 Test Loss: 0.3439464
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 56 cost time: 1.62693190574646
Epoch: 56, Steps: 52 | Train Loss: 0.4364263 Vali Loss: 1.3416396 Test Loss: 0.3435329
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 57 cost time: 1.6377642154693604
Epoch: 57, Steps: 52 | Train Loss: 0.4366058 Vali Loss: 1.3356032 Test Loss: 0.3439996
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 58 cost time: 1.6311614513397217
Epoch: 58, Steps: 52 | Train Loss: 0.4377013 Vali Loss: 1.3405761 Test Loss: 0.3439248
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 59 cost time: 1.6338558197021484
Epoch: 59, Steps: 52 | Train Loss: 0.4383155 Vali Loss: 1.3381875 Test Loss: 0.3437296
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 60 cost time: 1.63047456741333
Epoch: 60, Steps: 52 | Train Loss: 0.4369335 Vali Loss: 1.3362875 Test Loss: 0.3438748
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34372708201408386, mae:0.3839798867702484, rse:0.48030343651771545
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.05057811737060547 GB
Epoch: 1 cost time: 2.1554102897644043
Epoch: 1, Steps: 52 | Train Loss: 0.7266581 Vali Loss: 2.1522312 Test Loss: 1.3645267
Validation loss decreased (inf --> 2.152231).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 2 cost time: 0.7556304931640625
Epoch: 2, Steps: 52 | Train Loss: 0.6363269 Vali Loss: 1.7260718 Test Loss: 0.8161362
Validation loss decreased (2.152231 --> 1.726072).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 3 cost time: 0.7586209774017334
Epoch: 3, Steps: 52 | Train Loss: 0.5209447 Vali Loss: 1.5122315 Test Loss: 0.5228063
Validation loss decreased (1.726072 --> 1.512231).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 4 cost time: 0.7554895877838135
Epoch: 4, Steps: 52 | Train Loss: 0.4715685 Vali Loss: 1.4426966 Test Loss: 0.4364990
Validation loss decreased (1.512231 --> 1.442697).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 5 cost time: 0.7563965320587158
Epoch: 5, Steps: 52 | Train Loss: 0.4514559 Vali Loss: 1.4057338 Test Loss: 0.4092900
Validation loss decreased (1.442697 --> 1.405734).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 6 cost time: 1.6736059188842773
Epoch: 6, Steps: 52 | Train Loss: 0.4423202 Vali Loss: 1.3920045 Test Loss: 0.3913198
Validation loss decreased (1.405734 --> 1.392004).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 7 cost time: 1.6780881881713867
Epoch: 7, Steps: 52 | Train Loss: 0.4370688 Vali Loss: 1.3875605 Test Loss: 0.3795007
Validation loss decreased (1.392004 --> 1.387560).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 8 cost time: 1.6813397407531738
Epoch: 8, Steps: 52 | Train Loss: 0.4325798 Vali Loss: 1.3699491 Test Loss: 0.3720970
Validation loss decreased (1.387560 --> 1.369949).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 9 cost time: 1.6790771484375
Epoch: 9, Steps: 52 | Train Loss: 0.4288667 Vali Loss: 1.3683522 Test Loss: 0.3658969
Validation loss decreased (1.369949 --> 1.368352).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 10 cost time: 1.682258129119873
Epoch: 10, Steps: 52 | Train Loss: 0.4259157 Vali Loss: 1.3640866 Test Loss: 0.3612916
Validation loss decreased (1.368352 --> 1.364087).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 11 cost time: 1.6812241077423096
Epoch: 11, Steps: 52 | Train Loss: 0.4226132 Vali Loss: 1.3518605 Test Loss: 0.3568470
Validation loss decreased (1.364087 --> 1.351861).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 12 cost time: 1.6797752380371094
Epoch: 12, Steps: 52 | Train Loss: 0.4233245 Vali Loss: 1.3574495 Test Loss: 0.3541611
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 13 cost time: 1.6818716526031494
Epoch: 13, Steps: 52 | Train Loss: 0.4198971 Vali Loss: 1.3504030 Test Loss: 0.3509477
Validation loss decreased (1.351861 --> 1.350403).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 14 cost time: 1.6780710220336914
Epoch: 14, Steps: 52 | Train Loss: 0.4187202 Vali Loss: 1.3453836 Test Loss: 0.3499669
Validation loss decreased (1.350403 --> 1.345384).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 15 cost time: 1.67533278465271
Epoch: 15, Steps: 52 | Train Loss: 0.4171416 Vali Loss: 1.3507597 Test Loss: 0.3483037
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 16 cost time: 1.6753053665161133
Epoch: 16, Steps: 52 | Train Loss: 0.4179388 Vali Loss: 1.3404129 Test Loss: 0.3462216
Validation loss decreased (1.345384 --> 1.340413).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 17 cost time: 1.6854338645935059
Epoch: 17, Steps: 52 | Train Loss: 0.4176651 Vali Loss: 1.3406572 Test Loss: 0.3450735
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 18 cost time: 1.6820433139801025
Epoch: 18, Steps: 52 | Train Loss: 0.4149514 Vali Loss: 1.3376400 Test Loss: 0.3449645
Validation loss decreased (1.340413 --> 1.337640).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 19 cost time: 1.6775414943695068
Epoch: 19, Steps: 52 | Train Loss: 0.4139316 Vali Loss: 1.3383522 Test Loss: 0.3436339
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 20 cost time: 1.6781084537506104
Epoch: 20, Steps: 52 | Train Loss: 0.4140927 Vali Loss: 1.3276346 Test Loss: 0.3430284
Validation loss decreased (1.337640 --> 1.327635).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 21 cost time: 1.7192065715789795
Epoch: 21, Steps: 52 | Train Loss: 0.4139118 Vali Loss: 1.3347607 Test Loss: 0.3424271
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 22 cost time: 1.6781764030456543
Epoch: 22, Steps: 52 | Train Loss: 0.4123762 Vali Loss: 1.3313270 Test Loss: 0.3415612
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 23 cost time: 1.6800084114074707
Epoch: 23, Steps: 52 | Train Loss: 0.4127448 Vali Loss: 1.3282911 Test Loss: 0.3411377
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 24 cost time: 1.6794884204864502
Epoch: 24, Steps: 52 | Train Loss: 0.4115440 Vali Loss: 1.3347719 Test Loss: 0.3413208
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 25 cost time: 1.689129114151001
Epoch: 25, Steps: 52 | Train Loss: 0.4124233 Vali Loss: 1.3345362 Test Loss: 0.3402171
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 26 cost time: 1.6820807456970215
Epoch: 26, Steps: 52 | Train Loss: 0.4119338 Vali Loss: 1.3324931 Test Loss: 0.3401814
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 27 cost time: 1.683053731918335
Epoch: 27, Steps: 52 | Train Loss: 0.4114991 Vali Loss: 1.3201038 Test Loss: 0.3399731
Validation loss decreased (1.327635 --> 1.320104).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 28 cost time: 1.6793420314788818
Epoch: 28, Steps: 52 | Train Loss: 0.4109373 Vali Loss: 1.3336360 Test Loss: 0.3405117
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 29 cost time: 1.682445764541626
Epoch: 29, Steps: 52 | Train Loss: 0.4118720 Vali Loss: 1.3206402 Test Loss: 0.3396692
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 30 cost time: 1.677597999572754
Epoch: 30, Steps: 52 | Train Loss: 0.4116637 Vali Loss: 1.3266484 Test Loss: 0.3394992
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 31 cost time: 1.6825447082519531
Epoch: 31, Steps: 52 | Train Loss: 0.4110180 Vali Loss: 1.3271673 Test Loss: 0.3392144
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 32 cost time: 1.685948371887207
Epoch: 32, Steps: 52 | Train Loss: 0.4115867 Vali Loss: 1.3289552 Test Loss: 0.3392705
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 33 cost time: 1.6815581321716309
Epoch: 33, Steps: 52 | Train Loss: 0.4102824 Vali Loss: 1.3226542 Test Loss: 0.3387161
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 34 cost time: 1.6757197380065918
Epoch: 34, Steps: 52 | Train Loss: 0.4116321 Vali Loss: 1.3153741 Test Loss: 0.3390499
Validation loss decreased (1.320104 --> 1.315374).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 35 cost time: 1.6812360286712646
Epoch: 35, Steps: 52 | Train Loss: 0.4097995 Vali Loss: 1.3220929 Test Loss: 0.3387364
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 36 cost time: 1.6797325611114502
Epoch: 36, Steps: 52 | Train Loss: 0.4103807 Vali Loss: 1.3258345 Test Loss: 0.3390656
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 37 cost time: 1.6855790615081787
Epoch: 37, Steps: 52 | Train Loss: 0.4102705 Vali Loss: 1.3179574 Test Loss: 0.3379815
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 38 cost time: 1.6755344867706299
Epoch: 38, Steps: 52 | Train Loss: 0.4103937 Vali Loss: 1.3224742 Test Loss: 0.3382237
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 39 cost time: 1.6815266609191895
Epoch: 39, Steps: 52 | Train Loss: 0.4108916 Vali Loss: 1.3232009 Test Loss: 0.3390157
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 40 cost time: 1.6802773475646973
Epoch: 40, Steps: 52 | Train Loss: 0.4114909 Vali Loss: 1.3199677 Test Loss: 0.3384053
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 41 cost time: 1.6850612163543701
Epoch: 41, Steps: 52 | Train Loss: 0.4104950 Vali Loss: 1.3237141 Test Loss: 0.3382533
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 42 cost time: 1.6787784099578857
Epoch: 42, Steps: 52 | Train Loss: 0.4107647 Vali Loss: 1.3248291 Test Loss: 0.3382737
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 43 cost time: 1.6854937076568604
Epoch: 43, Steps: 52 | Train Loss: 0.4101205 Vali Loss: 1.3254730 Test Loss: 0.3389714
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 44 cost time: 1.6819326877593994
Epoch: 44, Steps: 52 | Train Loss: 0.4109678 Vali Loss: 1.3209350 Test Loss: 0.3385810
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 45 cost time: 1.6816248893737793
Epoch: 45, Steps: 52 | Train Loss: 0.4105405 Vali Loss: 1.3265373 Test Loss: 0.3380769
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 46 cost time: 1.6842262744903564
Epoch: 46, Steps: 52 | Train Loss: 0.4102817 Vali Loss: 1.3234630 Test Loss: 0.3386917
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 47 cost time: 1.7040514945983887
Epoch: 47, Steps: 52 | Train Loss: 0.4110870 Vali Loss: 1.3214923 Test Loss: 0.3384163
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 48 cost time: 1.68241548538208
Epoch: 48, Steps: 52 | Train Loss: 0.4079458 Vali Loss: 1.3244982 Test Loss: 0.3383988
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 49 cost time: 1.6809935569763184
Epoch: 49, Steps: 52 | Train Loss: 0.4091548 Vali Loss: 1.3260723 Test Loss: 0.3385484
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 50 cost time: 1.6774258613586426
Epoch: 50, Steps: 52 | Train Loss: 0.4099982 Vali Loss: 1.3188396 Test Loss: 0.3384840
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 51 cost time: 1.6839954853057861
Epoch: 51, Steps: 52 | Train Loss: 0.4106753 Vali Loss: 1.3222576 Test Loss: 0.3376863
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 52 cost time: 1.6732301712036133
Epoch: 52, Steps: 52 | Train Loss: 0.4082687 Vali Loss: 1.3188436 Test Loss: 0.3378337
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 53 cost time: 1.6808786392211914
Epoch: 53, Steps: 52 | Train Loss: 0.4091333 Vali Loss: 1.3231301 Test Loss: 0.3377354
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 54 cost time: 1.674351453781128
Epoch: 54, Steps: 52 | Train Loss: 0.4096477 Vali Loss: 1.3256514 Test Loss: 0.3382344
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 55 cost time: 1.683110237121582
Epoch: 55, Steps: 52 | Train Loss: 0.4091467 Vali Loss: 1.3248954 Test Loss: 0.3386235
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 56 cost time: 1.671541690826416
Epoch: 56, Steps: 52 | Train Loss: 0.4101978 Vali Loss: 1.3195108 Test Loss: 0.3377049
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 57 cost time: 1.6789846420288086
Epoch: 57, Steps: 52 | Train Loss: 0.4114542 Vali Loss: 1.3185749 Test Loss: 0.3385041
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 58 cost time: 1.674511432647705
Epoch: 58, Steps: 52 | Train Loss: 0.4087680 Vali Loss: 1.3279872 Test Loss: 0.3379918
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 59 cost time: 1.6788825988769531
Epoch: 59, Steps: 52 | Train Loss: 0.4085739 Vali Loss: 1.3209467 Test Loss: 0.3375955
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 60 cost time: 1.6910390853881836
Epoch: 60, Steps: 52 | Train Loss: 0.4101627 Vali Loss: 1.3205848 Test Loss: 0.3374333
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33904993534088135, mae:0.3852410614490509, rse:0.47702446579933167
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05169820785522461 GB
Epoch: 1 cost time: 2.1184186935424805
Epoch: 1, Steps: 52 | Train Loss: 0.7073372 Vali Loss: 2.1663418 Test Loss: 1.3985546
Validation loss decreased (inf --> 2.166342).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 2 cost time: 0.7762062549591064
Epoch: 2, Steps: 52 | Train Loss: 0.6298133 Vali Loss: 1.7583672 Test Loss: 0.8965021
Validation loss decreased (2.166342 --> 1.758367).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 3 cost time: 0.7756097316741943
Epoch: 3, Steps: 52 | Train Loss: 0.5182002 Vali Loss: 1.5049350 Test Loss: 0.5137318
Validation loss decreased (1.758367 --> 1.504935).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 4 cost time: 0.7674283981323242
Epoch: 4, Steps: 52 | Train Loss: 0.4620581 Vali Loss: 1.4297488 Test Loss: 0.4189582
Validation loss decreased (1.504935 --> 1.429749).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 5 cost time: 0.7628200054168701
Epoch: 5, Steps: 52 | Train Loss: 0.4422528 Vali Loss: 1.4045062 Test Loss: 0.3938417
Validation loss decreased (1.429749 --> 1.404506).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 6 cost time: 1.7170467376708984
Epoch: 6, Steps: 52 | Train Loss: 0.4351150 Vali Loss: 1.3890328 Test Loss: 0.3795145
Validation loss decreased (1.404506 --> 1.389033).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 7 cost time: 1.719205379486084
Epoch: 7, Steps: 52 | Train Loss: 0.4283924 Vali Loss: 1.3769610 Test Loss: 0.3693829
Validation loss decreased (1.389033 --> 1.376961).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 8 cost time: 1.7057616710662842
Epoch: 8, Steps: 52 | Train Loss: 0.4261952 Vali Loss: 1.3695467 Test Loss: 0.3638681
Validation loss decreased (1.376961 --> 1.369547).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 9 cost time: 1.707956314086914
Epoch: 9, Steps: 52 | Train Loss: 0.4211467 Vali Loss: 1.3649240 Test Loss: 0.3597981
Validation loss decreased (1.369547 --> 1.364924).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 10 cost time: 1.7186882495880127
Epoch: 10, Steps: 52 | Train Loss: 0.4206436 Vali Loss: 1.3525922 Test Loss: 0.3567554
Validation loss decreased (1.364924 --> 1.352592).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 11 cost time: 1.7143287658691406
Epoch: 11, Steps: 52 | Train Loss: 0.4184750 Vali Loss: 1.3559253 Test Loss: 0.3544525
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 12 cost time: 1.7098078727722168
Epoch: 12, Steps: 52 | Train Loss: 0.4171354 Vali Loss: 1.3522500 Test Loss: 0.3517086
Validation loss decreased (1.352592 --> 1.352250).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 13 cost time: 1.7067623138427734
Epoch: 13, Steps: 52 | Train Loss: 0.4151800 Vali Loss: 1.3460270 Test Loss: 0.3499103
Validation loss decreased (1.352250 --> 1.346027).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 14 cost time: 1.7078135013580322
Epoch: 14, Steps: 52 | Train Loss: 0.4164309 Vali Loss: 1.3360945 Test Loss: 0.3492441
Validation loss decreased (1.346027 --> 1.336094).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 15 cost time: 1.7121553421020508
Epoch: 15, Steps: 52 | Train Loss: 0.4122774 Vali Loss: 1.3354440 Test Loss: 0.3484296
Validation loss decreased (1.336094 --> 1.335444).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 16 cost time: 1.71449875831604
Epoch: 16, Steps: 52 | Train Loss: 0.4121631 Vali Loss: 1.3346577 Test Loss: 0.3462825
Validation loss decreased (1.335444 --> 1.334658).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 17 cost time: 1.7083947658538818
Epoch: 17, Steps: 52 | Train Loss: 0.4127805 Vali Loss: 1.3406235 Test Loss: 0.3463977
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 18 cost time: 1.7080490589141846
Epoch: 18, Steps: 52 | Train Loss: 0.4123293 Vali Loss: 1.3353519 Test Loss: 0.3450769
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 19 cost time: 1.7151367664337158
Epoch: 19, Steps: 52 | Train Loss: 0.4096946 Vali Loss: 1.3357086 Test Loss: 0.3447895
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 20 cost time: 1.7132821083068848
Epoch: 20, Steps: 52 | Train Loss: 0.4092450 Vali Loss: 1.3264246 Test Loss: 0.3442818
Validation loss decreased (1.334658 --> 1.326425).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 21 cost time: 1.7096352577209473
Epoch: 21, Steps: 52 | Train Loss: 0.4096775 Vali Loss: 1.3302274 Test Loss: 0.3434674
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 22 cost time: 1.7111377716064453
Epoch: 22, Steps: 52 | Train Loss: 0.4106810 Vali Loss: 1.3311329 Test Loss: 0.3444083
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 23 cost time: 1.7056963443756104
Epoch: 23, Steps: 52 | Train Loss: 0.4100774 Vali Loss: 1.3216002 Test Loss: 0.3427790
Validation loss decreased (1.326425 --> 1.321600).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 24 cost time: 1.7096288204193115
Epoch: 24, Steps: 52 | Train Loss: 0.4097580 Vali Loss: 1.3206084 Test Loss: 0.3428252
Validation loss decreased (1.321600 --> 1.320608).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 25 cost time: 1.7046153545379639
Epoch: 25, Steps: 52 | Train Loss: 0.4081143 Vali Loss: 1.3269883 Test Loss: 0.3420548
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 26 cost time: 1.7129225730895996
Epoch: 26, Steps: 52 | Train Loss: 0.4095406 Vali Loss: 1.3267354 Test Loss: 0.3419171
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 27 cost time: 1.705632209777832
Epoch: 27, Steps: 52 | Train Loss: 0.4063627 Vali Loss: 1.3203220 Test Loss: 0.3424739
Validation loss decreased (1.320608 --> 1.320322).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 28 cost time: 1.7093627452850342
Epoch: 28, Steps: 52 | Train Loss: 0.4090332 Vali Loss: 1.3201556 Test Loss: 0.3421029
Validation loss decreased (1.320322 --> 1.320156).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 29 cost time: 1.7094264030456543
Epoch: 29, Steps: 52 | Train Loss: 0.4087235 Vali Loss: 1.3281868 Test Loss: 0.3413931
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 30 cost time: 1.7103545665740967
Epoch: 30, Steps: 52 | Train Loss: 0.4091204 Vali Loss: 1.3245146 Test Loss: 0.3415200
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 31 cost time: 1.710374355316162
Epoch: 31, Steps: 52 | Train Loss: 0.4052059 Vali Loss: 1.3247963 Test Loss: 0.3415343
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 32 cost time: 1.707657814025879
Epoch: 32, Steps: 52 | Train Loss: 0.4084844 Vali Loss: 1.3177657 Test Loss: 0.3409537
Validation loss decreased (1.320156 --> 1.317766).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 33 cost time: 1.7088098526000977
Epoch: 33, Steps: 52 | Train Loss: 0.4090522 Vali Loss: 1.3234774 Test Loss: 0.3409981
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 34 cost time: 1.7147226333618164
Epoch: 34, Steps: 52 | Train Loss: 0.4085151 Vali Loss: 1.3280585 Test Loss: 0.3415080
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 35 cost time: 1.7069401741027832
Epoch: 35, Steps: 52 | Train Loss: 0.4086593 Vali Loss: 1.3216143 Test Loss: 0.3414799
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 36 cost time: 1.7074522972106934
Epoch: 36, Steps: 52 | Train Loss: 0.4060732 Vali Loss: 1.3115401 Test Loss: 0.3408588
Validation loss decreased (1.317766 --> 1.311540).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 37 cost time: 1.7069118022918701
Epoch: 37, Steps: 52 | Train Loss: 0.4056923 Vali Loss: 1.3262677 Test Loss: 0.3407524
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 38 cost time: 1.7088868618011475
Epoch: 38, Steps: 52 | Train Loss: 0.4076920 Vali Loss: 1.3266875 Test Loss: 0.3409029
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 39 cost time: 1.708486795425415
Epoch: 39, Steps: 52 | Train Loss: 0.4072555 Vali Loss: 1.3255677 Test Loss: 0.3410305
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 40 cost time: 1.7108733654022217
Epoch: 40, Steps: 52 | Train Loss: 0.4071517 Vali Loss: 1.3269601 Test Loss: 0.3411964
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 41 cost time: 1.7089653015136719
Epoch: 41, Steps: 52 | Train Loss: 0.4071266 Vali Loss: 1.3218424 Test Loss: 0.3415710
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 42 cost time: 1.712810754776001
Epoch: 42, Steps: 52 | Train Loss: 0.4062708 Vali Loss: 1.3218405 Test Loss: 0.3410874
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 43 cost time: 1.709308385848999
Epoch: 43, Steps: 52 | Train Loss: 0.4070464 Vali Loss: 1.3222477 Test Loss: 0.3407282
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 44 cost time: 1.710235357284546
Epoch: 44, Steps: 52 | Train Loss: 0.4082083 Vali Loss: 1.3231356 Test Loss: 0.3418974
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 45 cost time: 1.7105810642242432
Epoch: 45, Steps: 52 | Train Loss: 0.4083721 Vali Loss: 1.3186471 Test Loss: 0.3419408
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 46 cost time: 1.7077782154083252
Epoch: 46, Steps: 52 | Train Loss: 0.4063908 Vali Loss: 1.3135084 Test Loss: 0.3408890
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 47 cost time: 1.7116549015045166
Epoch: 47, Steps: 52 | Train Loss: 0.4070572 Vali Loss: 1.3190387 Test Loss: 0.3412372
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 48 cost time: 1.7115776538848877
Epoch: 48, Steps: 52 | Train Loss: 0.4067113 Vali Loss: 1.3264661 Test Loss: 0.3408545
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 49 cost time: 1.712458848953247
Epoch: 49, Steps: 52 | Train Loss: 0.4066543 Vali Loss: 1.3197876 Test Loss: 0.3407290
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 50 cost time: 1.7076449394226074
Epoch: 50, Steps: 52 | Train Loss: 0.4077390 Vali Loss: 1.3211656 Test Loss: 0.3416990
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 51 cost time: 1.7091243267059326
Epoch: 51, Steps: 52 | Train Loss: 0.4075209 Vali Loss: 1.3195186 Test Loss: 0.3414183
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 52 cost time: 1.7085959911346436
Epoch: 52, Steps: 52 | Train Loss: 0.4078421 Vali Loss: 1.3228489 Test Loss: 0.3413035
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 53 cost time: 1.7110025882720947
Epoch: 53, Steps: 52 | Train Loss: 0.4074411 Vali Loss: 1.3239701 Test Loss: 0.3401160
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 54 cost time: 1.7067430019378662
Epoch: 54, Steps: 52 | Train Loss: 0.4065094 Vali Loss: 1.3258287 Test Loss: 0.3414553
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 55 cost time: 1.7217745780944824
Epoch: 55, Steps: 52 | Train Loss: 0.4065193 Vali Loss: 1.3250514 Test Loss: 0.3403833
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 56 cost time: 1.7050740718841553
Epoch: 56, Steps: 52 | Train Loss: 0.4069847 Vali Loss: 1.3208251 Test Loss: 0.3408443
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 57 cost time: 1.7159693241119385
Epoch: 57, Steps: 52 | Train Loss: 0.4063499 Vali Loss: 1.3155832 Test Loss: 0.3409354
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 58 cost time: 1.7068161964416504
Epoch: 58, Steps: 52 | Train Loss: 0.4069212 Vali Loss: 1.3196375 Test Loss: 0.3405919
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 59 cost time: 1.708441972732544
Epoch: 59, Steps: 52 | Train Loss: 0.4073889 Vali Loss: 1.3213711 Test Loss: 0.3410256
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 60 cost time: 1.7086646556854248
Epoch: 60, Steps: 52 | Train Loss: 0.4069800 Vali Loss: 1.3189070 Test Loss: 0.3411380
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34085872769355774, mae:0.3900594711303711, rse:0.4782952070236206
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.049307823181152344 GB
Epoch: 1 cost time: 2.093416213989258
Epoch: 1, Steps: 52 | Train Loss: 0.9215583 Vali Loss: 2.4340963 Test Loss: 1.6267354
Validation loss decreased (inf --> 2.434096).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 2 cost time: 0.7338175773620605
Epoch: 2, Steps: 52 | Train Loss: 0.7764001 Vali Loss: 1.8060083 Test Loss: 0.9148935
Validation loss decreased (2.434096 --> 1.806008).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 3 cost time: 0.7337565422058105
Epoch: 3, Steps: 52 | Train Loss: 0.6232918 Vali Loss: 1.5788254 Test Loss: 0.6060567
Validation loss decreased (1.806008 --> 1.578825).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 4 cost time: 0.7346267700195312
Epoch: 4, Steps: 52 | Train Loss: 0.5459380 Vali Loss: 1.4796355 Test Loss: 0.4759893
Validation loss decreased (1.578825 --> 1.479635).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 5 cost time: 0.7484719753265381
Epoch: 5, Steps: 52 | Train Loss: 0.5131941 Vali Loss: 1.4421089 Test Loss: 0.4296700
Validation loss decreased (1.479635 --> 1.442109).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 6 cost time: 1.4462742805480957
Epoch: 6, Steps: 52 | Train Loss: 0.4953982 Vali Loss: 1.4209908 Test Loss: 0.4076260
Validation loss decreased (1.442109 --> 1.420991).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 7 cost time: 1.6285648345947266
Epoch: 7, Steps: 52 | Train Loss: 0.4808044 Vali Loss: 1.4066234 Test Loss: 0.3931622
Validation loss decreased (1.420991 --> 1.406623).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 8 cost time: 1.6308069229125977
Epoch: 8, Steps: 52 | Train Loss: 0.4721691 Vali Loss: 1.3984241 Test Loss: 0.3839745
Validation loss decreased (1.406623 --> 1.398424).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 9 cost time: 1.631307601928711
Epoch: 9, Steps: 52 | Train Loss: 0.4661748 Vali Loss: 1.3880450 Test Loss: 0.3770371
Validation loss decreased (1.398424 --> 1.388045).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 10 cost time: 1.6327662467956543
Epoch: 10, Steps: 52 | Train Loss: 0.4618371 Vali Loss: 1.3834881 Test Loss: 0.3710314
Validation loss decreased (1.388045 --> 1.383488).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 11 cost time: 1.6382746696472168
Epoch: 11, Steps: 52 | Train Loss: 0.4538508 Vali Loss: 1.3686585 Test Loss: 0.3658590
Validation loss decreased (1.383488 --> 1.368659).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 12 cost time: 1.6321723461151123
Epoch: 12, Steps: 52 | Train Loss: 0.4509664 Vali Loss: 1.3618948 Test Loss: 0.3623189
Validation loss decreased (1.368659 --> 1.361895).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 13 cost time: 1.628014087677002
Epoch: 13, Steps: 52 | Train Loss: 0.4480546 Vali Loss: 1.3566786 Test Loss: 0.3595926
Validation loss decreased (1.361895 --> 1.356679).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 14 cost time: 1.6364054679870605
Epoch: 14, Steps: 52 | Train Loss: 0.4471951 Vali Loss: 1.3527383 Test Loss: 0.3575496
Validation loss decreased (1.356679 --> 1.352738).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 15 cost time: 1.625840187072754
Epoch: 15, Steps: 52 | Train Loss: 0.4448397 Vali Loss: 1.3584852 Test Loss: 0.3554103
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 16 cost time: 1.6300766468048096
Epoch: 16, Steps: 52 | Train Loss: 0.4435781 Vali Loss: 1.3579695 Test Loss: 0.3536711
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 17 cost time: 1.6311049461364746
Epoch: 17, Steps: 52 | Train Loss: 0.4421096 Vali Loss: 1.3575926 Test Loss: 0.3520469
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 18 cost time: 1.6246230602264404
Epoch: 18, Steps: 52 | Train Loss: 0.4391124 Vali Loss: 1.3422067 Test Loss: 0.3510602
Validation loss decreased (1.352738 --> 1.342207).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 19 cost time: 1.6324489116668701
Epoch: 19, Steps: 52 | Train Loss: 0.4378134 Vali Loss: 1.3463130 Test Loss: 0.3496684
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 20 cost time: 1.6341512203216553
Epoch: 20, Steps: 52 | Train Loss: 0.4377378 Vali Loss: 1.3385010 Test Loss: 0.3491479
Validation loss decreased (1.342207 --> 1.338501).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 21 cost time: 1.6271750926971436
Epoch: 21, Steps: 52 | Train Loss: 0.4344912 Vali Loss: 1.3495748 Test Loss: 0.3481425
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 22 cost time: 1.6295559406280518
Epoch: 22, Steps: 52 | Train Loss: 0.4347695 Vali Loss: 1.3506477 Test Loss: 0.3472237
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 23 cost time: 1.6292569637298584
Epoch: 23, Steps: 52 | Train Loss: 0.4345418 Vali Loss: 1.3345525 Test Loss: 0.3462218
Validation loss decreased (1.338501 --> 1.334553).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 24 cost time: 1.6360116004943848
Epoch: 24, Steps: 52 | Train Loss: 0.4352259 Vali Loss: 1.3408129 Test Loss: 0.3460099
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 25 cost time: 1.6356987953186035
Epoch: 25, Steps: 52 | Train Loss: 0.4330128 Vali Loss: 1.3468757 Test Loss: 0.3455367
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 26 cost time: 1.6325101852416992
Epoch: 26, Steps: 52 | Train Loss: 0.4331453 Vali Loss: 1.3326157 Test Loss: 0.3453389
Validation loss decreased (1.334553 --> 1.332616).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 27 cost time: 1.6340343952178955
Epoch: 27, Steps: 52 | Train Loss: 0.4340049 Vali Loss: 1.3411074 Test Loss: 0.3445646
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 28 cost time: 1.629302740097046
Epoch: 28, Steps: 52 | Train Loss: 0.4330813 Vali Loss: 1.3344692 Test Loss: 0.3447203
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 29 cost time: 1.6272459030151367
Epoch: 29, Steps: 52 | Train Loss: 0.4325586 Vali Loss: 1.3387656 Test Loss: 0.3444615
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 30 cost time: 1.631587266921997
Epoch: 30, Steps: 52 | Train Loss: 0.4310234 Vali Loss: 1.3455114 Test Loss: 0.3436582
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 31 cost time: 1.6344356536865234
Epoch: 31, Steps: 52 | Train Loss: 0.4311788 Vali Loss: 1.3307273 Test Loss: 0.3430685
Validation loss decreased (1.332616 --> 1.330727).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 32 cost time: 1.6342382431030273
Epoch: 32, Steps: 52 | Train Loss: 0.4323920 Vali Loss: 1.3334541 Test Loss: 0.3433785
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 33 cost time: 1.6358187198638916
Epoch: 33, Steps: 52 | Train Loss: 0.4309712 Vali Loss: 1.3323866 Test Loss: 0.3436105
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 34 cost time: 1.6314334869384766
Epoch: 34, Steps: 52 | Train Loss: 0.4313375 Vali Loss: 1.3186851 Test Loss: 0.3424292
Validation loss decreased (1.330727 --> 1.318685).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 35 cost time: 1.632556676864624
Epoch: 35, Steps: 52 | Train Loss: 0.4313691 Vali Loss: 1.3385377 Test Loss: 0.3431570
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 36 cost time: 1.6321916580200195
Epoch: 36, Steps: 52 | Train Loss: 0.4298147 Vali Loss: 1.3281386 Test Loss: 0.3426511
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 37 cost time: 1.6329307556152344
Epoch: 37, Steps: 52 | Train Loss: 0.4320805 Vali Loss: 1.3354485 Test Loss: 0.3422712
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 38 cost time: 1.628046989440918
Epoch: 38, Steps: 52 | Train Loss: 0.4298999 Vali Loss: 1.3303804 Test Loss: 0.3429214
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 39 cost time: 1.626227617263794
Epoch: 39, Steps: 52 | Train Loss: 0.4294989 Vali Loss: 1.3385510 Test Loss: 0.3417153
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 40 cost time: 1.6348206996917725
Epoch: 40, Steps: 52 | Train Loss: 0.4296508 Vali Loss: 1.3364393 Test Loss: 0.3418755
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 41 cost time: 1.633676528930664
Epoch: 41, Steps: 52 | Train Loss: 0.4302000 Vali Loss: 1.3412683 Test Loss: 0.3421990
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 42 cost time: 1.6268970966339111
Epoch: 42, Steps: 52 | Train Loss: 0.4284695 Vali Loss: 1.3368185 Test Loss: 0.3418566
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 43 cost time: 1.6301374435424805
Epoch: 43, Steps: 52 | Train Loss: 0.4297418 Vali Loss: 1.3423665 Test Loss: 0.3424264
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 44 cost time: 1.6334936618804932
Epoch: 44, Steps: 52 | Train Loss: 0.4308197 Vali Loss: 1.3346031 Test Loss: 0.3426590
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 45 cost time: 1.6287167072296143
Epoch: 45, Steps: 52 | Train Loss: 0.4296385 Vali Loss: 1.3361585 Test Loss: 0.3420357
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 46 cost time: 1.6329014301300049
Epoch: 46, Steps: 52 | Train Loss: 0.4305475 Vali Loss: 1.3319496 Test Loss: 0.3418677
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 47 cost time: 1.6345975399017334
Epoch: 47, Steps: 52 | Train Loss: 0.4304795 Vali Loss: 1.3345014 Test Loss: 0.3416994
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 48 cost time: 1.6315717697143555
Epoch: 48, Steps: 52 | Train Loss: 0.4292416 Vali Loss: 1.3386112 Test Loss: 0.3419461
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 49 cost time: 1.6330435276031494
Epoch: 49, Steps: 52 | Train Loss: 0.4296395 Vali Loss: 1.3364248 Test Loss: 0.3413906
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 50 cost time: 1.627490520477295
Epoch: 50, Steps: 52 | Train Loss: 0.4270590 Vali Loss: 1.3358822 Test Loss: 0.3419592
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 51 cost time: 1.632779598236084
Epoch: 51, Steps: 52 | Train Loss: 0.4287030 Vali Loss: 1.3289223 Test Loss: 0.3414217
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 52 cost time: 1.6315741539001465
Epoch: 52, Steps: 52 | Train Loss: 0.4281739 Vali Loss: 1.3317158 Test Loss: 0.3409225
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 53 cost time: 1.6316096782684326
Epoch: 53, Steps: 52 | Train Loss: 0.4295081 Vali Loss: 1.3316501 Test Loss: 0.3411534
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 54 cost time: 1.6326181888580322
Epoch: 54, Steps: 52 | Train Loss: 0.4298191 Vali Loss: 1.3400092 Test Loss: 0.3407632
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 55 cost time: 1.6333339214324951
Epoch: 55, Steps: 52 | Train Loss: 0.4298316 Vali Loss: 1.3360817 Test Loss: 0.3421357
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 56 cost time: 1.631748914718628
Epoch: 56, Steps: 52 | Train Loss: 0.4282894 Vali Loss: 1.3365040 Test Loss: 0.3414437
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 57 cost time: 1.631683349609375
Epoch: 57, Steps: 52 | Train Loss: 0.4293154 Vali Loss: 1.3355882 Test Loss: 0.3411953
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 58 cost time: 1.6322758197784424
Epoch: 58, Steps: 52 | Train Loss: 0.4298614 Vali Loss: 1.3373576 Test Loss: 0.3410935
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 59 cost time: 1.6312336921691895
Epoch: 59, Steps: 52 | Train Loss: 0.4296287 Vali Loss: 1.3337183 Test Loss: 0.3412111
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 60 cost time: 1.6342353820800781
Epoch: 60, Steps: 52 | Train Loss: 0.4293911 Vali Loss: 1.3375401 Test Loss: 0.3413559
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3424292504787445, mae:0.3844505846500397, rse:0.4793958067893982
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05073976516723633 GB
Epoch: 1 cost time: 2.1292309761047363
Epoch: 1, Steps: 52 | Train Loss: 0.7550469 Vali Loss: 2.2135501 Test Loss: 1.4140856
Validation loss decreased (inf --> 2.213550).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 2 cost time: 0.7574994564056396
Epoch: 2, Steps: 52 | Train Loss: 0.6259021 Vali Loss: 1.6131554 Test Loss: 0.6882145
Validation loss decreased (2.213550 --> 1.613155).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 3 cost time: 0.7529997825622559
Epoch: 3, Steps: 52 | Train Loss: 0.4953261 Vali Loss: 1.4363714 Test Loss: 0.4458992
Validation loss decreased (1.613155 --> 1.436371).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 4 cost time: 0.7503926753997803
Epoch: 4, Steps: 52 | Train Loss: 0.4566517 Vali Loss: 1.4014988 Test Loss: 0.4014360
Validation loss decreased (1.436371 --> 1.401499).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 5 cost time: 0.7493975162506104
Epoch: 5, Steps: 52 | Train Loss: 0.4437496 Vali Loss: 1.3838725 Test Loss: 0.3845206
Validation loss decreased (1.401499 --> 1.383873).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 6 cost time: 1.6449048519134521
Epoch: 6, Steps: 52 | Train Loss: 0.4364062 Vali Loss: 1.3808756 Test Loss: 0.3746225
Validation loss decreased (1.383873 --> 1.380876).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 7 cost time: 1.6664140224456787
Epoch: 7, Steps: 52 | Train Loss: 0.4305784 Vali Loss: 1.3684938 Test Loss: 0.3671170
Validation loss decreased (1.380876 --> 1.368494).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 8 cost time: 1.6816821098327637
Epoch: 8, Steps: 52 | Train Loss: 0.4275343 Vali Loss: 1.3580317 Test Loss: 0.3617634
Validation loss decreased (1.368494 --> 1.358032).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 9 cost time: 1.6753566265106201
Epoch: 9, Steps: 52 | Train Loss: 0.4236857 Vali Loss: 1.3597035 Test Loss: 0.3577434
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 10 cost time: 1.6853137016296387
Epoch: 10, Steps: 52 | Train Loss: 0.4225261 Vali Loss: 1.3489908 Test Loss: 0.3544369
Validation loss decreased (1.358032 --> 1.348991).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 11 cost time: 1.6709918975830078
Epoch: 11, Steps: 52 | Train Loss: 0.4186570 Vali Loss: 1.3536015 Test Loss: 0.3523905
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 12 cost time: 1.6779074668884277
Epoch: 12, Steps: 52 | Train Loss: 0.4184664 Vali Loss: 1.3499382 Test Loss: 0.3504672
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 13 cost time: 1.6746375560760498
Epoch: 13, Steps: 52 | Train Loss: 0.4177526 Vali Loss: 1.3429904 Test Loss: 0.3489550
Validation loss decreased (1.348991 --> 1.342990).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 14 cost time: 1.67476487159729
Epoch: 14, Steps: 52 | Train Loss: 0.4162954 Vali Loss: 1.3453925 Test Loss: 0.3480445
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 15 cost time: 1.670959234237671
Epoch: 15, Steps: 52 | Train Loss: 0.4144096 Vali Loss: 1.3438513 Test Loss: 0.3464935
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 16 cost time: 1.6753931045532227
Epoch: 16, Steps: 52 | Train Loss: 0.4145544 Vali Loss: 1.3368620 Test Loss: 0.3451905
Validation loss decreased (1.342990 --> 1.336862).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 17 cost time: 1.6722567081451416
Epoch: 17, Steps: 52 | Train Loss: 0.4142092 Vali Loss: 1.3384047 Test Loss: 0.3440886
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 18 cost time: 1.6795179843902588
Epoch: 18, Steps: 52 | Train Loss: 0.4122154 Vali Loss: 1.3394074 Test Loss: 0.3442422
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 19 cost time: 1.6735138893127441
Epoch: 19, Steps: 52 | Train Loss: 0.4111400 Vali Loss: 1.3257291 Test Loss: 0.3432947
Validation loss decreased (1.336862 --> 1.325729).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 20 cost time: 1.6745882034301758
Epoch: 20, Steps: 52 | Train Loss: 0.4130874 Vali Loss: 1.3295131 Test Loss: 0.3417804
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 21 cost time: 1.672321081161499
Epoch: 21, Steps: 52 | Train Loss: 0.4114703 Vali Loss: 1.3377087 Test Loss: 0.3420597
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 22 cost time: 1.6715805530548096
Epoch: 22, Steps: 52 | Train Loss: 0.4110026 Vali Loss: 1.3352582 Test Loss: 0.3415100
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 23 cost time: 1.67673921585083
Epoch: 23, Steps: 52 | Train Loss: 0.4112731 Vali Loss: 1.3265560 Test Loss: 0.3407044
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 24 cost time: 1.6739256381988525
Epoch: 24, Steps: 52 | Train Loss: 0.4102756 Vali Loss: 1.3355155 Test Loss: 0.3406099
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 25 cost time: 1.673659324645996
Epoch: 25, Steps: 52 | Train Loss: 0.4101459 Vali Loss: 1.3219147 Test Loss: 0.3402142
Validation loss decreased (1.325729 --> 1.321915).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 26 cost time: 1.6731359958648682
Epoch: 26, Steps: 52 | Train Loss: 0.4090851 Vali Loss: 1.3179917 Test Loss: 0.3402078
Validation loss decreased (1.321915 --> 1.317992).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 27 cost time: 1.6765961647033691
Epoch: 27, Steps: 52 | Train Loss: 0.4090650 Vali Loss: 1.3242190 Test Loss: 0.3395436
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 28 cost time: 1.669560194015503
Epoch: 28, Steps: 52 | Train Loss: 0.4077804 Vali Loss: 1.3250645 Test Loss: 0.3394797
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 29 cost time: 1.6745498180389404
Epoch: 29, Steps: 52 | Train Loss: 0.4090763 Vali Loss: 1.3199568 Test Loss: 0.3394934
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 30 cost time: 1.6709303855895996
Epoch: 30, Steps: 52 | Train Loss: 0.4104814 Vali Loss: 1.3273070 Test Loss: 0.3391696
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 31 cost time: 1.6711058616638184
Epoch: 31, Steps: 52 | Train Loss: 0.4099167 Vali Loss: 1.3292844 Test Loss: 0.3394770
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 32 cost time: 1.6663975715637207
Epoch: 32, Steps: 52 | Train Loss: 0.4087588 Vali Loss: 1.3297364 Test Loss: 0.3383000
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 33 cost time: 1.6734259128570557
Epoch: 33, Steps: 52 | Train Loss: 0.4086198 Vali Loss: 1.3254230 Test Loss: 0.3385665
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 34 cost time: 1.6721079349517822
Epoch: 34, Steps: 52 | Train Loss: 0.4080269 Vali Loss: 1.3217630 Test Loss: 0.3381937
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 35 cost time: 1.6769554615020752
Epoch: 35, Steps: 52 | Train Loss: 0.4090968 Vali Loss: 1.3305693 Test Loss: 0.3380085
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 36 cost time: 1.6719403266906738
Epoch: 36, Steps: 52 | Train Loss: 0.4097568 Vali Loss: 1.3244646 Test Loss: 0.3384060
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 37 cost time: 1.6780788898468018
Epoch: 37, Steps: 52 | Train Loss: 0.4078319 Vali Loss: 1.3266778 Test Loss: 0.3380617
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 38 cost time: 1.67405104637146
Epoch: 38, Steps: 52 | Train Loss: 0.4080509 Vali Loss: 1.3197472 Test Loss: 0.3380855
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 39 cost time: 1.6791958808898926
Epoch: 39, Steps: 52 | Train Loss: 0.4089180 Vali Loss: 1.3137344 Test Loss: 0.3389384
Validation loss decreased (1.317992 --> 1.313734).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 40 cost time: 1.6717066764831543
Epoch: 40, Steps: 52 | Train Loss: 0.4079437 Vali Loss: 1.3268831 Test Loss: 0.3382616
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 41 cost time: 1.675459861755371
Epoch: 41, Steps: 52 | Train Loss: 0.4083027 Vali Loss: 1.3201096 Test Loss: 0.3378325
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 42 cost time: 1.6661598682403564
Epoch: 42, Steps: 52 | Train Loss: 0.4057794 Vali Loss: 1.3287731 Test Loss: 0.3381519
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 43 cost time: 1.6809422969818115
Epoch: 43, Steps: 52 | Train Loss: 0.4076582 Vali Loss: 1.3292848 Test Loss: 0.3382798
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 44 cost time: 1.6725847721099854
Epoch: 44, Steps: 52 | Train Loss: 0.4073742 Vali Loss: 1.3211420 Test Loss: 0.3374826
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 45 cost time: 1.6813273429870605
Epoch: 45, Steps: 52 | Train Loss: 0.4086577 Vali Loss: 1.3178785 Test Loss: 0.3379696
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 46 cost time: 1.6705589294433594
Epoch: 46, Steps: 52 | Train Loss: 0.4088673 Vali Loss: 1.3246877 Test Loss: 0.3380184
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 47 cost time: 1.6730692386627197
Epoch: 47, Steps: 52 | Train Loss: 0.4075784 Vali Loss: 1.3254616 Test Loss: 0.3374346
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 48 cost time: 1.6701629161834717
Epoch: 48, Steps: 52 | Train Loss: 0.4076792 Vali Loss: 1.3198335 Test Loss: 0.3376219
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 49 cost time: 1.6734051704406738
Epoch: 49, Steps: 52 | Train Loss: 0.4065499 Vali Loss: 1.3282504 Test Loss: 0.3375976
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 50 cost time: 1.6719303131103516
Epoch: 50, Steps: 52 | Train Loss: 0.4074636 Vali Loss: 1.3179266 Test Loss: 0.3381718
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 51 cost time: 1.6734724044799805
Epoch: 51, Steps: 52 | Train Loss: 0.4063867 Vali Loss: 1.3243159 Test Loss: 0.3382140
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 52 cost time: 1.6683964729309082
Epoch: 52, Steps: 52 | Train Loss: 0.4064309 Vali Loss: 1.3211733 Test Loss: 0.3380138
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 53 cost time: 1.6733076572418213
Epoch: 53, Steps: 52 | Train Loss: 0.4073734 Vali Loss: 1.3243804 Test Loss: 0.3385745
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 54 cost time: 1.6712005138397217
Epoch: 54, Steps: 52 | Train Loss: 0.4073701 Vali Loss: 1.3185741 Test Loss: 0.3375632
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 55 cost time: 1.6715519428253174
Epoch: 55, Steps: 52 | Train Loss: 0.4082571 Vali Loss: 1.3181560 Test Loss: 0.3388731
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 56 cost time: 1.6740248203277588
Epoch: 56, Steps: 52 | Train Loss: 0.4066532 Vali Loss: 1.3190305 Test Loss: 0.3369866
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 57 cost time: 1.6714420318603516
Epoch: 57, Steps: 52 | Train Loss: 0.4077651 Vali Loss: 1.3159475 Test Loss: 0.3366891
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 58 cost time: 1.6854870319366455
Epoch: 58, Steps: 52 | Train Loss: 0.4088036 Vali Loss: 1.3137696 Test Loss: 0.3369273
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 59 cost time: 1.6914033889770508
Epoch: 59, Steps: 52 | Train Loss: 0.4072782 Vali Loss: 1.3203945 Test Loss: 0.3379460
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 60 cost time: 1.6892824172973633
Epoch: 60, Steps: 52 | Train Loss: 0.4071781 Vali Loss: 1.3214738 Test Loss: 0.3369572
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.338938444852829, mae:0.38519200682640076, rse:0.4769459664821625
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05185985565185547 GB
Epoch: 1 cost time: 2.1087453365325928
Epoch: 1, Steps: 52 | Train Loss: 0.7122015 Vali Loss: 2.1546876 Test Loss: 1.3704498
Validation loss decreased (inf --> 2.154688).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 2 cost time: 0.7893736362457275
Epoch: 2, Steps: 52 | Train Loss: 0.6095269 Vali Loss: 1.6325266 Test Loss: 0.7246621
Validation loss decreased (2.154688 --> 1.632527).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 3 cost time: 0.7844007015228271
Epoch: 3, Steps: 52 | Train Loss: 0.4842597 Vali Loss: 1.4306949 Test Loss: 0.4370179
Validation loss decreased (1.632527 --> 1.430695).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 4 cost time: 0.7842292785644531
Epoch: 4, Steps: 52 | Train Loss: 0.4465333 Vali Loss: 1.3996172 Test Loss: 0.3995996
Validation loss decreased (1.430695 --> 1.399617).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 5 cost time: 0.775362491607666
Epoch: 5, Steps: 52 | Train Loss: 0.4331828 Vali Loss: 1.3833683 Test Loss: 0.3834024
Validation loss decreased (1.399617 --> 1.383368).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 6 cost time: 1.745934247970581
Epoch: 6, Steps: 52 | Train Loss: 0.4269925 Vali Loss: 1.3672851 Test Loss: 0.3727255
Validation loss decreased (1.383368 --> 1.367285).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 7 cost time: 1.7464094161987305
Epoch: 7, Steps: 52 | Train Loss: 0.4225951 Vali Loss: 1.3668470 Test Loss: 0.3657619
Validation loss decreased (1.367285 --> 1.366847).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 8 cost time: 1.7448394298553467
Epoch: 8, Steps: 52 | Train Loss: 0.4205591 Vali Loss: 1.3528545 Test Loss: 0.3608642
Validation loss decreased (1.366847 --> 1.352854).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 9 cost time: 1.7465007305145264
Epoch: 9, Steps: 52 | Train Loss: 0.4175491 Vali Loss: 1.3497193 Test Loss: 0.3575719
Validation loss decreased (1.352854 --> 1.349719).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 10 cost time: 1.744938611984253
Epoch: 10, Steps: 52 | Train Loss: 0.4154319 Vali Loss: 1.3394878 Test Loss: 0.3542176
Validation loss decreased (1.349719 --> 1.339488).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 11 cost time: 1.7502894401550293
Epoch: 11, Steps: 52 | Train Loss: 0.4145756 Vali Loss: 1.3334404 Test Loss: 0.3520274
Validation loss decreased (1.339488 --> 1.333440).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 12 cost time: 1.747180461883545
Epoch: 12, Steps: 52 | Train Loss: 0.4142598 Vali Loss: 1.3334877 Test Loss: 0.3508001
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 13 cost time: 1.7429816722869873
Epoch: 13, Steps: 52 | Train Loss: 0.4141011 Vali Loss: 1.3348814 Test Loss: 0.3481978
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 14 cost time: 1.7524909973144531
Epoch: 14, Steps: 52 | Train Loss: 0.4113194 Vali Loss: 1.3297179 Test Loss: 0.3482606
Validation loss decreased (1.333440 --> 1.329718).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 15 cost time: 1.7469558715820312
Epoch: 15, Steps: 52 | Train Loss: 0.4110801 Vali Loss: 1.3205822 Test Loss: 0.3463039
Validation loss decreased (1.329718 --> 1.320582).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 16 cost time: 1.756037712097168
Epoch: 16, Steps: 52 | Train Loss: 0.4105519 Vali Loss: 1.3302962 Test Loss: 0.3462411
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 17 cost time: 1.7531425952911377
Epoch: 17, Steps: 52 | Train Loss: 0.4097068 Vali Loss: 1.3287983 Test Loss: 0.3450412
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 18 cost time: 1.7515513896942139
Epoch: 18, Steps: 52 | Train Loss: 0.4075299 Vali Loss: 1.3227177 Test Loss: 0.3430546
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 19 cost time: 1.7532284259796143
Epoch: 19, Steps: 52 | Train Loss: 0.4097105 Vali Loss: 1.3238125 Test Loss: 0.3428356
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 20 cost time: 1.7529382705688477
Epoch: 20, Steps: 52 | Train Loss: 0.4097356 Vali Loss: 1.3190763 Test Loss: 0.3423762
Validation loss decreased (1.320582 --> 1.319076).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 21 cost time: 1.747736930847168
Epoch: 21, Steps: 52 | Train Loss: 0.4086990 Vali Loss: 1.3211315 Test Loss: 0.3428688
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 22 cost time: 1.7491586208343506
Epoch: 22, Steps: 52 | Train Loss: 0.4055552 Vali Loss: 1.3203250 Test Loss: 0.3423283
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 23 cost time: 1.7452666759490967
Epoch: 23, Steps: 52 | Train Loss: 0.4075455 Vali Loss: 1.3206676 Test Loss: 0.3418877
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 24 cost time: 1.7502920627593994
Epoch: 24, Steps: 52 | Train Loss: 0.4072817 Vali Loss: 1.3106396 Test Loss: 0.3425809
Validation loss decreased (1.319076 --> 1.310640).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 25 cost time: 1.740288257598877
Epoch: 25, Steps: 52 | Train Loss: 0.4064438 Vali Loss: 1.3168826 Test Loss: 0.3403115
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 26 cost time: 1.748903512954712
Epoch: 26, Steps: 52 | Train Loss: 0.4063100 Vali Loss: 1.3089249 Test Loss: 0.3419004
Validation loss decreased (1.310640 --> 1.308925).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 27 cost time: 1.750152349472046
Epoch: 27, Steps: 52 | Train Loss: 0.4060507 Vali Loss: 1.3205464 Test Loss: 0.3404301
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 28 cost time: 1.7560806274414062
Epoch: 28, Steps: 52 | Train Loss: 0.4060374 Vali Loss: 1.3049321 Test Loss: 0.3409784
Validation loss decreased (1.308925 --> 1.304932).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 29 cost time: 1.746443271636963
Epoch: 29, Steps: 52 | Train Loss: 0.4065045 Vali Loss: 1.3145858 Test Loss: 0.3406813
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 30 cost time: 1.7496657371520996
Epoch: 30, Steps: 52 | Train Loss: 0.4047330 Vali Loss: 1.3209891 Test Loss: 0.3402879
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 31 cost time: 1.7544405460357666
Epoch: 31, Steps: 52 | Train Loss: 0.4068626 Vali Loss: 1.3164819 Test Loss: 0.3406609
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 32 cost time: 1.7521865367889404
Epoch: 32, Steps: 52 | Train Loss: 0.4050621 Vali Loss: 1.3154473 Test Loss: 0.3410373
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 33 cost time: 1.7530388832092285
Epoch: 33, Steps: 52 | Train Loss: 0.4064596 Vali Loss: 1.3122280 Test Loss: 0.3396498
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 34 cost time: 1.7495453357696533
Epoch: 34, Steps: 52 | Train Loss: 0.4040483 Vali Loss: 1.3140600 Test Loss: 0.3406180
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 35 cost time: 1.7460918426513672
Epoch: 35, Steps: 52 | Train Loss: 0.4063349 Vali Loss: 1.3175896 Test Loss: 0.3402502
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 36 cost time: 1.7481446266174316
Epoch: 36, Steps: 52 | Train Loss: 0.4043666 Vali Loss: 1.3124381 Test Loss: 0.3404163
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 37 cost time: 1.7542695999145508
Epoch: 37, Steps: 52 | Train Loss: 0.4038371 Vali Loss: 1.3061142 Test Loss: 0.3385243
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 38 cost time: 1.7466990947723389
Epoch: 38, Steps: 52 | Train Loss: 0.4054886 Vali Loss: 1.3131797 Test Loss: 0.3415020
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 39 cost time: 1.7500264644622803
Epoch: 39, Steps: 52 | Train Loss: 0.4052332 Vali Loss: 1.3133386 Test Loss: 0.3392913
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 40 cost time: 1.7473559379577637
Epoch: 40, Steps: 52 | Train Loss: 0.4051940 Vali Loss: 1.3099191 Test Loss: 0.3405521
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 41 cost time: 1.7523539066314697
Epoch: 41, Steps: 52 | Train Loss: 0.4051702 Vali Loss: 1.3075180 Test Loss: 0.3400509
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 42 cost time: 1.7460300922393799
Epoch: 42, Steps: 52 | Train Loss: 0.4059627 Vali Loss: 1.3127812 Test Loss: 0.3386091
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 43 cost time: 1.746263027191162
Epoch: 43, Steps: 52 | Train Loss: 0.4039858 Vali Loss: 1.3057346 Test Loss: 0.3397155
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 44 cost time: 1.7505338191986084
Epoch: 44, Steps: 52 | Train Loss: 0.4048836 Vali Loss: 1.3166697 Test Loss: 0.3395211
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 45 cost time: 1.7481896877288818
Epoch: 45, Steps: 52 | Train Loss: 0.4056491 Vali Loss: 1.3103232 Test Loss: 0.3405124
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 46 cost time: 1.7464122772216797
Epoch: 46, Steps: 52 | Train Loss: 0.4050028 Vali Loss: 1.3112987 Test Loss: 0.3392360
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 47 cost time: 1.7449393272399902
Epoch: 47, Steps: 52 | Train Loss: 0.4041768 Vali Loss: 1.3057413 Test Loss: 0.3391125
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 48 cost time: 1.7503163814544678
Epoch: 48, Steps: 52 | Train Loss: 0.4054415 Vali Loss: 1.3117096 Test Loss: 0.3399144
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 49 cost time: 1.7482941150665283
Epoch: 49, Steps: 52 | Train Loss: 0.4043194 Vali Loss: 1.3063928 Test Loss: 0.3398768
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 50 cost time: 1.7503728866577148
Epoch: 50, Steps: 52 | Train Loss: 0.4045735 Vali Loss: 1.3075380 Test Loss: 0.3399416
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 51 cost time: 1.74525785446167
Epoch: 51, Steps: 52 | Train Loss: 0.4056028 Vali Loss: 1.3167946 Test Loss: 0.3390513
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 52 cost time: 1.7522318363189697
Epoch: 52, Steps: 52 | Train Loss: 0.4044699 Vali Loss: 1.3162032 Test Loss: 0.3390414
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 53 cost time: 1.744335651397705
Epoch: 53, Steps: 52 | Train Loss: 0.4040719 Vali Loss: 1.3099482 Test Loss: 0.3398364
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 54 cost time: 1.7419605255126953
Epoch: 54, Steps: 52 | Train Loss: 0.4051546 Vali Loss: 1.3122398 Test Loss: 0.3397494
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 55 cost time: 1.7438511848449707
Epoch: 55, Steps: 52 | Train Loss: 0.4040340 Vali Loss: 1.3087592 Test Loss: 0.3390059
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 56 cost time: 1.7547426223754883
Epoch: 56, Steps: 52 | Train Loss: 0.4053890 Vali Loss: 1.3154038 Test Loss: 0.3391142
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 57 cost time: 1.743818998336792
Epoch: 57, Steps: 52 | Train Loss: 0.4051668 Vali Loss: 1.3114222 Test Loss: 0.3406852
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 58 cost time: 1.7458572387695312
Epoch: 58, Steps: 52 | Train Loss: 0.4054814 Vali Loss: 1.3056505 Test Loss: 0.3397822
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 59 cost time: 1.74513840675354
Epoch: 59, Steps: 52 | Train Loss: 0.4058195 Vali Loss: 1.3165574 Test Loss: 0.3391635
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 60 cost time: 1.741621971130371
Epoch: 60, Steps: 52 | Train Loss: 0.4037542 Vali Loss: 1.3119574 Test Loss: 0.3395606
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34097838401794434, mae:0.3905909061431885, rse:0.47837916016578674
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.049469947814941406 GB
Epoch: 1 cost time: 2.1012463569641113
Epoch: 1, Steps: 52 | Train Loss: 0.9601281 Vali Loss: 2.6000028 Test Loss: 1.8179951
Validation loss decreased (inf --> 2.600003).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 2 cost time: 0.7356281280517578
Epoch: 2, Steps: 52 | Train Loss: 0.8125769 Vali Loss: 1.8905299 Test Loss: 1.0298275
Validation loss decreased (2.600003 --> 1.890530).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 3 cost time: 0.7423722743988037
Epoch: 3, Steps: 52 | Train Loss: 0.6278503 Vali Loss: 1.5808282 Test Loss: 0.6316439
Validation loss decreased (1.890530 --> 1.580828).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 4 cost time: 0.7400000095367432
Epoch: 4, Steps: 52 | Train Loss: 0.5402622 Vali Loss: 1.4530960 Test Loss: 0.4601525
Validation loss decreased (1.580828 --> 1.453096).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 5 cost time: 0.743614673614502
Epoch: 5, Steps: 52 | Train Loss: 0.5025510 Vali Loss: 1.4157648 Test Loss: 0.4128680
Validation loss decreased (1.453096 --> 1.415765).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 6 cost time: 1.530280351638794
Epoch: 6, Steps: 52 | Train Loss: 0.4847177 Vali Loss: 1.4000809 Test Loss: 0.3949426
Validation loss decreased (1.415765 --> 1.400081).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 7 cost time: 1.638864517211914
Epoch: 7, Steps: 52 | Train Loss: 0.4727168 Vali Loss: 1.3920404 Test Loss: 0.3846188
Validation loss decreased (1.400081 --> 1.392040).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 8 cost time: 1.6483170986175537
Epoch: 8, Steps: 52 | Train Loss: 0.4637075 Vali Loss: 1.3646002 Test Loss: 0.3768879
Validation loss decreased (1.392040 --> 1.364600).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 9 cost time: 1.6454005241394043
Epoch: 9, Steps: 52 | Train Loss: 0.4584601 Vali Loss: 1.3624070 Test Loss: 0.3709326
Validation loss decreased (1.364600 --> 1.362407).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 10 cost time: 1.6484363079071045
Epoch: 10, Steps: 52 | Train Loss: 0.4536610 Vali Loss: 1.3629615 Test Loss: 0.3667952
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 11 cost time: 1.642650842666626
Epoch: 11, Steps: 52 | Train Loss: 0.4499100 Vali Loss: 1.3580904 Test Loss: 0.3636910
Validation loss decreased (1.362407 --> 1.358090).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 12 cost time: 1.6495583057403564
Epoch: 12, Steps: 52 | Train Loss: 0.4466588 Vali Loss: 1.3598244 Test Loss: 0.3611483
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 13 cost time: 1.636366367340088
Epoch: 13, Steps: 52 | Train Loss: 0.4450181 Vali Loss: 1.3472675 Test Loss: 0.3584364
Validation loss decreased (1.358090 --> 1.347268).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 14 cost time: 1.6409566402435303
Epoch: 14, Steps: 52 | Train Loss: 0.4414567 Vali Loss: 1.3444157 Test Loss: 0.3568189
Validation loss decreased (1.347268 --> 1.344416).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 15 cost time: 1.6390304565429688
Epoch: 15, Steps: 52 | Train Loss: 0.4406861 Vali Loss: 1.3499579 Test Loss: 0.3548507
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 16 cost time: 1.6415400505065918
Epoch: 16, Steps: 52 | Train Loss: 0.4389081 Vali Loss: 1.3431370 Test Loss: 0.3538017
Validation loss decreased (1.344416 --> 1.343137).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 17 cost time: 1.6464688777923584
Epoch: 17, Steps: 52 | Train Loss: 0.4351307 Vali Loss: 1.3376944 Test Loss: 0.3522594
Validation loss decreased (1.343137 --> 1.337694).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 18 cost time: 1.646475076675415
Epoch: 18, Steps: 52 | Train Loss: 0.4351271 Vali Loss: 1.3460546 Test Loss: 0.3516384
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 19 cost time: 1.645939826965332
Epoch: 19, Steps: 52 | Train Loss: 0.4357339 Vali Loss: 1.3459817 Test Loss: 0.3510488
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 20 cost time: 1.6470232009887695
Epoch: 20, Steps: 52 | Train Loss: 0.4327145 Vali Loss: 1.3318578 Test Loss: 0.3496164
Validation loss decreased (1.337694 --> 1.331858).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 21 cost time: 1.6412379741668701
Epoch: 21, Steps: 52 | Train Loss: 0.4327292 Vali Loss: 1.3281580 Test Loss: 0.3493230
Validation loss decreased (1.331858 --> 1.328158).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 22 cost time: 1.644373893737793
Epoch: 22, Steps: 52 | Train Loss: 0.4317687 Vali Loss: 1.3358102 Test Loss: 0.3489307
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 23 cost time: 1.637080430984497
Epoch: 23, Steps: 52 | Train Loss: 0.4328612 Vali Loss: 1.3323034 Test Loss: 0.3483103
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 24 cost time: 1.6402688026428223
Epoch: 24, Steps: 52 | Train Loss: 0.4315643 Vali Loss: 1.3224641 Test Loss: 0.3466865
Validation loss decreased (1.328158 --> 1.322464).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 25 cost time: 1.6359784603118896
Epoch: 25, Steps: 52 | Train Loss: 0.4305079 Vali Loss: 1.3334351 Test Loss: 0.3472190
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 26 cost time: 1.6433348655700684
Epoch: 26, Steps: 52 | Train Loss: 0.4286016 Vali Loss: 1.3347971 Test Loss: 0.3464459
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 27 cost time: 1.6378910541534424
Epoch: 27, Steps: 52 | Train Loss: 0.4290738 Vali Loss: 1.3268086 Test Loss: 0.3461449
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 28 cost time: 1.6421244144439697
Epoch: 28, Steps: 52 | Train Loss: 0.4300457 Vali Loss: 1.3309135 Test Loss: 0.3466026
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 29 cost time: 1.6425528526306152
Epoch: 29, Steps: 52 | Train Loss: 0.4284896 Vali Loss: 1.3358867 Test Loss: 0.3460301
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 30 cost time: 1.638990879058838
Epoch: 30, Steps: 52 | Train Loss: 0.4279884 Vali Loss: 1.3354452 Test Loss: 0.3452242
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 31 cost time: 1.6365618705749512
Epoch: 31, Steps: 52 | Train Loss: 0.4283555 Vali Loss: 1.3288467 Test Loss: 0.3454716
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 32 cost time: 1.6379787921905518
Epoch: 32, Steps: 52 | Train Loss: 0.4292982 Vali Loss: 1.3325849 Test Loss: 0.3453489
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 33 cost time: 1.639519453048706
Epoch: 33, Steps: 52 | Train Loss: 0.4275433 Vali Loss: 1.3295799 Test Loss: 0.3450956
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 34 cost time: 1.644684076309204
Epoch: 34, Steps: 52 | Train Loss: 0.4250638 Vali Loss: 1.3351731 Test Loss: 0.3447475
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 35 cost time: 1.6404197216033936
Epoch: 35, Steps: 52 | Train Loss: 0.4275853 Vali Loss: 1.3320448 Test Loss: 0.3445948
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 36 cost time: 1.6409177780151367
Epoch: 36, Steps: 52 | Train Loss: 0.4275298 Vali Loss: 1.3241798 Test Loss: 0.3447592
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 37 cost time: 1.6415047645568848
Epoch: 37, Steps: 52 | Train Loss: 0.4273316 Vali Loss: 1.3305836 Test Loss: 0.3449463
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 38 cost time: 1.6452839374542236
Epoch: 38, Steps: 52 | Train Loss: 0.4269409 Vali Loss: 1.3299989 Test Loss: 0.3440538
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 39 cost time: 1.6448564529418945
Epoch: 39, Steps: 52 | Train Loss: 0.4243972 Vali Loss: 1.3209765 Test Loss: 0.3443108
Validation loss decreased (1.322464 --> 1.320976).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 40 cost time: 1.6461730003356934
Epoch: 40, Steps: 52 | Train Loss: 0.4255251 Vali Loss: 1.3293345 Test Loss: 0.3443788
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 41 cost time: 1.6356878280639648
Epoch: 41, Steps: 52 | Train Loss: 0.4262592 Vali Loss: 1.3299123 Test Loss: 0.3441653
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 42 cost time: 1.6411411762237549
Epoch: 42, Steps: 52 | Train Loss: 0.4253255 Vali Loss: 1.3309910 Test Loss: 0.3435487
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 43 cost time: 1.6375505924224854
Epoch: 43, Steps: 52 | Train Loss: 0.4264735 Vali Loss: 1.3280653 Test Loss: 0.3436562
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 44 cost time: 1.6415016651153564
Epoch: 44, Steps: 52 | Train Loss: 0.4264388 Vali Loss: 1.3332446 Test Loss: 0.3439762
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 45 cost time: 1.638805627822876
Epoch: 45, Steps: 52 | Train Loss: 0.4252640 Vali Loss: 1.3249629 Test Loss: 0.3443438
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 46 cost time: 1.641535997390747
Epoch: 46, Steps: 52 | Train Loss: 0.4239611 Vali Loss: 1.3279378 Test Loss: 0.3441183
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 47 cost time: 1.6394686698913574
Epoch: 47, Steps: 52 | Train Loss: 0.4261229 Vali Loss: 1.3289838 Test Loss: 0.3442113
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 48 cost time: 1.64328932762146
Epoch: 48, Steps: 52 | Train Loss: 0.4255981 Vali Loss: 1.3340280 Test Loss: 0.3439358
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 49 cost time: 1.637892484664917
Epoch: 49, Steps: 52 | Train Loss: 0.4267223 Vali Loss: 1.3245109 Test Loss: 0.3440851
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 50 cost time: 1.6486544609069824
Epoch: 50, Steps: 52 | Train Loss: 0.4257420 Vali Loss: 1.3326578 Test Loss: 0.3441750
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 51 cost time: 1.6349461078643799
Epoch: 51, Steps: 52 | Train Loss: 0.4263619 Vali Loss: 1.3209872 Test Loss: 0.3441094
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 52 cost time: 1.6398351192474365
Epoch: 52, Steps: 52 | Train Loss: 0.4249215 Vali Loss: 1.3254544 Test Loss: 0.3439122
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 53 cost time: 1.6397919654846191
Epoch: 53, Steps: 52 | Train Loss: 0.4251179 Vali Loss: 1.3179338 Test Loss: 0.3442906
Validation loss decreased (1.320976 --> 1.317934).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 54 cost time: 1.6470251083374023
Epoch: 54, Steps: 52 | Train Loss: 0.4262889 Vali Loss: 1.3295493 Test Loss: 0.3441095
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 55 cost time: 1.643892765045166
Epoch: 55, Steps: 52 | Train Loss: 0.4270762 Vali Loss: 1.3300707 Test Loss: 0.3441331
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 56 cost time: 1.640462875366211
Epoch: 56, Steps: 52 | Train Loss: 0.4244864 Vali Loss: 1.3321668 Test Loss: 0.3442852
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 57 cost time: 1.6363880634307861
Epoch: 57, Steps: 52 | Train Loss: 0.4264976 Vali Loss: 1.3235908 Test Loss: 0.3433658
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 58 cost time: 1.6433215141296387
Epoch: 58, Steps: 52 | Train Loss: 0.4255727 Vali Loss: 1.3299220 Test Loss: 0.3435798
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 59 cost time: 1.6390531063079834
Epoch: 59, Steps: 52 | Train Loss: 0.4255109 Vali Loss: 1.3237925 Test Loss: 0.3432802
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 60 cost time: 1.644474744796753
Epoch: 60, Steps: 52 | Train Loss: 0.4234946 Vali Loss: 1.3323146 Test Loss: 0.3433931
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34429052472114563, mae:0.3881438076496124, rse:0.4806969463825226
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05090188980102539 GB
Epoch: 1 cost time: 2.1868503093719482
Epoch: 1, Steps: 52 | Train Loss: 0.7049466 Vali Loss: 2.0815480 Test Loss: 1.3010044
Validation loss decreased (inf --> 2.081548).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 2 cost time: 0.776115894317627
Epoch: 2, Steps: 52 | Train Loss: 0.6055701 Vali Loss: 1.5966194 Test Loss: 0.7062393
Validation loss decreased (2.081548 --> 1.596619).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 3 cost time: 0.7494454383850098
Epoch: 3, Steps: 52 | Train Loss: 0.4907793 Vali Loss: 1.4264321 Test Loss: 0.4461999
Validation loss decreased (1.596619 --> 1.426432).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 4 cost time: 0.742332935333252
Epoch: 4, Steps: 52 | Train Loss: 0.4510051 Vali Loss: 1.3919861 Test Loss: 0.3993751
Validation loss decreased (1.426432 --> 1.391986).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 5 cost time: 0.7493550777435303
Epoch: 5, Steps: 52 | Train Loss: 0.4361173 Vali Loss: 1.3789324 Test Loss: 0.3837828
Validation loss decreased (1.391986 --> 1.378932).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 6 cost time: 1.694650650024414
Epoch: 6, Steps: 52 | Train Loss: 0.4307009 Vali Loss: 1.3650582 Test Loss: 0.3728662
Validation loss decreased (1.378932 --> 1.365058).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 7 cost time: 1.6964125633239746
Epoch: 7, Steps: 52 | Train Loss: 0.4244125 Vali Loss: 1.3548787 Test Loss: 0.3667636
Validation loss decreased (1.365058 --> 1.354879).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 8 cost time: 1.7024705410003662
Epoch: 8, Steps: 52 | Train Loss: 0.4231708 Vali Loss: 1.3588029 Test Loss: 0.3617911
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 9 cost time: 1.699469804763794
Epoch: 9, Steps: 52 | Train Loss: 0.4216850 Vali Loss: 1.3516035 Test Loss: 0.3583611
Validation loss decreased (1.354879 --> 1.351604).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 10 cost time: 1.7025628089904785
Epoch: 10, Steps: 52 | Train Loss: 0.4177567 Vali Loss: 1.3449290 Test Loss: 0.3547365
Validation loss decreased (1.351604 --> 1.344929).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 11 cost time: 1.6968324184417725
Epoch: 11, Steps: 52 | Train Loss: 0.4160030 Vali Loss: 1.3348844 Test Loss: 0.3521265
Validation loss decreased (1.344929 --> 1.334884).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 12 cost time: 1.6965522766113281
Epoch: 12, Steps: 52 | Train Loss: 0.4138764 Vali Loss: 1.3320887 Test Loss: 0.3504062
Validation loss decreased (1.334884 --> 1.332089).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 13 cost time: 1.694373369216919
Epoch: 13, Steps: 52 | Train Loss: 0.4133590 Vali Loss: 1.3385918 Test Loss: 0.3485236
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 14 cost time: 1.6963095664978027
Epoch: 14, Steps: 52 | Train Loss: 0.4118450 Vali Loss: 1.3259022 Test Loss: 0.3475699
Validation loss decreased (1.332089 --> 1.325902).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 15 cost time: 1.701357364654541
Epoch: 15, Steps: 52 | Train Loss: 0.4110001 Vali Loss: 1.3236599 Test Loss: 0.3465383
Validation loss decreased (1.325902 --> 1.323660).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 16 cost time: 1.7014472484588623
Epoch: 16, Steps: 52 | Train Loss: 0.4103699 Vali Loss: 1.3304207 Test Loss: 0.3455369
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 17 cost time: 1.700998306274414
Epoch: 17, Steps: 52 | Train Loss: 0.4097337 Vali Loss: 1.3229868 Test Loss: 0.3449284
Validation loss decreased (1.323660 --> 1.322987).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 18 cost time: 1.7025775909423828
Epoch: 18, Steps: 52 | Train Loss: 0.4092760 Vali Loss: 1.3219981 Test Loss: 0.3441629
Validation loss decreased (1.322987 --> 1.321998).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 19 cost time: 1.7011244297027588
Epoch: 19, Steps: 52 | Train Loss: 0.4088008 Vali Loss: 1.3263992 Test Loss: 0.3434127
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 20 cost time: 1.6998944282531738
Epoch: 20, Steps: 52 | Train Loss: 0.4081533 Vali Loss: 1.3222556 Test Loss: 0.3435253
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 21 cost time: 1.6980843544006348
Epoch: 21, Steps: 52 | Train Loss: 0.4062997 Vali Loss: 1.3076175 Test Loss: 0.3428958
Validation loss decreased (1.321998 --> 1.307618).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 22 cost time: 1.6958115100860596
Epoch: 22, Steps: 52 | Train Loss: 0.4077617 Vali Loss: 1.3192519 Test Loss: 0.3424509
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 23 cost time: 1.6998059749603271
Epoch: 23, Steps: 52 | Train Loss: 0.4066569 Vali Loss: 1.3128198 Test Loss: 0.3419775
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 24 cost time: 1.6995782852172852
Epoch: 24, Steps: 52 | Train Loss: 0.4080043 Vali Loss: 1.3173672 Test Loss: 0.3418884
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 25 cost time: 1.701310634613037
Epoch: 25, Steps: 52 | Train Loss: 0.4051205 Vali Loss: 1.3118834 Test Loss: 0.3417734
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 26 cost time: 1.6955583095550537
Epoch: 26, Steps: 52 | Train Loss: 0.4072744 Vali Loss: 1.3202982 Test Loss: 0.3421005
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 27 cost time: 1.7018024921417236
Epoch: 27, Steps: 52 | Train Loss: 0.4063615 Vali Loss: 1.3230932 Test Loss: 0.3419462
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 28 cost time: 1.7003486156463623
Epoch: 28, Steps: 52 | Train Loss: 0.4068355 Vali Loss: 1.3200316 Test Loss: 0.3417194
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 29 cost time: 1.7050983905792236
Epoch: 29, Steps: 52 | Train Loss: 0.4058223 Vali Loss: 1.3141643 Test Loss: 0.3415925
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 30 cost time: 1.700773000717163
Epoch: 30, Steps: 52 | Train Loss: 0.4073572 Vali Loss: 1.3156567 Test Loss: 0.3406464
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 31 cost time: 1.7045774459838867
Epoch: 31, Steps: 52 | Train Loss: 0.4057518 Vali Loss: 1.3128963 Test Loss: 0.3414964
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 32 cost time: 1.7112200260162354
Epoch: 32, Steps: 52 | Train Loss: 0.4066621 Vali Loss: 1.3170458 Test Loss: 0.3404004
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 33 cost time: 1.7023060321807861
Epoch: 33, Steps: 52 | Train Loss: 0.4057459 Vali Loss: 1.3153654 Test Loss: 0.3407306
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 34 cost time: 1.6941373348236084
Epoch: 34, Steps: 52 | Train Loss: 0.4054793 Vali Loss: 1.3098586 Test Loss: 0.3404689
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 35 cost time: 1.6973328590393066
Epoch: 35, Steps: 52 | Train Loss: 0.4055610 Vali Loss: 1.3153944 Test Loss: 0.3404078
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 36 cost time: 1.695281982421875
Epoch: 36, Steps: 52 | Train Loss: 0.4045217 Vali Loss: 1.3175582 Test Loss: 0.3403467
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 37 cost time: 1.6988036632537842
Epoch: 37, Steps: 52 | Train Loss: 0.4052372 Vali Loss: 1.3154453 Test Loss: 0.3402954
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 38 cost time: 1.6970174312591553
Epoch: 38, Steps: 52 | Train Loss: 0.4055091 Vali Loss: 1.3068807 Test Loss: 0.3401056
Validation loss decreased (1.307618 --> 1.306881).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 39 cost time: 1.6988441944122314
Epoch: 39, Steps: 52 | Train Loss: 0.4041740 Vali Loss: 1.3122262 Test Loss: 0.3399869
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 40 cost time: 1.69022536277771
Epoch: 40, Steps: 52 | Train Loss: 0.4047002 Vali Loss: 1.3135170 Test Loss: 0.3407112
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 41 cost time: 1.6979737281799316
Epoch: 41, Steps: 52 | Train Loss: 0.4042256 Vali Loss: 1.3179280 Test Loss: 0.3401784
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 42 cost time: 1.6972377300262451
Epoch: 42, Steps: 52 | Train Loss: 0.4046760 Vali Loss: 1.3083091 Test Loss: 0.3400827
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 43 cost time: 1.696547031402588
Epoch: 43, Steps: 52 | Train Loss: 0.4059787 Vali Loss: 1.3100804 Test Loss: 0.3403086
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 44 cost time: 1.6974787712097168
Epoch: 44, Steps: 52 | Train Loss: 0.4048581 Vali Loss: 1.3016033 Test Loss: 0.3399655
Validation loss decreased (1.306881 --> 1.301603).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 45 cost time: 1.6978490352630615
Epoch: 45, Steps: 52 | Train Loss: 0.4046100 Vali Loss: 1.3183584 Test Loss: 0.3411903
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 46 cost time: 1.6987323760986328
Epoch: 46, Steps: 52 | Train Loss: 0.4037353 Vali Loss: 1.3076965 Test Loss: 0.3407685
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 47 cost time: 1.6973259449005127
Epoch: 47, Steps: 52 | Train Loss: 0.4048814 Vali Loss: 1.3074288 Test Loss: 0.3392440
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 48 cost time: 1.7027668952941895
Epoch: 48, Steps: 52 | Train Loss: 0.4045625 Vali Loss: 1.3155184 Test Loss: 0.3393905
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 49 cost time: 1.6938846111297607
Epoch: 49, Steps: 52 | Train Loss: 0.4036984 Vali Loss: 1.3063915 Test Loss: 0.3405955
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 50 cost time: 1.701833724975586
Epoch: 50, Steps: 52 | Train Loss: 0.4049068 Vali Loss: 1.3031294 Test Loss: 0.3397928
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 51 cost time: 1.696091890335083
Epoch: 51, Steps: 52 | Train Loss: 0.4057293 Vali Loss: 1.3162448 Test Loss: 0.3408223
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 52 cost time: 1.6982755661010742
Epoch: 52, Steps: 52 | Train Loss: 0.4048212 Vali Loss: 1.3146765 Test Loss: 0.3399025
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 53 cost time: 1.690542221069336
Epoch: 53, Steps: 52 | Train Loss: 0.4041393 Vali Loss: 1.3074348 Test Loss: 0.3395246
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 54 cost time: 1.6971192359924316
Epoch: 54, Steps: 52 | Train Loss: 0.4051121 Vali Loss: 1.3128196 Test Loss: 0.3402092
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 55 cost time: 1.7013533115386963
Epoch: 55, Steps: 52 | Train Loss: 0.4032162 Vali Loss: 1.3148017 Test Loss: 0.3394744
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 56 cost time: 1.6981837749481201
Epoch: 56, Steps: 52 | Train Loss: 0.4038511 Vali Loss: 1.3104005 Test Loss: 0.3397102
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 57 cost time: 1.694516658782959
Epoch: 57, Steps: 52 | Train Loss: 0.4047953 Vali Loss: 1.3099744 Test Loss: 0.3396462
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 58 cost time: 1.7001714706420898
Epoch: 58, Steps: 52 | Train Loss: 0.4059931 Vali Loss: 1.3125095 Test Loss: 0.3397352
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 59 cost time: 1.6979432106018066
Epoch: 59, Steps: 52 | Train Loss: 0.4037524 Vali Loss: 1.3146343 Test Loss: 0.3402356
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 60 cost time: 1.6968564987182617
Epoch: 60, Steps: 52 | Train Loss: 0.4061627 Vali Loss: 1.3103595 Test Loss: 0.3404545
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33996546268463135, mae:0.3890789747238159, rse:0.47766804695129395
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05202198028564453 GB
Epoch: 1 cost time: 2.1324667930603027
Epoch: 1, Steps: 52 | Train Loss: 0.7238713 Vali Loss: 2.2225804 Test Loss: 1.4600599
Validation loss decreased (inf --> 2.222580).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 2 cost time: 0.7822318077087402
Epoch: 2, Steps: 52 | Train Loss: 0.6382352 Vali Loss: 1.7544301 Test Loss: 0.8955497
Validation loss decreased (2.222580 --> 1.754430).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 3 cost time: 0.7846918106079102
Epoch: 3, Steps: 52 | Train Loss: 0.5053384 Vali Loss: 1.4551301 Test Loss: 0.4569175
Validation loss decreased (1.754430 --> 1.455130).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 4 cost time: 0.850841760635376
Epoch: 4, Steps: 52 | Train Loss: 0.4508850 Vali Loss: 1.4113033 Test Loss: 0.4089295
Validation loss decreased (1.455130 --> 1.411303).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 5 cost time: 0.9589169025421143
Epoch: 5, Steps: 52 | Train Loss: 0.4344252 Vali Loss: 1.3775878 Test Loss: 0.3867312
Validation loss decreased (1.411303 --> 1.377588).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 6 cost time: 1.747737169265747
Epoch: 6, Steps: 52 | Train Loss: 0.4297984 Vali Loss: 1.3675092 Test Loss: 0.3733554
Validation loss decreased (1.377588 --> 1.367509).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 7 cost time: 1.7470130920410156
Epoch: 7, Steps: 52 | Train Loss: 0.4229090 Vali Loss: 1.3591905 Test Loss: 0.3643969
Validation loss decreased (1.367509 --> 1.359190).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 8 cost time: 1.7495758533477783
Epoch: 8, Steps: 52 | Train Loss: 0.4186303 Vali Loss: 1.3535793 Test Loss: 0.3586552
Validation loss decreased (1.359190 --> 1.353579).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 9 cost time: 1.7483043670654297
Epoch: 9, Steps: 52 | Train Loss: 0.4167711 Vali Loss: 1.3493547 Test Loss: 0.3556753
Validation loss decreased (1.353579 --> 1.349355).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 10 cost time: 1.7472620010375977
Epoch: 10, Steps: 52 | Train Loss: 0.4145696 Vali Loss: 1.3489363 Test Loss: 0.3532858
Validation loss decreased (1.349355 --> 1.348936).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 11 cost time: 1.7487473487854004
Epoch: 11, Steps: 52 | Train Loss: 0.4126923 Vali Loss: 1.3431497 Test Loss: 0.3518737
Validation loss decreased (1.348936 --> 1.343150).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 12 cost time: 1.750744104385376
Epoch: 12, Steps: 52 | Train Loss: 0.4116952 Vali Loss: 1.3254681 Test Loss: 0.3497377
Validation loss decreased (1.343150 --> 1.325468).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 13 cost time: 1.7526516914367676
Epoch: 13, Steps: 52 | Train Loss: 0.4088132 Vali Loss: 1.3256328 Test Loss: 0.3495711
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 14 cost time: 1.7492454051971436
Epoch: 14, Steps: 52 | Train Loss: 0.4096620 Vali Loss: 1.3267130 Test Loss: 0.3481348
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 15 cost time: 1.7480075359344482
Epoch: 15, Steps: 52 | Train Loss: 0.4098332 Vali Loss: 1.3294964 Test Loss: 0.3469788
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 16 cost time: 1.7439823150634766
Epoch: 16, Steps: 52 | Train Loss: 0.4080226 Vali Loss: 1.3176465 Test Loss: 0.3456404
Validation loss decreased (1.325468 --> 1.317647).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 17 cost time: 1.7568917274475098
Epoch: 17, Steps: 52 | Train Loss: 0.4082830 Vali Loss: 1.3215144 Test Loss: 0.3478669
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 18 cost time: 1.7468342781066895
Epoch: 18, Steps: 52 | Train Loss: 0.4085792 Vali Loss: 1.3201270 Test Loss: 0.3442621
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 19 cost time: 1.749230146408081
Epoch: 19, Steps: 52 | Train Loss: 0.4075271 Vali Loss: 1.3206804 Test Loss: 0.3458497
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 20 cost time: 1.7475628852844238
Epoch: 20, Steps: 52 | Train Loss: 0.4064580 Vali Loss: 1.3205276 Test Loss: 0.3458931
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 21 cost time: 1.7500078678131104
Epoch: 21, Steps: 52 | Train Loss: 0.4061326 Vali Loss: 1.3237571 Test Loss: 0.3457012
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 22 cost time: 1.7490794658660889
Epoch: 22, Steps: 52 | Train Loss: 0.4061621 Vali Loss: 1.3099616 Test Loss: 0.3445209
Validation loss decreased (1.317647 --> 1.309962).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 23 cost time: 1.749678611755371
Epoch: 23, Steps: 52 | Train Loss: 0.4050141 Vali Loss: 1.3213565 Test Loss: 0.3455395
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 24 cost time: 1.7442386150360107
Epoch: 24, Steps: 52 | Train Loss: 0.4060891 Vali Loss: 1.3208654 Test Loss: 0.3459276
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 25 cost time: 1.7490918636322021
Epoch: 25, Steps: 52 | Train Loss: 0.4035731 Vali Loss: 1.3200027 Test Loss: 0.3461237
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 26 cost time: 1.747194528579712
Epoch: 26, Steps: 52 | Train Loss: 0.4045631 Vali Loss: 1.3187453 Test Loss: 0.3455530
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 27 cost time: 1.7446575164794922
Epoch: 27, Steps: 52 | Train Loss: 0.4053981 Vali Loss: 1.3145909 Test Loss: 0.3448091
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 28 cost time: 1.7493321895599365
Epoch: 28, Steps: 52 | Train Loss: 0.4027415 Vali Loss: 1.3083730 Test Loss: 0.3461645
Validation loss decreased (1.309962 --> 1.308373).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 29 cost time: 1.7472224235534668
Epoch: 29, Steps: 52 | Train Loss: 0.4033717 Vali Loss: 1.3095294 Test Loss: 0.3437628
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 30 cost time: 1.7486162185668945
Epoch: 30, Steps: 52 | Train Loss: 0.4031057 Vali Loss: 1.3089542 Test Loss: 0.3446149
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 31 cost time: 1.7446672916412354
Epoch: 31, Steps: 52 | Train Loss: 0.4038314 Vali Loss: 1.3103901 Test Loss: 0.3440174
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 32 cost time: 1.7491559982299805
Epoch: 32, Steps: 52 | Train Loss: 0.4020998 Vali Loss: 1.3081603 Test Loss: 0.3446265
Validation loss decreased (1.308373 --> 1.308160).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 33 cost time: 1.7449862957000732
Epoch: 33, Steps: 52 | Train Loss: 0.4043051 Vali Loss: 1.3050308 Test Loss: 0.3449818
Validation loss decreased (1.308160 --> 1.305031).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 34 cost time: 1.744157314300537
Epoch: 34, Steps: 52 | Train Loss: 0.4035409 Vali Loss: 1.3162718 Test Loss: 0.3444672
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 35 cost time: 1.7490103244781494
Epoch: 35, Steps: 52 | Train Loss: 0.4032822 Vali Loss: 1.2931471 Test Loss: 0.3452451
Validation loss decreased (1.305031 --> 1.293147).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 36 cost time: 1.7492787837982178
Epoch: 36, Steps: 52 | Train Loss: 0.4023260 Vali Loss: 1.3076396 Test Loss: 0.3440574
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 37 cost time: 1.747795581817627
Epoch: 37, Steps: 52 | Train Loss: 0.4043400 Vali Loss: 1.3115689 Test Loss: 0.3455359
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 38 cost time: 1.7464351654052734
Epoch: 38, Steps: 52 | Train Loss: 0.4043845 Vali Loss: 1.3091904 Test Loss: 0.3450346
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 39 cost time: 1.746178388595581
Epoch: 39, Steps: 52 | Train Loss: 0.4041143 Vali Loss: 1.3078377 Test Loss: 0.3435223
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 40 cost time: 1.748776912689209
Epoch: 40, Steps: 52 | Train Loss: 0.4034159 Vali Loss: 1.3136370 Test Loss: 0.3433529
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 41 cost time: 1.744271993637085
Epoch: 41, Steps: 52 | Train Loss: 0.4036693 Vali Loss: 1.3082519 Test Loss: 0.3434936
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 42 cost time: 1.7468152046203613
Epoch: 42, Steps: 52 | Train Loss: 0.4039162 Vali Loss: 1.3135967 Test Loss: 0.3445307
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 43 cost time: 1.7474212646484375
Epoch: 43, Steps: 52 | Train Loss: 0.4020977 Vali Loss: 1.3113766 Test Loss: 0.3440368
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 44 cost time: 1.7505805492401123
Epoch: 44, Steps: 52 | Train Loss: 0.4022391 Vali Loss: 1.3084910 Test Loss: 0.3441149
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 45 cost time: 1.7504310607910156
Epoch: 45, Steps: 52 | Train Loss: 0.4022353 Vali Loss: 1.3069129 Test Loss: 0.3439620
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 46 cost time: 1.7455744743347168
Epoch: 46, Steps: 52 | Train Loss: 0.4032809 Vali Loss: 1.3141547 Test Loss: 0.3444409
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 47 cost time: 1.7562413215637207
Epoch: 47, Steps: 52 | Train Loss: 0.4035033 Vali Loss: 1.3076627 Test Loss: 0.3427277
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 48 cost time: 1.746713399887085
Epoch: 48, Steps: 52 | Train Loss: 0.4018341 Vali Loss: 1.3133283 Test Loss: 0.3449379
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 49 cost time: 1.7494993209838867
Epoch: 49, Steps: 52 | Train Loss: 0.4036515 Vali Loss: 1.3056831 Test Loss: 0.3435116
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 50 cost time: 1.7420971393585205
Epoch: 50, Steps: 52 | Train Loss: 0.4034296 Vali Loss: 1.3041389 Test Loss: 0.3432454
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 51 cost time: 1.7508211135864258
Epoch: 51, Steps: 52 | Train Loss: 0.4037103 Vali Loss: 1.3025244 Test Loss: 0.3445547
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 52 cost time: 1.7470698356628418
Epoch: 52, Steps: 52 | Train Loss: 0.4018031 Vali Loss: 1.3137875 Test Loss: 0.3435324
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 53 cost time: 1.7506799697875977
Epoch: 53, Steps: 52 | Train Loss: 0.4029357 Vali Loss: 1.3107128 Test Loss: 0.3436320
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 54 cost time: 1.742161512374878
Epoch: 54, Steps: 52 | Train Loss: 0.4021776 Vali Loss: 1.3048698 Test Loss: 0.3448908
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 55 cost time: 1.748584508895874
Epoch: 55, Steps: 52 | Train Loss: 0.4021229 Vali Loss: 1.3090706 Test Loss: 0.3444449
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 56 cost time: 1.7467701435089111
Epoch: 56, Steps: 52 | Train Loss: 0.4030749 Vali Loss: 1.3077798 Test Loss: 0.3433183
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 57 cost time: 1.7456917762756348
Epoch: 57, Steps: 52 | Train Loss: 0.4016013 Vali Loss: 1.3070997 Test Loss: 0.3442338
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 58 cost time: 1.7581231594085693
Epoch: 58, Steps: 52 | Train Loss: 0.4027325 Vali Loss: 1.3107884 Test Loss: 0.3453166
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 59 cost time: 1.736898422241211
Epoch: 59, Steps: 52 | Train Loss: 0.4034695 Vali Loss: 1.3073254 Test Loss: 0.3433674
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 60 cost time: 1.752037525177002
Epoch: 60, Steps: 52 | Train Loss: 0.4028092 Vali Loss: 1.3067602 Test Loss: 0.3451069
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3452450931072235, mae:0.39614203572273254, rse:0.48136284947395325
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.049631595611572266 GB
Epoch: 1 cost time: 2.125319480895996
Epoch: 1, Steps: 52 | Train Loss: 0.8147587 Vali Loss: 2.1779678 Test Loss: 1.3040420
Validation loss decreased (inf --> 2.177968).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 2 cost time: 0.7566094398498535
Epoch: 2, Steps: 52 | Train Loss: 0.6883272 Vali Loss: 1.6267297 Test Loss: 0.6716201
Validation loss decreased (2.177968 --> 1.626730).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 3 cost time: 0.7603554725646973
Epoch: 3, Steps: 52 | Train Loss: 0.5598963 Vali Loss: 1.4769039 Test Loss: 0.4974751
Validation loss decreased (1.626730 --> 1.476904).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 4 cost time: 0.7512953281402588
Epoch: 4, Steps: 52 | Train Loss: 0.5113452 Vali Loss: 1.4225831 Test Loss: 0.4354309
Validation loss decreased (1.476904 --> 1.422583).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 5 cost time: 0.7289996147155762
Epoch: 5, Steps: 52 | Train Loss: 0.4866950 Vali Loss: 1.3982893 Test Loss: 0.4087790
Validation loss decreased (1.422583 --> 1.398289).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 6 cost time: 1.630934715270996
Epoch: 6, Steps: 52 | Train Loss: 0.4761445 Vali Loss: 1.3855395 Test Loss: 0.3932586
Validation loss decreased (1.398289 --> 1.385540).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 7 cost time: 1.6724011898040771
Epoch: 7, Steps: 52 | Train Loss: 0.4630080 Vali Loss: 1.3772485 Test Loss: 0.3816032
Validation loss decreased (1.385540 --> 1.377249).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 8 cost time: 1.6686227321624756
Epoch: 8, Steps: 52 | Train Loss: 0.4583163 Vali Loss: 1.3573526 Test Loss: 0.3736082
Validation loss decreased (1.377249 --> 1.357353).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 9 cost time: 1.6698527336120605
Epoch: 9, Steps: 52 | Train Loss: 0.4524581 Vali Loss: 1.3669733 Test Loss: 0.3673170
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 10 cost time: 1.6651067733764648
Epoch: 10, Steps: 52 | Train Loss: 0.4463401 Vali Loss: 1.3617163 Test Loss: 0.3622864
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 11 cost time: 1.6675357818603516
Epoch: 11, Steps: 52 | Train Loss: 0.4450997 Vali Loss: 1.3448117 Test Loss: 0.3569795
Validation loss decreased (1.357353 --> 1.344812).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 12 cost time: 1.6661951541900635
Epoch: 12, Steps: 52 | Train Loss: 0.4415231 Vali Loss: 1.3525633 Test Loss: 0.3538626
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 13 cost time: 1.6669535636901855
Epoch: 13, Steps: 52 | Train Loss: 0.4386156 Vali Loss: 1.3457060 Test Loss: 0.3511364
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 14 cost time: 1.6697807312011719
Epoch: 14, Steps: 52 | Train Loss: 0.4382113 Vali Loss: 1.3432983 Test Loss: 0.3490843
Validation loss decreased (1.344812 --> 1.343298).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 15 cost time: 1.6706390380859375
Epoch: 15, Steps: 52 | Train Loss: 0.4360624 Vali Loss: 1.3388166 Test Loss: 0.3475444
Validation loss decreased (1.343298 --> 1.338817).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 16 cost time: 1.6645276546478271
Epoch: 16, Steps: 52 | Train Loss: 0.4319185 Vali Loss: 1.3407680 Test Loss: 0.3457698
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 17 cost time: 1.6649987697601318
Epoch: 17, Steps: 52 | Train Loss: 0.4321428 Vali Loss: 1.3399738 Test Loss: 0.3437299
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 18 cost time: 1.6649847030639648
Epoch: 18, Steps: 52 | Train Loss: 0.4303835 Vali Loss: 1.3364242 Test Loss: 0.3426376
Validation loss decreased (1.338817 --> 1.336424).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 19 cost time: 1.663802146911621
Epoch: 19, Steps: 52 | Train Loss: 0.4287125 Vali Loss: 1.3393557 Test Loss: 0.3418594
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 20 cost time: 1.6690561771392822
Epoch: 20, Steps: 52 | Train Loss: 0.4303056 Vali Loss: 1.3292456 Test Loss: 0.3410120
Validation loss decreased (1.336424 --> 1.329246).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 21 cost time: 1.6652932167053223
Epoch: 21, Steps: 52 | Train Loss: 0.4283734 Vali Loss: 1.3321781 Test Loss: 0.3400004
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 22 cost time: 1.6691803932189941
Epoch: 22, Steps: 52 | Train Loss: 0.4283515 Vali Loss: 1.3307014 Test Loss: 0.3396587
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 23 cost time: 1.6639246940612793
Epoch: 23, Steps: 52 | Train Loss: 0.4289962 Vali Loss: 1.3300169 Test Loss: 0.3387825
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 24 cost time: 1.6756706237792969
Epoch: 24, Steps: 52 | Train Loss: 0.4268669 Vali Loss: 1.3248532 Test Loss: 0.3384677
Validation loss decreased (1.329246 --> 1.324853).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 25 cost time: 1.6666405200958252
Epoch: 25, Steps: 52 | Train Loss: 0.4269247 Vali Loss: 1.3197608 Test Loss: 0.3378396
Validation loss decreased (1.324853 --> 1.319761).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 26 cost time: 1.668633222579956
Epoch: 26, Steps: 52 | Train Loss: 0.4267237 Vali Loss: 1.3272250 Test Loss: 0.3380581
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 27 cost time: 1.6672179698944092
Epoch: 27, Steps: 52 | Train Loss: 0.4244692 Vali Loss: 1.3320775 Test Loss: 0.3378537
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 28 cost time: 1.6722238063812256
Epoch: 28, Steps: 52 | Train Loss: 0.4250736 Vali Loss: 1.3223901 Test Loss: 0.3369841
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 29 cost time: 1.6677556037902832
Epoch: 29, Steps: 52 | Train Loss: 0.4273618 Vali Loss: 1.3253469 Test Loss: 0.3370859
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 30 cost time: 1.6732587814331055
Epoch: 30, Steps: 52 | Train Loss: 0.4243748 Vali Loss: 1.3261809 Test Loss: 0.3357298
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 31 cost time: 1.671302318572998
Epoch: 31, Steps: 52 | Train Loss: 0.4252529 Vali Loss: 1.3299482 Test Loss: 0.3364070
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 32 cost time: 1.672255277633667
Epoch: 32, Steps: 52 | Train Loss: 0.4230554 Vali Loss: 1.3217878 Test Loss: 0.3358882
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 33 cost time: 1.6678831577301025
Epoch: 33, Steps: 52 | Train Loss: 0.4242674 Vali Loss: 1.3263924 Test Loss: 0.3358651
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 34 cost time: 1.6680526733398438
Epoch: 34, Steps: 52 | Train Loss: 0.4239590 Vali Loss: 1.3211623 Test Loss: 0.3352665
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 35 cost time: 1.662109136581421
Epoch: 35, Steps: 52 | Train Loss: 0.4215405 Vali Loss: 1.3206067 Test Loss: 0.3355592
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 36 cost time: 1.6707422733306885
Epoch: 36, Steps: 52 | Train Loss: 0.4227059 Vali Loss: 1.3143926 Test Loss: 0.3352490
Validation loss decreased (1.319761 --> 1.314393).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 37 cost time: 1.6677868366241455
Epoch: 37, Steps: 52 | Train Loss: 0.4246663 Vali Loss: 1.3227044 Test Loss: 0.3349403
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 38 cost time: 1.6640353202819824
Epoch: 38, Steps: 52 | Train Loss: 0.4223610 Vali Loss: 1.3186719 Test Loss: 0.3347783
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 39 cost time: 1.6648738384246826
Epoch: 39, Steps: 52 | Train Loss: 0.4230734 Vali Loss: 1.3271527 Test Loss: 0.3346693
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 40 cost time: 1.6689374446868896
Epoch: 40, Steps: 52 | Train Loss: 0.4226665 Vali Loss: 1.3169726 Test Loss: 0.3346887
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 41 cost time: 1.665273666381836
Epoch: 41, Steps: 52 | Train Loss: 0.4246658 Vali Loss: 1.3205444 Test Loss: 0.3349128
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 42 cost time: 1.666130781173706
Epoch: 42, Steps: 52 | Train Loss: 0.4219800 Vali Loss: 1.3149790 Test Loss: 0.3347127
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 43 cost time: 1.6622991561889648
Epoch: 43, Steps: 52 | Train Loss: 0.4230044 Vali Loss: 1.3219438 Test Loss: 0.3348526
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 44 cost time: 1.6645123958587646
Epoch: 44, Steps: 52 | Train Loss: 0.4217815 Vali Loss: 1.3234617 Test Loss: 0.3353152
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 45 cost time: 1.66086745262146
Epoch: 45, Steps: 52 | Train Loss: 0.4239056 Vali Loss: 1.3203377 Test Loss: 0.3346560
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 46 cost time: 1.6743438243865967
Epoch: 46, Steps: 52 | Train Loss: 0.4222078 Vali Loss: 1.3244808 Test Loss: 0.3344182
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 47 cost time: 1.6754493713378906
Epoch: 47, Steps: 52 | Train Loss: 0.4212217 Vali Loss: 1.3144015 Test Loss: 0.3349515
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 48 cost time: 1.6737523078918457
Epoch: 48, Steps: 52 | Train Loss: 0.4221639 Vali Loss: 1.3211982 Test Loss: 0.3355245
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 49 cost time: 1.6701185703277588
Epoch: 49, Steps: 52 | Train Loss: 0.4232636 Vali Loss: 1.3280817 Test Loss: 0.3345247
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 50 cost time: 1.6652448177337646
Epoch: 50, Steps: 52 | Train Loss: 0.4235882 Vali Loss: 1.3208774 Test Loss: 0.3334680
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 51 cost time: 1.6648046970367432
Epoch: 51, Steps: 52 | Train Loss: 0.4213672 Vali Loss: 1.3178627 Test Loss: 0.3345587
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 52 cost time: 1.6675264835357666
Epoch: 52, Steps: 52 | Train Loss: 0.4226779 Vali Loss: 1.3126694 Test Loss: 0.3337488
Validation loss decreased (1.314393 --> 1.312669).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 53 cost time: 1.6660988330841064
Epoch: 53, Steps: 52 | Train Loss: 0.4229830 Vali Loss: 1.3264892 Test Loss: 0.3333080
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 54 cost time: 1.6611990928649902
Epoch: 54, Steps: 52 | Train Loss: 0.4214325 Vali Loss: 1.3238617 Test Loss: 0.3341489
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 55 cost time: 1.6666994094848633
Epoch: 55, Steps: 52 | Train Loss: 0.4220231 Vali Loss: 1.3245188 Test Loss: 0.3341950
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 56 cost time: 1.6590933799743652
Epoch: 56, Steps: 52 | Train Loss: 0.4209736 Vali Loss: 1.3199219 Test Loss: 0.3342887
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 57 cost time: 1.6635360717773438
Epoch: 57, Steps: 52 | Train Loss: 0.4205581 Vali Loss: 1.3200345 Test Loss: 0.3337584
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 58 cost time: 1.6614129543304443
Epoch: 58, Steps: 52 | Train Loss: 0.4221492 Vali Loss: 1.3255601 Test Loss: 0.3342498
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 59 cost time: 1.6632030010223389
Epoch: 59, Steps: 52 | Train Loss: 0.4215185 Vali Loss: 1.3253369 Test Loss: 0.3346137
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 60 cost time: 1.668083906173706
Epoch: 60, Steps: 52 | Train Loss: 0.4215104 Vali Loss: 1.3172228 Test Loss: 0.3345821
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33374881744384766, mae:0.37514159083366394, rse:0.47328054904937744
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05106353759765625 GB
Epoch: 1 cost time: 2.155311346054077
Epoch: 1, Steps: 52 | Train Loss: 0.7363492 Vali Loss: 2.1879714 Test Loss: 1.3723919
Validation loss decreased (inf --> 2.187971).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 2 cost time: 0.7784218788146973
Epoch: 2, Steps: 52 | Train Loss: 0.6191888 Vali Loss: 1.6361153 Test Loss: 0.6966003
Validation loss decreased (2.187971 --> 1.636115).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 3 cost time: 0.7783558368682861
Epoch: 3, Steps: 52 | Train Loss: 0.4949161 Vali Loss: 1.4529355 Test Loss: 0.4554889
Validation loss decreased (1.636115 --> 1.452935).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 4 cost time: 0.7733945846557617
Epoch: 4, Steps: 52 | Train Loss: 0.4557154 Vali Loss: 1.4007475 Test Loss: 0.4024751
Validation loss decreased (1.452935 --> 1.400748).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 5 cost time: 0.7709996700286865
Epoch: 5, Steps: 52 | Train Loss: 0.4408188 Vali Loss: 1.3817632 Test Loss: 0.3881561
Validation loss decreased (1.400748 --> 1.381763).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 6 cost time: 1.7346110343933105
Epoch: 6, Steps: 52 | Train Loss: 0.4339704 Vali Loss: 1.3751757 Test Loss: 0.3796880
Validation loss decreased (1.381763 --> 1.375176).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 7 cost time: 1.7248144149780273
Epoch: 7, Steps: 52 | Train Loss: 0.4298215 Vali Loss: 1.3662970 Test Loss: 0.3710383
Validation loss decreased (1.375176 --> 1.366297).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 8 cost time: 1.726741075515747
Epoch: 8, Steps: 52 | Train Loss: 0.4252346 Vali Loss: 1.3584460 Test Loss: 0.3655527
Validation loss decreased (1.366297 --> 1.358446).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 9 cost time: 1.7264606952667236
Epoch: 9, Steps: 52 | Train Loss: 0.4234257 Vali Loss: 1.3495331 Test Loss: 0.3619994
Validation loss decreased (1.358446 --> 1.349533).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 10 cost time: 1.7221124172210693
Epoch: 10, Steps: 52 | Train Loss: 0.4196192 Vali Loss: 1.3469988 Test Loss: 0.3596778
Validation loss decreased (1.349533 --> 1.346999).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 11 cost time: 1.7307226657867432
Epoch: 11, Steps: 52 | Train Loss: 0.4182800 Vali Loss: 1.3481005 Test Loss: 0.3557650
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 12 cost time: 1.7242445945739746
Epoch: 12, Steps: 52 | Train Loss: 0.4175485 Vali Loss: 1.3399639 Test Loss: 0.3540803
Validation loss decreased (1.346999 --> 1.339964).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 13 cost time: 1.7315144538879395
Epoch: 13, Steps: 52 | Train Loss: 0.4169527 Vali Loss: 1.3443545 Test Loss: 0.3527790
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 14 cost time: 1.7262132167816162
Epoch: 14, Steps: 52 | Train Loss: 0.4137604 Vali Loss: 1.3377805 Test Loss: 0.3507702
Validation loss decreased (1.339964 --> 1.337780).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 15 cost time: 1.7294070720672607
Epoch: 15, Steps: 52 | Train Loss: 0.4139634 Vali Loss: 1.3293911 Test Loss: 0.3500657
Validation loss decreased (1.337780 --> 1.329391).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 16 cost time: 1.7305762767791748
Epoch: 16, Steps: 52 | Train Loss: 0.4129685 Vali Loss: 1.3397856 Test Loss: 0.3489219
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 17 cost time: 1.7284138202667236
Epoch: 17, Steps: 52 | Train Loss: 0.4128192 Vali Loss: 1.3296776 Test Loss: 0.3480750
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 18 cost time: 1.7256224155426025
Epoch: 18, Steps: 52 | Train Loss: 0.4115061 Vali Loss: 1.3289940 Test Loss: 0.3473609
Validation loss decreased (1.329391 --> 1.328994).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 19 cost time: 1.7426917552947998
Epoch: 19, Steps: 52 | Train Loss: 0.4112972 Vali Loss: 1.3303492 Test Loss: 0.3467100
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 20 cost time: 1.727259874343872
Epoch: 20, Steps: 52 | Train Loss: 0.4113203 Vali Loss: 1.3270271 Test Loss: 0.3462956
Validation loss decreased (1.328994 --> 1.327027).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 21 cost time: 1.733870506286621
Epoch: 21, Steps: 52 | Train Loss: 0.4120890 Vali Loss: 1.3179859 Test Loss: 0.3455955
Validation loss decreased (1.327027 --> 1.317986).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 22 cost time: 1.7287523746490479
Epoch: 22, Steps: 52 | Train Loss: 0.4099873 Vali Loss: 1.3280394 Test Loss: 0.3451346
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 23 cost time: 1.7268331050872803
Epoch: 23, Steps: 52 | Train Loss: 0.4108242 Vali Loss: 1.3277583 Test Loss: 0.3443014
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 24 cost time: 1.7273948192596436
Epoch: 24, Steps: 52 | Train Loss: 0.4107546 Vali Loss: 1.3207408 Test Loss: 0.3437406
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 25 cost time: 1.7285256385803223
Epoch: 25, Steps: 52 | Train Loss: 0.4092385 Vali Loss: 1.3205841 Test Loss: 0.3433164
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 26 cost time: 1.7334327697753906
Epoch: 26, Steps: 52 | Train Loss: 0.4088972 Vali Loss: 1.3258848 Test Loss: 0.3431561
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 27 cost time: 1.7298948764801025
Epoch: 27, Steps: 52 | Train Loss: 0.4076900 Vali Loss: 1.3294487 Test Loss: 0.3435451
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 28 cost time: 1.7327709197998047
Epoch: 28, Steps: 52 | Train Loss: 0.4081918 Vali Loss: 1.3242414 Test Loss: 0.3431000
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 29 cost time: 1.7326900959014893
Epoch: 29, Steps: 52 | Train Loss: 0.4079357 Vali Loss: 1.3236256 Test Loss: 0.3429663
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 30 cost time: 1.7310473918914795
Epoch: 30, Steps: 52 | Train Loss: 0.4077778 Vali Loss: 1.3225447 Test Loss: 0.3428921
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 31 cost time: 1.7280981540679932
Epoch: 31, Steps: 52 | Train Loss: 0.4100456 Vali Loss: 1.3121324 Test Loss: 0.3425371
Validation loss decreased (1.317986 --> 1.312132).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 32 cost time: 1.7343568801879883
Epoch: 32, Steps: 52 | Train Loss: 0.4072969 Vali Loss: 1.3187540 Test Loss: 0.3423685
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 33 cost time: 1.7272498607635498
Epoch: 33, Steps: 52 | Train Loss: 0.4086518 Vali Loss: 1.3231279 Test Loss: 0.3418057
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 34 cost time: 1.7291162014007568
Epoch: 34, Steps: 52 | Train Loss: 0.4088223 Vali Loss: 1.3201506 Test Loss: 0.3417502
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 35 cost time: 1.7272331714630127
Epoch: 35, Steps: 52 | Train Loss: 0.4089325 Vali Loss: 1.3122089 Test Loss: 0.3416109
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 36 cost time: 1.727970838546753
Epoch: 36, Steps: 52 | Train Loss: 0.4084634 Vali Loss: 1.3168206 Test Loss: 0.3417917
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 37 cost time: 1.7297332286834717
Epoch: 37, Steps: 52 | Train Loss: 0.4082068 Vali Loss: 1.3198482 Test Loss: 0.3419118
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 38 cost time: 1.7314939498901367
Epoch: 38, Steps: 52 | Train Loss: 0.4088075 Vali Loss: 1.3230445 Test Loss: 0.3416660
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 39 cost time: 1.7269809246063232
Epoch: 39, Steps: 52 | Train Loss: 0.4075933 Vali Loss: 1.3246969 Test Loss: 0.3412235
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 40 cost time: 1.730426549911499
Epoch: 40, Steps: 52 | Train Loss: 0.4097179 Vali Loss: 1.3223658 Test Loss: 0.3412734
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 41 cost time: 1.728304386138916
Epoch: 41, Steps: 52 | Train Loss: 0.4079084 Vali Loss: 1.3255224 Test Loss: 0.3413098
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 42 cost time: 1.7275102138519287
Epoch: 42, Steps: 52 | Train Loss: 0.4065200 Vali Loss: 1.3223722 Test Loss: 0.3408532
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 43 cost time: 1.7305989265441895
Epoch: 43, Steps: 52 | Train Loss: 0.4089740 Vali Loss: 1.3250186 Test Loss: 0.3412440
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 44 cost time: 1.7325506210327148
Epoch: 44, Steps: 52 | Train Loss: 0.4089402 Vali Loss: 1.3167756 Test Loss: 0.3406822
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 45 cost time: 1.7320115566253662
Epoch: 45, Steps: 52 | Train Loss: 0.4073390 Vali Loss: 1.3165293 Test Loss: 0.3406023
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 46 cost time: 1.7282583713531494
Epoch: 46, Steps: 52 | Train Loss: 0.4070899 Vali Loss: 1.3180610 Test Loss: 0.3413731
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 47 cost time: 1.726888656616211
Epoch: 47, Steps: 52 | Train Loss: 0.4065770 Vali Loss: 1.3196146 Test Loss: 0.3408866
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 48 cost time: 1.7262389659881592
Epoch: 48, Steps: 52 | Train Loss: 0.4064303 Vali Loss: 1.3202467 Test Loss: 0.3405294
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 49 cost time: 1.7337455749511719
Epoch: 49, Steps: 52 | Train Loss: 0.4089990 Vali Loss: 1.3176231 Test Loss: 0.3404935
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 50 cost time: 1.726985216140747
Epoch: 50, Steps: 52 | Train Loss: 0.4074501 Vali Loss: 1.3176956 Test Loss: 0.3415124
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 51 cost time: 1.7299401760101318
Epoch: 51, Steps: 52 | Train Loss: 0.4080509 Vali Loss: 1.3179624 Test Loss: 0.3400488
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 52 cost time: 1.726313829421997
Epoch: 52, Steps: 52 | Train Loss: 0.4065968 Vali Loss: 1.3225055 Test Loss: 0.3402854
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 53 cost time: 1.7336595058441162
Epoch: 53, Steps: 52 | Train Loss: 0.4078550 Vali Loss: 1.3179061 Test Loss: 0.3404961
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 54 cost time: 1.729344129562378
Epoch: 54, Steps: 52 | Train Loss: 0.4074560 Vali Loss: 1.3159118 Test Loss: 0.3414550
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 55 cost time: 1.7274467945098877
Epoch: 55, Steps: 52 | Train Loss: 0.4077887 Vali Loss: 1.3247664 Test Loss: 0.3406975
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 56 cost time: 1.7284390926361084
Epoch: 56, Steps: 52 | Train Loss: 0.4077091 Vali Loss: 1.3213181 Test Loss: 0.3406841
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 57 cost time: 1.7235767841339111
Epoch: 57, Steps: 52 | Train Loss: 0.4073570 Vali Loss: 1.3246381 Test Loss: 0.3411929
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 58 cost time: 1.7255933284759521
Epoch: 58, Steps: 52 | Train Loss: 0.4067610 Vali Loss: 1.3141074 Test Loss: 0.3408939
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 59 cost time: 1.728581428527832
Epoch: 59, Steps: 52 | Train Loss: 0.4073269 Vali Loss: 1.3198578 Test Loss: 0.3410003
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 60 cost time: 1.7258927822113037
Epoch: 60, Steps: 52 | Train Loss: 0.4071868 Vali Loss: 1.3191977 Test Loss: 0.3407710
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34253716468811035, mae:0.38858234882354736, rse:0.4794713258743286
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.05218362808227539 GB
Epoch: 1 cost time: 2.2262728214263916
Epoch: 1, Steps: 52 | Train Loss: 0.7065516 Vali Loss: 2.1435680 Test Loss: 1.3536310
Validation loss decreased (inf --> 2.143568).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 2 cost time: 0.8054614067077637
Epoch: 2, Steps: 52 | Train Loss: 0.6164615 Vali Loss: 1.6717162 Test Loss: 0.7569308
Validation loss decreased (2.143568 --> 1.671716).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 3 cost time: 0.7999997138977051
Epoch: 3, Steps: 52 | Train Loss: 0.4947042 Vali Loss: 1.4422565 Test Loss: 0.4754885
Validation loss decreased (1.671716 --> 1.442256).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 4 cost time: 0.8066215515136719
Epoch: 4, Steps: 52 | Train Loss: 0.4525414 Vali Loss: 1.3984712 Test Loss: 0.4229290
Validation loss decreased (1.442256 --> 1.398471).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 5 cost time: 1.1042497158050537
Epoch: 5, Steps: 52 | Train Loss: 0.4389839 Vali Loss: 1.3824564 Test Loss: 0.3921942
Validation loss decreased (1.398471 --> 1.382456).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 6 cost time: 1.774834394454956
Epoch: 6, Steps: 52 | Train Loss: 0.4300585 Vali Loss: 1.3643746 Test Loss: 0.3748911
Validation loss decreased (1.382456 --> 1.364375).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 7 cost time: 1.773285150527954
Epoch: 7, Steps: 52 | Train Loss: 0.4247980 Vali Loss: 1.3579502 Test Loss: 0.3645536
Validation loss decreased (1.364375 --> 1.357950).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 8 cost time: 1.7759182453155518
Epoch: 8, Steps: 52 | Train Loss: 0.4208231 Vali Loss: 1.3494321 Test Loss: 0.3574855
Validation loss decreased (1.357950 --> 1.349432).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 9 cost time: 1.7743101119995117
Epoch: 9, Steps: 52 | Train Loss: 0.4171906 Vali Loss: 1.3445661 Test Loss: 0.3527787
Validation loss decreased (1.349432 --> 1.344566).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 10 cost time: 1.7788496017456055
Epoch: 10, Steps: 52 | Train Loss: 0.4163706 Vali Loss: 1.3426390 Test Loss: 0.3486361
Validation loss decreased (1.344566 --> 1.342639).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 11 cost time: 1.7743360996246338
Epoch: 11, Steps: 52 | Train Loss: 0.4139852 Vali Loss: 1.3265126 Test Loss: 0.3468893
Validation loss decreased (1.342639 --> 1.326513).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 12 cost time: 1.775374412536621
Epoch: 12, Steps: 52 | Train Loss: 0.4153423 Vali Loss: 1.3279850 Test Loss: 0.3455114
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 13 cost time: 1.7768027782440186
Epoch: 13, Steps: 52 | Train Loss: 0.4122040 Vali Loss: 1.3350430 Test Loss: 0.3446292
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 14 cost time: 1.7837352752685547
Epoch: 14, Steps: 52 | Train Loss: 0.4113604 Vali Loss: 1.3288022 Test Loss: 0.3425698
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 15 cost time: 1.7766947746276855
Epoch: 15, Steps: 52 | Train Loss: 0.4102590 Vali Loss: 1.3265893 Test Loss: 0.3412307
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 16 cost time: 1.7744183540344238
Epoch: 16, Steps: 52 | Train Loss: 0.4076922 Vali Loss: 1.3202770 Test Loss: 0.3405932
Validation loss decreased (1.326513 --> 1.320277).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 17 cost time: 1.7698893547058105
Epoch: 17, Steps: 52 | Train Loss: 0.4067195 Vali Loss: 1.3184880 Test Loss: 0.3397279
Validation loss decreased (1.320277 --> 1.318488).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 18 cost time: 1.7724981307983398
Epoch: 18, Steps: 52 | Train Loss: 0.4069877 Vali Loss: 1.3245792 Test Loss: 0.3385989
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 19 cost time: 1.773705244064331
Epoch: 19, Steps: 52 | Train Loss: 0.4078935 Vali Loss: 1.3229871 Test Loss: 0.3390571
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 20 cost time: 1.7700178623199463
Epoch: 20, Steps: 52 | Train Loss: 0.4061935 Vali Loss: 1.3136218 Test Loss: 0.3382850
Validation loss decreased (1.318488 --> 1.313622).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 21 cost time: 1.774559497833252
Epoch: 21, Steps: 52 | Train Loss: 0.4059011 Vali Loss: 1.3146379 Test Loss: 0.3385296
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 22 cost time: 1.7746820449829102
Epoch: 22, Steps: 52 | Train Loss: 0.4055430 Vali Loss: 1.3238814 Test Loss: 0.3378115
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 23 cost time: 1.7754552364349365
Epoch: 23, Steps: 52 | Train Loss: 0.4059219 Vali Loss: 1.3112130 Test Loss: 0.3365090
Validation loss decreased (1.313622 --> 1.311213).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 24 cost time: 1.7781565189361572
Epoch: 24, Steps: 52 | Train Loss: 0.4063621 Vali Loss: 1.3237600 Test Loss: 0.3372847
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 25 cost time: 1.7743818759918213
Epoch: 25, Steps: 52 | Train Loss: 0.4049058 Vali Loss: 1.3127108 Test Loss: 0.3365632
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 26 cost time: 1.7769508361816406
Epoch: 26, Steps: 52 | Train Loss: 0.4040525 Vali Loss: 1.3186092 Test Loss: 0.3368006
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 27 cost time: 1.7732343673706055
Epoch: 27, Steps: 52 | Train Loss: 0.4037708 Vali Loss: 1.3186033 Test Loss: 0.3366663
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 28 cost time: 1.7682971954345703
Epoch: 28, Steps: 52 | Train Loss: 0.4039473 Vali Loss: 1.3086300 Test Loss: 0.3370172
Validation loss decreased (1.311213 --> 1.308630).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 29 cost time: 1.775261640548706
Epoch: 29, Steps: 52 | Train Loss: 0.4044201 Vali Loss: 1.3109617 Test Loss: 0.3358781
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 30 cost time: 1.7806994915008545
Epoch: 30, Steps: 52 | Train Loss: 0.4052242 Vali Loss: 1.3091125 Test Loss: 0.3363205
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 31 cost time: 1.7822964191436768
Epoch: 31, Steps: 52 | Train Loss: 0.4042875 Vali Loss: 1.3094425 Test Loss: 0.3360287
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 32 cost time: 1.7744312286376953
Epoch: 32, Steps: 52 | Train Loss: 0.4050104 Vali Loss: 1.3139094 Test Loss: 0.3359890
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 33 cost time: 1.7744855880737305
Epoch: 33, Steps: 52 | Train Loss: 0.4038879 Vali Loss: 1.3125203 Test Loss: 0.3358244
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 34 cost time: 1.7797284126281738
Epoch: 34, Steps: 52 | Train Loss: 0.4042322 Vali Loss: 1.3142854 Test Loss: 0.3367653
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 35 cost time: 1.7761211395263672
Epoch: 35, Steps: 52 | Train Loss: 0.4035650 Vali Loss: 1.3139240 Test Loss: 0.3357261
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 36 cost time: 1.7809710502624512
Epoch: 36, Steps: 52 | Train Loss: 0.4043978 Vali Loss: 1.3198812 Test Loss: 0.3363113
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 37 cost time: 1.7746658325195312
Epoch: 37, Steps: 52 | Train Loss: 0.4037920 Vali Loss: 1.3112395 Test Loss: 0.3359598
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 38 cost time: 1.7793381214141846
Epoch: 38, Steps: 52 | Train Loss: 0.4041234 Vali Loss: 1.3146458 Test Loss: 0.3354362
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 39 cost time: 1.77378511428833
Epoch: 39, Steps: 52 | Train Loss: 0.4022924 Vali Loss: 1.3022460 Test Loss: 0.3354939
Validation loss decreased (1.308630 --> 1.302246).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 40 cost time: 1.7774174213409424
Epoch: 40, Steps: 52 | Train Loss: 0.4047077 Vali Loss: 1.3062340 Test Loss: 0.3347477
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 41 cost time: 1.7775628566741943
Epoch: 41, Steps: 52 | Train Loss: 0.4041903 Vali Loss: 1.3121645 Test Loss: 0.3359022
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 42 cost time: 1.7720892429351807
Epoch: 42, Steps: 52 | Train Loss: 0.4026534 Vali Loss: 1.3090544 Test Loss: 0.3354665
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 43 cost time: 1.7781474590301514
Epoch: 43, Steps: 52 | Train Loss: 0.4046684 Vali Loss: 1.3155622 Test Loss: 0.3360017
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 44 cost time: 1.7734613418579102
Epoch: 44, Steps: 52 | Train Loss: 0.4028939 Vali Loss: 1.3149006 Test Loss: 0.3355894
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 45 cost time: 1.7782130241394043
Epoch: 45, Steps: 52 | Train Loss: 0.4027136 Vali Loss: 1.3117523 Test Loss: 0.3361543
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 46 cost time: 1.7715389728546143
Epoch: 46, Steps: 52 | Train Loss: 0.4031749 Vali Loss: 1.3166112 Test Loss: 0.3357972
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 47 cost time: 1.7772135734558105
Epoch: 47, Steps: 52 | Train Loss: 0.4031157 Vali Loss: 1.3151258 Test Loss: 0.3355741
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 48 cost time: 1.7732312679290771
Epoch: 48, Steps: 52 | Train Loss: 0.4043561 Vali Loss: 1.3086765 Test Loss: 0.3359289
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 49 cost time: 1.7813615798950195
Epoch: 49, Steps: 52 | Train Loss: 0.4032401 Vali Loss: 1.3128006 Test Loss: 0.3349050
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 50 cost time: 1.7752463817596436
Epoch: 50, Steps: 52 | Train Loss: 0.4045958 Vali Loss: 1.3183570 Test Loss: 0.3359537
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 51 cost time: 1.7746520042419434
Epoch: 51, Steps: 52 | Train Loss: 0.4021296 Vali Loss: 1.3138871 Test Loss: 0.3356788
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 52 cost time: 1.7754664421081543
Epoch: 52, Steps: 52 | Train Loss: 0.4030549 Vali Loss: 1.2995054 Test Loss: 0.3358255
Validation loss decreased (1.302246 --> 1.299505).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 53 cost time: 1.774531364440918
Epoch: 53, Steps: 52 | Train Loss: 0.4040980 Vali Loss: 1.3141110 Test Loss: 0.3350071
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 54 cost time: 1.779369831085205
Epoch: 54, Steps: 52 | Train Loss: 0.4026516 Vali Loss: 1.3011504 Test Loss: 0.3354184
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 55 cost time: 1.7726640701293945
Epoch: 55, Steps: 52 | Train Loss: 0.4045555 Vali Loss: 1.3041378 Test Loss: 0.3353250
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 56 cost time: 1.7826814651489258
Epoch: 56, Steps: 52 | Train Loss: 0.4039859 Vali Loss: 1.3087144 Test Loss: 0.3358758
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 57 cost time: 1.77738618850708
Epoch: 57, Steps: 52 | Train Loss: 0.4046260 Vali Loss: 1.3047091 Test Loss: 0.3352661
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 58 cost time: 1.7805626392364502
Epoch: 58, Steps: 52 | Train Loss: 0.4041250 Vali Loss: 1.3164297 Test Loss: 0.3350586
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 59 cost time: 1.7757985591888428
Epoch: 59, Steps: 52 | Train Loss: 0.4032786 Vali Loss: 1.3038661 Test Loss: 0.3361388
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 60 cost time: 1.7813935279846191
Epoch: 60, Steps: 52 | Train Loss: 0.4034802 Vali Loss: 1.3060342 Test Loss: 0.3357242
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33582547307014465, mae:0.38245630264282227, rse:0.47475069761276245
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.04979372024536133 GB
Epoch: 1 cost time: 2.1848011016845703
Epoch: 1, Steps: 52 | Train Loss: 0.9661709 Vali Loss: 2.5718565 Test Loss: 1.7361259
Validation loss decreased (inf --> 2.571856).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 2 cost time: 0.7599990367889404
Epoch: 2, Steps: 52 | Train Loss: 0.7962985 Vali Loss: 1.7921324 Test Loss: 0.8755707
Validation loss decreased (2.571856 --> 1.792132).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 3 cost time: 0.7353622913360596
Epoch: 3, Steps: 52 | Train Loss: 0.6086558 Vali Loss: 1.5303037 Test Loss: 0.5638880
Validation loss decreased (1.792132 --> 1.530304).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 4 cost time: 0.7573320865631104
Epoch: 4, Steps: 52 | Train Loss: 0.5324285 Vali Loss: 1.4335829 Test Loss: 0.4481743
Validation loss decreased (1.530304 --> 1.433583).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 5 cost time: 0.7560000419616699
Epoch: 5, Steps: 52 | Train Loss: 0.4987494 Vali Loss: 1.3939812 Test Loss: 0.4081280
Validation loss decreased (1.433583 --> 1.393981).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 6 cost time: 1.6775176525115967
Epoch: 6, Steps: 52 | Train Loss: 0.4827070 Vali Loss: 1.3833870 Test Loss: 0.3906780
Validation loss decreased (1.393981 --> 1.383387).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 7 cost time: 1.6796085834503174
Epoch: 7, Steps: 52 | Train Loss: 0.4721382 Vali Loss: 1.3755875 Test Loss: 0.3801917
Validation loss decreased (1.383387 --> 1.375587).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 8 cost time: 1.6804678440093994
Epoch: 8, Steps: 52 | Train Loss: 0.4616939 Vali Loss: 1.3637317 Test Loss: 0.3728344
Validation loss decreased (1.375587 --> 1.363732).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 9 cost time: 1.6794676780700684
Epoch: 9, Steps: 52 | Train Loss: 0.4573840 Vali Loss: 1.3560600 Test Loss: 0.3665209
Validation loss decreased (1.363732 --> 1.356060).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 10 cost time: 1.6876962184906006
Epoch: 10, Steps: 52 | Train Loss: 0.4527269 Vali Loss: 1.3525473 Test Loss: 0.3623843
Validation loss decreased (1.356060 --> 1.352547).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 11 cost time: 1.679833173751831
Epoch: 11, Steps: 52 | Train Loss: 0.4497094 Vali Loss: 1.3560598 Test Loss: 0.3586392
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 12 cost time: 1.685340404510498
Epoch: 12, Steps: 52 | Train Loss: 0.4469943 Vali Loss: 1.3506740 Test Loss: 0.3549233
Validation loss decreased (1.352547 --> 1.350674).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 13 cost time: 1.6802222728729248
Epoch: 13, Steps: 52 | Train Loss: 0.4453353 Vali Loss: 1.3427302 Test Loss: 0.3521467
Validation loss decreased (1.350674 --> 1.342730).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 14 cost time: 1.683971643447876
Epoch: 14, Steps: 52 | Train Loss: 0.4428637 Vali Loss: 1.3413835 Test Loss: 0.3507711
Validation loss decreased (1.342730 --> 1.341383).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 15 cost time: 1.6754255294799805
Epoch: 15, Steps: 52 | Train Loss: 0.4400847 Vali Loss: 1.3431565 Test Loss: 0.3484927
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 16 cost time: 1.675605058670044
Epoch: 16, Steps: 52 | Train Loss: 0.4390706 Vali Loss: 1.3306413 Test Loss: 0.3469898
Validation loss decreased (1.341383 --> 1.330641).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 17 cost time: 1.675581693649292
Epoch: 17, Steps: 52 | Train Loss: 0.4371789 Vali Loss: 1.3341966 Test Loss: 0.3459423
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 18 cost time: 1.6750991344451904
Epoch: 18, Steps: 52 | Train Loss: 0.4357853 Vali Loss: 1.3265226 Test Loss: 0.3447999
Validation loss decreased (1.330641 --> 1.326523).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 19 cost time: 1.6785054206848145
Epoch: 19, Steps: 52 | Train Loss: 0.4320721 Vali Loss: 1.3310201 Test Loss: 0.3433360
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 20 cost time: 1.6784789562225342
Epoch: 20, Steps: 52 | Train Loss: 0.4344333 Vali Loss: 1.3294230 Test Loss: 0.3427190
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 21 cost time: 1.6791050434112549
Epoch: 21, Steps: 52 | Train Loss: 0.4332393 Vali Loss: 1.3252395 Test Loss: 0.3422142
Validation loss decreased (1.326523 --> 1.325240).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 22 cost time: 1.6801965236663818
Epoch: 22, Steps: 52 | Train Loss: 0.4315061 Vali Loss: 1.3256428 Test Loss: 0.3413439
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 23 cost time: 1.6853516101837158
Epoch: 23, Steps: 52 | Train Loss: 0.4307184 Vali Loss: 1.3251894 Test Loss: 0.3407918
Validation loss decreased (1.325240 --> 1.325189).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 24 cost time: 1.6760482788085938
Epoch: 24, Steps: 52 | Train Loss: 0.4302191 Vali Loss: 1.3252801 Test Loss: 0.3398798
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 25 cost time: 1.6786699295043945
Epoch: 25, Steps: 52 | Train Loss: 0.4309438 Vali Loss: 1.3211962 Test Loss: 0.3390271
Validation loss decreased (1.325189 --> 1.321196).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 26 cost time: 1.6778383255004883
Epoch: 26, Steps: 52 | Train Loss: 0.4302956 Vali Loss: 1.3244513 Test Loss: 0.3392133
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 27 cost time: 1.6846938133239746
Epoch: 27, Steps: 52 | Train Loss: 0.4294384 Vali Loss: 1.3255563 Test Loss: 0.3392899
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 28 cost time: 1.6773433685302734
Epoch: 28, Steps: 52 | Train Loss: 0.4290866 Vali Loss: 1.3160770 Test Loss: 0.3377991
Validation loss decreased (1.321196 --> 1.316077).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 29 cost time: 1.6798171997070312
Epoch: 29, Steps: 52 | Train Loss: 0.4276337 Vali Loss: 1.3216681 Test Loss: 0.3378533
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 30 cost time: 1.6765305995941162
Epoch: 30, Steps: 52 | Train Loss: 0.4285345 Vali Loss: 1.3292056 Test Loss: 0.3384946
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 31 cost time: 1.6775665283203125
Epoch: 31, Steps: 52 | Train Loss: 0.4284946 Vali Loss: 1.3287102 Test Loss: 0.3378538
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 32 cost time: 1.671776533126831
Epoch: 32, Steps: 52 | Train Loss: 0.4286746 Vali Loss: 1.3229618 Test Loss: 0.3370640
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 33 cost time: 1.6816089153289795
Epoch: 33, Steps: 52 | Train Loss: 0.4276011 Vali Loss: 1.3236010 Test Loss: 0.3372081
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 34 cost time: 1.6765944957733154
Epoch: 34, Steps: 52 | Train Loss: 0.4259551 Vali Loss: 1.3267336 Test Loss: 0.3372964
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 35 cost time: 1.6812348365783691
Epoch: 35, Steps: 52 | Train Loss: 0.4295154 Vali Loss: 1.3244653 Test Loss: 0.3373837
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 36 cost time: 1.674861192703247
Epoch: 36, Steps: 52 | Train Loss: 0.4256620 Vali Loss: 1.3185798 Test Loss: 0.3370458
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 37 cost time: 1.679671287536621
Epoch: 37, Steps: 52 | Train Loss: 0.4258022 Vali Loss: 1.3157258 Test Loss: 0.3367919
Validation loss decreased (1.316077 --> 1.315726).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 38 cost time: 1.6806793212890625
Epoch: 38, Steps: 52 | Train Loss: 0.4264727 Vali Loss: 1.3191483 Test Loss: 0.3373505
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 39 cost time: 1.682624101638794
Epoch: 39, Steps: 52 | Train Loss: 0.4283889 Vali Loss: 1.3181412 Test Loss: 0.3362978
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 40 cost time: 1.6713957786560059
Epoch: 40, Steps: 52 | Train Loss: 0.4260689 Vali Loss: 1.3226572 Test Loss: 0.3360429
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 41 cost time: 1.68037748336792
Epoch: 41, Steps: 52 | Train Loss: 0.4266098 Vali Loss: 1.3165767 Test Loss: 0.3362730
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 42 cost time: 1.679164171218872
Epoch: 42, Steps: 52 | Train Loss: 0.4278272 Vali Loss: 1.3131998 Test Loss: 0.3372213
Validation loss decreased (1.315726 --> 1.313200).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 43 cost time: 1.6773464679718018
Epoch: 43, Steps: 52 | Train Loss: 0.4258131 Vali Loss: 1.3166299 Test Loss: 0.3355516
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 44 cost time: 1.6788437366485596
Epoch: 44, Steps: 52 | Train Loss: 0.4261607 Vali Loss: 1.3150542 Test Loss: 0.3355328
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 45 cost time: 1.67470383644104
Epoch: 45, Steps: 52 | Train Loss: 0.4259894 Vali Loss: 1.3210946 Test Loss: 0.3357290
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 46 cost time: 1.6739273071289062
Epoch: 46, Steps: 52 | Train Loss: 0.4264499 Vali Loss: 1.3170890 Test Loss: 0.3356794
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 47 cost time: 1.6743736267089844
Epoch: 47, Steps: 52 | Train Loss: 0.4260046 Vali Loss: 1.3179405 Test Loss: 0.3363625
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 48 cost time: 1.6766316890716553
Epoch: 48, Steps: 52 | Train Loss: 0.4280740 Vali Loss: 1.3190988 Test Loss: 0.3354301
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 49 cost time: 1.6714272499084473
Epoch: 49, Steps: 52 | Train Loss: 0.4258582 Vali Loss: 1.3174527 Test Loss: 0.3355596
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 50 cost time: 1.674433708190918
Epoch: 50, Steps: 52 | Train Loss: 0.4264205 Vali Loss: 1.3203255 Test Loss: 0.3361380
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 51 cost time: 1.6707170009613037
Epoch: 51, Steps: 52 | Train Loss: 0.4269481 Vali Loss: 1.3166246 Test Loss: 0.3362451
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 52 cost time: 1.678924322128296
Epoch: 52, Steps: 52 | Train Loss: 0.4270684 Vali Loss: 1.3216496 Test Loss: 0.3359353
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 53 cost time: 1.6797575950622559
Epoch: 53, Steps: 52 | Train Loss: 0.4238074 Vali Loss: 1.3131039 Test Loss: 0.3365230
Validation loss decreased (1.313200 --> 1.313104).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 54 cost time: 1.6804625988006592
Epoch: 54, Steps: 52 | Train Loss: 0.4251263 Vali Loss: 1.3193188 Test Loss: 0.3362339
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 55 cost time: 1.6730854511260986
Epoch: 55, Steps: 52 | Train Loss: 0.4244334 Vali Loss: 1.3148196 Test Loss: 0.3361310
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 56 cost time: 1.683699607849121
Epoch: 56, Steps: 52 | Train Loss: 0.4257949 Vali Loss: 1.3188320 Test Loss: 0.3359808
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 57 cost time: 1.6754679679870605
Epoch: 57, Steps: 52 | Train Loss: 0.4264940 Vali Loss: 1.3169973 Test Loss: 0.3364415
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 58 cost time: 1.6829698085784912
Epoch: 58, Steps: 52 | Train Loss: 0.4253441 Vali Loss: 1.3210455 Test Loss: 0.3356111
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 59 cost time: 1.6754534244537354
Epoch: 59, Steps: 52 | Train Loss: 0.4247687 Vali Loss: 1.3203421 Test Loss: 0.3359075
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 60 cost time: 1.6833791732788086
Epoch: 60, Steps: 52 | Train Loss: 0.4251963 Vali Loss: 1.3129749 Test Loss: 0.3359837
Validation loss decreased (1.313104 --> 1.312975).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3359837234020233, mae:0.3766665756702423, rse:0.4748625159263611
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05122566223144531 GB
Epoch: 1 cost time: 2.159820556640625
Epoch: 1, Steps: 52 | Train Loss: 0.7888404 Vali Loss: 2.2770479 Test Loss: 1.5319591
Validation loss decreased (inf --> 2.277048).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 2 cost time: 0.7823536396026611
Epoch: 2, Steps: 52 | Train Loss: 0.6405871 Vali Loss: 1.6001537 Test Loss: 0.6976321
Validation loss decreased (2.277048 --> 1.600154).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 3 cost time: 0.7810003757476807
Epoch: 3, Steps: 52 | Train Loss: 0.4925071 Vali Loss: 1.4273362 Test Loss: 0.4535897
Validation loss decreased (1.600154 --> 1.427336).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 4 cost time: 0.7512965202331543
Epoch: 4, Steps: 52 | Train Loss: 0.4562645 Vali Loss: 1.4039097 Test Loss: 0.4168848
Validation loss decreased (1.427336 --> 1.403910).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 5 cost time: 0.7514364719390869
Epoch: 5, Steps: 52 | Train Loss: 0.4440323 Vali Loss: 1.3815395 Test Loss: 0.3960733
Validation loss decreased (1.403910 --> 1.381539).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 6 cost time: 1.7280068397521973
Epoch: 6, Steps: 52 | Train Loss: 0.4359592 Vali Loss: 1.3721092 Test Loss: 0.3839632
Validation loss decreased (1.381539 --> 1.372109).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 7 cost time: 1.7250099182128906
Epoch: 7, Steps: 52 | Train Loss: 0.4306998 Vali Loss: 1.3746314 Test Loss: 0.3747729
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 8 cost time: 1.7307896614074707
Epoch: 8, Steps: 52 | Train Loss: 0.4257266 Vali Loss: 1.3635988 Test Loss: 0.3671220
Validation loss decreased (1.372109 --> 1.363599).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 9 cost time: 1.7257211208343506
Epoch: 9, Steps: 52 | Train Loss: 0.4226451 Vali Loss: 1.3524709 Test Loss: 0.3618631
Validation loss decreased (1.363599 --> 1.352471).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 10 cost time: 1.7323448657989502
Epoch: 10, Steps: 52 | Train Loss: 0.4228557 Vali Loss: 1.3385782 Test Loss: 0.3572040
Validation loss decreased (1.352471 --> 1.338578).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 11 cost time: 1.7265393733978271
Epoch: 11, Steps: 52 | Train Loss: 0.4192001 Vali Loss: 1.3388567 Test Loss: 0.3542284
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 12 cost time: 1.7315971851348877
Epoch: 12, Steps: 52 | Train Loss: 0.4160078 Vali Loss: 1.3355162 Test Loss: 0.3519906
Validation loss decreased (1.338578 --> 1.335516).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 13 cost time: 1.7277143001556396
Epoch: 13, Steps: 52 | Train Loss: 0.4152463 Vali Loss: 1.3430922 Test Loss: 0.3500211
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 14 cost time: 1.7295353412628174
Epoch: 14, Steps: 52 | Train Loss: 0.4153087 Vali Loss: 1.3336561 Test Loss: 0.3474058
Validation loss decreased (1.335516 --> 1.333656).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 15 cost time: 1.7327907085418701
Epoch: 15, Steps: 52 | Train Loss: 0.4139590 Vali Loss: 1.3305254 Test Loss: 0.3460076
Validation loss decreased (1.333656 --> 1.330525).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 16 cost time: 1.731226921081543
Epoch: 16, Steps: 52 | Train Loss: 0.4128071 Vali Loss: 1.3352211 Test Loss: 0.3445339
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 17 cost time: 1.7283787727355957
Epoch: 17, Steps: 52 | Train Loss: 0.4120174 Vali Loss: 1.3343134 Test Loss: 0.3445180
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 18 cost time: 1.7295236587524414
Epoch: 18, Steps: 52 | Train Loss: 0.4108827 Vali Loss: 1.3315818 Test Loss: 0.3430716
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 19 cost time: 1.7298293113708496
Epoch: 19, Steps: 52 | Train Loss: 0.4094314 Vali Loss: 1.3254941 Test Loss: 0.3428575
Validation loss decreased (1.330525 --> 1.325494).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 20 cost time: 1.724919319152832
Epoch: 20, Steps: 52 | Train Loss: 0.4105037 Vali Loss: 1.3174114 Test Loss: 0.3419949
Validation loss decreased (1.325494 --> 1.317411).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 21 cost time: 1.7287843227386475
Epoch: 21, Steps: 52 | Train Loss: 0.4105867 Vali Loss: 1.3210785 Test Loss: 0.3414018
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 22 cost time: 1.7237763404846191
Epoch: 22, Steps: 52 | Train Loss: 0.4086677 Vali Loss: 1.3223779 Test Loss: 0.3408586
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 23 cost time: 1.728405475616455
Epoch: 23, Steps: 52 | Train Loss: 0.4106073 Vali Loss: 1.3245543 Test Loss: 0.3399731
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 24 cost time: 1.72757887840271
Epoch: 24, Steps: 52 | Train Loss: 0.4078994 Vali Loss: 1.3226737 Test Loss: 0.3401706
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 25 cost time: 1.730436086654663
Epoch: 25, Steps: 52 | Train Loss: 0.4078602 Vali Loss: 1.3147827 Test Loss: 0.3398532
Validation loss decreased (1.317411 --> 1.314783).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 26 cost time: 1.7288639545440674
Epoch: 26, Steps: 52 | Train Loss: 0.4088050 Vali Loss: 1.3226532 Test Loss: 0.3409762
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 27 cost time: 1.7314417362213135
Epoch: 27, Steps: 52 | Train Loss: 0.4070619 Vali Loss: 1.3218876 Test Loss: 0.3399245
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 28 cost time: 1.726635217666626
Epoch: 28, Steps: 52 | Train Loss: 0.4079510 Vali Loss: 1.3234689 Test Loss: 0.3388587
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 29 cost time: 1.728928565979004
Epoch: 29, Steps: 52 | Train Loss: 0.4068525 Vali Loss: 1.3190485 Test Loss: 0.3392893
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 30 cost time: 1.7323286533355713
Epoch: 30, Steps: 52 | Train Loss: 0.4056557 Vali Loss: 1.3185446 Test Loss: 0.3388435
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 31 cost time: 1.7297744750976562
Epoch: 31, Steps: 52 | Train Loss: 0.4055535 Vali Loss: 1.3178377 Test Loss: 0.3392798
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 32 cost time: 1.7216176986694336
Epoch: 32, Steps: 52 | Train Loss: 0.4073729 Vali Loss: 1.3233389 Test Loss: 0.3387208
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 33 cost time: 1.7265925407409668
Epoch: 33, Steps: 52 | Train Loss: 0.4058596 Vali Loss: 1.3180686 Test Loss: 0.3397939
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 34 cost time: 1.7217586040496826
Epoch: 34, Steps: 52 | Train Loss: 0.4081025 Vali Loss: 1.3193877 Test Loss: 0.3387132
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 35 cost time: 1.7211544513702393
Epoch: 35, Steps: 52 | Train Loss: 0.4069080 Vali Loss: 1.3147647 Test Loss: 0.3393221
Validation loss decreased (1.314783 --> 1.314765).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 36 cost time: 1.7261724472045898
Epoch: 36, Steps: 52 | Train Loss: 0.4059002 Vali Loss: 1.3176334 Test Loss: 0.3382829
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 37 cost time: 1.7234957218170166
Epoch: 37, Steps: 52 | Train Loss: 0.4073797 Vali Loss: 1.3128426 Test Loss: 0.3389784
Validation loss decreased (1.314765 --> 1.312843).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 38 cost time: 1.7260277271270752
Epoch: 38, Steps: 52 | Train Loss: 0.4057571 Vali Loss: 1.3169329 Test Loss: 0.3381256
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 39 cost time: 1.7208468914031982
Epoch: 39, Steps: 52 | Train Loss: 0.4063047 Vali Loss: 1.3093507 Test Loss: 0.3375382
Validation loss decreased (1.312843 --> 1.309351).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 40 cost time: 1.7388651371002197
Epoch: 40, Steps: 52 | Train Loss: 0.4073689 Vali Loss: 1.3197631 Test Loss: 0.3386787
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 41 cost time: 1.731821060180664
Epoch: 41, Steps: 52 | Train Loss: 0.4039431 Vali Loss: 1.3225917 Test Loss: 0.3391847
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 42 cost time: 1.7269048690795898
Epoch: 42, Steps: 52 | Train Loss: 0.4073735 Vali Loss: 1.3161705 Test Loss: 0.3384060
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 43 cost time: 1.7264227867126465
Epoch: 43, Steps: 52 | Train Loss: 0.4064106 Vali Loss: 1.3189807 Test Loss: 0.3381343
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 44 cost time: 1.7282612323760986
Epoch: 44, Steps: 52 | Train Loss: 0.4070582 Vali Loss: 1.3167201 Test Loss: 0.3378516
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 45 cost time: 1.7379686832427979
Epoch: 45, Steps: 52 | Train Loss: 0.4063586 Vali Loss: 1.3180369 Test Loss: 0.3376372
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 46 cost time: 1.7254159450531006
Epoch: 46, Steps: 52 | Train Loss: 0.4069110 Vali Loss: 1.3119752 Test Loss: 0.3375810
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 47 cost time: 1.7276947498321533
Epoch: 47, Steps: 52 | Train Loss: 0.4056641 Vali Loss: 1.3195162 Test Loss: 0.3370433
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 48 cost time: 1.7264444828033447
Epoch: 48, Steps: 52 | Train Loss: 0.4066731 Vali Loss: 1.3060195 Test Loss: 0.3380661
Validation loss decreased (1.309351 --> 1.306020).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 49 cost time: 1.7313275337219238
Epoch: 49, Steps: 52 | Train Loss: 0.4055666 Vali Loss: 1.3156047 Test Loss: 0.3387203
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 50 cost time: 1.7266504764556885
Epoch: 50, Steps: 52 | Train Loss: 0.4056521 Vali Loss: 1.3157226 Test Loss: 0.3384514
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 51 cost time: 1.7271757125854492
Epoch: 51, Steps: 52 | Train Loss: 0.4044378 Vali Loss: 1.3171420 Test Loss: 0.3373376
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 52 cost time: 1.7229328155517578
Epoch: 52, Steps: 52 | Train Loss: 0.4066733 Vali Loss: 1.3132017 Test Loss: 0.3376112
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 53 cost time: 1.732832431793213
Epoch: 53, Steps: 52 | Train Loss: 0.4057250 Vali Loss: 1.3138056 Test Loss: 0.3378380
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 54 cost time: 1.7228765487670898
Epoch: 54, Steps: 52 | Train Loss: 0.4053314 Vali Loss: 1.3214077 Test Loss: 0.3372962
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 55 cost time: 1.731079339981079
Epoch: 55, Steps: 52 | Train Loss: 0.4058827 Vali Loss: 1.3183744 Test Loss: 0.3374768
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 56 cost time: 1.7261381149291992
Epoch: 56, Steps: 52 | Train Loss: 0.4056428 Vali Loss: 1.3215623 Test Loss: 0.3386692
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 57 cost time: 1.7300162315368652
Epoch: 57, Steps: 52 | Train Loss: 0.4048941 Vali Loss: 1.3165004 Test Loss: 0.3379653
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 58 cost time: 1.7265994548797607
Epoch: 58, Steps: 52 | Train Loss: 0.4055654 Vali Loss: 1.3086926 Test Loss: 0.3373539
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 59 cost time: 1.7327921390533447
Epoch: 59, Steps: 52 | Train Loss: 0.4060039 Vali Loss: 1.3220227 Test Loss: 0.3381341
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 60 cost time: 1.7312266826629639
Epoch: 60, Steps: 52 | Train Loss: 0.4055185 Vali Loss: 1.3134258 Test Loss: 0.3373132
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33806607127189636, mae:0.3866923749446869, rse:0.47633183002471924
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05234575271606445 GB
Epoch: 1 cost time: 2.1754848957061768
Epoch: 1, Steps: 52 | Train Loss: 0.7017674 Vali Loss: 2.1562560 Test Loss: 1.3735024
Validation loss decreased (inf --> 2.156256).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 2 cost time: 0.7967767715454102
Epoch: 2, Steps: 52 | Train Loss: 0.6069939 Vali Loss: 1.6438794 Test Loss: 0.7365643
Validation loss decreased (2.156256 --> 1.643879).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 3 cost time: 0.7979941368103027
Epoch: 3, Steps: 52 | Train Loss: 0.4792742 Vali Loss: 1.4358180 Test Loss: 0.4497503
Validation loss decreased (1.643879 --> 1.435818).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 4 cost time: 0.7967398166656494
Epoch: 4, Steps: 52 | Train Loss: 0.4417291 Vali Loss: 1.3970313 Test Loss: 0.4069899
Validation loss decreased (1.435818 --> 1.397031).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 5 cost time: 0.9164314270019531
Epoch: 5, Steps: 52 | Train Loss: 0.4322884 Vali Loss: 1.3853409 Test Loss: 0.3857836
Validation loss decreased (1.397031 --> 1.385341).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 6 cost time: 1.7754876613616943
Epoch: 6, Steps: 52 | Train Loss: 0.4237046 Vali Loss: 1.3676103 Test Loss: 0.3735822
Validation loss decreased (1.385341 --> 1.367610).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 7 cost time: 1.783022403717041
Epoch: 7, Steps: 52 | Train Loss: 0.4195170 Vali Loss: 1.3650408 Test Loss: 0.3657913
Validation loss decreased (1.367610 --> 1.365041).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 8 cost time: 1.7763442993164062
Epoch: 8, Steps: 52 | Train Loss: 0.4186951 Vali Loss: 1.3492118 Test Loss: 0.3600646
Validation loss decreased (1.365041 --> 1.349212).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 9 cost time: 1.7830924987792969
Epoch: 9, Steps: 52 | Train Loss: 0.4142866 Vali Loss: 1.3520938 Test Loss: 0.3554128
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 10 cost time: 1.7808125019073486
Epoch: 10, Steps: 52 | Train Loss: 0.4131755 Vali Loss: 1.3314590 Test Loss: 0.3532918
Validation loss decreased (1.349212 --> 1.331459).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 11 cost time: 1.777472972869873
Epoch: 11, Steps: 52 | Train Loss: 0.4118273 Vali Loss: 1.3350133 Test Loss: 0.3523566
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 12 cost time: 1.781092643737793
Epoch: 12, Steps: 52 | Train Loss: 0.4114046 Vali Loss: 1.3363516 Test Loss: 0.3502167
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 13 cost time: 1.779090404510498
Epoch: 13, Steps: 52 | Train Loss: 0.4088507 Vali Loss: 1.3289008 Test Loss: 0.3484565
Validation loss decreased (1.331459 --> 1.328901).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 14 cost time: 1.7792508602142334
Epoch: 14, Steps: 52 | Train Loss: 0.4087852 Vali Loss: 1.3248714 Test Loss: 0.3470407
Validation loss decreased (1.328901 --> 1.324871).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 15 cost time: 1.7787814140319824
Epoch: 15, Steps: 52 | Train Loss: 0.4079125 Vali Loss: 1.3245751 Test Loss: 0.3477504
Validation loss decreased (1.324871 --> 1.324575).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 16 cost time: 1.7831721305847168
Epoch: 16, Steps: 52 | Train Loss: 0.4064177 Vali Loss: 1.3277574 Test Loss: 0.3471974
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 17 cost time: 1.7807228565216064
Epoch: 17, Steps: 52 | Train Loss: 0.4063040 Vali Loss: 1.3210032 Test Loss: 0.3467426
Validation loss decreased (1.324575 --> 1.321003).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 18 cost time: 1.7788655757904053
Epoch: 18, Steps: 52 | Train Loss: 0.4065850 Vali Loss: 1.3270751 Test Loss: 0.3465114
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 19 cost time: 1.7768912315368652
Epoch: 19, Steps: 52 | Train Loss: 0.4038471 Vali Loss: 1.3246946 Test Loss: 0.3458283
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 20 cost time: 1.7820723056793213
Epoch: 20, Steps: 52 | Train Loss: 0.4035789 Vali Loss: 1.3121886 Test Loss: 0.3444521
Validation loss decreased (1.321003 --> 1.312189).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 21 cost time: 1.7793591022491455
Epoch: 21, Steps: 52 | Train Loss: 0.4040979 Vali Loss: 1.3167362 Test Loss: 0.3474585
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 22 cost time: 1.7791013717651367
Epoch: 22, Steps: 52 | Train Loss: 0.4046785 Vali Loss: 1.3189373 Test Loss: 0.3445362
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 23 cost time: 1.7818214893341064
Epoch: 23, Steps: 52 | Train Loss: 0.4037756 Vali Loss: 1.3170114 Test Loss: 0.3437290
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 24 cost time: 1.7747886180877686
Epoch: 24, Steps: 52 | Train Loss: 0.4039148 Vali Loss: 1.3126647 Test Loss: 0.3445480
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 25 cost time: 1.785982370376587
Epoch: 25, Steps: 52 | Train Loss: 0.4016813 Vali Loss: 1.3173801 Test Loss: 0.3457336
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 26 cost time: 1.784968614578247
Epoch: 26, Steps: 52 | Train Loss: 0.4039012 Vali Loss: 1.3136727 Test Loss: 0.3443859
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 27 cost time: 1.7837915420532227
Epoch: 27, Steps: 52 | Train Loss: 0.4032868 Vali Loss: 1.3130901 Test Loss: 0.3439748
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 28 cost time: 1.777184009552002
Epoch: 28, Steps: 52 | Train Loss: 0.4035532 Vali Loss: 1.3189631 Test Loss: 0.3446110
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 29 cost time: 1.785038709640503
Epoch: 29, Steps: 52 | Train Loss: 0.4021674 Vali Loss: 1.3090518 Test Loss: 0.3442621
Validation loss decreased (1.312189 --> 1.309052).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 30 cost time: 1.7794406414031982
Epoch: 30, Steps: 52 | Train Loss: 0.4037264 Vali Loss: 1.3127513 Test Loss: 0.3459988
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 31 cost time: 1.7830359935760498
Epoch: 31, Steps: 52 | Train Loss: 0.4012599 Vali Loss: 1.3168728 Test Loss: 0.3452669
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 32 cost time: 1.7724635601043701
Epoch: 32, Steps: 52 | Train Loss: 0.4034631 Vali Loss: 1.3065481 Test Loss: 0.3437096
Validation loss decreased (1.309052 --> 1.306548).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 33 cost time: 1.777947187423706
Epoch: 33, Steps: 52 | Train Loss: 0.4017121 Vali Loss: 1.3175175 Test Loss: 0.3435421
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 34 cost time: 1.7793843746185303
Epoch: 34, Steps: 52 | Train Loss: 0.4022068 Vali Loss: 1.3119657 Test Loss: 0.3453639
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 35 cost time: 1.7795257568359375
Epoch: 35, Steps: 52 | Train Loss: 0.4022936 Vali Loss: 1.3144712 Test Loss: 0.3447269
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 36 cost time: 1.7768363952636719
Epoch: 36, Steps: 52 | Train Loss: 0.4015776 Vali Loss: 1.3136559 Test Loss: 0.3439564
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 37 cost time: 1.7793800830841064
Epoch: 37, Steps: 52 | Train Loss: 0.4016791 Vali Loss: 1.3145473 Test Loss: 0.3439624
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 38 cost time: 1.7808208465576172
Epoch: 38, Steps: 52 | Train Loss: 0.3997554 Vali Loss: 1.3096707 Test Loss: 0.3431605
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 39 cost time: 1.776534080505371
Epoch: 39, Steps: 52 | Train Loss: 0.4024734 Vali Loss: 1.3156394 Test Loss: 0.3435992
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 40 cost time: 1.7838757038116455
Epoch: 40, Steps: 52 | Train Loss: 0.4018920 Vali Loss: 1.3155441 Test Loss: 0.3430927
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 41 cost time: 1.7770981788635254
Epoch: 41, Steps: 52 | Train Loss: 0.4023946 Vali Loss: 1.3060887 Test Loss: 0.3437909
Validation loss decreased (1.306548 --> 1.306089).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 42 cost time: 1.7817058563232422
Epoch: 42, Steps: 52 | Train Loss: 0.4012505 Vali Loss: 1.3098519 Test Loss: 0.3426147
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 43 cost time: 1.7742292881011963
Epoch: 43, Steps: 52 | Train Loss: 0.4027410 Vali Loss: 1.3100641 Test Loss: 0.3436397
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 44 cost time: 1.770993947982788
Epoch: 44, Steps: 52 | Train Loss: 0.4029109 Vali Loss: 1.3038056 Test Loss: 0.3429494
Validation loss decreased (1.306089 --> 1.303806).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 45 cost time: 1.778761863708496
Epoch: 45, Steps: 52 | Train Loss: 0.4017138 Vali Loss: 1.3101001 Test Loss: 0.3435898
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 46 cost time: 1.7744476795196533
Epoch: 46, Steps: 52 | Train Loss: 0.4010828 Vali Loss: 1.3163134 Test Loss: 0.3441483
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 47 cost time: 1.7745146751403809
Epoch: 47, Steps: 52 | Train Loss: 0.4012699 Vali Loss: 1.3146799 Test Loss: 0.3445169
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 48 cost time: 1.7755553722381592
Epoch: 48, Steps: 52 | Train Loss: 0.4003865 Vali Loss: 1.3133885 Test Loss: 0.3452691
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 49 cost time: 1.7807910442352295
Epoch: 49, Steps: 52 | Train Loss: 0.4035100 Vali Loss: 1.3105292 Test Loss: 0.3422228
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 50 cost time: 1.7794854640960693
Epoch: 50, Steps: 52 | Train Loss: 0.4020521 Vali Loss: 1.3122627 Test Loss: 0.3435498
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 51 cost time: 1.7823047637939453
Epoch: 51, Steps: 52 | Train Loss: 0.4008866 Vali Loss: 1.3068199 Test Loss: 0.3431311
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 52 cost time: 1.7752761840820312
Epoch: 52, Steps: 52 | Train Loss: 0.4001216 Vali Loss: 1.3125294 Test Loss: 0.3436768
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 53 cost time: 1.7828078269958496
Epoch: 53, Steps: 52 | Train Loss: 0.4025598 Vali Loss: 1.3103132 Test Loss: 0.3454995
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 54 cost time: 1.7841591835021973
Epoch: 54, Steps: 52 | Train Loss: 0.4027890 Vali Loss: 1.3089246 Test Loss: 0.3437332
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 55 cost time: 1.774379014968872
Epoch: 55, Steps: 52 | Train Loss: 0.4010101 Vali Loss: 1.3146760 Test Loss: 0.3442728
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 56 cost time: 1.7785022258758545
Epoch: 56, Steps: 52 | Train Loss: 0.4020151 Vali Loss: 1.3135111 Test Loss: 0.3437379
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 57 cost time: 1.778730869293213
Epoch: 57, Steps: 52 | Train Loss: 0.4020232 Vali Loss: 1.3081777 Test Loss: 0.3436613
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 58 cost time: 1.7809362411499023
Epoch: 58, Steps: 52 | Train Loss: 0.4009928 Vali Loss: 1.3122786 Test Loss: 0.3446381
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 59 cost time: 1.7802321910858154
Epoch: 59, Steps: 52 | Train Loss: 0.4030707 Vali Loss: 1.3095452 Test Loss: 0.3453654
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 60 cost time: 1.7833564281463623
Epoch: 60, Steps: 52 | Train Loss: 0.4014152 Vali Loss: 1.3187945 Test Loss: 0.3446110
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34294939041137695, mae:0.39473602175712585, rse:0.4797597825527191
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.057065486907958984 GB
Epoch: 1 cost time: 2.1074461936950684
Epoch: 1, Steps: 52 | Train Loss: 0.7997690 Vali Loss: 2.0997934 Test Loss: 1.2030348
Validation loss decreased (inf --> 2.099793).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 2 cost time: 0.732619047164917
Epoch: 2, Steps: 52 | Train Loss: 0.6790980 Vali Loss: 1.6143463 Test Loss: 0.6375680
Validation loss decreased (2.099793 --> 1.614346).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 3 cost time: 0.7378578186035156
Epoch: 3, Steps: 52 | Train Loss: 0.5560719 Vali Loss: 1.4630835 Test Loss: 0.4655242
Validation loss decreased (1.614346 --> 1.463084).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 4 cost time: 0.7326278686523438
Epoch: 4, Steps: 52 | Train Loss: 0.5106543 Vali Loss: 1.4128618 Test Loss: 0.4178584
Validation loss decreased (1.463084 --> 1.412862).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 5 cost time: 0.7302370071411133
Epoch: 5, Steps: 52 | Train Loss: 0.4854009 Vali Loss: 1.3928449 Test Loss: 0.3978849
Validation loss decreased (1.412862 --> 1.392845).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 6 cost time: 1.3886876106262207
Epoch: 6, Steps: 52 | Train Loss: 0.4737076 Vali Loss: 1.3712600 Test Loss: 0.3844020
Validation loss decreased (1.392845 --> 1.371260).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 7 cost time: 1.62357497215271
Epoch: 7, Steps: 52 | Train Loss: 0.4646455 Vali Loss: 1.3666389 Test Loss: 0.3745509
Validation loss decreased (1.371260 --> 1.366639).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 8 cost time: 1.6192619800567627
Epoch: 8, Steps: 52 | Train Loss: 0.4569586 Vali Loss: 1.3557572 Test Loss: 0.3666072
Validation loss decreased (1.366639 --> 1.355757).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 9 cost time: 1.6225836277008057
Epoch: 9, Steps: 52 | Train Loss: 0.4526023 Vali Loss: 1.3467796 Test Loss: 0.3605197
Validation loss decreased (1.355757 --> 1.346780).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 10 cost time: 1.6144931316375732
Epoch: 10, Steps: 52 | Train Loss: 0.4467947 Vali Loss: 1.3392208 Test Loss: 0.3557824
Validation loss decreased (1.346780 --> 1.339221).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 11 cost time: 1.6190242767333984
Epoch: 11, Steps: 52 | Train Loss: 0.4455073 Vali Loss: 1.3454002 Test Loss: 0.3531331
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 12 cost time: 1.6137382984161377
Epoch: 12, Steps: 52 | Train Loss: 0.4398793 Vali Loss: 1.3375771 Test Loss: 0.3491094
Validation loss decreased (1.339221 --> 1.337577).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 13 cost time: 1.6234331130981445
Epoch: 13, Steps: 52 | Train Loss: 0.4384358 Vali Loss: 1.3383224 Test Loss: 0.3465991
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 14 cost time: 1.614877700805664
Epoch: 14, Steps: 52 | Train Loss: 0.4377629 Vali Loss: 1.3338034 Test Loss: 0.3447520
Validation loss decreased (1.337577 --> 1.333803).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 15 cost time: 1.6155548095703125
Epoch: 15, Steps: 52 | Train Loss: 0.4367823 Vali Loss: 1.3349146 Test Loss: 0.3425351
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 16 cost time: 1.6074600219726562
Epoch: 16, Steps: 52 | Train Loss: 0.4343263 Vali Loss: 1.3291538 Test Loss: 0.3413322
Validation loss decreased (1.333803 --> 1.329154).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 17 cost time: 1.6213030815124512
Epoch: 17, Steps: 52 | Train Loss: 0.4318359 Vali Loss: 1.3136146 Test Loss: 0.3401290
Validation loss decreased (1.329154 --> 1.313615).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 18 cost time: 1.6126041412353516
Epoch: 18, Steps: 52 | Train Loss: 0.4318508 Vali Loss: 1.3230082 Test Loss: 0.3389311
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 19 cost time: 1.6174280643463135
Epoch: 19, Steps: 52 | Train Loss: 0.4302611 Vali Loss: 1.3125155 Test Loss: 0.3378063
Validation loss decreased (1.313615 --> 1.312515).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 20 cost time: 1.6171061992645264
Epoch: 20, Steps: 52 | Train Loss: 0.4296764 Vali Loss: 1.3267636 Test Loss: 0.3373633
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 21 cost time: 1.6182177066802979
Epoch: 21, Steps: 52 | Train Loss: 0.4290582 Vali Loss: 1.3190833 Test Loss: 0.3366137
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 22 cost time: 1.6159021854400635
Epoch: 22, Steps: 52 | Train Loss: 0.4289465 Vali Loss: 1.3105803 Test Loss: 0.3361753
Validation loss decreased (1.312515 --> 1.310580).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 23 cost time: 1.6166179180145264
Epoch: 23, Steps: 52 | Train Loss: 0.4280763 Vali Loss: 1.3247973 Test Loss: 0.3354392
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 24 cost time: 1.6137683391571045
Epoch: 24, Steps: 52 | Train Loss: 0.4270969 Vali Loss: 1.3151246 Test Loss: 0.3349445
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 25 cost time: 1.6203598976135254
Epoch: 25, Steps: 52 | Train Loss: 0.4252051 Vali Loss: 1.3187181 Test Loss: 0.3349766
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 26 cost time: 1.6155877113342285
Epoch: 26, Steps: 52 | Train Loss: 0.4247989 Vali Loss: 1.3125038 Test Loss: 0.3340899
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 27 cost time: 1.620412826538086
Epoch: 27, Steps: 52 | Train Loss: 0.4243984 Vali Loss: 1.3191395 Test Loss: 0.3340544
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 28 cost time: 1.6152427196502686
Epoch: 28, Steps: 52 | Train Loss: 0.4248497 Vali Loss: 1.3195512 Test Loss: 0.3334949
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 29 cost time: 1.6137592792510986
Epoch: 29, Steps: 52 | Train Loss: 0.4242322 Vali Loss: 1.3178248 Test Loss: 0.3338490
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 30 cost time: 1.6172356605529785
Epoch: 30, Steps: 52 | Train Loss: 0.4240782 Vali Loss: 1.3181134 Test Loss: 0.3329752
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 31 cost time: 1.618570327758789
Epoch: 31, Steps: 52 | Train Loss: 0.4237413 Vali Loss: 1.3199270 Test Loss: 0.3328684
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 32 cost time: 1.6206462383270264
Epoch: 32, Steps: 52 | Train Loss: 0.4226734 Vali Loss: 1.3150456 Test Loss: 0.3326734
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 33 cost time: 1.6186952590942383
Epoch: 33, Steps: 52 | Train Loss: 0.4233061 Vali Loss: 1.3117810 Test Loss: 0.3328909
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 34 cost time: 1.612257957458496
Epoch: 34, Steps: 52 | Train Loss: 0.4257680 Vali Loss: 1.3089416 Test Loss: 0.3324116
Validation loss decreased (1.310580 --> 1.308942).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 35 cost time: 1.6244046688079834
Epoch: 35, Steps: 52 | Train Loss: 0.4234264 Vali Loss: 1.3079146 Test Loss: 0.3321242
Validation loss decreased (1.308942 --> 1.307915).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 36 cost time: 1.6160755157470703
Epoch: 36, Steps: 52 | Train Loss: 0.4226514 Vali Loss: 1.3173740 Test Loss: 0.3320455
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 37 cost time: 1.620408535003662
Epoch: 37, Steps: 52 | Train Loss: 0.4236353 Vali Loss: 1.3147250 Test Loss: 0.3322077
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 38 cost time: 1.616121768951416
Epoch: 38, Steps: 52 | Train Loss: 0.4214684 Vali Loss: 1.3180538 Test Loss: 0.3319051
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 39 cost time: 1.6199631690979004
Epoch: 39, Steps: 52 | Train Loss: 0.4242853 Vali Loss: 1.3060176 Test Loss: 0.3322672
Validation loss decreased (1.307915 --> 1.306018).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 40 cost time: 1.6159336566925049
Epoch: 40, Steps: 52 | Train Loss: 0.4211675 Vali Loss: 1.3135478 Test Loss: 0.3319135
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 41 cost time: 1.6190214157104492
Epoch: 41, Steps: 52 | Train Loss: 0.4219303 Vali Loss: 1.3060229 Test Loss: 0.3318177
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 42 cost time: 1.6147618293762207
Epoch: 42, Steps: 52 | Train Loss: 0.4227724 Vali Loss: 1.3079652 Test Loss: 0.3316143
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 43 cost time: 1.619856357574463
Epoch: 43, Steps: 52 | Train Loss: 0.4211632 Vali Loss: 1.3130702 Test Loss: 0.3317678
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 44 cost time: 1.6185712814331055
Epoch: 44, Steps: 52 | Train Loss: 0.4230760 Vali Loss: 1.3088813 Test Loss: 0.3316017
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 45 cost time: 1.6183879375457764
Epoch: 45, Steps: 52 | Train Loss: 0.4235869 Vali Loss: 1.3101637 Test Loss: 0.3311111
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 46 cost time: 1.6160049438476562
Epoch: 46, Steps: 52 | Train Loss: 0.4230631 Vali Loss: 1.3116829 Test Loss: 0.3316709
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 47 cost time: 1.6188209056854248
Epoch: 47, Steps: 52 | Train Loss: 0.4222278 Vali Loss: 1.3124670 Test Loss: 0.3309375
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 48 cost time: 1.6169133186340332
Epoch: 48, Steps: 52 | Train Loss: 0.4228542 Vali Loss: 1.3146212 Test Loss: 0.3311992
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 49 cost time: 1.6170287132263184
Epoch: 49, Steps: 52 | Train Loss: 0.4210529 Vali Loss: 1.3104806 Test Loss: 0.3310682
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 50 cost time: 1.6124048233032227
Epoch: 50, Steps: 52 | Train Loss: 0.4211187 Vali Loss: 1.3105471 Test Loss: 0.3311116
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 51 cost time: 1.6162712574005127
Epoch: 51, Steps: 52 | Train Loss: 0.4222745 Vali Loss: 1.3122056 Test Loss: 0.3313636
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 52 cost time: 1.6156871318817139
Epoch: 52, Steps: 52 | Train Loss: 0.4228331 Vali Loss: 1.3162370 Test Loss: 0.3309764
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 53 cost time: 1.6196086406707764
Epoch: 53, Steps: 52 | Train Loss: 0.4231978 Vali Loss: 1.3128510 Test Loss: 0.3317391
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 54 cost time: 1.6115658283233643
Epoch: 54, Steps: 52 | Train Loss: 0.4224721 Vali Loss: 1.3122239 Test Loss: 0.3311531
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 55 cost time: 1.6216578483581543
Epoch: 55, Steps: 52 | Train Loss: 0.4235201 Vali Loss: 1.3097453 Test Loss: 0.3310670
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 56 cost time: 1.6117732524871826
Epoch: 56, Steps: 52 | Train Loss: 0.4209446 Vali Loss: 1.3073690 Test Loss: 0.3307477
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 57 cost time: 1.6168529987335205
Epoch: 57, Steps: 52 | Train Loss: 0.4211904 Vali Loss: 1.3098950 Test Loss: 0.3311532
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 58 cost time: 1.6139869689941406
Epoch: 58, Steps: 52 | Train Loss: 0.4219754 Vali Loss: 1.3087342 Test Loss: 0.3308836
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 59 cost time: 1.6138620376586914
Epoch: 59, Steps: 52 | Train Loss: 0.4207411 Vali Loss: 1.3123424 Test Loss: 0.3313026
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 60 cost time: 1.6152446269989014
Epoch: 60, Steps: 52 | Train Loss: 0.4211670 Vali Loss: 1.3055792 Test Loss: 0.3309701
Validation loss decreased (1.306018 --> 1.305579).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3309701085090637, mae:0.3722546100616455, rse:0.4713062644004822
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.05849742889404297 GB
Epoch: 1 cost time: 2.1451210975646973
Epoch: 1, Steps: 52 | Train Loss: 0.7791878 Vali Loss: 2.2324038 Test Loss: 1.4753726
Validation loss decreased (inf --> 2.232404).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 2 cost time: 0.7721738815307617
Epoch: 2, Steps: 52 | Train Loss: 0.6548156 Vali Loss: 1.6830263 Test Loss: 0.7935959
Validation loss decreased (2.232404 --> 1.683026).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 3 cost time: 0.7590000629425049
Epoch: 3, Steps: 52 | Train Loss: 0.5204455 Vali Loss: 1.4740248 Test Loss: 0.4913980
Validation loss decreased (1.683026 --> 1.474025).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 4 cost time: 0.7586102485656738
Epoch: 4, Steps: 52 | Train Loss: 0.4692825 Vali Loss: 1.4161328 Test Loss: 0.4164706
Validation loss decreased (1.474025 --> 1.416133).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 5 cost time: 0.7648234367370605
Epoch: 5, Steps: 52 | Train Loss: 0.4512166 Vali Loss: 1.3821782 Test Loss: 0.3922653
Validation loss decreased (1.416133 --> 1.382178).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 6 cost time: 1.68003249168396
Epoch: 6, Steps: 52 | Train Loss: 0.4405290 Vali Loss: 1.3776515 Test Loss: 0.3787702
Validation loss decreased (1.382178 --> 1.377651).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 7 cost time: 1.6782267093658447
Epoch: 7, Steps: 52 | Train Loss: 0.4358774 Vali Loss: 1.3683596 Test Loss: 0.3695526
Validation loss decreased (1.377651 --> 1.368360).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 8 cost time: 1.6843993663787842
Epoch: 8, Steps: 52 | Train Loss: 0.4321156 Vali Loss: 1.3471458 Test Loss: 0.3631123
Validation loss decreased (1.368360 --> 1.347146).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 9 cost time: 1.6741294860839844
Epoch: 9, Steps: 52 | Train Loss: 0.4268073 Vali Loss: 1.3487962 Test Loss: 0.3591077
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 10 cost time: 1.6848082542419434
Epoch: 10, Steps: 52 | Train Loss: 0.4254345 Vali Loss: 1.3491229 Test Loss: 0.3555301
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 11 cost time: 1.6777827739715576
Epoch: 11, Steps: 52 | Train Loss: 0.4223981 Vali Loss: 1.3347955 Test Loss: 0.3518542
Validation loss decreased (1.347146 --> 1.334795).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 12 cost time: 1.686020851135254
Epoch: 12, Steps: 52 | Train Loss: 0.4207734 Vali Loss: 1.3400218 Test Loss: 0.3500089
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 13 cost time: 1.6800196170806885
Epoch: 13, Steps: 52 | Train Loss: 0.4180512 Vali Loss: 1.3361460 Test Loss: 0.3476066
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 14 cost time: 1.6843364238739014
Epoch: 14, Steps: 52 | Train Loss: 0.4177543 Vali Loss: 1.3286860 Test Loss: 0.3465850
Validation loss decreased (1.334795 --> 1.328686).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 15 cost time: 1.678889274597168
Epoch: 15, Steps: 52 | Train Loss: 0.4185044 Vali Loss: 1.3278611 Test Loss: 0.3446251
Validation loss decreased (1.328686 --> 1.327861).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 16 cost time: 1.6810452938079834
Epoch: 16, Steps: 52 | Train Loss: 0.4155520 Vali Loss: 1.3241593 Test Loss: 0.3444454
Validation loss decreased (1.327861 --> 1.324159).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 17 cost time: 1.6793599128723145
Epoch: 17, Steps: 52 | Train Loss: 0.4155743 Vali Loss: 1.3272657 Test Loss: 0.3432809
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 18 cost time: 1.6788036823272705
Epoch: 18, Steps: 52 | Train Loss: 0.4138596 Vali Loss: 1.3189332 Test Loss: 0.3421052
Validation loss decreased (1.324159 --> 1.318933).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 19 cost time: 1.6776602268218994
Epoch: 19, Steps: 52 | Train Loss: 0.4134165 Vali Loss: 1.3244246 Test Loss: 0.3411879
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 20 cost time: 1.6805047988891602
Epoch: 20, Steps: 52 | Train Loss: 0.4140584 Vali Loss: 1.3242726 Test Loss: 0.3411863
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 21 cost time: 1.6776723861694336
Epoch: 21, Steps: 52 | Train Loss: 0.4130231 Vali Loss: 1.3262566 Test Loss: 0.3409418
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 22 cost time: 1.6737315654754639
Epoch: 22, Steps: 52 | Train Loss: 0.4126609 Vali Loss: 1.3206394 Test Loss: 0.3401076
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 23 cost time: 1.6741223335266113
Epoch: 23, Steps: 52 | Train Loss: 0.4119473 Vali Loss: 1.3154365 Test Loss: 0.3395228
Validation loss decreased (1.318933 --> 1.315436).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 24 cost time: 1.6786165237426758
Epoch: 24, Steps: 52 | Train Loss: 0.4117044 Vali Loss: 1.3177516 Test Loss: 0.3395750
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 25 cost time: 1.6825895309448242
Epoch: 25, Steps: 52 | Train Loss: 0.4100873 Vali Loss: 1.3152928 Test Loss: 0.3383166
Validation loss decreased (1.315436 --> 1.315293).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 26 cost time: 1.6800646781921387
Epoch: 26, Steps: 52 | Train Loss: 0.4099013 Vali Loss: 1.3091867 Test Loss: 0.3391930
Validation loss decreased (1.315293 --> 1.309187).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 27 cost time: 1.6808395385742188
Epoch: 27, Steps: 52 | Train Loss: 0.4101154 Vali Loss: 1.3219951 Test Loss: 0.3385966
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 28 cost time: 1.6794986724853516
Epoch: 28, Steps: 52 | Train Loss: 0.4110287 Vali Loss: 1.3184891 Test Loss: 0.3376668
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 29 cost time: 1.6803951263427734
Epoch: 29, Steps: 52 | Train Loss: 0.4083849 Vali Loss: 1.3201737 Test Loss: 0.3371752
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 30 cost time: 1.6783661842346191
Epoch: 30, Steps: 52 | Train Loss: 0.4104625 Vali Loss: 1.3195007 Test Loss: 0.3374132
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 31 cost time: 1.6821353435516357
Epoch: 31, Steps: 52 | Train Loss: 0.4111394 Vali Loss: 1.3054554 Test Loss: 0.3376300
Validation loss decreased (1.309187 --> 1.305455).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 32 cost time: 1.6796307563781738
Epoch: 32, Steps: 52 | Train Loss: 0.4100127 Vali Loss: 1.3165891 Test Loss: 0.3387179
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 33 cost time: 1.6827778816223145
Epoch: 33, Steps: 52 | Train Loss: 0.4093648 Vali Loss: 1.3093700 Test Loss: 0.3365922
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 34 cost time: 1.6791911125183105
Epoch: 34, Steps: 52 | Train Loss: 0.4089903 Vali Loss: 1.3160145 Test Loss: 0.3364275
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 35 cost time: 1.6830289363861084
Epoch: 35, Steps: 52 | Train Loss: 0.4110605 Vali Loss: 1.3077862 Test Loss: 0.3378860
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 36 cost time: 1.6789326667785645
Epoch: 36, Steps: 52 | Train Loss: 0.4093742 Vali Loss: 1.3106023 Test Loss: 0.3370042
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 37 cost time: 1.6796753406524658
Epoch: 37, Steps: 52 | Train Loss: 0.4097984 Vali Loss: 1.3113426 Test Loss: 0.3365650
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 38 cost time: 1.6739284992218018
Epoch: 38, Steps: 52 | Train Loss: 0.4098314 Vali Loss: 1.3138895 Test Loss: 0.3372946
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 39 cost time: 1.6790215969085693
Epoch: 39, Steps: 52 | Train Loss: 0.4107710 Vali Loss: 1.3122847 Test Loss: 0.3365055
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 40 cost time: 1.6777820587158203
Epoch: 40, Steps: 52 | Train Loss: 0.4083007 Vali Loss: 1.3050888 Test Loss: 0.3364749
Validation loss decreased (1.305455 --> 1.305089).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 41 cost time: 1.681307077407837
Epoch: 41, Steps: 52 | Train Loss: 0.4101203 Vali Loss: 1.3125528 Test Loss: 0.3365785
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 42 cost time: 1.6788432598114014
Epoch: 42, Steps: 52 | Train Loss: 0.4068769 Vali Loss: 1.3095598 Test Loss: 0.3370587
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 43 cost time: 1.6829473972320557
Epoch: 43, Steps: 52 | Train Loss: 0.4084340 Vali Loss: 1.3128830 Test Loss: 0.3366979
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 44 cost time: 1.6755952835083008
Epoch: 44, Steps: 52 | Train Loss: 0.4085196 Vali Loss: 1.3152816 Test Loss: 0.3366975
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 45 cost time: 1.6860008239746094
Epoch: 45, Steps: 52 | Train Loss: 0.4075174 Vali Loss: 1.3127835 Test Loss: 0.3370371
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 46 cost time: 1.6804499626159668
Epoch: 46, Steps: 52 | Train Loss: 0.4071310 Vali Loss: 1.3147951 Test Loss: 0.3368682
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 47 cost time: 1.6861491203308105
Epoch: 47, Steps: 52 | Train Loss: 0.4082344 Vali Loss: 1.3127921 Test Loss: 0.3365782
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 48 cost time: 1.6812682151794434
Epoch: 48, Steps: 52 | Train Loss: 0.4109702 Vali Loss: 1.3033857 Test Loss: 0.3365861
Validation loss decreased (1.305089 --> 1.303386).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 49 cost time: 1.681023359298706
Epoch: 49, Steps: 52 | Train Loss: 0.4082749 Vali Loss: 1.3147348 Test Loss: 0.3362811
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 50 cost time: 1.6783065795898438
Epoch: 50, Steps: 52 | Train Loss: 0.4076414 Vali Loss: 1.3170528 Test Loss: 0.3373102
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 51 cost time: 1.6782302856445312
Epoch: 51, Steps: 52 | Train Loss: 0.4079688 Vali Loss: 1.3056645 Test Loss: 0.3362361
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 52 cost time: 1.6750779151916504
Epoch: 52, Steps: 52 | Train Loss: 0.4090356 Vali Loss: 1.3081152 Test Loss: 0.3361699
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 53 cost time: 1.6784496307373047
Epoch: 53, Steps: 52 | Train Loss: 0.4095156 Vali Loss: 1.3063090 Test Loss: 0.3371908
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 54 cost time: 1.6806139945983887
Epoch: 54, Steps: 52 | Train Loss: 0.4090221 Vali Loss: 1.3107544 Test Loss: 0.3364022
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 55 cost time: 1.6782469749450684
Epoch: 55, Steps: 52 | Train Loss: 0.4091779 Vali Loss: 1.3160981 Test Loss: 0.3366767
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 56 cost time: 1.6753318309783936
Epoch: 56, Steps: 52 | Train Loss: 0.4093127 Vali Loss: 1.3108819 Test Loss: 0.3365667
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 57 cost time: 1.671452283859253
Epoch: 57, Steps: 52 | Train Loss: 0.4081184 Vali Loss: 1.3138630 Test Loss: 0.3366096
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 58 cost time: 1.6721422672271729
Epoch: 58, Steps: 52 | Train Loss: 0.4095831 Vali Loss: 1.3169689 Test Loss: 0.3362971
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 59 cost time: 1.6837646961212158
Epoch: 59, Steps: 52 | Train Loss: 0.4086560 Vali Loss: 1.3151655 Test Loss: 0.3361594
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 60 cost time: 1.6752517223358154
Epoch: 60, Steps: 52 | Train Loss: 0.4090105 Vali Loss: 1.3084724 Test Loss: 0.3363734
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33658602833747864, mae:0.38438308238983154, rse:0.4752880036830902
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.05961751937866211 GB
Epoch: 1 cost time: 2.128330945968628
Epoch: 1, Steps: 52 | Train Loss: 0.7335567 Vali Loss: 2.2144299 Test Loss: 1.4752586
Validation loss decreased (inf --> 2.214430).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 2 cost time: 0.766139030456543
Epoch: 2, Steps: 52 | Train Loss: 0.6399816 Vali Loss: 1.7416195 Test Loss: 0.8749025
Validation loss decreased (2.214430 --> 1.741619).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 3 cost time: 0.7776205539703369
Epoch: 3, Steps: 52 | Train Loss: 0.5081422 Vali Loss: 1.4602280 Test Loss: 0.4619333
Validation loss decreased (1.741619 --> 1.460228).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 4 cost time: 0.7724432945251465
Epoch: 4, Steps: 52 | Train Loss: 0.4542915 Vali Loss: 1.3888060 Test Loss: 0.3945247
Validation loss decreased (1.460228 --> 1.388806).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 5 cost time: 0.7701535224914551
Epoch: 5, Steps: 52 | Train Loss: 0.4378532 Vali Loss: 1.3669124 Test Loss: 0.3730248
Validation loss decreased (1.388806 --> 1.366912).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 6 cost time: 1.7200632095336914
Epoch: 6, Steps: 52 | Train Loss: 0.4300533 Vali Loss: 1.3582432 Test Loss: 0.3631532
Validation loss decreased (1.366912 --> 1.358243).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 7 cost time: 1.7268223762512207
Epoch: 7, Steps: 52 | Train Loss: 0.4247002 Vali Loss: 1.3428423 Test Loss: 0.3580167
Validation loss decreased (1.358243 --> 1.342842).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 8 cost time: 1.7181341648101807
Epoch: 8, Steps: 52 | Train Loss: 0.4219628 Vali Loss: 1.3330863 Test Loss: 0.3527059
Validation loss decreased (1.342842 --> 1.333086).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 9 cost time: 1.7251696586608887
Epoch: 9, Steps: 52 | Train Loss: 0.4184640 Vali Loss: 1.3351268 Test Loss: 0.3490161
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 10 cost time: 1.7237792015075684
Epoch: 10, Steps: 52 | Train Loss: 0.4181200 Vali Loss: 1.3185649 Test Loss: 0.3466411
Validation loss decreased (1.333086 --> 1.318565).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 11 cost time: 1.7254478931427002
Epoch: 11, Steps: 52 | Train Loss: 0.4152919 Vali Loss: 1.3260977 Test Loss: 0.3441359
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 12 cost time: 1.7215561866760254
Epoch: 12, Steps: 52 | Train Loss: 0.4140855 Vali Loss: 1.3306353 Test Loss: 0.3424625
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 13 cost time: 1.7248992919921875
Epoch: 13, Steps: 52 | Train Loss: 0.4120327 Vali Loss: 1.3240288 Test Loss: 0.3413044
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 14 cost time: 1.719627857208252
Epoch: 14, Steps: 52 | Train Loss: 0.4107585 Vali Loss: 1.3187735 Test Loss: 0.3398246
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 15 cost time: 1.727982759475708
Epoch: 15, Steps: 52 | Train Loss: 0.4107976 Vali Loss: 1.3220315 Test Loss: 0.3383701
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 16 cost time: 1.7234294414520264
Epoch: 16, Steps: 52 | Train Loss: 0.4084844 Vali Loss: 1.3119717 Test Loss: 0.3373178
Validation loss decreased (1.318565 --> 1.311972).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 17 cost time: 1.7188355922698975
Epoch: 17, Steps: 52 | Train Loss: 0.4084700 Vali Loss: 1.3163154 Test Loss: 0.3360587
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 18 cost time: 1.7199206352233887
Epoch: 18, Steps: 52 | Train Loss: 0.4070894 Vali Loss: 1.3065088 Test Loss: 0.3358713
Validation loss decreased (1.311972 --> 1.306509).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 19 cost time: 1.7216923236846924
Epoch: 19, Steps: 52 | Train Loss: 0.4061293 Vali Loss: 1.3142780 Test Loss: 0.3356737
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 20 cost time: 1.7264835834503174
Epoch: 20, Steps: 52 | Train Loss: 0.4069692 Vali Loss: 1.3060350 Test Loss: 0.3352675
Validation loss decreased (1.306509 --> 1.306035).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 21 cost time: 1.717010259628296
Epoch: 21, Steps: 52 | Train Loss: 0.4037955 Vali Loss: 1.3026838 Test Loss: 0.3343868
Validation loss decreased (1.306035 --> 1.302684).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 22 cost time: 1.7214689254760742
Epoch: 22, Steps: 52 | Train Loss: 0.4063376 Vali Loss: 1.3083876 Test Loss: 0.3340921
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 23 cost time: 1.7185332775115967
Epoch: 23, Steps: 52 | Train Loss: 0.4050024 Vali Loss: 1.3084520 Test Loss: 0.3342224
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 24 cost time: 1.7260141372680664
Epoch: 24, Steps: 52 | Train Loss: 0.4045071 Vali Loss: 1.3058584 Test Loss: 0.3331369
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 25 cost time: 1.7228336334228516
Epoch: 25, Steps: 52 | Train Loss: 0.4051141 Vali Loss: 1.3147435 Test Loss: 0.3325990
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 26 cost time: 1.7205379009246826
Epoch: 26, Steps: 52 | Train Loss: 0.4042463 Vali Loss: 1.3040029 Test Loss: 0.3327454
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 27 cost time: 1.7197237014770508
Epoch: 27, Steps: 52 | Train Loss: 0.4052169 Vali Loss: 1.3015027 Test Loss: 0.3319912
Validation loss decreased (1.302684 --> 1.301503).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 28 cost time: 1.7294189929962158
Epoch: 28, Steps: 52 | Train Loss: 0.4067232 Vali Loss: 1.3041962 Test Loss: 0.3325490
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 29 cost time: 1.7212438583374023
Epoch: 29, Steps: 52 | Train Loss: 0.4050274 Vali Loss: 1.3101640 Test Loss: 0.3321010
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 30 cost time: 1.7265543937683105
Epoch: 30, Steps: 52 | Train Loss: 0.4047403 Vali Loss: 1.3105764 Test Loss: 0.3318902
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 31 cost time: 1.7199909687042236
Epoch: 31, Steps: 52 | Train Loss: 0.4037839 Vali Loss: 1.3046079 Test Loss: 0.3323781
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 32 cost time: 1.7207667827606201
Epoch: 32, Steps: 52 | Train Loss: 0.4034551 Vali Loss: 1.3073066 Test Loss: 0.3324062
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 33 cost time: 1.715402364730835
Epoch: 33, Steps: 52 | Train Loss: 0.4022706 Vali Loss: 1.3044895 Test Loss: 0.3315923
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 34 cost time: 1.7244813442230225
Epoch: 34, Steps: 52 | Train Loss: 0.4016721 Vali Loss: 1.3069810 Test Loss: 0.3316567
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 35 cost time: 1.7233037948608398
Epoch: 35, Steps: 52 | Train Loss: 0.4045788 Vali Loss: 1.3080932 Test Loss: 0.3309290
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 36 cost time: 1.7236688137054443
Epoch: 36, Steps: 52 | Train Loss: 0.4035675 Vali Loss: 1.2986546 Test Loss: 0.3308497
Validation loss decreased (1.301503 --> 1.298655).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 37 cost time: 1.718306303024292
Epoch: 37, Steps: 52 | Train Loss: 0.4040475 Vali Loss: 1.3067322 Test Loss: 0.3315018
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 38 cost time: 1.7203705310821533
Epoch: 38, Steps: 52 | Train Loss: 0.4035212 Vali Loss: 1.3006469 Test Loss: 0.3306903
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 39 cost time: 1.723625659942627
Epoch: 39, Steps: 52 | Train Loss: 0.4032627 Vali Loss: 1.3047068 Test Loss: 0.3310960
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 40 cost time: 1.7179663181304932
Epoch: 40, Steps: 52 | Train Loss: 0.4046460 Vali Loss: 1.3086728 Test Loss: 0.3315238
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 41 cost time: 1.722179889678955
Epoch: 41, Steps: 52 | Train Loss: 0.4049229 Vali Loss: 1.3016690 Test Loss: 0.3305346
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 42 cost time: 1.7183330059051514
Epoch: 42, Steps: 52 | Train Loss: 0.4040463 Vali Loss: 1.3048973 Test Loss: 0.3314573
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 43 cost time: 1.7279982566833496
Epoch: 43, Steps: 52 | Train Loss: 0.4031223 Vali Loss: 1.3050423 Test Loss: 0.3313637
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 44 cost time: 1.7172877788543701
Epoch: 44, Steps: 52 | Train Loss: 0.4027390 Vali Loss: 1.3050807 Test Loss: 0.3311107
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 45 cost time: 1.7184748649597168
Epoch: 45, Steps: 52 | Train Loss: 0.4053008 Vali Loss: 1.3043108 Test Loss: 0.3307412
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 46 cost time: 1.7202832698822021
Epoch: 46, Steps: 52 | Train Loss: 0.4031448 Vali Loss: 1.3005326 Test Loss: 0.3301357
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 47 cost time: 1.723811388015747
Epoch: 47, Steps: 52 | Train Loss: 0.4030469 Vali Loss: 1.2995095 Test Loss: 0.3307718
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 48 cost time: 1.7236340045928955
Epoch: 48, Steps: 52 | Train Loss: 0.4034645 Vali Loss: 1.3019121 Test Loss: 0.3309285
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 49 cost time: 1.7230794429779053
Epoch: 49, Steps: 52 | Train Loss: 0.4029616 Vali Loss: 1.3032755 Test Loss: 0.3307581
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 50 cost time: 1.7212984561920166
Epoch: 50, Steps: 52 | Train Loss: 0.4032637 Vali Loss: 1.3060451 Test Loss: 0.3308822
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 51 cost time: 1.7207212448120117
Epoch: 51, Steps: 52 | Train Loss: 0.4022737 Vali Loss: 1.3008802 Test Loss: 0.3306102
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 52 cost time: 1.720839023590088
Epoch: 52, Steps: 52 | Train Loss: 0.4023882 Vali Loss: 1.2981619 Test Loss: 0.3311561
Validation loss decreased (1.298655 --> 1.298162).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 53 cost time: 1.7273945808410645
Epoch: 53, Steps: 52 | Train Loss: 0.4027374 Vali Loss: 1.3045321 Test Loss: 0.3312726
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 54 cost time: 1.721217155456543
Epoch: 54, Steps: 52 | Train Loss: 0.4023359 Vali Loss: 1.3052415 Test Loss: 0.3310629
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 55 cost time: 1.723353624343872
Epoch: 55, Steps: 52 | Train Loss: 0.4018215 Vali Loss: 1.3063273 Test Loss: 0.3312556
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 56 cost time: 1.7209937572479248
Epoch: 56, Steps: 52 | Train Loss: 0.4038583 Vali Loss: 1.3006184 Test Loss: 0.3304835
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 57 cost time: 1.7295112609863281
Epoch: 57, Steps: 52 | Train Loss: 0.4018058 Vali Loss: 1.3019983 Test Loss: 0.3309581
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 58 cost time: 1.721421718597412
Epoch: 58, Steps: 52 | Train Loss: 0.4039331 Vali Loss: 1.2926741 Test Loss: 0.3305950
Validation loss decreased (1.298162 --> 1.292674).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 59 cost time: 1.7227683067321777
Epoch: 59, Steps: 52 | Train Loss: 0.4053541 Vali Loss: 1.2932272 Test Loss: 0.3297053
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 60 cost time: 1.7229983806610107
Epoch: 60, Steps: 52 | Train Loss: 0.4034699 Vali Loss: 1.3056600 Test Loss: 0.3305877
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3305949866771698, mae:0.37676796317100525, rse:0.4710390865802765
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.057227134704589844 GB
Epoch: 1 cost time: 2.1056125164031982
Epoch: 1, Steps: 52 | Train Loss: 0.7639781 Vali Loss: 2.0403914 Test Loss: 1.1160161
Validation loss decreased (inf --> 2.040391).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 2 cost time: 0.7389817237854004
Epoch: 2, Steps: 52 | Train Loss: 0.6433735 Vali Loss: 1.5476310 Test Loss: 0.5671640
Validation loss decreased (2.040391 --> 1.547631).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 3 cost time: 0.7373216152191162
Epoch: 3, Steps: 52 | Train Loss: 0.5297549 Vali Loss: 1.4364678 Test Loss: 0.4380839
Validation loss decreased (1.547631 --> 1.436468).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 4 cost time: 0.7424125671386719
Epoch: 4, Steps: 52 | Train Loss: 0.4895409 Vali Loss: 1.3942482 Test Loss: 0.3968992
Validation loss decreased (1.436468 --> 1.394248).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 5 cost time: 0.7172799110412598
Epoch: 5, Steps: 52 | Train Loss: 0.4728678 Vali Loss: 1.3758485 Test Loss: 0.3799466
Validation loss decreased (1.394248 --> 1.375849).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 6 cost time: 1.4448368549346924
Epoch: 6, Steps: 52 | Train Loss: 0.4604540 Vali Loss: 1.3667734 Test Loss: 0.3675359
Validation loss decreased (1.375849 --> 1.366773).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 7 cost time: 1.6336851119995117
Epoch: 7, Steps: 52 | Train Loss: 0.4536335 Vali Loss: 1.3558633 Test Loss: 0.3595831
Validation loss decreased (1.366773 --> 1.355863).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 8 cost time: 1.63377046585083
Epoch: 8, Steps: 52 | Train Loss: 0.4454642 Vali Loss: 1.3478143 Test Loss: 0.3541231
Validation loss decreased (1.355863 --> 1.347814).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 9 cost time: 1.6349899768829346
Epoch: 9, Steps: 52 | Train Loss: 0.4412822 Vali Loss: 1.3375618 Test Loss: 0.3502189
Validation loss decreased (1.347814 --> 1.337562).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 10 cost time: 1.6311569213867188
Epoch: 10, Steps: 52 | Train Loss: 0.4386428 Vali Loss: 1.3308556 Test Loss: 0.3469572
Validation loss decreased (1.337562 --> 1.330856).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 11 cost time: 1.6334528923034668
Epoch: 11, Steps: 52 | Train Loss: 0.4345617 Vali Loss: 1.3340235 Test Loss: 0.3445215
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 12 cost time: 1.6315484046936035
Epoch: 12, Steps: 52 | Train Loss: 0.4325522 Vali Loss: 1.3291526 Test Loss: 0.3426128
Validation loss decreased (1.330856 --> 1.329153).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 13 cost time: 1.6327934265136719
Epoch: 13, Steps: 52 | Train Loss: 0.4305631 Vali Loss: 1.3246672 Test Loss: 0.3413607
Validation loss decreased (1.329153 --> 1.324667).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 14 cost time: 1.6307663917541504
Epoch: 14, Steps: 52 | Train Loss: 0.4284279 Vali Loss: 1.3251703 Test Loss: 0.3403540
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 15 cost time: 1.6358702182769775
Epoch: 15, Steps: 52 | Train Loss: 0.4281696 Vali Loss: 1.3256571 Test Loss: 0.3392454
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 16 cost time: 1.6297607421875
Epoch: 16, Steps: 52 | Train Loss: 0.4246748 Vali Loss: 1.3173193 Test Loss: 0.3383513
Validation loss decreased (1.324667 --> 1.317319).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 17 cost time: 1.632584810256958
Epoch: 17, Steps: 52 | Train Loss: 0.4255221 Vali Loss: 1.3059455 Test Loss: 0.3378393
Validation loss decreased (1.317319 --> 1.305946).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 18 cost time: 1.6304543018341064
Epoch: 18, Steps: 52 | Train Loss: 0.4259142 Vali Loss: 1.3172244 Test Loss: 0.3374907
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 19 cost time: 1.6373751163482666
Epoch: 19, Steps: 52 | Train Loss: 0.4239128 Vali Loss: 1.3124902 Test Loss: 0.3360138
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 20 cost time: 1.6323378086090088
Epoch: 20, Steps: 52 | Train Loss: 0.4223669 Vali Loss: 1.3160334 Test Loss: 0.3368190
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 21 cost time: 1.6337943077087402
Epoch: 21, Steps: 52 | Train Loss: 0.4226779 Vali Loss: 1.3065093 Test Loss: 0.3360995
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 22 cost time: 1.6339008808135986
Epoch: 22, Steps: 52 | Train Loss: 0.4197397 Vali Loss: 1.3079305 Test Loss: 0.3355095
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 23 cost time: 1.6343493461608887
Epoch: 23, Steps: 52 | Train Loss: 0.4213652 Vali Loss: 1.3098586 Test Loss: 0.3353463
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 24 cost time: 1.6324384212493896
Epoch: 24, Steps: 52 | Train Loss: 0.4200633 Vali Loss: 1.3136318 Test Loss: 0.3348628
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 25 cost time: 1.6350317001342773
Epoch: 25, Steps: 52 | Train Loss: 0.4210773 Vali Loss: 1.3026750 Test Loss: 0.3351198
Validation loss decreased (1.305946 --> 1.302675).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 26 cost time: 1.6355111598968506
Epoch: 26, Steps: 52 | Train Loss: 0.4195380 Vali Loss: 1.3098621 Test Loss: 0.3343584
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 27 cost time: 1.6350781917572021
Epoch: 27, Steps: 52 | Train Loss: 0.4188892 Vali Loss: 1.3074299 Test Loss: 0.3348781
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 28 cost time: 1.6331987380981445
Epoch: 28, Steps: 52 | Train Loss: 0.4161262 Vali Loss: 1.2992349 Test Loss: 0.3346478
Validation loss decreased (1.302675 --> 1.299235).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 29 cost time: 1.6364614963531494
Epoch: 29, Steps: 52 | Train Loss: 0.4182609 Vali Loss: 1.3017492 Test Loss: 0.3340120
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 30 cost time: 1.6336939334869385
Epoch: 30, Steps: 52 | Train Loss: 0.4190752 Vali Loss: 1.3107560 Test Loss: 0.3336024
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 31 cost time: 1.6317362785339355
Epoch: 31, Steps: 52 | Train Loss: 0.4184093 Vali Loss: 1.3105539 Test Loss: 0.3334597
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 32 cost time: 1.632319450378418
Epoch: 32, Steps: 52 | Train Loss: 0.4178554 Vali Loss: 1.3031292 Test Loss: 0.3336697
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 33 cost time: 1.627971887588501
Epoch: 33, Steps: 52 | Train Loss: 0.4175503 Vali Loss: 1.3052909 Test Loss: 0.3339432
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 34 cost time: 1.6270639896392822
Epoch: 34, Steps: 52 | Train Loss: 0.4175024 Vali Loss: 1.3096839 Test Loss: 0.3341142
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 35 cost time: 1.6334314346313477
Epoch: 35, Steps: 52 | Train Loss: 0.4168029 Vali Loss: 1.3080127 Test Loss: 0.3331518
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 36 cost time: 1.6326804161071777
Epoch: 36, Steps: 52 | Train Loss: 0.4160634 Vali Loss: 1.3073392 Test Loss: 0.3344917
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 37 cost time: 1.6367931365966797
Epoch: 37, Steps: 52 | Train Loss: 0.4162995 Vali Loss: 1.3056762 Test Loss: 0.3327269
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 38 cost time: 1.630981683731079
Epoch: 38, Steps: 52 | Train Loss: 0.4160816 Vali Loss: 1.3024635 Test Loss: 0.3329344
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 39 cost time: 1.6351079940795898
Epoch: 39, Steps: 52 | Train Loss: 0.4172323 Vali Loss: 1.2945354 Test Loss: 0.3336627
Validation loss decreased (1.299235 --> 1.294535).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 40 cost time: 1.6354529857635498
Epoch: 40, Steps: 52 | Train Loss: 0.4178676 Vali Loss: 1.3066810 Test Loss: 0.3334997
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 41 cost time: 1.6361093521118164
Epoch: 41, Steps: 52 | Train Loss: 0.4165686 Vali Loss: 1.3073303 Test Loss: 0.3331853
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 42 cost time: 1.6300058364868164
Epoch: 42, Steps: 52 | Train Loss: 0.4165214 Vali Loss: 1.3073366 Test Loss: 0.3351344
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 43 cost time: 1.6388380527496338
Epoch: 43, Steps: 52 | Train Loss: 0.4174727 Vali Loss: 1.3024230 Test Loss: 0.3340024
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 44 cost time: 1.6289052963256836
Epoch: 44, Steps: 52 | Train Loss: 0.4171509 Vali Loss: 1.3092541 Test Loss: 0.3336761
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 45 cost time: 1.636378526687622
Epoch: 45, Steps: 52 | Train Loss: 0.4153111 Vali Loss: 1.3013282 Test Loss: 0.3334369
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 46 cost time: 1.6302921772003174
Epoch: 46, Steps: 52 | Train Loss: 0.4157044 Vali Loss: 1.3041362 Test Loss: 0.3336353
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 47 cost time: 1.6335113048553467
Epoch: 47, Steps: 52 | Train Loss: 0.4159702 Vali Loss: 1.3030503 Test Loss: 0.3341301
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 48 cost time: 1.6295111179351807
Epoch: 48, Steps: 52 | Train Loss: 0.4167311 Vali Loss: 1.2932247 Test Loss: 0.3332529
Validation loss decreased (1.294535 --> 1.293225).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 49 cost time: 1.6360149383544922
Epoch: 49, Steps: 52 | Train Loss: 0.4163617 Vali Loss: 1.3058233 Test Loss: 0.3335046
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 50 cost time: 1.6298551559448242
Epoch: 50, Steps: 52 | Train Loss: 0.4153141 Vali Loss: 1.3115437 Test Loss: 0.3338401
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 51 cost time: 1.635549545288086
Epoch: 51, Steps: 52 | Train Loss: 0.4168909 Vali Loss: 1.3018987 Test Loss: 0.3328056
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 52 cost time: 1.6324820518493652
Epoch: 52, Steps: 52 | Train Loss: 0.4173316 Vali Loss: 1.3033870 Test Loss: 0.3334665
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 53 cost time: 1.6361143589019775
Epoch: 53, Steps: 52 | Train Loss: 0.4154910 Vali Loss: 1.3043526 Test Loss: 0.3332381
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 54 cost time: 1.6348626613616943
Epoch: 54, Steps: 52 | Train Loss: 0.4157059 Vali Loss: 1.3092077 Test Loss: 0.3329178
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 55 cost time: 1.6357738971710205
Epoch: 55, Steps: 52 | Train Loss: 0.4163545 Vali Loss: 1.3070022 Test Loss: 0.3335050
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 56 cost time: 1.6351113319396973
Epoch: 56, Steps: 52 | Train Loss: 0.4166787 Vali Loss: 1.2931733 Test Loss: 0.3331763
Validation loss decreased (1.293225 --> 1.293173).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 57 cost time: 1.6372051239013672
Epoch: 57, Steps: 52 | Train Loss: 0.4167077 Vali Loss: 1.3047025 Test Loss: 0.3336194
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 58 cost time: 1.6329951286315918
Epoch: 58, Steps: 52 | Train Loss: 0.4154315 Vali Loss: 1.3036535 Test Loss: 0.3333744
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 59 cost time: 1.6397738456726074
Epoch: 59, Steps: 52 | Train Loss: 0.4165260 Vali Loss: 1.3095429 Test Loss: 0.3332805
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 60 cost time: 1.6331117153167725
Epoch: 60, Steps: 52 | Train Loss: 0.4152526 Vali Loss: 1.3074441 Test Loss: 0.3337743
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33317628502845764, mae:0.3804086744785309, rse:0.4728744328022003
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.05865907669067383 GB
Epoch: 1 cost time: 2.134000062942505
Epoch: 1, Steps: 52 | Train Loss: 0.7855352 Vali Loss: 2.2455759 Test Loss: 1.5364255
Validation loss decreased (inf --> 2.245576).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 2 cost time: 0.7456467151641846
Epoch: 2, Steps: 52 | Train Loss: 0.6396366 Vali Loss: 1.6455632 Test Loss: 0.7523781
Validation loss decreased (2.245576 --> 1.645563).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 3 cost time: 0.7674040794372559
Epoch: 3, Steps: 52 | Train Loss: 0.5061452 Vali Loss: 1.4518225 Test Loss: 0.4749977
Validation loss decreased (1.645563 --> 1.451823).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 4 cost time: 0.7730371952056885
Epoch: 4, Steps: 52 | Train Loss: 0.4573765 Vali Loss: 1.3971536 Test Loss: 0.4073787
Validation loss decreased (1.451823 --> 1.397154).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 5 cost time: 0.7670018672943115
Epoch: 5, Steps: 52 | Train Loss: 0.4422331 Vali Loss: 1.3624151 Test Loss: 0.3854314
Validation loss decreased (1.397154 --> 1.362415).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 6 cost time: 1.6946332454681396
Epoch: 6, Steps: 52 | Train Loss: 0.4344200 Vali Loss: 1.3580333 Test Loss: 0.3723496
Validation loss decreased (1.362415 --> 1.358033).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 7 cost time: 1.6968896389007568
Epoch: 7, Steps: 52 | Train Loss: 0.4289047 Vali Loss: 1.3528613 Test Loss: 0.3631216
Validation loss decreased (1.358033 --> 1.352861).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 8 cost time: 1.7021141052246094
Epoch: 8, Steps: 52 | Train Loss: 0.4244833 Vali Loss: 1.3391826 Test Loss: 0.3571131
Validation loss decreased (1.352861 --> 1.339183).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 9 cost time: 1.7008655071258545
Epoch: 9, Steps: 52 | Train Loss: 0.4214528 Vali Loss: 1.3284611 Test Loss: 0.3532335
Validation loss decreased (1.339183 --> 1.328461).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 10 cost time: 1.6987125873565674
Epoch: 10, Steps: 52 | Train Loss: 0.4212142 Vali Loss: 1.3284398 Test Loss: 0.3500659
Validation loss decreased (1.328461 --> 1.328440).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 11 cost time: 1.7009270191192627
Epoch: 11, Steps: 52 | Train Loss: 0.4178653 Vali Loss: 1.3201132 Test Loss: 0.3470349
Validation loss decreased (1.328440 --> 1.320113).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 12 cost time: 1.6987993717193604
Epoch: 12, Steps: 52 | Train Loss: 0.4161311 Vali Loss: 1.3285314 Test Loss: 0.3458818
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 13 cost time: 1.7022984027862549
Epoch: 13, Steps: 52 | Train Loss: 0.4147495 Vali Loss: 1.3226401 Test Loss: 0.3434003
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 14 cost time: 1.7007107734680176
Epoch: 14, Steps: 52 | Train Loss: 0.4131798 Vali Loss: 1.3227339 Test Loss: 0.3429547
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 15 cost time: 1.7033360004425049
Epoch: 15, Steps: 52 | Train Loss: 0.4136857 Vali Loss: 1.3236442 Test Loss: 0.3418874
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 16 cost time: 1.7019968032836914
Epoch: 16, Steps: 52 | Train Loss: 0.4120717 Vali Loss: 1.3229636 Test Loss: 0.3414191
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 17 cost time: 1.6998097896575928
Epoch: 17, Steps: 52 | Train Loss: 0.4139099 Vali Loss: 1.3130859 Test Loss: 0.3393936
Validation loss decreased (1.320113 --> 1.313086).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 18 cost time: 1.704383134841919
Epoch: 18, Steps: 52 | Train Loss: 0.4110148 Vali Loss: 1.3107500 Test Loss: 0.3390087
Validation loss decreased (1.313086 --> 1.310750).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 19 cost time: 1.7176074981689453
Epoch: 19, Steps: 52 | Train Loss: 0.4093574 Vali Loss: 1.3196306 Test Loss: 0.3379448
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 20 cost time: 1.699629783630371
Epoch: 20, Steps: 52 | Train Loss: 0.4084247 Vali Loss: 1.3161846 Test Loss: 0.3366807
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 21 cost time: 1.702319622039795
Epoch: 21, Steps: 52 | Train Loss: 0.4075701 Vali Loss: 1.3116229 Test Loss: 0.3362610
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 22 cost time: 1.6934585571289062
Epoch: 22, Steps: 52 | Train Loss: 0.4083009 Vali Loss: 1.3136098 Test Loss: 0.3365756
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 23 cost time: 1.702786922454834
Epoch: 23, Steps: 52 | Train Loss: 0.4087874 Vali Loss: 1.3064238 Test Loss: 0.3354234
Validation loss decreased (1.310750 --> 1.306424).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 24 cost time: 1.7009227275848389
Epoch: 24, Steps: 52 | Train Loss: 0.4072394 Vali Loss: 1.2961805 Test Loss: 0.3359849
Validation loss decreased (1.306424 --> 1.296180).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 25 cost time: 1.7048132419586182
Epoch: 25, Steps: 52 | Train Loss: 0.4079248 Vali Loss: 1.3128245 Test Loss: 0.3355314
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 26 cost time: 1.6998686790466309
Epoch: 26, Steps: 52 | Train Loss: 0.4058250 Vali Loss: 1.3110850 Test Loss: 0.3354019
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 27 cost time: 1.7014236450195312
Epoch: 27, Steps: 52 | Train Loss: 0.4070382 Vali Loss: 1.3021405 Test Loss: 0.3349755
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 28 cost time: 1.7068123817443848
Epoch: 28, Steps: 52 | Train Loss: 0.4067584 Vali Loss: 1.3037312 Test Loss: 0.3355528
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 29 cost time: 1.7016246318817139
Epoch: 29, Steps: 52 | Train Loss: 0.4053667 Vali Loss: 1.3042247 Test Loss: 0.3348116
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 30 cost time: 1.7023351192474365
Epoch: 30, Steps: 52 | Train Loss: 0.4063755 Vali Loss: 1.3018686 Test Loss: 0.3338608
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 31 cost time: 1.7073290348052979
Epoch: 31, Steps: 52 | Train Loss: 0.4063823 Vali Loss: 1.2989433 Test Loss: 0.3338113
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 32 cost time: 1.7032296657562256
Epoch: 32, Steps: 52 | Train Loss: 0.4062777 Vali Loss: 1.3026900 Test Loss: 0.3347573
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 33 cost time: 1.6997895240783691
Epoch: 33, Steps: 52 | Train Loss: 0.4060539 Vali Loss: 1.3081181 Test Loss: 0.3338904
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 34 cost time: 1.699615716934204
Epoch: 34, Steps: 52 | Train Loss: 0.4061277 Vali Loss: 1.3000715 Test Loss: 0.3349554
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 35 cost time: 1.7009403705596924
Epoch: 35, Steps: 52 | Train Loss: 0.4052119 Vali Loss: 1.3056643 Test Loss: 0.3335300
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 36 cost time: 1.698728084564209
Epoch: 36, Steps: 52 | Train Loss: 0.4059541 Vali Loss: 1.3042665 Test Loss: 0.3334067
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 37 cost time: 1.6989293098449707
Epoch: 37, Steps: 52 | Train Loss: 0.4061805 Vali Loss: 1.3104907 Test Loss: 0.3335021
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 38 cost time: 1.7066717147827148
Epoch: 38, Steps: 52 | Train Loss: 0.4051933 Vali Loss: 1.3023376 Test Loss: 0.3342657
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 39 cost time: 1.7022128105163574
Epoch: 39, Steps: 52 | Train Loss: 0.4057288 Vali Loss: 1.3049195 Test Loss: 0.3340394
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 40 cost time: 1.7018170356750488
Epoch: 40, Steps: 52 | Train Loss: 0.4040795 Vali Loss: 1.3002146 Test Loss: 0.3331870
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 41 cost time: 1.700143575668335
Epoch: 41, Steps: 52 | Train Loss: 0.4056098 Vali Loss: 1.3094488 Test Loss: 0.3338886
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 42 cost time: 1.7036607265472412
Epoch: 42, Steps: 52 | Train Loss: 0.4059067 Vali Loss: 1.3104434 Test Loss: 0.3329927
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 43 cost time: 1.6985726356506348
Epoch: 43, Steps: 52 | Train Loss: 0.4054283 Vali Loss: 1.3055623 Test Loss: 0.3323239
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 44 cost time: 1.7014613151550293
Epoch: 44, Steps: 52 | Train Loss: 0.4039124 Vali Loss: 1.3050427 Test Loss: 0.3338485
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 45 cost time: 1.7021653652191162
Epoch: 45, Steps: 52 | Train Loss: 0.4044534 Vali Loss: 1.3069675 Test Loss: 0.3343441
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 46 cost time: 1.7050426006317139
Epoch: 46, Steps: 52 | Train Loss: 0.4039461 Vali Loss: 1.3089353 Test Loss: 0.3338342
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 47 cost time: 1.7045483589172363
Epoch: 47, Steps: 52 | Train Loss: 0.4064857 Vali Loss: 1.3003179 Test Loss: 0.3332566
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 48 cost time: 1.7011544704437256
Epoch: 48, Steps: 52 | Train Loss: 0.4053513 Vali Loss: 1.3010154 Test Loss: 0.3329678
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 49 cost time: 1.6979470252990723
Epoch: 49, Steps: 52 | Train Loss: 0.4063696 Vali Loss: 1.3074291 Test Loss: 0.3327650
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 50 cost time: 1.7021141052246094
Epoch: 50, Steps: 52 | Train Loss: 0.4042810 Vali Loss: 1.2963399 Test Loss: 0.3335022
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 51 cost time: 1.6975784301757812
Epoch: 51, Steps: 52 | Train Loss: 0.4055686 Vali Loss: 1.3046391 Test Loss: 0.3332684
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 52 cost time: 1.703789234161377
Epoch: 52, Steps: 52 | Train Loss: 0.4055391 Vali Loss: 1.3020515 Test Loss: 0.3335653
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 53 cost time: 1.6986215114593506
Epoch: 53, Steps: 52 | Train Loss: 0.4049498 Vali Loss: 1.3049246 Test Loss: 0.3336485
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 54 cost time: 1.7018990516662598
Epoch: 54, Steps: 52 | Train Loss: 0.4048661 Vali Loss: 1.3011658 Test Loss: 0.3324442
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 55 cost time: 1.697871446609497
Epoch: 55, Steps: 52 | Train Loss: 0.4040579 Vali Loss: 1.3029501 Test Loss: 0.3326705
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 56 cost time: 1.7069463729858398
Epoch: 56, Steps: 52 | Train Loss: 0.4042479 Vali Loss: 1.3086203 Test Loss: 0.3324380
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 57 cost time: 1.699401617050171
Epoch: 57, Steps: 52 | Train Loss: 0.4059734 Vali Loss: 1.3098024 Test Loss: 0.3341959
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 58 cost time: 1.7023248672485352
Epoch: 58, Steps: 52 | Train Loss: 0.4061886 Vali Loss: 1.3085904 Test Loss: 0.3316637
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 59 cost time: 1.701112985610962
Epoch: 59, Steps: 52 | Train Loss: 0.4043039 Vali Loss: 1.3020236 Test Loss: 0.3333461
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 60 cost time: 1.702986240386963
Epoch: 60, Steps: 52 | Train Loss: 0.4040294 Vali Loss: 1.3070877 Test Loss: 0.3324853
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3359849154949188, mae:0.38282644748687744, rse:0.4748633801937103
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.05977916717529297 GB
Epoch: 1 cost time: 2.2061636447906494
Epoch: 1, Steps: 52 | Train Loss: 0.7022155 Vali Loss: 2.1560676 Test Loss: 1.3773123
Validation loss decreased (inf --> 2.156068).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 2 cost time: 0.7990789413452148
Epoch: 2, Steps: 52 | Train Loss: 0.6010243 Vali Loss: 1.6142039 Test Loss: 0.6929792
Validation loss decreased (2.156068 --> 1.614204).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 3 cost time: 0.7906134128570557
Epoch: 3, Steps: 52 | Train Loss: 0.4741555 Vali Loss: 1.4190612 Test Loss: 0.4220393
Validation loss decreased (1.614204 --> 1.419061).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 4 cost time: 0.7893023490905762
Epoch: 4, Steps: 52 | Train Loss: 0.4366543 Vali Loss: 1.3810217 Test Loss: 0.3840533
Validation loss decreased (1.419061 --> 1.381022).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 5 cost time: 0.938483715057373
Epoch: 5, Steps: 52 | Train Loss: 0.4245918 Vali Loss: 1.3592569 Test Loss: 0.3668270
Validation loss decreased (1.381022 --> 1.359257).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 6 cost time: 1.743791103363037
Epoch: 6, Steps: 52 | Train Loss: 0.4199226 Vali Loss: 1.3445815 Test Loss: 0.3580014
Validation loss decreased (1.359257 --> 1.344581).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 7 cost time: 1.7434139251708984
Epoch: 7, Steps: 52 | Train Loss: 0.4160114 Vali Loss: 1.3312358 Test Loss: 0.3540941
Validation loss decreased (1.344581 --> 1.331236).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 8 cost time: 1.7384135723114014
Epoch: 8, Steps: 52 | Train Loss: 0.4148618 Vali Loss: 1.3241448 Test Loss: 0.3504575
Validation loss decreased (1.331236 --> 1.324145).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 9 cost time: 1.7382726669311523
Epoch: 9, Steps: 52 | Train Loss: 0.4120246 Vali Loss: 1.3317734 Test Loss: 0.3472649
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 10 cost time: 1.7374212741851807
Epoch: 10, Steps: 52 | Train Loss: 0.4090125 Vali Loss: 1.3245933 Test Loss: 0.3451159
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 11 cost time: 1.746849536895752
Epoch: 11, Steps: 52 | Train Loss: 0.4111239 Vali Loss: 1.3112488 Test Loss: 0.3447213
Validation loss decreased (1.324145 --> 1.311249).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 12 cost time: 1.7441246509552002
Epoch: 12, Steps: 52 | Train Loss: 0.4061196 Vali Loss: 1.3178329 Test Loss: 0.3422714
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 13 cost time: 1.746497631072998
Epoch: 13, Steps: 52 | Train Loss: 0.4044238 Vali Loss: 1.3196187 Test Loss: 0.3421005
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 14 cost time: 1.7446985244750977
Epoch: 14, Steps: 52 | Train Loss: 0.4054007 Vali Loss: 1.3133578 Test Loss: 0.3420417
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 15 cost time: 1.7467947006225586
Epoch: 15, Steps: 52 | Train Loss: 0.4053654 Vali Loss: 1.3108981 Test Loss: 0.3397867
Validation loss decreased (1.311249 --> 1.310898).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 16 cost time: 1.7454228401184082
Epoch: 16, Steps: 52 | Train Loss: 0.4042100 Vali Loss: 1.3041167 Test Loss: 0.3386496
Validation loss decreased (1.310898 --> 1.304117).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 17 cost time: 1.7440197467803955
Epoch: 17, Steps: 52 | Train Loss: 0.4039777 Vali Loss: 1.3051856 Test Loss: 0.3390809
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 18 cost time: 1.7418265342712402
Epoch: 18, Steps: 52 | Train Loss: 0.4040790 Vali Loss: 1.3058708 Test Loss: 0.3374833
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 19 cost time: 1.751086950302124
Epoch: 19, Steps: 52 | Train Loss: 0.4022744 Vali Loss: 1.3031456 Test Loss: 0.3379063
Validation loss decreased (1.304117 --> 1.303146).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 20 cost time: 1.7461018562316895
Epoch: 20, Steps: 52 | Train Loss: 0.4026403 Vali Loss: 1.2996719 Test Loss: 0.3375659
Validation loss decreased (1.303146 --> 1.299672).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 21 cost time: 1.7490320205688477
Epoch: 21, Steps: 52 | Train Loss: 0.4024718 Vali Loss: 1.3027720 Test Loss: 0.3370277
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 22 cost time: 1.7445459365844727
Epoch: 22, Steps: 52 | Train Loss: 0.4035889 Vali Loss: 1.3052868 Test Loss: 0.3370679
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 23 cost time: 1.7453718185424805
Epoch: 23, Steps: 52 | Train Loss: 0.4032444 Vali Loss: 1.2972052 Test Loss: 0.3373398
Validation loss decreased (1.299672 --> 1.297205).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 24 cost time: 1.744880199432373
Epoch: 24, Steps: 52 | Train Loss: 0.4010602 Vali Loss: 1.3049908 Test Loss: 0.3362270
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 25 cost time: 1.747507095336914
Epoch: 25, Steps: 52 | Train Loss: 0.4011578 Vali Loss: 1.3015633 Test Loss: 0.3356433
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 26 cost time: 1.7452795505523682
Epoch: 26, Steps: 52 | Train Loss: 0.4010377 Vali Loss: 1.2999418 Test Loss: 0.3341002
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 27 cost time: 1.7468008995056152
Epoch: 27, Steps: 52 | Train Loss: 0.3993293 Vali Loss: 1.2977711 Test Loss: 0.3376243
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 28 cost time: 1.7451128959655762
Epoch: 28, Steps: 52 | Train Loss: 0.3993780 Vali Loss: 1.2999864 Test Loss: 0.3375582
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 29 cost time: 1.7449426651000977
Epoch: 29, Steps: 52 | Train Loss: 0.4007288 Vali Loss: 1.2953954 Test Loss: 0.3360551
Validation loss decreased (1.297205 --> 1.295395).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 30 cost time: 1.751582145690918
Epoch: 30, Steps: 52 | Train Loss: 0.4012125 Vali Loss: 1.2988124 Test Loss: 0.3359638
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 31 cost time: 1.743711233139038
Epoch: 31, Steps: 52 | Train Loss: 0.3994409 Vali Loss: 1.2926981 Test Loss: 0.3354734
Validation loss decreased (1.295395 --> 1.292698).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 32 cost time: 1.7503817081451416
Epoch: 32, Steps: 52 | Train Loss: 0.4009459 Vali Loss: 1.3006164 Test Loss: 0.3344825
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 33 cost time: 1.744725227355957
Epoch: 33, Steps: 52 | Train Loss: 0.3999586 Vali Loss: 1.2884078 Test Loss: 0.3356519
Validation loss decreased (1.292698 --> 1.288408).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 34 cost time: 1.747532606124878
Epoch: 34, Steps: 52 | Train Loss: 0.4009099 Vali Loss: 1.2939558 Test Loss: 0.3371863
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 35 cost time: 1.7470531463623047
Epoch: 35, Steps: 52 | Train Loss: 0.3988382 Vali Loss: 1.3010757 Test Loss: 0.3358388
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 36 cost time: 1.7485241889953613
Epoch: 36, Steps: 52 | Train Loss: 0.4008223 Vali Loss: 1.2965348 Test Loss: 0.3360567
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 37 cost time: 1.7460529804229736
Epoch: 37, Steps: 52 | Train Loss: 0.3995441 Vali Loss: 1.2969745 Test Loss: 0.3345734
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 38 cost time: 1.7531883716583252
Epoch: 38, Steps: 52 | Train Loss: 0.3999476 Vali Loss: 1.2993779 Test Loss: 0.3370933
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 39 cost time: 1.7436258792877197
Epoch: 39, Steps: 52 | Train Loss: 0.3985549 Vali Loss: 1.2998836 Test Loss: 0.3345246
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 40 cost time: 1.7441563606262207
Epoch: 40, Steps: 52 | Train Loss: 0.3985094 Vali Loss: 1.2978520 Test Loss: 0.3345542
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 41 cost time: 1.7413647174835205
Epoch: 41, Steps: 52 | Train Loss: 0.3981189 Vali Loss: 1.2948589 Test Loss: 0.3358135
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 42 cost time: 1.739089012145996
Epoch: 42, Steps: 52 | Train Loss: 0.3977680 Vali Loss: 1.2926981 Test Loss: 0.3360443
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 43 cost time: 1.747891902923584
Epoch: 43, Steps: 52 | Train Loss: 0.3997751 Vali Loss: 1.3031435 Test Loss: 0.3362953
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 44 cost time: 1.7396471500396729
Epoch: 44, Steps: 52 | Train Loss: 0.3989350 Vali Loss: 1.3000381 Test Loss: 0.3347384
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 45 cost time: 1.7434475421905518
Epoch: 45, Steps: 52 | Train Loss: 0.3986571 Vali Loss: 1.2884564 Test Loss: 0.3341628
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 46 cost time: 1.745915412902832
Epoch: 46, Steps: 52 | Train Loss: 0.3993015 Vali Loss: 1.2983038 Test Loss: 0.3360804
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 47 cost time: 1.7517762184143066
Epoch: 47, Steps: 52 | Train Loss: 0.4011228 Vali Loss: 1.2967647 Test Loss: 0.3349804
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 48 cost time: 1.7438921928405762
Epoch: 48, Steps: 52 | Train Loss: 0.3984378 Vali Loss: 1.3039283 Test Loss: 0.3356908
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 49 cost time: 1.7475569248199463
Epoch: 49, Steps: 52 | Train Loss: 0.3984155 Vali Loss: 1.2918878 Test Loss: 0.3348184
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 50 cost time: 1.7464160919189453
Epoch: 50, Steps: 52 | Train Loss: 0.3989897 Vali Loss: 1.2979354 Test Loss: 0.3351151
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 51 cost time: 1.7446472644805908
Epoch: 51, Steps: 52 | Train Loss: 0.3979927 Vali Loss: 1.2960719 Test Loss: 0.3345997
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 52 cost time: 1.7379937171936035
Epoch: 52, Steps: 52 | Train Loss: 0.3987416 Vali Loss: 1.2964199 Test Loss: 0.3351786
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 53 cost time: 1.7483322620391846
Epoch: 53, Steps: 52 | Train Loss: 0.4001151 Vali Loss: 1.2993351 Test Loss: 0.3354521
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 54 cost time: 1.745042324066162
Epoch: 54, Steps: 52 | Train Loss: 0.3994466 Vali Loss: 1.3004118 Test Loss: 0.3360674
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 55 cost time: 1.745347499847412
Epoch: 55, Steps: 52 | Train Loss: 0.3994633 Vali Loss: 1.2954410 Test Loss: 0.3364195
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 56 cost time: 1.7407948970794678
Epoch: 56, Steps: 52 | Train Loss: 0.3984936 Vali Loss: 1.2898717 Test Loss: 0.3349401
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 57 cost time: 1.7423019409179688
Epoch: 57, Steps: 52 | Train Loss: 0.3998515 Vali Loss: 1.2943336 Test Loss: 0.3350637
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 58 cost time: 1.7419204711914062
Epoch: 58, Steps: 52 | Train Loss: 0.3982247 Vali Loss: 1.2961228 Test Loss: 0.3342130
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 59 cost time: 1.7403664588928223
Epoch: 59, Steps: 52 | Train Loss: 0.3986685 Vali Loss: 1.3007283 Test Loss: 0.3348398
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 60 cost time: 1.739999532699585
Epoch: 60, Steps: 52 | Train Loss: 0.3996021 Vali Loss: 1.3006773 Test Loss: 0.3355123
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3356519639492035, mae:0.38531431555747986, rse:0.4746280312538147
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.057389259338378906 GB
Epoch: 1 cost time: 2.1244759559631348
Epoch: 1, Steps: 52 | Train Loss: 0.9763825 Vali Loss: 2.6115918 Test Loss: 1.7321007
Validation loss decreased (inf --> 2.611592).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 2 cost time: 0.7533974647521973
Epoch: 2, Steps: 52 | Train Loss: 0.7644799 Vali Loss: 1.6909078 Test Loss: 0.7359865
Validation loss decreased (2.611592 --> 1.690908).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 3 cost time: 0.7524466514587402
Epoch: 3, Steps: 52 | Train Loss: 0.5759277 Vali Loss: 1.4752884 Test Loss: 0.4955008
Validation loss decreased (1.690908 --> 1.475288).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 4 cost time: 0.7550880908966064
Epoch: 4, Steps: 52 | Train Loss: 0.5201411 Vali Loss: 1.4169998 Test Loss: 0.4296160
Validation loss decreased (1.475288 --> 1.417000).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 5 cost time: 0.7268340587615967
Epoch: 5, Steps: 52 | Train Loss: 0.4925213 Vali Loss: 1.3879907 Test Loss: 0.4062142
Validation loss decreased (1.417000 --> 1.387991).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 6 cost time: 1.6091954708099365
Epoch: 6, Steps: 52 | Train Loss: 0.4779572 Vali Loss: 1.3810433 Test Loss: 0.3908305
Validation loss decreased (1.387991 --> 1.381043).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 7 cost time: 1.6763153076171875
Epoch: 7, Steps: 52 | Train Loss: 0.4658379 Vali Loss: 1.3670133 Test Loss: 0.3786854
Validation loss decreased (1.381043 --> 1.367013).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 8 cost time: 1.6704342365264893
Epoch: 8, Steps: 52 | Train Loss: 0.4625458 Vali Loss: 1.3591676 Test Loss: 0.3710051
Validation loss decreased (1.367013 --> 1.359168).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 9 cost time: 1.6783485412597656
Epoch: 9, Steps: 52 | Train Loss: 0.4559213 Vali Loss: 1.3476641 Test Loss: 0.3653259
Validation loss decreased (1.359168 --> 1.347664).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 10 cost time: 1.6686162948608398
Epoch: 10, Steps: 52 | Train Loss: 0.4498527 Vali Loss: 1.3424697 Test Loss: 0.3608997
Validation loss decreased (1.347664 --> 1.342470).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 11 cost time: 1.671280860900879
Epoch: 11, Steps: 52 | Train Loss: 0.4475448 Vali Loss: 1.3441784 Test Loss: 0.3555241
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 12 cost time: 1.6698343753814697
Epoch: 12, Steps: 52 | Train Loss: 0.4430128 Vali Loss: 1.3446635 Test Loss: 0.3522402
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 13 cost time: 1.6738200187683105
Epoch: 13, Steps: 52 | Train Loss: 0.4411282 Vali Loss: 1.3369085 Test Loss: 0.3499030
Validation loss decreased (1.342470 --> 1.336908).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 14 cost time: 1.669325590133667
Epoch: 14, Steps: 52 | Train Loss: 0.4388685 Vali Loss: 1.3346397 Test Loss: 0.3474948
Validation loss decreased (1.336908 --> 1.334640).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 15 cost time: 1.667027473449707
Epoch: 15, Steps: 52 | Train Loss: 0.4369970 Vali Loss: 1.3340614 Test Loss: 0.3453571
Validation loss decreased (1.334640 --> 1.334061).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 16 cost time: 1.6736564636230469
Epoch: 16, Steps: 52 | Train Loss: 0.4345681 Vali Loss: 1.3330734 Test Loss: 0.3437947
Validation loss decreased (1.334061 --> 1.333073).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 17 cost time: 1.6695587635040283
Epoch: 17, Steps: 52 | Train Loss: 0.4345843 Vali Loss: 1.3283416 Test Loss: 0.3423048
Validation loss decreased (1.333073 --> 1.328342).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 18 cost time: 1.6726865768432617
Epoch: 18, Steps: 52 | Train Loss: 0.4321923 Vali Loss: 1.3296009 Test Loss: 0.3410011
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 19 cost time: 1.67203688621521
Epoch: 19, Steps: 52 | Train Loss: 0.4298545 Vali Loss: 1.3116381 Test Loss: 0.3397148
Validation loss decreased (1.328342 --> 1.311638).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 20 cost time: 1.6727018356323242
Epoch: 20, Steps: 52 | Train Loss: 0.4303197 Vali Loss: 1.3253162 Test Loss: 0.3387717
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 21 cost time: 1.667531967163086
Epoch: 21, Steps: 52 | Train Loss: 0.4293597 Vali Loss: 1.3256500 Test Loss: 0.3378407
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 22 cost time: 1.6732690334320068
Epoch: 22, Steps: 52 | Train Loss: 0.4309850 Vali Loss: 1.3194325 Test Loss: 0.3369468
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 23 cost time: 1.670011043548584
Epoch: 23, Steps: 52 | Train Loss: 0.4273221 Vali Loss: 1.3161842 Test Loss: 0.3357233
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 24 cost time: 1.6769943237304688
Epoch: 24, Steps: 52 | Train Loss: 0.4268116 Vali Loss: 1.3174180 Test Loss: 0.3352895
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 25 cost time: 1.6787757873535156
Epoch: 25, Steps: 52 | Train Loss: 0.4280041 Vali Loss: 1.3204758 Test Loss: 0.3351147
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 26 cost time: 1.673781394958496
Epoch: 26, Steps: 52 | Train Loss: 0.4280114 Vali Loss: 1.3087964 Test Loss: 0.3348436
Validation loss decreased (1.311638 --> 1.308796).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 27 cost time: 1.6700093746185303
Epoch: 27, Steps: 52 | Train Loss: 0.4268718 Vali Loss: 1.3086629 Test Loss: 0.3339657
Validation loss decreased (1.308796 --> 1.308663).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 28 cost time: 1.669872522354126
Epoch: 28, Steps: 52 | Train Loss: 0.4256891 Vali Loss: 1.3146861 Test Loss: 0.3340545
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 29 cost time: 1.6683940887451172
Epoch: 29, Steps: 52 | Train Loss: 0.4244500 Vali Loss: 1.3100944 Test Loss: 0.3328612
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 30 cost time: 1.674292802810669
Epoch: 30, Steps: 52 | Train Loss: 0.4245110 Vali Loss: 1.3195884 Test Loss: 0.3330023
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 31 cost time: 1.6710340976715088
Epoch: 31, Steps: 52 | Train Loss: 0.4245145 Vali Loss: 1.3087556 Test Loss: 0.3323003
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 32 cost time: 1.6818795204162598
Epoch: 32, Steps: 52 | Train Loss: 0.4252247 Vali Loss: 1.3052142 Test Loss: 0.3324568
Validation loss decreased (1.308663 --> 1.305214).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 33 cost time: 1.6665637493133545
Epoch: 33, Steps: 52 | Train Loss: 0.4232150 Vali Loss: 1.3092158 Test Loss: 0.3319601
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 34 cost time: 1.6751859188079834
Epoch: 34, Steps: 52 | Train Loss: 0.4258931 Vali Loss: 1.3101249 Test Loss: 0.3317110
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 35 cost time: 1.6700968742370605
Epoch: 35, Steps: 52 | Train Loss: 0.4249301 Vali Loss: 1.3119674 Test Loss: 0.3315448
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 36 cost time: 1.668675184249878
Epoch: 36, Steps: 52 | Train Loss: 0.4237889 Vali Loss: 1.3167262 Test Loss: 0.3316820
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 37 cost time: 1.6709589958190918
Epoch: 37, Steps: 52 | Train Loss: 0.4222316 Vali Loss: 1.3172208 Test Loss: 0.3316534
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 38 cost time: 1.6683323383331299
Epoch: 38, Steps: 52 | Train Loss: 0.4236232 Vali Loss: 1.3118418 Test Loss: 0.3313646
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 39 cost time: 1.6655831336975098
Epoch: 39, Steps: 52 | Train Loss: 0.4247233 Vali Loss: 1.3087102 Test Loss: 0.3306239
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 40 cost time: 1.6728227138519287
Epoch: 40, Steps: 52 | Train Loss: 0.4219672 Vali Loss: 1.3095317 Test Loss: 0.3312343
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 41 cost time: 1.6689248085021973
Epoch: 41, Steps: 52 | Train Loss: 0.4225267 Vali Loss: 1.3163564 Test Loss: 0.3313508
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 42 cost time: 1.6721570491790771
Epoch: 42, Steps: 52 | Train Loss: 0.4233493 Vali Loss: 1.3030477 Test Loss: 0.3309240
Validation loss decreased (1.305214 --> 1.303048).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 43 cost time: 1.669602632522583
Epoch: 43, Steps: 52 | Train Loss: 0.4232858 Vali Loss: 1.3154635 Test Loss: 0.3310837
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 44 cost time: 1.6723763942718506
Epoch: 44, Steps: 52 | Train Loss: 0.4240119 Vali Loss: 1.3008783 Test Loss: 0.3306356
Validation loss decreased (1.303048 --> 1.300878).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 45 cost time: 1.664278268814087
Epoch: 45, Steps: 52 | Train Loss: 0.4237637 Vali Loss: 1.3115572 Test Loss: 0.3303510
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 46 cost time: 1.6689622402191162
Epoch: 46, Steps: 52 | Train Loss: 0.4256913 Vali Loss: 1.3145006 Test Loss: 0.3306090
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 47 cost time: 1.6674776077270508
Epoch: 47, Steps: 52 | Train Loss: 0.4219710 Vali Loss: 1.3119365 Test Loss: 0.3305242
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 48 cost time: 1.66959547996521
Epoch: 48, Steps: 52 | Train Loss: 0.4226638 Vali Loss: 1.3135372 Test Loss: 0.3308055
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 49 cost time: 1.6644041538238525
Epoch: 49, Steps: 52 | Train Loss: 0.4226027 Vali Loss: 1.3078790 Test Loss: 0.3309627
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 50 cost time: 1.6671035289764404
Epoch: 50, Steps: 52 | Train Loss: 0.4214309 Vali Loss: 1.3072910 Test Loss: 0.3293616
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 51 cost time: 1.6699535846710205
Epoch: 51, Steps: 52 | Train Loss: 0.4244394 Vali Loss: 1.3126012 Test Loss: 0.3305797
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 52 cost time: 1.671898603439331
Epoch: 52, Steps: 52 | Train Loss: 0.4203791 Vali Loss: 1.3129184 Test Loss: 0.3302819
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 53 cost time: 1.6663506031036377
Epoch: 53, Steps: 52 | Train Loss: 0.4221572 Vali Loss: 1.3103210 Test Loss: 0.3305451
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 54 cost time: 1.6717443466186523
Epoch: 54, Steps: 52 | Train Loss: 0.4238619 Vali Loss: 1.3165072 Test Loss: 0.3306051
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 55 cost time: 1.6649796962738037
Epoch: 55, Steps: 52 | Train Loss: 0.4236856 Vali Loss: 1.3150749 Test Loss: 0.3303200
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 56 cost time: 1.6650373935699463
Epoch: 56, Steps: 52 | Train Loss: 0.4233296 Vali Loss: 1.3088455 Test Loss: 0.3301789
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 57 cost time: 1.6681544780731201
Epoch: 57, Steps: 52 | Train Loss: 0.4226746 Vali Loss: 1.3113827 Test Loss: 0.3302649
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 58 cost time: 1.668337106704712
Epoch: 58, Steps: 52 | Train Loss: 0.4231874 Vali Loss: 1.3106805 Test Loss: 0.3307945
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 59 cost time: 1.667565107345581
Epoch: 59, Steps: 52 | Train Loss: 0.4232080 Vali Loss: 1.3068359 Test Loss: 0.3296960
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 60 cost time: 1.6686768531799316
Epoch: 60, Steps: 52 | Train Loss: 0.4222624 Vali Loss: 1.3066542 Test Loss: 0.3290766
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3306356370449066, mae:0.37259888648986816, rse:0.47106802463531494
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.05882120132446289 GB
Epoch: 1 cost time: 2.1762516498565674
Epoch: 1, Steps: 52 | Train Loss: 0.7544030 Vali Loss: 2.2384462 Test Loss: 1.4424282
Validation loss decreased (inf --> 2.238446).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 2 cost time: 0.775353193283081
Epoch: 2, Steps: 52 | Train Loss: 0.6164269 Vali Loss: 1.5922710 Test Loss: 0.6652436
Validation loss decreased (2.238446 --> 1.592271).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 3 cost time: 0.7764134407043457
Epoch: 3, Steps: 52 | Train Loss: 0.4868156 Vali Loss: 1.4140728 Test Loss: 0.4243281
Validation loss decreased (1.592271 --> 1.414073).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 4 cost time: 0.7719337940216064
Epoch: 4, Steps: 52 | Train Loss: 0.4488644 Vali Loss: 1.3790138 Test Loss: 0.3910521
Validation loss decreased (1.414073 --> 1.379014).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 5 cost time: 0.7740001678466797
Epoch: 5, Steps: 52 | Train Loss: 0.4370365 Vali Loss: 1.3694258 Test Loss: 0.3758613
Validation loss decreased (1.379014 --> 1.369426).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 6 cost time: 1.6980953216552734
Epoch: 6, Steps: 52 | Train Loss: 0.4292969 Vali Loss: 1.3565528 Test Loss: 0.3647324
Validation loss decreased (1.369426 --> 1.356553).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 7 cost time: 1.703639030456543
Epoch: 7, Steps: 52 | Train Loss: 0.4251030 Vali Loss: 1.3487265 Test Loss: 0.3563225
Validation loss decreased (1.356553 --> 1.348727).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 8 cost time: 1.709421157836914
Epoch: 8, Steps: 52 | Train Loss: 0.4202354 Vali Loss: 1.3386176 Test Loss: 0.3511890
Validation loss decreased (1.348727 --> 1.338618).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 9 cost time: 1.7051689624786377
Epoch: 9, Steps: 52 | Train Loss: 0.4176666 Vali Loss: 1.3364272 Test Loss: 0.3465452
Validation loss decreased (1.338618 --> 1.336427).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 10 cost time: 1.706235647201538
Epoch: 10, Steps: 52 | Train Loss: 0.4160096 Vali Loss: 1.3207092 Test Loss: 0.3431607
Validation loss decreased (1.336427 --> 1.320709).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 11 cost time: 1.7036559581756592
Epoch: 11, Steps: 52 | Train Loss: 0.4148677 Vali Loss: 1.3244514 Test Loss: 0.3409696
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 12 cost time: 1.704770565032959
Epoch: 12, Steps: 52 | Train Loss: 0.4127090 Vali Loss: 1.3212643 Test Loss: 0.3392852
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 13 cost time: 1.7099640369415283
Epoch: 13, Steps: 52 | Train Loss: 0.4096642 Vali Loss: 1.3139855 Test Loss: 0.3377080
Validation loss decreased (1.320709 --> 1.313985).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 14 cost time: 1.6995041370391846
Epoch: 14, Steps: 52 | Train Loss: 0.4107725 Vali Loss: 1.3160331 Test Loss: 0.3353947
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 15 cost time: 1.7068595886230469
Epoch: 15, Steps: 52 | Train Loss: 0.4094854 Vali Loss: 1.3146155 Test Loss: 0.3352225
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 16 cost time: 1.7013425827026367
Epoch: 16, Steps: 52 | Train Loss: 0.4094868 Vali Loss: 1.3133049 Test Loss: 0.3348532
Validation loss decreased (1.313985 --> 1.313305).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 17 cost time: 1.710089921951294
Epoch: 17, Steps: 52 | Train Loss: 0.4083038 Vali Loss: 1.2984338 Test Loss: 0.3327437
Validation loss decreased (1.313305 --> 1.298434).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 18 cost time: 1.7070565223693848
Epoch: 18, Steps: 52 | Train Loss: 0.4065925 Vali Loss: 1.2976644 Test Loss: 0.3324044
Validation loss decreased (1.298434 --> 1.297664).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 19 cost time: 1.709792137145996
Epoch: 19, Steps: 52 | Train Loss: 0.4061810 Vali Loss: 1.3061566 Test Loss: 0.3318051
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 20 cost time: 1.7044720649719238
Epoch: 20, Steps: 52 | Train Loss: 0.4058902 Vali Loss: 1.3074321 Test Loss: 0.3327631
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 21 cost time: 1.7050037384033203
Epoch: 21, Steps: 52 | Train Loss: 0.4056323 Vali Loss: 1.2966962 Test Loss: 0.3320109
Validation loss decreased (1.297664 --> 1.296696).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 22 cost time: 1.7058568000793457
Epoch: 22, Steps: 52 | Train Loss: 0.4042924 Vali Loss: 1.2995218 Test Loss: 0.3307481
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 23 cost time: 1.7079219818115234
Epoch: 23, Steps: 52 | Train Loss: 0.4036595 Vali Loss: 1.2915564 Test Loss: 0.3319535
Validation loss decreased (1.296696 --> 1.291556).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 24 cost time: 1.7000837326049805
Epoch: 24, Steps: 52 | Train Loss: 0.4050741 Vali Loss: 1.3026545 Test Loss: 0.3322004
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 25 cost time: 1.7120857238769531
Epoch: 25, Steps: 52 | Train Loss: 0.4032111 Vali Loss: 1.2934482 Test Loss: 0.3304216
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 26 cost time: 1.700772762298584
Epoch: 26, Steps: 52 | Train Loss: 0.4047673 Vali Loss: 1.2987810 Test Loss: 0.3301099
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 27 cost time: 1.7074735164642334
Epoch: 27, Steps: 52 | Train Loss: 0.4020678 Vali Loss: 1.2983769 Test Loss: 0.3305293
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 28 cost time: 1.7061247825622559
Epoch: 28, Steps: 52 | Train Loss: 0.4038838 Vali Loss: 1.2957263 Test Loss: 0.3301814
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 29 cost time: 1.703230857849121
Epoch: 29, Steps: 52 | Train Loss: 0.4036328 Vali Loss: 1.2946765 Test Loss: 0.3300150
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 30 cost time: 1.6999404430389404
Epoch: 30, Steps: 52 | Train Loss: 0.4020814 Vali Loss: 1.3011384 Test Loss: 0.3306550
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 31 cost time: 1.6981749534606934
Epoch: 31, Steps: 52 | Train Loss: 0.4038079 Vali Loss: 1.2931769 Test Loss: 0.3298472
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 32 cost time: 1.700474739074707
Epoch: 32, Steps: 52 | Train Loss: 0.4032342 Vali Loss: 1.2934184 Test Loss: 0.3291605
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 33 cost time: 1.697429895401001
Epoch: 33, Steps: 52 | Train Loss: 0.4029285 Vali Loss: 1.2888592 Test Loss: 0.3300367
Validation loss decreased (1.291556 --> 1.288859).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 34 cost time: 1.7013568878173828
Epoch: 34, Steps: 52 | Train Loss: 0.4023335 Vali Loss: 1.2894568 Test Loss: 0.3307171
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 35 cost time: 1.699692726135254
Epoch: 35, Steps: 52 | Train Loss: 0.4021750 Vali Loss: 1.2941778 Test Loss: 0.3292330
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 36 cost time: 1.7036066055297852
Epoch: 36, Steps: 52 | Train Loss: 0.4033357 Vali Loss: 1.2875636 Test Loss: 0.3293083
Validation loss decreased (1.288859 --> 1.287564).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 37 cost time: 1.7033193111419678
Epoch: 37, Steps: 52 | Train Loss: 0.4005090 Vali Loss: 1.2932917 Test Loss: 0.3298553
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 38 cost time: 1.7087879180908203
Epoch: 38, Steps: 52 | Train Loss: 0.4008681 Vali Loss: 1.2870984 Test Loss: 0.3296977
Validation loss decreased (1.287564 --> 1.287098).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 39 cost time: 1.7034187316894531
Epoch: 39, Steps: 52 | Train Loss: 0.4028723 Vali Loss: 1.2945062 Test Loss: 0.3289436
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 40 cost time: 1.7066547870635986
Epoch: 40, Steps: 52 | Train Loss: 0.4015405 Vali Loss: 1.2948303 Test Loss: 0.3291847
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 41 cost time: 1.7030556201934814
Epoch: 41, Steps: 52 | Train Loss: 0.4019186 Vali Loss: 1.2951069 Test Loss: 0.3279508
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 42 cost time: 1.7057380676269531
Epoch: 42, Steps: 52 | Train Loss: 0.4027497 Vali Loss: 1.2951381 Test Loss: 0.3300098
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 43 cost time: 1.7073137760162354
Epoch: 43, Steps: 52 | Train Loss: 0.4026321 Vali Loss: 1.2992673 Test Loss: 0.3299208
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 44 cost time: 1.7167413234710693
Epoch: 44, Steps: 52 | Train Loss: 0.4010255 Vali Loss: 1.2982569 Test Loss: 0.3289339
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 45 cost time: 1.703343391418457
Epoch: 45, Steps: 52 | Train Loss: 0.4024225 Vali Loss: 1.2848520 Test Loss: 0.3296362
Validation loss decreased (1.287098 --> 1.284852).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 46 cost time: 1.704087257385254
Epoch: 46, Steps: 52 | Train Loss: 0.4026204 Vali Loss: 1.2935755 Test Loss: 0.3286489
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 47 cost time: 1.6942148208618164
Epoch: 47, Steps: 52 | Train Loss: 0.4010815 Vali Loss: 1.2905610 Test Loss: 0.3280446
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 48 cost time: 1.696556806564331
Epoch: 48, Steps: 52 | Train Loss: 0.4019503 Vali Loss: 1.2931321 Test Loss: 0.3292816
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 49 cost time: 1.7009186744689941
Epoch: 49, Steps: 52 | Train Loss: 0.4004275 Vali Loss: 1.2935619 Test Loss: 0.3292089
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 50 cost time: 1.7022442817687988
Epoch: 50, Steps: 52 | Train Loss: 0.4014733 Vali Loss: 1.2968544 Test Loss: 0.3284284
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 51 cost time: 1.6948695182800293
Epoch: 51, Steps: 52 | Train Loss: 0.4020982 Vali Loss: 1.2967525 Test Loss: 0.3293358
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 52 cost time: 1.7049977779388428
Epoch: 52, Steps: 52 | Train Loss: 0.4010600 Vali Loss: 1.2950412 Test Loss: 0.3296704
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 53 cost time: 1.7013633251190186
Epoch: 53, Steps: 52 | Train Loss: 0.4006549 Vali Loss: 1.2928841 Test Loss: 0.3277761
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 54 cost time: 1.7036855220794678
Epoch: 54, Steps: 52 | Train Loss: 0.4013507 Vali Loss: 1.2870584 Test Loss: 0.3278844
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 55 cost time: 1.700697422027588
Epoch: 55, Steps: 52 | Train Loss: 0.4024727 Vali Loss: 1.2975559 Test Loss: 0.3296160
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 56 cost time: 1.6961350440979004
Epoch: 56, Steps: 52 | Train Loss: 0.4012519 Vali Loss: 1.2883749 Test Loss: 0.3292577
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 57 cost time: 1.6954748630523682
Epoch: 57, Steps: 52 | Train Loss: 0.4009890 Vali Loss: 1.2943558 Test Loss: 0.3286816
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 58 cost time: 1.6974105834960938
Epoch: 58, Steps: 52 | Train Loss: 0.4023294 Vali Loss: 1.2956926 Test Loss: 0.3298474
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 59 cost time: 1.6998705863952637
Epoch: 59, Steps: 52 | Train Loss: 0.4020431 Vali Loss: 1.2969902 Test Loss: 0.3292442
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 60 cost time: 1.6957666873931885
Epoch: 60, Steps: 52 | Train Loss: 0.4020153 Vali Loss: 1.2966886 Test Loss: 0.3302882
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.32963624596595764, mae:0.3812921941280365, rse:0.4703555405139923
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.05994129180908203 GB
Epoch: 1 cost time: 2.1759724617004395
Epoch: 1, Steps: 52 | Train Loss: 0.7024305 Vali Loss: 2.1405993 Test Loss: 1.3816347
Validation loss decreased (inf --> 2.140599).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 2 cost time: 0.7892649173736572
Epoch: 2, Steps: 52 | Train Loss: 0.6095460 Vali Loss: 1.6340876 Test Loss: 0.7358853
Validation loss decreased (2.140599 --> 1.634088).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 3 cost time: 0.8073668479919434
Epoch: 3, Steps: 52 | Train Loss: 0.4828362 Vali Loss: 1.4388980 Test Loss: 0.4518475
Validation loss decreased (1.634088 --> 1.438898).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 4 cost time: 0.8029999732971191
Epoch: 4, Steps: 52 | Train Loss: 0.4431458 Vali Loss: 1.3931488 Test Loss: 0.4046058
Validation loss decreased (1.438898 --> 1.393149).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 5 cost time: 0.9055993556976318
Epoch: 5, Steps: 52 | Train Loss: 0.4305848 Vali Loss: 1.3724982 Test Loss: 0.3773588
Validation loss decreased (1.393149 --> 1.372498).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 6 cost time: 1.7541909217834473
Epoch: 6, Steps: 52 | Train Loss: 0.4224839 Vali Loss: 1.3547733 Test Loss: 0.3644786
Validation loss decreased (1.372498 --> 1.354773).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 7 cost time: 1.759432077407837
Epoch: 7, Steps: 52 | Train Loss: 0.4170265 Vali Loss: 1.3502932 Test Loss: 0.3563216
Validation loss decreased (1.354773 --> 1.350293).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 8 cost time: 1.7573602199554443
Epoch: 8, Steps: 52 | Train Loss: 0.4151514 Vali Loss: 1.3470219 Test Loss: 0.3499569
Validation loss decreased (1.350293 --> 1.347022).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 9 cost time: 1.7593436241149902
Epoch: 9, Steps: 52 | Train Loss: 0.4124698 Vali Loss: 1.3266606 Test Loss: 0.3457317
Validation loss decreased (1.347022 --> 1.326661).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 10 cost time: 1.7520463466644287
Epoch: 10, Steps: 52 | Train Loss: 0.4097709 Vali Loss: 1.3315043 Test Loss: 0.3425035
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 11 cost time: 1.7615911960601807
Epoch: 11, Steps: 52 | Train Loss: 0.4075714 Vali Loss: 1.3240508 Test Loss: 0.3411359
Validation loss decreased (1.326661 --> 1.324051).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 12 cost time: 1.7553722858428955
Epoch: 12, Steps: 52 | Train Loss: 0.4074710 Vali Loss: 1.3244631 Test Loss: 0.3387746
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 13 cost time: 1.7811071872711182
Epoch: 13, Steps: 52 | Train Loss: 0.4075724 Vali Loss: 1.3086702 Test Loss: 0.3368568
Validation loss decreased (1.324051 --> 1.308670).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 14 cost time: 1.7527921199798584
Epoch: 14, Steps: 52 | Train Loss: 0.4056892 Vali Loss: 1.3216674 Test Loss: 0.3356729
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 15 cost time: 1.7645418643951416
Epoch: 15, Steps: 52 | Train Loss: 0.4043767 Vali Loss: 1.2993164 Test Loss: 0.3347242
Validation loss decreased (1.308670 --> 1.299316).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 16 cost time: 1.7526957988739014
Epoch: 16, Steps: 52 | Train Loss: 0.4027740 Vali Loss: 1.3183599 Test Loss: 0.3346082
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 17 cost time: 1.7554905414581299
Epoch: 17, Steps: 52 | Train Loss: 0.4032229 Vali Loss: 1.3075650 Test Loss: 0.3327385
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 18 cost time: 1.754187822341919
Epoch: 18, Steps: 52 | Train Loss: 0.4021569 Vali Loss: 1.3070655 Test Loss: 0.3320189
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 19 cost time: 1.7573516368865967
Epoch: 19, Steps: 52 | Train Loss: 0.4015327 Vali Loss: 1.3110641 Test Loss: 0.3313554
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 20 cost time: 1.754702091217041
Epoch: 20, Steps: 52 | Train Loss: 0.4018646 Vali Loss: 1.3034077 Test Loss: 0.3312293
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 21 cost time: 1.7532389163970947
Epoch: 21, Steps: 52 | Train Loss: 0.4009334 Vali Loss: 1.3038493 Test Loss: 0.3301190
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 22 cost time: 1.7559075355529785
Epoch: 22, Steps: 52 | Train Loss: 0.3995793 Vali Loss: 1.3076968 Test Loss: 0.3301574
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 23 cost time: 1.7549529075622559
Epoch: 23, Steps: 52 | Train Loss: 0.3985629 Vali Loss: 1.3062235 Test Loss: 0.3291839
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 24 cost time: 1.759697437286377
Epoch: 24, Steps: 52 | Train Loss: 0.3994134 Vali Loss: 1.3068748 Test Loss: 0.3294283
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 25 cost time: 1.7554006576538086
Epoch: 25, Steps: 52 | Train Loss: 0.3988314 Vali Loss: 1.3061984 Test Loss: 0.3291310
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 26 cost time: 1.760268211364746
Epoch: 26, Steps: 52 | Train Loss: 0.3992657 Vali Loss: 1.3033729 Test Loss: 0.3287705
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 27 cost time: 1.7553720474243164
Epoch: 27, Steps: 52 | Train Loss: 0.3992446 Vali Loss: 1.2941123 Test Loss: 0.3287309
Validation loss decreased (1.299316 --> 1.294112).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 28 cost time: 1.7642951011657715
Epoch: 28, Steps: 52 | Train Loss: 0.3992209 Vali Loss: 1.2999604 Test Loss: 0.3286091
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 29 cost time: 1.7566554546356201
Epoch: 29, Steps: 52 | Train Loss: 0.3995343 Vali Loss: 1.3073907 Test Loss: 0.3286428
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 30 cost time: 1.754667043685913
Epoch: 30, Steps: 52 | Train Loss: 0.3980316 Vali Loss: 1.2982497 Test Loss: 0.3277498
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 31 cost time: 1.7548999786376953
Epoch: 31, Steps: 52 | Train Loss: 0.3995128 Vali Loss: 1.2898362 Test Loss: 0.3276674
Validation loss decreased (1.294112 --> 1.289836).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 32 cost time: 1.757756233215332
Epoch: 32, Steps: 52 | Train Loss: 0.3984284 Vali Loss: 1.2993042 Test Loss: 0.3282319
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 33 cost time: 1.7508721351623535
Epoch: 33, Steps: 52 | Train Loss: 0.3980679 Vali Loss: 1.3036488 Test Loss: 0.3278651
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 34 cost time: 1.754413366317749
Epoch: 34, Steps: 52 | Train Loss: 0.3975454 Vali Loss: 1.2999833 Test Loss: 0.3269683
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 35 cost time: 1.7574419975280762
Epoch: 35, Steps: 52 | Train Loss: 0.3963914 Vali Loss: 1.3000954 Test Loss: 0.3274183
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 36 cost time: 1.757216453552246
Epoch: 36, Steps: 52 | Train Loss: 0.3985085 Vali Loss: 1.3041503 Test Loss: 0.3283024
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 37 cost time: 1.7603206634521484
Epoch: 37, Steps: 52 | Train Loss: 0.3963948 Vali Loss: 1.3008745 Test Loss: 0.3268374
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 38 cost time: 1.756209135055542
Epoch: 38, Steps: 52 | Train Loss: 0.3974959 Vali Loss: 1.2990187 Test Loss: 0.3272261
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 39 cost time: 1.7606449127197266
Epoch: 39, Steps: 52 | Train Loss: 0.3991343 Vali Loss: 1.2957982 Test Loss: 0.3265482
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 40 cost time: 1.7553598880767822
Epoch: 40, Steps: 52 | Train Loss: 0.3984962 Vali Loss: 1.2869031 Test Loss: 0.3272994
Validation loss decreased (1.289836 --> 1.286903).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 41 cost time: 1.7566874027252197
Epoch: 41, Steps: 52 | Train Loss: 0.3982071 Vali Loss: 1.3058462 Test Loss: 0.3277176
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 42 cost time: 1.7547438144683838
Epoch: 42, Steps: 52 | Train Loss: 0.3988089 Vali Loss: 1.3047981 Test Loss: 0.3268574
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 43 cost time: 1.7608675956726074
Epoch: 43, Steps: 52 | Train Loss: 0.3967156 Vali Loss: 1.3026108 Test Loss: 0.3270416
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 44 cost time: 1.7539689540863037
Epoch: 44, Steps: 52 | Train Loss: 0.3984559 Vali Loss: 1.2872374 Test Loss: 0.3274302
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 45 cost time: 1.7534022331237793
Epoch: 45, Steps: 52 | Train Loss: 0.3980321 Vali Loss: 1.3010867 Test Loss: 0.3268504
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 46 cost time: 1.7590794563293457
Epoch: 46, Steps: 52 | Train Loss: 0.3976100 Vali Loss: 1.3008518 Test Loss: 0.3274716
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 47 cost time: 1.7547855377197266
Epoch: 47, Steps: 52 | Train Loss: 0.3984063 Vali Loss: 1.2933347 Test Loss: 0.3281680
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 48 cost time: 1.7551681995391846
Epoch: 48, Steps: 52 | Train Loss: 0.3975309 Vali Loss: 1.2985142 Test Loss: 0.3272274
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 49 cost time: 1.751680850982666
Epoch: 49, Steps: 52 | Train Loss: 0.3989998 Vali Loss: 1.3036169 Test Loss: 0.3268651
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 50 cost time: 1.754755973815918
Epoch: 50, Steps: 52 | Train Loss: 0.3969630 Vali Loss: 1.2950907 Test Loss: 0.3267652
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 51 cost time: 1.7540650367736816
Epoch: 51, Steps: 52 | Train Loss: 0.3973823 Vali Loss: 1.2975299 Test Loss: 0.3268663
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 52 cost time: 1.7567222118377686
Epoch: 52, Steps: 52 | Train Loss: 0.3977032 Vali Loss: 1.3029110 Test Loss: 0.3266106
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 53 cost time: 1.7570531368255615
Epoch: 53, Steps: 52 | Train Loss: 0.3962576 Vali Loss: 1.2975631 Test Loss: 0.3267695
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 54 cost time: 1.7601814270019531
Epoch: 54, Steps: 52 | Train Loss: 0.3976913 Vali Loss: 1.3037522 Test Loss: 0.3266687
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 55 cost time: 1.7517869472503662
Epoch: 55, Steps: 52 | Train Loss: 0.3983552 Vali Loss: 1.2822342 Test Loss: 0.3267543
Validation loss decreased (1.286903 --> 1.282234).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 56 cost time: 1.7606260776519775
Epoch: 56, Steps: 52 | Train Loss: 0.3972617 Vali Loss: 1.3002476 Test Loss: 0.3265546
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 57 cost time: 1.7573132514953613
Epoch: 57, Steps: 52 | Train Loss: 0.3984316 Vali Loss: 1.2884538 Test Loss: 0.3267730
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 58 cost time: 1.7576053142547607
Epoch: 58, Steps: 52 | Train Loss: 0.3970785 Vali Loss: 1.2932029 Test Loss: 0.3261843
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 59 cost time: 1.751302719116211
Epoch: 59, Steps: 52 | Train Loss: 0.3974273 Vali Loss: 1.2938203 Test Loss: 0.3270684
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 60 cost time: 1.7557945251464844
Epoch: 60, Steps: 52 | Train Loss: 0.3972255 Vali Loss: 1.3041584 Test Loss: 0.3270217
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3267543613910675, mae:0.3722356855869293, rse:0.46829497814178467
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.057550907135009766 GB
Epoch: 1 cost time: 2.152749538421631
Epoch: 1, Steps: 52 | Train Loss: 0.8238590 Vali Loss: 2.1652510 Test Loss: 1.3134845
Validation loss decreased (inf --> 2.165251).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 2 cost time: 0.7546219825744629
Epoch: 2, Steps: 52 | Train Loss: 0.6715337 Vali Loss: 1.5287099 Test Loss: 0.5624659
Validation loss decreased (2.165251 --> 1.528710).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 3 cost time: 0.7314414978027344
Epoch: 3, Steps: 52 | Train Loss: 0.5325529 Vali Loss: 1.4310580 Test Loss: 0.4410827
Validation loss decreased (1.528710 --> 1.431058).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 4 cost time: 0.7689609527587891
Epoch: 4, Steps: 52 | Train Loss: 0.4937769 Vali Loss: 1.3862569 Test Loss: 0.4075198
Validation loss decreased (1.431058 --> 1.386257).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 5 cost time: 0.7658944129943848
Epoch: 5, Steps: 52 | Train Loss: 0.4753568 Vali Loss: 1.3722456 Test Loss: 0.3894771
Validation loss decreased (1.386257 --> 1.372246).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 6 cost time: 1.6610467433929443
Epoch: 6, Steps: 52 | Train Loss: 0.4629988 Vali Loss: 1.3447337 Test Loss: 0.3770286
Validation loss decreased (1.372246 --> 1.344734).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 7 cost time: 1.6678545475006104
Epoch: 7, Steps: 52 | Train Loss: 0.4520710 Vali Loss: 1.3556044 Test Loss: 0.3678752
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 8 cost time: 1.6739623546600342
Epoch: 8, Steps: 52 | Train Loss: 0.4488276 Vali Loss: 1.3420671 Test Loss: 0.3616977
Validation loss decreased (1.344734 --> 1.342067).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 9 cost time: 1.6704254150390625
Epoch: 9, Steps: 52 | Train Loss: 0.4465744 Vali Loss: 1.3446307 Test Loss: 0.3567329
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 10 cost time: 1.6694912910461426
Epoch: 10, Steps: 52 | Train Loss: 0.4398327 Vali Loss: 1.3372793 Test Loss: 0.3524919
Validation loss decreased (1.342067 --> 1.337279).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 11 cost time: 1.6678540706634521
Epoch: 11, Steps: 52 | Train Loss: 0.4385572 Vali Loss: 1.3371891 Test Loss: 0.3495336
Validation loss decreased (1.337279 --> 1.337189).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 12 cost time: 1.6688838005065918
Epoch: 12, Steps: 52 | Train Loss: 0.4331172 Vali Loss: 1.3302323 Test Loss: 0.3467201
Validation loss decreased (1.337189 --> 1.330232).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 13 cost time: 1.6693120002746582
Epoch: 13, Steps: 52 | Train Loss: 0.4324780 Vali Loss: 1.3265576 Test Loss: 0.3448806
Validation loss decreased (1.330232 --> 1.326558).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 14 cost time: 1.6738059520721436
Epoch: 14, Steps: 52 | Train Loss: 0.4320274 Vali Loss: 1.3282475 Test Loss: 0.3427966
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 15 cost time: 1.6712367534637451
Epoch: 15, Steps: 52 | Train Loss: 0.4294845 Vali Loss: 1.3205357 Test Loss: 0.3416796
Validation loss decreased (1.326558 --> 1.320536).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 16 cost time: 1.6695775985717773
Epoch: 16, Steps: 52 | Train Loss: 0.4278215 Vali Loss: 1.3231627 Test Loss: 0.3404563
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 17 cost time: 1.6739416122436523
Epoch: 17, Steps: 52 | Train Loss: 0.4257350 Vali Loss: 1.3113887 Test Loss: 0.3388609
Validation loss decreased (1.320536 --> 1.311389).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 18 cost time: 1.675976037979126
Epoch: 18, Steps: 52 | Train Loss: 0.4257324 Vali Loss: 1.3155422 Test Loss: 0.3380552
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 19 cost time: 1.6663269996643066
Epoch: 19, Steps: 52 | Train Loss: 0.4262196 Vali Loss: 1.3180869 Test Loss: 0.3371132
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 20 cost time: 1.670278787612915
Epoch: 20, Steps: 52 | Train Loss: 0.4240300 Vali Loss: 1.3205051 Test Loss: 0.3370324
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 21 cost time: 1.6702134609222412
Epoch: 21, Steps: 52 | Train Loss: 0.4236004 Vali Loss: 1.3127130 Test Loss: 0.3357183
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 22 cost time: 1.671163558959961
Epoch: 22, Steps: 52 | Train Loss: 0.4245405 Vali Loss: 1.3125696 Test Loss: 0.3359202
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 23 cost time: 1.671086072921753
Epoch: 23, Steps: 52 | Train Loss: 0.4219817 Vali Loss: 1.3097088 Test Loss: 0.3347114
Validation loss decreased (1.311389 --> 1.309709).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 24 cost time: 1.6694426536560059
Epoch: 24, Steps: 52 | Train Loss: 0.4227773 Vali Loss: 1.3033105 Test Loss: 0.3346819
Validation loss decreased (1.309709 --> 1.303311).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 25 cost time: 1.6706912517547607
Epoch: 25, Steps: 52 | Train Loss: 0.4198043 Vali Loss: 1.3163617 Test Loss: 0.3342214
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 26 cost time: 1.6639354228973389
Epoch: 26, Steps: 52 | Train Loss: 0.4213347 Vali Loss: 1.3066416 Test Loss: 0.3337796
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 27 cost time: 1.6750941276550293
Epoch: 27, Steps: 52 | Train Loss: 0.4206992 Vali Loss: 1.3148360 Test Loss: 0.3342932
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 28 cost time: 1.6649806499481201
Epoch: 28, Steps: 52 | Train Loss: 0.4207733 Vali Loss: 1.3095307 Test Loss: 0.3330553
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 29 cost time: 1.6714613437652588
Epoch: 29, Steps: 52 | Train Loss: 0.4185918 Vali Loss: 1.3115063 Test Loss: 0.3331045
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 30 cost time: 1.6751155853271484
Epoch: 30, Steps: 52 | Train Loss: 0.4208522 Vali Loss: 1.3094997 Test Loss: 0.3332497
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 31 cost time: 1.676429271697998
Epoch: 31, Steps: 52 | Train Loss: 0.4191482 Vali Loss: 1.3130292 Test Loss: 0.3333820
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 32 cost time: 1.6744842529296875
Epoch: 32, Steps: 52 | Train Loss: 0.4187988 Vali Loss: 1.3083913 Test Loss: 0.3324063
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 33 cost time: 1.6740024089813232
Epoch: 33, Steps: 52 | Train Loss: 0.4180141 Vali Loss: 1.3096924 Test Loss: 0.3323364
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 34 cost time: 1.6675128936767578
Epoch: 34, Steps: 52 | Train Loss: 0.4195561 Vali Loss: 1.3110057 Test Loss: 0.3319488
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 35 cost time: 1.6724145412445068
Epoch: 35, Steps: 52 | Train Loss: 0.4179028 Vali Loss: 1.3077084 Test Loss: 0.3325511
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 36 cost time: 1.6714327335357666
Epoch: 36, Steps: 52 | Train Loss: 0.4199416 Vali Loss: 1.2998098 Test Loss: 0.3318519
Validation loss decreased (1.303311 --> 1.299810).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 37 cost time: 1.6736257076263428
Epoch: 37, Steps: 52 | Train Loss: 0.4194567 Vali Loss: 1.3068233 Test Loss: 0.3318923
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 38 cost time: 1.6719472408294678
Epoch: 38, Steps: 52 | Train Loss: 0.4177736 Vali Loss: 1.3105123 Test Loss: 0.3317294
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 39 cost time: 1.6719532012939453
Epoch: 39, Steps: 52 | Train Loss: 0.4189461 Vali Loss: 1.3074992 Test Loss: 0.3319255
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 40 cost time: 1.6680629253387451
Epoch: 40, Steps: 52 | Train Loss: 0.4187783 Vali Loss: 1.2972391 Test Loss: 0.3320074
Validation loss decreased (1.299810 --> 1.297239).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 41 cost time: 1.6714966297149658
Epoch: 41, Steps: 52 | Train Loss: 0.4196307 Vali Loss: 1.3086914 Test Loss: 0.3319405
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 42 cost time: 1.6734604835510254
Epoch: 42, Steps: 52 | Train Loss: 0.4182005 Vali Loss: 1.3026099 Test Loss: 0.3315890
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 43 cost time: 1.6728835105895996
Epoch: 43, Steps: 52 | Train Loss: 0.4169880 Vali Loss: 1.3090580 Test Loss: 0.3316848
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 44 cost time: 1.673703670501709
Epoch: 44, Steps: 52 | Train Loss: 0.4171785 Vali Loss: 1.3112040 Test Loss: 0.3313817
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 45 cost time: 1.6774866580963135
Epoch: 45, Steps: 52 | Train Loss: 0.4170169 Vali Loss: 1.3042223 Test Loss: 0.3314639
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 46 cost time: 1.6743874549865723
Epoch: 46, Steps: 52 | Train Loss: 0.4171657 Vali Loss: 1.3104339 Test Loss: 0.3317819
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 47 cost time: 1.6724276542663574
Epoch: 47, Steps: 52 | Train Loss: 0.4186732 Vali Loss: 1.2986410 Test Loss: 0.3314506
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 48 cost time: 1.6732571125030518
Epoch: 48, Steps: 52 | Train Loss: 0.4188678 Vali Loss: 1.2999010 Test Loss: 0.3314061
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 49 cost time: 1.6745309829711914
Epoch: 49, Steps: 52 | Train Loss: 0.4183690 Vali Loss: 1.3044105 Test Loss: 0.3317294
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 50 cost time: 1.6744611263275146
Epoch: 50, Steps: 52 | Train Loss: 0.4184586 Vali Loss: 1.3010802 Test Loss: 0.3315143
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 51 cost time: 1.6750950813293457
Epoch: 51, Steps: 52 | Train Loss: 0.4176948 Vali Loss: 1.3100021 Test Loss: 0.3310967
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 52 cost time: 1.6654295921325684
Epoch: 52, Steps: 52 | Train Loss: 0.4166581 Vali Loss: 1.3084233 Test Loss: 0.3312399
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 53 cost time: 1.6725773811340332
Epoch: 53, Steps: 52 | Train Loss: 0.4179366 Vali Loss: 1.3005304 Test Loss: 0.3312364
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 54 cost time: 1.6704463958740234
Epoch: 54, Steps: 52 | Train Loss: 0.4181256 Vali Loss: 1.3064466 Test Loss: 0.3316960
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 55 cost time: 1.6701173782348633
Epoch: 55, Steps: 52 | Train Loss: 0.4171427 Vali Loss: 1.2988998 Test Loss: 0.3305972
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 56 cost time: 1.6720919609069824
Epoch: 56, Steps: 52 | Train Loss: 0.4175112 Vali Loss: 1.2953579 Test Loss: 0.3306102
Validation loss decreased (1.297239 --> 1.295358).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 57 cost time: 1.6678895950317383
Epoch: 57, Steps: 52 | Train Loss: 0.4161904 Vali Loss: 1.3042583 Test Loss: 0.3307494
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 58 cost time: 1.6716077327728271
Epoch: 58, Steps: 52 | Train Loss: 0.4149736 Vali Loss: 1.3098521 Test Loss: 0.3311946
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 59 cost time: 1.6692285537719727
Epoch: 59, Steps: 52 | Train Loss: 0.4173029 Vali Loss: 1.2956493 Test Loss: 0.3318374
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 60 cost time: 1.6674816608428955
Epoch: 60, Steps: 52 | Train Loss: 0.4170706 Vali Loss: 1.2982261 Test Loss: 0.3314922
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3306102156639099, mae:0.37782296538352966, rse:0.4710499346256256
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.05898284912109375 GB
Epoch: 1 cost time: 2.139068126678467
Epoch: 1, Steps: 52 | Train Loss: 0.7763488 Vali Loss: 2.2669833 Test Loss: 1.5213826
Validation loss decreased (inf --> 2.266983).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 2 cost time: 0.7774434089660645
Epoch: 2, Steps: 52 | Train Loss: 0.6261316 Vali Loss: 1.5954995 Test Loss: 0.6557661
Validation loss decreased (2.266983 --> 1.595500).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 3 cost time: 0.7749993801116943
Epoch: 3, Steps: 52 | Train Loss: 0.4824140 Vali Loss: 1.4215134 Test Loss: 0.4259955
Validation loss decreased (1.595500 --> 1.421513).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 4 cost time: 0.7810168266296387
Epoch: 4, Steps: 52 | Train Loss: 0.4453672 Vali Loss: 1.3823512 Test Loss: 0.3922120
Validation loss decreased (1.421513 --> 1.382351).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 5 cost time: 0.7753469944000244
Epoch: 5, Steps: 52 | Train Loss: 0.4351772 Vali Loss: 1.3711067 Test Loss: 0.3759589
Validation loss decreased (1.382351 --> 1.371107).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 6 cost time: 1.7238755226135254
Epoch: 6, Steps: 52 | Train Loss: 0.4285162 Vali Loss: 1.3630323 Test Loss: 0.3661806
Validation loss decreased (1.371107 --> 1.363032).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 7 cost time: 1.733860731124878
Epoch: 7, Steps: 52 | Train Loss: 0.4244579 Vali Loss: 1.3506460 Test Loss: 0.3593680
Validation loss decreased (1.363032 --> 1.350646).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 8 cost time: 1.727997064590454
Epoch: 8, Steps: 52 | Train Loss: 0.4201849 Vali Loss: 1.3477361 Test Loss: 0.3547576
Validation loss decreased (1.350646 --> 1.347736).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 9 cost time: 1.7309486865997314
Epoch: 9, Steps: 52 | Train Loss: 0.4171935 Vali Loss: 1.3444207 Test Loss: 0.3512670
Validation loss decreased (1.347736 --> 1.344421).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 10 cost time: 1.7236862182617188
Epoch: 10, Steps: 52 | Train Loss: 0.4155802 Vali Loss: 1.3303028 Test Loss: 0.3481287
Validation loss decreased (1.344421 --> 1.330303).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 11 cost time: 1.7265093326568604
Epoch: 11, Steps: 52 | Train Loss: 0.4138392 Vali Loss: 1.3229740 Test Loss: 0.3466341
Validation loss decreased (1.330303 --> 1.322974).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 12 cost time: 1.7315115928649902
Epoch: 12, Steps: 52 | Train Loss: 0.4126576 Vali Loss: 1.3260549 Test Loss: 0.3448733
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 13 cost time: 1.72586989402771
Epoch: 13, Steps: 52 | Train Loss: 0.4121182 Vali Loss: 1.3242750 Test Loss: 0.3431151
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 14 cost time: 1.7300496101379395
Epoch: 14, Steps: 52 | Train Loss: 0.4094696 Vali Loss: 1.3253098 Test Loss: 0.3423593
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 15 cost time: 1.7252931594848633
Epoch: 15, Steps: 52 | Train Loss: 0.4111303 Vali Loss: 1.3222015 Test Loss: 0.3422267
Validation loss decreased (1.322974 --> 1.322201).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 16 cost time: 1.7326853275299072
Epoch: 16, Steps: 52 | Train Loss: 0.4098959 Vali Loss: 1.3096670 Test Loss: 0.3403244
Validation loss decreased (1.322201 --> 1.309667).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 17 cost time: 1.729238748550415
Epoch: 17, Steps: 52 | Train Loss: 0.4074865 Vali Loss: 1.3219185 Test Loss: 0.3408362
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 18 cost time: 1.7344343662261963
Epoch: 18, Steps: 52 | Train Loss: 0.4069766 Vali Loss: 1.3129678 Test Loss: 0.3395235
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 19 cost time: 1.7274761199951172
Epoch: 19, Steps: 52 | Train Loss: 0.4074891 Vali Loss: 1.3165342 Test Loss: 0.3386994
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 20 cost time: 1.7267310619354248
Epoch: 20, Steps: 52 | Train Loss: 0.4071766 Vali Loss: 1.3077178 Test Loss: 0.3385271
Validation loss decreased (1.309667 --> 1.307718).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 21 cost time: 1.723954200744629
Epoch: 21, Steps: 52 | Train Loss: 0.4064162 Vali Loss: 1.3157023 Test Loss: 0.3376784
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 22 cost time: 1.7283663749694824
Epoch: 22, Steps: 52 | Train Loss: 0.4054561 Vali Loss: 1.3112202 Test Loss: 0.3373833
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 23 cost time: 1.7184641361236572
Epoch: 23, Steps: 52 | Train Loss: 0.4042451 Vali Loss: 1.3114312 Test Loss: 0.3377341
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 24 cost time: 1.7250566482543945
Epoch: 24, Steps: 52 | Train Loss: 0.4050603 Vali Loss: 1.3087947 Test Loss: 0.3377213
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 25 cost time: 1.726447343826294
Epoch: 25, Steps: 52 | Train Loss: 0.4048941 Vali Loss: 1.3064573 Test Loss: 0.3361980
Validation loss decreased (1.307718 --> 1.306457).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 26 cost time: 1.72794771194458
Epoch: 26, Steps: 52 | Train Loss: 0.4041052 Vali Loss: 1.3125719 Test Loss: 0.3364917
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 27 cost time: 1.7246670722961426
Epoch: 27, Steps: 52 | Train Loss: 0.4031941 Vali Loss: 1.3132691 Test Loss: 0.3364603
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 28 cost time: 1.7292752265930176
Epoch: 28, Steps: 52 | Train Loss: 0.4049699 Vali Loss: 1.3054419 Test Loss: 0.3358376
Validation loss decreased (1.306457 --> 1.305442).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 29 cost time: 1.7281887531280518
Epoch: 29, Steps: 52 | Train Loss: 0.4027164 Vali Loss: 1.3072221 Test Loss: 0.3360440
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 30 cost time: 1.72283935546875
Epoch: 30, Steps: 52 | Train Loss: 0.4025718 Vali Loss: 1.3056688 Test Loss: 0.3356367
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 31 cost time: 1.7300431728363037
Epoch: 31, Steps: 52 | Train Loss: 0.4041700 Vali Loss: 1.3052365 Test Loss: 0.3356073
Validation loss decreased (1.305442 --> 1.305236).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 32 cost time: 1.7229955196380615
Epoch: 32, Steps: 52 | Train Loss: 0.4048819 Vali Loss: 1.3068306 Test Loss: 0.3354989
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 33 cost time: 1.7303857803344727
Epoch: 33, Steps: 52 | Train Loss: 0.4044638 Vali Loss: 1.3027711 Test Loss: 0.3358611
Validation loss decreased (1.305236 --> 1.302771).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 34 cost time: 1.7284367084503174
Epoch: 34, Steps: 52 | Train Loss: 0.4017211 Vali Loss: 1.3090820 Test Loss: 0.3359579
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 35 cost time: 1.7318403720855713
Epoch: 35, Steps: 52 | Train Loss: 0.4028645 Vali Loss: 1.2996798 Test Loss: 0.3351266
Validation loss decreased (1.302771 --> 1.299680).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 36 cost time: 1.7252330780029297
Epoch: 36, Steps: 52 | Train Loss: 0.4057191 Vali Loss: 1.2964860 Test Loss: 0.3359432
Validation loss decreased (1.299680 --> 1.296486).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 37 cost time: 1.7263121604919434
Epoch: 37, Steps: 52 | Train Loss: 0.4038926 Vali Loss: 1.2915962 Test Loss: 0.3358542
Validation loss decreased (1.296486 --> 1.291596).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 38 cost time: 1.7247042655944824
Epoch: 38, Steps: 52 | Train Loss: 0.4032066 Vali Loss: 1.3038518 Test Loss: 0.3350752
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 39 cost time: 1.7282400131225586
Epoch: 39, Steps: 52 | Train Loss: 0.4026277 Vali Loss: 1.3008713 Test Loss: 0.3353647
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 40 cost time: 1.727482795715332
Epoch: 40, Steps: 52 | Train Loss: 0.4035972 Vali Loss: 1.3005922 Test Loss: 0.3346723
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 41 cost time: 1.7263031005859375
Epoch: 41, Steps: 52 | Train Loss: 0.4047224 Vali Loss: 1.3024522 Test Loss: 0.3351772
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 42 cost time: 1.7247214317321777
Epoch: 42, Steps: 52 | Train Loss: 0.4033730 Vali Loss: 1.3043641 Test Loss: 0.3335844
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 43 cost time: 1.7253367900848389
Epoch: 43, Steps: 52 | Train Loss: 0.4026539 Vali Loss: 1.3041888 Test Loss: 0.3353363
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 44 cost time: 1.729048490524292
Epoch: 44, Steps: 52 | Train Loss: 0.4030633 Vali Loss: 1.2915683 Test Loss: 0.3352611
Validation loss decreased (1.291596 --> 1.291568).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 45 cost time: 1.727921962738037
Epoch: 45, Steps: 52 | Train Loss: 0.4020705 Vali Loss: 1.3074408 Test Loss: 0.3350169
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 46 cost time: 1.7268171310424805
Epoch: 46, Steps: 52 | Train Loss: 0.4031765 Vali Loss: 1.3028067 Test Loss: 0.3347532
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 47 cost time: 1.7279412746429443
Epoch: 47, Steps: 52 | Train Loss: 0.4024983 Vali Loss: 1.2949620 Test Loss: 0.3341256
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 48 cost time: 1.7306106090545654
Epoch: 48, Steps: 52 | Train Loss: 0.4033513 Vali Loss: 1.2963731 Test Loss: 0.3357418
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 49 cost time: 1.727771520614624
Epoch: 49, Steps: 52 | Train Loss: 0.4011969 Vali Loss: 1.2969632 Test Loss: 0.3345940
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 50 cost time: 1.729156255722046
Epoch: 50, Steps: 52 | Train Loss: 0.4039893 Vali Loss: 1.2987617 Test Loss: 0.3355100
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 51 cost time: 1.7233877182006836
Epoch: 51, Steps: 52 | Train Loss: 0.4024215 Vali Loss: 1.3060234 Test Loss: 0.3341854
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 52 cost time: 1.7267155647277832
Epoch: 52, Steps: 52 | Train Loss: 0.4041380 Vali Loss: 1.3030448 Test Loss: 0.3346323
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 53 cost time: 1.7245910167694092
Epoch: 53, Steps: 52 | Train Loss: 0.4017899 Vali Loss: 1.3003614 Test Loss: 0.3340613
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 54 cost time: 1.7275540828704834
Epoch: 54, Steps: 52 | Train Loss: 0.4014746 Vali Loss: 1.3095011 Test Loss: 0.3353750
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 55 cost time: 1.723625898361206
Epoch: 55, Steps: 52 | Train Loss: 0.4031975 Vali Loss: 1.3073068 Test Loss: 0.3347470
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 56 cost time: 1.7264349460601807
Epoch: 56, Steps: 52 | Train Loss: 0.4023834 Vali Loss: 1.3065925 Test Loss: 0.3347424
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 57 cost time: 1.7249200344085693
Epoch: 57, Steps: 52 | Train Loss: 0.4032411 Vali Loss: 1.3083541 Test Loss: 0.3354582
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 58 cost time: 1.7261879444122314
Epoch: 58, Steps: 52 | Train Loss: 0.4027570 Vali Loss: 1.3075988 Test Loss: 0.3350758
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 59 cost time: 1.7234020233154297
Epoch: 59, Steps: 52 | Train Loss: 0.4021605 Vali Loss: 1.3052118 Test Loss: 0.3347517
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 60 cost time: 1.7258636951446533
Epoch: 60, Steps: 52 | Train Loss: 0.4042133 Vali Loss: 1.2995304 Test Loss: 0.3348288
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3352610766887665, mae:0.3859597146511078, rse:0.4743516147136688
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.06010293960571289 GB
Epoch: 1 cost time: 2.1890385150909424
Epoch: 1, Steps: 52 | Train Loss: 0.6924972 Vali Loss: 2.1020942 Test Loss: 1.3342552
Validation loss decreased (inf --> 2.102094).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 2 cost time: 0.7999107837677002
Epoch: 2, Steps: 52 | Train Loss: 0.5937321 Vali Loss: 1.5899701 Test Loss: 0.6867734
Validation loss decreased (2.102094 --> 1.589970).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 3 cost time: 0.7964811325073242
Epoch: 3, Steps: 52 | Train Loss: 0.4726176 Vali Loss: 1.4106529 Test Loss: 0.4310651
Validation loss decreased (1.589970 --> 1.410653).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 4 cost time: 0.7948668003082275
Epoch: 4, Steps: 52 | Train Loss: 0.4384064 Vali Loss: 1.3748955 Test Loss: 0.3894500
Validation loss decreased (1.410653 --> 1.374895).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 5 cost time: 0.9583008289337158
Epoch: 5, Steps: 52 | Train Loss: 0.4265970 Vali Loss: 1.3588723 Test Loss: 0.3660017
Validation loss decreased (1.374895 --> 1.358872).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 6 cost time: 1.7688190937042236
Epoch: 6, Steps: 52 | Train Loss: 0.4201684 Vali Loss: 1.3480967 Test Loss: 0.3557404
Validation loss decreased (1.358872 --> 1.348097).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 7 cost time: 1.7696964740753174
Epoch: 7, Steps: 52 | Train Loss: 0.4137126 Vali Loss: 1.3315871 Test Loss: 0.3488771
Validation loss decreased (1.348097 --> 1.331587).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 8 cost time: 1.7675731182098389
Epoch: 8, Steps: 52 | Train Loss: 0.4110611 Vali Loss: 1.3327098 Test Loss: 0.3452747
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 9 cost time: 1.7684640884399414
Epoch: 9, Steps: 52 | Train Loss: 0.4105130 Vali Loss: 1.3201976 Test Loss: 0.3429456
Validation loss decreased (1.331587 --> 1.320198).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 10 cost time: 1.7660179138183594
Epoch: 10, Steps: 52 | Train Loss: 0.4089132 Vali Loss: 1.3168541 Test Loss: 0.3417093
Validation loss decreased (1.320198 --> 1.316854).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 11 cost time: 1.7693543434143066
Epoch: 11, Steps: 52 | Train Loss: 0.4084247 Vali Loss: 1.3118072 Test Loss: 0.3387898
Validation loss decreased (1.316854 --> 1.311807).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 12 cost time: 1.7611076831817627
Epoch: 12, Steps: 52 | Train Loss: 0.4061913 Vali Loss: 1.3168266 Test Loss: 0.3378921
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 13 cost time: 1.77024507522583
Epoch: 13, Steps: 52 | Train Loss: 0.4048416 Vali Loss: 1.3143479 Test Loss: 0.3364810
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 14 cost time: 1.7650771141052246
Epoch: 14, Steps: 52 | Train Loss: 0.4036318 Vali Loss: 1.3088083 Test Loss: 0.3365029
Validation loss decreased (1.311807 --> 1.308808).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 15 cost time: 1.7752933502197266
Epoch: 15, Steps: 52 | Train Loss: 0.4033475 Vali Loss: 1.3068569 Test Loss: 0.3371001
Validation loss decreased (1.308808 --> 1.306857).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 16 cost time: 1.7780227661132812
Epoch: 16, Steps: 52 | Train Loss: 0.4024458 Vali Loss: 1.3081691 Test Loss: 0.3369910
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 17 cost time: 1.7756638526916504
Epoch: 17, Steps: 52 | Train Loss: 0.4024401 Vali Loss: 1.3039969 Test Loss: 0.3355356
Validation loss decreased (1.306857 --> 1.303997).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 18 cost time: 1.7696552276611328
Epoch: 18, Steps: 52 | Train Loss: 0.4013316 Vali Loss: 1.2950199 Test Loss: 0.3364835
Validation loss decreased (1.303997 --> 1.295020).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 19 cost time: 1.768996000289917
Epoch: 19, Steps: 52 | Train Loss: 0.4008357 Vali Loss: 1.2968675 Test Loss: 0.3353695
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 20 cost time: 1.7679200172424316
Epoch: 20, Steps: 52 | Train Loss: 0.3995787 Vali Loss: 1.2959518 Test Loss: 0.3344761
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 21 cost time: 1.7648062705993652
Epoch: 21, Steps: 52 | Train Loss: 0.3996170 Vali Loss: 1.2887933 Test Loss: 0.3352457
Validation loss decreased (1.295020 --> 1.288793).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 22 cost time: 1.7681119441986084
Epoch: 22, Steps: 52 | Train Loss: 0.3985629 Vali Loss: 1.2952034 Test Loss: 0.3348175
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 23 cost time: 1.7677364349365234
Epoch: 23, Steps: 52 | Train Loss: 0.3989271 Vali Loss: 1.2965856 Test Loss: 0.3344781
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 24 cost time: 1.763728380203247
Epoch: 24, Steps: 52 | Train Loss: 0.3997613 Vali Loss: 1.2884210 Test Loss: 0.3345396
Validation loss decreased (1.288793 --> 1.288421).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 25 cost time: 1.7694294452667236
Epoch: 25, Steps: 52 | Train Loss: 0.3994503 Vali Loss: 1.2942790 Test Loss: 0.3343105
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 26 cost time: 1.7719378471374512
Epoch: 26, Steps: 52 | Train Loss: 0.3986735 Vali Loss: 1.2991287 Test Loss: 0.3352165
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 27 cost time: 1.768747091293335
Epoch: 27, Steps: 52 | Train Loss: 0.3970132 Vali Loss: 1.2879643 Test Loss: 0.3348662
Validation loss decreased (1.288421 --> 1.287964).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 28 cost time: 1.7747738361358643
Epoch: 28, Steps: 52 | Train Loss: 0.3988414 Vali Loss: 1.2811420 Test Loss: 0.3348079
Validation loss decreased (1.287964 --> 1.281142).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 29 cost time: 1.7722055912017822
Epoch: 29, Steps: 52 | Train Loss: 0.3978805 Vali Loss: 1.2910235 Test Loss: 0.3332055
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 30 cost time: 1.7675037384033203
Epoch: 30, Steps: 52 | Train Loss: 0.3980930 Vali Loss: 1.2858869 Test Loss: 0.3343983
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 31 cost time: 1.7656750679016113
Epoch: 31, Steps: 52 | Train Loss: 0.3979687 Vali Loss: 1.2891258 Test Loss: 0.3335351
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 32 cost time: 1.7653965950012207
Epoch: 32, Steps: 52 | Train Loss: 0.4002216 Vali Loss: 1.2815418 Test Loss: 0.3343883
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 33 cost time: 1.7721714973449707
Epoch: 33, Steps: 52 | Train Loss: 0.3977476 Vali Loss: 1.2884533 Test Loss: 0.3354326
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 34 cost time: 1.7677531242370605
Epoch: 34, Steps: 52 | Train Loss: 0.3979384 Vali Loss: 1.2925423 Test Loss: 0.3326097
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 35 cost time: 1.7662949562072754
Epoch: 35, Steps: 52 | Train Loss: 0.3987444 Vali Loss: 1.2890713 Test Loss: 0.3337192
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 36 cost time: 1.7682702541351318
Epoch: 36, Steps: 52 | Train Loss: 0.3979856 Vali Loss: 1.2979999 Test Loss: 0.3346565
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 37 cost time: 1.770859718322754
Epoch: 37, Steps: 52 | Train Loss: 0.3976085 Vali Loss: 1.2920516 Test Loss: 0.3327528
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 38 cost time: 1.7715137004852295
Epoch: 38, Steps: 52 | Train Loss: 0.3991954 Vali Loss: 1.2857938 Test Loss: 0.3329878
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 39 cost time: 1.7729570865631104
Epoch: 39, Steps: 52 | Train Loss: 0.3988112 Vali Loss: 1.2960802 Test Loss: 0.3336631
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 40 cost time: 1.7690799236297607
Epoch: 40, Steps: 52 | Train Loss: 0.3982162 Vali Loss: 1.2878419 Test Loss: 0.3329210
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 41 cost time: 1.770390272140503
Epoch: 41, Steps: 52 | Train Loss: 0.3970661 Vali Loss: 1.2946048 Test Loss: 0.3347821
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 42 cost time: 1.770742416381836
Epoch: 42, Steps: 52 | Train Loss: 0.3990246 Vali Loss: 1.2871890 Test Loss: 0.3335080
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 43 cost time: 1.7697603702545166
Epoch: 43, Steps: 52 | Train Loss: 0.3971279 Vali Loss: 1.2930342 Test Loss: 0.3334726
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 44 cost time: 1.7741436958312988
Epoch: 44, Steps: 52 | Train Loss: 0.3961251 Vali Loss: 1.2906263 Test Loss: 0.3344288
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 45 cost time: 1.7734768390655518
Epoch: 45, Steps: 52 | Train Loss: 0.3971846 Vali Loss: 1.2921593 Test Loss: 0.3337964
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 46 cost time: 1.7750277519226074
Epoch: 46, Steps: 52 | Train Loss: 0.3977352 Vali Loss: 1.2905278 Test Loss: 0.3333432
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 47 cost time: 1.7712976932525635
Epoch: 47, Steps: 52 | Train Loss: 0.3971910 Vali Loss: 1.2922473 Test Loss: 0.3333581
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 48 cost time: 1.7740812301635742
Epoch: 48, Steps: 52 | Train Loss: 0.3961568 Vali Loss: 1.2846221 Test Loss: 0.3337052
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 49 cost time: 1.7669909000396729
Epoch: 49, Steps: 52 | Train Loss: 0.3972395 Vali Loss: 1.2895238 Test Loss: 0.3336313
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 50 cost time: 1.7772672176361084
Epoch: 50, Steps: 52 | Train Loss: 0.3972544 Vali Loss: 1.2900081 Test Loss: 0.3336947
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 51 cost time: 1.7693614959716797
Epoch: 51, Steps: 52 | Train Loss: 0.3971506 Vali Loss: 1.2876840 Test Loss: 0.3324764
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 52 cost time: 1.7735319137573242
Epoch: 52, Steps: 52 | Train Loss: 0.3959878 Vali Loss: 1.2954557 Test Loss: 0.3339081
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 53 cost time: 1.767545223236084
Epoch: 53, Steps: 52 | Train Loss: 0.3971690 Vali Loss: 1.2955780 Test Loss: 0.3336901
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 54 cost time: 1.7666656970977783
Epoch: 54, Steps: 52 | Train Loss: 0.3972960 Vali Loss: 1.2837509 Test Loss: 0.3331541
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 55 cost time: 1.7692184448242188
Epoch: 55, Steps: 52 | Train Loss: 0.3967107 Vali Loss: 1.2946777 Test Loss: 0.3331320
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 56 cost time: 1.7683768272399902
Epoch: 56, Steps: 52 | Train Loss: 0.3951720 Vali Loss: 1.2859179 Test Loss: 0.3338395
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 57 cost time: 1.7721624374389648
Epoch: 57, Steps: 52 | Train Loss: 0.3970081 Vali Loss: 1.2878549 Test Loss: 0.3339083
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 58 cost time: 1.7705950736999512
Epoch: 58, Steps: 52 | Train Loss: 0.3962846 Vali Loss: 1.2964458 Test Loss: 0.3334684
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 59 cost time: 1.7736001014709473
Epoch: 59, Steps: 52 | Train Loss: 0.3972827 Vali Loss: 1.2870789 Test Loss: 0.3339734
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 60 cost time: 1.7692067623138428
Epoch: 60, Steps: 52 | Train Loss: 0.3974586 Vali Loss: 1.2829456 Test Loss: 0.3329394
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33480796217918396, mae:0.3889354467391968, rse:0.4740309715270996
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05771303176879883 GB
Epoch: 1 cost time: 2.145250082015991
Epoch: 1, Steps: 52 | Train Loss: 0.9529325 Vali Loss: 2.5367169 Test Loss: 1.7055744
Validation loss decreased (inf --> 2.536717).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 2 cost time: 0.7589998245239258
Epoch: 2, Steps: 52 | Train Loss: 0.7444200 Vali Loss: 1.6571608 Test Loss: 0.7114172
Validation loss decreased (2.536717 --> 1.657161).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 3 cost time: 0.75848388671875
Epoch: 3, Steps: 52 | Train Loss: 0.5628309 Vali Loss: 1.4743284 Test Loss: 0.4851296
Validation loss decreased (1.657161 --> 1.474328).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 4 cost time: 0.7565546035766602
Epoch: 4, Steps: 52 | Train Loss: 0.5079821 Vali Loss: 1.4124805 Test Loss: 0.4276357
Validation loss decreased (1.474328 --> 1.412480).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 5 cost time: 0.7629997730255127
Epoch: 5, Steps: 52 | Train Loss: 0.4803462 Vali Loss: 1.3925157 Test Loss: 0.4018866
Validation loss decreased (1.412480 --> 1.392516).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 6 cost time: 1.6772677898406982
Epoch: 6, Steps: 52 | Train Loss: 0.4671784 Vali Loss: 1.3732131 Test Loss: 0.3863116
Validation loss decreased (1.392516 --> 1.373213).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 7 cost time: 1.6855583190917969
Epoch: 7, Steps: 52 | Train Loss: 0.4576820 Vali Loss: 1.3695689 Test Loss: 0.3766596
Validation loss decreased (1.373213 --> 1.369569).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 8 cost time: 1.690568208694458
Epoch: 8, Steps: 52 | Train Loss: 0.4539803 Vali Loss: 1.3469200 Test Loss: 0.3692231
Validation loss decreased (1.369569 --> 1.346920).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 9 cost time: 1.6855578422546387
Epoch: 9, Steps: 52 | Train Loss: 0.4492884 Vali Loss: 1.3544393 Test Loss: 0.3638411
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 10 cost time: 1.6794495582580566
Epoch: 10, Steps: 52 | Train Loss: 0.4437707 Vali Loss: 1.3435466 Test Loss: 0.3595939
Validation loss decreased (1.346920 --> 1.343547).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 11 cost time: 1.686384916305542
Epoch: 11, Steps: 52 | Train Loss: 0.4410993 Vali Loss: 1.3461711 Test Loss: 0.3565874
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 12 cost time: 1.6783146858215332
Epoch: 12, Steps: 52 | Train Loss: 0.4387035 Vali Loss: 1.3405643 Test Loss: 0.3543841
Validation loss decreased (1.343547 --> 1.340564).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 13 cost time: 1.6812081336975098
Epoch: 13, Steps: 52 | Train Loss: 0.4357877 Vali Loss: 1.3384879 Test Loss: 0.3515866
Validation loss decreased (1.340564 --> 1.338488).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 14 cost time: 1.6830809116363525
Epoch: 14, Steps: 52 | Train Loss: 0.4331923 Vali Loss: 1.3336661 Test Loss: 0.3491559
Validation loss decreased (1.338488 --> 1.333666).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 15 cost time: 1.6829681396484375
Epoch: 15, Steps: 52 | Train Loss: 0.4321807 Vali Loss: 1.3356882 Test Loss: 0.3481405
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 16 cost time: 1.683401346206665
Epoch: 16, Steps: 52 | Train Loss: 0.4308847 Vali Loss: 1.3319793 Test Loss: 0.3465528
Validation loss decreased (1.333666 --> 1.331979).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 17 cost time: 1.6790337562561035
Epoch: 17, Steps: 52 | Train Loss: 0.4318094 Vali Loss: 1.3252800 Test Loss: 0.3452801
Validation loss decreased (1.331979 --> 1.325280).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 18 cost time: 1.674849510192871
Epoch: 18, Steps: 52 | Train Loss: 0.4264998 Vali Loss: 1.3178658 Test Loss: 0.3449682
Validation loss decreased (1.325280 --> 1.317866).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 19 cost time: 1.6802492141723633
Epoch: 19, Steps: 52 | Train Loss: 0.4273956 Vali Loss: 1.3198003 Test Loss: 0.3438276
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 20 cost time: 1.6804873943328857
Epoch: 20, Steps: 52 | Train Loss: 0.4255228 Vali Loss: 1.3243899 Test Loss: 0.3431848
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 21 cost time: 1.683612585067749
Epoch: 21, Steps: 52 | Train Loss: 0.4264610 Vali Loss: 1.3264539 Test Loss: 0.3428262
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 22 cost time: 1.677119493484497
Epoch: 22, Steps: 52 | Train Loss: 0.4241475 Vali Loss: 1.3181370 Test Loss: 0.3416971
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 23 cost time: 1.6805121898651123
Epoch: 23, Steps: 52 | Train Loss: 0.4240363 Vali Loss: 1.3260674 Test Loss: 0.3413184
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 24 cost time: 1.6752824783325195
Epoch: 24, Steps: 52 | Train Loss: 0.4221899 Vali Loss: 1.3206251 Test Loss: 0.3409309
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 25 cost time: 1.6847343444824219
Epoch: 25, Steps: 52 | Train Loss: 0.4243347 Vali Loss: 1.3102767 Test Loss: 0.3407159
Validation loss decreased (1.317866 --> 1.310277).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 26 cost time: 1.6803665161132812
Epoch: 26, Steps: 52 | Train Loss: 0.4215584 Vali Loss: 1.3165700 Test Loss: 0.3403932
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 27 cost time: 1.6813075542449951
Epoch: 27, Steps: 52 | Train Loss: 0.4233120 Vali Loss: 1.3161451 Test Loss: 0.3395053
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 28 cost time: 1.6747362613677979
Epoch: 28, Steps: 52 | Train Loss: 0.4225994 Vali Loss: 1.3082640 Test Loss: 0.3396633
Validation loss decreased (1.310277 --> 1.308264).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 29 cost time: 1.6800291538238525
Epoch: 29, Steps: 52 | Train Loss: 0.4230985 Vali Loss: 1.3194381 Test Loss: 0.3398669
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 30 cost time: 1.6778795719146729
Epoch: 30, Steps: 52 | Train Loss: 0.4208867 Vali Loss: 1.3106513 Test Loss: 0.3389502
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 31 cost time: 1.672832727432251
Epoch: 31, Steps: 52 | Train Loss: 0.4219908 Vali Loss: 1.3188548 Test Loss: 0.3388734
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 32 cost time: 1.6763536930084229
Epoch: 32, Steps: 52 | Train Loss: 0.4212616 Vali Loss: 1.3158590 Test Loss: 0.3383714
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 33 cost time: 1.6767821311950684
Epoch: 33, Steps: 52 | Train Loss: 0.4227739 Vali Loss: 1.3170624 Test Loss: 0.3385435
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 34 cost time: 1.6839139461517334
Epoch: 34, Steps: 52 | Train Loss: 0.4196381 Vali Loss: 1.3149936 Test Loss: 0.3387473
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 35 cost time: 1.6775856018066406
Epoch: 35, Steps: 52 | Train Loss: 0.4208083 Vali Loss: 1.3097447 Test Loss: 0.3377362
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 36 cost time: 1.6779370307922363
Epoch: 36, Steps: 52 | Train Loss: 0.4207736 Vali Loss: 1.3144662 Test Loss: 0.3385198
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 37 cost time: 1.671884536743164
Epoch: 37, Steps: 52 | Train Loss: 0.4174447 Vali Loss: 1.3143542 Test Loss: 0.3379971
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 38 cost time: 1.6757545471191406
Epoch: 38, Steps: 52 | Train Loss: 0.4202385 Vali Loss: 1.3130226 Test Loss: 0.3383812
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 39 cost time: 1.6685223579406738
Epoch: 39, Steps: 52 | Train Loss: 0.4209949 Vali Loss: 1.3073530 Test Loss: 0.3377353
Validation loss decreased (1.308264 --> 1.307353).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 40 cost time: 1.6841537952423096
Epoch: 40, Steps: 52 | Train Loss: 0.4211714 Vali Loss: 1.3172667 Test Loss: 0.3380956
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 41 cost time: 1.6792807579040527
Epoch: 41, Steps: 52 | Train Loss: 0.4178301 Vali Loss: 1.3125498 Test Loss: 0.3371336
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 42 cost time: 1.6829028129577637
Epoch: 42, Steps: 52 | Train Loss: 0.4201740 Vali Loss: 1.3170804 Test Loss: 0.3377984
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 43 cost time: 1.680398941040039
Epoch: 43, Steps: 52 | Train Loss: 0.4206381 Vali Loss: 1.3191634 Test Loss: 0.3378572
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 44 cost time: 1.6847624778747559
Epoch: 44, Steps: 52 | Train Loss: 0.4212215 Vali Loss: 1.3116534 Test Loss: 0.3373479
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 45 cost time: 1.684727430343628
Epoch: 45, Steps: 52 | Train Loss: 0.4191397 Vali Loss: 1.3048408 Test Loss: 0.3370907
Validation loss decreased (1.307353 --> 1.304841).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 46 cost time: 1.6890194416046143
Epoch: 46, Steps: 52 | Train Loss: 0.4196545 Vali Loss: 1.3181087 Test Loss: 0.3374356
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 47 cost time: 1.6840898990631104
Epoch: 47, Steps: 52 | Train Loss: 0.4192848 Vali Loss: 1.3101423 Test Loss: 0.3375432
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 48 cost time: 1.6907613277435303
Epoch: 48, Steps: 52 | Train Loss: 0.4191910 Vali Loss: 1.3103335 Test Loss: 0.3368443
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 49 cost time: 1.6775355339050293
Epoch: 49, Steps: 52 | Train Loss: 0.4203031 Vali Loss: 1.3153081 Test Loss: 0.3367150
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 50 cost time: 1.6872491836547852
Epoch: 50, Steps: 52 | Train Loss: 0.4217268 Vali Loss: 1.3159935 Test Loss: 0.3375666
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 51 cost time: 1.679234266281128
Epoch: 51, Steps: 52 | Train Loss: 0.4182162 Vali Loss: 1.3064142 Test Loss: 0.3368156
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 52 cost time: 1.6839382648468018
Epoch: 52, Steps: 52 | Train Loss: 0.4185146 Vali Loss: 1.3078268 Test Loss: 0.3374471
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 53 cost time: 1.6831817626953125
Epoch: 53, Steps: 52 | Train Loss: 0.4184889 Vali Loss: 1.3113120 Test Loss: 0.3370965
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 54 cost time: 1.686539888381958
Epoch: 54, Steps: 52 | Train Loss: 0.4216656 Vali Loss: 1.3133394 Test Loss: 0.3375246
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 55 cost time: 1.6808981895446777
Epoch: 55, Steps: 52 | Train Loss: 0.4199984 Vali Loss: 1.3122542 Test Loss: 0.3369519
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 56 cost time: 1.68611478805542
Epoch: 56, Steps: 52 | Train Loss: 0.4205474 Vali Loss: 1.3131788 Test Loss: 0.3370175
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 57 cost time: 1.6823930740356445
Epoch: 57, Steps: 52 | Train Loss: 0.4185347 Vali Loss: 1.3173320 Test Loss: 0.3368535
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 58 cost time: 1.6822445392608643
Epoch: 58, Steps: 52 | Train Loss: 0.4204037 Vali Loss: 1.3128370 Test Loss: 0.3369623
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 59 cost time: 1.6769583225250244
Epoch: 59, Steps: 52 | Train Loss: 0.4189639 Vali Loss: 1.3058858 Test Loss: 0.3377913
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 60 cost time: 1.6786699295043945
Epoch: 60, Steps: 52 | Train Loss: 0.4202791 Vali Loss: 1.3042073 Test Loss: 0.3370636
Validation loss decreased (1.304841 --> 1.304207).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33706358075141907, mae:0.3816549777984619, rse:0.47562506794929504
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.05914497375488281 GB
Epoch: 1 cost time: 2.1699957847595215
Epoch: 1, Steps: 52 | Train Loss: 0.7162304 Vali Loss: 2.0823741 Test Loss: 1.2754396
Validation loss decreased (inf --> 2.082374).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 2 cost time: 0.7873237133026123
Epoch: 2, Steps: 52 | Train Loss: 0.5720042 Vali Loss: 1.4686141 Test Loss: 0.5050833
Validation loss decreased (2.082374 --> 1.468614).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 3 cost time: 0.7909998893737793
Epoch: 3, Steps: 52 | Train Loss: 0.4660743 Vali Loss: 1.4034443 Test Loss: 0.4019034
Validation loss decreased (1.468614 --> 1.403444).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 4 cost time: 0.7893581390380859
Epoch: 4, Steps: 52 | Train Loss: 0.4425111 Vali Loss: 1.3794768 Test Loss: 0.3835455
Validation loss decreased (1.403444 --> 1.379477).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 5 cost time: 0.7883565425872803
Epoch: 5, Steps: 52 | Train Loss: 0.4315450 Vali Loss: 1.3694305 Test Loss: 0.3705636
Validation loss decreased (1.379477 --> 1.369431).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 6 cost time: 1.7370293140411377
Epoch: 6, Steps: 52 | Train Loss: 0.4258523 Vali Loss: 1.3535252 Test Loss: 0.3623248
Validation loss decreased (1.369431 --> 1.353525).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 7 cost time: 1.7390949726104736
Epoch: 7, Steps: 52 | Train Loss: 0.4243676 Vali Loss: 1.3515452 Test Loss: 0.3570928
Validation loss decreased (1.353525 --> 1.351545).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 8 cost time: 1.7385427951812744
Epoch: 8, Steps: 52 | Train Loss: 0.4184379 Vali Loss: 1.3300927 Test Loss: 0.3528799
Validation loss decreased (1.351545 --> 1.330093).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 9 cost time: 1.743661642074585
Epoch: 9, Steps: 52 | Train Loss: 0.4158876 Vali Loss: 1.3351476 Test Loss: 0.3497318
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 10 cost time: 1.7356576919555664
Epoch: 10, Steps: 52 | Train Loss: 0.4146436 Vali Loss: 1.3338749 Test Loss: 0.3480382
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 11 cost time: 1.7383434772491455
Epoch: 11, Steps: 52 | Train Loss: 0.4134122 Vali Loss: 1.3267269 Test Loss: 0.3453478
Validation loss decreased (1.330093 --> 1.326727).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 12 cost time: 1.7402808666229248
Epoch: 12, Steps: 52 | Train Loss: 0.4126678 Vali Loss: 1.3298683 Test Loss: 0.3439146
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 13 cost time: 1.7383842468261719
Epoch: 13, Steps: 52 | Train Loss: 0.4100698 Vali Loss: 1.3198940 Test Loss: 0.3431897
Validation loss decreased (1.326727 --> 1.319894).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 14 cost time: 1.743818759918213
Epoch: 14, Steps: 52 | Train Loss: 0.4080444 Vali Loss: 1.3227065 Test Loss: 0.3413050
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 15 cost time: 1.743401288986206
Epoch: 15, Steps: 52 | Train Loss: 0.4094478 Vali Loss: 1.3207327 Test Loss: 0.3405537
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 16 cost time: 1.7361927032470703
Epoch: 16, Steps: 52 | Train Loss: 0.4072702 Vali Loss: 1.3175769 Test Loss: 0.3394110
Validation loss decreased (1.319894 --> 1.317577).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 17 cost time: 1.7444031238555908
Epoch: 17, Steps: 52 | Train Loss: 0.4088160 Vali Loss: 1.3154492 Test Loss: 0.3388504
Validation loss decreased (1.317577 --> 1.315449).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 18 cost time: 1.7390213012695312
Epoch: 18, Steps: 52 | Train Loss: 0.4070920 Vali Loss: 1.3181068 Test Loss: 0.3384103
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 19 cost time: 1.7404778003692627
Epoch: 19, Steps: 52 | Train Loss: 0.4044938 Vali Loss: 1.3138835 Test Loss: 0.3376883
Validation loss decreased (1.315449 --> 1.313884).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 20 cost time: 1.7344131469726562
Epoch: 20, Steps: 52 | Train Loss: 0.4065491 Vali Loss: 1.3190649 Test Loss: 0.3373903
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 21 cost time: 1.7387454509735107
Epoch: 21, Steps: 52 | Train Loss: 0.4051863 Vali Loss: 1.3134518 Test Loss: 0.3357185
Validation loss decreased (1.313884 --> 1.313452).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 22 cost time: 1.7378571033477783
Epoch: 22, Steps: 52 | Train Loss: 0.4050412 Vali Loss: 1.3048525 Test Loss: 0.3358292
Validation loss decreased (1.313452 --> 1.304852).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 23 cost time: 1.7377893924713135
Epoch: 23, Steps: 52 | Train Loss: 0.4040337 Vali Loss: 1.3141291 Test Loss: 0.3354921
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 24 cost time: 1.7382361888885498
Epoch: 24, Steps: 52 | Train Loss: 0.4040364 Vali Loss: 1.3117032 Test Loss: 0.3349994
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 25 cost time: 1.7380130290985107
Epoch: 25, Steps: 52 | Train Loss: 0.4039774 Vali Loss: 1.3084145 Test Loss: 0.3346616
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 26 cost time: 1.740588903427124
Epoch: 26, Steps: 52 | Train Loss: 0.4036301 Vali Loss: 1.3142930 Test Loss: 0.3344646
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 27 cost time: 1.7343947887420654
Epoch: 27, Steps: 52 | Train Loss: 0.4046675 Vali Loss: 1.3122363 Test Loss: 0.3349561
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 28 cost time: 1.734666347503662
Epoch: 28, Steps: 52 | Train Loss: 0.4022190 Vali Loss: 1.3054643 Test Loss: 0.3348745
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 29 cost time: 1.7315292358398438
Epoch: 29, Steps: 52 | Train Loss: 0.4019922 Vali Loss: 1.3090909 Test Loss: 0.3340972
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 30 cost time: 1.7418525218963623
Epoch: 30, Steps: 52 | Train Loss: 0.4012088 Vali Loss: 1.3038807 Test Loss: 0.3341419
Validation loss decreased (1.304852 --> 1.303881).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 31 cost time: 1.740351676940918
Epoch: 31, Steps: 52 | Train Loss: 0.4037235 Vali Loss: 1.2947880 Test Loss: 0.3334675
Validation loss decreased (1.303881 --> 1.294788).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 32 cost time: 1.7410800457000732
Epoch: 32, Steps: 52 | Train Loss: 0.4027718 Vali Loss: 1.3047850 Test Loss: 0.3330011
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 33 cost time: 1.738948106765747
Epoch: 33, Steps: 52 | Train Loss: 0.4038235 Vali Loss: 1.3074210 Test Loss: 0.3338340
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 34 cost time: 1.7405712604522705
Epoch: 34, Steps: 52 | Train Loss: 0.4036200 Vali Loss: 1.3045944 Test Loss: 0.3330014
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 35 cost time: 1.7389717102050781
Epoch: 35, Steps: 52 | Train Loss: 0.4010659 Vali Loss: 1.3073871 Test Loss: 0.3335025
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 36 cost time: 1.7342629432678223
Epoch: 36, Steps: 52 | Train Loss: 0.4028302 Vali Loss: 1.2997026 Test Loss: 0.3330022
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 37 cost time: 1.7380011081695557
Epoch: 37, Steps: 52 | Train Loss: 0.4034652 Vali Loss: 1.3102940 Test Loss: 0.3330474
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 38 cost time: 1.740504503250122
Epoch: 38, Steps: 52 | Train Loss: 0.4026084 Vali Loss: 1.3070775 Test Loss: 0.3329851
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 39 cost time: 1.7409617900848389
Epoch: 39, Steps: 52 | Train Loss: 0.4018360 Vali Loss: 1.3012588 Test Loss: 0.3315628
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 40 cost time: 1.7390155792236328
Epoch: 40, Steps: 52 | Train Loss: 0.4019539 Vali Loss: 1.3023806 Test Loss: 0.3324477
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 41 cost time: 1.7407596111297607
Epoch: 41, Steps: 52 | Train Loss: 0.4025360 Vali Loss: 1.3101919 Test Loss: 0.3338920
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 42 cost time: 1.7375521659851074
Epoch: 42, Steps: 52 | Train Loss: 0.4012211 Vali Loss: 1.3039014 Test Loss: 0.3323424
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 43 cost time: 1.7416996955871582
Epoch: 43, Steps: 52 | Train Loss: 0.4013623 Vali Loss: 1.2843108 Test Loss: 0.3320031
Validation loss decreased (1.294788 --> 1.284311).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 44 cost time: 1.7350292205810547
Epoch: 44, Steps: 52 | Train Loss: 0.4025677 Vali Loss: 1.3055396 Test Loss: 0.3325872
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 45 cost time: 1.7427048683166504
Epoch: 45, Steps: 52 | Train Loss: 0.4023646 Vali Loss: 1.3053124 Test Loss: 0.3333101
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 46 cost time: 1.7373991012573242
Epoch: 46, Steps: 52 | Train Loss: 0.4010807 Vali Loss: 1.3040732 Test Loss: 0.3327233
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 47 cost time: 1.7404956817626953
Epoch: 47, Steps: 52 | Train Loss: 0.4010809 Vali Loss: 1.3059735 Test Loss: 0.3322732
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 48 cost time: 1.7333955764770508
Epoch: 48, Steps: 52 | Train Loss: 0.4019485 Vali Loss: 1.3103316 Test Loss: 0.3324361
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 49 cost time: 1.7427895069122314
Epoch: 49, Steps: 52 | Train Loss: 0.4015849 Vali Loss: 1.3049701 Test Loss: 0.3321177
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 50 cost time: 1.7355408668518066
Epoch: 50, Steps: 52 | Train Loss: 0.4029282 Vali Loss: 1.3041253 Test Loss: 0.3320127
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 51 cost time: 1.7348659038543701
Epoch: 51, Steps: 52 | Train Loss: 0.4017940 Vali Loss: 1.3101637 Test Loss: 0.3321475
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 52 cost time: 1.7388694286346436
Epoch: 52, Steps: 52 | Train Loss: 0.4005879 Vali Loss: 1.3030875 Test Loss: 0.3327080
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 53 cost time: 1.7355599403381348
Epoch: 53, Steps: 52 | Train Loss: 0.4033625 Vali Loss: 1.3062530 Test Loss: 0.3318167
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 54 cost time: 1.740297555923462
Epoch: 54, Steps: 52 | Train Loss: 0.4019393 Vali Loss: 1.2950917 Test Loss: 0.3322795
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 55 cost time: 1.739980936050415
Epoch: 55, Steps: 52 | Train Loss: 0.4023973 Vali Loss: 1.2984483 Test Loss: 0.3318442
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 56 cost time: 1.7404975891113281
Epoch: 56, Steps: 52 | Train Loss: 0.4020240 Vali Loss: 1.3056084 Test Loss: 0.3319478
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 57 cost time: 1.7362053394317627
Epoch: 57, Steps: 52 | Train Loss: 0.4019866 Vali Loss: 1.3087567 Test Loss: 0.3326272
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 58 cost time: 1.738312005996704
Epoch: 58, Steps: 52 | Train Loss: 0.4018292 Vali Loss: 1.2993343 Test Loss: 0.3324950
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 59 cost time: 1.7368583679199219
Epoch: 59, Steps: 52 | Train Loss: 0.4015639 Vali Loss: 1.2984719 Test Loss: 0.3326209
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 60 cost time: 1.7381117343902588
Epoch: 60, Steps: 52 | Train Loss: 0.4010255 Vali Loss: 1.3065259 Test Loss: 0.3328701
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3320031464099884, mae:0.3783828020095825, rse:0.47204118967056274
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06026506423950195 GB
Epoch: 1 cost time: 2.1785097122192383
Epoch: 1, Steps: 52 | Train Loss: 0.7155079 Vali Loss: 2.1579731 Test Loss: 1.4026251
Validation loss decreased (inf --> 2.157973).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 2 cost time: 0.8068161010742188
Epoch: 2, Steps: 52 | Train Loss: 0.6015783 Vali Loss: 1.5633140 Test Loss: 0.6379547
Validation loss decreased (2.157973 --> 1.563314).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 3 cost time: 0.8041341304779053
Epoch: 3, Steps: 52 | Train Loss: 0.4715155 Vali Loss: 1.4223030 Test Loss: 0.4257859
Validation loss decreased (1.563314 --> 1.422303).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 4 cost time: 0.8039994239807129
Epoch: 4, Steps: 52 | Train Loss: 0.4378717 Vali Loss: 1.3858809 Test Loss: 0.3927629
Validation loss decreased (1.422303 --> 1.385881).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 5 cost time: 0.9359724521636963
Epoch: 5, Steps: 52 | Train Loss: 0.4271656 Vali Loss: 1.3642702 Test Loss: 0.3733249
Validation loss decreased (1.385881 --> 1.364270).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 6 cost time: 1.7903850078582764
Epoch: 6, Steps: 52 | Train Loss: 0.4186456 Vali Loss: 1.3441982 Test Loss: 0.3629438
Validation loss decreased (1.364270 --> 1.344198).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 7 cost time: 1.7861082553863525
Epoch: 7, Steps: 52 | Train Loss: 0.4159436 Vali Loss: 1.3403956 Test Loss: 0.3565179
Validation loss decreased (1.344198 --> 1.340396).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 8 cost time: 1.788686752319336
Epoch: 8, Steps: 52 | Train Loss: 0.4131037 Vali Loss: 1.3250687 Test Loss: 0.3528746
Validation loss decreased (1.340396 --> 1.325069).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 9 cost time: 1.7854599952697754
Epoch: 9, Steps: 52 | Train Loss: 0.4096640 Vali Loss: 1.3296704 Test Loss: 0.3497486
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 10 cost time: 1.787987232208252
Epoch: 10, Steps: 52 | Train Loss: 0.4085834 Vali Loss: 1.3268745 Test Loss: 0.3470455
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 11 cost time: 1.7881748676300049
Epoch: 11, Steps: 52 | Train Loss: 0.4069397 Vali Loss: 1.3240047 Test Loss: 0.3448375
Validation loss decreased (1.325069 --> 1.324005).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 12 cost time: 1.7879245281219482
Epoch: 12, Steps: 52 | Train Loss: 0.4077027 Vali Loss: 1.3180907 Test Loss: 0.3427100
Validation loss decreased (1.324005 --> 1.318091).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 13 cost time: 1.7849338054656982
Epoch: 13, Steps: 52 | Train Loss: 0.4060932 Vali Loss: 1.3113225 Test Loss: 0.3411918
Validation loss decreased (1.318091 --> 1.311322).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 14 cost time: 1.7831900119781494
Epoch: 14, Steps: 52 | Train Loss: 0.4047655 Vali Loss: 1.3211752 Test Loss: 0.3410035
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 15 cost time: 1.7861580848693848
Epoch: 15, Steps: 52 | Train Loss: 0.4034543 Vali Loss: 1.3080828 Test Loss: 0.3388110
Validation loss decreased (1.311322 --> 1.308083).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 16 cost time: 1.7824969291687012
Epoch: 16, Steps: 52 | Train Loss: 0.4038605 Vali Loss: 1.3096730 Test Loss: 0.3382740
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 17 cost time: 1.7897727489471436
Epoch: 17, Steps: 52 | Train Loss: 0.4024886 Vali Loss: 1.3115511 Test Loss: 0.3374816
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 18 cost time: 1.7825863361358643
Epoch: 18, Steps: 52 | Train Loss: 0.4010272 Vali Loss: 1.3076559 Test Loss: 0.3377474
Validation loss decreased (1.308083 --> 1.307656).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 19 cost time: 1.7867522239685059
Epoch: 19, Steps: 52 | Train Loss: 0.4023028 Vali Loss: 1.3082008 Test Loss: 0.3367178
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 20 cost time: 1.7863681316375732
Epoch: 20, Steps: 52 | Train Loss: 0.4022238 Vali Loss: 1.3025570 Test Loss: 0.3357208
Validation loss decreased (1.307656 --> 1.302557).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 21 cost time: 1.7790427207946777
Epoch: 21, Steps: 52 | Train Loss: 0.4023220 Vali Loss: 1.3110840 Test Loss: 0.3352628
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 22 cost time: 1.7851448059082031
Epoch: 22, Steps: 52 | Train Loss: 0.4015002 Vali Loss: 1.3053880 Test Loss: 0.3353908
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 23 cost time: 1.7814817428588867
Epoch: 23, Steps: 52 | Train Loss: 0.4001652 Vali Loss: 1.3051872 Test Loss: 0.3346922
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 24 cost time: 1.7864973545074463
Epoch: 24, Steps: 52 | Train Loss: 0.4001730 Vali Loss: 1.3067786 Test Loss: 0.3343266
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 25 cost time: 1.7729268074035645
Epoch: 25, Steps: 52 | Train Loss: 0.4001870 Vali Loss: 1.3058398 Test Loss: 0.3346189
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 26 cost time: 1.7795519828796387
Epoch: 26, Steps: 52 | Train Loss: 0.4002807 Vali Loss: 1.3081174 Test Loss: 0.3336574
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 27 cost time: 1.7862606048583984
Epoch: 27, Steps: 52 | Train Loss: 0.3994649 Vali Loss: 1.3076049 Test Loss: 0.3334416
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 28 cost time: 1.795806884765625
Epoch: 28, Steps: 52 | Train Loss: 0.3991792 Vali Loss: 1.3022215 Test Loss: 0.3327069
Validation loss decreased (1.302557 --> 1.302222).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 29 cost time: 1.786402702331543
Epoch: 29, Steps: 52 | Train Loss: 0.3988275 Vali Loss: 1.3016942 Test Loss: 0.3327693
Validation loss decreased (1.302222 --> 1.301694).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 30 cost time: 1.789917230606079
Epoch: 30, Steps: 52 | Train Loss: 0.3984248 Vali Loss: 1.2966757 Test Loss: 0.3333562
Validation loss decreased (1.301694 --> 1.296676).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 31 cost time: 1.7823128700256348
Epoch: 31, Steps: 52 | Train Loss: 0.3977874 Vali Loss: 1.3059661 Test Loss: 0.3332224
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 32 cost time: 1.7849416732788086
Epoch: 32, Steps: 52 | Train Loss: 0.3987347 Vali Loss: 1.3046870 Test Loss: 0.3318461
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 33 cost time: 1.7868001461029053
Epoch: 33, Steps: 52 | Train Loss: 0.3990971 Vali Loss: 1.3069397 Test Loss: 0.3329869
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 34 cost time: 1.7812058925628662
Epoch: 34, Steps: 52 | Train Loss: 0.3980424 Vali Loss: 1.2885934 Test Loss: 0.3324799
Validation loss decreased (1.296676 --> 1.288593).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 35 cost time: 1.7903146743774414
Epoch: 35, Steps: 52 | Train Loss: 0.3994112 Vali Loss: 1.3037292 Test Loss: 0.3321006
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 36 cost time: 1.7854571342468262
Epoch: 36, Steps: 52 | Train Loss: 0.3994532 Vali Loss: 1.3019625 Test Loss: 0.3328112
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 37 cost time: 1.790114164352417
Epoch: 37, Steps: 52 | Train Loss: 0.3978669 Vali Loss: 1.3053923 Test Loss: 0.3325326
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 38 cost time: 1.7854111194610596
Epoch: 38, Steps: 52 | Train Loss: 0.3977489 Vali Loss: 1.3007283 Test Loss: 0.3319795
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 39 cost time: 1.790442705154419
Epoch: 39, Steps: 52 | Train Loss: 0.3987714 Vali Loss: 1.3015879 Test Loss: 0.3320172
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 40 cost time: 1.783200979232788
Epoch: 40, Steps: 52 | Train Loss: 0.3982292 Vali Loss: 1.3051236 Test Loss: 0.3320134
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 41 cost time: 1.7862544059753418
Epoch: 41, Steps: 52 | Train Loss: 0.3993706 Vali Loss: 1.2909529 Test Loss: 0.3320005
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 42 cost time: 1.7875185012817383
Epoch: 42, Steps: 52 | Train Loss: 0.3991533 Vali Loss: 1.3057936 Test Loss: 0.3312241
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 43 cost time: 1.7894527912139893
Epoch: 43, Steps: 52 | Train Loss: 0.3990514 Vali Loss: 1.3056393 Test Loss: 0.3322591
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 44 cost time: 1.793982982635498
Epoch: 44, Steps: 52 | Train Loss: 0.3977208 Vali Loss: 1.3009316 Test Loss: 0.3321422
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 45 cost time: 1.7847185134887695
Epoch: 45, Steps: 52 | Train Loss: 0.3988977 Vali Loss: 1.3051800 Test Loss: 0.3321559
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 46 cost time: 1.7924211025238037
Epoch: 46, Steps: 52 | Train Loss: 0.3973061 Vali Loss: 1.3037030 Test Loss: 0.3317779
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 47 cost time: 1.8015694618225098
Epoch: 47, Steps: 52 | Train Loss: 0.3984093 Vali Loss: 1.2915161 Test Loss: 0.3321081
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 48 cost time: 1.7919883728027344
Epoch: 48, Steps: 52 | Train Loss: 0.3983100 Vali Loss: 1.2987224 Test Loss: 0.3315521
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 49 cost time: 1.786517858505249
Epoch: 49, Steps: 52 | Train Loss: 0.3974812 Vali Loss: 1.2979782 Test Loss: 0.3310777
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 50 cost time: 1.7854115962982178
Epoch: 50, Steps: 52 | Train Loss: 0.3980505 Vali Loss: 1.2976069 Test Loss: 0.3326871
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 51 cost time: 1.7807724475860596
Epoch: 51, Steps: 52 | Train Loss: 0.3979526 Vali Loss: 1.3000708 Test Loss: 0.3314974
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 52 cost time: 1.7819228172302246
Epoch: 52, Steps: 52 | Train Loss: 0.3975610 Vali Loss: 1.3031266 Test Loss: 0.3312487
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 53 cost time: 1.7889227867126465
Epoch: 53, Steps: 52 | Train Loss: 0.3992820 Vali Loss: 1.3029494 Test Loss: 0.3319278
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 54 cost time: 1.7829787731170654
Epoch: 54, Steps: 52 | Train Loss: 0.3986219 Vali Loss: 1.2999415 Test Loss: 0.3320091
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 55 cost time: 1.7856800556182861
Epoch: 55, Steps: 52 | Train Loss: 0.3976872 Vali Loss: 1.2964633 Test Loss: 0.3317811
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 56 cost time: 1.7841980457305908
Epoch: 56, Steps: 52 | Train Loss: 0.3966960 Vali Loss: 1.2962979 Test Loss: 0.3326547
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 57 cost time: 1.784435510635376
Epoch: 57, Steps: 52 | Train Loss: 0.3988685 Vali Loss: 1.3064584 Test Loss: 0.3322112
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 58 cost time: 1.784895420074463
Epoch: 58, Steps: 52 | Train Loss: 0.3979543 Vali Loss: 1.2975476 Test Loss: 0.3305233
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 59 cost time: 1.7862043380737305
Epoch: 59, Steps: 52 | Train Loss: 0.3988024 Vali Loss: 1.2974148 Test Loss: 0.3317220
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 60 cost time: 1.784278392791748
Epoch: 60, Steps: 52 | Train Loss: 0.3979537 Vali Loss: 1.3034662 Test Loss: 0.3310421
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.33247992396354675, mae:0.3814511299133301, rse:0.47238004207611084
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.045563697814941406 GB
Epoch: 1 cost time: 2.0834550857543945
Epoch: 1, Steps: 52 | Train Loss: 0.7684122 Vali Loss: 2.2938614 Test Loss: 1.4513031
Validation loss decreased (inf --> 2.293861).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 2 cost time: 0.6886024475097656
Epoch: 2, Steps: 52 | Train Loss: 0.7225867 Vali Loss: 2.0500994 Test Loss: 1.2124183
Validation loss decreased (2.293861 --> 2.050099).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 3 cost time: 0.6924328804016113
Epoch: 3, Steps: 52 | Train Loss: 0.6526560 Vali Loss: 1.8617818 Test Loss: 1.0190978
Validation loss decreased (2.050099 --> 1.861782).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 4 cost time: 0.6890010833740234
Epoch: 4, Steps: 52 | Train Loss: 0.5967018 Vali Loss: 1.7184889 Test Loss: 0.8354221
Validation loss decreased (1.861782 --> 1.718489).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 5 cost time: 0.6966049671173096
Epoch: 5, Steps: 52 | Train Loss: 0.5497088 Vali Loss: 1.6089823 Test Loss: 0.6942252
Validation loss decreased (1.718489 --> 1.608982).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 6 cost time: 1.0827810764312744
Epoch: 6, Steps: 52 | Train Loss: 0.5176030 Vali Loss: 1.5420954 Test Loss: 0.6026545
Validation loss decreased (1.608982 --> 1.542095).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 7 cost time: 1.525085687637329
Epoch: 7, Steps: 52 | Train Loss: 0.4972518 Vali Loss: 1.4985918 Test Loss: 0.5433449
Validation loss decreased (1.542095 --> 1.498592).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 8 cost time: 1.5411837100982666
Epoch: 8, Steps: 52 | Train Loss: 0.4804447 Vali Loss: 1.4745693 Test Loss: 0.5058218
Validation loss decreased (1.498592 --> 1.474569).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 9 cost time: 1.5373413562774658
Epoch: 9, Steps: 52 | Train Loss: 0.4715061 Vali Loss: 1.4362464 Test Loss: 0.4819711
Validation loss decreased (1.474569 --> 1.436246).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 10 cost time: 1.5372850894927979
Epoch: 10, Steps: 52 | Train Loss: 0.4655138 Vali Loss: 1.4344172 Test Loss: 0.4683650
Validation loss decreased (1.436246 --> 1.434417).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 11 cost time: 1.5422215461730957
Epoch: 11, Steps: 52 | Train Loss: 0.4596649 Vali Loss: 1.4283056 Test Loss: 0.4557064
Validation loss decreased (1.434417 --> 1.428306).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 12 cost time: 1.5385839939117432
Epoch: 12, Steps: 52 | Train Loss: 0.4563998 Vali Loss: 1.4215991 Test Loss: 0.4474704
Validation loss decreased (1.428306 --> 1.421599).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 13 cost time: 1.5347175598144531
Epoch: 13, Steps: 52 | Train Loss: 0.4526604 Vali Loss: 1.4104905 Test Loss: 0.4409373
Validation loss decreased (1.421599 --> 1.410491).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 14 cost time: 1.5460574626922607
Epoch: 14, Steps: 52 | Train Loss: 0.4510518 Vali Loss: 1.4101875 Test Loss: 0.4372956
Validation loss decreased (1.410491 --> 1.410187).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 15 cost time: 1.5337860584259033
Epoch: 15, Steps: 52 | Train Loss: 0.4485474 Vali Loss: 1.4027798 Test Loss: 0.4320533
Validation loss decreased (1.410187 --> 1.402780).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 16 cost time: 1.5353095531463623
Epoch: 16, Steps: 52 | Train Loss: 0.4463585 Vali Loss: 1.3863312 Test Loss: 0.4276316
Validation loss decreased (1.402780 --> 1.386331).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 17 cost time: 1.53123140335083
Epoch: 17, Steps: 52 | Train Loss: 0.4470052 Vali Loss: 1.3930390 Test Loss: 0.4269282
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 18 cost time: 1.5371479988098145
Epoch: 18, Steps: 52 | Train Loss: 0.4432549 Vali Loss: 1.3973458 Test Loss: 0.4240127
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 19 cost time: 1.5391225814819336
Epoch: 19, Steps: 52 | Train Loss: 0.4421700 Vali Loss: 1.3830745 Test Loss: 0.4238634
Validation loss decreased (1.386331 --> 1.383075).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 20 cost time: 1.5433073043823242
Epoch: 20, Steps: 52 | Train Loss: 0.4431416 Vali Loss: 1.3740165 Test Loss: 0.4211891
Validation loss decreased (1.383075 --> 1.374017).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 21 cost time: 1.537410020828247
Epoch: 21, Steps: 52 | Train Loss: 0.4394123 Vali Loss: 1.3889374 Test Loss: 0.4212776
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 22 cost time: 1.5374939441680908
Epoch: 22, Steps: 52 | Train Loss: 0.4391495 Vali Loss: 1.3836521 Test Loss: 0.4195219
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 23 cost time: 1.536597490310669
Epoch: 23, Steps: 52 | Train Loss: 0.4396531 Vali Loss: 1.3894393 Test Loss: 0.4191136
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 24 cost time: 1.5315592288970947
Epoch: 24, Steps: 52 | Train Loss: 0.4385330 Vali Loss: 1.3865755 Test Loss: 0.4177057
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 25 cost time: 1.5358247756958008
Epoch: 25, Steps: 52 | Train Loss: 0.4389167 Vali Loss: 1.3816915 Test Loss: 0.4177835
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 26 cost time: 1.5255138874053955
Epoch: 26, Steps: 52 | Train Loss: 0.4382009 Vali Loss: 1.3812433 Test Loss: 0.4164663
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 27 cost time: 1.5249271392822266
Epoch: 27, Steps: 52 | Train Loss: 0.4390671 Vali Loss: 1.3759973 Test Loss: 0.4169408
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 28 cost time: 1.5503883361816406
Epoch: 28, Steps: 52 | Train Loss: 0.4384913 Vali Loss: 1.3776484 Test Loss: 0.4164516
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 29 cost time: 1.5346767902374268
Epoch: 29, Steps: 52 | Train Loss: 0.4377724 Vali Loss: 1.3773868 Test Loss: 0.4156479
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 30 cost time: 1.539682149887085
Epoch: 30, Steps: 52 | Train Loss: 0.4373611 Vali Loss: 1.3695929 Test Loss: 0.4151579
Validation loss decreased (1.374017 --> 1.369593).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 31 cost time: 1.5410377979278564
Epoch: 31, Steps: 52 | Train Loss: 0.4350361 Vali Loss: 1.3767049 Test Loss: 0.4151174
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 32 cost time: 1.5364346504211426
Epoch: 32, Steps: 52 | Train Loss: 0.4370154 Vali Loss: 1.3653672 Test Loss: 0.4154163
Validation loss decreased (1.369593 --> 1.365367).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 33 cost time: 1.5392625331878662
Epoch: 33, Steps: 52 | Train Loss: 0.4344177 Vali Loss: 1.3785349 Test Loss: 0.4130563
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 34 cost time: 1.534426212310791
Epoch: 34, Steps: 52 | Train Loss: 0.4360084 Vali Loss: 1.3771454 Test Loss: 0.4137113
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 35 cost time: 1.5406887531280518
Epoch: 35, Steps: 52 | Train Loss: 0.4337916 Vali Loss: 1.3817284 Test Loss: 0.4149227
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 36 cost time: 1.5350160598754883
Epoch: 36, Steps: 52 | Train Loss: 0.4345159 Vali Loss: 1.3697543 Test Loss: 0.4142893
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 37 cost time: 1.5411019325256348
Epoch: 37, Steps: 52 | Train Loss: 0.4358555 Vali Loss: 1.3780934 Test Loss: 0.4147867
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 38 cost time: 1.5394902229309082
Epoch: 38, Steps: 52 | Train Loss: 0.4342048 Vali Loss: 1.3800781 Test Loss: 0.4135123
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 39 cost time: 1.5403602123260498
Epoch: 39, Steps: 52 | Train Loss: 0.4362409 Vali Loss: 1.3747308 Test Loss: 0.4138554
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 40 cost time: 1.5350816249847412
Epoch: 40, Steps: 52 | Train Loss: 0.4352593 Vali Loss: 1.3702713 Test Loss: 0.4128242
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 41 cost time: 1.5406625270843506
Epoch: 41, Steps: 52 | Train Loss: 0.4356043 Vali Loss: 1.3754309 Test Loss: 0.4127280
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 42 cost time: 1.5377211570739746
Epoch: 42, Steps: 52 | Train Loss: 0.4343200 Vali Loss: 1.3694980 Test Loss: 0.4131583
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 43 cost time: 1.5359742641448975
Epoch: 43, Steps: 52 | Train Loss: 0.4350219 Vali Loss: 1.3713577 Test Loss: 0.4132248
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 44 cost time: 1.5336439609527588
Epoch: 44, Steps: 52 | Train Loss: 0.4343513 Vali Loss: 1.3759584 Test Loss: 0.4128664
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 45 cost time: 1.5291178226470947
Epoch: 45, Steps: 52 | Train Loss: 0.4350425 Vali Loss: 1.3773893 Test Loss: 0.4126679
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 46 cost time: 1.5259380340576172
Epoch: 46, Steps: 52 | Train Loss: 0.4335803 Vali Loss: 1.3666449 Test Loss: 0.4130996
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 47 cost time: 1.531386137008667
Epoch: 47, Steps: 52 | Train Loss: 0.4341593 Vali Loss: 1.3743954 Test Loss: 0.4122826
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 48 cost time: 1.5383937358856201
Epoch: 48, Steps: 52 | Train Loss: 0.4334651 Vali Loss: 1.3776617 Test Loss: 0.4126190
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 49 cost time: 1.5348618030548096
Epoch: 49, Steps: 52 | Train Loss: 0.4356240 Vali Loss: 1.3748806 Test Loss: 0.4127232
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 50 cost time: 1.5357649326324463
Epoch: 50, Steps: 52 | Train Loss: 0.4358277 Vali Loss: 1.3771546 Test Loss: 0.4132993
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 51 cost time: 1.5384104251861572
Epoch: 51, Steps: 52 | Train Loss: 0.4350959 Vali Loss: 1.3634009 Test Loss: 0.4122935
Validation loss decreased (1.365367 --> 1.363401).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 52 cost time: 1.5409255027770996
Epoch: 52, Steps: 52 | Train Loss: 0.4326601 Vali Loss: 1.3707423 Test Loss: 0.4128074
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 53 cost time: 1.537416934967041
Epoch: 53, Steps: 52 | Train Loss: 0.4332899 Vali Loss: 1.3760059 Test Loss: 0.4126458
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 54 cost time: 1.5365595817565918
Epoch: 54, Steps: 52 | Train Loss: 0.4341940 Vali Loss: 1.3699795 Test Loss: 0.4127299
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 55 cost time: 1.5372600555419922
Epoch: 55, Steps: 52 | Train Loss: 0.4343550 Vali Loss: 1.3723903 Test Loss: 0.4125820
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 56 cost time: 1.5430212020874023
Epoch: 56, Steps: 52 | Train Loss: 0.4340034 Vali Loss: 1.3760461 Test Loss: 0.4130534
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 57 cost time: 1.5351355075836182
Epoch: 57, Steps: 52 | Train Loss: 0.4351609 Vali Loss: 1.3733120 Test Loss: 0.4126755
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 58 cost time: 1.5439836978912354
Epoch: 58, Steps: 52 | Train Loss: 0.4346931 Vali Loss: 1.3721558 Test Loss: 0.4113515
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 59 cost time: 1.5361361503601074
Epoch: 59, Steps: 52 | Train Loss: 0.4337707 Vali Loss: 1.3713262 Test Loss: 0.4122243
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 60 cost time: 1.5345041751861572
Epoch: 60, Steps: 52 | Train Loss: 0.4344535 Vali Loss: 1.3698443 Test Loss: 0.4121315
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.4122934639453888, mae:0.4517827332019806, rse:0.5260318517684937
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 1 cost time: 2.1013810634613037
Epoch: 1, Steps: 52 | Train Loss: 0.7020052 Vali Loss: 2.1270471 Test Loss: 1.3692813
Validation loss decreased (inf --> 2.127047).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 2 cost time: 0.7105062007904053
Epoch: 2, Steps: 52 | Train Loss: 0.6014200 Vali Loss: 1.6339381 Test Loss: 0.7822320
Validation loss decreased (2.127047 --> 1.633938).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 3 cost time: 0.7230410575866699
Epoch: 3, Steps: 52 | Train Loss: 0.5019214 Vali Loss: 1.4628611 Test Loss: 0.5223487
Validation loss decreased (1.633938 --> 1.462861).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 4 cost time: 0.7319991588592529
Epoch: 4, Steps: 52 | Train Loss: 0.4655986 Vali Loss: 1.4186163 Test Loss: 0.4548518
Validation loss decreased (1.462861 --> 1.418616).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 5 cost time: 0.694385290145874
Epoch: 5, Steps: 52 | Train Loss: 0.4510740 Vali Loss: 1.3997703 Test Loss: 0.4343597
Validation loss decreased (1.418616 --> 1.399770).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 6 cost time: 1.3840446472167969
Epoch: 6, Steps: 52 | Train Loss: 0.4432514 Vali Loss: 1.3924158 Test Loss: 0.4218986
Validation loss decreased (1.399770 --> 1.392416).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 7 cost time: 1.5805063247680664
Epoch: 7, Steps: 52 | Train Loss: 0.4381282 Vali Loss: 1.3764938 Test Loss: 0.4143906
Validation loss decreased (1.392416 --> 1.376494).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 8 cost time: 1.601905345916748
Epoch: 8, Steps: 52 | Train Loss: 0.4345080 Vali Loss: 1.3680563 Test Loss: 0.4079335
Validation loss decreased (1.376494 --> 1.368056).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 9 cost time: 1.6011664867401123
Epoch: 9, Steps: 52 | Train Loss: 0.4329347 Vali Loss: 1.3618952 Test Loss: 0.4036623
Validation loss decreased (1.368056 --> 1.361895).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 10 cost time: 1.579357624053955
Epoch: 10, Steps: 52 | Train Loss: 0.4298784 Vali Loss: 1.3510487 Test Loss: 0.3995836
Validation loss decreased (1.361895 --> 1.351049).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 11 cost time: 1.596907377243042
Epoch: 11, Steps: 52 | Train Loss: 0.4293754 Vali Loss: 1.3559028 Test Loss: 0.3971172
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 12 cost time: 1.5953898429870605
Epoch: 12, Steps: 52 | Train Loss: 0.4277939 Vali Loss: 1.3545831 Test Loss: 0.3953770
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 13 cost time: 1.6008548736572266
Epoch: 13, Steps: 52 | Train Loss: 0.4250106 Vali Loss: 1.3444058 Test Loss: 0.3930303
Validation loss decreased (1.351049 --> 1.344406).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 14 cost time: 1.5997822284698486
Epoch: 14, Steps: 52 | Train Loss: 0.4250121 Vali Loss: 1.3473215 Test Loss: 0.3905268
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 15 cost time: 1.5982818603515625
Epoch: 15, Steps: 52 | Train Loss: 0.4249426 Vali Loss: 1.3438697 Test Loss: 0.3897837
Validation loss decreased (1.344406 --> 1.343870).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 16 cost time: 1.592146873474121
Epoch: 16, Steps: 52 | Train Loss: 0.4210428 Vali Loss: 1.3427314 Test Loss: 0.3887604
Validation loss decreased (1.343870 --> 1.342731).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 17 cost time: 1.5831913948059082
Epoch: 17, Steps: 52 | Train Loss: 0.4215365 Vali Loss: 1.3366303 Test Loss: 0.3874808
Validation loss decreased (1.342731 --> 1.336630).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 18 cost time: 1.5768156051635742
Epoch: 18, Steps: 52 | Train Loss: 0.4220206 Vali Loss: 1.3361272 Test Loss: 0.3867558
Validation loss decreased (1.336630 --> 1.336127).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 19 cost time: 1.5839259624481201
Epoch: 19, Steps: 52 | Train Loss: 0.4207023 Vali Loss: 1.3443533 Test Loss: 0.3855686
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 20 cost time: 1.579425573348999
Epoch: 20, Steps: 52 | Train Loss: 0.4211743 Vali Loss: 1.3377383 Test Loss: 0.3849189
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 21 cost time: 1.5832738876342773
Epoch: 21, Steps: 52 | Train Loss: 0.4214103 Vali Loss: 1.3414568 Test Loss: 0.3841512
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 22 cost time: 1.5826380252838135
Epoch: 22, Steps: 52 | Train Loss: 0.4222425 Vali Loss: 1.3392920 Test Loss: 0.3842047
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 23 cost time: 1.5807688236236572
Epoch: 23, Steps: 52 | Train Loss: 0.4205232 Vali Loss: 1.3368653 Test Loss: 0.3832516
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 24 cost time: 1.5783436298370361
Epoch: 24, Steps: 52 | Train Loss: 0.4194284 Vali Loss: 1.3335160 Test Loss: 0.3831339
Validation loss decreased (1.336127 --> 1.333516).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 25 cost time: 1.5843918323516846
Epoch: 25, Steps: 52 | Train Loss: 0.4189452 Vali Loss: 1.3284440 Test Loss: 0.3825839
Validation loss decreased (1.333516 --> 1.328444).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 26 cost time: 1.5836691856384277
Epoch: 26, Steps: 52 | Train Loss: 0.4200285 Vali Loss: 1.3341732 Test Loss: 0.3823252
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 27 cost time: 1.5863471031188965
Epoch: 27, Steps: 52 | Train Loss: 0.4190092 Vali Loss: 1.3335698 Test Loss: 0.3815139
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 28 cost time: 1.5852630138397217
Epoch: 28, Steps: 52 | Train Loss: 0.4184011 Vali Loss: 1.3305373 Test Loss: 0.3814218
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 29 cost time: 1.5857388973236084
Epoch: 29, Steps: 52 | Train Loss: 0.4196901 Vali Loss: 1.3337760 Test Loss: 0.3815216
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 30 cost time: 1.586350440979004
Epoch: 30, Steps: 52 | Train Loss: 0.4174376 Vali Loss: 1.3351712 Test Loss: 0.3804544
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 31 cost time: 1.5819189548492432
Epoch: 31, Steps: 52 | Train Loss: 0.4171326 Vali Loss: 1.3322625 Test Loss: 0.3804728
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 32 cost time: 1.5832266807556152
Epoch: 32, Steps: 52 | Train Loss: 0.4181413 Vali Loss: 1.3360512 Test Loss: 0.3805128
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 33 cost time: 1.585937261581421
Epoch: 33, Steps: 52 | Train Loss: 0.4185290 Vali Loss: 1.3313057 Test Loss: 0.3807855
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 34 cost time: 1.5852394104003906
Epoch: 34, Steps: 52 | Train Loss: 0.4182465 Vali Loss: 1.3309208 Test Loss: 0.3799184
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 35 cost time: 1.584409475326538
Epoch: 35, Steps: 52 | Train Loss: 0.4186800 Vali Loss: 1.3286424 Test Loss: 0.3804185
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 36 cost time: 1.58717679977417
Epoch: 36, Steps: 52 | Train Loss: 0.4177795 Vali Loss: 1.3309293 Test Loss: 0.3797922
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 37 cost time: 1.5814380645751953
Epoch: 37, Steps: 52 | Train Loss: 0.4160686 Vali Loss: 1.3274333 Test Loss: 0.3802735
Validation loss decreased (1.328444 --> 1.327433).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 38 cost time: 1.5818202495574951
Epoch: 38, Steps: 52 | Train Loss: 0.4182686 Vali Loss: 1.3317351 Test Loss: 0.3798618
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 39 cost time: 1.5826225280761719
Epoch: 39, Steps: 52 | Train Loss: 0.4176867 Vali Loss: 1.3366207 Test Loss: 0.3803534
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 40 cost time: 1.5857155323028564
Epoch: 40, Steps: 52 | Train Loss: 0.4186152 Vali Loss: 1.3289754 Test Loss: 0.3801230
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 41 cost time: 1.5844652652740479
Epoch: 41, Steps: 52 | Train Loss: 0.4177245 Vali Loss: 1.3335001 Test Loss: 0.3796124
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 42 cost time: 1.5833616256713867
Epoch: 42, Steps: 52 | Train Loss: 0.4163289 Vali Loss: 1.3280764 Test Loss: 0.3800416
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 43 cost time: 1.5817348957061768
Epoch: 43, Steps: 52 | Train Loss: 0.4181477 Vali Loss: 1.3314896 Test Loss: 0.3793876
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 44 cost time: 1.5823864936828613
Epoch: 44, Steps: 52 | Train Loss: 0.4175646 Vali Loss: 1.3184178 Test Loss: 0.3800500
Validation loss decreased (1.327433 --> 1.318418).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 45 cost time: 1.5836069583892822
Epoch: 45, Steps: 52 | Train Loss: 0.4171882 Vali Loss: 1.3295143 Test Loss: 0.3789441
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 46 cost time: 1.5767498016357422
Epoch: 46, Steps: 52 | Train Loss: 0.4163077 Vali Loss: 1.3339334 Test Loss: 0.3793787
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 47 cost time: 1.582594394683838
Epoch: 47, Steps: 52 | Train Loss: 0.4165402 Vali Loss: 1.3234199 Test Loss: 0.3793810
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 48 cost time: 1.5884218215942383
Epoch: 48, Steps: 52 | Train Loss: 0.4155674 Vali Loss: 1.3302875 Test Loss: 0.3794282
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 49 cost time: 1.5857226848602295
Epoch: 49, Steps: 52 | Train Loss: 0.4150185 Vali Loss: 1.3319714 Test Loss: 0.3794082
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 50 cost time: 1.5795059204101562
Epoch: 50, Steps: 52 | Train Loss: 0.4171460 Vali Loss: 1.3316398 Test Loss: 0.3795544
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 51 cost time: 1.5785467624664307
Epoch: 51, Steps: 52 | Train Loss: 0.4167943 Vali Loss: 1.3268561 Test Loss: 0.3798943
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 52 cost time: 1.5834579467773438
Epoch: 52, Steps: 52 | Train Loss: 0.4170504 Vali Loss: 1.3249187 Test Loss: 0.3792200
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 53 cost time: 1.5752418041229248
Epoch: 53, Steps: 52 | Train Loss: 0.4158204 Vali Loss: 1.3293753 Test Loss: 0.3793101
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 54 cost time: 1.5793936252593994
Epoch: 54, Steps: 52 | Train Loss: 0.4162088 Vali Loss: 1.3254019 Test Loss: 0.3800117
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 55 cost time: 1.5781023502349854
Epoch: 55, Steps: 52 | Train Loss: 0.4178862 Vali Loss: 1.3330417 Test Loss: 0.3805978
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 56 cost time: 1.5783870220184326
Epoch: 56, Steps: 52 | Train Loss: 0.4179066 Vali Loss: 1.3298163 Test Loss: 0.3797028
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 57 cost time: 1.578688383102417
Epoch: 57, Steps: 52 | Train Loss: 0.4164876 Vali Loss: 1.3300800 Test Loss: 0.3794208
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 58 cost time: 1.5810120105743408
Epoch: 58, Steps: 52 | Train Loss: 0.4175343 Vali Loss: 1.3324788 Test Loss: 0.3794847
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 59 cost time: 1.5767135620117188
Epoch: 59, Steps: 52 | Train Loss: 0.4170520 Vali Loss: 1.3327651 Test Loss: 0.3794117
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 60 cost time: 1.5838367938995361
Epoch: 60, Steps: 52 | Train Loss: 0.4171530 Vali Loss: 1.3277004 Test Loss: 0.3791220
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3800499439239502, mae:0.4259223937988281, rse:0.5050439238548279
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05285072326660156 GB
Epoch: 1 cost time: 2.111196517944336
Epoch: 1, Steps: 52 | Train Loss: 0.6853288 Vali Loss: 2.1182327 Test Loss: 1.3545866
Validation loss decreased (inf --> 2.118233).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 2 cost time: 0.7376093864440918
Epoch: 2, Steps: 52 | Train Loss: 0.5823746 Vali Loss: 1.5578423 Test Loss: 0.6574712
Validation loss decreased (2.118233 --> 1.557842).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 3 cost time: 0.7367260456085205
Epoch: 3, Steps: 52 | Train Loss: 0.4804968 Vali Loss: 1.4390560 Test Loss: 0.4696302
Validation loss decreased (1.557842 --> 1.439056).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 4 cost time: 0.7396225929260254
Epoch: 4, Steps: 52 | Train Loss: 0.4556839 Vali Loss: 1.4091048 Test Loss: 0.4376247
Validation loss decreased (1.439056 --> 1.409105).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 5 cost time: 0.7366194725036621
Epoch: 5, Steps: 52 | Train Loss: 0.4454814 Vali Loss: 1.3932574 Test Loss: 0.4211939
Validation loss decreased (1.409105 --> 1.393257).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 6 cost time: 1.62892746925354
Epoch: 6, Steps: 52 | Train Loss: 0.4388602 Vali Loss: 1.3792082 Test Loss: 0.4123213
Validation loss decreased (1.393257 --> 1.379208).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 7 cost time: 1.6388208866119385
Epoch: 7, Steps: 52 | Train Loss: 0.4342766 Vali Loss: 1.3743120 Test Loss: 0.4079517
Validation loss decreased (1.379208 --> 1.374312).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 8 cost time: 1.6512699127197266
Epoch: 8, Steps: 52 | Train Loss: 0.4320915 Vali Loss: 1.3668787 Test Loss: 0.4030228
Validation loss decreased (1.374312 --> 1.366879).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 9 cost time: 1.6409223079681396
Epoch: 9, Steps: 52 | Train Loss: 0.4287234 Vali Loss: 1.3660336 Test Loss: 0.3999555
Validation loss decreased (1.366879 --> 1.366034).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 10 cost time: 1.6627390384674072
Epoch: 10, Steps: 52 | Train Loss: 0.4285679 Vali Loss: 1.3515377 Test Loss: 0.3953891
Validation loss decreased (1.366034 --> 1.351538).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 11 cost time: 1.6605777740478516
Epoch: 11, Steps: 52 | Train Loss: 0.4248025 Vali Loss: 1.3472353 Test Loss: 0.3937938
Validation loss decreased (1.351538 --> 1.347235).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 12 cost time: 1.645561933517456
Epoch: 12, Steps: 52 | Train Loss: 0.4246719 Vali Loss: 1.3462968 Test Loss: 0.3917873
Validation loss decreased (1.347235 --> 1.346297).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 13 cost time: 1.6640496253967285
Epoch: 13, Steps: 52 | Train Loss: 0.4218403 Vali Loss: 1.3444312 Test Loss: 0.3897330
Validation loss decreased (1.346297 --> 1.344431).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 14 cost time: 1.6462442874908447
Epoch: 14, Steps: 52 | Train Loss: 0.4233182 Vali Loss: 1.3472880 Test Loss: 0.3885610
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 15 cost time: 1.6372959613800049
Epoch: 15, Steps: 52 | Train Loss: 0.4217737 Vali Loss: 1.3404455 Test Loss: 0.3874150
Validation loss decreased (1.344431 --> 1.340446).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 16 cost time: 1.664292573928833
Epoch: 16, Steps: 52 | Train Loss: 0.4201592 Vali Loss: 1.3324903 Test Loss: 0.3861516
Validation loss decreased (1.340446 --> 1.332490).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 17 cost time: 1.6363976001739502
Epoch: 17, Steps: 52 | Train Loss: 0.4210185 Vali Loss: 1.3379083 Test Loss: 0.3850876
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 18 cost time: 1.6404993534088135
Epoch: 18, Steps: 52 | Train Loss: 0.4186542 Vali Loss: 1.3346654 Test Loss: 0.3852740
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 19 cost time: 1.6675267219543457
Epoch: 19, Steps: 52 | Train Loss: 0.4194066 Vali Loss: 1.3297913 Test Loss: 0.3833929
Validation loss decreased (1.332490 --> 1.329791).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 20 cost time: 1.6461288928985596
Epoch: 20, Steps: 52 | Train Loss: 0.4177670 Vali Loss: 1.3309602 Test Loss: 0.3824544
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 21 cost time: 1.6608684062957764
Epoch: 21, Steps: 52 | Train Loss: 0.4192153 Vali Loss: 1.3327630 Test Loss: 0.3826098
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 22 cost time: 1.6511664390563965
Epoch: 22, Steps: 52 | Train Loss: 0.4182937 Vali Loss: 1.3383070 Test Loss: 0.3822857
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 23 cost time: 1.6414620876312256
Epoch: 23, Steps: 52 | Train Loss: 0.4167741 Vali Loss: 1.3273007 Test Loss: 0.3823183
Validation loss decreased (1.329791 --> 1.327301).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 24 cost time: 1.665358304977417
Epoch: 24, Steps: 52 | Train Loss: 0.4152734 Vali Loss: 1.3315947 Test Loss: 0.3811322
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 25 cost time: 1.6568152904510498
Epoch: 25, Steps: 52 | Train Loss: 0.4188649 Vali Loss: 1.3329604 Test Loss: 0.3809001
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 26 cost time: 1.6424591541290283
Epoch: 26, Steps: 52 | Train Loss: 0.4177679 Vali Loss: 1.3302424 Test Loss: 0.3807296
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 27 cost time: 1.6592717170715332
Epoch: 27, Steps: 52 | Train Loss: 0.4178414 Vali Loss: 1.3245852 Test Loss: 0.3799881
Validation loss decreased (1.327301 --> 1.324585).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 28 cost time: 1.648775339126587
Epoch: 28, Steps: 52 | Train Loss: 0.4175021 Vali Loss: 1.3293102 Test Loss: 0.3799438
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 29 cost time: 1.668818473815918
Epoch: 29, Steps: 52 | Train Loss: 0.4164732 Vali Loss: 1.3329877 Test Loss: 0.3798785
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 30 cost time: 1.6445467472076416
Epoch: 30, Steps: 52 | Train Loss: 0.4165191 Vali Loss: 1.3328612 Test Loss: 0.3792427
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 31 cost time: 1.6633586883544922
Epoch: 31, Steps: 52 | Train Loss: 0.4164602 Vali Loss: 1.3330984 Test Loss: 0.3792520
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 32 cost time: 1.6509056091308594
Epoch: 32, Steps: 52 | Train Loss: 0.4161427 Vali Loss: 1.3326571 Test Loss: 0.3797734
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 33 cost time: 1.6327898502349854
Epoch: 33, Steps: 52 | Train Loss: 0.4159902 Vali Loss: 1.3338714 Test Loss: 0.3789400
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 34 cost time: 1.665602684020996
Epoch: 34, Steps: 52 | Train Loss: 0.4157059 Vali Loss: 1.3246784 Test Loss: 0.3786949
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 35 cost time: 1.6401190757751465
Epoch: 35, Steps: 52 | Train Loss: 0.4172032 Vali Loss: 1.3345813 Test Loss: 0.3789427
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 36 cost time: 1.6633524894714355
Epoch: 36, Steps: 52 | Train Loss: 0.4158817 Vali Loss: 1.3277860 Test Loss: 0.3787996
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 37 cost time: 1.636366367340088
Epoch: 37, Steps: 52 | Train Loss: 0.4145553 Vali Loss: 1.3338959 Test Loss: 0.3784229
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 38 cost time: 1.6624557971954346
Epoch: 38, Steps: 52 | Train Loss: 0.4176781 Vali Loss: 1.3309948 Test Loss: 0.3789020
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 39 cost time: 1.6455068588256836
Epoch: 39, Steps: 52 | Train Loss: 0.4156298 Vali Loss: 1.3106124 Test Loss: 0.3788052
Validation loss decreased (1.324585 --> 1.310612).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 40 cost time: 1.662024736404419
Epoch: 40, Steps: 52 | Train Loss: 0.4167208 Vali Loss: 1.3229097 Test Loss: 0.3780195
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 41 cost time: 1.6471328735351562
Epoch: 41, Steps: 52 | Train Loss: 0.4152699 Vali Loss: 1.3234553 Test Loss: 0.3783734
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 42 cost time: 1.6413004398345947
Epoch: 42, Steps: 52 | Train Loss: 0.4159939 Vali Loss: 1.3324665 Test Loss: 0.3778438
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 43 cost time: 1.6483676433563232
Epoch: 43, Steps: 52 | Train Loss: 0.4167545 Vali Loss: 1.3216391 Test Loss: 0.3784666
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 44 cost time: 1.6665494441986084
Epoch: 44, Steps: 52 | Train Loss: 0.4146063 Vali Loss: 1.3273195 Test Loss: 0.3779212
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 45 cost time: 1.6418709754943848
Epoch: 45, Steps: 52 | Train Loss: 0.4154898 Vali Loss: 1.3254099 Test Loss: 0.3778017
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 46 cost time: 1.6702640056610107
Epoch: 46, Steps: 52 | Train Loss: 0.4155331 Vali Loss: 1.3309623 Test Loss: 0.3783274
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 47 cost time: 1.634359359741211
Epoch: 47, Steps: 52 | Train Loss: 0.4167103 Vali Loss: 1.3229468 Test Loss: 0.3779756
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 48 cost time: 1.6660611629486084
Epoch: 48, Steps: 52 | Train Loss: 0.4152915 Vali Loss: 1.3192067 Test Loss: 0.3776576
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 49 cost time: 1.63993501663208
Epoch: 49, Steps: 52 | Train Loss: 0.4155318 Vali Loss: 1.3293544 Test Loss: 0.3782040
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 50 cost time: 1.6584067344665527
Epoch: 50, Steps: 52 | Train Loss: 0.4161879 Vali Loss: 1.3282616 Test Loss: 0.3779563
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 51 cost time: 1.6363978385925293
Epoch: 51, Steps: 52 | Train Loss: 0.4161899 Vali Loss: 1.3280948 Test Loss: 0.3775955
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 52 cost time: 1.6570103168487549
Epoch: 52, Steps: 52 | Train Loss: 0.4156285 Vali Loss: 1.3243219 Test Loss: 0.3784117
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 53 cost time: 1.642935037612915
Epoch: 53, Steps: 52 | Train Loss: 0.4162794 Vali Loss: 1.3321884 Test Loss: 0.3780988
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 54 cost time: 1.6629528999328613
Epoch: 54, Steps: 52 | Train Loss: 0.4153233 Vali Loss: 1.3303974 Test Loss: 0.3780353
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 55 cost time: 1.642103910446167
Epoch: 55, Steps: 52 | Train Loss: 0.4163095 Vali Loss: 1.3296081 Test Loss: 0.3774402
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 56 cost time: 1.6411871910095215
Epoch: 56, Steps: 52 | Train Loss: 0.4167815 Vali Loss: 1.3227792 Test Loss: 0.3777556
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 57 cost time: 1.6559112071990967
Epoch: 57, Steps: 52 | Train Loss: 0.4158417 Vali Loss: 1.3265567 Test Loss: 0.3776604
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 58 cost time: 1.6606738567352295
Epoch: 58, Steps: 52 | Train Loss: 0.4142612 Vali Loss: 1.3316823 Test Loss: 0.3780298
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 59 cost time: 1.6450307369232178
Epoch: 59, Steps: 52 | Train Loss: 0.4169003 Vali Loss: 1.3311889 Test Loss: 0.3781223
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 60 cost time: 1.6639504432678223
Epoch: 60, Steps: 52 | Train Loss: 0.4164901 Vali Loss: 1.3284934 Test Loss: 0.3780068
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3788052499294281, mae:0.42509329319000244, rse:0.504216194152832
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04572486877441406 GB
Epoch: 1 cost time: 2.0549232959747314
Epoch: 1, Steps: 52 | Train Loss: 0.7596287 Vali Loss: 2.2058759 Test Loss: 1.4287329
Validation loss decreased (inf --> 2.205876).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 2 cost time: 0.6930005550384521
Epoch: 2, Steps: 52 | Train Loss: 0.7048799 Vali Loss: 1.9403253 Test Loss: 1.1419904
Validation loss decreased (2.205876 --> 1.940325).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 3 cost time: 0.6923480033874512
Epoch: 3, Steps: 52 | Train Loss: 0.6315039 Vali Loss: 1.7823288 Test Loss: 0.9480860
Validation loss decreased (1.940325 --> 1.782329).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 4 cost time: 0.6914501190185547
Epoch: 4, Steps: 52 | Train Loss: 0.5745270 Vali Loss: 1.6399940 Test Loss: 0.7668978
Validation loss decreased (1.782329 --> 1.639994).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 5 cost time: 0.6920003890991211
Epoch: 5, Steps: 52 | Train Loss: 0.5317414 Vali Loss: 1.5510100 Test Loss: 0.6352579
Validation loss decreased (1.639994 --> 1.551010).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 6 cost time: 1.0968201160430908
Epoch: 6, Steps: 52 | Train Loss: 0.5007630 Vali Loss: 1.4978076 Test Loss: 0.5571090
Validation loss decreased (1.551010 --> 1.497808).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 7 cost time: 1.54298996925354
Epoch: 7, Steps: 52 | Train Loss: 0.4828023 Vali Loss: 1.4547988 Test Loss: 0.5109636
Validation loss decreased (1.497808 --> 1.454799).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 8 cost time: 1.5453417301177979
Epoch: 8, Steps: 52 | Train Loss: 0.4717084 Vali Loss: 1.4436042 Test Loss: 0.4811628
Validation loss decreased (1.454799 --> 1.443604).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 9 cost time: 1.5516650676727295
Epoch: 9, Steps: 52 | Train Loss: 0.4619978 Vali Loss: 1.4282353 Test Loss: 0.4620722
Validation loss decreased (1.443604 --> 1.428235).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 10 cost time: 1.5563478469848633
Epoch: 10, Steps: 52 | Train Loss: 0.4553568 Vali Loss: 1.4118187 Test Loss: 0.4501019
Validation loss decreased (1.428235 --> 1.411819).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 11 cost time: 1.552579641342163
Epoch: 11, Steps: 52 | Train Loss: 0.4502873 Vali Loss: 1.4160368 Test Loss: 0.4413238
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 12 cost time: 1.5548088550567627
Epoch: 12, Steps: 52 | Train Loss: 0.4471261 Vali Loss: 1.4096011 Test Loss: 0.4342892
Validation loss decreased (1.411819 --> 1.409601).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 13 cost time: 1.5526554584503174
Epoch: 13, Steps: 52 | Train Loss: 0.4450638 Vali Loss: 1.4029366 Test Loss: 0.4293857
Validation loss decreased (1.409601 --> 1.402937).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 14 cost time: 1.5531222820281982
Epoch: 14, Steps: 52 | Train Loss: 0.4441283 Vali Loss: 1.3959317 Test Loss: 0.4271909
Validation loss decreased (1.402937 --> 1.395932).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 15 cost time: 1.549919605255127
Epoch: 15, Steps: 52 | Train Loss: 0.4401039 Vali Loss: 1.3944423 Test Loss: 0.4227816
Validation loss decreased (1.395932 --> 1.394442).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 16 cost time: 1.5503654479980469
Epoch: 16, Steps: 52 | Train Loss: 0.4376410 Vali Loss: 1.3828647 Test Loss: 0.4196284
Validation loss decreased (1.394442 --> 1.382865).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 17 cost time: 1.558077096939087
Epoch: 17, Steps: 52 | Train Loss: 0.4387169 Vali Loss: 1.3905481 Test Loss: 0.4173262
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 18 cost time: 1.557499885559082
Epoch: 18, Steps: 52 | Train Loss: 0.4350360 Vali Loss: 1.3875722 Test Loss: 0.4168836
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 19 cost time: 1.5594463348388672
Epoch: 19, Steps: 52 | Train Loss: 0.4346947 Vali Loss: 1.3787107 Test Loss: 0.4139095
Validation loss decreased (1.382865 --> 1.378711).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 20 cost time: 1.5542523860931396
Epoch: 20, Steps: 52 | Train Loss: 0.4333449 Vali Loss: 1.3881264 Test Loss: 0.4137784
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 21 cost time: 1.5601739883422852
Epoch: 21, Steps: 52 | Train Loss: 0.4324657 Vali Loss: 1.3757354 Test Loss: 0.4120002
Validation loss decreased (1.378711 --> 1.375735).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 22 cost time: 1.5514400005340576
Epoch: 22, Steps: 52 | Train Loss: 0.4326588 Vali Loss: 1.3790330 Test Loss: 0.4118432
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 23 cost time: 1.5575511455535889
Epoch: 23, Steps: 52 | Train Loss: 0.4317051 Vali Loss: 1.3839630 Test Loss: 0.4110410
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 24 cost time: 1.5517172813415527
Epoch: 24, Steps: 52 | Train Loss: 0.4299783 Vali Loss: 1.3699119 Test Loss: 0.4099951
Validation loss decreased (1.375735 --> 1.369912).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 25 cost time: 1.554084062576294
Epoch: 25, Steps: 52 | Train Loss: 0.4327774 Vali Loss: 1.3723555 Test Loss: 0.4085901
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 26 cost time: 1.5553014278411865
Epoch: 26, Steps: 52 | Train Loss: 0.4307645 Vali Loss: 1.3818512 Test Loss: 0.4087981
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 27 cost time: 1.5560827255249023
Epoch: 27, Steps: 52 | Train Loss: 0.4305683 Vali Loss: 1.3782128 Test Loss: 0.4081992
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 28 cost time: 1.5543224811553955
Epoch: 28, Steps: 52 | Train Loss: 0.4306325 Vali Loss: 1.3789099 Test Loss: 0.4077792
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 29 cost time: 1.5557518005371094
Epoch: 29, Steps: 52 | Train Loss: 0.4286271 Vali Loss: 1.3731194 Test Loss: 0.4070784
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 30 cost time: 1.5550198554992676
Epoch: 30, Steps: 52 | Train Loss: 0.4301173 Vali Loss: 1.3654253 Test Loss: 0.4076483
Validation loss decreased (1.369912 --> 1.365425).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 31 cost time: 1.555800199508667
Epoch: 31, Steps: 52 | Train Loss: 0.4295885 Vali Loss: 1.3705214 Test Loss: 0.4060901
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 32 cost time: 1.555471420288086
Epoch: 32, Steps: 52 | Train Loss: 0.4299051 Vali Loss: 1.3710144 Test Loss: 0.4063625
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 33 cost time: 1.5517871379852295
Epoch: 33, Steps: 52 | Train Loss: 0.4281516 Vali Loss: 1.3709649 Test Loss: 0.4062068
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 34 cost time: 1.5483214855194092
Epoch: 34, Steps: 52 | Train Loss: 0.4296220 Vali Loss: 1.3710921 Test Loss: 0.4056104
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 35 cost time: 1.5464723110198975
Epoch: 35, Steps: 52 | Train Loss: 0.4284314 Vali Loss: 1.3782709 Test Loss: 0.4057122
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 36 cost time: 1.545074701309204
Epoch: 36, Steps: 52 | Train Loss: 0.4278713 Vali Loss: 1.3772798 Test Loss: 0.4058673
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 37 cost time: 1.5478451251983643
Epoch: 37, Steps: 52 | Train Loss: 0.4284491 Vali Loss: 1.3644707 Test Loss: 0.4050531
Validation loss decreased (1.365425 --> 1.364471).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 38 cost time: 1.5563833713531494
Epoch: 38, Steps: 52 | Train Loss: 0.4285898 Vali Loss: 1.3666091 Test Loss: 0.4055895
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 39 cost time: 1.5555119514465332
Epoch: 39, Steps: 52 | Train Loss: 0.4284250 Vali Loss: 1.3740189 Test Loss: 0.4056957
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 40 cost time: 1.554842472076416
Epoch: 40, Steps: 52 | Train Loss: 0.4286899 Vali Loss: 1.3643315 Test Loss: 0.4061426
Validation loss decreased (1.364471 --> 1.364331).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 41 cost time: 1.555586576461792
Epoch: 41, Steps: 52 | Train Loss: 0.4267749 Vali Loss: 1.3746486 Test Loss: 0.4040209
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 42 cost time: 1.5544352531433105
Epoch: 42, Steps: 52 | Train Loss: 0.4280987 Vali Loss: 1.3643914 Test Loss: 0.4044238
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 43 cost time: 1.5528364181518555
Epoch: 43, Steps: 52 | Train Loss: 0.4279431 Vali Loss: 1.3718033 Test Loss: 0.4057962
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 44 cost time: 1.561553955078125
Epoch: 44, Steps: 52 | Train Loss: 0.4286361 Vali Loss: 1.3747094 Test Loss: 0.4042338
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 45 cost time: 1.555727243423462
Epoch: 45, Steps: 52 | Train Loss: 0.4292853 Vali Loss: 1.3664732 Test Loss: 0.4049658
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 46 cost time: 1.5552148818969727
Epoch: 46, Steps: 52 | Train Loss: 0.4271350 Vali Loss: 1.3623821 Test Loss: 0.4051047
Validation loss decreased (1.364331 --> 1.362382).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 47 cost time: 1.5513238906860352
Epoch: 47, Steps: 52 | Train Loss: 0.4288374 Vali Loss: 1.3694862 Test Loss: 0.4046224
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 48 cost time: 1.5570275783538818
Epoch: 48, Steps: 52 | Train Loss: 0.4277506 Vali Loss: 1.3732828 Test Loss: 0.4040804
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 49 cost time: 1.5541701316833496
Epoch: 49, Steps: 52 | Train Loss: 0.4257103 Vali Loss: 1.3725815 Test Loss: 0.4047480
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 50 cost time: 1.5524156093597412
Epoch: 50, Steps: 52 | Train Loss: 0.4280691 Vali Loss: 1.3647168 Test Loss: 0.4041054
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 51 cost time: 1.5499775409698486
Epoch: 51, Steps: 52 | Train Loss: 0.4263006 Vali Loss: 1.3655720 Test Loss: 0.4037820
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 52 cost time: 1.5548985004425049
Epoch: 52, Steps: 52 | Train Loss: 0.4275224 Vali Loss: 1.3634003 Test Loss: 0.4040557
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 53 cost time: 1.5540170669555664
Epoch: 53, Steps: 52 | Train Loss: 0.4268816 Vali Loss: 1.3661100 Test Loss: 0.4038666
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 54 cost time: 1.5490093231201172
Epoch: 54, Steps: 52 | Train Loss: 0.4267780 Vali Loss: 1.3730648 Test Loss: 0.4033962
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 55 cost time: 1.554995059967041
Epoch: 55, Steps: 52 | Train Loss: 0.4268194 Vali Loss: 1.3671023 Test Loss: 0.4040481
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 56 cost time: 1.5594217777252197
Epoch: 56, Steps: 52 | Train Loss: 0.4259359 Vali Loss: 1.3677306 Test Loss: 0.4040461
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 57 cost time: 1.5539207458496094
Epoch: 57, Steps: 52 | Train Loss: 0.4270041 Vali Loss: 1.3736465 Test Loss: 0.4034897
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 58 cost time: 1.5539796352386475
Epoch: 58, Steps: 52 | Train Loss: 0.4278053 Vali Loss: 1.3626429 Test Loss: 0.4042222
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 59 cost time: 1.5504136085510254
Epoch: 59, Steps: 52 | Train Loss: 0.4263360 Vali Loss: 1.3717865 Test Loss: 0.4044330
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 60 cost time: 1.5493614673614502
Epoch: 60, Steps: 52 | Train Loss: 0.4276949 Vali Loss: 1.3738880 Test Loss: 0.4039298
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.40510472655296326, mae:0.44488534331321716, rse:0.521425724029541
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 1 cost time: 2.0731074810028076
Epoch: 1, Steps: 52 | Train Loss: 0.7062872 Vali Loss: 2.1364942 Test Loss: 1.3765990
Validation loss decreased (inf --> 2.136494).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 2 cost time: 0.7206130027770996
Epoch: 2, Steps: 52 | Train Loss: 0.6096938 Vali Loss: 1.6625050 Test Loss: 0.8070419
Validation loss decreased (2.136494 --> 1.662505).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 3 cost time: 0.7204501628875732
Epoch: 3, Steps: 52 | Train Loss: 0.4949262 Vali Loss: 1.4323413 Test Loss: 0.4773409
Validation loss decreased (1.662505 --> 1.432341).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 4 cost time: 0.7160537242889404
Epoch: 4, Steps: 52 | Train Loss: 0.4533341 Vali Loss: 1.3950222 Test Loss: 0.4211466
Validation loss decreased (1.432341 --> 1.395022).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 5 cost time: 0.7140002250671387
Epoch: 5, Steps: 52 | Train Loss: 0.4412460 Vali Loss: 1.3707887 Test Loss: 0.4125884
Validation loss decreased (1.395022 --> 1.370789).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 6 cost time: 1.4181644916534424
Epoch: 6, Steps: 52 | Train Loss: 0.4333852 Vali Loss: 1.3704575 Test Loss: 0.4028587
Validation loss decreased (1.370789 --> 1.370458).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 7 cost time: 1.601017713546753
Epoch: 7, Steps: 52 | Train Loss: 0.4301451 Vali Loss: 1.3647561 Test Loss: 0.3981141
Validation loss decreased (1.370458 --> 1.364756).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 8 cost time: 1.6196224689483643
Epoch: 8, Steps: 52 | Train Loss: 0.4276753 Vali Loss: 1.3642368 Test Loss: 0.3931492
Validation loss decreased (1.364756 --> 1.364237).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 9 cost time: 1.618621826171875
Epoch: 9, Steps: 52 | Train Loss: 0.4237092 Vali Loss: 1.3576295 Test Loss: 0.3897334
Validation loss decreased (1.364237 --> 1.357630).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 10 cost time: 1.6145780086517334
Epoch: 10, Steps: 52 | Train Loss: 0.4220181 Vali Loss: 1.3456392 Test Loss: 0.3867408
Validation loss decreased (1.357630 --> 1.345639).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 11 cost time: 1.61724853515625
Epoch: 11, Steps: 52 | Train Loss: 0.4216524 Vali Loss: 1.3461183 Test Loss: 0.3842672
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 12 cost time: 1.6116907596588135
Epoch: 12, Steps: 52 | Train Loss: 0.4196381 Vali Loss: 1.3419518 Test Loss: 0.3826644
Validation loss decreased (1.345639 --> 1.341952).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 13 cost time: 1.6016037464141846
Epoch: 13, Steps: 52 | Train Loss: 0.4187522 Vali Loss: 1.3398499 Test Loss: 0.3801793
Validation loss decreased (1.341952 --> 1.339850).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 14 cost time: 1.6158020496368408
Epoch: 14, Steps: 52 | Train Loss: 0.4178320 Vali Loss: 1.3440188 Test Loss: 0.3796857
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 15 cost time: 1.6160781383514404
Epoch: 15, Steps: 52 | Train Loss: 0.4170364 Vali Loss: 1.3371398 Test Loss: 0.3783947
Validation loss decreased (1.339850 --> 1.337140).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 16 cost time: 1.6104626655578613
Epoch: 16, Steps: 52 | Train Loss: 0.4165995 Vali Loss: 1.3270868 Test Loss: 0.3770648
Validation loss decreased (1.337140 --> 1.327087).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 17 cost time: 1.6022496223449707
Epoch: 17, Steps: 52 | Train Loss: 0.4170074 Vali Loss: 1.3328221 Test Loss: 0.3760867
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 18 cost time: 1.600250005722046
Epoch: 18, Steps: 52 | Train Loss: 0.4143712 Vali Loss: 1.3314579 Test Loss: 0.3752958
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 19 cost time: 1.6068384647369385
Epoch: 19, Steps: 52 | Train Loss: 0.4144371 Vali Loss: 1.3336759 Test Loss: 0.3745503
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 20 cost time: 1.6003773212432861
Epoch: 20, Steps: 52 | Train Loss: 0.4136010 Vali Loss: 1.3268992 Test Loss: 0.3734597
Validation loss decreased (1.327087 --> 1.326899).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 21 cost time: 1.6018574237823486
Epoch: 21, Steps: 52 | Train Loss: 0.4147359 Vali Loss: 1.3315712 Test Loss: 0.3734378
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 22 cost time: 1.601639747619629
Epoch: 22, Steps: 52 | Train Loss: 0.4138321 Vali Loss: 1.3269758 Test Loss: 0.3725690
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 23 cost time: 1.6083197593688965
Epoch: 23, Steps: 52 | Train Loss: 0.4128167 Vali Loss: 1.3261585 Test Loss: 0.3722260
Validation loss decreased (1.326899 --> 1.326159).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 24 cost time: 1.6116578578948975
Epoch: 24, Steps: 52 | Train Loss: 0.4129995 Vali Loss: 1.3262962 Test Loss: 0.3718069
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 25 cost time: 1.6122803688049316
Epoch: 25, Steps: 52 | Train Loss: 0.4131043 Vali Loss: 1.3266090 Test Loss: 0.3713126
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 26 cost time: 1.597519874572754
Epoch: 26, Steps: 52 | Train Loss: 0.4123993 Vali Loss: 1.3250101 Test Loss: 0.3713925
Validation loss decreased (1.326159 --> 1.325010).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 27 cost time: 1.6036055088043213
Epoch: 27, Steps: 52 | Train Loss: 0.4116098 Vali Loss: 1.3241013 Test Loss: 0.3712730
Validation loss decreased (1.325010 --> 1.324101).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 28 cost time: 1.6046218872070312
Epoch: 28, Steps: 52 | Train Loss: 0.4134031 Vali Loss: 1.3252139 Test Loss: 0.3714091
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 29 cost time: 1.5981369018554688
Epoch: 29, Steps: 52 | Train Loss: 0.4139806 Vali Loss: 1.3250630 Test Loss: 0.3714223
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 30 cost time: 1.6148111820220947
Epoch: 30, Steps: 52 | Train Loss: 0.4126094 Vali Loss: 1.3160022 Test Loss: 0.3708729
Validation loss decreased (1.324101 --> 1.316002).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 31 cost time: 1.6140761375427246
Epoch: 31, Steps: 52 | Train Loss: 0.4111586 Vali Loss: 1.3236418 Test Loss: 0.3709401
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 32 cost time: 1.5937707424163818
Epoch: 32, Steps: 52 | Train Loss: 0.4103588 Vali Loss: 1.3196472 Test Loss: 0.3704215
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 33 cost time: 1.614452600479126
Epoch: 33, Steps: 52 | Train Loss: 0.4117736 Vali Loss: 1.3152628 Test Loss: 0.3706578
Validation loss decreased (1.316002 --> 1.315263).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 34 cost time: 1.6111700534820557
Epoch: 34, Steps: 52 | Train Loss: 0.4113186 Vali Loss: 1.3148670 Test Loss: 0.3701041
Validation loss decreased (1.315263 --> 1.314867).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 35 cost time: 1.5970942974090576
Epoch: 35, Steps: 52 | Train Loss: 0.4110755 Vali Loss: 1.3225279 Test Loss: 0.3703323
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 36 cost time: 1.6172890663146973
Epoch: 36, Steps: 52 | Train Loss: 0.4111843 Vali Loss: 1.3156507 Test Loss: 0.3700836
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 37 cost time: 1.621384620666504
Epoch: 37, Steps: 52 | Train Loss: 0.4096462 Vali Loss: 1.3205371 Test Loss: 0.3702427
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 38 cost time: 1.5989091396331787
Epoch: 38, Steps: 52 | Train Loss: 0.4106119 Vali Loss: 1.3274148 Test Loss: 0.3701614
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 39 cost time: 1.6204257011413574
Epoch: 39, Steps: 52 | Train Loss: 0.4108383 Vali Loss: 1.3168340 Test Loss: 0.3698242
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 40 cost time: 1.6194348335266113
Epoch: 40, Steps: 52 | Train Loss: 0.4116229 Vali Loss: 1.3180971 Test Loss: 0.3698503
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 41 cost time: 1.6024858951568604
Epoch: 41, Steps: 52 | Train Loss: 0.4107550 Vali Loss: 1.3268068 Test Loss: 0.3697281
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 42 cost time: 1.6158688068389893
Epoch: 42, Steps: 52 | Train Loss: 0.4118174 Vali Loss: 1.3183148 Test Loss: 0.3699545
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 43 cost time: 1.6214520931243896
Epoch: 43, Steps: 52 | Train Loss: 0.4106740 Vali Loss: 1.3235101 Test Loss: 0.3695694
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 44 cost time: 1.5975453853607178
Epoch: 44, Steps: 52 | Train Loss: 0.4108970 Vali Loss: 1.3260324 Test Loss: 0.3696755
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 45 cost time: 1.6215932369232178
Epoch: 45, Steps: 52 | Train Loss: 0.4105656 Vali Loss: 1.3207104 Test Loss: 0.3698279
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 46 cost time: 1.6110093593597412
Epoch: 46, Steps: 52 | Train Loss: 0.4092111 Vali Loss: 1.3238521 Test Loss: 0.3693784
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 47 cost time: 1.6024606227874756
Epoch: 47, Steps: 52 | Train Loss: 0.4107403 Vali Loss: 1.3221281 Test Loss: 0.3695201
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 48 cost time: 1.6134731769561768
Epoch: 48, Steps: 52 | Train Loss: 0.4109364 Vali Loss: 1.3153327 Test Loss: 0.3694520
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 49 cost time: 1.6179556846618652
Epoch: 49, Steps: 52 | Train Loss: 0.4088766 Vali Loss: 1.3205044 Test Loss: 0.3695581
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 50 cost time: 1.5969319343566895
Epoch: 50, Steps: 52 | Train Loss: 0.4099285 Vali Loss: 1.3130062 Test Loss: 0.3697713
Validation loss decreased (1.314867 --> 1.313006).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 51 cost time: 1.613877296447754
Epoch: 51, Steps: 52 | Train Loss: 0.4117335 Vali Loss: 1.3276300 Test Loss: 0.3696291
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 52 cost time: 1.6124067306518555
Epoch: 52, Steps: 52 | Train Loss: 0.4095255 Vali Loss: 1.3186715 Test Loss: 0.3693515
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 53 cost time: 1.598205804824829
Epoch: 53, Steps: 52 | Train Loss: 0.4101855 Vali Loss: 1.3195223 Test Loss: 0.3698812
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 54 cost time: 1.610213279724121
Epoch: 54, Steps: 52 | Train Loss: 0.4107690 Vali Loss: 1.3153323 Test Loss: 0.3697356
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 55 cost time: 1.6191799640655518
Epoch: 55, Steps: 52 | Train Loss: 0.4114259 Vali Loss: 1.3148896 Test Loss: 0.3691901
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 56 cost time: 1.595731258392334
Epoch: 56, Steps: 52 | Train Loss: 0.4109533 Vali Loss: 1.3177185 Test Loss: 0.3694482
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 57 cost time: 1.617638111114502
Epoch: 57, Steps: 52 | Train Loss: 0.4097859 Vali Loss: 1.3241661 Test Loss: 0.3696637
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 58 cost time: 1.614767074584961
Epoch: 58, Steps: 52 | Train Loss: 0.4108603 Vali Loss: 1.3242384 Test Loss: 0.3694996
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 59 cost time: 1.5948779582977295
Epoch: 59, Steps: 52 | Train Loss: 0.4109850 Vali Loss: 1.3234532 Test Loss: 0.3692294
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 60 cost time: 1.5952579975128174
Epoch: 60, Steps: 52 | Train Loss: 0.4099532 Vali Loss: 1.3247230 Test Loss: 0.3694051
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.369771271944046, mae:0.41561853885650635, rse:0.4981675148010254
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05301189422607422 GB
Epoch: 1 cost time: 2.1007020473480225
Epoch: 1, Steps: 52 | Train Loss: 0.6842644 Vali Loss: 2.0959892 Test Loss: 1.3507161
Validation loss decreased (inf --> 2.095989).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 2 cost time: 0.7487986087799072
Epoch: 2, Steps: 52 | Train Loss: 0.5872868 Vali Loss: 1.5775529 Test Loss: 0.6947387
Validation loss decreased (2.095989 --> 1.577553).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 3 cost time: 0.7547104358673096
Epoch: 3, Steps: 52 | Train Loss: 0.4728603 Vali Loss: 1.3907862 Test Loss: 0.4294809
Validation loss decreased (1.577553 --> 1.390786).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 4 cost time: 0.7551047801971436
Epoch: 4, Steps: 52 | Train Loss: 0.4454172 Vali Loss: 1.3874228 Test Loss: 0.4176899
Validation loss decreased (1.390786 --> 1.387423).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 5 cost time: 0.7563884258270264
Epoch: 5, Steps: 52 | Train Loss: 0.4340829 Vali Loss: 1.3661263 Test Loss: 0.4061367
Validation loss decreased (1.387423 --> 1.366126).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 6 cost time: 1.6463146209716797
Epoch: 6, Steps: 52 | Train Loss: 0.4322551 Vali Loss: 1.3635290 Test Loss: 0.3993127
Validation loss decreased (1.366126 --> 1.363529).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 7 cost time: 1.646285057067871
Epoch: 7, Steps: 52 | Train Loss: 0.4271974 Vali Loss: 1.3564546 Test Loss: 0.3954911
Validation loss decreased (1.363529 --> 1.356455).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 8 cost time: 1.6706297397613525
Epoch: 8, Steps: 52 | Train Loss: 0.4237877 Vali Loss: 1.3545381 Test Loss: 0.3910428
Validation loss decreased (1.356455 --> 1.354538).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 9 cost time: 1.650397777557373
Epoch: 9, Steps: 52 | Train Loss: 0.4234009 Vali Loss: 1.3503692 Test Loss: 0.3882927
Validation loss decreased (1.354538 --> 1.350369).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 10 cost time: 1.6694350242614746
Epoch: 10, Steps: 52 | Train Loss: 0.4216017 Vali Loss: 1.3521625 Test Loss: 0.3846770
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 11 cost time: 1.654691219329834
Epoch: 11, Steps: 52 | Train Loss: 0.4202502 Vali Loss: 1.3430433 Test Loss: 0.3828682
Validation loss decreased (1.350369 --> 1.343043).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 12 cost time: 1.660670518875122
Epoch: 12, Steps: 52 | Train Loss: 0.4195881 Vali Loss: 1.3423568 Test Loss: 0.3813199
Validation loss decreased (1.343043 --> 1.342357).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 13 cost time: 1.6476190090179443
Epoch: 13, Steps: 52 | Train Loss: 0.4181928 Vali Loss: 1.3368888 Test Loss: 0.3795417
Validation loss decreased (1.342357 --> 1.336889).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 14 cost time: 1.6730868816375732
Epoch: 14, Steps: 52 | Train Loss: 0.4171006 Vali Loss: 1.3339186 Test Loss: 0.3779101
Validation loss decreased (1.336889 --> 1.333919).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 15 cost time: 1.6502110958099365
Epoch: 15, Steps: 52 | Train Loss: 0.4149780 Vali Loss: 1.3273411 Test Loss: 0.3774491
Validation loss decreased (1.333919 --> 1.327341).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 16 cost time: 1.6440074443817139
Epoch: 16, Steps: 52 | Train Loss: 0.4161329 Vali Loss: 1.3335474 Test Loss: 0.3762733
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 17 cost time: 1.655029535293579
Epoch: 17, Steps: 52 | Train Loss: 0.4151796 Vali Loss: 1.3300405 Test Loss: 0.3758922
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 18 cost time: 1.6731657981872559
Epoch: 18, Steps: 52 | Train Loss: 0.4152414 Vali Loss: 1.3288522 Test Loss: 0.3751163
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 19 cost time: 1.6446645259857178
Epoch: 19, Steps: 52 | Train Loss: 0.4137745 Vali Loss: 1.3294915 Test Loss: 0.3742050
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 20 cost time: 1.668391466140747
Epoch: 20, Steps: 52 | Train Loss: 0.4132427 Vali Loss: 1.3339038 Test Loss: 0.3738249
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 21 cost time: 1.6682398319244385
Epoch: 21, Steps: 52 | Train Loss: 0.4129129 Vali Loss: 1.3341939 Test Loss: 0.3732963
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 22 cost time: 1.6705644130706787
Epoch: 22, Steps: 52 | Train Loss: 0.4118129 Vali Loss: 1.3209839 Test Loss: 0.3727973
Validation loss decreased (1.327341 --> 1.320984).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 23 cost time: 1.648061752319336
Epoch: 23, Steps: 52 | Train Loss: 0.4129162 Vali Loss: 1.3287156 Test Loss: 0.3725343
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 24 cost time: 1.6675667762756348
Epoch: 24, Steps: 52 | Train Loss: 0.4123567 Vali Loss: 1.3182118 Test Loss: 0.3722335
Validation loss decreased (1.320984 --> 1.318212).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 25 cost time: 1.6496787071228027
Epoch: 25, Steps: 52 | Train Loss: 0.4101913 Vali Loss: 1.3234658 Test Loss: 0.3720165
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 26 cost time: 1.6679773330688477
Epoch: 26, Steps: 52 | Train Loss: 0.4116271 Vali Loss: 1.3254892 Test Loss: 0.3719306
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 27 cost time: 1.6579468250274658
Epoch: 27, Steps: 52 | Train Loss: 0.4115514 Vali Loss: 1.3241117 Test Loss: 0.3714923
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 28 cost time: 1.648216962814331
Epoch: 28, Steps: 52 | Train Loss: 0.4124882 Vali Loss: 1.3281486 Test Loss: 0.3713842
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 29 cost time: 1.6716268062591553
Epoch: 29, Steps: 52 | Train Loss: 0.4116365 Vali Loss: 1.3189408 Test Loss: 0.3713694
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 30 cost time: 1.6501121520996094
Epoch: 30, Steps: 52 | Train Loss: 0.4096461 Vali Loss: 1.3217955 Test Loss: 0.3711229
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 31 cost time: 1.663482666015625
Epoch: 31, Steps: 52 | Train Loss: 0.4102502 Vali Loss: 1.3169284 Test Loss: 0.3709230
Validation loss decreased (1.318212 --> 1.316928).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 32 cost time: 1.6613919734954834
Epoch: 32, Steps: 52 | Train Loss: 0.4107883 Vali Loss: 1.3137122 Test Loss: 0.3711559
Validation loss decreased (1.316928 --> 1.313712).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 33 cost time: 1.6644623279571533
Epoch: 33, Steps: 52 | Train Loss: 0.4106725 Vali Loss: 1.3224630 Test Loss: 0.3707131
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 34 cost time: 1.6479194164276123
Epoch: 34, Steps: 52 | Train Loss: 0.4098425 Vali Loss: 1.3181860 Test Loss: 0.3706867
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 35 cost time: 1.6718175411224365
Epoch: 35, Steps: 52 | Train Loss: 0.4094386 Vali Loss: 1.3181787 Test Loss: 0.3705954
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 36 cost time: 1.6504459381103516
Epoch: 36, Steps: 52 | Train Loss: 0.4098584 Vali Loss: 1.3209757 Test Loss: 0.3703756
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 37 cost time: 1.6778419017791748
Epoch: 37, Steps: 52 | Train Loss: 0.4118968 Vali Loss: 1.3178424 Test Loss: 0.3705066
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 38 cost time: 1.6506383419036865
Epoch: 38, Steps: 52 | Train Loss: 0.4115040 Vali Loss: 1.3239841 Test Loss: 0.3704428
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 39 cost time: 1.651827335357666
Epoch: 39, Steps: 52 | Train Loss: 0.4107807 Vali Loss: 1.3169794 Test Loss: 0.3703121
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 40 cost time: 1.6686019897460938
Epoch: 40, Steps: 52 | Train Loss: 0.4101886 Vali Loss: 1.3222252 Test Loss: 0.3703730
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 41 cost time: 1.6497812271118164
Epoch: 41, Steps: 52 | Train Loss: 0.4098796 Vali Loss: 1.3210505 Test Loss: 0.3701473
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 42 cost time: 1.660895824432373
Epoch: 42, Steps: 52 | Train Loss: 0.4114518 Vali Loss: 1.3244643 Test Loss: 0.3706607
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 43 cost time: 1.6565299034118652
Epoch: 43, Steps: 52 | Train Loss: 0.4086252 Vali Loss: 1.3226187 Test Loss: 0.3702524
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 44 cost time: 1.6485474109649658
Epoch: 44, Steps: 52 | Train Loss: 0.4119353 Vali Loss: 1.3219873 Test Loss: 0.3704399
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 45 cost time: 1.6773655414581299
Epoch: 45, Steps: 52 | Train Loss: 0.4091093 Vali Loss: 1.3192364 Test Loss: 0.3702641
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 46 cost time: 1.6499087810516357
Epoch: 46, Steps: 52 | Train Loss: 0.4097878 Vali Loss: 1.3217660 Test Loss: 0.3702523
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 47 cost time: 1.6712634563446045
Epoch: 47, Steps: 52 | Train Loss: 0.4103699 Vali Loss: 1.3168364 Test Loss: 0.3706303
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 48 cost time: 1.6474792957305908
Epoch: 48, Steps: 52 | Train Loss: 0.4099851 Vali Loss: 1.3207555 Test Loss: 0.3701736
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 49 cost time: 1.663766622543335
Epoch: 49, Steps: 52 | Train Loss: 0.4108481 Vali Loss: 1.3221229 Test Loss: 0.3701145
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 50 cost time: 1.6546134948730469
Epoch: 50, Steps: 52 | Train Loss: 0.4108719 Vali Loss: 1.3206177 Test Loss: 0.3702508
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 51 cost time: 1.6475942134857178
Epoch: 51, Steps: 52 | Train Loss: 0.4089262 Vali Loss: 1.3210181 Test Loss: 0.3700233
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 52 cost time: 1.6704976558685303
Epoch: 52, Steps: 52 | Train Loss: 0.4103299 Vali Loss: 1.3223714 Test Loss: 0.3699286
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 53 cost time: 1.6464135646820068
Epoch: 53, Steps: 52 | Train Loss: 0.4105707 Vali Loss: 1.3159602 Test Loss: 0.3700410
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 54 cost time: 1.667203426361084
Epoch: 54, Steps: 52 | Train Loss: 0.4112654 Vali Loss: 1.3161646 Test Loss: 0.3698570
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 55 cost time: 1.6552743911743164
Epoch: 55, Steps: 52 | Train Loss: 0.4090039 Vali Loss: 1.3184727 Test Loss: 0.3698802
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 56 cost time: 1.6675350666046143
Epoch: 56, Steps: 52 | Train Loss: 0.4081492 Vali Loss: 1.3247677 Test Loss: 0.3700957
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 57 cost time: 1.6774532794952393
Epoch: 57, Steps: 52 | Train Loss: 0.4102242 Vali Loss: 1.3169284 Test Loss: 0.3699187
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 58 cost time: 1.6484942436218262
Epoch: 58, Steps: 52 | Train Loss: 0.4095666 Vali Loss: 1.3203722 Test Loss: 0.3701231
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 59 cost time: 1.6603753566741943
Epoch: 59, Steps: 52 | Train Loss: 0.4096558 Vali Loss: 1.3220375 Test Loss: 0.3700374
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 60 cost time: 1.6472556591033936
Epoch: 60, Steps: 52 | Train Loss: 0.4098529 Vali Loss: 1.3142583 Test Loss: 0.3701913
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.37115588784217834, mae:0.41825878620147705, rse:0.4990993142127991
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04588603973388672 GB
Epoch: 1 cost time: 2.056668996810913
Epoch: 1, Steps: 52 | Train Loss: 0.7668402 Vali Loss: 2.2516198 Test Loss: 1.4616327
Validation loss decreased (inf --> 2.251620).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 2 cost time: 0.6877796649932861
Epoch: 2, Steps: 52 | Train Loss: 0.7143695 Vali Loss: 2.0112796 Test Loss: 1.1830785
Validation loss decreased (2.251620 --> 2.011280).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 3 cost time: 0.6998116970062256
Epoch: 3, Steps: 52 | Train Loss: 0.6356055 Vali Loss: 1.8069236 Test Loss: 0.9406748
Validation loss decreased (2.011280 --> 1.806924).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 4 cost time: 0.7069995403289795
Epoch: 4, Steps: 52 | Train Loss: 0.5667829 Vali Loss: 1.6501451 Test Loss: 0.7183760
Validation loss decreased (1.806924 --> 1.650145).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 5 cost time: 0.7014601230621338
Epoch: 5, Steps: 52 | Train Loss: 0.5199474 Vali Loss: 1.5413024 Test Loss: 0.5882385
Validation loss decreased (1.650145 --> 1.541302).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 6 cost time: 1.1417491436004639
Epoch: 6, Steps: 52 | Train Loss: 0.4895219 Vali Loss: 1.4980551 Test Loss: 0.5181081
Validation loss decreased (1.541302 --> 1.498055).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 7 cost time: 1.5581004619598389
Epoch: 7, Steps: 52 | Train Loss: 0.4734891 Vali Loss: 1.4663570 Test Loss: 0.4825908
Validation loss decreased (1.498055 --> 1.466357).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 8 cost time: 1.5554842948913574
Epoch: 8, Steps: 52 | Train Loss: 0.4653938 Vali Loss: 1.4453893 Test Loss: 0.4586611
Validation loss decreased (1.466357 --> 1.445389).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 9 cost time: 1.5742039680480957
Epoch: 9, Steps: 52 | Train Loss: 0.4571941 Vali Loss: 1.4298661 Test Loss: 0.4458525
Validation loss decreased (1.445389 --> 1.429866).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 10 cost time: 1.570702075958252
Epoch: 10, Steps: 52 | Train Loss: 0.4488958 Vali Loss: 1.4237862 Test Loss: 0.4371638
Validation loss decreased (1.429866 --> 1.423786).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 11 cost time: 1.571593999862671
Epoch: 11, Steps: 52 | Train Loss: 0.4467696 Vali Loss: 1.4203522 Test Loss: 0.4323722
Validation loss decreased (1.423786 --> 1.420352).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 12 cost time: 1.5675404071807861
Epoch: 12, Steps: 52 | Train Loss: 0.4432083 Vali Loss: 1.4101608 Test Loss: 0.4274784
Validation loss decreased (1.420352 --> 1.410161).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 13 cost time: 1.5724313259124756
Epoch: 13, Steps: 52 | Train Loss: 0.4411303 Vali Loss: 1.4083474 Test Loss: 0.4244028
Validation loss decreased (1.410161 --> 1.408347).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 14 cost time: 1.5674467086791992
Epoch: 14, Steps: 52 | Train Loss: 0.4403925 Vali Loss: 1.3933100 Test Loss: 0.4221767
Validation loss decreased (1.408347 --> 1.393310).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 15 cost time: 1.563474178314209
Epoch: 15, Steps: 52 | Train Loss: 0.4381984 Vali Loss: 1.4062431 Test Loss: 0.4203266
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 16 cost time: 1.5677142143249512
Epoch: 16, Steps: 52 | Train Loss: 0.4371046 Vali Loss: 1.3976403 Test Loss: 0.4189288
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 17 cost time: 1.5669045448303223
Epoch: 17, Steps: 52 | Train Loss: 0.4353055 Vali Loss: 1.3963641 Test Loss: 0.4187493
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 18 cost time: 1.5710456371307373
Epoch: 18, Steps: 52 | Train Loss: 0.4351036 Vali Loss: 1.3948727 Test Loss: 0.4166147
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 19 cost time: 1.568579912185669
Epoch: 19, Steps: 52 | Train Loss: 0.4330162 Vali Loss: 1.3934522 Test Loss: 0.4162482
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 20 cost time: 1.5614345073699951
Epoch: 20, Steps: 52 | Train Loss: 0.4326893 Vali Loss: 1.3935333 Test Loss: 0.4159029
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 21 cost time: 1.5628647804260254
Epoch: 21, Steps: 52 | Train Loss: 0.4312384 Vali Loss: 1.3857200 Test Loss: 0.4152191
Validation loss decreased (1.393310 --> 1.385720).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 22 cost time: 1.574523687362671
Epoch: 22, Steps: 52 | Train Loss: 0.4313317 Vali Loss: 1.3845809 Test Loss: 0.4145082
Validation loss decreased (1.385720 --> 1.384581).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 23 cost time: 1.569091558456421
Epoch: 23, Steps: 52 | Train Loss: 0.4311339 Vali Loss: 1.3797334 Test Loss: 0.4140462
Validation loss decreased (1.384581 --> 1.379733).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 24 cost time: 1.577030897140503
Epoch: 24, Steps: 52 | Train Loss: 0.4296125 Vali Loss: 1.3873067 Test Loss: 0.4138483
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 25 cost time: 1.5657680034637451
Epoch: 25, Steps: 52 | Train Loss: 0.4281089 Vali Loss: 1.3830532 Test Loss: 0.4131335
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 26 cost time: 1.5774390697479248
Epoch: 26, Steps: 52 | Train Loss: 0.4312763 Vali Loss: 1.3807690 Test Loss: 0.4128724
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 27 cost time: 1.5681989192962646
Epoch: 27, Steps: 52 | Train Loss: 0.4288788 Vali Loss: 1.3754342 Test Loss: 0.4118169
Validation loss decreased (1.379733 --> 1.375434).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 28 cost time: 1.5740458965301514
Epoch: 28, Steps: 52 | Train Loss: 0.4284557 Vali Loss: 1.3863902 Test Loss: 0.4128698
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 29 cost time: 1.5659644603729248
Epoch: 29, Steps: 52 | Train Loss: 0.4276389 Vali Loss: 1.3802341 Test Loss: 0.4123608
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 30 cost time: 1.5754034519195557
Epoch: 30, Steps: 52 | Train Loss: 0.4284882 Vali Loss: 1.3776414 Test Loss: 0.4115873
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 31 cost time: 1.565969705581665
Epoch: 31, Steps: 52 | Train Loss: 0.4273995 Vali Loss: 1.3817853 Test Loss: 0.4114447
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 32 cost time: 1.5675971508026123
Epoch: 32, Steps: 52 | Train Loss: 0.4287246 Vali Loss: 1.3628531 Test Loss: 0.4112682
Validation loss decreased (1.375434 --> 1.362853).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 33 cost time: 1.5660827159881592
Epoch: 33, Steps: 52 | Train Loss: 0.4269122 Vali Loss: 1.3749044 Test Loss: 0.4123613
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 34 cost time: 1.5677273273468018
Epoch: 34, Steps: 52 | Train Loss: 0.4282103 Vali Loss: 1.3753023 Test Loss: 0.4118102
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 35 cost time: 1.5624680519104004
Epoch: 35, Steps: 52 | Train Loss: 0.4278531 Vali Loss: 1.3740268 Test Loss: 0.4110766
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 36 cost time: 1.5633320808410645
Epoch: 36, Steps: 52 | Train Loss: 0.4269721 Vali Loss: 1.3755043 Test Loss: 0.4112337
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 37 cost time: 1.5685701370239258
Epoch: 37, Steps: 52 | Train Loss: 0.4282973 Vali Loss: 1.3690014 Test Loss: 0.4121194
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 38 cost time: 1.575216293334961
Epoch: 38, Steps: 52 | Train Loss: 0.4282068 Vali Loss: 1.3735003 Test Loss: 0.4110898
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 39 cost time: 1.566819190979004
Epoch: 39, Steps: 52 | Train Loss: 0.4279122 Vali Loss: 1.3744833 Test Loss: 0.4112446
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 40 cost time: 1.5712966918945312
Epoch: 40, Steps: 52 | Train Loss: 0.4254959 Vali Loss: 1.3756566 Test Loss: 0.4112713
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 41 cost time: 1.5686581134796143
Epoch: 41, Steps: 52 | Train Loss: 0.4254554 Vali Loss: 1.3672559 Test Loss: 0.4107863
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 42 cost time: 1.571937084197998
Epoch: 42, Steps: 52 | Train Loss: 0.4274803 Vali Loss: 1.3793002 Test Loss: 0.4115902
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 43 cost time: 1.566481351852417
Epoch: 43, Steps: 52 | Train Loss: 0.4275118 Vali Loss: 1.3814136 Test Loss: 0.4106374
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 44 cost time: 1.571897268295288
Epoch: 44, Steps: 52 | Train Loss: 0.4250951 Vali Loss: 1.3694093 Test Loss: 0.4105437
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 45 cost time: 1.5710558891296387
Epoch: 45, Steps: 52 | Train Loss: 0.4254087 Vali Loss: 1.3667164 Test Loss: 0.4102688
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 46 cost time: 1.5698094367980957
Epoch: 46, Steps: 52 | Train Loss: 0.4248040 Vali Loss: 1.3778675 Test Loss: 0.4103571
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 47 cost time: 1.565922498703003
Epoch: 47, Steps: 52 | Train Loss: 0.4266372 Vali Loss: 1.3764973 Test Loss: 0.4103766
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 48 cost time: 1.567840576171875
Epoch: 48, Steps: 52 | Train Loss: 0.4264531 Vali Loss: 1.3787626 Test Loss: 0.4102046
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 49 cost time: 1.5668964385986328
Epoch: 49, Steps: 52 | Train Loss: 0.4250720 Vali Loss: 1.3749716 Test Loss: 0.4109932
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 50 cost time: 1.563833236694336
Epoch: 50, Steps: 52 | Train Loss: 0.4252737 Vali Loss: 1.3735871 Test Loss: 0.4108748
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 51 cost time: 1.5663437843322754
Epoch: 51, Steps: 52 | Train Loss: 0.4253508 Vali Loss: 1.3795152 Test Loss: 0.4103063
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 52 cost time: 1.5640158653259277
Epoch: 52, Steps: 52 | Train Loss: 0.4270591 Vali Loss: 1.3750501 Test Loss: 0.4103046
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 53 cost time: 1.5636475086212158
Epoch: 53, Steps: 52 | Train Loss: 0.4274331 Vali Loss: 1.3789233 Test Loss: 0.4107849
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 54 cost time: 1.5583865642547607
Epoch: 54, Steps: 52 | Train Loss: 0.4250462 Vali Loss: 1.3714237 Test Loss: 0.4109970
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 55 cost time: 1.556434154510498
Epoch: 55, Steps: 52 | Train Loss: 0.4260433 Vali Loss: 1.3785149 Test Loss: 0.4104923
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 56 cost time: 1.5518858432769775
Epoch: 56, Steps: 52 | Train Loss: 0.4253301 Vali Loss: 1.3784779 Test Loss: 0.4105405
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 57 cost time: 1.5679302215576172
Epoch: 57, Steps: 52 | Train Loss: 0.4247055 Vali Loss: 1.3751581 Test Loss: 0.4109434
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 58 cost time: 1.5668554306030273
Epoch: 58, Steps: 52 | Train Loss: 0.4240465 Vali Loss: 1.3741608 Test Loss: 0.4095396
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 59 cost time: 1.572371006011963
Epoch: 59, Steps: 52 | Train Loss: 0.4251933 Vali Loss: 1.3763938 Test Loss: 0.4106718
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 60 cost time: 1.5691256523132324
Epoch: 60, Steps: 52 | Train Loss: 0.4269461 Vali Loss: 1.3760873 Test Loss: 0.4101790
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.4112682044506073, mae:0.450302392244339, rse:0.5253773927688599
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 1 cost time: 2.0860953330993652
Epoch: 1, Steps: 52 | Train Loss: 0.7021872 Vali Loss: 2.1407053 Test Loss: 1.3679140
Validation loss decreased (inf --> 2.140705).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 2 cost time: 0.7306234836578369
Epoch: 2, Steps: 52 | Train Loss: 0.6098759 Vali Loss: 1.6481202 Test Loss: 0.7928076
Validation loss decreased (2.140705 --> 1.648120).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 3 cost time: 0.7293596267700195
Epoch: 3, Steps: 52 | Train Loss: 0.4944925 Vali Loss: 1.4304087 Test Loss: 0.4551799
Validation loss decreased (1.648120 --> 1.430409).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 4 cost time: 0.7311017513275146
Epoch: 4, Steps: 52 | Train Loss: 0.4533218 Vali Loss: 1.4019361 Test Loss: 0.4226796
Validation loss decreased (1.430409 --> 1.401936).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 5 cost time: 0.7397744655609131
Epoch: 5, Steps: 52 | Train Loss: 0.4396808 Vali Loss: 1.3895822 Test Loss: 0.4134680
Validation loss decreased (1.401936 --> 1.389582).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 6 cost time: 1.4783837795257568
Epoch: 6, Steps: 52 | Train Loss: 0.4344918 Vali Loss: 1.3750138 Test Loss: 0.4033817
Validation loss decreased (1.389582 --> 1.375014).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 7 cost time: 1.6170167922973633
Epoch: 7, Steps: 52 | Train Loss: 0.4319598 Vali Loss: 1.3732550 Test Loss: 0.3977111
Validation loss decreased (1.375014 --> 1.373255).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 8 cost time: 1.6336383819580078
Epoch: 8, Steps: 52 | Train Loss: 0.4278702 Vali Loss: 1.3611619 Test Loss: 0.3918692
Validation loss decreased (1.373255 --> 1.361162).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 9 cost time: 1.6281836032867432
Epoch: 9, Steps: 52 | Train Loss: 0.4262047 Vali Loss: 1.3537807 Test Loss: 0.3876004
Validation loss decreased (1.361162 --> 1.353781).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 10 cost time: 1.6446237564086914
Epoch: 10, Steps: 52 | Train Loss: 0.4232153 Vali Loss: 1.3485739 Test Loss: 0.3840697
Validation loss decreased (1.353781 --> 1.348574).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 11 cost time: 1.6291844844818115
Epoch: 11, Steps: 52 | Train Loss: 0.4222087 Vali Loss: 1.3394186 Test Loss: 0.3810227
Validation loss decreased (1.348574 --> 1.339419).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 12 cost time: 1.6180026531219482
Epoch: 12, Steps: 52 | Train Loss: 0.4203997 Vali Loss: 1.3320005 Test Loss: 0.3801337
Validation loss decreased (1.339419 --> 1.332000).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 13 cost time: 1.622802972793579
Epoch: 13, Steps: 52 | Train Loss: 0.4189017 Vali Loss: 1.3372145 Test Loss: 0.3779652
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 14 cost time: 1.6113455295562744
Epoch: 14, Steps: 52 | Train Loss: 0.4187755 Vali Loss: 1.3285651 Test Loss: 0.3766056
Validation loss decreased (1.332000 --> 1.328565).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 15 cost time: 1.616109848022461
Epoch: 15, Steps: 52 | Train Loss: 0.4174966 Vali Loss: 1.3361397 Test Loss: 0.3760059
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 16 cost time: 1.6187222003936768
Epoch: 16, Steps: 52 | Train Loss: 0.4158123 Vali Loss: 1.3346959 Test Loss: 0.3751565
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 17 cost time: 1.6328153610229492
Epoch: 17, Steps: 52 | Train Loss: 0.4162877 Vali Loss: 1.3313942 Test Loss: 0.3741454
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 18 cost time: 1.6285505294799805
Epoch: 18, Steps: 52 | Train Loss: 0.4151488 Vali Loss: 1.3175663 Test Loss: 0.3738498
Validation loss decreased (1.328565 --> 1.317566).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 19 cost time: 1.616729497909546
Epoch: 19, Steps: 52 | Train Loss: 0.4135643 Vali Loss: 1.3290596 Test Loss: 0.3730573
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 20 cost time: 1.6042797565460205
Epoch: 20, Steps: 52 | Train Loss: 0.4139078 Vali Loss: 1.3222752 Test Loss: 0.3728886
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 21 cost time: 1.6145257949829102
Epoch: 21, Steps: 52 | Train Loss: 0.4124153 Vali Loss: 1.3179052 Test Loss: 0.3717868
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 22 cost time: 1.6098415851593018
Epoch: 22, Steps: 52 | Train Loss: 0.4127547 Vali Loss: 1.3171061 Test Loss: 0.3720767
Validation loss decreased (1.317566 --> 1.317106).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 23 cost time: 1.6222734451293945
Epoch: 23, Steps: 52 | Train Loss: 0.4123409 Vali Loss: 1.3211318 Test Loss: 0.3720839
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 24 cost time: 1.6241209506988525
Epoch: 24, Steps: 52 | Train Loss: 0.4118759 Vali Loss: 1.3168751 Test Loss: 0.3713730
Validation loss decreased (1.317106 --> 1.316875).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 25 cost time: 1.612149715423584
Epoch: 25, Steps: 52 | Train Loss: 0.4127015 Vali Loss: 1.3169105 Test Loss: 0.3716827
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 26 cost time: 1.6141772270202637
Epoch: 26, Steps: 52 | Train Loss: 0.4118124 Vali Loss: 1.3241709 Test Loss: 0.3710181
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 27 cost time: 1.6211414337158203
Epoch: 27, Steps: 52 | Train Loss: 0.4104234 Vali Loss: 1.3177297 Test Loss: 0.3705255
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 28 cost time: 1.6215097904205322
Epoch: 28, Steps: 52 | Train Loss: 0.4118346 Vali Loss: 1.3220360 Test Loss: 0.3704392
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 29 cost time: 1.6069281101226807
Epoch: 29, Steps: 52 | Train Loss: 0.4116263 Vali Loss: 1.3204147 Test Loss: 0.3706150
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 30 cost time: 1.623521327972412
Epoch: 30, Steps: 52 | Train Loss: 0.4128681 Vali Loss: 1.3172315 Test Loss: 0.3700713
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 31 cost time: 1.6295368671417236
Epoch: 31, Steps: 52 | Train Loss: 0.4108519 Vali Loss: 1.3234470 Test Loss: 0.3700535
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 32 cost time: 1.6208956241607666
Epoch: 32, Steps: 52 | Train Loss: 0.4110844 Vali Loss: 1.3234259 Test Loss: 0.3699018
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 33 cost time: 1.624330759048462
Epoch: 33, Steps: 52 | Train Loss: 0.4111819 Vali Loss: 1.3188143 Test Loss: 0.3703661
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 34 cost time: 1.6162445545196533
Epoch: 34, Steps: 52 | Train Loss: 0.4112000 Vali Loss: 1.3178127 Test Loss: 0.3695340
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 35 cost time: 1.6177396774291992
Epoch: 35, Steps: 52 | Train Loss: 0.4118344 Vali Loss: 1.3083440 Test Loss: 0.3699388
Validation loss decreased (1.316875 --> 1.308344).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 36 cost time: 1.610910177230835
Epoch: 36, Steps: 52 | Train Loss: 0.4108085 Vali Loss: 1.3170358 Test Loss: 0.3695869
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 37 cost time: 1.610445261001587
Epoch: 37, Steps: 52 | Train Loss: 0.4102979 Vali Loss: 1.3177947 Test Loss: 0.3693848
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 38 cost time: 1.6118831634521484
Epoch: 38, Steps: 52 | Train Loss: 0.4118905 Vali Loss: 1.3153102 Test Loss: 0.3696982
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 39 cost time: 1.620272159576416
Epoch: 39, Steps: 52 | Train Loss: 0.4107387 Vali Loss: 1.3149030 Test Loss: 0.3696459
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 40 cost time: 1.618255615234375
Epoch: 40, Steps: 52 | Train Loss: 0.4103501 Vali Loss: 1.3176310 Test Loss: 0.3699808
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 41 cost time: 1.6311662197113037
Epoch: 41, Steps: 52 | Train Loss: 0.4103125 Vali Loss: 1.3150512 Test Loss: 0.3700848
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 42 cost time: 1.6107943058013916
Epoch: 42, Steps: 52 | Train Loss: 0.4095136 Vali Loss: 1.3046050 Test Loss: 0.3693400
Validation loss decreased (1.308344 --> 1.304605).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 43 cost time: 1.6132657527923584
Epoch: 43, Steps: 52 | Train Loss: 0.4102294 Vali Loss: 1.3177944 Test Loss: 0.3697020
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 44 cost time: 1.621946096420288
Epoch: 44, Steps: 52 | Train Loss: 0.4115231 Vali Loss: 1.3199129 Test Loss: 0.3697426
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 45 cost time: 1.6134893894195557
Epoch: 45, Steps: 52 | Train Loss: 0.4103473 Vali Loss: 1.3144002 Test Loss: 0.3698466
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 46 cost time: 1.6099095344543457
Epoch: 46, Steps: 52 | Train Loss: 0.4102389 Vali Loss: 1.3122264 Test Loss: 0.3693660
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 47 cost time: 1.621713638305664
Epoch: 47, Steps: 52 | Train Loss: 0.4090994 Vali Loss: 1.3144846 Test Loss: 0.3694947
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 48 cost time: 1.6189548969268799
Epoch: 48, Steps: 52 | Train Loss: 0.4088996 Vali Loss: 1.3142507 Test Loss: 0.3692734
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 49 cost time: 1.6148288249969482
Epoch: 49, Steps: 52 | Train Loss: 0.4092286 Vali Loss: 1.3164406 Test Loss: 0.3691704
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 50 cost time: 1.6144440174102783
Epoch: 50, Steps: 52 | Train Loss: 0.4088825 Vali Loss: 1.3219595 Test Loss: 0.3697884
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 51 cost time: 1.618112564086914
Epoch: 51, Steps: 52 | Train Loss: 0.4105817 Vali Loss: 1.3203299 Test Loss: 0.3698466
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 52 cost time: 1.610123634338379
Epoch: 52, Steps: 52 | Train Loss: 0.4118845 Vali Loss: 1.3123341 Test Loss: 0.3695625
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 53 cost time: 1.6154489517211914
Epoch: 53, Steps: 52 | Train Loss: 0.4108487 Vali Loss: 1.3099086 Test Loss: 0.3693884
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 54 cost time: 1.6120374202728271
Epoch: 54, Steps: 52 | Train Loss: 0.4095712 Vali Loss: 1.3115921 Test Loss: 0.3691967
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 55 cost time: 1.6284632682800293
Epoch: 55, Steps: 52 | Train Loss: 0.4112220 Vali Loss: 1.3202382 Test Loss: 0.3694383
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 56 cost time: 1.6086578369140625
Epoch: 56, Steps: 52 | Train Loss: 0.4091320 Vali Loss: 1.2998718 Test Loss: 0.3692366
Validation loss decreased (1.304605 --> 1.299872).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 57 cost time: 1.6214582920074463
Epoch: 57, Steps: 52 | Train Loss: 0.4109327 Vali Loss: 1.3138314 Test Loss: 0.3691565
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 58 cost time: 1.622570276260376
Epoch: 58, Steps: 52 | Train Loss: 0.4111780 Vali Loss: 1.3195606 Test Loss: 0.3693164
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 59 cost time: 1.639923334121704
Epoch: 59, Steps: 52 | Train Loss: 0.4111886 Vali Loss: 1.3183250 Test Loss: 0.3696925
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 60 cost time: 1.6309854984283447
Epoch: 60, Steps: 52 | Train Loss: 0.4100663 Vali Loss: 1.3165145 Test Loss: 0.3694863
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3692365884780884, mae:0.416920930147171, rse:0.49780720472335815
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.053173065185546875 GB
Epoch: 1 cost time: 2.1648108959198
Epoch: 1, Steps: 52 | Train Loss: 0.6821364 Vali Loss: 2.1073873 Test Loss: 1.3479117
Validation loss decreased (inf --> 2.107387).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 2 cost time: 0.7586281299591064
Epoch: 2, Steps: 52 | Train Loss: 0.5876468 Vali Loss: 1.5419512 Test Loss: 0.6306417
Validation loss decreased (2.107387 --> 1.541951).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 3 cost time: 0.7467217445373535
Epoch: 3, Steps: 52 | Train Loss: 0.4684119 Vali Loss: 1.3934000 Test Loss: 0.4198898
Validation loss decreased (1.541951 --> 1.393400).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 4 cost time: 0.7635130882263184
Epoch: 4, Steps: 52 | Train Loss: 0.4440217 Vali Loss: 1.3885118 Test Loss: 0.4107873
Validation loss decreased (1.393400 --> 1.388512).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 5 cost time: 0.7463808059692383
Epoch: 5, Steps: 52 | Train Loss: 0.4368398 Vali Loss: 1.3797739 Test Loss: 0.3996370
Validation loss decreased (1.388512 --> 1.379774).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 6 cost time: 1.6561102867126465
Epoch: 6, Steps: 52 | Train Loss: 0.4301505 Vali Loss: 1.3693852 Test Loss: 0.3924405
Validation loss decreased (1.379774 --> 1.369385).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 7 cost time: 1.6686978340148926
Epoch: 7, Steps: 52 | Train Loss: 0.4268761 Vali Loss: 1.3642092 Test Loss: 0.3879308
Validation loss decreased (1.369385 --> 1.364209).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 8 cost time: 1.694336175918579
Epoch: 8, Steps: 52 | Train Loss: 0.4260753 Vali Loss: 1.3495024 Test Loss: 0.3841843
Validation loss decreased (1.364209 --> 1.349502).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 9 cost time: 1.6691460609436035
Epoch: 9, Steps: 52 | Train Loss: 0.4221348 Vali Loss: 1.3436327 Test Loss: 0.3807090
Validation loss decreased (1.349502 --> 1.343633).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 10 cost time: 1.6700079441070557
Epoch: 10, Steps: 52 | Train Loss: 0.4199370 Vali Loss: 1.3315518 Test Loss: 0.3774647
Validation loss decreased (1.343633 --> 1.331552).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 11 cost time: 1.664069652557373
Epoch: 11, Steps: 52 | Train Loss: 0.4212737 Vali Loss: 1.3373477 Test Loss: 0.3759487
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 12 cost time: 1.674898624420166
Epoch: 12, Steps: 52 | Train Loss: 0.4194099 Vali Loss: 1.3354464 Test Loss: 0.3739499
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 13 cost time: 1.6715788841247559
Epoch: 13, Steps: 52 | Train Loss: 0.4153365 Vali Loss: 1.3300407 Test Loss: 0.3717445
Validation loss decreased (1.331552 --> 1.330041).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 14 cost time: 1.6610758304595947
Epoch: 14, Steps: 52 | Train Loss: 0.4172856 Vali Loss: 1.3290503 Test Loss: 0.3705560
Validation loss decreased (1.330041 --> 1.329050).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 15 cost time: 1.6837801933288574
Epoch: 15, Steps: 52 | Train Loss: 0.4149526 Vali Loss: 1.3293859 Test Loss: 0.3697481
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 16 cost time: 1.6708264350891113
Epoch: 16, Steps: 52 | Train Loss: 0.4133865 Vali Loss: 1.3282380 Test Loss: 0.3684893
Validation loss decreased (1.329050 --> 1.328238).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 17 cost time: 1.6764304637908936
Epoch: 17, Steps: 52 | Train Loss: 0.4127104 Vali Loss: 1.3270483 Test Loss: 0.3685701
Validation loss decreased (1.328238 --> 1.327048).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 18 cost time: 1.672539472579956
Epoch: 18, Steps: 52 | Train Loss: 0.4142341 Vali Loss: 1.3228509 Test Loss: 0.3675793
Validation loss decreased (1.327048 --> 1.322851).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 19 cost time: 1.6574835777282715
Epoch: 19, Steps: 52 | Train Loss: 0.4141159 Vali Loss: 1.3182452 Test Loss: 0.3668302
Validation loss decreased (1.322851 --> 1.318245).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 20 cost time: 1.6869187355041504
Epoch: 20, Steps: 52 | Train Loss: 0.4124373 Vali Loss: 1.3157749 Test Loss: 0.3669454
Validation loss decreased (1.318245 --> 1.315775).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 21 cost time: 1.6774241924285889
Epoch: 21, Steps: 52 | Train Loss: 0.4120789 Vali Loss: 1.3138249 Test Loss: 0.3664414
Validation loss decreased (1.315775 --> 1.313825).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 22 cost time: 1.663611888885498
Epoch: 22, Steps: 52 | Train Loss: 0.4121841 Vali Loss: 1.3199794 Test Loss: 0.3665628
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 23 cost time: 1.6829376220703125
Epoch: 23, Steps: 52 | Train Loss: 0.4116324 Vali Loss: 1.3188347 Test Loss: 0.3662072
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 24 cost time: 1.6715245246887207
Epoch: 24, Steps: 52 | Train Loss: 0.4127480 Vali Loss: 1.3087003 Test Loss: 0.3660725
Validation loss decreased (1.313825 --> 1.308700).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 25 cost time: 1.6605274677276611
Epoch: 25, Steps: 52 | Train Loss: 0.4115786 Vali Loss: 1.3081874 Test Loss: 0.3657612
Validation loss decreased (1.308700 --> 1.308187).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 26 cost time: 1.689138412475586
Epoch: 26, Steps: 52 | Train Loss: 0.4133109 Vali Loss: 1.3156319 Test Loss: 0.3658525
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 27 cost time: 1.6677987575531006
Epoch: 27, Steps: 52 | Train Loss: 0.4103618 Vali Loss: 1.3171861 Test Loss: 0.3652716
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 28 cost time: 1.6605899333953857
Epoch: 28, Steps: 52 | Train Loss: 0.4106767 Vali Loss: 1.3113396 Test Loss: 0.3649354
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 29 cost time: 1.6865432262420654
Epoch: 29, Steps: 52 | Train Loss: 0.4102619 Vali Loss: 1.3110251 Test Loss: 0.3651421
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 30 cost time: 1.6660840511322021
Epoch: 30, Steps: 52 | Train Loss: 0.4099347 Vali Loss: 1.3110374 Test Loss: 0.3654065
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 31 cost time: 1.6784663200378418
Epoch: 31, Steps: 52 | Train Loss: 0.4108702 Vali Loss: 1.3129799 Test Loss: 0.3649077
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 32 cost time: 1.664081335067749
Epoch: 32, Steps: 52 | Train Loss: 0.4094304 Vali Loss: 1.3194222 Test Loss: 0.3649796
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 33 cost time: 1.6867775917053223
Epoch: 33, Steps: 52 | Train Loss: 0.4089334 Vali Loss: 1.3168588 Test Loss: 0.3650670
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 34 cost time: 1.6664047241210938
Epoch: 34, Steps: 52 | Train Loss: 0.4099582 Vali Loss: 1.3113884 Test Loss: 0.3648090
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 35 cost time: 1.6780974864959717
Epoch: 35, Steps: 52 | Train Loss: 0.4102507 Vali Loss: 1.3166170 Test Loss: 0.3647856
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 36 cost time: 1.6948256492614746
Epoch: 36, Steps: 52 | Train Loss: 0.4078318 Vali Loss: 1.3086071 Test Loss: 0.3648185
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 37 cost time: 1.6650707721710205
Epoch: 37, Steps: 52 | Train Loss: 0.4091842 Vali Loss: 1.3103778 Test Loss: 0.3645442
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 38 cost time: 1.6877093315124512
Epoch: 38, Steps: 52 | Train Loss: 0.4086540 Vali Loss: 1.3120524 Test Loss: 0.3647898
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 39 cost time: 1.6625325679779053
Epoch: 39, Steps: 52 | Train Loss: 0.4105703 Vali Loss: 1.3176039 Test Loss: 0.3644986
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 40 cost time: 1.6850764751434326
Epoch: 40, Steps: 52 | Train Loss: 0.4098911 Vali Loss: 1.3122573 Test Loss: 0.3647037
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 41 cost time: 1.6673235893249512
Epoch: 41, Steps: 52 | Train Loss: 0.4095296 Vali Loss: 1.3122466 Test Loss: 0.3646471
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 42 cost time: 1.6822388172149658
Epoch: 42, Steps: 52 | Train Loss: 0.4100973 Vali Loss: 1.3156619 Test Loss: 0.3649363
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 43 cost time: 1.671093463897705
Epoch: 43, Steps: 52 | Train Loss: 0.4093344 Vali Loss: 1.3132520 Test Loss: 0.3644673
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 44 cost time: 1.6633985042572021
Epoch: 44, Steps: 52 | Train Loss: 0.4081082 Vali Loss: 1.3155153 Test Loss: 0.3646974
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 45 cost time: 1.6852407455444336
Epoch: 45, Steps: 52 | Train Loss: 0.4095993 Vali Loss: 1.2960298 Test Loss: 0.3645514
Validation loss decreased (1.308187 --> 1.296030).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 46 cost time: 1.6711411476135254
Epoch: 46, Steps: 52 | Train Loss: 0.4096603 Vali Loss: 1.3081694 Test Loss: 0.3646182
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 47 cost time: 1.6666834354400635
Epoch: 47, Steps: 52 | Train Loss: 0.4081090 Vali Loss: 1.3081120 Test Loss: 0.3644292
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 48 cost time: 1.6870365142822266
Epoch: 48, Steps: 52 | Train Loss: 0.4099963 Vali Loss: 1.3070438 Test Loss: 0.3646860
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 49 cost time: 1.6742866039276123
Epoch: 49, Steps: 52 | Train Loss: 0.4102301 Vali Loss: 1.3131694 Test Loss: 0.3643106
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 50 cost time: 1.6703670024871826
Epoch: 50, Steps: 52 | Train Loss: 0.4074869 Vali Loss: 1.3128126 Test Loss: 0.3645507
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 51 cost time: 1.6935069561004639
Epoch: 51, Steps: 52 | Train Loss: 0.4103919 Vali Loss: 1.3095117 Test Loss: 0.3648131
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 52 cost time: 1.668586254119873
Epoch: 52, Steps: 52 | Train Loss: 0.4095770 Vali Loss: 1.3133955 Test Loss: 0.3642634
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 53 cost time: 1.6803758144378662
Epoch: 53, Steps: 52 | Train Loss: 0.4089435 Vali Loss: 1.3130362 Test Loss: 0.3648158
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 54 cost time: 1.6873507499694824
Epoch: 54, Steps: 52 | Train Loss: 0.4083637 Vali Loss: 1.3170292 Test Loss: 0.3640836
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 55 cost time: 1.668215036392212
Epoch: 55, Steps: 52 | Train Loss: 0.4101133 Vali Loss: 1.3130772 Test Loss: 0.3644996
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 56 cost time: 1.6835424900054932
Epoch: 56, Steps: 52 | Train Loss: 0.4078855 Vali Loss: 1.3151424 Test Loss: 0.3646358
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 57 cost time: 1.662524700164795
Epoch: 57, Steps: 52 | Train Loss: 0.4079628 Vali Loss: 1.3112111 Test Loss: 0.3641434
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 58 cost time: 1.678210735321045
Epoch: 58, Steps: 52 | Train Loss: 0.4076644 Vali Loss: 1.3087524 Test Loss: 0.3643811
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 59 cost time: 1.6651132106781006
Epoch: 59, Steps: 52 | Train Loss: 0.4077084 Vali Loss: 1.3152837 Test Loss: 0.3642199
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 60 cost time: 1.6771488189697266
Epoch: 60, Steps: 52 | Train Loss: 0.4092378 Vali Loss: 1.3092391 Test Loss: 0.3643744
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3645513951778412, mae:0.41114187240600586, rse:0.4946388006210327
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04604673385620117 GB
Epoch: 1 cost time: 2.07832670211792
Epoch: 1, Steps: 52 | Train Loss: 0.7774225 Vali Loss: 2.2734683 Test Loss: 1.5272734
Validation loss decreased (inf --> 2.273468).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 2 cost time: 0.6832540035247803
Epoch: 2, Steps: 52 | Train Loss: 0.7204998 Vali Loss: 1.9802694 Test Loss: 1.2104336
Validation loss decreased (2.273468 --> 1.980269).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 3 cost time: 0.7059998512268066
Epoch: 3, Steps: 52 | Train Loss: 0.6336491 Vali Loss: 1.7794880 Test Loss: 0.9685867
Validation loss decreased (1.980269 --> 1.779488).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 4 cost time: 0.7043859958648682
Epoch: 4, Steps: 52 | Train Loss: 0.5667087 Vali Loss: 1.6242416 Test Loss: 0.7565343
Validation loss decreased (1.779488 --> 1.624242).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 5 cost time: 0.7107198238372803
Epoch: 5, Steps: 52 | Train Loss: 0.5196069 Vali Loss: 1.5382254 Test Loss: 0.6194246
Validation loss decreased (1.624242 --> 1.538225).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 6 cost time: 1.2169032096862793
Epoch: 6, Steps: 52 | Train Loss: 0.4901182 Vali Loss: 1.4888480 Test Loss: 0.5387886
Validation loss decreased (1.538225 --> 1.488848).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 7 cost time: 1.5708236694335938
Epoch: 7, Steps: 52 | Train Loss: 0.4744969 Vali Loss: 1.4638853 Test Loss: 0.5006077
Validation loss decreased (1.488848 --> 1.463885).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 8 cost time: 1.5847134590148926
Epoch: 8, Steps: 52 | Train Loss: 0.4621269 Vali Loss: 1.4395726 Test Loss: 0.4751596
Validation loss decreased (1.463885 --> 1.439573).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 9 cost time: 1.5801193714141846
Epoch: 9, Steps: 52 | Train Loss: 0.4556576 Vali Loss: 1.4272642 Test Loss: 0.4572385
Validation loss decreased (1.439573 --> 1.427264).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 10 cost time: 1.584928274154663
Epoch: 10, Steps: 52 | Train Loss: 0.4486567 Vali Loss: 1.4133425 Test Loss: 0.4475434
Validation loss decreased (1.427264 --> 1.413342).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 11 cost time: 1.5843994617462158
Epoch: 11, Steps: 52 | Train Loss: 0.4456309 Vali Loss: 1.3969387 Test Loss: 0.4387494
Validation loss decreased (1.413342 --> 1.396939).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 12 cost time: 1.5872783660888672
Epoch: 12, Steps: 52 | Train Loss: 0.4444101 Vali Loss: 1.3970420 Test Loss: 0.4328941
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 13 cost time: 1.5787460803985596
Epoch: 13, Steps: 52 | Train Loss: 0.4414325 Vali Loss: 1.3969612 Test Loss: 0.4292470
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 14 cost time: 1.5852632522583008
Epoch: 14, Steps: 52 | Train Loss: 0.4400985 Vali Loss: 1.3836358 Test Loss: 0.4255806
Validation loss decreased (1.396939 --> 1.383636).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 15 cost time: 1.5789756774902344
Epoch: 15, Steps: 52 | Train Loss: 0.4374927 Vali Loss: 1.3814367 Test Loss: 0.4236479
Validation loss decreased (1.383636 --> 1.381437).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 16 cost time: 1.5863642692565918
Epoch: 16, Steps: 52 | Train Loss: 0.4353717 Vali Loss: 1.3770633 Test Loss: 0.4200884
Validation loss decreased (1.381437 --> 1.377063).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 17 cost time: 1.5867609977722168
Epoch: 17, Steps: 52 | Train Loss: 0.4330696 Vali Loss: 1.3797874 Test Loss: 0.4192729
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 18 cost time: 1.5794358253479004
Epoch: 18, Steps: 52 | Train Loss: 0.4335649 Vali Loss: 1.3725514 Test Loss: 0.4166555
Validation loss decreased (1.377063 --> 1.372551).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 19 cost time: 1.582101821899414
Epoch: 19, Steps: 52 | Train Loss: 0.4330281 Vali Loss: 1.3716891 Test Loss: 0.4159294
Validation loss decreased (1.372551 --> 1.371689).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 20 cost time: 1.5797436237335205
Epoch: 20, Steps: 52 | Train Loss: 0.4310321 Vali Loss: 1.3656441 Test Loss: 0.4141044
Validation loss decreased (1.371689 --> 1.365644).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 21 cost time: 1.5739774703979492
Epoch: 21, Steps: 52 | Train Loss: 0.4299676 Vali Loss: 1.3702898 Test Loss: 0.4142498
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 22 cost time: 1.5755541324615479
Epoch: 22, Steps: 52 | Train Loss: 0.4293845 Vali Loss: 1.3712006 Test Loss: 0.4127885
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 23 cost time: 1.5779590606689453
Epoch: 23, Steps: 52 | Train Loss: 0.4292777 Vali Loss: 1.3558402 Test Loss: 0.4123489
Validation loss decreased (1.365644 --> 1.355840).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 24 cost time: 1.5767042636871338
Epoch: 24, Steps: 52 | Train Loss: 0.4288199 Vali Loss: 1.3619471 Test Loss: 0.4106241
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 25 cost time: 1.5734267234802246
Epoch: 25, Steps: 52 | Train Loss: 0.4268026 Vali Loss: 1.3573227 Test Loss: 0.4101649
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 26 cost time: 1.5824644565582275
Epoch: 26, Steps: 52 | Train Loss: 0.4275278 Vali Loss: 1.3626473 Test Loss: 0.4110238
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 27 cost time: 1.5762176513671875
Epoch: 27, Steps: 52 | Train Loss: 0.4276216 Vali Loss: 1.3635368 Test Loss: 0.4098927
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 28 cost time: 1.5825896263122559
Epoch: 28, Steps: 52 | Train Loss: 0.4288374 Vali Loss: 1.3634845 Test Loss: 0.4089741
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 29 cost time: 1.5835061073303223
Epoch: 29, Steps: 52 | Train Loss: 0.4282644 Vali Loss: 1.3586830 Test Loss: 0.4084143
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 30 cost time: 1.585541009902954
Epoch: 30, Steps: 52 | Train Loss: 0.4269489 Vali Loss: 1.3635522 Test Loss: 0.4098235
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 31 cost time: 1.5818703174591064
Epoch: 31, Steps: 52 | Train Loss: 0.4271338 Vali Loss: 1.3657391 Test Loss: 0.4083650
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 32 cost time: 1.5843451023101807
Epoch: 32, Steps: 52 | Train Loss: 0.4258609 Vali Loss: 1.3603891 Test Loss: 0.4076582
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 33 cost time: 1.5848827362060547
Epoch: 33, Steps: 52 | Train Loss: 0.4266741 Vali Loss: 1.3580884 Test Loss: 0.4077188
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 34 cost time: 1.5861461162567139
Epoch: 34, Steps: 52 | Train Loss: 0.4279373 Vali Loss: 1.3620365 Test Loss: 0.4075674
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 35 cost time: 1.5824990272521973
Epoch: 35, Steps: 52 | Train Loss: 0.4251440 Vali Loss: 1.3537569 Test Loss: 0.4078510
Validation loss decreased (1.355840 --> 1.353757).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 36 cost time: 1.586026668548584
Epoch: 36, Steps: 52 | Train Loss: 0.4259518 Vali Loss: 1.3633761 Test Loss: 0.4075858
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 37 cost time: 1.5822110176086426
Epoch: 37, Steps: 52 | Train Loss: 0.4254063 Vali Loss: 1.3486637 Test Loss: 0.4071395
Validation loss decreased (1.353757 --> 1.348664).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 38 cost time: 1.5846223831176758
Epoch: 38, Steps: 52 | Train Loss: 0.4269451 Vali Loss: 1.3568859 Test Loss: 0.4071027
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 39 cost time: 1.579932451248169
Epoch: 39, Steps: 52 | Train Loss: 0.4247068 Vali Loss: 1.3585174 Test Loss: 0.4066045
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 40 cost time: 1.5858542919158936
Epoch: 40, Steps: 52 | Train Loss: 0.4259027 Vali Loss: 1.3567407 Test Loss: 0.4067785
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 41 cost time: 1.5838725566864014
Epoch: 41, Steps: 52 | Train Loss: 0.4272267 Vali Loss: 1.3631063 Test Loss: 0.4064636
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 42 cost time: 1.5844542980194092
Epoch: 42, Steps: 52 | Train Loss: 0.4267634 Vali Loss: 1.3598518 Test Loss: 0.4063703
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 43 cost time: 1.5815908908843994
Epoch: 43, Steps: 52 | Train Loss: 0.4250894 Vali Loss: 1.3548939 Test Loss: 0.4065450
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 44 cost time: 1.5840983390808105
Epoch: 44, Steps: 52 | Train Loss: 0.4254082 Vali Loss: 1.3543811 Test Loss: 0.4071093
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 45 cost time: 1.5838181972503662
Epoch: 45, Steps: 52 | Train Loss: 0.4244919 Vali Loss: 1.3493052 Test Loss: 0.4064689
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 46 cost time: 1.5772204399108887
Epoch: 46, Steps: 52 | Train Loss: 0.4258617 Vali Loss: 1.3582563 Test Loss: 0.4055800
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 47 cost time: 1.5717113018035889
Epoch: 47, Steps: 52 | Train Loss: 0.4265655 Vali Loss: 1.3593692 Test Loss: 0.4064817
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 48 cost time: 1.579352617263794
Epoch: 48, Steps: 52 | Train Loss: 0.4257819 Vali Loss: 1.3584244 Test Loss: 0.4052041
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 49 cost time: 1.5783905982971191
Epoch: 49, Steps: 52 | Train Loss: 0.4256458 Vali Loss: 1.3633525 Test Loss: 0.4065779
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 50 cost time: 1.5804309844970703
Epoch: 50, Steps: 52 | Train Loss: 0.4232426 Vali Loss: 1.3631215 Test Loss: 0.4059907
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 51 cost time: 1.579617977142334
Epoch: 51, Steps: 52 | Train Loss: 0.4254040 Vali Loss: 1.3624625 Test Loss: 0.4058875
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 52 cost time: 1.5835599899291992
Epoch: 52, Steps: 52 | Train Loss: 0.4261104 Vali Loss: 1.3593187 Test Loss: 0.4058334
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 53 cost time: 1.5813734531402588
Epoch: 53, Steps: 52 | Train Loss: 0.4251852 Vali Loss: 1.3485159 Test Loss: 0.4054536
Validation loss decreased (1.348664 --> 1.348516).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 54 cost time: 1.5812170505523682
Epoch: 54, Steps: 52 | Train Loss: 0.4258913 Vali Loss: 1.3537388 Test Loss: 0.4055562
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 55 cost time: 1.5805423259735107
Epoch: 55, Steps: 52 | Train Loss: 0.4261784 Vali Loss: 1.3605161 Test Loss: 0.4059265
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 56 cost time: 1.571781873703003
Epoch: 56, Steps: 52 | Train Loss: 0.4248338 Vali Loss: 1.3447829 Test Loss: 0.4047742
Validation loss decreased (1.348516 --> 1.344783).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 57 cost time: 1.5813298225402832
Epoch: 57, Steps: 52 | Train Loss: 0.4241979 Vali Loss: 1.3576994 Test Loss: 0.4053080
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 58 cost time: 1.5793883800506592
Epoch: 58, Steps: 52 | Train Loss: 0.4244816 Vali Loss: 1.3565183 Test Loss: 0.4059288
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 59 cost time: 1.5843312740325928
Epoch: 59, Steps: 52 | Train Loss: 0.4246454 Vali Loss: 1.3612859 Test Loss: 0.4044907
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 60 cost time: 1.579590082168579
Epoch: 60, Steps: 52 | Train Loss: 0.4250739 Vali Loss: 1.3585384 Test Loss: 0.4051722
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.4047742187976837, mae:0.4444575309753418, rse:0.5212129950523376
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 1 cost time: 2.102882146835327
Epoch: 1, Steps: 52 | Train Loss: 0.6908224 Vali Loss: 2.1289673 Test Loss: 1.3510418
Validation loss decreased (inf --> 2.128967).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 2 cost time: 0.7286114692687988
Epoch: 2, Steps: 52 | Train Loss: 0.6022091 Vali Loss: 1.6401986 Test Loss: 0.7748491
Validation loss decreased (2.128967 --> 1.640199).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 3 cost time: 0.7313764095306396
Epoch: 3, Steps: 52 | Train Loss: 0.4882972 Vali Loss: 1.4473141 Test Loss: 0.4712141
Validation loss decreased (1.640199 --> 1.447314).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 4 cost time: 0.7293617725372314
Epoch: 4, Steps: 52 | Train Loss: 0.4491862 Vali Loss: 1.4083785 Test Loss: 0.4315348
Validation loss decreased (1.447314 --> 1.408378).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 5 cost time: 0.7367594242095947
Epoch: 5, Steps: 52 | Train Loss: 0.4397898 Vali Loss: 1.3935306 Test Loss: 0.4191654
Validation loss decreased (1.408378 --> 1.393531).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 6 cost time: 1.508331060409546
Epoch: 6, Steps: 52 | Train Loss: 0.4362842 Vali Loss: 1.3812822 Test Loss: 0.4093205
Validation loss decreased (1.393531 --> 1.381282).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 7 cost time: 1.6341800689697266
Epoch: 7, Steps: 52 | Train Loss: 0.4306464 Vali Loss: 1.3799725 Test Loss: 0.4033811
Validation loss decreased (1.381282 --> 1.379972).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 8 cost time: 1.652439832687378
Epoch: 8, Steps: 52 | Train Loss: 0.4286422 Vali Loss: 1.3682220 Test Loss: 0.3955226
Validation loss decreased (1.379972 --> 1.368222).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 9 cost time: 1.64937162399292
Epoch: 9, Steps: 52 | Train Loss: 0.4259507 Vali Loss: 1.3648053 Test Loss: 0.3910964
Validation loss decreased (1.368222 --> 1.364805).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 10 cost time: 1.646174669265747
Epoch: 10, Steps: 52 | Train Loss: 0.4234303 Vali Loss: 1.3531997 Test Loss: 0.3860957
Validation loss decreased (1.364805 --> 1.353200).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 11 cost time: 1.6496860980987549
Epoch: 11, Steps: 52 | Train Loss: 0.4212289 Vali Loss: 1.3558135 Test Loss: 0.3826085
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 12 cost time: 1.6414873600006104
Epoch: 12, Steps: 52 | Train Loss: 0.4206630 Vali Loss: 1.3407760 Test Loss: 0.3803087
Validation loss decreased (1.353200 --> 1.340776).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 13 cost time: 1.6365017890930176
Epoch: 13, Steps: 52 | Train Loss: 0.4176872 Vali Loss: 1.3442631 Test Loss: 0.3782047
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 14 cost time: 1.6330432891845703
Epoch: 14, Steps: 52 | Train Loss: 0.4170549 Vali Loss: 1.3336565 Test Loss: 0.3764912
Validation loss decreased (1.340776 --> 1.333657).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 15 cost time: 1.634460210800171
Epoch: 15, Steps: 52 | Train Loss: 0.4176922 Vali Loss: 1.3307498 Test Loss: 0.3747948
Validation loss decreased (1.333657 --> 1.330750).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 16 cost time: 1.6354477405548096
Epoch: 16, Steps: 52 | Train Loss: 0.4149252 Vali Loss: 1.3326081 Test Loss: 0.3729440
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 17 cost time: 1.643007516860962
Epoch: 17, Steps: 52 | Train Loss: 0.4155485 Vali Loss: 1.3352714 Test Loss: 0.3723080
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 18 cost time: 1.6348729133605957
Epoch: 18, Steps: 52 | Train Loss: 0.4156903 Vali Loss: 1.3340037 Test Loss: 0.3717441
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 19 cost time: 1.6444876194000244
Epoch: 19, Steps: 52 | Train Loss: 0.4133326 Vali Loss: 1.3279369 Test Loss: 0.3701112
Validation loss decreased (1.330750 --> 1.327937).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 20 cost time: 1.6305959224700928
Epoch: 20, Steps: 52 | Train Loss: 0.4154452 Vali Loss: 1.3265010 Test Loss: 0.3695209
Validation loss decreased (1.327937 --> 1.326501).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 21 cost time: 1.6439964771270752
Epoch: 21, Steps: 52 | Train Loss: 0.4130247 Vali Loss: 1.3281209 Test Loss: 0.3691090
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 22 cost time: 1.6443812847137451
Epoch: 22, Steps: 52 | Train Loss: 0.4141045 Vali Loss: 1.3275079 Test Loss: 0.3685188
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 23 cost time: 1.6367518901824951
Epoch: 23, Steps: 52 | Train Loss: 0.4132325 Vali Loss: 1.3254611 Test Loss: 0.3680234
Validation loss decreased (1.326501 --> 1.325461).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 24 cost time: 1.6406099796295166
Epoch: 24, Steps: 52 | Train Loss: 0.4114699 Vali Loss: 1.3172076 Test Loss: 0.3672504
Validation loss decreased (1.325461 --> 1.317208).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 25 cost time: 1.6514415740966797
Epoch: 25, Steps: 52 | Train Loss: 0.4124183 Vali Loss: 1.3213875 Test Loss: 0.3669769
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 26 cost time: 1.6257059574127197
Epoch: 26, Steps: 52 | Train Loss: 0.4135769 Vali Loss: 1.3264025 Test Loss: 0.3667424
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 27 cost time: 1.6343541145324707
Epoch: 27, Steps: 52 | Train Loss: 0.4125739 Vali Loss: 1.3217453 Test Loss: 0.3665827
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 28 cost time: 1.6292502880096436
Epoch: 28, Steps: 52 | Train Loss: 0.4106218 Vali Loss: 1.3235390 Test Loss: 0.3661748
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 29 cost time: 1.6314756870269775
Epoch: 29, Steps: 52 | Train Loss: 0.4130902 Vali Loss: 1.3157594 Test Loss: 0.3664983
Validation loss decreased (1.317208 --> 1.315759).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 30 cost time: 1.630737066268921
Epoch: 30, Steps: 52 | Train Loss: 0.4097074 Vali Loss: 1.3204380 Test Loss: 0.3657601
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 31 cost time: 1.644557237625122
Epoch: 31, Steps: 52 | Train Loss: 0.4113990 Vali Loss: 1.3209666 Test Loss: 0.3656868
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 32 cost time: 1.6404776573181152
Epoch: 32, Steps: 52 | Train Loss: 0.4107364 Vali Loss: 1.3110442 Test Loss: 0.3653347
Validation loss decreased (1.315759 --> 1.311044).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 33 cost time: 1.6462140083312988
Epoch: 33, Steps: 52 | Train Loss: 0.4121682 Vali Loss: 1.3197527 Test Loss: 0.3653954
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 34 cost time: 1.6229898929595947
Epoch: 34, Steps: 52 | Train Loss: 0.4125470 Vali Loss: 1.3085263 Test Loss: 0.3650544
Validation loss decreased (1.311044 --> 1.308526).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 35 cost time: 1.6284136772155762
Epoch: 35, Steps: 52 | Train Loss: 0.4107695 Vali Loss: 1.3124397 Test Loss: 0.3651921
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 36 cost time: 1.6348633766174316
Epoch: 36, Steps: 52 | Train Loss: 0.4112553 Vali Loss: 1.3110332 Test Loss: 0.3653641
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 37 cost time: 1.634401798248291
Epoch: 37, Steps: 52 | Train Loss: 0.4109812 Vali Loss: 1.3196151 Test Loss: 0.3647113
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 38 cost time: 1.6237342357635498
Epoch: 38, Steps: 52 | Train Loss: 0.4098585 Vali Loss: 1.3140122 Test Loss: 0.3647479
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 39 cost time: 1.6395058631896973
Epoch: 39, Steps: 52 | Train Loss: 0.4112028 Vali Loss: 1.3222072 Test Loss: 0.3649152
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 40 cost time: 1.6420872211456299
Epoch: 40, Steps: 52 | Train Loss: 0.4091415 Vali Loss: 1.3185749 Test Loss: 0.3649915
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 41 cost time: 1.6358520984649658
Epoch: 41, Steps: 52 | Train Loss: 0.4123734 Vali Loss: 1.3199426 Test Loss: 0.3647276
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 42 cost time: 1.6309573650360107
Epoch: 42, Steps: 52 | Train Loss: 0.4092836 Vali Loss: 1.3158579 Test Loss: 0.3646812
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 43 cost time: 1.6344704627990723
Epoch: 43, Steps: 52 | Train Loss: 0.4110887 Vali Loss: 1.3177466 Test Loss: 0.3645627
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 44 cost time: 1.6346416473388672
Epoch: 44, Steps: 52 | Train Loss: 0.4099432 Vali Loss: 1.3196863 Test Loss: 0.3646024
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 45 cost time: 1.634382963180542
Epoch: 45, Steps: 52 | Train Loss: 0.4109455 Vali Loss: 1.3184991 Test Loss: 0.3645963
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 46 cost time: 1.6300718784332275
Epoch: 46, Steps: 52 | Train Loss: 0.4089093 Vali Loss: 1.3176512 Test Loss: 0.3648735
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 47 cost time: 1.6366932392120361
Epoch: 47, Steps: 52 | Train Loss: 0.4113182 Vali Loss: 1.3144473 Test Loss: 0.3642579
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 48 cost time: 1.6430010795593262
Epoch: 48, Steps: 52 | Train Loss: 0.4101906 Vali Loss: 1.3159704 Test Loss: 0.3642959
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 49 cost time: 1.645343542098999
Epoch: 49, Steps: 52 | Train Loss: 0.4099062 Vali Loss: 1.3153038 Test Loss: 0.3644268
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 50 cost time: 1.634911060333252
Epoch: 50, Steps: 52 | Train Loss: 0.4107866 Vali Loss: 1.3144292 Test Loss: 0.3642969
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 51 cost time: 1.626706600189209
Epoch: 51, Steps: 52 | Train Loss: 0.4106102 Vali Loss: 1.3104997 Test Loss: 0.3645720
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 52 cost time: 1.6353754997253418
Epoch: 52, Steps: 52 | Train Loss: 0.4101048 Vali Loss: 1.3191614 Test Loss: 0.3645837
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 53 cost time: 1.6370644569396973
Epoch: 53, Steps: 52 | Train Loss: 0.4111577 Vali Loss: 1.3126724 Test Loss: 0.3644721
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 54 cost time: 1.652510404586792
Epoch: 54, Steps: 52 | Train Loss: 0.4091990 Vali Loss: 1.3010612 Test Loss: 0.3647234
Validation loss decreased (1.308526 --> 1.301061).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 55 cost time: 1.6276724338531494
Epoch: 55, Steps: 52 | Train Loss: 0.4101991 Vali Loss: 1.3097327 Test Loss: 0.3642346
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 56 cost time: 1.635249137878418
Epoch: 56, Steps: 52 | Train Loss: 0.4107259 Vali Loss: 1.3187088 Test Loss: 0.3646123
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 57 cost time: 1.6338996887207031
Epoch: 57, Steps: 52 | Train Loss: 0.4096786 Vali Loss: 1.3119687 Test Loss: 0.3642674
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 58 cost time: 1.6437652111053467
Epoch: 58, Steps: 52 | Train Loss: 0.4095647 Vali Loss: 1.3073894 Test Loss: 0.3642715
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 59 cost time: 1.641392707824707
Epoch: 59, Steps: 52 | Train Loss: 0.4092386 Vali Loss: 1.3196032 Test Loss: 0.3642843
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 60 cost time: 1.6296522617340088
Epoch: 60, Steps: 52 | Train Loss: 0.4109325 Vali Loss: 1.3184553 Test Loss: 0.3644596
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3647233545780182, mae:0.4130512475967407, rse:0.49475547671318054
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05333375930786133 GB
Epoch: 1 cost time: 2.183640956878662
Epoch: 1, Steps: 52 | Train Loss: 0.7054324 Vali Loss: 2.1551163 Test Loss: 1.4154145
Validation loss decreased (inf --> 2.155116).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 2 cost time: 0.7608251571655273
Epoch: 2, Steps: 52 | Train Loss: 0.5947542 Vali Loss: 1.5439234 Test Loss: 0.6322219
Validation loss decreased (2.155116 --> 1.543923).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 3 cost time: 0.7649998664855957
Epoch: 3, Steps: 52 | Train Loss: 0.4669668 Vali Loss: 1.4123905 Test Loss: 0.4299912
Validation loss decreased (1.543923 --> 1.412390).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 4 cost time: 0.7644004821777344
Epoch: 4, Steps: 52 | Train Loss: 0.4443334 Vali Loss: 1.3912714 Test Loss: 0.4150774
Validation loss decreased (1.412390 --> 1.391271).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 5 cost time: 0.7713205814361572
Epoch: 5, Steps: 52 | Train Loss: 0.4334713 Vali Loss: 1.3829465 Test Loss: 0.4036887
Validation loss decreased (1.391271 --> 1.382946).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 6 cost time: 1.6789889335632324
Epoch: 6, Steps: 52 | Train Loss: 0.4296350 Vali Loss: 1.3650583 Test Loss: 0.3937749
Validation loss decreased (1.382946 --> 1.365058).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 7 cost time: 1.6819207668304443
Epoch: 7, Steps: 52 | Train Loss: 0.4240004 Vali Loss: 1.3537924 Test Loss: 0.3848933
Validation loss decreased (1.365058 --> 1.353792).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 8 cost time: 1.7126827239990234
Epoch: 8, Steps: 52 | Train Loss: 0.4237431 Vali Loss: 1.3544012 Test Loss: 0.3796174
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 9 cost time: 1.697815179824829
Epoch: 9, Steps: 52 | Train Loss: 0.4188371 Vali Loss: 1.3467138 Test Loss: 0.3744772
Validation loss decreased (1.353792 --> 1.346714).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 10 cost time: 1.6845102310180664
Epoch: 10, Steps: 52 | Train Loss: 0.4175242 Vali Loss: 1.3442776 Test Loss: 0.3716706
Validation loss decreased (1.346714 --> 1.344278).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 11 cost time: 1.7001266479492188
Epoch: 11, Steps: 52 | Train Loss: 0.4159801 Vali Loss: 1.3398761 Test Loss: 0.3685967
Validation loss decreased (1.344278 --> 1.339876).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 12 cost time: 1.6820387840270996
Epoch: 12, Steps: 52 | Train Loss: 0.4163978 Vali Loss: 1.3355848 Test Loss: 0.3663582
Validation loss decreased (1.339876 --> 1.335585).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 13 cost time: 1.6953954696655273
Epoch: 13, Steps: 52 | Train Loss: 0.4135969 Vali Loss: 1.3259112 Test Loss: 0.3650168
Validation loss decreased (1.335585 --> 1.325911).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 14 cost time: 1.7083425521850586
Epoch: 14, Steps: 52 | Train Loss: 0.4138679 Vali Loss: 1.3254714 Test Loss: 0.3633367
Validation loss decreased (1.325911 --> 1.325471).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 15 cost time: 1.6865465641021729
Epoch: 15, Steps: 52 | Train Loss: 0.4115002 Vali Loss: 1.3205292 Test Loss: 0.3626169
Validation loss decreased (1.325471 --> 1.320529).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 16 cost time: 1.6857068538665771
Epoch: 16, Steps: 52 | Train Loss: 0.4131861 Vali Loss: 1.3144523 Test Loss: 0.3615833
Validation loss decreased (1.320529 --> 1.314452).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 17 cost time: 1.69175124168396
Epoch: 17, Steps: 52 | Train Loss: 0.4102111 Vali Loss: 1.3126211 Test Loss: 0.3605278
Validation loss decreased (1.314452 --> 1.312621).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 18 cost time: 1.6820049285888672
Epoch: 18, Steps: 52 | Train Loss: 0.4116346 Vali Loss: 1.3097252 Test Loss: 0.3603510
Validation loss decreased (1.312621 --> 1.309725).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 19 cost time: 1.6940009593963623
Epoch: 19, Steps: 52 | Train Loss: 0.4099154 Vali Loss: 1.3190475 Test Loss: 0.3594799
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 20 cost time: 1.7005667686462402
Epoch: 20, Steps: 52 | Train Loss: 0.4102477 Vali Loss: 1.3139939 Test Loss: 0.3600004
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 21 cost time: 1.6789321899414062
Epoch: 21, Steps: 52 | Train Loss: 0.4112628 Vali Loss: 1.3108157 Test Loss: 0.3590930
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 22 cost time: 1.69234299659729
Epoch: 22, Steps: 52 | Train Loss: 0.4115357 Vali Loss: 1.3132997 Test Loss: 0.3592210
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 23 cost time: 1.7058007717132568
Epoch: 23, Steps: 52 | Train Loss: 0.4086784 Vali Loss: 1.3117049 Test Loss: 0.3586902
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 24 cost time: 1.6775538921356201
Epoch: 24, Steps: 52 | Train Loss: 0.4084209 Vali Loss: 1.3071696 Test Loss: 0.3584814
Validation loss decreased (1.309725 --> 1.307170).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 25 cost time: 1.6996941566467285
Epoch: 25, Steps: 52 | Train Loss: 0.4088329 Vali Loss: 1.3109902 Test Loss: 0.3582363
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 26 cost time: 1.6834402084350586
Epoch: 26, Steps: 52 | Train Loss: 0.4084751 Vali Loss: 1.3154643 Test Loss: 0.3575879
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 27 cost time: 1.6807608604431152
Epoch: 27, Steps: 52 | Train Loss: 0.4089120 Vali Loss: 1.3125178 Test Loss: 0.3580157
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 28 cost time: 1.6971538066864014
Epoch: 28, Steps: 52 | Train Loss: 0.4070168 Vali Loss: 1.3095840 Test Loss: 0.3576496
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 29 cost time: 1.687741756439209
Epoch: 29, Steps: 52 | Train Loss: 0.4081505 Vali Loss: 1.3091547 Test Loss: 0.3579524
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 30 cost time: 1.6718132495880127
Epoch: 30, Steps: 52 | Train Loss: 0.4086332 Vali Loss: 1.3088727 Test Loss: 0.3574273
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 31 cost time: 1.7031378746032715
Epoch: 31, Steps: 52 | Train Loss: 0.4078229 Vali Loss: 1.3100982 Test Loss: 0.3569064
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 32 cost time: 1.6791737079620361
Epoch: 32, Steps: 52 | Train Loss: 0.4084519 Vali Loss: 1.3044350 Test Loss: 0.3571632
Validation loss decreased (1.307170 --> 1.304435).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 33 cost time: 1.692870855331421
Epoch: 33, Steps: 52 | Train Loss: 0.4071043 Vali Loss: 1.3116142 Test Loss: 0.3569813
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 34 cost time: 1.698713779449463
Epoch: 34, Steps: 52 | Train Loss: 0.4071189 Vali Loss: 1.3082148 Test Loss: 0.3568570
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 35 cost time: 1.6865735054016113
Epoch: 35, Steps: 52 | Train Loss: 0.4076599 Vali Loss: 1.3145946 Test Loss: 0.3573899
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 36 cost time: 1.690443992614746
Epoch: 36, Steps: 52 | Train Loss: 0.4078202 Vali Loss: 1.3010468 Test Loss: 0.3572078
Validation loss decreased (1.304435 --> 1.301047).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 37 cost time: 1.7044601440429688
Epoch: 37, Steps: 52 | Train Loss: 0.4071681 Vali Loss: 1.2996199 Test Loss: 0.3570642
Validation loss decreased (1.301047 --> 1.299620).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 38 cost time: 1.6798803806304932
Epoch: 38, Steps: 52 | Train Loss: 0.4073575 Vali Loss: 1.3148515 Test Loss: 0.3574491
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 39 cost time: 1.6959257125854492
Epoch: 39, Steps: 52 | Train Loss: 0.4072854 Vali Loss: 1.3078089 Test Loss: 0.3571508
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 40 cost time: 1.680607557296753
Epoch: 40, Steps: 52 | Train Loss: 0.4069035 Vali Loss: 1.2980168 Test Loss: 0.3571512
Validation loss decreased (1.299620 --> 1.298017).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 41 cost time: 1.7013070583343506
Epoch: 41, Steps: 52 | Train Loss: 0.4072732 Vali Loss: 1.3054793 Test Loss: 0.3570316
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 42 cost time: 1.6861951351165771
Epoch: 42, Steps: 52 | Train Loss: 0.4069575 Vali Loss: 1.3092302 Test Loss: 0.3571091
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 43 cost time: 1.6763396263122559
Epoch: 43, Steps: 52 | Train Loss: 0.4053926 Vali Loss: 1.3135309 Test Loss: 0.3573815
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 44 cost time: 1.699636459350586
Epoch: 44, Steps: 52 | Train Loss: 0.4078038 Vali Loss: 1.3082756 Test Loss: 0.3569515
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 45 cost time: 1.6845283508300781
Epoch: 45, Steps: 52 | Train Loss: 0.4065490 Vali Loss: 1.2980586 Test Loss: 0.3570791
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 46 cost time: 1.6808793544769287
Epoch: 46, Steps: 52 | Train Loss: 0.4054471 Vali Loss: 1.3062474 Test Loss: 0.3566900
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 47 cost time: 1.6989271640777588
Epoch: 47, Steps: 52 | Train Loss: 0.4082913 Vali Loss: 1.2947612 Test Loss: 0.3568920
Validation loss decreased (1.298017 --> 1.294761).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 48 cost time: 1.7039954662322998
Epoch: 48, Steps: 52 | Train Loss: 0.4081264 Vali Loss: 1.3013933 Test Loss: 0.3571185
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 49 cost time: 1.680133581161499
Epoch: 49, Steps: 52 | Train Loss: 0.4065101 Vali Loss: 1.3035376 Test Loss: 0.3568012
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 50 cost time: 1.7050018310546875
Epoch: 50, Steps: 52 | Train Loss: 0.4076518 Vali Loss: 1.3036662 Test Loss: 0.3572178
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 51 cost time: 1.6815061569213867
Epoch: 51, Steps: 52 | Train Loss: 0.4066518 Vali Loss: 1.3117990 Test Loss: 0.3568227
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 52 cost time: 1.6990087032318115
Epoch: 52, Steps: 52 | Train Loss: 0.4070974 Vali Loss: 1.3097297 Test Loss: 0.3569518
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 53 cost time: 1.701582670211792
Epoch: 53, Steps: 52 | Train Loss: 0.4079346 Vali Loss: 1.3143582 Test Loss: 0.3570375
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 54 cost time: 1.6835658550262451
Epoch: 54, Steps: 52 | Train Loss: 0.4067589 Vali Loss: 1.3078974 Test Loss: 0.3571693
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 55 cost time: 1.7044048309326172
Epoch: 55, Steps: 52 | Train Loss: 0.4063864 Vali Loss: 1.3100032 Test Loss: 0.3572483
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 56 cost time: 1.6845309734344482
Epoch: 56, Steps: 52 | Train Loss: 0.4061332 Vali Loss: 1.3025836 Test Loss: 0.3575910
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 57 cost time: 1.7001678943634033
Epoch: 57, Steps: 52 | Train Loss: 0.4066532 Vali Loss: 1.3062301 Test Loss: 0.3567965
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 58 cost time: 1.6842100620269775
Epoch: 58, Steps: 52 | Train Loss: 0.4068840 Vali Loss: 1.3110952 Test Loss: 0.3572076
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 59 cost time: 1.6920998096466064
Epoch: 59, Steps: 52 | Train Loss: 0.4069023 Vali Loss: 1.3035431 Test Loss: 0.3567037
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 60 cost time: 1.6848478317260742
Epoch: 60, Steps: 52 | Train Loss: 0.4074468 Vali Loss: 1.3068280 Test Loss: 0.3567691
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35689201951026917, mae:0.40612080693244934, rse:0.4894149601459503
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.04620790481567383 GB
Epoch: 1 cost time: 2.1285181045532227
Epoch: 1, Steps: 52 | Train Loss: 0.7377898 Vali Loss: 2.1624389 Test Loss: 1.3740408
Validation loss decreased (inf --> 2.162439).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 2 cost time: 0.7212204933166504
Epoch: 2, Steps: 52 | Train Loss: 0.6802529 Vali Loss: 1.8789167 Test Loss: 1.0490916
Validation loss decreased (2.162439 --> 1.878917).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 3 cost time: 0.6992185115814209
Epoch: 3, Steps: 52 | Train Loss: 0.5957094 Vali Loss: 1.6804805 Test Loss: 0.8004967
Validation loss decreased (1.878917 --> 1.680480).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 4 cost time: 0.7046413421630859
Epoch: 4, Steps: 52 | Train Loss: 0.5325671 Vali Loss: 1.5533962 Test Loss: 0.6300176
Validation loss decreased (1.680480 --> 1.553396).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 5 cost time: 0.7163469791412354
Epoch: 5, Steps: 52 | Train Loss: 0.4960892 Vali Loss: 1.4896199 Test Loss: 0.5360862
Validation loss decreased (1.553396 --> 1.489620).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 6 cost time: 1.4124226570129395
Epoch: 6, Steps: 52 | Train Loss: 0.4740554 Vali Loss: 1.4534806 Test Loss: 0.4880999
Validation loss decreased (1.489620 --> 1.453481).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 7 cost time: 1.5852305889129639
Epoch: 7, Steps: 52 | Train Loss: 0.4603361 Vali Loss: 1.4332746 Test Loss: 0.4588857
Validation loss decreased (1.453481 --> 1.433275).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 8 cost time: 1.591482162475586
Epoch: 8, Steps: 52 | Train Loss: 0.4533058 Vali Loss: 1.4138994 Test Loss: 0.4407236
Validation loss decreased (1.433275 --> 1.413899).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 9 cost time: 1.589125633239746
Epoch: 9, Steps: 52 | Train Loss: 0.4462714 Vali Loss: 1.4120617 Test Loss: 0.4310901
Validation loss decreased (1.413899 --> 1.412062).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 10 cost time: 1.6012179851531982
Epoch: 10, Steps: 52 | Train Loss: 0.4442983 Vali Loss: 1.4044771 Test Loss: 0.4216737
Validation loss decreased (1.412062 --> 1.404477).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 11 cost time: 1.5964665412902832
Epoch: 11, Steps: 52 | Train Loss: 0.4408904 Vali Loss: 1.3934101 Test Loss: 0.4158268
Validation loss decreased (1.404477 --> 1.393410).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 12 cost time: 1.598991870880127
Epoch: 12, Steps: 52 | Train Loss: 0.4372242 Vali Loss: 1.3933975 Test Loss: 0.4120839
Validation loss decreased (1.393410 --> 1.393397).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 13 cost time: 1.6014883518218994
Epoch: 13, Steps: 52 | Train Loss: 0.4377393 Vali Loss: 1.3862643 Test Loss: 0.4085542
Validation loss decreased (1.393397 --> 1.386264).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 14 cost time: 1.598928451538086
Epoch: 14, Steps: 52 | Train Loss: 0.4315402 Vali Loss: 1.3854530 Test Loss: 0.4049929
Validation loss decreased (1.386264 --> 1.385453).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 15 cost time: 1.5949499607086182
Epoch: 15, Steps: 52 | Train Loss: 0.4335610 Vali Loss: 1.3752472 Test Loss: 0.4047374
Validation loss decreased (1.385453 --> 1.375247).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 16 cost time: 1.596076250076294
Epoch: 16, Steps: 52 | Train Loss: 0.4309923 Vali Loss: 1.3775913 Test Loss: 0.4018884
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 17 cost time: 1.5928187370300293
Epoch: 17, Steps: 52 | Train Loss: 0.4314761 Vali Loss: 1.3770808 Test Loss: 0.3990651
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 18 cost time: 1.595597505569458
Epoch: 18, Steps: 52 | Train Loss: 0.4287094 Vali Loss: 1.3697946 Test Loss: 0.3996165
Validation loss decreased (1.375247 --> 1.369795).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 19 cost time: 1.589785099029541
Epoch: 19, Steps: 52 | Train Loss: 0.4275163 Vali Loss: 1.3672726 Test Loss: 0.3971962
Validation loss decreased (1.369795 --> 1.367273).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 20 cost time: 1.5961472988128662
Epoch: 20, Steps: 52 | Train Loss: 0.4284701 Vali Loss: 1.3576448 Test Loss: 0.3971990
Validation loss decreased (1.367273 --> 1.357645).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 21 cost time: 1.591400146484375
Epoch: 21, Steps: 52 | Train Loss: 0.4258152 Vali Loss: 1.3638847 Test Loss: 0.3962699
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 22 cost time: 1.5913441181182861
Epoch: 22, Steps: 52 | Train Loss: 0.4258527 Vali Loss: 1.3702927 Test Loss: 0.3944485
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 23 cost time: 1.5970540046691895
Epoch: 23, Steps: 52 | Train Loss: 0.4246662 Vali Loss: 1.3635633 Test Loss: 0.3940741
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 24 cost time: 1.6006286144256592
Epoch: 24, Steps: 52 | Train Loss: 0.4244032 Vali Loss: 1.3569841 Test Loss: 0.3934603
Validation loss decreased (1.357645 --> 1.356984).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 25 cost time: 1.5947165489196777
Epoch: 25, Steps: 52 | Train Loss: 0.4239813 Vali Loss: 1.3594909 Test Loss: 0.3924502
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 26 cost time: 1.5980665683746338
Epoch: 26, Steps: 52 | Train Loss: 0.4231955 Vali Loss: 1.3606148 Test Loss: 0.3919522
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 27 cost time: 1.593634843826294
Epoch: 27, Steps: 52 | Train Loss: 0.4238577 Vali Loss: 1.3580506 Test Loss: 0.3913402
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 28 cost time: 1.5929648876190186
Epoch: 28, Steps: 52 | Train Loss: 0.4238959 Vali Loss: 1.3653245 Test Loss: 0.3908142
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 29 cost time: 1.5898518562316895
Epoch: 29, Steps: 52 | Train Loss: 0.4237071 Vali Loss: 1.3349999 Test Loss: 0.3906874
Validation loss decreased (1.356984 --> 1.335000).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 30 cost time: 1.6025488376617432
Epoch: 30, Steps: 52 | Train Loss: 0.4218752 Vali Loss: 1.3588728 Test Loss: 0.3909004
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 31 cost time: 1.5955026149749756
Epoch: 31, Steps: 52 | Train Loss: 0.4226846 Vali Loss: 1.3531988 Test Loss: 0.3902748
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 32 cost time: 1.5985023975372314
Epoch: 32, Steps: 52 | Train Loss: 0.4225147 Vali Loss: 1.3618275 Test Loss: 0.3900961
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 33 cost time: 1.5925779342651367
Epoch: 33, Steps: 52 | Train Loss: 0.4219273 Vali Loss: 1.3498375 Test Loss: 0.3900120
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 34 cost time: 1.5893199443817139
Epoch: 34, Steps: 52 | Train Loss: 0.4223276 Vali Loss: 1.3589880 Test Loss: 0.3902348
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 35 cost time: 1.5864460468292236
Epoch: 35, Steps: 52 | Train Loss: 0.4221158 Vali Loss: 1.3641827 Test Loss: 0.3892526
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 36 cost time: 1.5922961235046387
Epoch: 36, Steps: 52 | Train Loss: 0.4215659 Vali Loss: 1.3582740 Test Loss: 0.3896202
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 37 cost time: 1.5893874168395996
Epoch: 37, Steps: 52 | Train Loss: 0.4229677 Vali Loss: 1.3554919 Test Loss: 0.3891607
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 38 cost time: 1.5946500301361084
Epoch: 38, Steps: 52 | Train Loss: 0.4205328 Vali Loss: 1.3569167 Test Loss: 0.3888028
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 39 cost time: 1.5912742614746094
Epoch: 39, Steps: 52 | Train Loss: 0.4204917 Vali Loss: 1.3558282 Test Loss: 0.3890412
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 40 cost time: 1.5960054397583008
Epoch: 40, Steps: 52 | Train Loss: 0.4234155 Vali Loss: 1.3600378 Test Loss: 0.3888234
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 41 cost time: 1.5941908359527588
Epoch: 41, Steps: 52 | Train Loss: 0.4214710 Vali Loss: 1.3566706 Test Loss: 0.3884721
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 42 cost time: 1.5984747409820557
Epoch: 42, Steps: 52 | Train Loss: 0.4215746 Vali Loss: 1.3597026 Test Loss: 0.3885009
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 43 cost time: 1.5953078269958496
Epoch: 43, Steps: 52 | Train Loss: 0.4211410 Vali Loss: 1.3552884 Test Loss: 0.3887197
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 44 cost time: 1.6000409126281738
Epoch: 44, Steps: 52 | Train Loss: 0.4217356 Vali Loss: 1.3513739 Test Loss: 0.3878942
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 45 cost time: 1.5984563827514648
Epoch: 45, Steps: 52 | Train Loss: 0.4225663 Vali Loss: 1.3458242 Test Loss: 0.3883808
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 46 cost time: 1.5944559574127197
Epoch: 46, Steps: 52 | Train Loss: 0.4206697 Vali Loss: 1.3555241 Test Loss: 0.3878887
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 47 cost time: 1.5949718952178955
Epoch: 47, Steps: 52 | Train Loss: 0.4215388 Vali Loss: 1.3506916 Test Loss: 0.3886403
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 48 cost time: 1.5981855392456055
Epoch: 48, Steps: 52 | Train Loss: 0.4207589 Vali Loss: 1.3608747 Test Loss: 0.3876702
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 49 cost time: 1.5977587699890137
Epoch: 49, Steps: 52 | Train Loss: 0.4203338 Vali Loss: 1.3594550 Test Loss: 0.3881376
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 50 cost time: 1.5961308479309082
Epoch: 50, Steps: 52 | Train Loss: 0.4218155 Vali Loss: 1.3515303 Test Loss: 0.3878597
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 51 cost time: 1.5933189392089844
Epoch: 51, Steps: 52 | Train Loss: 0.4196431 Vali Loss: 1.3614482 Test Loss: 0.3882787
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 52 cost time: 1.5941603183746338
Epoch: 52, Steps: 52 | Train Loss: 0.4205857 Vali Loss: 1.3569945 Test Loss: 0.3876587
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 53 cost time: 1.5901191234588623
Epoch: 53, Steps: 52 | Train Loss: 0.4202051 Vali Loss: 1.3500979 Test Loss: 0.3875847
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 54 cost time: 1.5949149131774902
Epoch: 54, Steps: 52 | Train Loss: 0.4213055 Vali Loss: 1.3498590 Test Loss: 0.3877334
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 55 cost time: 1.5922064781188965
Epoch: 55, Steps: 52 | Train Loss: 0.4213247 Vali Loss: 1.3519752 Test Loss: 0.3872367
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 56 cost time: 1.5883595943450928
Epoch: 56, Steps: 52 | Train Loss: 0.4215185 Vali Loss: 1.3560586 Test Loss: 0.3877231
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 57 cost time: 1.5845112800598145
Epoch: 57, Steps: 52 | Train Loss: 0.4214800 Vali Loss: 1.3534949 Test Loss: 0.3873267
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 58 cost time: 1.5885810852050781
Epoch: 58, Steps: 52 | Train Loss: 0.4207145 Vali Loss: 1.3607825 Test Loss: 0.3878413
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 59 cost time: 1.594567060470581
Epoch: 59, Steps: 52 | Train Loss: 0.4215848 Vali Loss: 1.3566949 Test Loss: 0.3873778
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 60 cost time: 1.5919735431671143
Epoch: 60, Steps: 52 | Train Loss: 0.4203801 Vali Loss: 1.3509295 Test Loss: 0.3874597
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3906874656677246, mae:0.4315784275531769, rse:0.512063205242157
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 1 cost time: 2.1026687622070312
Epoch: 1, Steps: 52 | Train Loss: 0.6975828 Vali Loss: 2.1280041 Test Loss: 1.3538264
Validation loss decreased (inf --> 2.128004).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 2 cost time: 0.7436280250549316
Epoch: 2, Steps: 52 | Train Loss: 0.5940849 Vali Loss: 1.5848985 Test Loss: 0.6756521
Validation loss decreased (2.128004 --> 1.584898).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 3 cost time: 0.7444510459899902
Epoch: 3, Steps: 52 | Train Loss: 0.4709202 Vali Loss: 1.4228672 Test Loss: 0.4329249
Validation loss decreased (1.584898 --> 1.422867).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 4 cost time: 0.750352144241333
Epoch: 4, Steps: 52 | Train Loss: 0.4445248 Vali Loss: 1.4040818 Test Loss: 0.4230850
Validation loss decreased (1.422867 --> 1.404082).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 5 cost time: 0.7297945022583008
Epoch: 5, Steps: 52 | Train Loss: 0.4346035 Vali Loss: 1.3926717 Test Loss: 0.4115225
Validation loss decreased (1.404082 --> 1.392672).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 6 cost time: 1.6153554916381836
Epoch: 6, Steps: 52 | Train Loss: 0.4308661 Vali Loss: 1.3783442 Test Loss: 0.4056449
Validation loss decreased (1.392672 --> 1.378344).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 7 cost time: 1.6392886638641357
Epoch: 7, Steps: 52 | Train Loss: 0.4271502 Vali Loss: 1.3672364 Test Loss: 0.4002592
Validation loss decreased (1.378344 --> 1.367236).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 8 cost time: 1.6500632762908936
Epoch: 8, Steps: 52 | Train Loss: 0.4255771 Vali Loss: 1.3599346 Test Loss: 0.3958811
Validation loss decreased (1.367236 --> 1.359935).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 9 cost time: 1.6382477283477783
Epoch: 9, Steps: 52 | Train Loss: 0.4226066 Vali Loss: 1.3521763 Test Loss: 0.3920765
Validation loss decreased (1.359935 --> 1.352176).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 10 cost time: 1.6440250873565674
Epoch: 10, Steps: 52 | Train Loss: 0.4209147 Vali Loss: 1.3564371 Test Loss: 0.3887998
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 11 cost time: 1.6568655967712402
Epoch: 11, Steps: 52 | Train Loss: 0.4191163 Vali Loss: 1.3423805 Test Loss: 0.3855706
Validation loss decreased (1.352176 --> 1.342381).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 12 cost time: 1.639275312423706
Epoch: 12, Steps: 52 | Train Loss: 0.4170568 Vali Loss: 1.3430347 Test Loss: 0.3835683
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 13 cost time: 1.652766227722168
Epoch: 13, Steps: 52 | Train Loss: 0.4164602 Vali Loss: 1.3393745 Test Loss: 0.3822581
Validation loss decreased (1.342381 --> 1.339375).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 14 cost time: 1.6395554542541504
Epoch: 14, Steps: 52 | Train Loss: 0.4145884 Vali Loss: 1.3377653 Test Loss: 0.3799214
Validation loss decreased (1.339375 --> 1.337765).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 15 cost time: 1.6421031951904297
Epoch: 15, Steps: 52 | Train Loss: 0.4150917 Vali Loss: 1.3362689 Test Loss: 0.3781637
Validation loss decreased (1.337765 --> 1.336269).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 16 cost time: 1.643092155456543
Epoch: 16, Steps: 52 | Train Loss: 0.4127804 Vali Loss: 1.3359691 Test Loss: 0.3769122
Validation loss decreased (1.336269 --> 1.335969).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 17 cost time: 1.6531615257263184
Epoch: 17, Steps: 52 | Train Loss: 0.4132399 Vali Loss: 1.3277657 Test Loss: 0.3756057
Validation loss decreased (1.335969 --> 1.327766).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 18 cost time: 1.6473870277404785
Epoch: 18, Steps: 52 | Train Loss: 0.4127142 Vali Loss: 1.3349417 Test Loss: 0.3745468
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 19 cost time: 1.6391961574554443
Epoch: 19, Steps: 52 | Train Loss: 0.4118092 Vali Loss: 1.3191898 Test Loss: 0.3737218
Validation loss decreased (1.327766 --> 1.319190).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 20 cost time: 1.6494598388671875
Epoch: 20, Steps: 52 | Train Loss: 0.4115331 Vali Loss: 1.3216120 Test Loss: 0.3729986
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 21 cost time: 1.6556313037872314
Epoch: 21, Steps: 52 | Train Loss: 0.4112317 Vali Loss: 1.3183652 Test Loss: 0.3726717
Validation loss decreased (1.319190 --> 1.318365).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 22 cost time: 1.6407206058502197
Epoch: 22, Steps: 52 | Train Loss: 0.4115518 Vali Loss: 1.3223011 Test Loss: 0.3716280
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 23 cost time: 1.6385445594787598
Epoch: 23, Steps: 52 | Train Loss: 0.4101136 Vali Loss: 1.3124764 Test Loss: 0.3713212
Validation loss decreased (1.318365 --> 1.312476).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 24 cost time: 1.6507086753845215
Epoch: 24, Steps: 52 | Train Loss: 0.4096137 Vali Loss: 1.3242940 Test Loss: 0.3711722
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 25 cost time: 1.6535124778747559
Epoch: 25, Steps: 52 | Train Loss: 0.4089366 Vali Loss: 1.3227015 Test Loss: 0.3704506
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 26 cost time: 1.6400182247161865
Epoch: 26, Steps: 52 | Train Loss: 0.4094922 Vali Loss: 1.3260458 Test Loss: 0.3701149
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 27 cost time: 1.6396725177764893
Epoch: 27, Steps: 52 | Train Loss: 0.4104127 Vali Loss: 1.3231244 Test Loss: 0.3699685
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 28 cost time: 1.6457765102386475
Epoch: 28, Steps: 52 | Train Loss: 0.4095799 Vali Loss: 1.3185809 Test Loss: 0.3698531
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 29 cost time: 1.651047945022583
Epoch: 29, Steps: 52 | Train Loss: 0.4086189 Vali Loss: 1.3123385 Test Loss: 0.3694465
Validation loss decreased (1.312476 --> 1.312338).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 30 cost time: 1.645214319229126
Epoch: 30, Steps: 52 | Train Loss: 0.4085963 Vali Loss: 1.3215569 Test Loss: 0.3690936
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 31 cost time: 1.6351449489593506
Epoch: 31, Steps: 52 | Train Loss: 0.4085562 Vali Loss: 1.3217902 Test Loss: 0.3687537
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 32 cost time: 1.6454076766967773
Epoch: 32, Steps: 52 | Train Loss: 0.4087831 Vali Loss: 1.3189235 Test Loss: 0.3689443
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 33 cost time: 1.6516594886779785
Epoch: 33, Steps: 52 | Train Loss: 0.4074670 Vali Loss: 1.3182352 Test Loss: 0.3685191
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 34 cost time: 1.6383094787597656
Epoch: 34, Steps: 52 | Train Loss: 0.4062391 Vali Loss: 1.3163821 Test Loss: 0.3686748
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 35 cost time: 1.642709493637085
Epoch: 35, Steps: 52 | Train Loss: 0.4084806 Vali Loss: 1.3138025 Test Loss: 0.3689619
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 36 cost time: 1.641972303390503
Epoch: 36, Steps: 52 | Train Loss: 0.4079936 Vali Loss: 1.3168344 Test Loss: 0.3684925
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 37 cost time: 1.6456663608551025
Epoch: 37, Steps: 52 | Train Loss: 0.4074033 Vali Loss: 1.3191295 Test Loss: 0.3681841
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 38 cost time: 1.642465591430664
Epoch: 38, Steps: 52 | Train Loss: 0.4074125 Vali Loss: 1.3137470 Test Loss: 0.3681192
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 39 cost time: 1.6435251235961914
Epoch: 39, Steps: 52 | Train Loss: 0.4085394 Vali Loss: 1.3163235 Test Loss: 0.3682868
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 40 cost time: 1.6581552028656006
Epoch: 40, Steps: 52 | Train Loss: 0.4084069 Vali Loss: 1.3125417 Test Loss: 0.3680349
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 41 cost time: 1.6371169090270996
Epoch: 41, Steps: 52 | Train Loss: 0.4084947 Vali Loss: 1.3126773 Test Loss: 0.3678600
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 42 cost time: 1.6483726501464844
Epoch: 42, Steps: 52 | Train Loss: 0.4071242 Vali Loss: 1.3162949 Test Loss: 0.3680946
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 43 cost time: 1.6376850605010986
Epoch: 43, Steps: 52 | Train Loss: 0.4075951 Vali Loss: 1.3153520 Test Loss: 0.3681692
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 44 cost time: 1.6377012729644775
Epoch: 44, Steps: 52 | Train Loss: 0.4077669 Vali Loss: 1.3233213 Test Loss: 0.3684494
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 45 cost time: 1.6404571533203125
Epoch: 45, Steps: 52 | Train Loss: 0.4072605 Vali Loss: 1.3180003 Test Loss: 0.3680789
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 46 cost time: 1.646763801574707
Epoch: 46, Steps: 52 | Train Loss: 0.4081202 Vali Loss: 1.3177471 Test Loss: 0.3677007
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 47 cost time: 1.6573429107666016
Epoch: 47, Steps: 52 | Train Loss: 0.4069330 Vali Loss: 1.3189018 Test Loss: 0.3678974
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 48 cost time: 1.6396703720092773
Epoch: 48, Steps: 52 | Train Loss: 0.4060204 Vali Loss: 1.3213465 Test Loss: 0.3683206
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 49 cost time: 1.6400487422943115
Epoch: 49, Steps: 52 | Train Loss: 0.4065694 Vali Loss: 1.3112106 Test Loss: 0.3677796
Validation loss decreased (1.312338 --> 1.311211).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 50 cost time: 1.6344287395477295
Epoch: 50, Steps: 52 | Train Loss: 0.4074949 Vali Loss: 1.3121625 Test Loss: 0.3675916
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 51 cost time: 1.6375179290771484
Epoch: 51, Steps: 52 | Train Loss: 0.4074498 Vali Loss: 1.3197629 Test Loss: 0.3677387
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 52 cost time: 1.6443068981170654
Epoch: 52, Steps: 52 | Train Loss: 0.4061366 Vali Loss: 1.3144565 Test Loss: 0.3679149
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 53 cost time: 1.652132272720337
Epoch: 53, Steps: 52 | Train Loss: 0.4073362 Vali Loss: 1.3208888 Test Loss: 0.3680628
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 54 cost time: 1.633500099182129
Epoch: 54, Steps: 52 | Train Loss: 0.4069383 Vali Loss: 1.3140192 Test Loss: 0.3680847
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 55 cost time: 1.64223313331604
Epoch: 55, Steps: 52 | Train Loss: 0.4081646 Vali Loss: 1.3166920 Test Loss: 0.3680121
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 56 cost time: 1.644413709640503
Epoch: 56, Steps: 52 | Train Loss: 0.4062504 Vali Loss: 1.3131623 Test Loss: 0.3678555
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 57 cost time: 1.6511812210083008
Epoch: 57, Steps: 52 | Train Loss: 0.4064124 Vali Loss: 1.3115356 Test Loss: 0.3676326
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 58 cost time: 1.6391522884368896
Epoch: 58, Steps: 52 | Train Loss: 0.4076924 Vali Loss: 1.3139786 Test Loss: 0.3675614
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 59 cost time: 1.6552445888519287
Epoch: 59, Steps: 52 | Train Loss: 0.4064848 Vali Loss: 1.3145294 Test Loss: 0.3675552
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 60 cost time: 1.6364071369171143
Epoch: 60, Steps: 52 | Train Loss: 0.4084355 Vali Loss: 1.3199629 Test Loss: 0.3677790
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36777961254119873, mae:0.4143486022949219, rse:0.49682408571243286
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.053494930267333984 GB
Epoch: 1 cost time: 2.1576216220855713
Epoch: 1, Steps: 52 | Train Loss: 0.6894259 Vali Loss: 2.1099634 Test Loss: 1.3695308
Validation loss decreased (inf --> 2.109963).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 2 cost time: 0.764641284942627
Epoch: 2, Steps: 52 | Train Loss: 0.5816225 Vali Loss: 1.5217227 Test Loss: 0.6050894
Validation loss decreased (2.109963 --> 1.521723).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 3 cost time: 0.7754065990447998
Epoch: 3, Steps: 52 | Train Loss: 0.4585295 Vali Loss: 1.3943522 Test Loss: 0.4214623
Validation loss decreased (1.521723 --> 1.394352).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 4 cost time: 0.7714278697967529
Epoch: 4, Steps: 52 | Train Loss: 0.4397464 Vali Loss: 1.3864750 Test Loss: 0.4149941
Validation loss decreased (1.394352 --> 1.386475).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 5 cost time: 0.7800002098083496
Epoch: 5, Steps: 52 | Train Loss: 0.4336634 Vali Loss: 1.3746722 Test Loss: 0.4043007
Validation loss decreased (1.386475 --> 1.374672).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 6 cost time: 1.6916651725769043
Epoch: 6, Steps: 52 | Train Loss: 0.4278050 Vali Loss: 1.3684763 Test Loss: 0.3956034
Validation loss decreased (1.374672 --> 1.368476).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 7 cost time: 1.702268123626709
Epoch: 7, Steps: 52 | Train Loss: 0.4242540 Vali Loss: 1.3538163 Test Loss: 0.3908368
Validation loss decreased (1.368476 --> 1.353816).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 8 cost time: 1.7256689071655273
Epoch: 8, Steps: 52 | Train Loss: 0.4225523 Vali Loss: 1.3394035 Test Loss: 0.3853319
Validation loss decreased (1.353816 --> 1.339404).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 9 cost time: 1.701540231704712
Epoch: 9, Steps: 52 | Train Loss: 0.4192347 Vali Loss: 1.3482760 Test Loss: 0.3811044
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 10 cost time: 1.7050085067749023
Epoch: 10, Steps: 52 | Train Loss: 0.4181104 Vali Loss: 1.3425792 Test Loss: 0.3785042
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 11 cost time: 1.7219312191009521
Epoch: 11, Steps: 52 | Train Loss: 0.4153158 Vali Loss: 1.3392532 Test Loss: 0.3754991
Validation loss decreased (1.339404 --> 1.339253).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 12 cost time: 1.6979265213012695
Epoch: 12, Steps: 52 | Train Loss: 0.4165716 Vali Loss: 1.3349690 Test Loss: 0.3740162
Validation loss decreased (1.339253 --> 1.334969).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 13 cost time: 1.7001349925994873
Epoch: 13, Steps: 52 | Train Loss: 0.4135236 Vali Loss: 1.3241111 Test Loss: 0.3724847
Validation loss decreased (1.334969 --> 1.324111).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 14 cost time: 1.6981861591339111
Epoch: 14, Steps: 52 | Train Loss: 0.4124289 Vali Loss: 1.3279151 Test Loss: 0.3716547
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 15 cost time: 1.7013764381408691
Epoch: 15, Steps: 52 | Train Loss: 0.4123164 Vali Loss: 1.3203316 Test Loss: 0.3705698
Validation loss decreased (1.324111 --> 1.320332).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 16 cost time: 1.713200569152832
Epoch: 16, Steps: 52 | Train Loss: 0.4119278 Vali Loss: 1.3198519 Test Loss: 0.3697198
Validation loss decreased (1.320332 --> 1.319852).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 17 cost time: 1.699162483215332
Epoch: 17, Steps: 52 | Train Loss: 0.4113868 Vali Loss: 1.3231769 Test Loss: 0.3689193
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 18 cost time: 1.7143833637237549
Epoch: 18, Steps: 52 | Train Loss: 0.4112310 Vali Loss: 1.3246869 Test Loss: 0.3684036
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 19 cost time: 1.722438097000122
Epoch: 19, Steps: 52 | Train Loss: 0.4088482 Vali Loss: 1.3203986 Test Loss: 0.3681066
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 20 cost time: 1.7034327983856201
Epoch: 20, Steps: 52 | Train Loss: 0.4091537 Vali Loss: 1.3215828 Test Loss: 0.3676398
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 21 cost time: 1.722869634628296
Epoch: 21, Steps: 52 | Train Loss: 0.4078578 Vali Loss: 1.3103896 Test Loss: 0.3675303
Validation loss decreased (1.319852 --> 1.310390).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 22 cost time: 1.703148603439331
Epoch: 22, Steps: 52 | Train Loss: 0.4087163 Vali Loss: 1.3223256 Test Loss: 0.3678161
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 23 cost time: 1.7170350551605225
Epoch: 23, Steps: 52 | Train Loss: 0.4077747 Vali Loss: 1.3160638 Test Loss: 0.3671339
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 24 cost time: 1.7045538425445557
Epoch: 24, Steps: 52 | Train Loss: 0.4086745 Vali Loss: 1.3218327 Test Loss: 0.3673488
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 25 cost time: 1.695549726486206
Epoch: 25, Steps: 52 | Train Loss: 0.4086369 Vali Loss: 1.3132303 Test Loss: 0.3665614
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 26 cost time: 1.723034143447876
Epoch: 26, Steps: 52 | Train Loss: 0.4081436 Vali Loss: 1.3114946 Test Loss: 0.3669037
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 27 cost time: 1.7023470401763916
Epoch: 27, Steps: 52 | Train Loss: 0.4073913 Vali Loss: 1.3104148 Test Loss: 0.3660400
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 28 cost time: 1.7020344734191895
Epoch: 28, Steps: 52 | Train Loss: 0.4084931 Vali Loss: 1.3164324 Test Loss: 0.3664933
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 29 cost time: 1.7043042182922363
Epoch: 29, Steps: 52 | Train Loss: 0.4074365 Vali Loss: 1.3114891 Test Loss: 0.3661696
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 30 cost time: 1.7204065322875977
Epoch: 30, Steps: 52 | Train Loss: 0.4073549 Vali Loss: 1.3076001 Test Loss: 0.3664351
Validation loss decreased (1.310390 --> 1.307600).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 31 cost time: 1.7171974182128906
Epoch: 31, Steps: 52 | Train Loss: 0.4088088 Vali Loss: 1.3042967 Test Loss: 0.3656288
Validation loss decreased (1.307600 --> 1.304297).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 32 cost time: 1.6955440044403076
Epoch: 32, Steps: 52 | Train Loss: 0.4066870 Vali Loss: 1.3121613 Test Loss: 0.3658904
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 33 cost time: 1.7189545631408691
Epoch: 33, Steps: 52 | Train Loss: 0.4061447 Vali Loss: 1.3092850 Test Loss: 0.3657921
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 34 cost time: 1.7054338455200195
Epoch: 34, Steps: 52 | Train Loss: 0.4071356 Vali Loss: 1.3096457 Test Loss: 0.3653949
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 35 cost time: 1.7092571258544922
Epoch: 35, Steps: 52 | Train Loss: 0.4073915 Vali Loss: 1.3140885 Test Loss: 0.3662844
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 36 cost time: 1.7224183082580566
Epoch: 36, Steps: 52 | Train Loss: 0.4061267 Vali Loss: 1.3179710 Test Loss: 0.3659059
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 37 cost time: 1.703930377960205
Epoch: 37, Steps: 52 | Train Loss: 0.4071039 Vali Loss: 1.3187692 Test Loss: 0.3656635
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 38 cost time: 1.7027559280395508
Epoch: 38, Steps: 52 | Train Loss: 0.4076030 Vali Loss: 1.3161126 Test Loss: 0.3657481
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 39 cost time: 1.7237534523010254
Epoch: 39, Steps: 52 | Train Loss: 0.4053829 Vali Loss: 1.3119024 Test Loss: 0.3658425
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 40 cost time: 1.6933717727661133
Epoch: 40, Steps: 52 | Train Loss: 0.4073484 Vali Loss: 1.3152385 Test Loss: 0.3655975
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 41 cost time: 1.7078900337219238
Epoch: 41, Steps: 52 | Train Loss: 0.4076613 Vali Loss: 1.3074948 Test Loss: 0.3654144
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 42 cost time: 1.719423532485962
Epoch: 42, Steps: 52 | Train Loss: 0.4095611 Vali Loss: 1.3101786 Test Loss: 0.3654869
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 43 cost time: 1.722245216369629
Epoch: 43, Steps: 52 | Train Loss: 0.4079311 Vali Loss: 1.3182003 Test Loss: 0.3660272
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 44 cost time: 1.6929600238800049
Epoch: 44, Steps: 52 | Train Loss: 0.4060954 Vali Loss: 1.3154538 Test Loss: 0.3657779
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 45 cost time: 1.720646619796753
Epoch: 45, Steps: 52 | Train Loss: 0.4074106 Vali Loss: 1.3102547 Test Loss: 0.3655860
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 46 cost time: 1.6991209983825684
Epoch: 46, Steps: 52 | Train Loss: 0.4078432 Vali Loss: 1.3165121 Test Loss: 0.3654509
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 47 cost time: 1.7147231101989746
Epoch: 47, Steps: 52 | Train Loss: 0.4065857 Vali Loss: 1.3098549 Test Loss: 0.3657158
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 48 cost time: 1.705364465713501
Epoch: 48, Steps: 52 | Train Loss: 0.4070899 Vali Loss: 1.3178610 Test Loss: 0.3658109
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 49 cost time: 1.6933708190917969
Epoch: 49, Steps: 52 | Train Loss: 0.4072463 Vali Loss: 1.3064731 Test Loss: 0.3653452
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 50 cost time: 1.7094006538391113
Epoch: 50, Steps: 52 | Train Loss: 0.4065571 Vali Loss: 1.3009050 Test Loss: 0.3656874
Validation loss decreased (1.304297 --> 1.300905).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 51 cost time: 1.7194185256958008
Epoch: 51, Steps: 52 | Train Loss: 0.4069943 Vali Loss: 1.3131614 Test Loss: 0.3657069
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 52 cost time: 1.6997404098510742
Epoch: 52, Steps: 52 | Train Loss: 0.4067909 Vali Loss: 1.3087705 Test Loss: 0.3665513
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 53 cost time: 1.6977200508117676
Epoch: 53, Steps: 52 | Train Loss: 0.4060572 Vali Loss: 1.3075620 Test Loss: 0.3649333
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 54 cost time: 1.7196400165557861
Epoch: 54, Steps: 52 | Train Loss: 0.4071247 Vali Loss: 1.3112295 Test Loss: 0.3659610
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 55 cost time: 1.7027978897094727
Epoch: 55, Steps: 52 | Train Loss: 0.4087112 Vali Loss: 1.3092633 Test Loss: 0.3654005
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 56 cost time: 1.7027974128723145
Epoch: 56, Steps: 52 | Train Loss: 0.4069534 Vali Loss: 1.3099072 Test Loss: 0.3662275
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 57 cost time: 1.6935675144195557
Epoch: 57, Steps: 52 | Train Loss: 0.4089556 Vali Loss: 1.3170402 Test Loss: 0.3658105
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 58 cost time: 1.719681739807129
Epoch: 58, Steps: 52 | Train Loss: 0.4049993 Vali Loss: 1.3121437 Test Loss: 0.3657493
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 59 cost time: 1.7009398937225342
Epoch: 59, Steps: 52 | Train Loss: 0.4083125 Vali Loss: 1.3029056 Test Loss: 0.3655249
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 60 cost time: 1.7177624702453613
Epoch: 60, Steps: 52 | Train Loss: 0.4053150 Vali Loss: 1.3070443 Test Loss: 0.3649989
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36568745970726013, mae:0.4140580892562866, rse:0.49540889263153076
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.049500465393066406 GB
Epoch: 1 cost time: 2.0587470531463623
Epoch: 1, Steps: 52 | Train Loss: 0.7633755 Vali Loss: 2.2296844 Test Loss: 1.4222839
Validation loss decreased (inf --> 2.229684).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 2 cost time: 0.6927824020385742
Epoch: 2, Steps: 52 | Train Loss: 0.7052017 Vali Loss: 1.9737167 Test Loss: 1.1361639
Validation loss decreased (2.229684 --> 1.973717).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 3 cost time: 0.6979982852935791
Epoch: 3, Steps: 52 | Train Loss: 0.6304685 Vali Loss: 1.7868979 Test Loss: 0.9264717
Validation loss decreased (1.973717 --> 1.786898).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 4 cost time: 0.6933209896087646
Epoch: 4, Steps: 52 | Train Loss: 0.5720099 Vali Loss: 1.6459169 Test Loss: 0.7385043
Validation loss decreased (1.786898 --> 1.645917).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 5 cost time: 0.6929566860198975
Epoch: 5, Steps: 52 | Train Loss: 0.5257782 Vali Loss: 1.5539775 Test Loss: 0.6191763
Validation loss decreased (1.645917 --> 1.553977).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 6 cost time: 1.085686445236206
Epoch: 6, Steps: 52 | Train Loss: 0.5006099 Vali Loss: 1.4945644 Test Loss: 0.5490294
Validation loss decreased (1.553977 --> 1.494564).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 7 cost time: 1.5295946598052979
Epoch: 7, Steps: 52 | Train Loss: 0.4821904 Vali Loss: 1.4644393 Test Loss: 0.5055175
Validation loss decreased (1.494564 --> 1.464439).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 8 cost time: 1.5437612533569336
Epoch: 8, Steps: 52 | Train Loss: 0.4729270 Vali Loss: 1.4377389 Test Loss: 0.4774248
Validation loss decreased (1.464439 --> 1.437739).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 9 cost time: 1.5460479259490967
Epoch: 9, Steps: 52 | Train Loss: 0.4637869 Vali Loss: 1.4266980 Test Loss: 0.4581386
Validation loss decreased (1.437739 --> 1.426698).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 10 cost time: 1.544541835784912
Epoch: 10, Steps: 52 | Train Loss: 0.4580249 Vali Loss: 1.4122639 Test Loss: 0.4444746
Validation loss decreased (1.426698 --> 1.412264).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 11 cost time: 1.5446934700012207
Epoch: 11, Steps: 52 | Train Loss: 0.4529162 Vali Loss: 1.4028000 Test Loss: 0.4351760
Validation loss decreased (1.412264 --> 1.402800).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 12 cost time: 1.5414652824401855
Epoch: 12, Steps: 52 | Train Loss: 0.4517606 Vali Loss: 1.3938124 Test Loss: 0.4277601
Validation loss decreased (1.402800 --> 1.393812).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 13 cost time: 1.5495891571044922
Epoch: 13, Steps: 52 | Train Loss: 0.4451351 Vali Loss: 1.3815295 Test Loss: 0.4217378
Validation loss decreased (1.393812 --> 1.381529).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 14 cost time: 1.543637990951538
Epoch: 14, Steps: 52 | Train Loss: 0.4415867 Vali Loss: 1.3779371 Test Loss: 0.4166455
Validation loss decreased (1.381529 --> 1.377937).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 15 cost time: 1.5469770431518555
Epoch: 15, Steps: 52 | Train Loss: 0.4426740 Vali Loss: 1.3687830 Test Loss: 0.4135299
Validation loss decreased (1.377937 --> 1.368783).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 16 cost time: 1.5476765632629395
Epoch: 16, Steps: 52 | Train Loss: 0.4395141 Vali Loss: 1.3748213 Test Loss: 0.4108264
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 17 cost time: 1.5443089008331299
Epoch: 17, Steps: 52 | Train Loss: 0.4396209 Vali Loss: 1.3687203 Test Loss: 0.4066034
Validation loss decreased (1.368783 --> 1.368720).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 18 cost time: 1.544816493988037
Epoch: 18, Steps: 52 | Train Loss: 0.4374969 Vali Loss: 1.3653655 Test Loss: 0.4057769
Validation loss decreased (1.368720 --> 1.365366).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 19 cost time: 1.5450468063354492
Epoch: 19, Steps: 52 | Train Loss: 0.4354822 Vali Loss: 1.3645279 Test Loss: 0.4027114
Validation loss decreased (1.365366 --> 1.364528).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 20 cost time: 1.5396051406860352
Epoch: 20, Steps: 52 | Train Loss: 0.4358913 Vali Loss: 1.3519368 Test Loss: 0.4012641
Validation loss decreased (1.364528 --> 1.351937).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 21 cost time: 1.5427231788635254
Epoch: 21, Steps: 52 | Train Loss: 0.4345877 Vali Loss: 1.3556831 Test Loss: 0.4001374
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 22 cost time: 1.5454835891723633
Epoch: 22, Steps: 52 | Train Loss: 0.4341049 Vali Loss: 1.3556769 Test Loss: 0.4000130
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 23 cost time: 1.5451695919036865
Epoch: 23, Steps: 52 | Train Loss: 0.4327239 Vali Loss: 1.3562920 Test Loss: 0.3982045
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 24 cost time: 1.5347654819488525
Epoch: 24, Steps: 52 | Train Loss: 0.4335092 Vali Loss: 1.3536581 Test Loss: 0.3977150
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 25 cost time: 1.5362741947174072
Epoch: 25, Steps: 52 | Train Loss: 0.4320542 Vali Loss: 1.3446320 Test Loss: 0.3984645
Validation loss decreased (1.351937 --> 1.344632).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 26 cost time: 1.5323028564453125
Epoch: 26, Steps: 52 | Train Loss: 0.4314940 Vali Loss: 1.3470246 Test Loss: 0.3965854
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 27 cost time: 1.5289978981018066
Epoch: 27, Steps: 52 | Train Loss: 0.4311106 Vali Loss: 1.3443696 Test Loss: 0.3951075
Validation loss decreased (1.344632 --> 1.344370).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 28 cost time: 1.544158697128296
Epoch: 28, Steps: 52 | Train Loss: 0.4311629 Vali Loss: 1.3532901 Test Loss: 0.3947498
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 29 cost time: 1.540395736694336
Epoch: 29, Steps: 52 | Train Loss: 0.4308495 Vali Loss: 1.3510572 Test Loss: 0.3943115
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 30 cost time: 1.5436656475067139
Epoch: 30, Steps: 52 | Train Loss: 0.4297854 Vali Loss: 1.3461374 Test Loss: 0.3943651
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 31 cost time: 1.5377836227416992
Epoch: 31, Steps: 52 | Train Loss: 0.4288617 Vali Loss: 1.3421770 Test Loss: 0.3935471
Validation loss decreased (1.344370 --> 1.342177).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 32 cost time: 1.5439951419830322
Epoch: 32, Steps: 52 | Train Loss: 0.4296476 Vali Loss: 1.3344846 Test Loss: 0.3932032
Validation loss decreased (1.342177 --> 1.334485).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 33 cost time: 1.5433073043823242
Epoch: 33, Steps: 52 | Train Loss: 0.4295622 Vali Loss: 1.3478689 Test Loss: 0.3927312
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 34 cost time: 1.5461044311523438
Epoch: 34, Steps: 52 | Train Loss: 0.4292430 Vali Loss: 1.3500057 Test Loss: 0.3928908
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 35 cost time: 1.545008659362793
Epoch: 35, Steps: 52 | Train Loss: 0.4290717 Vali Loss: 1.3443489 Test Loss: 0.3929228
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 36 cost time: 1.5467257499694824
Epoch: 36, Steps: 52 | Train Loss: 0.4276405 Vali Loss: 1.3343170 Test Loss: 0.3926210
Validation loss decreased (1.334485 --> 1.334317).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 37 cost time: 1.5430965423583984
Epoch: 37, Steps: 52 | Train Loss: 0.4283500 Vali Loss: 1.3433225 Test Loss: 0.3920773
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 38 cost time: 1.548588752746582
Epoch: 38, Steps: 52 | Train Loss: 0.4275378 Vali Loss: 1.3411522 Test Loss: 0.3922092
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 39 cost time: 1.542158842086792
Epoch: 39, Steps: 52 | Train Loss: 0.4288562 Vali Loss: 1.3471868 Test Loss: 0.3925274
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 40 cost time: 1.542375087738037
Epoch: 40, Steps: 52 | Train Loss: 0.4290168 Vali Loss: 1.3405497 Test Loss: 0.3916418
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 41 cost time: 1.540391445159912
Epoch: 41, Steps: 52 | Train Loss: 0.4254623 Vali Loss: 1.3442483 Test Loss: 0.3919271
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 42 cost time: 1.5399253368377686
Epoch: 42, Steps: 52 | Train Loss: 0.4283431 Vali Loss: 1.3384516 Test Loss: 0.3917767
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 43 cost time: 1.5408284664154053
Epoch: 43, Steps: 52 | Train Loss: 0.4277385 Vali Loss: 1.3381391 Test Loss: 0.3919010
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 44 cost time: 1.5402193069458008
Epoch: 44, Steps: 52 | Train Loss: 0.4292067 Vali Loss: 1.3454530 Test Loss: 0.3916095
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 45 cost time: 1.5375730991363525
Epoch: 45, Steps: 52 | Train Loss: 0.4273402 Vali Loss: 1.3390130 Test Loss: 0.3910391
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 46 cost time: 1.5293207168579102
Epoch: 46, Steps: 52 | Train Loss: 0.4297194 Vali Loss: 1.3399832 Test Loss: 0.3913724
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 47 cost time: 1.534104824066162
Epoch: 47, Steps: 52 | Train Loss: 0.4287496 Vali Loss: 1.3299806 Test Loss: 0.3907539
Validation loss decreased (1.334317 --> 1.329981).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 48 cost time: 1.5282213687896729
Epoch: 48, Steps: 52 | Train Loss: 0.4289380 Vali Loss: 1.3306568 Test Loss: 0.3907884
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 49 cost time: 1.5379750728607178
Epoch: 49, Steps: 52 | Train Loss: 0.4287485 Vali Loss: 1.3442678 Test Loss: 0.3912947
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 50 cost time: 1.5389704704284668
Epoch: 50, Steps: 52 | Train Loss: 0.4281871 Vali Loss: 1.3315442 Test Loss: 0.3908278
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 51 cost time: 1.5483288764953613
Epoch: 51, Steps: 52 | Train Loss: 0.4294649 Vali Loss: 1.3378855 Test Loss: 0.3908191
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 52 cost time: 1.5424063205718994
Epoch: 52, Steps: 52 | Train Loss: 0.4273994 Vali Loss: 1.3470601 Test Loss: 0.3908107
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 53 cost time: 1.5398774147033691
Epoch: 53, Steps: 52 | Train Loss: 0.4273241 Vali Loss: 1.3378103 Test Loss: 0.3905948
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 54 cost time: 1.5311517715454102
Epoch: 54, Steps: 52 | Train Loss: 0.4277074 Vali Loss: 1.3469640 Test Loss: 0.3910979
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 55 cost time: 1.544616937637329
Epoch: 55, Steps: 52 | Train Loss: 0.4272465 Vali Loss: 1.3432573 Test Loss: 0.3902669
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 56 cost time: 1.5398049354553223
Epoch: 56, Steps: 52 | Train Loss: 0.4263039 Vali Loss: 1.3387311 Test Loss: 0.3910374
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 57 cost time: 1.5382697582244873
Epoch: 57, Steps: 52 | Train Loss: 0.4270560 Vali Loss: 1.3410807 Test Loss: 0.3909867
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 58 cost time: 1.5382990837097168
Epoch: 58, Steps: 52 | Train Loss: 0.4270251 Vali Loss: 1.3363073 Test Loss: 0.3912575
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 59 cost time: 1.5415847301483154
Epoch: 59, Steps: 52 | Train Loss: 0.4256891 Vali Loss: 1.3461255 Test Loss: 0.3904163
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 60 cost time: 1.540116310119629
Epoch: 60, Steps: 52 | Train Loss: 0.4281512 Vali Loss: 1.3444917 Test Loss: 0.3908720
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3907538652420044, mae:0.434238076210022, rse:0.5121066570281982
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 1 cost time: 2.1006336212158203
Epoch: 1, Steps: 52 | Train Loss: 0.7234449 Vali Loss: 2.1666384 Test Loss: 1.4186258
Validation loss decreased (inf --> 2.166638).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 2 cost time: 0.7372305393218994
Epoch: 2, Steps: 52 | Train Loss: 0.6134001 Vali Loss: 1.6526749 Test Loss: 0.7749100
Validation loss decreased (2.166638 --> 1.652675).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 3 cost time: 0.721794605255127
Epoch: 3, Steps: 52 | Train Loss: 0.4994540 Vali Loss: 1.4663792 Test Loss: 0.4998286
Validation loss decreased (1.652675 --> 1.466379).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 4 cost time: 0.7229995727539062
Epoch: 4, Steps: 52 | Train Loss: 0.4660599 Vali Loss: 1.4298867 Test Loss: 0.4519240
Validation loss decreased (1.466379 --> 1.429887).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 5 cost time: 0.7213940620422363
Epoch: 5, Steps: 52 | Train Loss: 0.4518717 Vali Loss: 1.4068331 Test Loss: 0.4369503
Validation loss decreased (1.429887 --> 1.406833).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 6 cost time: 1.4285411834716797
Epoch: 6, Steps: 52 | Train Loss: 0.4439129 Vali Loss: 1.3750019 Test Loss: 0.4214460
Validation loss decreased (1.406833 --> 1.375002).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 7 cost time: 1.5884053707122803
Epoch: 7, Steps: 52 | Train Loss: 0.4385529 Vali Loss: 1.3835170 Test Loss: 0.4129263
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 8 cost time: 1.6150600910186768
Epoch: 8, Steps: 52 | Train Loss: 0.4362343 Vali Loss: 1.3758563 Test Loss: 0.4062206
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 9 cost time: 1.592757225036621
Epoch: 9, Steps: 52 | Train Loss: 0.4333911 Vali Loss: 1.3570701 Test Loss: 0.4014367
Validation loss decreased (1.375002 --> 1.357070).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 10 cost time: 1.6161696910858154
Epoch: 10, Steps: 52 | Train Loss: 0.4290336 Vali Loss: 1.3588569 Test Loss: 0.3971534
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 11 cost time: 1.5910208225250244
Epoch: 11, Steps: 52 | Train Loss: 0.4284072 Vali Loss: 1.3489501 Test Loss: 0.3935919
Validation loss decreased (1.357070 --> 1.348950).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 12 cost time: 1.6127533912658691
Epoch: 12, Steps: 52 | Train Loss: 0.4262947 Vali Loss: 1.3492904 Test Loss: 0.3922330
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 13 cost time: 1.5883371829986572
Epoch: 13, Steps: 52 | Train Loss: 0.4252971 Vali Loss: 1.3471178 Test Loss: 0.3893327
Validation loss decreased (1.348950 --> 1.347118).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 14 cost time: 1.596017837524414
Epoch: 14, Steps: 52 | Train Loss: 0.4227991 Vali Loss: 1.3412101 Test Loss: 0.3873449
Validation loss decreased (1.347118 --> 1.341210).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 15 cost time: 1.6080169677734375
Epoch: 15, Steps: 52 | Train Loss: 0.4227739 Vali Loss: 1.3406312 Test Loss: 0.3855311
Validation loss decreased (1.341210 --> 1.340631).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 16 cost time: 1.5950005054473877
Epoch: 16, Steps: 52 | Train Loss: 0.4201976 Vali Loss: 1.3330898 Test Loss: 0.3850049
Validation loss decreased (1.340631 --> 1.333090).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 17 cost time: 1.5845427513122559
Epoch: 17, Steps: 52 | Train Loss: 0.4206427 Vali Loss: 1.3304646 Test Loss: 0.3837587
Validation loss decreased (1.333090 --> 1.330465).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 18 cost time: 1.608452320098877
Epoch: 18, Steps: 52 | Train Loss: 0.4200374 Vali Loss: 1.3368351 Test Loss: 0.3833960
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 19 cost time: 1.5866758823394775
Epoch: 19, Steps: 52 | Train Loss: 0.4195317 Vali Loss: 1.3317537 Test Loss: 0.3818197
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 20 cost time: 1.5917224884033203
Epoch: 20, Steps: 52 | Train Loss: 0.4182853 Vali Loss: 1.3347634 Test Loss: 0.3814604
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 21 cost time: 1.591693639755249
Epoch: 21, Steps: 52 | Train Loss: 0.4163585 Vali Loss: 1.3323302 Test Loss: 0.3808197
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 22 cost time: 1.5956428050994873
Epoch: 22, Steps: 52 | Train Loss: 0.4169890 Vali Loss: 1.3272302 Test Loss: 0.3800416
Validation loss decreased (1.330465 --> 1.327230).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 23 cost time: 1.58827543258667
Epoch: 23, Steps: 52 | Train Loss: 0.4186297 Vali Loss: 1.3293079 Test Loss: 0.3796737
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 24 cost time: 1.598036527633667
Epoch: 24, Steps: 52 | Train Loss: 0.4173245 Vali Loss: 1.3277061 Test Loss: 0.3794988
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 25 cost time: 1.5977935791015625
Epoch: 25, Steps: 52 | Train Loss: 0.4162695 Vali Loss: 1.3299050 Test Loss: 0.3786078
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 26 cost time: 1.5904221534729004
Epoch: 26, Steps: 52 | Train Loss: 0.4156338 Vali Loss: 1.3222183 Test Loss: 0.3790902
Validation loss decreased (1.327230 --> 1.322218).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 27 cost time: 1.5906484127044678
Epoch: 27, Steps: 52 | Train Loss: 0.4175162 Vali Loss: 1.3245095 Test Loss: 0.3782125
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 28 cost time: 1.589867115020752
Epoch: 28, Steps: 52 | Train Loss: 0.4145460 Vali Loss: 1.3206127 Test Loss: 0.3787108
Validation loss decreased (1.322218 --> 1.320613).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 29 cost time: 1.5888159275054932
Epoch: 29, Steps: 52 | Train Loss: 0.4150952 Vali Loss: 1.3163472 Test Loss: 0.3783750
Validation loss decreased (1.320613 --> 1.316347).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 30 cost time: 1.5928163528442383
Epoch: 30, Steps: 52 | Train Loss: 0.4153530 Vali Loss: 1.3272777 Test Loss: 0.3780482
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 31 cost time: 1.5910792350769043
Epoch: 31, Steps: 52 | Train Loss: 0.4151356 Vali Loss: 1.3272862 Test Loss: 0.3780134
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 32 cost time: 1.595139503479004
Epoch: 32, Steps: 52 | Train Loss: 0.4157662 Vali Loss: 1.3216996 Test Loss: 0.3779567
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 33 cost time: 1.6065926551818848
Epoch: 33, Steps: 52 | Train Loss: 0.4140446 Vali Loss: 1.3217943 Test Loss: 0.3775007
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 34 cost time: 1.6104621887207031
Epoch: 34, Steps: 52 | Train Loss: 0.4156308 Vali Loss: 1.3208389 Test Loss: 0.3774534
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 35 cost time: 1.5892364978790283
Epoch: 35, Steps: 52 | Train Loss: 0.4138582 Vali Loss: 1.3236115 Test Loss: 0.3774855
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 36 cost time: 1.6070771217346191
Epoch: 36, Steps: 52 | Train Loss: 0.4162815 Vali Loss: 1.3166451 Test Loss: 0.3774253
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 37 cost time: 1.603351354598999
Epoch: 37, Steps: 52 | Train Loss: 0.4140287 Vali Loss: 1.3158839 Test Loss: 0.3771782
Validation loss decreased (1.316347 --> 1.315884).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 38 cost time: 1.5942862033843994
Epoch: 38, Steps: 52 | Train Loss: 0.4141653 Vali Loss: 1.3228945 Test Loss: 0.3773674
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 39 cost time: 1.6063413619995117
Epoch: 39, Steps: 52 | Train Loss: 0.4159122 Vali Loss: 1.3186848 Test Loss: 0.3768318
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 40 cost time: 1.6176164150238037
Epoch: 40, Steps: 52 | Train Loss: 0.4141995 Vali Loss: 1.3198165 Test Loss: 0.3769298
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 41 cost time: 1.5925297737121582
Epoch: 41, Steps: 52 | Train Loss: 0.4140427 Vali Loss: 1.3071799 Test Loss: 0.3771082
Validation loss decreased (1.315884 --> 1.307180).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 42 cost time: 1.6112878322601318
Epoch: 42, Steps: 52 | Train Loss: 0.4144593 Vali Loss: 1.3249679 Test Loss: 0.3770844
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 43 cost time: 1.6093339920043945
Epoch: 43, Steps: 52 | Train Loss: 0.4146274 Vali Loss: 1.3138182 Test Loss: 0.3766996
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 44 cost time: 1.5918118953704834
Epoch: 44, Steps: 52 | Train Loss: 0.4125581 Vali Loss: 1.3098247 Test Loss: 0.3768710
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 45 cost time: 1.6100380420684814
Epoch: 45, Steps: 52 | Train Loss: 0.4136417 Vali Loss: 1.3238626 Test Loss: 0.3766896
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 46 cost time: 1.6120519638061523
Epoch: 46, Steps: 52 | Train Loss: 0.4147858 Vali Loss: 1.3050196 Test Loss: 0.3766473
Validation loss decreased (1.307180 --> 1.305020).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 47 cost time: 1.5915825366973877
Epoch: 47, Steps: 52 | Train Loss: 0.4127646 Vali Loss: 1.3195981 Test Loss: 0.3766300
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 48 cost time: 1.6066956520080566
Epoch: 48, Steps: 52 | Train Loss: 0.4129221 Vali Loss: 1.3119016 Test Loss: 0.3767325
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 49 cost time: 1.5861334800720215
Epoch: 49, Steps: 52 | Train Loss: 0.4146084 Vali Loss: 1.3197706 Test Loss: 0.3770936
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 50 cost time: 1.59855318069458
Epoch: 50, Steps: 52 | Train Loss: 0.4139485 Vali Loss: 1.3141732 Test Loss: 0.3767087
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 51 cost time: 1.6038422584533691
Epoch: 51, Steps: 52 | Train Loss: 0.4152296 Vali Loss: 1.3135321 Test Loss: 0.3764943
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 52 cost time: 1.610468864440918
Epoch: 52, Steps: 52 | Train Loss: 0.4143194 Vali Loss: 1.3246390 Test Loss: 0.3768611
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 53 cost time: 1.5945706367492676
Epoch: 53, Steps: 52 | Train Loss: 0.4137990 Vali Loss: 1.3183179 Test Loss: 0.3767239
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 54 cost time: 1.6112596988677979
Epoch: 54, Steps: 52 | Train Loss: 0.4152640 Vali Loss: 1.3152933 Test Loss: 0.3765777
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 55 cost time: 1.5997991561889648
Epoch: 55, Steps: 52 | Train Loss: 0.4141974 Vali Loss: 1.3196824 Test Loss: 0.3765843
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 56 cost time: 1.5919339656829834
Epoch: 56, Steps: 52 | Train Loss: 0.4118411 Vali Loss: 1.3206356 Test Loss: 0.3765880
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 57 cost time: 1.6138699054718018
Epoch: 57, Steps: 52 | Train Loss: 0.4150058 Vali Loss: 1.3204345 Test Loss: 0.3767329
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 58 cost time: 1.6007537841796875
Epoch: 58, Steps: 52 | Train Loss: 0.4142586 Vali Loss: 1.3169245 Test Loss: 0.3767861
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 59 cost time: 1.594407558441162
Epoch: 59, Steps: 52 | Train Loss: 0.4138596 Vali Loss: 1.3167900 Test Loss: 0.3766525
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 60 cost time: 1.6050419807434082
Epoch: 60, Steps: 52 | Train Loss: 0.4145908 Vali Loss: 1.3090636 Test Loss: 0.3769946
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.37664735317230225, mae:0.42271628975868225, rse:0.5027779936790466
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05678749084472656 GB
Epoch: 1 cost time: 2.1262471675872803
Epoch: 1, Steps: 52 | Train Loss: 0.6678530 Vali Loss: 2.0838151 Test Loss: 1.3071747
Validation loss decreased (inf --> 2.083815).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 2 cost time: 0.7444846630096436
Epoch: 2, Steps: 52 | Train Loss: 0.5686872 Vali Loss: 1.5327173 Test Loss: 0.5892501
Validation loss decreased (2.083815 --> 1.532717).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 3 cost time: 0.7368075847625732
Epoch: 3, Steps: 52 | Train Loss: 0.4732752 Vali Loss: 1.4324019 Test Loss: 0.4610216
Validation loss decreased (1.532717 --> 1.432402).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 4 cost time: 0.7434687614440918
Epoch: 4, Steps: 52 | Train Loss: 0.4503083 Vali Loss: 1.4031415 Test Loss: 0.4322191
Validation loss decreased (1.432402 --> 1.403141).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 5 cost time: 0.7439472675323486
Epoch: 5, Steps: 52 | Train Loss: 0.4408730 Vali Loss: 1.3834856 Test Loss: 0.4215048
Validation loss decreased (1.403141 --> 1.383486).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 6 cost time: 1.6136608123779297
Epoch: 6, Steps: 52 | Train Loss: 0.4373269 Vali Loss: 1.3665332 Test Loss: 0.4106468
Validation loss decreased (1.383486 --> 1.366533).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 7 cost time: 1.6336796283721924
Epoch: 7, Steps: 52 | Train Loss: 0.4312715 Vali Loss: 1.3636599 Test Loss: 0.4026432
Validation loss decreased (1.366533 --> 1.363660).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 8 cost time: 1.6386220455169678
Epoch: 8, Steps: 52 | Train Loss: 0.4279755 Vali Loss: 1.3610170 Test Loss: 0.3982697
Validation loss decreased (1.363660 --> 1.361017).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 9 cost time: 1.660170078277588
Epoch: 9, Steps: 52 | Train Loss: 0.4248698 Vali Loss: 1.3497584 Test Loss: 0.3935550
Validation loss decreased (1.361017 --> 1.349758).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 10 cost time: 1.6369202136993408
Epoch: 10, Steps: 52 | Train Loss: 0.4253340 Vali Loss: 1.3366698 Test Loss: 0.3922029
Validation loss decreased (1.349758 --> 1.336670).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 11 cost time: 1.6605138778686523
Epoch: 11, Steps: 52 | Train Loss: 0.4197412 Vali Loss: 1.3343017 Test Loss: 0.3869875
Validation loss decreased (1.336670 --> 1.334302).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 12 cost time: 1.6354150772094727
Epoch: 12, Steps: 52 | Train Loss: 0.4209459 Vali Loss: 1.3364866 Test Loss: 0.3863510
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 13 cost time: 1.6420836448669434
Epoch: 13, Steps: 52 | Train Loss: 0.4182227 Vali Loss: 1.3336802 Test Loss: 0.3846847
Validation loss decreased (1.334302 --> 1.333680).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 14 cost time: 1.6312174797058105
Epoch: 14, Steps: 52 | Train Loss: 0.4196016 Vali Loss: 1.3276567 Test Loss: 0.3832725
Validation loss decreased (1.333680 --> 1.327657).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 15 cost time: 1.6441740989685059
Epoch: 15, Steps: 52 | Train Loss: 0.4168878 Vali Loss: 1.3263754 Test Loss: 0.3818921
Validation loss decreased (1.327657 --> 1.326375).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 16 cost time: 1.6549031734466553
Epoch: 16, Steps: 52 | Train Loss: 0.4164793 Vali Loss: 1.3277771 Test Loss: 0.3814558
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 17 cost time: 1.6363766193389893
Epoch: 17, Steps: 52 | Train Loss: 0.4164514 Vali Loss: 1.3085622 Test Loss: 0.3814693
Validation loss decreased (1.326375 --> 1.308562).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 18 cost time: 1.659487009048462
Epoch: 18, Steps: 52 | Train Loss: 0.4158372 Vali Loss: 1.3268965 Test Loss: 0.3811384
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 19 cost time: 1.6381950378417969
Epoch: 19, Steps: 52 | Train Loss: 0.4154202 Vali Loss: 1.3252518 Test Loss: 0.3801617
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 20 cost time: 1.640329122543335
Epoch: 20, Steps: 52 | Train Loss: 0.4140269 Vali Loss: 1.3135633 Test Loss: 0.3792142
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 21 cost time: 1.63437819480896
Epoch: 21, Steps: 52 | Train Loss: 0.4137321 Vali Loss: 1.3215652 Test Loss: 0.3788426
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 22 cost time: 1.6406302452087402
Epoch: 22, Steps: 52 | Train Loss: 0.4120780 Vali Loss: 1.3087244 Test Loss: 0.3785585
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 23 cost time: 1.634230375289917
Epoch: 23, Steps: 52 | Train Loss: 0.4133891 Vali Loss: 1.3204775 Test Loss: 0.3777436
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 24 cost time: 1.641099214553833
Epoch: 24, Steps: 52 | Train Loss: 0.4138984 Vali Loss: 1.3139045 Test Loss: 0.3777268
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 25 cost time: 1.6616671085357666
Epoch: 25, Steps: 52 | Train Loss: 0.4140719 Vali Loss: 1.3176899 Test Loss: 0.3778455
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 26 cost time: 1.6365070343017578
Epoch: 26, Steps: 52 | Train Loss: 0.4135712 Vali Loss: 1.3114511 Test Loss: 0.3771417
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 27 cost time: 1.6590487957000732
Epoch: 27, Steps: 52 | Train Loss: 0.4118159 Vali Loss: 1.3147671 Test Loss: 0.3776137
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 28 cost time: 1.6336205005645752
Epoch: 28, Steps: 52 | Train Loss: 0.4124340 Vali Loss: 1.3163188 Test Loss: 0.3771336
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 29 cost time: 1.6424779891967773
Epoch: 29, Steps: 52 | Train Loss: 0.4117080 Vali Loss: 1.3092082 Test Loss: 0.3770646
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 30 cost time: 1.6325733661651611
Epoch: 30, Steps: 52 | Train Loss: 0.4121940 Vali Loss: 1.3114991 Test Loss: 0.3769955
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 31 cost time: 1.6391618251800537
Epoch: 31, Steps: 52 | Train Loss: 0.4116185 Vali Loss: 1.3079398 Test Loss: 0.3767155
Validation loss decreased (1.308562 --> 1.307940).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 32 cost time: 1.6550521850585938
Epoch: 32, Steps: 52 | Train Loss: 0.4136681 Vali Loss: 1.3145890 Test Loss: 0.3769004
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 33 cost time: 1.6333541870117188
Epoch: 33, Steps: 52 | Train Loss: 0.4111287 Vali Loss: 1.3090879 Test Loss: 0.3769517
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 34 cost time: 1.6360349655151367
Epoch: 34, Steps: 52 | Train Loss: 0.4113026 Vali Loss: 1.3167374 Test Loss: 0.3775500
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 35 cost time: 1.6495697498321533
Epoch: 35, Steps: 52 | Train Loss: 0.4123386 Vali Loss: 1.3146682 Test Loss: 0.3769144
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 36 cost time: 1.6386916637420654
Epoch: 36, Steps: 52 | Train Loss: 0.4118523 Vali Loss: 1.3179207 Test Loss: 0.3767558
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 37 cost time: 1.6551384925842285
Epoch: 37, Steps: 52 | Train Loss: 0.4113430 Vali Loss: 1.3065336 Test Loss: 0.3769266
Validation loss decreased (1.307940 --> 1.306534).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 38 cost time: 1.633965015411377
Epoch: 38, Steps: 52 | Train Loss: 0.4115674 Vali Loss: 1.3177212 Test Loss: 0.3763098
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 39 cost time: 1.6473875045776367
Epoch: 39, Steps: 52 | Train Loss: 0.4118812 Vali Loss: 1.3152753 Test Loss: 0.3769464
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 40 cost time: 1.631422758102417
Epoch: 40, Steps: 52 | Train Loss: 0.4113333 Vali Loss: 1.3092852 Test Loss: 0.3765624
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 41 cost time: 1.6420741081237793
Epoch: 41, Steps: 52 | Train Loss: 0.4112054 Vali Loss: 1.3165072 Test Loss: 0.3762659
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 42 cost time: 1.6577203273773193
Epoch: 42, Steps: 52 | Train Loss: 0.4128924 Vali Loss: 1.3163260 Test Loss: 0.3762631
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 43 cost time: 1.635293960571289
Epoch: 43, Steps: 52 | Train Loss: 0.4115697 Vali Loss: 1.3090653 Test Loss: 0.3761410
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 44 cost time: 1.6397297382354736
Epoch: 44, Steps: 52 | Train Loss: 0.4110196 Vali Loss: 1.3154958 Test Loss: 0.3764871
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 45 cost time: 1.6348772048950195
Epoch: 45, Steps: 52 | Train Loss: 0.4108990 Vali Loss: 1.3106782 Test Loss: 0.3763905
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 46 cost time: 1.643462896347046
Epoch: 46, Steps: 52 | Train Loss: 0.4098093 Vali Loss: 1.3066673 Test Loss: 0.3762771
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 47 cost time: 1.6548328399658203
Epoch: 47, Steps: 52 | Train Loss: 0.4099138 Vali Loss: 1.3148322 Test Loss: 0.3758797
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 48 cost time: 1.6347253322601318
Epoch: 48, Steps: 52 | Train Loss: 0.4120393 Vali Loss: 1.3167427 Test Loss: 0.3763976
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 49 cost time: 1.642421007156372
Epoch: 49, Steps: 52 | Train Loss: 0.4105823 Vali Loss: 1.3065599 Test Loss: 0.3763755
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 50 cost time: 1.6503865718841553
Epoch: 50, Steps: 52 | Train Loss: 0.4103638 Vali Loss: 1.3114457 Test Loss: 0.3759562
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 51 cost time: 1.6351969242095947
Epoch: 51, Steps: 52 | Train Loss: 0.4116150 Vali Loss: 1.3122506 Test Loss: 0.3758223
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 52 cost time: 1.6446187496185303
Epoch: 52, Steps: 52 | Train Loss: 0.4113896 Vali Loss: 1.3088417 Test Loss: 0.3757045
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 53 cost time: 1.633411169052124
Epoch: 53, Steps: 52 | Train Loss: 0.4119773 Vali Loss: 1.3039689 Test Loss: 0.3760501
Validation loss decreased (1.306534 --> 1.303969).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 54 cost time: 1.64208984375
Epoch: 54, Steps: 52 | Train Loss: 0.4113125 Vali Loss: 1.3096073 Test Loss: 0.3759543
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 55 cost time: 1.6529805660247803
Epoch: 55, Steps: 52 | Train Loss: 0.4121706 Vali Loss: 1.3124436 Test Loss: 0.3764444
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 56 cost time: 1.63761305809021
Epoch: 56, Steps: 52 | Train Loss: 0.4094683 Vali Loss: 1.3026543 Test Loss: 0.3759941
Validation loss decreased (1.303969 --> 1.302654).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 57 cost time: 1.650038480758667
Epoch: 57, Steps: 52 | Train Loss: 0.4117645 Vali Loss: 1.3094397 Test Loss: 0.3759365
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 58 cost time: 1.6348683834075928
Epoch: 58, Steps: 52 | Train Loss: 0.4110714 Vali Loss: 1.3122575 Test Loss: 0.3761971
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 59 cost time: 1.6569859981536865
Epoch: 59, Steps: 52 | Train Loss: 0.4111206 Vali Loss: 1.3129532 Test Loss: 0.3758840
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 60 cost time: 1.632523536682129
Epoch: 60, Steps: 52 | Train Loss: 0.4101589 Vali Loss: 1.3152902 Test Loss: 0.3762812
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.37599408626556396, mae:0.4242205321788788, rse:0.5023418068885803
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04966163635253906 GB
Epoch: 1 cost time: 2.1055593490600586
Epoch: 1, Steps: 52 | Train Loss: 0.7518250 Vali Loss: 2.1855083 Test Loss: 1.4094630
Validation loss decreased (inf --> 2.185508).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 2 cost time: 0.6886036396026611
Epoch: 2, Steps: 52 | Train Loss: 0.7052260 Vali Loss: 1.9610448 Test Loss: 1.1649959
Validation loss decreased (2.185508 --> 1.961045).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 3 cost time: 0.6867749691009521
Epoch: 3, Steps: 52 | Train Loss: 0.6342425 Vali Loss: 1.7971816 Test Loss: 0.9536365
Validation loss decreased (1.961045 --> 1.797182).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 4 cost time: 0.6910004615783691
Epoch: 4, Steps: 52 | Train Loss: 0.5725367 Vali Loss: 1.6453531 Test Loss: 0.7740147
Validation loss decreased (1.797182 --> 1.645353).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 5 cost time: 0.6943643093109131
Epoch: 5, Steps: 52 | Train Loss: 0.5276040 Vali Loss: 1.5627708 Test Loss: 0.6487241
Validation loss decreased (1.645353 --> 1.562771).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 6 cost time: 1.1512558460235596
Epoch: 6, Steps: 52 | Train Loss: 0.4988427 Vali Loss: 1.5066155 Test Loss: 0.5737230
Validation loss decreased (1.562771 --> 1.506616).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 7 cost time: 1.549870252609253
Epoch: 7, Steps: 52 | Train Loss: 0.4817076 Vali Loss: 1.4722657 Test Loss: 0.5241231
Validation loss decreased (1.506616 --> 1.472266).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 8 cost time: 1.5462346076965332
Epoch: 8, Steps: 52 | Train Loss: 0.4680556 Vali Loss: 1.4490378 Test Loss: 0.4910203
Validation loss decreased (1.472266 --> 1.449038).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 9 cost time: 1.542409896850586
Epoch: 9, Steps: 52 | Train Loss: 0.4599552 Vali Loss: 1.4259486 Test Loss: 0.4678054
Validation loss decreased (1.449038 --> 1.425949).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 10 cost time: 1.5376133918762207
Epoch: 10, Steps: 52 | Train Loss: 0.4522082 Vali Loss: 1.4153740 Test Loss: 0.4507437
Validation loss decreased (1.425949 --> 1.415374).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 11 cost time: 1.5374977588653564
Epoch: 11, Steps: 52 | Train Loss: 0.4482040 Vali Loss: 1.4031837 Test Loss: 0.4384148
Validation loss decreased (1.415374 --> 1.403184).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 12 cost time: 1.5422487258911133
Epoch: 12, Steps: 52 | Train Loss: 0.4465612 Vali Loss: 1.3953803 Test Loss: 0.4304821
Validation loss decreased (1.403184 --> 1.395380).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 13 cost time: 1.5539321899414062
Epoch: 13, Steps: 52 | Train Loss: 0.4427784 Vali Loss: 1.3854064 Test Loss: 0.4229123
Validation loss decreased (1.395380 --> 1.385406).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 14 cost time: 1.5533831119537354
Epoch: 14, Steps: 52 | Train Loss: 0.4401045 Vali Loss: 1.3846463 Test Loss: 0.4181898
Validation loss decreased (1.385406 --> 1.384646).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 15 cost time: 1.5504343509674072
Epoch: 15, Steps: 52 | Train Loss: 0.4401184 Vali Loss: 1.3773643 Test Loss: 0.4138160
Validation loss decreased (1.384646 --> 1.377364).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 16 cost time: 1.5498452186584473
Epoch: 16, Steps: 52 | Train Loss: 0.4386781 Vali Loss: 1.3753276 Test Loss: 0.4102461
Validation loss decreased (1.377364 --> 1.375328).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 17 cost time: 1.549039363861084
Epoch: 17, Steps: 52 | Train Loss: 0.4369545 Vali Loss: 1.3719289 Test Loss: 0.4070148
Validation loss decreased (1.375328 --> 1.371929).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 18 cost time: 1.5473449230194092
Epoch: 18, Steps: 52 | Train Loss: 0.4350526 Vali Loss: 1.3634772 Test Loss: 0.4046994
Validation loss decreased (1.371929 --> 1.363477).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 19 cost time: 1.5495150089263916
Epoch: 19, Steps: 52 | Train Loss: 0.4346091 Vali Loss: 1.3662959 Test Loss: 0.4024993
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 20 cost time: 1.5564355850219727
Epoch: 20, Steps: 52 | Train Loss: 0.4322253 Vali Loss: 1.3627083 Test Loss: 0.4010261
Validation loss decreased (1.363477 --> 1.362708).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 21 cost time: 1.5524122714996338
Epoch: 21, Steps: 52 | Train Loss: 0.4305335 Vali Loss: 1.3468205 Test Loss: 0.3998046
Validation loss decreased (1.362708 --> 1.346820).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 22 cost time: 1.5549564361572266
Epoch: 22, Steps: 52 | Train Loss: 0.4310709 Vali Loss: 1.3566668 Test Loss: 0.3987247
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 23 cost time: 1.5504505634307861
Epoch: 23, Steps: 52 | Train Loss: 0.4308297 Vali Loss: 1.3598421 Test Loss: 0.3969786
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 24 cost time: 1.5542874336242676
Epoch: 24, Steps: 52 | Train Loss: 0.4305305 Vali Loss: 1.3536327 Test Loss: 0.3961227
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 25 cost time: 1.5540869235992432
Epoch: 25, Steps: 52 | Train Loss: 0.4310443 Vali Loss: 1.3534565 Test Loss: 0.3951147
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 26 cost time: 1.5543677806854248
Epoch: 26, Steps: 52 | Train Loss: 0.4295590 Vali Loss: 1.3523788 Test Loss: 0.3940274
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 27 cost time: 1.5488064289093018
Epoch: 27, Steps: 52 | Train Loss: 0.4290790 Vali Loss: 1.3466046 Test Loss: 0.3941151
Validation loss decreased (1.346820 --> 1.346605).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 28 cost time: 1.545445442199707
Epoch: 28, Steps: 52 | Train Loss: 0.4284383 Vali Loss: 1.3541386 Test Loss: 0.3935819
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 29 cost time: 1.548034906387329
Epoch: 29, Steps: 52 | Train Loss: 0.4277809 Vali Loss: 1.3516834 Test Loss: 0.3921615
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 30 cost time: 1.5547537803649902
Epoch: 30, Steps: 52 | Train Loss: 0.4279459 Vali Loss: 1.3486619 Test Loss: 0.3920094
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 31 cost time: 1.552654504776001
Epoch: 31, Steps: 52 | Train Loss: 0.4279517 Vali Loss: 1.3535368 Test Loss: 0.3919165
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 32 cost time: 1.554771900177002
Epoch: 32, Steps: 52 | Train Loss: 0.4270240 Vali Loss: 1.3450465 Test Loss: 0.3913536
Validation loss decreased (1.346605 --> 1.345047).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 33 cost time: 1.5534560680389404
Epoch: 33, Steps: 52 | Train Loss: 0.4284834 Vali Loss: 1.3490627 Test Loss: 0.3911594
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 34 cost time: 1.554518222808838
Epoch: 34, Steps: 52 | Train Loss: 0.4287882 Vali Loss: 1.3496764 Test Loss: 0.3903505
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 35 cost time: 1.5504796504974365
Epoch: 35, Steps: 52 | Train Loss: 0.4288435 Vali Loss: 1.3537632 Test Loss: 0.3901206
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 36 cost time: 1.5441153049468994
Epoch: 36, Steps: 52 | Train Loss: 0.4278532 Vali Loss: 1.3469595 Test Loss: 0.3898193
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 37 cost time: 1.5374367237091064
Epoch: 37, Steps: 52 | Train Loss: 0.4279300 Vali Loss: 1.3485754 Test Loss: 0.3901410
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 38 cost time: 1.5371057987213135
Epoch: 38, Steps: 52 | Train Loss: 0.4258906 Vali Loss: 1.3466293 Test Loss: 0.3896606
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 39 cost time: 1.5408806800842285
Epoch: 39, Steps: 52 | Train Loss: 0.4251768 Vali Loss: 1.3455486 Test Loss: 0.3902131
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 40 cost time: 1.5430176258087158
Epoch: 40, Steps: 52 | Train Loss: 0.4260624 Vali Loss: 1.3513640 Test Loss: 0.3894056
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 41 cost time: 1.5505495071411133
Epoch: 41, Steps: 52 | Train Loss: 0.4270522 Vali Loss: 1.3458500 Test Loss: 0.3892980
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 42 cost time: 1.5502197742462158
Epoch: 42, Steps: 52 | Train Loss: 0.4279252 Vali Loss: 1.3422153 Test Loss: 0.3900028
Validation loss decreased (1.345047 --> 1.342215).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 43 cost time: 1.5556645393371582
Epoch: 43, Steps: 52 | Train Loss: 0.4254902 Vali Loss: 1.3384765 Test Loss: 0.3892621
Validation loss decreased (1.342215 --> 1.338477).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 44 cost time: 1.5529890060424805
Epoch: 44, Steps: 52 | Train Loss: 0.4263268 Vali Loss: 1.3479853 Test Loss: 0.3890989
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 45 cost time: 1.554595708847046
Epoch: 45, Steps: 52 | Train Loss: 0.4253046 Vali Loss: 1.3521335 Test Loss: 0.3889503
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 46 cost time: 1.549196481704712
Epoch: 46, Steps: 52 | Train Loss: 0.4269573 Vali Loss: 1.3459227 Test Loss: 0.3886352
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 47 cost time: 1.5505948066711426
Epoch: 47, Steps: 52 | Train Loss: 0.4264241 Vali Loss: 1.3472128 Test Loss: 0.3886290
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 48 cost time: 1.5507452487945557
Epoch: 48, Steps: 52 | Train Loss: 0.4276013 Vali Loss: 1.3439190 Test Loss: 0.3887714
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 49 cost time: 1.5543689727783203
Epoch: 49, Steps: 52 | Train Loss: 0.4265597 Vali Loss: 1.3439134 Test Loss: 0.3890999
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 50 cost time: 1.551957130432129
Epoch: 50, Steps: 52 | Train Loss: 0.4267906 Vali Loss: 1.3346372 Test Loss: 0.3881316
Validation loss decreased (1.338477 --> 1.334637).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 51 cost time: 1.5536577701568604
Epoch: 51, Steps: 52 | Train Loss: 0.4272412 Vali Loss: 1.3447757 Test Loss: 0.3886085
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 52 cost time: 1.5491154193878174
Epoch: 52, Steps: 52 | Train Loss: 0.4263315 Vali Loss: 1.3455887 Test Loss: 0.3884066
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 53 cost time: 1.5483269691467285
Epoch: 53, Steps: 52 | Train Loss: 0.4252068 Vali Loss: 1.3479314 Test Loss: 0.3878537
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 54 cost time: 1.546602725982666
Epoch: 54, Steps: 52 | Train Loss: 0.4252430 Vali Loss: 1.3443568 Test Loss: 0.3885030
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 55 cost time: 1.5477838516235352
Epoch: 55, Steps: 52 | Train Loss: 0.4264197 Vali Loss: 1.3508961 Test Loss: 0.3885199
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 56 cost time: 1.5424113273620605
Epoch: 56, Steps: 52 | Train Loss: 0.4263793 Vali Loss: 1.3407459 Test Loss: 0.3882470
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 57 cost time: 1.5491719245910645
Epoch: 57, Steps: 52 | Train Loss: 0.4278959 Vali Loss: 1.3474021 Test Loss: 0.3883215
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 58 cost time: 1.550337553024292
Epoch: 58, Steps: 52 | Train Loss: 0.4269093 Vali Loss: 1.3496362 Test Loss: 0.3885899
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 59 cost time: 1.5490872859954834
Epoch: 59, Steps: 52 | Train Loss: 0.4246360 Vali Loss: 1.3422459 Test Loss: 0.3876238
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 60 cost time: 1.5494742393493652
Epoch: 60, Steps: 52 | Train Loss: 0.4255430 Vali Loss: 1.3407962 Test Loss: 0.3882572
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.38813158869743347, mae:0.4345022141933441, rse:0.5103854537010193
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 1 cost time: 2.08679461479187
Epoch: 1, Steps: 52 | Train Loss: 0.7062723 Vali Loss: 2.1598742 Test Loss: 1.3895268
Validation loss decreased (inf --> 2.159874).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 2 cost time: 0.7263884544372559
Epoch: 2, Steps: 52 | Train Loss: 0.6069624 Vali Loss: 1.6219130 Test Loss: 0.7613817
Validation loss decreased (2.159874 --> 1.621913).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 3 cost time: 0.7408678531646729
Epoch: 3, Steps: 52 | Train Loss: 0.4846009 Vali Loss: 1.4235609 Test Loss: 0.4565550
Validation loss decreased (1.621913 --> 1.423561).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 4 cost time: 0.7254536151885986
Epoch: 4, Steps: 52 | Train Loss: 0.4514305 Vali Loss: 1.4011983 Test Loss: 0.4378371
Validation loss decreased (1.423561 --> 1.401198).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 5 cost time: 0.7273995876312256
Epoch: 5, Steps: 52 | Train Loss: 0.4414907 Vali Loss: 1.3890620 Test Loss: 0.4209906
Validation loss decreased (1.401198 --> 1.389062).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 6 cost time: 1.4285659790039062
Epoch: 6, Steps: 52 | Train Loss: 0.4354120 Vali Loss: 1.3813969 Test Loss: 0.4101567
Validation loss decreased (1.389062 --> 1.381397).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 7 cost time: 1.6080188751220703
Epoch: 7, Steps: 52 | Train Loss: 0.4327360 Vali Loss: 1.3697258 Test Loss: 0.4020870
Validation loss decreased (1.381397 --> 1.369726).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 8 cost time: 1.6332545280456543
Epoch: 8, Steps: 52 | Train Loss: 0.4273311 Vali Loss: 1.3621397 Test Loss: 0.3961735
Validation loss decreased (1.369726 --> 1.362140).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 9 cost time: 1.6140286922454834
Epoch: 9, Steps: 52 | Train Loss: 0.4273396 Vali Loss: 1.3541086 Test Loss: 0.3922499
Validation loss decreased (1.362140 --> 1.354109).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 10 cost time: 1.6162753105163574
Epoch: 10, Steps: 52 | Train Loss: 0.4239150 Vali Loss: 1.3499939 Test Loss: 0.3884131
Validation loss decreased (1.354109 --> 1.349994).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 11 cost time: 1.6131043434143066
Epoch: 11, Steps: 52 | Train Loss: 0.4221134 Vali Loss: 1.3508217 Test Loss: 0.3854571
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 12 cost time: 1.6367075443267822
Epoch: 12, Steps: 52 | Train Loss: 0.4212012 Vali Loss: 1.3455987 Test Loss: 0.3830995
Validation loss decreased (1.349994 --> 1.345599).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 13 cost time: 1.6299309730529785
Epoch: 13, Steps: 52 | Train Loss: 0.4188751 Vali Loss: 1.3454654 Test Loss: 0.3810593
Validation loss decreased (1.345599 --> 1.345465).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 14 cost time: 1.6154215335845947
Epoch: 14, Steps: 52 | Train Loss: 0.4188426 Vali Loss: 1.3405190 Test Loss: 0.3799424
Validation loss decreased (1.345465 --> 1.340519).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 15 cost time: 1.632030963897705
Epoch: 15, Steps: 52 | Train Loss: 0.4175621 Vali Loss: 1.3340061 Test Loss: 0.3784550
Validation loss decreased (1.340519 --> 1.334006).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 16 cost time: 1.6342840194702148
Epoch: 16, Steps: 52 | Train Loss: 0.4166576 Vali Loss: 1.3223498 Test Loss: 0.3771839
Validation loss decreased (1.334006 --> 1.322350).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 17 cost time: 1.6093404293060303
Epoch: 17, Steps: 52 | Train Loss: 0.4152650 Vali Loss: 1.3349310 Test Loss: 0.3762326
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 18 cost time: 1.6195499897003174
Epoch: 18, Steps: 52 | Train Loss: 0.4160781 Vali Loss: 1.3294048 Test Loss: 0.3756950
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 19 cost time: 1.6120891571044922
Epoch: 19, Steps: 52 | Train Loss: 0.4148716 Vali Loss: 1.3299131 Test Loss: 0.3746386
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 20 cost time: 1.6250457763671875
Epoch: 20, Steps: 52 | Train Loss: 0.4154685 Vali Loss: 1.3253052 Test Loss: 0.3742023
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 21 cost time: 1.6276190280914307
Epoch: 21, Steps: 52 | Train Loss: 0.4128674 Vali Loss: 1.3225938 Test Loss: 0.3733487
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 22 cost time: 1.633871078491211
Epoch: 22, Steps: 52 | Train Loss: 0.4123516 Vali Loss: 1.3301706 Test Loss: 0.3729160
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 23 cost time: 1.6109836101531982
Epoch: 23, Steps: 52 | Train Loss: 0.4126922 Vali Loss: 1.3257263 Test Loss: 0.3724467
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 24 cost time: 1.618933916091919
Epoch: 24, Steps: 52 | Train Loss: 0.4144855 Vali Loss: 1.3193465 Test Loss: 0.3721129
Validation loss decreased (1.322350 --> 1.319347).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 25 cost time: 1.614222764968872
Epoch: 25, Steps: 52 | Train Loss: 0.4141737 Vali Loss: 1.3275635 Test Loss: 0.3714970
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 26 cost time: 1.6208992004394531
Epoch: 26, Steps: 52 | Train Loss: 0.4122498 Vali Loss: 1.3214526 Test Loss: 0.3710591
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 27 cost time: 1.631239891052246
Epoch: 27, Steps: 52 | Train Loss: 0.4118574 Vali Loss: 1.3197901 Test Loss: 0.3706916
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 28 cost time: 1.6311824321746826
Epoch: 28, Steps: 52 | Train Loss: 0.4112949 Vali Loss: 1.3283144 Test Loss: 0.3706197
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 29 cost time: 1.610269546508789
Epoch: 29, Steps: 52 | Train Loss: 0.4118384 Vali Loss: 1.3229113 Test Loss: 0.3705770
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 30 cost time: 1.6321403980255127
Epoch: 30, Steps: 52 | Train Loss: 0.4109507 Vali Loss: 1.3112755 Test Loss: 0.3699392
Validation loss decreased (1.319347 --> 1.311275).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 31 cost time: 1.6189219951629639
Epoch: 31, Steps: 52 | Train Loss: 0.4127605 Vali Loss: 1.3257033 Test Loss: 0.3699909
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 32 cost time: 1.6181449890136719
Epoch: 32, Steps: 52 | Train Loss: 0.4120459 Vali Loss: 1.3251441 Test Loss: 0.3698641
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 33 cost time: 1.6082277297973633
Epoch: 33, Steps: 52 | Train Loss: 0.4108363 Vali Loss: 1.3234310 Test Loss: 0.3696180
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 34 cost time: 1.6108872890472412
Epoch: 34, Steps: 52 | Train Loss: 0.4116093 Vali Loss: 1.3199782 Test Loss: 0.3694760
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 35 cost time: 1.6126718521118164
Epoch: 35, Steps: 52 | Train Loss: 0.4121214 Vali Loss: 1.3193674 Test Loss: 0.3693766
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 36 cost time: 1.6134600639343262
Epoch: 36, Steps: 52 | Train Loss: 0.4119144 Vali Loss: 1.3165821 Test Loss: 0.3691702
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 37 cost time: 1.6313145160675049
Epoch: 37, Steps: 52 | Train Loss: 0.4102122 Vali Loss: 1.3196577 Test Loss: 0.3690884
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 38 cost time: 1.6336746215820312
Epoch: 38, Steps: 52 | Train Loss: 0.4120816 Vali Loss: 1.3168160 Test Loss: 0.3690532
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 39 cost time: 1.6168262958526611
Epoch: 39, Steps: 52 | Train Loss: 0.4106143 Vali Loss: 1.3107520 Test Loss: 0.3691169
Validation loss decreased (1.311275 --> 1.310752).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 40 cost time: 1.6209425926208496
Epoch: 40, Steps: 52 | Train Loss: 0.4108613 Vali Loss: 1.3229954 Test Loss: 0.3690006
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 41 cost time: 1.6140685081481934
Epoch: 41, Steps: 52 | Train Loss: 0.4108950 Vali Loss: 1.3217793 Test Loss: 0.3689380
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 42 cost time: 1.6349892616271973
Epoch: 42, Steps: 52 | Train Loss: 0.4095653 Vali Loss: 1.3182895 Test Loss: 0.3691189
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 43 cost time: 1.6242222785949707
Epoch: 43, Steps: 52 | Train Loss: 0.4116376 Vali Loss: 1.3239210 Test Loss: 0.3690227
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 44 cost time: 1.617055892944336
Epoch: 44, Steps: 52 | Train Loss: 0.4099491 Vali Loss: 1.3235810 Test Loss: 0.3690652
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 45 cost time: 1.6158363819122314
Epoch: 45, Steps: 52 | Train Loss: 0.4101857 Vali Loss: 1.3165410 Test Loss: 0.3686576
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 46 cost time: 1.6156082153320312
Epoch: 46, Steps: 52 | Train Loss: 0.4115697 Vali Loss: 1.3184283 Test Loss: 0.3687143
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 47 cost time: 1.6125352382659912
Epoch: 47, Steps: 52 | Train Loss: 0.4113545 Vali Loss: 1.3192599 Test Loss: 0.3685675
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 48 cost time: 1.6184020042419434
Epoch: 48, Steps: 52 | Train Loss: 0.4105056 Vali Loss: 1.3214107 Test Loss: 0.3686247
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 49 cost time: 1.6253983974456787
Epoch: 49, Steps: 52 | Train Loss: 0.4094929 Vali Loss: 1.3136187 Test Loss: 0.3685655
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 50 cost time: 1.6365735530853271
Epoch: 50, Steps: 52 | Train Loss: 0.4096160 Vali Loss: 1.3179696 Test Loss: 0.3688224
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 51 cost time: 1.6108019351959229
Epoch: 51, Steps: 52 | Train Loss: 0.4109023 Vali Loss: 1.3223585 Test Loss: 0.3686056
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 52 cost time: 1.615800380706787
Epoch: 52, Steps: 52 | Train Loss: 0.4095159 Vali Loss: 1.3192806 Test Loss: 0.3684541
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 53 cost time: 1.6050810813903809
Epoch: 53, Steps: 52 | Train Loss: 0.4105056 Vali Loss: 1.3227634 Test Loss: 0.3684253
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 54 cost time: 1.6299633979797363
Epoch: 54, Steps: 52 | Train Loss: 0.4095656 Vali Loss: 1.3202622 Test Loss: 0.3684365
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 55 cost time: 1.6296308040618896
Epoch: 55, Steps: 52 | Train Loss: 0.4102361 Vali Loss: 1.3137156 Test Loss: 0.3684863
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 56 cost time: 1.6158561706542969
Epoch: 56, Steps: 52 | Train Loss: 0.4095574 Vali Loss: 1.3201581 Test Loss: 0.3684672
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 57 cost time: 1.6119153499603271
Epoch: 57, Steps: 52 | Train Loss: 0.4107000 Vali Loss: 1.3166919 Test Loss: 0.3685183
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 58 cost time: 1.6346909999847412
Epoch: 58, Steps: 52 | Train Loss: 0.4110778 Vali Loss: 1.3205621 Test Loss: 0.3684453
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 59 cost time: 1.6284496784210205
Epoch: 59, Steps: 52 | Train Loss: 0.4105665 Vali Loss: 1.3132958 Test Loss: 0.3682281
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 60 cost time: 1.6152474880218506
Epoch: 60, Steps: 52 | Train Loss: 0.4096595 Vali Loss: 1.3018930 Test Loss: 0.3685767
Validation loss decreased (1.310752 --> 1.301893).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36857664585113525, mae:0.41538354754447937, rse:0.4973621070384979
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05694866180419922 GB
Epoch: 1 cost time: 2.1680080890655518
Epoch: 1, Steps: 52 | Train Loss: 0.6823045 Vali Loss: 2.1099074 Test Loss: 1.3477279
Validation loss decreased (inf --> 2.109907).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 2 cost time: 0.7530257701873779
Epoch: 2, Steps: 52 | Train Loss: 0.5849414 Vali Loss: 1.5301483 Test Loss: 0.6218868
Validation loss decreased (2.109907 --> 1.530148).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 3 cost time: 0.7633471488952637
Epoch: 3, Steps: 52 | Train Loss: 0.4671508 Vali Loss: 1.4054420 Test Loss: 0.4338579
Validation loss decreased (1.530148 --> 1.405442).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 4 cost time: 0.7291462421417236
Epoch: 4, Steps: 52 | Train Loss: 0.4437879 Vali Loss: 1.3941659 Test Loss: 0.4148958
Validation loss decreased (1.405442 --> 1.394166).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 5 cost time: 0.7470006942749023
Epoch: 5, Steps: 52 | Train Loss: 0.4340650 Vali Loss: 1.3721499 Test Loss: 0.4039893
Validation loss decreased (1.394166 --> 1.372150).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 6 cost time: 1.645474910736084
Epoch: 6, Steps: 52 | Train Loss: 0.4311175 Vali Loss: 1.3690041 Test Loss: 0.3963756
Validation loss decreased (1.372150 --> 1.369004).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 7 cost time: 1.65431547164917
Epoch: 7, Steps: 52 | Train Loss: 0.4258739 Vali Loss: 1.3617876 Test Loss: 0.3883363
Validation loss decreased (1.369004 --> 1.361788).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 8 cost time: 1.661024570465088
Epoch: 8, Steps: 52 | Train Loss: 0.4229004 Vali Loss: 1.3478676 Test Loss: 0.3852827
Validation loss decreased (1.361788 --> 1.347868).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 9 cost time: 1.6787240505218506
Epoch: 9, Steps: 52 | Train Loss: 0.4215187 Vali Loss: 1.3477126 Test Loss: 0.3821953
Validation loss decreased (1.347868 --> 1.347713).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 10 cost time: 1.6592175960540771
Epoch: 10, Steps: 52 | Train Loss: 0.4207203 Vali Loss: 1.3408552 Test Loss: 0.3787597
Validation loss decreased (1.347713 --> 1.340855).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 11 cost time: 1.6738944053649902
Epoch: 11, Steps: 52 | Train Loss: 0.4189376 Vali Loss: 1.3352400 Test Loss: 0.3766811
Validation loss decreased (1.340855 --> 1.335240).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 12 cost time: 1.6626765727996826
Epoch: 12, Steps: 52 | Train Loss: 0.4163304 Vali Loss: 1.3366557 Test Loss: 0.3741371
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 13 cost time: 1.6691629886627197
Epoch: 13, Steps: 52 | Train Loss: 0.4161055 Vali Loss: 1.3293586 Test Loss: 0.3730410
Validation loss decreased (1.335240 --> 1.329359).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 14 cost time: 1.6602773666381836
Epoch: 14, Steps: 52 | Train Loss: 0.4138509 Vali Loss: 1.3300807 Test Loss: 0.3722284
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 15 cost time: 1.6502809524536133
Epoch: 15, Steps: 52 | Train Loss: 0.4125746 Vali Loss: 1.3209786 Test Loss: 0.3707785
Validation loss decreased (1.329359 --> 1.320979).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 16 cost time: 1.660703420639038
Epoch: 16, Steps: 52 | Train Loss: 0.4118699 Vali Loss: 1.3224266 Test Loss: 0.3701302
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 17 cost time: 1.6543972492218018
Epoch: 17, Steps: 52 | Train Loss: 0.4120272 Vali Loss: 1.3210936 Test Loss: 0.3692105
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 18 cost time: 1.6713066101074219
Epoch: 18, Steps: 52 | Train Loss: 0.4126427 Vali Loss: 1.3117967 Test Loss: 0.3684833
Validation loss decreased (1.320979 --> 1.311797).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 19 cost time: 1.65716552734375
Epoch: 19, Steps: 52 | Train Loss: 0.4102347 Vali Loss: 1.3195733 Test Loss: 0.3681265
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 20 cost time: 1.6662781238555908
Epoch: 20, Steps: 52 | Train Loss: 0.4110447 Vali Loss: 1.3188727 Test Loss: 0.3679080
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 21 cost time: 1.6541757583618164
Epoch: 21, Steps: 52 | Train Loss: 0.4085889 Vali Loss: 1.3206761 Test Loss: 0.3676640
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 22 cost time: 1.663733720779419
Epoch: 22, Steps: 52 | Train Loss: 0.4097871 Vali Loss: 1.3182173 Test Loss: 0.3669808
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 23 cost time: 1.659590244293213
Epoch: 23, Steps: 52 | Train Loss: 0.4099133 Vali Loss: 1.3132715 Test Loss: 0.3668265
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 24 cost time: 1.6601018905639648
Epoch: 24, Steps: 52 | Train Loss: 0.4100492 Vali Loss: 1.3201473 Test Loss: 0.3666352
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 25 cost time: 1.6705732345581055
Epoch: 25, Steps: 52 | Train Loss: 0.4092332 Vali Loss: 1.3164433 Test Loss: 0.3663870
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 26 cost time: 1.6596465110778809
Epoch: 26, Steps: 52 | Train Loss: 0.4077837 Vali Loss: 1.3206611 Test Loss: 0.3661824
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 27 cost time: 1.6743099689483643
Epoch: 27, Steps: 52 | Train Loss: 0.4103247 Vali Loss: 1.3062270 Test Loss: 0.3657835
Validation loss decreased (1.311797 --> 1.306227).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 28 cost time: 1.6644210815429688
Epoch: 28, Steps: 52 | Train Loss: 0.4090519 Vali Loss: 1.3169770 Test Loss: 0.3658584
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 29 cost time: 1.6722385883331299
Epoch: 29, Steps: 52 | Train Loss: 0.4078319 Vali Loss: 1.3137918 Test Loss: 0.3655244
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 30 cost time: 1.6563100814819336
Epoch: 30, Steps: 52 | Train Loss: 0.4093092 Vali Loss: 1.2988966 Test Loss: 0.3654281
Validation loss decreased (1.306227 --> 1.298897).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 31 cost time: 1.6804118156433105
Epoch: 31, Steps: 52 | Train Loss: 0.4072547 Vali Loss: 1.3152894 Test Loss: 0.3650474
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 32 cost time: 1.6584057807922363
Epoch: 32, Steps: 52 | Train Loss: 0.4076273 Vali Loss: 1.3173590 Test Loss: 0.3652379
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 33 cost time: 1.6590080261230469
Epoch: 33, Steps: 52 | Train Loss: 0.4071206 Vali Loss: 1.3189107 Test Loss: 0.3649747
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 34 cost time: 1.6599788665771484
Epoch: 34, Steps: 52 | Train Loss: 0.4065875 Vali Loss: 1.3181765 Test Loss: 0.3651560
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 35 cost time: 1.6644456386566162
Epoch: 35, Steps: 52 | Train Loss: 0.4062868 Vali Loss: 1.3187084 Test Loss: 0.3651990
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 36 cost time: 1.671442985534668
Epoch: 36, Steps: 52 | Train Loss: 0.4073900 Vali Loss: 1.3182422 Test Loss: 0.3651095
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 37 cost time: 1.660386085510254
Epoch: 37, Steps: 52 | Train Loss: 0.4070943 Vali Loss: 1.3161461 Test Loss: 0.3647561
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 38 cost time: 1.6603820323944092
Epoch: 38, Steps: 52 | Train Loss: 0.4064587 Vali Loss: 1.3013194 Test Loss: 0.3645270
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 39 cost time: 1.6619610786437988
Epoch: 39, Steps: 52 | Train Loss: 0.4082713 Vali Loss: 1.3195533 Test Loss: 0.3649706
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 40 cost time: 1.6627850532531738
Epoch: 40, Steps: 52 | Train Loss: 0.4077104 Vali Loss: 1.3130031 Test Loss: 0.3646049
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 41 cost time: 1.6636672019958496
Epoch: 41, Steps: 52 | Train Loss: 0.4057692 Vali Loss: 1.3146033 Test Loss: 0.3647698
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 42 cost time: 1.6645166873931885
Epoch: 42, Steps: 52 | Train Loss: 0.4077876 Vali Loss: 1.3116858 Test Loss: 0.3648605
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 43 cost time: 1.6643691062927246
Epoch: 43, Steps: 52 | Train Loss: 0.4076761 Vali Loss: 1.3180708 Test Loss: 0.3647399
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 44 cost time: 1.6706788539886475
Epoch: 44, Steps: 52 | Train Loss: 0.4065513 Vali Loss: 1.3098662 Test Loss: 0.3648284
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 45 cost time: 1.6562438011169434
Epoch: 45, Steps: 52 | Train Loss: 0.4075979 Vali Loss: 1.3196497 Test Loss: 0.3646861
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 46 cost time: 1.6714956760406494
Epoch: 46, Steps: 52 | Train Loss: 0.4075704 Vali Loss: 1.3110355 Test Loss: 0.3648060
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 47 cost time: 1.6550817489624023
Epoch: 47, Steps: 52 | Train Loss: 0.4067049 Vali Loss: 1.3086431 Test Loss: 0.3645309
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 48 cost time: 1.670348882675171
Epoch: 48, Steps: 52 | Train Loss: 0.4063558 Vali Loss: 1.3030658 Test Loss: 0.3643536
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 49 cost time: 1.6651501655578613
Epoch: 49, Steps: 52 | Train Loss: 0.4058666 Vali Loss: 1.3089073 Test Loss: 0.3646437
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 50 cost time: 1.6688108444213867
Epoch: 50, Steps: 52 | Train Loss: 0.4063960 Vali Loss: 1.3120990 Test Loss: 0.3639963
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 51 cost time: 1.6609911918640137
Epoch: 51, Steps: 52 | Train Loss: 0.4063035 Vali Loss: 1.3102337 Test Loss: 0.3642728
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 52 cost time: 1.6720244884490967
Epoch: 52, Steps: 52 | Train Loss: 0.4084460 Vali Loss: 1.3072495 Test Loss: 0.3646593
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 53 cost time: 1.658501386642456
Epoch: 53, Steps: 52 | Train Loss: 0.4078719 Vali Loss: 1.3074377 Test Loss: 0.3645573
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 54 cost time: 1.663468360900879
Epoch: 54, Steps: 52 | Train Loss: 0.4052526 Vali Loss: 1.3136894 Test Loss: 0.3642994
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 55 cost time: 1.6586413383483887
Epoch: 55, Steps: 52 | Train Loss: 0.4064344 Vali Loss: 1.3106965 Test Loss: 0.3643077
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 56 cost time: 1.6561942100524902
Epoch: 56, Steps: 52 | Train Loss: 0.4067523 Vali Loss: 1.3142302 Test Loss: 0.3642826
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 57 cost time: 1.6762685775756836
Epoch: 57, Steps: 52 | Train Loss: 0.4073353 Vali Loss: 1.3159695 Test Loss: 0.3644444
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 58 cost time: 1.6602091789245605
Epoch: 58, Steps: 52 | Train Loss: 0.4050863 Vali Loss: 1.3138785 Test Loss: 0.3643590
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 59 cost time: 1.6706690788269043
Epoch: 59, Steps: 52 | Train Loss: 0.4068010 Vali Loss: 1.3136289 Test Loss: 0.3644190
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 60 cost time: 1.6570453643798828
Epoch: 60, Steps: 52 | Train Loss: 0.4079186 Vali Loss: 1.3077047 Test Loss: 0.3641000
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3654281198978424, mae:0.4119912385940552, rse:0.4952332675457001
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.04982280731201172 GB
Epoch: 1 cost time: 2.0596556663513184
Epoch: 1, Steps: 52 | Train Loss: 0.7910314 Vali Loss: 2.3344598 Test Loss: 1.5267320
Validation loss decreased (inf --> 2.334460).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 2 cost time: 0.680394172668457
Epoch: 2, Steps: 52 | Train Loss: 0.7282549 Vali Loss: 2.0270271 Test Loss: 1.2151196
Validation loss decreased (2.334460 --> 2.027027).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 3 cost time: 0.6863408088684082
Epoch: 3, Steps: 52 | Train Loss: 0.6432994 Vali Loss: 1.8252246 Test Loss: 0.9779159
Validation loss decreased (2.027027 --> 1.825225).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 4 cost time: 0.6828145980834961
Epoch: 4, Steps: 52 | Train Loss: 0.5812213 Vali Loss: 1.6737326 Test Loss: 0.7750111
Validation loss decreased (1.825225 --> 1.673733).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 5 cost time: 0.6977691650390625
Epoch: 5, Steps: 52 | Train Loss: 0.5322195 Vali Loss: 1.5764987 Test Loss: 0.6489097
Validation loss decreased (1.673733 --> 1.576499).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 6 cost time: 1.1299304962158203
Epoch: 6, Steps: 52 | Train Loss: 0.5023303 Vali Loss: 1.5188626 Test Loss: 0.5621618
Validation loss decreased (1.576499 --> 1.518863).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 7 cost time: 1.5586929321289062
Epoch: 7, Steps: 52 | Train Loss: 0.4818800 Vali Loss: 1.4737307 Test Loss: 0.5088059
Validation loss decreased (1.518863 --> 1.473731).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 8 cost time: 1.574559211730957
Epoch: 8, Steps: 52 | Train Loss: 0.4686010 Vali Loss: 1.4428729 Test Loss: 0.4716605
Validation loss decreased (1.473731 --> 1.442873).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 9 cost time: 1.570608377456665
Epoch: 9, Steps: 52 | Train Loss: 0.4583275 Vali Loss: 1.4301007 Test Loss: 0.4469106
Validation loss decreased (1.442873 --> 1.430101).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 10 cost time: 1.5715248584747314
Epoch: 10, Steps: 52 | Train Loss: 0.4502815 Vali Loss: 1.4091797 Test Loss: 0.4316608
Validation loss decreased (1.430101 --> 1.409180).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 11 cost time: 1.5675160884857178
Epoch: 11, Steps: 52 | Train Loss: 0.4478060 Vali Loss: 1.4037976 Test Loss: 0.4213569
Validation loss decreased (1.409180 --> 1.403798).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 12 cost time: 1.5722200870513916
Epoch: 12, Steps: 52 | Train Loss: 0.4432037 Vali Loss: 1.3968997 Test Loss: 0.4135092
Validation loss decreased (1.403798 --> 1.396900).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 13 cost time: 1.5705926418304443
Epoch: 13, Steps: 52 | Train Loss: 0.4384040 Vali Loss: 1.3823135 Test Loss: 0.4066728
Validation loss decreased (1.396900 --> 1.382313).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 14 cost time: 1.572866678237915
Epoch: 14, Steps: 52 | Train Loss: 0.4359725 Vali Loss: 1.3841292 Test Loss: 0.4033039
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 15 cost time: 1.5672967433929443
Epoch: 15, Steps: 52 | Train Loss: 0.4352056 Vali Loss: 1.3772008 Test Loss: 0.3985979
Validation loss decreased (1.382313 --> 1.377201).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 16 cost time: 1.570176362991333
Epoch: 16, Steps: 52 | Train Loss: 0.4323134 Vali Loss: 1.3630537 Test Loss: 0.3944804
Validation loss decreased (1.377201 --> 1.363054).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 17 cost time: 1.570849895477295
Epoch: 17, Steps: 52 | Train Loss: 0.4298552 Vali Loss: 1.3636788 Test Loss: 0.3922570
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 18 cost time: 1.5690231323242188
Epoch: 18, Steps: 52 | Train Loss: 0.4300730 Vali Loss: 1.3676934 Test Loss: 0.3901456
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 19 cost time: 1.5721831321716309
Epoch: 19, Steps: 52 | Train Loss: 0.4276587 Vali Loss: 1.3577329 Test Loss: 0.3886902
Validation loss decreased (1.363054 --> 1.357733).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 20 cost time: 1.5700397491455078
Epoch: 20, Steps: 52 | Train Loss: 0.4297127 Vali Loss: 1.3602945 Test Loss: 0.3870473
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 21 cost time: 1.5659596920013428
Epoch: 21, Steps: 52 | Train Loss: 0.4254587 Vali Loss: 1.3648160 Test Loss: 0.3862419
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 22 cost time: 1.5734038352966309
Epoch: 22, Steps: 52 | Train Loss: 0.4276852 Vali Loss: 1.3569224 Test Loss: 0.3849044
Validation loss decreased (1.357733 --> 1.356922).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 23 cost time: 1.5662379264831543
Epoch: 23, Steps: 52 | Train Loss: 0.4253836 Vali Loss: 1.3487027 Test Loss: 0.3834658
Validation loss decreased (1.356922 --> 1.348703).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 24 cost time: 1.5696945190429688
Epoch: 24, Steps: 52 | Train Loss: 0.4234122 Vali Loss: 1.3551414 Test Loss: 0.3830437
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 25 cost time: 1.571274995803833
Epoch: 25, Steps: 52 | Train Loss: 0.4250361 Vali Loss: 1.3568785 Test Loss: 0.3816997
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 26 cost time: 1.566784381866455
Epoch: 26, Steps: 52 | Train Loss: 0.4254917 Vali Loss: 1.3523090 Test Loss: 0.3816990
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 27 cost time: 1.5685575008392334
Epoch: 27, Steps: 52 | Train Loss: 0.4241106 Vali Loss: 1.3441758 Test Loss: 0.3803393
Validation loss decreased (1.348703 --> 1.344176).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 28 cost time: 1.5693564414978027
Epoch: 28, Steps: 52 | Train Loss: 0.4253815 Vali Loss: 1.3475299 Test Loss: 0.3800941
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 29 cost time: 1.5690927505493164
Epoch: 29, Steps: 52 | Train Loss: 0.4236260 Vali Loss: 1.3543259 Test Loss: 0.3801429
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 30 cost time: 1.5683798789978027
Epoch: 30, Steps: 52 | Train Loss: 0.4231460 Vali Loss: 1.3506918 Test Loss: 0.3792976
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 31 cost time: 1.566753625869751
Epoch: 31, Steps: 52 | Train Loss: 0.4224458 Vali Loss: 1.3507115 Test Loss: 0.3794997
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 32 cost time: 1.573652744293213
Epoch: 32, Steps: 52 | Train Loss: 0.4207925 Vali Loss: 1.3394903 Test Loss: 0.3788277
Validation loss decreased (1.344176 --> 1.339490).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 33 cost time: 1.5731751918792725
Epoch: 33, Steps: 52 | Train Loss: 0.4205900 Vali Loss: 1.3508854 Test Loss: 0.3780742
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 34 cost time: 1.5658621788024902
Epoch: 34, Steps: 52 | Train Loss: 0.4221676 Vali Loss: 1.3533287 Test Loss: 0.3790588
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 35 cost time: 1.5676250457763672
Epoch: 35, Steps: 52 | Train Loss: 0.4209728 Vali Loss: 1.3426148 Test Loss: 0.3778384
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 36 cost time: 1.5650131702423096
Epoch: 36, Steps: 52 | Train Loss: 0.4210677 Vali Loss: 1.3383889 Test Loss: 0.3784069
Validation loss decreased (1.339490 --> 1.338389).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 37 cost time: 1.5696632862091064
Epoch: 37, Steps: 52 | Train Loss: 0.4218739 Vali Loss: 1.3478361 Test Loss: 0.3775131
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 38 cost time: 1.5658307075500488
Epoch: 38, Steps: 52 | Train Loss: 0.4216423 Vali Loss: 1.3475182 Test Loss: 0.3777073
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 39 cost time: 1.571359395980835
Epoch: 39, Steps: 52 | Train Loss: 0.4209239 Vali Loss: 1.3428717 Test Loss: 0.3774857
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 40 cost time: 1.56211519241333
Epoch: 40, Steps: 52 | Train Loss: 0.4214025 Vali Loss: 1.3452027 Test Loss: 0.3772426
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 41 cost time: 1.5660791397094727
Epoch: 41, Steps: 52 | Train Loss: 0.4206346 Vali Loss: 1.3445450 Test Loss: 0.3767835
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 42 cost time: 1.5559074878692627
Epoch: 42, Steps: 52 | Train Loss: 0.4217810 Vali Loss: 1.3472081 Test Loss: 0.3774835
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 43 cost time: 1.5625262260437012
Epoch: 43, Steps: 52 | Train Loss: 0.4215623 Vali Loss: 1.3403678 Test Loss: 0.3768636
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 44 cost time: 1.5590827465057373
Epoch: 44, Steps: 52 | Train Loss: 0.4213116 Vali Loss: 1.3496174 Test Loss: 0.3771208
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 45 cost time: 1.5625932216644287
Epoch: 45, Steps: 52 | Train Loss: 0.4202210 Vali Loss: 1.3480551 Test Loss: 0.3768198
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 46 cost time: 1.5575525760650635
Epoch: 46, Steps: 52 | Train Loss: 0.4203586 Vali Loss: 1.3402033 Test Loss: 0.3766425
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 47 cost time: 1.5597209930419922
Epoch: 47, Steps: 52 | Train Loss: 0.4202917 Vali Loss: 1.3466526 Test Loss: 0.3763571
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 48 cost time: 1.5693964958190918
Epoch: 48, Steps: 52 | Train Loss: 0.4215170 Vali Loss: 1.3417604 Test Loss: 0.3764877
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 49 cost time: 1.5734460353851318
Epoch: 49, Steps: 52 | Train Loss: 0.4195805 Vali Loss: 1.3386810 Test Loss: 0.3762360
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 50 cost time: 1.5680968761444092
Epoch: 50, Steps: 52 | Train Loss: 0.4210168 Vali Loss: 1.3429079 Test Loss: 0.3764354
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 51 cost time: 1.5764319896697998
Epoch: 51, Steps: 52 | Train Loss: 0.4217641 Vali Loss: 1.3403803 Test Loss: 0.3761690
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 52 cost time: 1.5678586959838867
Epoch: 52, Steps: 52 | Train Loss: 0.4198756 Vali Loss: 1.3441355 Test Loss: 0.3763542
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 53 cost time: 1.5708339214324951
Epoch: 53, Steps: 52 | Train Loss: 0.4209402 Vali Loss: 1.3474886 Test Loss: 0.3760644
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 54 cost time: 1.5693552494049072
Epoch: 54, Steps: 52 | Train Loss: 0.4192497 Vali Loss: 1.3385749 Test Loss: 0.3764401
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 55 cost time: 1.574324131011963
Epoch: 55, Steps: 52 | Train Loss: 0.4198776 Vali Loss: 1.3447733 Test Loss: 0.3762193
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 56 cost time: 1.5615782737731934
Epoch: 56, Steps: 52 | Train Loss: 0.4196773 Vali Loss: 1.3471159 Test Loss: 0.3764175
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 57 cost time: 1.5736992359161377
Epoch: 57, Steps: 52 | Train Loss: 0.4207733 Vali Loss: 1.3433247 Test Loss: 0.3757046
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 58 cost time: 1.5681581497192383
Epoch: 58, Steps: 52 | Train Loss: 0.4213140 Vali Loss: 1.3430874 Test Loss: 0.3764983
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 59 cost time: 1.5695669651031494
Epoch: 59, Steps: 52 | Train Loss: 0.4225349 Vali Loss: 1.3345953 Test Loss: 0.3759726
Validation loss decreased (1.338389 --> 1.334595).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 60 cost time: 1.5704190731048584
Epoch: 60, Steps: 52 | Train Loss: 0.4214370 Vali Loss: 1.3419087 Test Loss: 0.3759181
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3759726285934448, mae:0.41963815689086914, rse:0.5023274421691895
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 1 cost time: 2.1234970092773438
Epoch: 1, Steps: 52 | Train Loss: 0.7057495 Vali Loss: 2.1362114 Test Loss: 1.3917197
Validation loss decreased (inf --> 2.136211).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 2 cost time: 0.7456133365631104
Epoch: 2, Steps: 52 | Train Loss: 0.6116856 Vali Loss: 1.6186411 Test Loss: 0.7611316
Validation loss decreased (2.136211 --> 1.618641).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 3 cost time: 0.7485966682434082
Epoch: 3, Steps: 52 | Train Loss: 0.4845830 Vali Loss: 1.3981255 Test Loss: 0.4346365
Validation loss decreased (1.618641 --> 1.398126).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 4 cost time: 0.7469861507415771
Epoch: 4, Steps: 52 | Train Loss: 0.4484965 Vali Loss: 1.3844833 Test Loss: 0.4161410
Validation loss decreased (1.398126 --> 1.384483).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 5 cost time: 0.751800537109375
Epoch: 5, Steps: 52 | Train Loss: 0.4365725 Vali Loss: 1.3694143 Test Loss: 0.4001940
Validation loss decreased (1.384483 --> 1.369414).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 6 cost time: 1.6129236221313477
Epoch: 6, Steps: 52 | Train Loss: 0.4317208 Vali Loss: 1.3676450 Test Loss: 0.3898913
Validation loss decreased (1.369414 --> 1.367645).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 7 cost time: 1.6169483661651611
Epoch: 7, Steps: 52 | Train Loss: 0.4269493 Vali Loss: 1.3602579 Test Loss: 0.3831830
Validation loss decreased (1.367645 --> 1.360258).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 8 cost time: 1.6422758102416992
Epoch: 8, Steps: 52 | Train Loss: 0.4234905 Vali Loss: 1.3541570 Test Loss: 0.3792570
Validation loss decreased (1.360258 --> 1.354157).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 9 cost time: 1.6165571212768555
Epoch: 9, Steps: 52 | Train Loss: 0.4200048 Vali Loss: 1.3433570 Test Loss: 0.3761941
Validation loss decreased (1.354157 --> 1.343357).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 10 cost time: 1.6393661499023438
Epoch: 10, Steps: 52 | Train Loss: 0.4185632 Vali Loss: 1.3404784 Test Loss: 0.3742659
Validation loss decreased (1.343357 --> 1.340478).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 11 cost time: 1.6123323440551758
Epoch: 11, Steps: 52 | Train Loss: 0.4178622 Vali Loss: 1.3410939 Test Loss: 0.3726352
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 12 cost time: 1.6156158447265625
Epoch: 12, Steps: 52 | Train Loss: 0.4164976 Vali Loss: 1.3297429 Test Loss: 0.3711043
Validation loss decreased (1.340478 --> 1.329743).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 13 cost time: 1.612497329711914
Epoch: 13, Steps: 52 | Train Loss: 0.4134405 Vali Loss: 1.3316174 Test Loss: 0.3701780
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 14 cost time: 1.6343939304351807
Epoch: 14, Steps: 52 | Train Loss: 0.4125992 Vali Loss: 1.3230810 Test Loss: 0.3698776
Validation loss decreased (1.329743 --> 1.323081).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 15 cost time: 1.6321496963500977
Epoch: 15, Steps: 52 | Train Loss: 0.4123242 Vali Loss: 1.3199470 Test Loss: 0.3681767
Validation loss decreased (1.323081 --> 1.319947).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 16 cost time: 1.6202993392944336
Epoch: 16, Steps: 52 | Train Loss: 0.4122436 Vali Loss: 1.3178198 Test Loss: 0.3689263
Validation loss decreased (1.319947 --> 1.317820).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 17 cost time: 1.618011713027954
Epoch: 17, Steps: 52 | Train Loss: 0.4107844 Vali Loss: 1.3152604 Test Loss: 0.3678294
Validation loss decreased (1.317820 --> 1.315260).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 18 cost time: 1.6175017356872559
Epoch: 18, Steps: 52 | Train Loss: 0.4090649 Vali Loss: 1.3184304 Test Loss: 0.3678178
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 19 cost time: 1.607658863067627
Epoch: 19, Steps: 52 | Train Loss: 0.4089536 Vali Loss: 1.3169777 Test Loss: 0.3684833
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 20 cost time: 1.6174564361572266
Epoch: 20, Steps: 52 | Train Loss: 0.4101085 Vali Loss: 1.3135128 Test Loss: 0.3672934
Validation loss decreased (1.315260 --> 1.313513).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 21 cost time: 1.627666711807251
Epoch: 21, Steps: 52 | Train Loss: 0.4089544 Vali Loss: 1.3066535 Test Loss: 0.3677922
Validation loss decreased (1.313513 --> 1.306653).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 22 cost time: 1.6301796436309814
Epoch: 22, Steps: 52 | Train Loss: 0.4091109 Vali Loss: 1.3150339 Test Loss: 0.3679689
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 23 cost time: 1.6115784645080566
Epoch: 23, Steps: 52 | Train Loss: 0.4090861 Vali Loss: 1.3101509 Test Loss: 0.3684622
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 24 cost time: 1.617086410522461
Epoch: 24, Steps: 52 | Train Loss: 0.4071738 Vali Loss: 1.3166829 Test Loss: 0.3673745
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 25 cost time: 1.610163927078247
Epoch: 25, Steps: 52 | Train Loss: 0.4079400 Vali Loss: 1.3117929 Test Loss: 0.3677081
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 26 cost time: 1.6275944709777832
Epoch: 26, Steps: 52 | Train Loss: 0.4081885 Vali Loss: 1.3100021 Test Loss: 0.3668161
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 27 cost time: 1.6262853145599365
Epoch: 27, Steps: 52 | Train Loss: 0.4095670 Vali Loss: 1.3100275 Test Loss: 0.3675272
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 28 cost time: 1.6206638813018799
Epoch: 28, Steps: 52 | Train Loss: 0.4064060 Vali Loss: 1.3032503 Test Loss: 0.3663476
Validation loss decreased (1.306653 --> 1.303250).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 29 cost time: 1.6639890670776367
Epoch: 29, Steps: 52 | Train Loss: 0.4065049 Vali Loss: 1.3099723 Test Loss: 0.3668511
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 30 cost time: 1.6153008937835693
Epoch: 30, Steps: 52 | Train Loss: 0.4072656 Vali Loss: 1.3025939 Test Loss: 0.3673449
Validation loss decreased (1.303250 --> 1.302594).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 31 cost time: 1.6171400547027588
Epoch: 31, Steps: 52 | Train Loss: 0.4077815 Vali Loss: 1.3134484 Test Loss: 0.3669669
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 32 cost time: 1.6117384433746338
Epoch: 32, Steps: 52 | Train Loss: 0.4074764 Vali Loss: 1.3076754 Test Loss: 0.3664751
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 33 cost time: 1.613717794418335
Epoch: 33, Steps: 52 | Train Loss: 0.4074267 Vali Loss: 1.3037076 Test Loss: 0.3662633
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 34 cost time: 1.6153957843780518
Epoch: 34, Steps: 52 | Train Loss: 0.4053068 Vali Loss: 1.3044064 Test Loss: 0.3673439
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 35 cost time: 1.6097416877746582
Epoch: 35, Steps: 52 | Train Loss: 0.4065876 Vali Loss: 1.3058112 Test Loss: 0.3661739
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 36 cost time: 1.614274024963379
Epoch: 36, Steps: 52 | Train Loss: 0.4059795 Vali Loss: 1.3057938 Test Loss: 0.3664095
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 37 cost time: 1.6076784133911133
Epoch: 37, Steps: 52 | Train Loss: 0.4061389 Vali Loss: 1.3041925 Test Loss: 0.3668909
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 38 cost time: 1.6267776489257812
Epoch: 38, Steps: 52 | Train Loss: 0.4061533 Vali Loss: 1.3001620 Test Loss: 0.3666608
Validation loss decreased (1.302594 --> 1.300162).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 39 cost time: 1.6330738067626953
Epoch: 39, Steps: 52 | Train Loss: 0.4051969 Vali Loss: 1.3093615 Test Loss: 0.3665121
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 40 cost time: 1.6110270023345947
Epoch: 40, Steps: 52 | Train Loss: 0.4066768 Vali Loss: 1.3034809 Test Loss: 0.3664212
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 41 cost time: 1.6199164390563965
Epoch: 41, Steps: 52 | Train Loss: 0.4061790 Vali Loss: 1.3126999 Test Loss: 0.3663643
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 42 cost time: 1.6312365531921387
Epoch: 42, Steps: 52 | Train Loss: 0.4051351 Vali Loss: 1.3023782 Test Loss: 0.3650927
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 43 cost time: 1.627046823501587
Epoch: 43, Steps: 52 | Train Loss: 0.4047780 Vali Loss: 1.3042883 Test Loss: 0.3661023
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 44 cost time: 1.6124327182769775
Epoch: 44, Steps: 52 | Train Loss: 0.4072113 Vali Loss: 1.3046077 Test Loss: 0.3660844
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 45 cost time: 1.6155674457550049
Epoch: 45, Steps: 52 | Train Loss: 0.4067822 Vali Loss: 1.3063073 Test Loss: 0.3669012
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 46 cost time: 1.6299912929534912
Epoch: 46, Steps: 52 | Train Loss: 0.4063424 Vali Loss: 1.3061209 Test Loss: 0.3671752
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 47 cost time: 1.629680871963501
Epoch: 47, Steps: 52 | Train Loss: 0.4056108 Vali Loss: 1.3080264 Test Loss: 0.3669402
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 48 cost time: 1.610870599746704
Epoch: 48, Steps: 52 | Train Loss: 0.4072869 Vali Loss: 1.3096297 Test Loss: 0.3664958
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 49 cost time: 1.6282532215118408
Epoch: 49, Steps: 52 | Train Loss: 0.4051513 Vali Loss: 1.3071589 Test Loss: 0.3664409
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 50 cost time: 1.6319639682769775
Epoch: 50, Steps: 52 | Train Loss: 0.4061183 Vali Loss: 1.3099380 Test Loss: 0.3657092
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 51 cost time: 1.6072382926940918
Epoch: 51, Steps: 52 | Train Loss: 0.4059751 Vali Loss: 1.3053856 Test Loss: 0.3662559
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 52 cost time: 1.6254589557647705
Epoch: 52, Steps: 52 | Train Loss: 0.4065893 Vali Loss: 1.3086836 Test Loss: 0.3665512
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 53 cost time: 1.6310958862304688
Epoch: 53, Steps: 52 | Train Loss: 0.4067137 Vali Loss: 1.3022138 Test Loss: 0.3663850
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 54 cost time: 1.6107673645019531
Epoch: 54, Steps: 52 | Train Loss: 0.4052357 Vali Loss: 1.3112106 Test Loss: 0.3664539
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 55 cost time: 1.6270473003387451
Epoch: 55, Steps: 52 | Train Loss: 0.4051065 Vali Loss: 1.2991774 Test Loss: 0.3668343
Validation loss decreased (1.300162 --> 1.299177).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 56 cost time: 1.6324450969696045
Epoch: 56, Steps: 52 | Train Loss: 0.4055365 Vali Loss: 1.3104587 Test Loss: 0.3669468
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 57 cost time: 1.6123356819152832
Epoch: 57, Steps: 52 | Train Loss: 0.4058081 Vali Loss: 1.3052371 Test Loss: 0.3658908
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 58 cost time: 1.6260018348693848
Epoch: 58, Steps: 52 | Train Loss: 0.4058171 Vali Loss: 1.2980101 Test Loss: 0.3657598
Validation loss decreased (1.299177 --> 1.298010).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 59 cost time: 1.6366221904754639
Epoch: 59, Steps: 52 | Train Loss: 0.4058377 Vali Loss: 1.3002343 Test Loss: 0.3660958
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 60 cost time: 1.6143629550933838
Epoch: 60, Steps: 52 | Train Loss: 0.4067801 Vali Loss: 1.3080033 Test Loss: 0.3661225
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36575984954833984, mae:0.41451939940452576, rse:0.4954579472541809
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.057109832763671875 GB
Epoch: 1 cost time: 2.139467716217041
Epoch: 1, Steps: 52 | Train Loss: 0.6993318 Vali Loss: 2.1565905 Test Loss: 1.3970057
Validation loss decreased (inf --> 2.156590).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 2 cost time: 0.8037722110748291
Epoch: 2, Steps: 52 | Train Loss: 0.5952652 Vali Loss: 1.5518484 Test Loss: 0.6463054
Validation loss decreased (2.156590 --> 1.551848).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 3 cost time: 0.7594242095947266
Epoch: 3, Steps: 52 | Train Loss: 0.4715138 Vali Loss: 1.4063421 Test Loss: 0.4285565
Validation loss decreased (1.551848 --> 1.406342).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 4 cost time: 0.7530145645141602
Epoch: 4, Steps: 52 | Train Loss: 0.4443266 Vali Loss: 1.3852758 Test Loss: 0.4037507
Validation loss decreased (1.406342 --> 1.385276).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 5 cost time: 0.7616622447967529
Epoch: 5, Steps: 52 | Train Loss: 0.4338118 Vali Loss: 1.3712360 Test Loss: 0.3918904
Validation loss decreased (1.385276 --> 1.371236).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 6 cost time: 1.6665711402893066
Epoch: 6, Steps: 52 | Train Loss: 0.4263113 Vali Loss: 1.3640985 Test Loss: 0.3825784
Validation loss decreased (1.371236 --> 1.364099).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 7 cost time: 1.668060541152954
Epoch: 7, Steps: 52 | Train Loss: 0.4238653 Vali Loss: 1.3438523 Test Loss: 0.3772360
Validation loss decreased (1.364099 --> 1.343852).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 8 cost time: 1.6692724227905273
Epoch: 8, Steps: 52 | Train Loss: 0.4202362 Vali Loss: 1.3441219 Test Loss: 0.3734844
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 9 cost time: 1.6867361068725586
Epoch: 9, Steps: 52 | Train Loss: 0.4180813 Vali Loss: 1.3360718 Test Loss: 0.3708044
Validation loss decreased (1.343852 --> 1.336072).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 10 cost time: 1.6642529964447021
Epoch: 10, Steps: 52 | Train Loss: 0.4149579 Vali Loss: 1.3202021 Test Loss: 0.3684295
Validation loss decreased (1.336072 --> 1.320202).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 11 cost time: 1.6685316562652588
Epoch: 11, Steps: 52 | Train Loss: 0.4155190 Vali Loss: 1.3231699 Test Loss: 0.3679142
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 12 cost time: 1.668550968170166
Epoch: 12, Steps: 52 | Train Loss: 0.4138209 Vali Loss: 1.3216656 Test Loss: 0.3660343
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 13 cost time: 1.6693446636199951
Epoch: 13, Steps: 52 | Train Loss: 0.4108876 Vali Loss: 1.3195536 Test Loss: 0.3668623
Validation loss decreased (1.320202 --> 1.319554).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 14 cost time: 1.6678102016448975
Epoch: 14, Steps: 52 | Train Loss: 0.4103678 Vali Loss: 1.3224328 Test Loss: 0.3657564
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 15 cost time: 1.675666332244873
Epoch: 15, Steps: 52 | Train Loss: 0.4099159 Vali Loss: 1.3111546 Test Loss: 0.3655295
Validation loss decreased (1.319554 --> 1.311155).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 16 cost time: 1.6688494682312012
Epoch: 16, Steps: 52 | Train Loss: 0.4092350 Vali Loss: 1.3112242 Test Loss: 0.3657219
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 17 cost time: 1.6892526149749756
Epoch: 17, Steps: 52 | Train Loss: 0.4080191 Vali Loss: 1.3163956 Test Loss: 0.3649106
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 18 cost time: 1.6600914001464844
Epoch: 18, Steps: 52 | Train Loss: 0.4090828 Vali Loss: 1.3056676 Test Loss: 0.3644608
Validation loss decreased (1.311155 --> 1.305668).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 19 cost time: 1.690345048904419
Epoch: 19, Steps: 52 | Train Loss: 0.4069442 Vali Loss: 1.3032784 Test Loss: 0.3649687
Validation loss decreased (1.305668 --> 1.303278).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 20 cost time: 1.6590089797973633
Epoch: 20, Steps: 52 | Train Loss: 0.4066570 Vali Loss: 1.3132825 Test Loss: 0.3647965
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 21 cost time: 1.6697702407836914
Epoch: 21, Steps: 52 | Train Loss: 0.4067713 Vali Loss: 1.3044590 Test Loss: 0.3648108
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 22 cost time: 1.674854040145874
Epoch: 22, Steps: 52 | Train Loss: 0.4081523 Vali Loss: 1.3077366 Test Loss: 0.3643366
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 23 cost time: 1.6732237339019775
Epoch: 23, Steps: 52 | Train Loss: 0.4054327 Vali Loss: 1.3097579 Test Loss: 0.3641918
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 24 cost time: 1.673532247543335
Epoch: 24, Steps: 52 | Train Loss: 0.4049936 Vali Loss: 1.3105385 Test Loss: 0.3650565
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 25 cost time: 1.6674885749816895
Epoch: 25, Steps: 52 | Train Loss: 0.4088399 Vali Loss: 1.3081372 Test Loss: 0.3654518
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 26 cost time: 1.6736981868743896
Epoch: 26, Steps: 52 | Train Loss: 0.4045285 Vali Loss: 1.3084702 Test Loss: 0.3642207
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 27 cost time: 1.669602632522583
Epoch: 27, Steps: 52 | Train Loss: 0.4056782 Vali Loss: 1.3072588 Test Loss: 0.3643463
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 28 cost time: 1.6700117588043213
Epoch: 28, Steps: 52 | Train Loss: 0.4031583 Vali Loss: 1.3116074 Test Loss: 0.3647256
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 29 cost time: 1.6694531440734863
Epoch: 29, Steps: 52 | Train Loss: 0.4067708 Vali Loss: 1.3117756 Test Loss: 0.3643221
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 30 cost time: 1.6718778610229492
Epoch: 30, Steps: 52 | Train Loss: 0.4055326 Vali Loss: 1.3080399 Test Loss: 0.3647636
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 31 cost time: 1.6640260219573975
Epoch: 31, Steps: 52 | Train Loss: 0.4050357 Vali Loss: 1.3098729 Test Loss: 0.3649147
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 32 cost time: 1.667811632156372
Epoch: 32, Steps: 52 | Train Loss: 0.4033506 Vali Loss: 1.3030102 Test Loss: 0.3642771
Validation loss decreased (1.303278 --> 1.303010).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 33 cost time: 1.6688649654388428
Epoch: 33, Steps: 52 | Train Loss: 0.4060240 Vali Loss: 1.3080692 Test Loss: 0.3641159
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 34 cost time: 1.6732745170593262
Epoch: 34, Steps: 52 | Train Loss: 0.4057983 Vali Loss: 1.3081243 Test Loss: 0.3642778
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 35 cost time: 1.670102834701538
Epoch: 35, Steps: 52 | Train Loss: 0.4045536 Vali Loss: 1.3068266 Test Loss: 0.3641989
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 36 cost time: 1.6771764755249023
Epoch: 36, Steps: 52 | Train Loss: 0.4033899 Vali Loss: 1.3008270 Test Loss: 0.3647113
Validation loss decreased (1.303010 --> 1.300827).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 37 cost time: 1.6696794033050537
Epoch: 37, Steps: 52 | Train Loss: 0.4049843 Vali Loss: 1.3023401 Test Loss: 0.3645063
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 38 cost time: 1.6799991130828857
Epoch: 38, Steps: 52 | Train Loss: 0.4047820 Vali Loss: 1.3012159 Test Loss: 0.3648425
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 39 cost time: 1.6706819534301758
Epoch: 39, Steps: 52 | Train Loss: 0.4034387 Vali Loss: 1.3065625 Test Loss: 0.3646871
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 40 cost time: 1.675987720489502
Epoch: 40, Steps: 52 | Train Loss: 0.4052408 Vali Loss: 1.3070111 Test Loss: 0.3647007
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 41 cost time: 1.664466381072998
Epoch: 41, Steps: 52 | Train Loss: 0.4042185 Vali Loss: 1.2964628 Test Loss: 0.3643887
Validation loss decreased (1.300827 --> 1.296463).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 42 cost time: 1.6767578125
Epoch: 42, Steps: 52 | Train Loss: 0.4046653 Vali Loss: 1.3027453 Test Loss: 0.3647611
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 43 cost time: 1.6658973693847656
Epoch: 43, Steps: 52 | Train Loss: 0.4033740 Vali Loss: 1.3100200 Test Loss: 0.3645068
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 44 cost time: 1.6835639476776123
Epoch: 44, Steps: 52 | Train Loss: 0.4047072 Vali Loss: 1.3069286 Test Loss: 0.3643770
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 45 cost time: 1.663503885269165
Epoch: 45, Steps: 52 | Train Loss: 0.4034705 Vali Loss: 1.3104625 Test Loss: 0.3646328
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 46 cost time: 1.687544822692871
Epoch: 46, Steps: 52 | Train Loss: 0.4034894 Vali Loss: 1.3085165 Test Loss: 0.3646653
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 47 cost time: 1.662034273147583
Epoch: 47, Steps: 52 | Train Loss: 0.4047114 Vali Loss: 1.3089992 Test Loss: 0.3643543
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 48 cost time: 1.6812832355499268
Epoch: 48, Steps: 52 | Train Loss: 0.4063946 Vali Loss: 1.3109578 Test Loss: 0.3643132
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 49 cost time: 1.669525146484375
Epoch: 49, Steps: 52 | Train Loss: 0.4046431 Vali Loss: 1.3064735 Test Loss: 0.3653935
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 50 cost time: 1.6811974048614502
Epoch: 50, Steps: 52 | Train Loss: 0.4048911 Vali Loss: 1.3056180 Test Loss: 0.3636789
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 51 cost time: 1.6570746898651123
Epoch: 51, Steps: 52 | Train Loss: 0.4045188 Vali Loss: 1.3051221 Test Loss: 0.3644329
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 52 cost time: 1.6885926723480225
Epoch: 52, Steps: 52 | Train Loss: 0.4047792 Vali Loss: 1.3057137 Test Loss: 0.3640978
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 53 cost time: 1.6584887504577637
Epoch: 53, Steps: 52 | Train Loss: 0.4028822 Vali Loss: 1.3034081 Test Loss: 0.3639947
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 54 cost time: 1.6737937927246094
Epoch: 54, Steps: 52 | Train Loss: 0.4040262 Vali Loss: 1.3086677 Test Loss: 0.3639946
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 55 cost time: 1.6605043411254883
Epoch: 55, Steps: 52 | Train Loss: 0.4049675 Vali Loss: 1.3057308 Test Loss: 0.3645290
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 56 cost time: 1.670306921005249
Epoch: 56, Steps: 52 | Train Loss: 0.4043255 Vali Loss: 1.3013620 Test Loss: 0.3637924
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 57 cost time: 1.6656231880187988
Epoch: 57, Steps: 52 | Train Loss: 0.4042868 Vali Loss: 1.3045444 Test Loss: 0.3636391
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 58 cost time: 1.6735594272613525
Epoch: 58, Steps: 52 | Train Loss: 0.4030563 Vali Loss: 1.3054662 Test Loss: 0.3641390
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 59 cost time: 1.6693658828735352
Epoch: 59, Steps: 52 | Train Loss: 0.4041864 Vali Loss: 1.3036211 Test Loss: 0.3641115
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 60 cost time: 1.671086311340332
Epoch: 60, Steps: 52 | Train Loss: 0.4032790 Vali Loss: 1.3104482 Test Loss: 0.3638719
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36438870429992676, mae:0.4127611815929413, rse:0.4945284128189087
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.04998350143432617 GB
Epoch: 1 cost time: 2.089510679244995
Epoch: 1, Steps: 52 | Train Loss: 0.7694960 Vali Loss: 2.2130349 Test Loss: 1.4598992
Validation loss decreased (inf --> 2.213035).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 2 cost time: 0.7076177597045898
Epoch: 2, Steps: 52 | Train Loss: 0.7071495 Vali Loss: 1.9448839 Test Loss: 1.1331122
Validation loss decreased (2.213035 --> 1.944884).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 3 cost time: 0.7098119258880615
Epoch: 3, Steps: 52 | Train Loss: 0.6158898 Vali Loss: 1.7301540 Test Loss: 0.8480382
Validation loss decreased (1.944884 --> 1.730154).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 4 cost time: 0.709446907043457
Epoch: 4, Steps: 52 | Train Loss: 0.5432846 Vali Loss: 1.5688841 Test Loss: 0.6346008
Validation loss decreased (1.730154 --> 1.568884).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 5 cost time: 0.7090001106262207
Epoch: 5, Steps: 52 | Train Loss: 0.4985665 Vali Loss: 1.4925259 Test Loss: 0.5299401
Validation loss decreased (1.568884 --> 1.492526).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 6 cost time: 1.297234296798706
Epoch: 6, Steps: 52 | Train Loss: 0.4760313 Vali Loss: 1.4487168 Test Loss: 0.4801726
Validation loss decreased (1.492526 --> 1.448717).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 7 cost time: 1.577929973602295
Epoch: 7, Steps: 52 | Train Loss: 0.4629965 Vali Loss: 1.4298055 Test Loss: 0.4500539
Validation loss decreased (1.448717 --> 1.429806).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 8 cost time: 1.5814051628112793
Epoch: 8, Steps: 52 | Train Loss: 0.4547667 Vali Loss: 1.4112844 Test Loss: 0.4351830
Validation loss decreased (1.429806 --> 1.411284).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 9 cost time: 1.5842716693878174
Epoch: 9, Steps: 52 | Train Loss: 0.4485956 Vali Loss: 1.4004796 Test Loss: 0.4225264
Validation loss decreased (1.411284 --> 1.400480).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 10 cost time: 1.5806221961975098
Epoch: 10, Steps: 52 | Train Loss: 0.4464731 Vali Loss: 1.3941436 Test Loss: 0.4145256
Validation loss decreased (1.400480 --> 1.394144).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 11 cost time: 1.5832123756408691
Epoch: 11, Steps: 52 | Train Loss: 0.4407609 Vali Loss: 1.3948429 Test Loss: 0.4069588
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 12 cost time: 1.5837771892547607
Epoch: 12, Steps: 52 | Train Loss: 0.4397706 Vali Loss: 1.3868293 Test Loss: 0.4025500
Validation loss decreased (1.394144 --> 1.386829).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 13 cost time: 1.5837643146514893
Epoch: 13, Steps: 52 | Train Loss: 0.4364969 Vali Loss: 1.3752234 Test Loss: 0.3968761
Validation loss decreased (1.386829 --> 1.375223).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 14 cost time: 1.5804429054260254
Epoch: 14, Steps: 52 | Train Loss: 0.4342238 Vali Loss: 1.3737158 Test Loss: 0.3949449
Validation loss decreased (1.375223 --> 1.373716).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 15 cost time: 1.5834064483642578
Epoch: 15, Steps: 52 | Train Loss: 0.4319259 Vali Loss: 1.3761380 Test Loss: 0.3917094
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 16 cost time: 1.5834696292877197
Epoch: 16, Steps: 52 | Train Loss: 0.4305153 Vali Loss: 1.3671926 Test Loss: 0.3892989
Validation loss decreased (1.373716 --> 1.367193).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 17 cost time: 1.5805792808532715
Epoch: 17, Steps: 52 | Train Loss: 0.4298917 Vali Loss: 1.3682773 Test Loss: 0.3879173
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 18 cost time: 1.5764963626861572
Epoch: 18, Steps: 52 | Train Loss: 0.4280828 Vali Loss: 1.3663464 Test Loss: 0.3863510
Validation loss decreased (1.367193 --> 1.366346).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 19 cost time: 1.5812137126922607
Epoch: 19, Steps: 52 | Train Loss: 0.4262329 Vali Loss: 1.3612617 Test Loss: 0.3849078
Validation loss decreased (1.366346 --> 1.361262).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 20 cost time: 1.5771749019622803
Epoch: 20, Steps: 52 | Train Loss: 0.4259973 Vali Loss: 1.3540548 Test Loss: 0.3829000
Validation loss decreased (1.361262 --> 1.354055).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 21 cost time: 1.5825321674346924
Epoch: 21, Steps: 52 | Train Loss: 0.4272235 Vali Loss: 1.3565847 Test Loss: 0.3829558
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 22 cost time: 1.5803725719451904
Epoch: 22, Steps: 52 | Train Loss: 0.4263623 Vali Loss: 1.3590964 Test Loss: 0.3812625
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 23 cost time: 1.5844299793243408
Epoch: 23, Steps: 52 | Train Loss: 0.4261027 Vali Loss: 1.3502783 Test Loss: 0.3805727
Validation loss decreased (1.354055 --> 1.350278).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 24 cost time: 1.5845775604248047
Epoch: 24, Steps: 52 | Train Loss: 0.4260217 Vali Loss: 1.3566663 Test Loss: 0.3800018
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 25 cost time: 1.5840835571289062
Epoch: 25, Steps: 52 | Train Loss: 0.4252392 Vali Loss: 1.3436965 Test Loss: 0.3796465
Validation loss decreased (1.350278 --> 1.343696).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 26 cost time: 1.583420753479004
Epoch: 26, Steps: 52 | Train Loss: 0.4248332 Vali Loss: 1.3484869 Test Loss: 0.3782841
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 27 cost time: 1.584946870803833
Epoch: 27, Steps: 52 | Train Loss: 0.4235599 Vali Loss: 1.3455834 Test Loss: 0.3783342
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 28 cost time: 1.58054518699646
Epoch: 28, Steps: 52 | Train Loss: 0.4241506 Vali Loss: 1.3506405 Test Loss: 0.3776409
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 29 cost time: 1.5864477157592773
Epoch: 29, Steps: 52 | Train Loss: 0.4243740 Vali Loss: 1.3494781 Test Loss: 0.3774712
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 30 cost time: 1.584181785583496
Epoch: 30, Steps: 52 | Train Loss: 0.4209480 Vali Loss: 1.3442950 Test Loss: 0.3767737
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 31 cost time: 1.5841405391693115
Epoch: 31, Steps: 52 | Train Loss: 0.4244151 Vali Loss: 1.3427938 Test Loss: 0.3764368
Validation loss decreased (1.343696 --> 1.342794).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 32 cost time: 1.5806868076324463
Epoch: 32, Steps: 52 | Train Loss: 0.4220995 Vali Loss: 1.3473688 Test Loss: 0.3762802
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 33 cost time: 1.5884888172149658
Epoch: 33, Steps: 52 | Train Loss: 0.4217867 Vali Loss: 1.3495855 Test Loss: 0.3765228
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 34 cost time: 1.5812013149261475
Epoch: 34, Steps: 52 | Train Loss: 0.4221541 Vali Loss: 1.3484933 Test Loss: 0.3759145
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 35 cost time: 1.582287073135376
Epoch: 35, Steps: 52 | Train Loss: 0.4200277 Vali Loss: 1.3421727 Test Loss: 0.3757245
Validation loss decreased (1.342794 --> 1.342173).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 36 cost time: 1.580338716506958
Epoch: 36, Steps: 52 | Train Loss: 0.4222392 Vali Loss: 1.3468168 Test Loss: 0.3761597
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 37 cost time: 1.5857212543487549
Epoch: 37, Steps: 52 | Train Loss: 0.4203525 Vali Loss: 1.3389946 Test Loss: 0.3751646
Validation loss decreased (1.342173 --> 1.338995).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 38 cost time: 1.5848381519317627
Epoch: 38, Steps: 52 | Train Loss: 0.4222481 Vali Loss: 1.3411273 Test Loss: 0.3751094
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 39 cost time: 1.585557222366333
Epoch: 39, Steps: 52 | Train Loss: 0.4220924 Vali Loss: 1.3422747 Test Loss: 0.3753305
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 40 cost time: 1.5755035877227783
Epoch: 40, Steps: 52 | Train Loss: 0.4196801 Vali Loss: 1.3389394 Test Loss: 0.3749187
Validation loss decreased (1.338995 --> 1.338939).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 41 cost time: 1.5804152488708496
Epoch: 41, Steps: 52 | Train Loss: 0.4217283 Vali Loss: 1.3441075 Test Loss: 0.3751006
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 42 cost time: 1.5798768997192383
Epoch: 42, Steps: 52 | Train Loss: 0.4207576 Vali Loss: 1.3482579 Test Loss: 0.3751516
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 43 cost time: 1.5840973854064941
Epoch: 43, Steps: 52 | Train Loss: 0.4213937 Vali Loss: 1.3442866 Test Loss: 0.3749343
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 44 cost time: 1.5815279483795166
Epoch: 44, Steps: 52 | Train Loss: 0.4198851 Vali Loss: 1.3483713 Test Loss: 0.3749204
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 45 cost time: 1.5829391479492188
Epoch: 45, Steps: 52 | Train Loss: 0.4201309 Vali Loss: 1.3425776 Test Loss: 0.3743760
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 46 cost time: 1.5803170204162598
Epoch: 46, Steps: 52 | Train Loss: 0.4201405 Vali Loss: 1.3402288 Test Loss: 0.3743930
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 47 cost time: 1.58400297164917
Epoch: 47, Steps: 52 | Train Loss: 0.4209391 Vali Loss: 1.3429683 Test Loss: 0.3742778
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 48 cost time: 1.5814640522003174
Epoch: 48, Steps: 52 | Train Loss: 0.4198412 Vali Loss: 1.3432420 Test Loss: 0.3742732
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 49 cost time: 1.5837295055389404
Epoch: 49, Steps: 52 | Train Loss: 0.4192496 Vali Loss: 1.3461442 Test Loss: 0.3744077
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 50 cost time: 1.5824627876281738
Epoch: 50, Steps: 52 | Train Loss: 0.4199372 Vali Loss: 1.3355649 Test Loss: 0.3745014
Validation loss decreased (1.338939 --> 1.335565).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 51 cost time: 1.5809173583984375
Epoch: 51, Steps: 52 | Train Loss: 0.4223078 Vali Loss: 1.3464041 Test Loss: 0.3741273
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 52 cost time: 1.5830051898956299
Epoch: 52, Steps: 52 | Train Loss: 0.4210874 Vali Loss: 1.3391278 Test Loss: 0.3741717
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 53 cost time: 1.5828752517700195
Epoch: 53, Steps: 52 | Train Loss: 0.4202915 Vali Loss: 1.3365910 Test Loss: 0.3738412
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 54 cost time: 1.5895731449127197
Epoch: 54, Steps: 52 | Train Loss: 0.4207419 Vali Loss: 1.3316072 Test Loss: 0.3746501
Validation loss decreased (1.335565 --> 1.331607).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 55 cost time: 1.583514928817749
Epoch: 55, Steps: 52 | Train Loss: 0.4188739 Vali Loss: 1.3406892 Test Loss: 0.3739746
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 56 cost time: 1.5815215110778809
Epoch: 56, Steps: 52 | Train Loss: 0.4199847 Vali Loss: 1.3359010 Test Loss: 0.3742588
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 57 cost time: 1.5785961151123047
Epoch: 57, Steps: 52 | Train Loss: 0.4190873 Vali Loss: 1.3400266 Test Loss: 0.3748088
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 58 cost time: 1.5884664058685303
Epoch: 58, Steps: 52 | Train Loss: 0.4194424 Vali Loss: 1.3427458 Test Loss: 0.3743910
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 59 cost time: 1.5786049365997314
Epoch: 59, Steps: 52 | Train Loss: 0.4196582 Vali Loss: 1.3422512 Test Loss: 0.3740427
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 60 cost time: 1.5812363624572754
Epoch: 60, Steps: 52 | Train Loss: 0.4218166 Vali Loss: 1.3393762 Test Loss: 0.3741677
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3746500313282013, mae:0.4184342622756958, rse:0.5014431476593018
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 1 cost time: 2.1004796028137207
Epoch: 1, Steps: 52 | Train Loss: 0.7055224 Vali Loss: 2.1406631 Test Loss: 1.3813955
Validation loss decreased (inf --> 2.140663).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 2 cost time: 0.72633957862854
Epoch: 2, Steps: 52 | Train Loss: 0.6076290 Vali Loss: 1.6291031 Test Loss: 0.7636911
Validation loss decreased (2.140663 --> 1.629103).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 3 cost time: 0.7534136772155762
Epoch: 3, Steps: 52 | Train Loss: 0.4838349 Vali Loss: 1.4146186 Test Loss: 0.4358799
Validation loss decreased (1.629103 --> 1.414619).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 4 cost time: 0.7384421825408936
Epoch: 4, Steps: 52 | Train Loss: 0.4470787 Vali Loss: 1.3992565 Test Loss: 0.4147972
Validation loss decreased (1.414619 --> 1.399256).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 5 cost time: 0.7430002689361572
Epoch: 5, Steps: 52 | Train Loss: 0.4358486 Vali Loss: 1.3838241 Test Loss: 0.4011090
Validation loss decreased (1.399256 --> 1.383824).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 6 cost time: 1.5822937488555908
Epoch: 6, Steps: 52 | Train Loss: 0.4297858 Vali Loss: 1.3716111 Test Loss: 0.3927748
Validation loss decreased (1.383824 --> 1.371611).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 7 cost time: 1.6353275775909424
Epoch: 7, Steps: 52 | Train Loss: 0.4272944 Vali Loss: 1.3668754 Test Loss: 0.3870253
Validation loss decreased (1.371611 --> 1.366875).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 8 cost time: 1.6571109294891357
Epoch: 8, Steps: 52 | Train Loss: 0.4219293 Vali Loss: 1.3530897 Test Loss: 0.3818715
Validation loss decreased (1.366875 --> 1.353090).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 9 cost time: 1.6474270820617676
Epoch: 9, Steps: 52 | Train Loss: 0.4209751 Vali Loss: 1.3563291 Test Loss: 0.3779085
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 10 cost time: 1.6350531578063965
Epoch: 10, Steps: 52 | Train Loss: 0.4162687 Vali Loss: 1.3387067 Test Loss: 0.3746011
Validation loss decreased (1.353090 --> 1.338707).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 11 cost time: 1.6337394714355469
Epoch: 11, Steps: 52 | Train Loss: 0.4163727 Vali Loss: 1.3379469 Test Loss: 0.3723743
Validation loss decreased (1.338707 --> 1.337947).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 12 cost time: 1.6387333869934082
Epoch: 12, Steps: 52 | Train Loss: 0.4155419 Vali Loss: 1.3303795 Test Loss: 0.3695180
Validation loss decreased (1.337947 --> 1.330379).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 13 cost time: 1.6321158409118652
Epoch: 13, Steps: 52 | Train Loss: 0.4149414 Vali Loss: 1.3313372 Test Loss: 0.3683393
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 14 cost time: 1.6365067958831787
Epoch: 14, Steps: 52 | Train Loss: 0.4125176 Vali Loss: 1.3281361 Test Loss: 0.3669504
Validation loss decreased (1.330379 --> 1.328136).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 15 cost time: 1.6343650817871094
Epoch: 15, Steps: 52 | Train Loss: 0.4114348 Vali Loss: 1.3301218 Test Loss: 0.3658694
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 16 cost time: 1.6384506225585938
Epoch: 16, Steps: 52 | Train Loss: 0.4112805 Vali Loss: 1.3236057 Test Loss: 0.3652342
Validation loss decreased (1.328136 --> 1.323606).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 17 cost time: 1.6305875778198242
Epoch: 17, Steps: 52 | Train Loss: 0.4109558 Vali Loss: 1.3265400 Test Loss: 0.3642687
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 18 cost time: 1.6339473724365234
Epoch: 18, Steps: 52 | Train Loss: 0.4088170 Vali Loss: 1.3201778 Test Loss: 0.3635274
Validation loss decreased (1.323606 --> 1.320178).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 19 cost time: 1.6317028999328613
Epoch: 19, Steps: 52 | Train Loss: 0.4068928 Vali Loss: 1.3214824 Test Loss: 0.3627254
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 20 cost time: 1.6359078884124756
Epoch: 20, Steps: 52 | Train Loss: 0.4082684 Vali Loss: 1.3240206 Test Loss: 0.3619082
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 21 cost time: 1.6297478675842285
Epoch: 21, Steps: 52 | Train Loss: 0.4095696 Vali Loss: 1.3177739 Test Loss: 0.3621002
Validation loss decreased (1.320178 --> 1.317774).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 22 cost time: 1.6334331035614014
Epoch: 22, Steps: 52 | Train Loss: 0.4084070 Vali Loss: 1.3141840 Test Loss: 0.3617036
Validation loss decreased (1.317774 --> 1.314184).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 23 cost time: 1.6336767673492432
Epoch: 23, Steps: 52 | Train Loss: 0.4086868 Vali Loss: 1.3180674 Test Loss: 0.3613517
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 24 cost time: 1.6466171741485596
Epoch: 24, Steps: 52 | Train Loss: 0.4076824 Vali Loss: 1.3141047 Test Loss: 0.3611635
Validation loss decreased (1.314184 --> 1.314105).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 25 cost time: 1.6456453800201416
Epoch: 25, Steps: 52 | Train Loss: 0.4080664 Vali Loss: 1.3196681 Test Loss: 0.3611525
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 26 cost time: 1.649885654449463
Epoch: 26, Steps: 52 | Train Loss: 0.4078263 Vali Loss: 1.3102604 Test Loss: 0.3603132
Validation loss decreased (1.314105 --> 1.310260).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 27 cost time: 1.630772590637207
Epoch: 27, Steps: 52 | Train Loss: 0.4056298 Vali Loss: 1.3116407 Test Loss: 0.3599982
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 28 cost time: 1.6344788074493408
Epoch: 28, Steps: 52 | Train Loss: 0.4058088 Vali Loss: 1.3090541 Test Loss: 0.3607653
Validation loss decreased (1.310260 --> 1.309054).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 29 cost time: 1.6306090354919434
Epoch: 29, Steps: 52 | Train Loss: 0.4062389 Vali Loss: 1.3189312 Test Loss: 0.3599930
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 30 cost time: 1.6360220909118652
Epoch: 30, Steps: 52 | Train Loss: 0.4065648 Vali Loss: 1.3023202 Test Loss: 0.3599804
Validation loss decreased (1.309054 --> 1.302320).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 31 cost time: 1.6323020458221436
Epoch: 31, Steps: 52 | Train Loss: 0.4066913 Vali Loss: 1.3151419 Test Loss: 0.3594095
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 32 cost time: 1.6328086853027344
Epoch: 32, Steps: 52 | Train Loss: 0.4065207 Vali Loss: 1.3148290 Test Loss: 0.3599912
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 33 cost time: 1.6316518783569336
Epoch: 33, Steps: 52 | Train Loss: 0.4063727 Vali Loss: 1.3166997 Test Loss: 0.3596292
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 34 cost time: 1.6345875263214111
Epoch: 34, Steps: 52 | Train Loss: 0.4076291 Vali Loss: 1.3098831 Test Loss: 0.3596320
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 35 cost time: 1.6321580410003662
Epoch: 35, Steps: 52 | Train Loss: 0.4056917 Vali Loss: 1.3181338 Test Loss: 0.3594467
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 36 cost time: 1.6311626434326172
Epoch: 36, Steps: 52 | Train Loss: 0.4057437 Vali Loss: 1.3113816 Test Loss: 0.3594594
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 37 cost time: 1.635826587677002
Epoch: 37, Steps: 52 | Train Loss: 0.4051866 Vali Loss: 1.3130896 Test Loss: 0.3594556
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 38 cost time: 1.6408452987670898
Epoch: 38, Steps: 52 | Train Loss: 0.4068924 Vali Loss: 1.3113527 Test Loss: 0.3592324
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 39 cost time: 1.6546971797943115
Epoch: 39, Steps: 52 | Train Loss: 0.4040463 Vali Loss: 1.3130028 Test Loss: 0.3593801
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 40 cost time: 1.648573637008667
Epoch: 40, Steps: 52 | Train Loss: 0.4048472 Vali Loss: 1.3086120 Test Loss: 0.3592407
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 41 cost time: 1.6392481327056885
Epoch: 41, Steps: 52 | Train Loss: 0.4071326 Vali Loss: 1.3019266 Test Loss: 0.3588645
Validation loss decreased (1.302320 --> 1.301927).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 42 cost time: 1.6378979682922363
Epoch: 42, Steps: 52 | Train Loss: 0.4049830 Vali Loss: 1.3152106 Test Loss: 0.3593162
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 43 cost time: 1.6415867805480957
Epoch: 43, Steps: 52 | Train Loss: 0.4051577 Vali Loss: 1.3125367 Test Loss: 0.3594121
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 44 cost time: 1.6317756175994873
Epoch: 44, Steps: 52 | Train Loss: 0.4059248 Vali Loss: 1.3049632 Test Loss: 0.3594708
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 45 cost time: 1.6495623588562012
Epoch: 45, Steps: 52 | Train Loss: 0.4073514 Vali Loss: 1.3131449 Test Loss: 0.3591815
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 46 cost time: 1.6457622051239014
Epoch: 46, Steps: 52 | Train Loss: 0.4065361 Vali Loss: 1.3154581 Test Loss: 0.3593056
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 47 cost time: 1.6490662097930908
Epoch: 47, Steps: 52 | Train Loss: 0.4053825 Vali Loss: 1.3014143 Test Loss: 0.3591600
Validation loss decreased (1.301927 --> 1.301414).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 48 cost time: 1.629199743270874
Epoch: 48, Steps: 52 | Train Loss: 0.4056822 Vali Loss: 1.3099010 Test Loss: 0.3591800
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 49 cost time: 1.6466937065124512
Epoch: 49, Steps: 52 | Train Loss: 0.4050495 Vali Loss: 1.3118582 Test Loss: 0.3587795
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 50 cost time: 1.646744966506958
Epoch: 50, Steps: 52 | Train Loss: 0.4058698 Vali Loss: 1.2981781 Test Loss: 0.3590677
Validation loss decreased (1.301414 --> 1.298178).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 51 cost time: 1.6503913402557373
Epoch: 51, Steps: 52 | Train Loss: 0.4061844 Vali Loss: 1.3078908 Test Loss: 0.3590385
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 52 cost time: 1.6487226486206055
Epoch: 52, Steps: 52 | Train Loss: 0.4047581 Vali Loss: 1.3087535 Test Loss: 0.3589509
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 53 cost time: 1.6404008865356445
Epoch: 53, Steps: 52 | Train Loss: 0.4060869 Vali Loss: 1.3142736 Test Loss: 0.3590685
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 54 cost time: 1.6308915615081787
Epoch: 54, Steps: 52 | Train Loss: 0.4056697 Vali Loss: 1.3144585 Test Loss: 0.3590801
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 55 cost time: 1.643831491470337
Epoch: 55, Steps: 52 | Train Loss: 0.4064079 Vali Loss: 1.3167214 Test Loss: 0.3591561
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 56 cost time: 1.639049768447876
Epoch: 56, Steps: 52 | Train Loss: 0.4032277 Vali Loss: 1.3102006 Test Loss: 0.3594117
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 57 cost time: 1.6357948780059814
Epoch: 57, Steps: 52 | Train Loss: 0.4053345 Vali Loss: 1.3149495 Test Loss: 0.3588633
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 58 cost time: 1.6340992450714111
Epoch: 58, Steps: 52 | Train Loss: 0.4057186 Vali Loss: 1.3140314 Test Loss: 0.3592888
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 59 cost time: 1.6335229873657227
Epoch: 59, Steps: 52 | Train Loss: 0.4062052 Vali Loss: 1.3153584 Test Loss: 0.3591197
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 60 cost time: 1.6370477676391602
Epoch: 60, Steps: 52 | Train Loss: 0.4047392 Vali Loss: 1.3053083 Test Loss: 0.3590333
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3590677082538605, mae:0.40606382489204407, rse:0.49090448021888733
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05727052688598633 GB
Epoch: 1 cost time: 2.130262613296509
Epoch: 1, Steps: 52 | Train Loss: 0.6882107 Vali Loss: 2.1312840 Test Loss: 1.3724580
Validation loss decreased (inf --> 2.131284).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 2 cost time: 0.7699646949768066
Epoch: 2, Steps: 52 | Train Loss: 0.5965397 Vali Loss: 1.5734198 Test Loss: 0.6800069
Validation loss decreased (2.131284 --> 1.573420).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 3 cost time: 0.7750005722045898
Epoch: 3, Steps: 52 | Train Loss: 0.4706745 Vali Loss: 1.3922027 Test Loss: 0.4218987
Validation loss decreased (1.573420 --> 1.392203).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 4 cost time: 0.7646224498748779
Epoch: 4, Steps: 52 | Train Loss: 0.4410569 Vali Loss: 1.3868589 Test Loss: 0.4046447
Validation loss decreased (1.392203 --> 1.386859).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 5 cost time: 0.7754824161529541
Epoch: 5, Steps: 52 | Train Loss: 0.4317312 Vali Loss: 1.3663535 Test Loss: 0.3940837
Validation loss decreased (1.386859 --> 1.366354).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 6 cost time: 1.6794493198394775
Epoch: 6, Steps: 52 | Train Loss: 0.4256949 Vali Loss: 1.3529769 Test Loss: 0.3852684
Validation loss decreased (1.366354 --> 1.352977).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 7 cost time: 1.6868090629577637
Epoch: 7, Steps: 52 | Train Loss: 0.4220325 Vali Loss: 1.3549557 Test Loss: 0.3821602
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 8 cost time: 1.6896731853485107
Epoch: 8, Steps: 52 | Train Loss: 0.4207332 Vali Loss: 1.3375760 Test Loss: 0.3772868
Validation loss decreased (1.352977 --> 1.337576).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 9 cost time: 1.7064616680145264
Epoch: 9, Steps: 52 | Train Loss: 0.4181134 Vali Loss: 1.3377535 Test Loss: 0.3743769
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 10 cost time: 1.6957614421844482
Epoch: 10, Steps: 52 | Train Loss: 0.4156668 Vali Loss: 1.3168740 Test Loss: 0.3728561
Validation loss decreased (1.337576 --> 1.316874).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 11 cost time: 1.691469430923462
Epoch: 11, Steps: 52 | Train Loss: 0.4147873 Vali Loss: 1.3240392 Test Loss: 0.3704427
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 12 cost time: 1.6941184997558594
Epoch: 12, Steps: 52 | Train Loss: 0.4130743 Vali Loss: 1.3183281 Test Loss: 0.3689633
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 13 cost time: 1.6866087913513184
Epoch: 13, Steps: 52 | Train Loss: 0.4119663 Vali Loss: 1.3196045 Test Loss: 0.3678720
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 14 cost time: 1.7100987434387207
Epoch: 14, Steps: 52 | Train Loss: 0.4103357 Vali Loss: 1.3243377 Test Loss: 0.3666157
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 15 cost time: 1.6874380111694336
Epoch: 15, Steps: 52 | Train Loss: 0.4104208 Vali Loss: 1.3220420 Test Loss: 0.3656665
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 16 cost time: 1.697129726409912
Epoch: 16, Steps: 52 | Train Loss: 0.4097091 Vali Loss: 1.3128024 Test Loss: 0.3657877
Validation loss decreased (1.316874 --> 1.312802).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 17 cost time: 1.6884191036224365
Epoch: 17, Steps: 52 | Train Loss: 0.4090878 Vali Loss: 1.3166739 Test Loss: 0.3647576
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 18 cost time: 1.707423448562622
Epoch: 18, Steps: 52 | Train Loss: 0.4082710 Vali Loss: 1.3151076 Test Loss: 0.3645549
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 19 cost time: 1.6843407154083252
Epoch: 19, Steps: 52 | Train Loss: 0.4077443 Vali Loss: 1.3153342 Test Loss: 0.3642808
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 20 cost time: 1.708202838897705
Epoch: 20, Steps: 52 | Train Loss: 0.4081984 Vali Loss: 1.3042850 Test Loss: 0.3630632
Validation loss decreased (1.312802 --> 1.304285).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 21 cost time: 1.6839685440063477
Epoch: 21, Steps: 52 | Train Loss: 0.4061541 Vali Loss: 1.3104413 Test Loss: 0.3632778
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 22 cost time: 1.7154676914215088
Epoch: 22, Steps: 52 | Train Loss: 0.4069822 Vali Loss: 1.3089924 Test Loss: 0.3628535
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 23 cost time: 1.6881062984466553
Epoch: 23, Steps: 52 | Train Loss: 0.4063682 Vali Loss: 1.3061318 Test Loss: 0.3627657
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 24 cost time: 1.6946609020233154
Epoch: 24, Steps: 52 | Train Loss: 0.4072931 Vali Loss: 1.3114132 Test Loss: 0.3629692
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 25 cost time: 1.686171293258667
Epoch: 25, Steps: 52 | Train Loss: 0.4060152 Vali Loss: 1.2996908 Test Loss: 0.3621181
Validation loss decreased (1.304285 --> 1.299691).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 26 cost time: 1.7150838375091553
Epoch: 26, Steps: 52 | Train Loss: 0.4051521 Vali Loss: 1.3112400 Test Loss: 0.3625629
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 27 cost time: 1.6834585666656494
Epoch: 27, Steps: 52 | Train Loss: 0.4061542 Vali Loss: 1.2992439 Test Loss: 0.3619726
Validation loss decreased (1.299691 --> 1.299244).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 28 cost time: 1.6959991455078125
Epoch: 28, Steps: 52 | Train Loss: 0.4065328 Vali Loss: 1.3100843 Test Loss: 0.3619710
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 29 cost time: 1.6844284534454346
Epoch: 29, Steps: 52 | Train Loss: 0.4060254 Vali Loss: 1.3108575 Test Loss: 0.3619785
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 30 cost time: 1.6981637477874756
Epoch: 30, Steps: 52 | Train Loss: 0.4073025 Vali Loss: 1.3094240 Test Loss: 0.3622885
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 31 cost time: 1.6817631721496582
Epoch: 31, Steps: 52 | Train Loss: 0.4053919 Vali Loss: 1.3086286 Test Loss: 0.3618604
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 32 cost time: 1.6929481029510498
Epoch: 32, Steps: 52 | Train Loss: 0.4051760 Vali Loss: 1.3086224 Test Loss: 0.3616205
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 33 cost time: 1.6839759349822998
Epoch: 33, Steps: 52 | Train Loss: 0.4062788 Vali Loss: 1.3016391 Test Loss: 0.3620257
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 34 cost time: 1.710247278213501
Epoch: 34, Steps: 52 | Train Loss: 0.4061686 Vali Loss: 1.3014214 Test Loss: 0.3615636
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 35 cost time: 1.6890909671783447
Epoch: 35, Steps: 52 | Train Loss: 0.4054560 Vali Loss: 1.3033719 Test Loss: 0.3614377
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 36 cost time: 1.7111449241638184
Epoch: 36, Steps: 52 | Train Loss: 0.4045986 Vali Loss: 1.3101676 Test Loss: 0.3615150
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 37 cost time: 1.691774845123291
Epoch: 37, Steps: 52 | Train Loss: 0.4036366 Vali Loss: 1.3067033 Test Loss: 0.3618532
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 38 cost time: 1.6922838687896729
Epoch: 38, Steps: 52 | Train Loss: 0.4046935 Vali Loss: 1.3044829 Test Loss: 0.3614062
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 39 cost time: 1.6887257099151611
Epoch: 39, Steps: 52 | Train Loss: 0.4045079 Vali Loss: 1.3108286 Test Loss: 0.3612126
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 40 cost time: 1.7142608165740967
Epoch: 40, Steps: 52 | Train Loss: 0.4047365 Vali Loss: 1.3103611 Test Loss: 0.3613515
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 41 cost time: 1.6848804950714111
Epoch: 41, Steps: 52 | Train Loss: 0.4043500 Vali Loss: 1.2988142 Test Loss: 0.3611929
Validation loss decreased (1.299244 --> 1.298814).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 42 cost time: 1.690063714981079
Epoch: 42, Steps: 52 | Train Loss: 0.4052730 Vali Loss: 1.3007284 Test Loss: 0.3615609
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 43 cost time: 1.6976683139801025
Epoch: 43, Steps: 52 | Train Loss: 0.4050824 Vali Loss: 1.3093135 Test Loss: 0.3613988
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 44 cost time: 1.6925816535949707
Epoch: 44, Steps: 52 | Train Loss: 0.4052397 Vali Loss: 1.3029504 Test Loss: 0.3611255
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 45 cost time: 1.6906485557556152
Epoch: 45, Steps: 52 | Train Loss: 0.4044630 Vali Loss: 1.3094755 Test Loss: 0.3610647
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 46 cost time: 1.6951382160186768
Epoch: 46, Steps: 52 | Train Loss: 0.4054477 Vali Loss: 1.3095967 Test Loss: 0.3612181
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 47 cost time: 1.6866528987884521
Epoch: 47, Steps: 52 | Train Loss: 0.4025383 Vali Loss: 1.3059583 Test Loss: 0.3612854
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 48 cost time: 1.6908514499664307
Epoch: 48, Steps: 52 | Train Loss: 0.4030778 Vali Loss: 1.3096724 Test Loss: 0.3612971
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 49 cost time: 1.6884355545043945
Epoch: 49, Steps: 52 | Train Loss: 0.4026219 Vali Loss: 1.3045815 Test Loss: 0.3607465
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 50 cost time: 1.688436508178711
Epoch: 50, Steps: 52 | Train Loss: 0.4053259 Vali Loss: 1.2999414 Test Loss: 0.3609337
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 51 cost time: 1.6860554218292236
Epoch: 51, Steps: 52 | Train Loss: 0.4049843 Vali Loss: 1.3051016 Test Loss: 0.3611484
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 52 cost time: 1.6955108642578125
Epoch: 52, Steps: 52 | Train Loss: 0.4057124 Vali Loss: 1.3034089 Test Loss: 0.3607169
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 53 cost time: 1.6847057342529297
Epoch: 53, Steps: 52 | Train Loss: 0.4038891 Vali Loss: 1.3112670 Test Loss: 0.3609368
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 54 cost time: 1.7006826400756836
Epoch: 54, Steps: 52 | Train Loss: 0.4056891 Vali Loss: 1.3034651 Test Loss: 0.3613594
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 55 cost time: 1.683349609375
Epoch: 55, Steps: 52 | Train Loss: 0.4041518 Vali Loss: 1.3065896 Test Loss: 0.3613383
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 56 cost time: 1.706392765045166
Epoch: 56, Steps: 52 | Train Loss: 0.4051284 Vali Loss: 1.2974585 Test Loss: 0.3609053
Validation loss decreased (1.298814 --> 1.297459).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 57 cost time: 1.6864533424377441
Epoch: 57, Steps: 52 | Train Loss: 0.4051646 Vali Loss: 1.3080389 Test Loss: 0.3610536
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 58 cost time: 1.698521614074707
Epoch: 58, Steps: 52 | Train Loss: 0.4046791 Vali Loss: 1.2989926 Test Loss: 0.3611773
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 59 cost time: 1.6833469867706299
Epoch: 59, Steps: 52 | Train Loss: 0.4050491 Vali Loss: 1.3031290 Test Loss: 0.3611827
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 60 cost time: 1.7168920040130615
Epoch: 60, Steps: 52 | Train Loss: 0.4034668 Vali Loss: 1.3026910 Test Loss: 0.3610047
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.360905259847641, mae:0.40983903408050537, rse:0.492158979177475
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.05014467239379883 GB
Epoch: 1 cost time: 2.1004481315612793
Epoch: 1, Steps: 52 | Train Loss: 0.7519140 Vali Loss: 2.1927462 Test Loss: 1.4219294
Validation loss decreased (inf --> 2.192746).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 2 cost time: 0.7240002155303955
Epoch: 2, Steps: 52 | Train Loss: 0.6966640 Vali Loss: 1.9074118 Test Loss: 1.1143823
Validation loss decreased (2.192746 --> 1.907412).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 3 cost time: 0.7283661365509033
Epoch: 3, Steps: 52 | Train Loss: 0.6069737 Vali Loss: 1.7058110 Test Loss: 0.8534293
Validation loss decreased (1.907412 --> 1.705811).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 4 cost time: 0.727747917175293
Epoch: 4, Steps: 52 | Train Loss: 0.5414089 Vali Loss: 1.5685121 Test Loss: 0.6656017
Validation loss decreased (1.705811 --> 1.568512).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 5 cost time: 0.7263932228088379
Epoch: 5, Steps: 52 | Train Loss: 0.5010913 Vali Loss: 1.5017523 Test Loss: 0.5660143
Validation loss decreased (1.568512 --> 1.501752).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 6 cost time: 1.4694969654083252
Epoch: 6, Steps: 52 | Train Loss: 0.4758405 Vali Loss: 1.4583488 Test Loss: 0.5099332
Validation loss decreased (1.501752 --> 1.458349).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 7 cost time: 1.603529930114746
Epoch: 7, Steps: 52 | Train Loss: 0.4622706 Vali Loss: 1.4345222 Test Loss: 0.4766991
Validation loss decreased (1.458349 --> 1.434522).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 8 cost time: 1.6023645401000977
Epoch: 8, Steps: 52 | Train Loss: 0.4524037 Vali Loss: 1.4097230 Test Loss: 0.4546167
Validation loss decreased (1.434522 --> 1.409723).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 9 cost time: 1.601151704788208
Epoch: 9, Steps: 52 | Train Loss: 0.4453216 Vali Loss: 1.4055576 Test Loss: 0.4386536
Validation loss decreased (1.409723 --> 1.405558).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 10 cost time: 1.6166815757751465
Epoch: 10, Steps: 52 | Train Loss: 0.4411015 Vali Loss: 1.3896551 Test Loss: 0.4281023
Validation loss decreased (1.405558 --> 1.389655).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 11 cost time: 1.6113464832305908
Epoch: 11, Steps: 52 | Train Loss: 0.4363306 Vali Loss: 1.3843999 Test Loss: 0.4209510
Validation loss decreased (1.389655 --> 1.384400).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 12 cost time: 1.6030073165893555
Epoch: 12, Steps: 52 | Train Loss: 0.4345419 Vali Loss: 1.3777058 Test Loss: 0.4147658
Validation loss decreased (1.384400 --> 1.377706).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 13 cost time: 1.6092946529388428
Epoch: 13, Steps: 52 | Train Loss: 0.4348414 Vali Loss: 1.3700190 Test Loss: 0.4092631
Validation loss decreased (1.377706 --> 1.370019).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 14 cost time: 1.606656789779663
Epoch: 14, Steps: 52 | Train Loss: 0.4311724 Vali Loss: 1.3729882 Test Loss: 0.4055445
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 15 cost time: 1.6084959506988525
Epoch: 15, Steps: 52 | Train Loss: 0.4305588 Vali Loss: 1.3647183 Test Loss: 0.4024301
Validation loss decreased (1.370019 --> 1.364718).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 16 cost time: 1.603522777557373
Epoch: 16, Steps: 52 | Train Loss: 0.4276767 Vali Loss: 1.3469744 Test Loss: 0.4002044
Validation loss decreased (1.364718 --> 1.346974).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 17 cost time: 1.6071574687957764
Epoch: 17, Steps: 52 | Train Loss: 0.4270762 Vali Loss: 1.3557053 Test Loss: 0.3977368
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 18 cost time: 1.6038033962249756
Epoch: 18, Steps: 52 | Train Loss: 0.4271148 Vali Loss: 1.3602498 Test Loss: 0.3968484
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 19 cost time: 1.6092784404754639
Epoch: 19, Steps: 52 | Train Loss: 0.4249538 Vali Loss: 1.3481447 Test Loss: 0.3941478
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 20 cost time: 1.60394287109375
Epoch: 20, Steps: 52 | Train Loss: 0.4246264 Vali Loss: 1.3525147 Test Loss: 0.3935357
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 21 cost time: 1.60646390914917
Epoch: 21, Steps: 52 | Train Loss: 0.4222135 Vali Loss: 1.3465710 Test Loss: 0.3919761
Validation loss decreased (1.346974 --> 1.346571).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 22 cost time: 1.6024394035339355
Epoch: 22, Steps: 52 | Train Loss: 0.4229975 Vali Loss: 1.3432151 Test Loss: 0.3913242
Validation loss decreased (1.346571 --> 1.343215).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 23 cost time: 1.6068496704101562
Epoch: 23, Steps: 52 | Train Loss: 0.4208547 Vali Loss: 1.3372848 Test Loss: 0.3903359
Validation loss decreased (1.343215 --> 1.337285).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 24 cost time: 1.6069562435150146
Epoch: 24, Steps: 52 | Train Loss: 0.4213175 Vali Loss: 1.3505721 Test Loss: 0.3886827
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 25 cost time: 1.6094086170196533
Epoch: 25, Steps: 52 | Train Loss: 0.4201992 Vali Loss: 1.3493190 Test Loss: 0.3881752
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 26 cost time: 1.6036961078643799
Epoch: 26, Steps: 52 | Train Loss: 0.4203447 Vali Loss: 1.3428068 Test Loss: 0.3876453
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 27 cost time: 1.6066339015960693
Epoch: 27, Steps: 52 | Train Loss: 0.4218189 Vali Loss: 1.3443016 Test Loss: 0.3864951
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 28 cost time: 1.6020452976226807
Epoch: 28, Steps: 52 | Train Loss: 0.4209703 Vali Loss: 1.3267426 Test Loss: 0.3865257
Validation loss decreased (1.337285 --> 1.326743).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 29 cost time: 1.6054418087005615
Epoch: 29, Steps: 52 | Train Loss: 0.4202664 Vali Loss: 1.3409439 Test Loss: 0.3859026
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 30 cost time: 1.6020097732543945
Epoch: 30, Steps: 52 | Train Loss: 0.4185091 Vali Loss: 1.3389673 Test Loss: 0.3856468
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 31 cost time: 1.6068243980407715
Epoch: 31, Steps: 52 | Train Loss: 0.4192691 Vali Loss: 1.3412403 Test Loss: 0.3853500
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 32 cost time: 1.6033258438110352
Epoch: 32, Steps: 52 | Train Loss: 0.4195702 Vali Loss: 1.3415480 Test Loss: 0.3848106
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 33 cost time: 1.6098823547363281
Epoch: 33, Steps: 52 | Train Loss: 0.4170856 Vali Loss: 1.3453838 Test Loss: 0.3841575
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 34 cost time: 1.6033759117126465
Epoch: 34, Steps: 52 | Train Loss: 0.4184692 Vali Loss: 1.3420216 Test Loss: 0.3842460
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 35 cost time: 1.609839916229248
Epoch: 35, Steps: 52 | Train Loss: 0.4181251 Vali Loss: 1.3424053 Test Loss: 0.3836508
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 36 cost time: 1.6063714027404785
Epoch: 36, Steps: 52 | Train Loss: 0.4178638 Vali Loss: 1.3337805 Test Loss: 0.3835661
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 37 cost time: 1.6071267127990723
Epoch: 37, Steps: 52 | Train Loss: 0.4197887 Vali Loss: 1.3429513 Test Loss: 0.3840786
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 38 cost time: 1.6053907871246338
Epoch: 38, Steps: 52 | Train Loss: 0.4195462 Vali Loss: 1.3403561 Test Loss: 0.3834295
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 39 cost time: 1.605677604675293
Epoch: 39, Steps: 52 | Train Loss: 0.4164536 Vali Loss: 1.3327231 Test Loss: 0.3828862
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 40 cost time: 1.6024370193481445
Epoch: 40, Steps: 52 | Train Loss: 0.4179160 Vali Loss: 1.3316438 Test Loss: 0.3833647
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 41 cost time: 1.6047091484069824
Epoch: 41, Steps: 52 | Train Loss: 0.4176966 Vali Loss: 1.3359954 Test Loss: 0.3831944
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 42 cost time: 1.6032383441925049
Epoch: 42, Steps: 52 | Train Loss: 0.4203512 Vali Loss: 1.3322880 Test Loss: 0.3828478
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 43 cost time: 1.6081819534301758
Epoch: 43, Steps: 52 | Train Loss: 0.4169074 Vali Loss: 1.3312372 Test Loss: 0.3824879
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 44 cost time: 1.606844425201416
Epoch: 44, Steps: 52 | Train Loss: 0.4174596 Vali Loss: 1.3374740 Test Loss: 0.3825002
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 45 cost time: 1.60402512550354
Epoch: 45, Steps: 52 | Train Loss: 0.4183827 Vali Loss: 1.3390349 Test Loss: 0.3825125
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 46 cost time: 1.6036911010742188
Epoch: 46, Steps: 52 | Train Loss: 0.4181514 Vali Loss: 1.3383582 Test Loss: 0.3828354
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 47 cost time: 1.606215000152588
Epoch: 47, Steps: 52 | Train Loss: 0.4180947 Vali Loss: 1.3340739 Test Loss: 0.3819386
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 48 cost time: 1.6080548763275146
Epoch: 48, Steps: 52 | Train Loss: 0.4184813 Vali Loss: 1.3383763 Test Loss: 0.3824847
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 49 cost time: 1.6070725917816162
Epoch: 49, Steps: 52 | Train Loss: 0.4159661 Vali Loss: 1.3336658 Test Loss: 0.3824297
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 50 cost time: 1.6002349853515625
Epoch: 50, Steps: 52 | Train Loss: 0.4177292 Vali Loss: 1.3356597 Test Loss: 0.3822355
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 51 cost time: 1.5991222858428955
Epoch: 51, Steps: 52 | Train Loss: 0.4176970 Vali Loss: 1.3341112 Test Loss: 0.3818153
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 52 cost time: 1.6007604598999023
Epoch: 52, Steps: 52 | Train Loss: 0.4173775 Vali Loss: 1.3358276 Test Loss: 0.3821045
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 53 cost time: 1.60457444190979
Epoch: 53, Steps: 52 | Train Loss: 0.4173758 Vali Loss: 1.3366404 Test Loss: 0.3818114
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 54 cost time: 1.602548599243164
Epoch: 54, Steps: 52 | Train Loss: 0.4179133 Vali Loss: 1.3357539 Test Loss: 0.3821743
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 55 cost time: 1.6033785343170166
Epoch: 55, Steps: 52 | Train Loss: 0.4159261 Vali Loss: 1.3386593 Test Loss: 0.3813616
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 56 cost time: 1.5994617938995361
Epoch: 56, Steps: 52 | Train Loss: 0.4162954 Vali Loss: 1.3352195 Test Loss: 0.3818422
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 57 cost time: 1.6063203811645508
Epoch: 57, Steps: 52 | Train Loss: 0.4171961 Vali Loss: 1.3376119 Test Loss: 0.3818398
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 58 cost time: 1.6055479049682617
Epoch: 58, Steps: 52 | Train Loss: 0.4163409 Vali Loss: 1.3383515 Test Loss: 0.3817493
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 59 cost time: 1.6060380935668945
Epoch: 59, Steps: 52 | Train Loss: 0.4173129 Vali Loss: 1.3351376 Test Loss: 0.3814964
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 60 cost time: 1.604402780532837
Epoch: 60, Steps: 52 | Train Loss: 0.4186084 Vali Loss: 1.3372495 Test Loss: 0.3815140
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3865257203578949, mae:0.42894718050956726, rse:0.5093284845352173
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 1 cost time: 2.0997190475463867
Epoch: 1, Steps: 52 | Train Loss: 0.6964097 Vali Loss: 2.1250873 Test Loss: 1.3608108
Validation loss decreased (inf --> 2.125087).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 2 cost time: 0.7502670288085938
Epoch: 2, Steps: 52 | Train Loss: 0.6016847 Vali Loss: 1.6006367 Test Loss: 0.7379444
Validation loss decreased (2.125087 --> 1.600637).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 3 cost time: 0.7405765056610107
Epoch: 3, Steps: 52 | Train Loss: 0.4789808 Vali Loss: 1.4051715 Test Loss: 0.4357840
Validation loss decreased (1.600637 --> 1.405172).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 4 cost time: 0.7509994506835938
Epoch: 4, Steps: 52 | Train Loss: 0.4432197 Vali Loss: 1.3934920 Test Loss: 0.4254632
Validation loss decreased (1.405172 --> 1.393492).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 5 cost time: 0.7581624984741211
Epoch: 5, Steps: 52 | Train Loss: 0.4333383 Vali Loss: 1.3854501 Test Loss: 0.4134595
Validation loss decreased (1.393492 --> 1.385450).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 6 cost time: 1.6436293125152588
Epoch: 6, Steps: 52 | Train Loss: 0.4282184 Vali Loss: 1.3762798 Test Loss: 0.4046633
Validation loss decreased (1.385450 --> 1.376280).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 7 cost time: 1.650588035583496
Epoch: 7, Steps: 52 | Train Loss: 0.4265710 Vali Loss: 1.3620869 Test Loss: 0.4000419
Validation loss decreased (1.376280 --> 1.362087).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 8 cost time: 1.6684901714324951
Epoch: 8, Steps: 52 | Train Loss: 0.4231412 Vali Loss: 1.3603160 Test Loss: 0.3936677
Validation loss decreased (1.362087 --> 1.360316).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 9 cost time: 1.6549253463745117
Epoch: 9, Steps: 52 | Train Loss: 0.4189791 Vali Loss: 1.3478858 Test Loss: 0.3890224
Validation loss decreased (1.360316 --> 1.347886).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 10 cost time: 1.6642072200775146
Epoch: 10, Steps: 52 | Train Loss: 0.4196654 Vali Loss: 1.3478167 Test Loss: 0.3858039
Validation loss decreased (1.347886 --> 1.347817).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 11 cost time: 1.6700024604797363
Epoch: 11, Steps: 52 | Train Loss: 0.4155872 Vali Loss: 1.3429967 Test Loss: 0.3823090
Validation loss decreased (1.347817 --> 1.342997).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 12 cost time: 1.662646770477295
Epoch: 12, Steps: 52 | Train Loss: 0.4150184 Vali Loss: 1.3341877 Test Loss: 0.3796790
Validation loss decreased (1.342997 --> 1.334188).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 13 cost time: 1.6500625610351562
Epoch: 13, Steps: 52 | Train Loss: 0.4138256 Vali Loss: 1.3333434 Test Loss: 0.3773528
Validation loss decreased (1.334188 --> 1.333343).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 14 cost time: 1.649010181427002
Epoch: 14, Steps: 52 | Train Loss: 0.4145879 Vali Loss: 1.3190520 Test Loss: 0.3756921
Validation loss decreased (1.333343 --> 1.319052).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 15 cost time: 1.6560602188110352
Epoch: 15, Steps: 52 | Train Loss: 0.4119545 Vali Loss: 1.3277552 Test Loss: 0.3739973
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 16 cost time: 1.6473467350006104
Epoch: 16, Steps: 52 | Train Loss: 0.4128362 Vali Loss: 1.3302996 Test Loss: 0.3735546
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 17 cost time: 1.656782627105713
Epoch: 17, Steps: 52 | Train Loss: 0.4122410 Vali Loss: 1.3228791 Test Loss: 0.3719904
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 18 cost time: 1.6495869159698486
Epoch: 18, Steps: 52 | Train Loss: 0.4112015 Vali Loss: 1.3232439 Test Loss: 0.3712527
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 19 cost time: 1.6490411758422852
Epoch: 19, Steps: 52 | Train Loss: 0.4091061 Vali Loss: 1.3255786 Test Loss: 0.3700081
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 20 cost time: 1.6456375122070312
Epoch: 20, Steps: 52 | Train Loss: 0.4110608 Vali Loss: 1.3190396 Test Loss: 0.3694384
Validation loss decreased (1.319052 --> 1.319040).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 21 cost time: 1.6476383209228516
Epoch: 21, Steps: 52 | Train Loss: 0.4109050 Vali Loss: 1.3151352 Test Loss: 0.3686496
Validation loss decreased (1.319040 --> 1.315135).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 22 cost time: 1.6450412273406982
Epoch: 22, Steps: 52 | Train Loss: 0.4087698 Vali Loss: 1.3108480 Test Loss: 0.3686839
Validation loss decreased (1.315135 --> 1.310848).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 23 cost time: 1.6511969566345215
Epoch: 23, Steps: 52 | Train Loss: 0.4103794 Vali Loss: 1.3224516 Test Loss: 0.3685996
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 24 cost time: 1.6443085670471191
Epoch: 24, Steps: 52 | Train Loss: 0.4092935 Vali Loss: 1.3163080 Test Loss: 0.3677322
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 25 cost time: 1.6462271213531494
Epoch: 25, Steps: 52 | Train Loss: 0.4094531 Vali Loss: 1.3208696 Test Loss: 0.3678386
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 26 cost time: 1.6400654315948486
Epoch: 26, Steps: 52 | Train Loss: 0.4091068 Vali Loss: 1.3139088 Test Loss: 0.3673767
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 27 cost time: 1.6485390663146973
Epoch: 27, Steps: 52 | Train Loss: 0.4092709 Vali Loss: 1.3129132 Test Loss: 0.3673435
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 28 cost time: 1.6466968059539795
Epoch: 28, Steps: 52 | Train Loss: 0.4081447 Vali Loss: 1.3116794 Test Loss: 0.3672852
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 29 cost time: 1.6487689018249512
Epoch: 29, Steps: 52 | Train Loss: 0.4104550 Vali Loss: 1.3082993 Test Loss: 0.3670637
Validation loss decreased (1.310848 --> 1.308299).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 30 cost time: 1.653794288635254
Epoch: 30, Steps: 52 | Train Loss: 0.4099366 Vali Loss: 1.3113286 Test Loss: 0.3666284
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 31 cost time: 1.6453609466552734
Epoch: 31, Steps: 52 | Train Loss: 0.4083706 Vali Loss: 1.3102698 Test Loss: 0.3662840
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 32 cost time: 1.648940086364746
Epoch: 32, Steps: 52 | Train Loss: 0.4080748 Vali Loss: 1.3167443 Test Loss: 0.3663698
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 33 cost time: 1.6452736854553223
Epoch: 33, Steps: 52 | Train Loss: 0.4085600 Vali Loss: 1.3155916 Test Loss: 0.3662965
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 34 cost time: 1.6491994857788086
Epoch: 34, Steps: 52 | Train Loss: 0.4088104 Vali Loss: 1.3067347 Test Loss: 0.3662177
Validation loss decreased (1.308299 --> 1.306735).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 35 cost time: 1.6439549922943115
Epoch: 35, Steps: 52 | Train Loss: 0.4080750 Vali Loss: 1.3116902 Test Loss: 0.3658826
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 36 cost time: 1.6476383209228516
Epoch: 36, Steps: 52 | Train Loss: 0.4086643 Vali Loss: 1.3002864 Test Loss: 0.3657703
Validation loss decreased (1.306735 --> 1.300286).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 37 cost time: 1.647998332977295
Epoch: 37, Steps: 52 | Train Loss: 0.4073211 Vali Loss: 1.3113054 Test Loss: 0.3660169
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 38 cost time: 1.648557424545288
Epoch: 38, Steps: 52 | Train Loss: 0.4057498 Vali Loss: 1.3124295 Test Loss: 0.3659534
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 39 cost time: 1.6462652683258057
Epoch: 39, Steps: 52 | Train Loss: 0.4066492 Vali Loss: 1.3137301 Test Loss: 0.3659598
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 40 cost time: 1.6472363471984863
Epoch: 40, Steps: 52 | Train Loss: 0.4060205 Vali Loss: 1.3098116 Test Loss: 0.3655114
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 41 cost time: 1.6462464332580566
Epoch: 41, Steps: 52 | Train Loss: 0.4086312 Vali Loss: 1.3112912 Test Loss: 0.3657594
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 42 cost time: 1.648918628692627
Epoch: 42, Steps: 52 | Train Loss: 0.4074272 Vali Loss: 1.3104696 Test Loss: 0.3660473
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 43 cost time: 1.642709493637085
Epoch: 43, Steps: 52 | Train Loss: 0.4052592 Vali Loss: 1.3063318 Test Loss: 0.3652371
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 44 cost time: 1.6519834995269775
Epoch: 44, Steps: 52 | Train Loss: 0.4070210 Vali Loss: 1.3137206 Test Loss: 0.3656967
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 45 cost time: 1.643056869506836
Epoch: 45, Steps: 52 | Train Loss: 0.4070034 Vali Loss: 1.3133111 Test Loss: 0.3658353
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 46 cost time: 1.6470768451690674
Epoch: 46, Steps: 52 | Train Loss: 0.4059697 Vali Loss: 1.3030143 Test Loss: 0.3657501
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 47 cost time: 1.6468265056610107
Epoch: 47, Steps: 52 | Train Loss: 0.4081371 Vali Loss: 1.3098748 Test Loss: 0.3657249
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 48 cost time: 1.6475327014923096
Epoch: 48, Steps: 52 | Train Loss: 0.4067241 Vali Loss: 1.3142446 Test Loss: 0.3656037
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 49 cost time: 1.6442680358886719
Epoch: 49, Steps: 52 | Train Loss: 0.4064832 Vali Loss: 1.3042630 Test Loss: 0.3654591
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 50 cost time: 1.645831823348999
Epoch: 50, Steps: 52 | Train Loss: 0.4064677 Vali Loss: 1.3092229 Test Loss: 0.3655096
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 51 cost time: 1.6466577053070068
Epoch: 51, Steps: 52 | Train Loss: 0.4047422 Vali Loss: 1.3065169 Test Loss: 0.3656000
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 52 cost time: 1.6494641304016113
Epoch: 52, Steps: 52 | Train Loss: 0.4059587 Vali Loss: 1.3069165 Test Loss: 0.3654757
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 53 cost time: 1.647500991821289
Epoch: 53, Steps: 52 | Train Loss: 0.4077766 Vali Loss: 1.3116260 Test Loss: 0.3654114
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 54 cost time: 1.644242525100708
Epoch: 54, Steps: 52 | Train Loss: 0.4060439 Vali Loss: 1.3087344 Test Loss: 0.3652408
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 55 cost time: 1.6553008556365967
Epoch: 55, Steps: 52 | Train Loss: 0.4052315 Vali Loss: 1.3158288 Test Loss: 0.3657092
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 56 cost time: 1.6677665710449219
Epoch: 56, Steps: 52 | Train Loss: 0.4062588 Vali Loss: 1.3069936 Test Loss: 0.3655077
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 57 cost time: 1.649731159210205
Epoch: 57, Steps: 52 | Train Loss: 0.4077176 Vali Loss: 1.3139832 Test Loss: 0.3652757
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 58 cost time: 1.6520769596099854
Epoch: 58, Steps: 52 | Train Loss: 0.4079667 Vali Loss: 1.3076468 Test Loss: 0.3654149
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 59 cost time: 1.6678292751312256
Epoch: 59, Steps: 52 | Train Loss: 0.4078019 Vali Loss: 1.3114662 Test Loss: 0.3652017
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 60 cost time: 1.6382472515106201
Epoch: 60, Steps: 52 | Train Loss: 0.4074378 Vali Loss: 1.3086816 Test Loss: 0.3654493
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36577022075653076, mae:0.4126182794570923, rse:0.4954650104045868
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.057431697845458984 GB
Epoch: 1 cost time: 2.1231884956359863
Epoch: 1, Steps: 52 | Train Loss: 0.6790563 Vali Loss: 2.0911546 Test Loss: 1.3409286
Validation loss decreased (inf --> 2.091155).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 2 cost time: 0.746999979019165
Epoch: 2, Steps: 52 | Train Loss: 0.5803232 Vali Loss: 1.5159354 Test Loss: 0.6021149
Validation loss decreased (2.091155 --> 1.515935).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 3 cost time: 0.7736155986785889
Epoch: 3, Steps: 52 | Train Loss: 0.4646442 Vali Loss: 1.4035447 Test Loss: 0.4308220
Validation loss decreased (1.515935 --> 1.403545).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 4 cost time: 0.7733767032623291
Epoch: 4, Steps: 52 | Train Loss: 0.4400664 Vali Loss: 1.3829010 Test Loss: 0.4177005
Validation loss decreased (1.403545 --> 1.382901).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 5 cost time: 0.772756814956665
Epoch: 5, Steps: 52 | Train Loss: 0.4324993 Vali Loss: 1.3761320 Test Loss: 0.4070061
Validation loss decreased (1.382901 --> 1.376132).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 6 cost time: 1.7010393142700195
Epoch: 6, Steps: 52 | Train Loss: 0.4286285 Vali Loss: 1.3698645 Test Loss: 0.3995274
Validation loss decreased (1.376132 --> 1.369864).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 7 cost time: 1.714587926864624
Epoch: 7, Steps: 52 | Train Loss: 0.4242985 Vali Loss: 1.3606777 Test Loss: 0.3938331
Validation loss decreased (1.369864 --> 1.360678).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 8 cost time: 1.7334463596343994
Epoch: 8, Steps: 52 | Train Loss: 0.4239179 Vali Loss: 1.3558261 Test Loss: 0.3897932
Validation loss decreased (1.360678 --> 1.355826).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 9 cost time: 1.7116565704345703
Epoch: 9, Steps: 52 | Train Loss: 0.4203021 Vali Loss: 1.3484972 Test Loss: 0.3856919
Validation loss decreased (1.355826 --> 1.348497).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 10 cost time: 1.7291288375854492
Epoch: 10, Steps: 52 | Train Loss: 0.4189600 Vali Loss: 1.3406026 Test Loss: 0.3818068
Validation loss decreased (1.348497 --> 1.340603).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 11 cost time: 1.700376033782959
Epoch: 11, Steps: 52 | Train Loss: 0.4177419 Vali Loss: 1.3299289 Test Loss: 0.3800299
Validation loss decreased (1.340603 --> 1.329929).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 12 cost time: 1.728400707244873
Epoch: 12, Steps: 52 | Train Loss: 0.4164851 Vali Loss: 1.3302884 Test Loss: 0.3775297
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 13 cost time: 1.7041246891021729
Epoch: 13, Steps: 52 | Train Loss: 0.4149162 Vali Loss: 1.3239167 Test Loss: 0.3757228
Validation loss decreased (1.329929 --> 1.323917).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 14 cost time: 1.7126867771148682
Epoch: 14, Steps: 52 | Train Loss: 0.4140040 Vali Loss: 1.3270830 Test Loss: 0.3738508
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 15 cost time: 1.7026584148406982
Epoch: 15, Steps: 52 | Train Loss: 0.4125218 Vali Loss: 1.3275913 Test Loss: 0.3729713
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 16 cost time: 1.7330725193023682
Epoch: 16, Steps: 52 | Train Loss: 0.4110127 Vali Loss: 1.3213637 Test Loss: 0.3714315
Validation loss decreased (1.323917 --> 1.321364).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 17 cost time: 1.703373908996582
Epoch: 17, Steps: 52 | Train Loss: 0.4107217 Vali Loss: 1.3213170 Test Loss: 0.3698811
Validation loss decreased (1.321364 --> 1.321317).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 18 cost time: 1.7284250259399414
Epoch: 18, Steps: 52 | Train Loss: 0.4096793 Vali Loss: 1.3182126 Test Loss: 0.3689952
Validation loss decreased (1.321317 --> 1.318213).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 19 cost time: 1.705371379852295
Epoch: 19, Steps: 52 | Train Loss: 0.4106491 Vali Loss: 1.3165069 Test Loss: 0.3685488
Validation loss decreased (1.318213 --> 1.316507).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 20 cost time: 1.730372667312622
Epoch: 20, Steps: 52 | Train Loss: 0.4105492 Vali Loss: 1.3123882 Test Loss: 0.3674461
Validation loss decreased (1.316507 --> 1.312388).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 21 cost time: 1.705549716949463
Epoch: 21, Steps: 52 | Train Loss: 0.4082221 Vali Loss: 1.3180139 Test Loss: 0.3674482
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 22 cost time: 1.732903242111206
Epoch: 22, Steps: 52 | Train Loss: 0.4074186 Vali Loss: 1.3124732 Test Loss: 0.3665280
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 23 cost time: 1.6985929012298584
Epoch: 23, Steps: 52 | Train Loss: 0.4070310 Vali Loss: 1.3130987 Test Loss: 0.3665961
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 24 cost time: 1.716865062713623
Epoch: 24, Steps: 52 | Train Loss: 0.4082441 Vali Loss: 1.3127661 Test Loss: 0.3663372
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 25 cost time: 1.7058162689208984
Epoch: 25, Steps: 52 | Train Loss: 0.4101787 Vali Loss: 1.3118933 Test Loss: 0.3655541
Validation loss decreased (1.312388 --> 1.311893).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 26 cost time: 1.7295091152191162
Epoch: 26, Steps: 52 | Train Loss: 0.4072935 Vali Loss: 1.3134408 Test Loss: 0.3654429
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 27 cost time: 1.7055156230926514
Epoch: 27, Steps: 52 | Train Loss: 0.4088708 Vali Loss: 1.3083045 Test Loss: 0.3657597
Validation loss decreased (1.311893 --> 1.308305).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 28 cost time: 1.7295277118682861
Epoch: 28, Steps: 52 | Train Loss: 0.4078822 Vali Loss: 1.3079846 Test Loss: 0.3650664
Validation loss decreased (1.308305 --> 1.307985).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 29 cost time: 1.7017936706542969
Epoch: 29, Steps: 52 | Train Loss: 0.4074140 Vali Loss: 1.3142997 Test Loss: 0.3651915
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 30 cost time: 1.7229835987091064
Epoch: 30, Steps: 52 | Train Loss: 0.4047499 Vali Loss: 1.3117046 Test Loss: 0.3646654
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 31 cost time: 1.6996376514434814
Epoch: 31, Steps: 52 | Train Loss: 0.4070964 Vali Loss: 1.3154966 Test Loss: 0.3644702
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 32 cost time: 1.7344701290130615
Epoch: 32, Steps: 52 | Train Loss: 0.4086292 Vali Loss: 1.3063736 Test Loss: 0.3639903
Validation loss decreased (1.307985 --> 1.306374).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 33 cost time: 1.7069294452667236
Epoch: 33, Steps: 52 | Train Loss: 0.4053158 Vali Loss: 1.3079579 Test Loss: 0.3641943
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 34 cost time: 1.7089619636535645
Epoch: 34, Steps: 52 | Train Loss: 0.4051688 Vali Loss: 1.3120898 Test Loss: 0.3639949
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 35 cost time: 1.7024509906768799
Epoch: 35, Steps: 52 | Train Loss: 0.4045845 Vali Loss: 1.3129376 Test Loss: 0.3637783
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 36 cost time: 1.7286605834960938
Epoch: 36, Steps: 52 | Train Loss: 0.4055321 Vali Loss: 1.3115473 Test Loss: 0.3640963
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 37 cost time: 1.710897445678711
Epoch: 37, Steps: 52 | Train Loss: 0.4079245 Vali Loss: 1.3022037 Test Loss: 0.3639547
Validation loss decreased (1.306374 --> 1.302204).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 38 cost time: 1.726773977279663
Epoch: 38, Steps: 52 | Train Loss: 0.4065893 Vali Loss: 1.3101072 Test Loss: 0.3639067
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 39 cost time: 1.7145919799804688
Epoch: 39, Steps: 52 | Train Loss: 0.4057830 Vali Loss: 1.3142750 Test Loss: 0.3635779
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 40 cost time: 1.7221181392669678
Epoch: 40, Steps: 52 | Train Loss: 0.4057916 Vali Loss: 1.3089950 Test Loss: 0.3636777
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 41 cost time: 1.7181322574615479
Epoch: 41, Steps: 52 | Train Loss: 0.4053393 Vali Loss: 1.3092476 Test Loss: 0.3638111
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 42 cost time: 1.7176005840301514
Epoch: 42, Steps: 52 | Train Loss: 0.4065873 Vali Loss: 1.3038716 Test Loss: 0.3634745
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 43 cost time: 1.710846185684204
Epoch: 43, Steps: 52 | Train Loss: 0.4068658 Vali Loss: 1.3126662 Test Loss: 0.3634176
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 44 cost time: 1.7218570709228516
Epoch: 44, Steps: 52 | Train Loss: 0.4062626 Vali Loss: 1.3072269 Test Loss: 0.3632543
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 45 cost time: 1.7233662605285645
Epoch: 45, Steps: 52 | Train Loss: 0.4057449 Vali Loss: 1.3128786 Test Loss: 0.3638434
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 46 cost time: 1.7067511081695557
Epoch: 46, Steps: 52 | Train Loss: 0.4070232 Vali Loss: 1.3076035 Test Loss: 0.3631272
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 47 cost time: 1.7408559322357178
Epoch: 47, Steps: 52 | Train Loss: 0.4065741 Vali Loss: 1.3031065 Test Loss: 0.3634048
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 48 cost time: 1.7121963500976562
Epoch: 48, Steps: 52 | Train Loss: 0.4066704 Vali Loss: 1.3023417 Test Loss: 0.3634908
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 49 cost time: 1.7334904670715332
Epoch: 49, Steps: 52 | Train Loss: 0.4059151 Vali Loss: 1.3068918 Test Loss: 0.3632476
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 50 cost time: 1.7420008182525635
Epoch: 50, Steps: 52 | Train Loss: 0.4049867 Vali Loss: 1.3089936 Test Loss: 0.3635154
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 51 cost time: 1.7160301208496094
Epoch: 51, Steps: 52 | Train Loss: 0.4066033 Vali Loss: 1.3069816 Test Loss: 0.3632216
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 52 cost time: 1.7349092960357666
Epoch: 52, Steps: 52 | Train Loss: 0.4060770 Vali Loss: 1.3127486 Test Loss: 0.3631542
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 53 cost time: 1.7039282321929932
Epoch: 53, Steps: 52 | Train Loss: 0.4064777 Vali Loss: 1.3042939 Test Loss: 0.3633654
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 54 cost time: 1.7191665172576904
Epoch: 54, Steps: 52 | Train Loss: 0.4064612 Vali Loss: 1.3089530 Test Loss: 0.3634450
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 55 cost time: 1.7073545455932617
Epoch: 55, Steps: 52 | Train Loss: 0.4061248 Vali Loss: 1.3073410 Test Loss: 0.3630880
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 56 cost time: 1.7284011840820312
Epoch: 56, Steps: 52 | Train Loss: 0.4072071 Vali Loss: 1.3056588 Test Loss: 0.3633246
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 57 cost time: 1.73270583152771
Epoch: 57, Steps: 52 | Train Loss: 0.4058978 Vali Loss: 1.3057408 Test Loss: 0.3633231
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 58 cost time: 1.7302167415618896
Epoch: 58, Steps: 52 | Train Loss: 0.4048197 Vali Loss: 1.3100412 Test Loss: 0.3634909
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 59 cost time: 1.7073111534118652
Epoch: 59, Steps: 52 | Train Loss: 0.4062522 Vali Loss: 1.3084817 Test Loss: 0.3632379
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 60 cost time: 1.7344310283660889
Epoch: 60, Steps: 52 | Train Loss: 0.4042690 Vali Loss: 1.3032651 Test Loss: 0.3630897
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36395463347435, mae:0.4100893437862396, rse:0.4942338168621063
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.057007789611816406 GB
Epoch: 1 cost time: 2.0897600650787354
Epoch: 1, Steps: 52 | Train Loss: 0.7716449 Vali Loss: 2.2231493 Test Loss: 1.4376607
Validation loss decreased (inf --> 2.223149).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 2 cost time: 0.6956031322479248
Epoch: 2, Steps: 52 | Train Loss: 0.7060806 Vali Loss: 1.9314470 Test Loss: 1.1153094
Validation loss decreased (2.223149 --> 1.931447).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 3 cost time: 0.6953694820404053
Epoch: 3, Steps: 52 | Train Loss: 0.6181062 Vali Loss: 1.7362865 Test Loss: 0.8756693
Validation loss decreased (1.931447 --> 1.736287).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 4 cost time: 0.693000316619873
Epoch: 4, Steps: 52 | Train Loss: 0.5558148 Vali Loss: 1.5887576 Test Loss: 0.6877140
Validation loss decreased (1.736287 --> 1.588758).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 5 cost time: 0.6995992660522461
Epoch: 5, Steps: 52 | Train Loss: 0.5139250 Vali Loss: 1.5080049 Test Loss: 0.5826890
Validation loss decreased (1.588758 --> 1.508005).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 6 cost time: 1.1391627788543701
Epoch: 6, Steps: 52 | Train Loss: 0.4903029 Vali Loss: 1.4716907 Test Loss: 0.5226167
Validation loss decreased (1.508005 --> 1.471691).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 7 cost time: 1.5334467887878418
Epoch: 7, Steps: 52 | Train Loss: 0.4735604 Vali Loss: 1.4339057 Test Loss: 0.4842333
Validation loss decreased (1.471691 --> 1.433906).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 8 cost time: 1.5290453433990479
Epoch: 8, Steps: 52 | Train Loss: 0.4646045 Vali Loss: 1.4175811 Test Loss: 0.4599885
Validation loss decreased (1.433906 --> 1.417581).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 9 cost time: 1.5470917224884033
Epoch: 9, Steps: 52 | Train Loss: 0.4538468 Vali Loss: 1.3945017 Test Loss: 0.4404356
Validation loss decreased (1.417581 --> 1.394502).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 10 cost time: 1.5262572765350342
Epoch: 10, Steps: 52 | Train Loss: 0.4511823 Vali Loss: 1.3916254 Test Loss: 0.4283811
Validation loss decreased (1.394502 --> 1.391625).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 11 cost time: 1.534372329711914
Epoch: 11, Steps: 52 | Train Loss: 0.4443549 Vali Loss: 1.3711677 Test Loss: 0.4185323
Validation loss decreased (1.391625 --> 1.371168).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 12 cost time: 1.5372111797332764
Epoch: 12, Steps: 52 | Train Loss: 0.4429952 Vali Loss: 1.3712116 Test Loss: 0.4128478
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 13 cost time: 1.542072057723999
Epoch: 13, Steps: 52 | Train Loss: 0.4394615 Vali Loss: 1.3546579 Test Loss: 0.4073538
Validation loss decreased (1.371168 --> 1.354658).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 14 cost time: 1.5277554988861084
Epoch: 14, Steps: 52 | Train Loss: 0.4372431 Vali Loss: 1.3654805 Test Loss: 0.4023999
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 15 cost time: 1.543196678161621
Epoch: 15, Steps: 52 | Train Loss: 0.4354921 Vali Loss: 1.3525581 Test Loss: 0.4015714
Validation loss decreased (1.354658 --> 1.352558).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 16 cost time: 1.5310873985290527
Epoch: 16, Steps: 52 | Train Loss: 0.4340758 Vali Loss: 1.3488873 Test Loss: 0.3977982
Validation loss decreased (1.352558 --> 1.348887).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 17 cost time: 1.5363554954528809
Epoch: 17, Steps: 52 | Train Loss: 0.4330859 Vali Loss: 1.3475751 Test Loss: 0.3949518
Validation loss decreased (1.348887 --> 1.347575).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 18 cost time: 1.5264129638671875
Epoch: 18, Steps: 52 | Train Loss: 0.4307716 Vali Loss: 1.3437550 Test Loss: 0.3934079
Validation loss decreased (1.347575 --> 1.343755).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 19 cost time: 1.5369584560394287
Epoch: 19, Steps: 52 | Train Loss: 0.4320761 Vali Loss: 1.3472662 Test Loss: 0.3909020
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 20 cost time: 1.524468183517456
Epoch: 20, Steps: 52 | Train Loss: 0.4297800 Vali Loss: 1.3359934 Test Loss: 0.3913881
Validation loss decreased (1.343755 --> 1.335993).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 21 cost time: 1.5307683944702148
Epoch: 21, Steps: 52 | Train Loss: 0.4289456 Vali Loss: 1.3462982 Test Loss: 0.3895008
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 22 cost time: 1.5387260913848877
Epoch: 22, Steps: 52 | Train Loss: 0.4291758 Vali Loss: 1.3416876 Test Loss: 0.3883441
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 23 cost time: 1.5289177894592285
Epoch: 23, Steps: 52 | Train Loss: 0.4278782 Vali Loss: 1.3353560 Test Loss: 0.3877965
Validation loss decreased (1.335993 --> 1.335356).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 24 cost time: 1.5394926071166992
Epoch: 24, Steps: 52 | Train Loss: 0.4266100 Vali Loss: 1.3430905 Test Loss: 0.3867519
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 25 cost time: 1.52742338180542
Epoch: 25, Steps: 52 | Train Loss: 0.4275579 Vali Loss: 1.3381437 Test Loss: 0.3862721
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 26 cost time: 1.5375893115997314
Epoch: 26, Steps: 52 | Train Loss: 0.4265472 Vali Loss: 1.3340166 Test Loss: 0.3855571
Validation loss decreased (1.335356 --> 1.334017).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 27 cost time: 1.5380594730377197
Epoch: 27, Steps: 52 | Train Loss: 0.4269564 Vali Loss: 1.3363904 Test Loss: 0.3852600
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 28 cost time: 1.5323262214660645
Epoch: 28, Steps: 52 | Train Loss: 0.4261671 Vali Loss: 1.3310221 Test Loss: 0.3840213
Validation loss decreased (1.334017 --> 1.331022).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 29 cost time: 1.5391275882720947
Epoch: 29, Steps: 52 | Train Loss: 0.4246327 Vali Loss: 1.3357699 Test Loss: 0.3842680
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 30 cost time: 1.528977870941162
Epoch: 30, Steps: 52 | Train Loss: 0.4250378 Vali Loss: 1.3325336 Test Loss: 0.3838856
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 31 cost time: 1.5288548469543457
Epoch: 31, Steps: 52 | Train Loss: 0.4250902 Vali Loss: 1.3317349 Test Loss: 0.3825755
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 32 cost time: 1.53352952003479
Epoch: 32, Steps: 52 | Train Loss: 0.4251640 Vali Loss: 1.3310113 Test Loss: 0.3831748
Validation loss decreased (1.331022 --> 1.331011).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 33 cost time: 1.5304219722747803
Epoch: 33, Steps: 52 | Train Loss: 0.4245815 Vali Loss: 1.3291351 Test Loss: 0.3828118
Validation loss decreased (1.331011 --> 1.329135).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 34 cost time: 1.543332576751709
Epoch: 34, Steps: 52 | Train Loss: 0.4244121 Vali Loss: 1.3365134 Test Loss: 0.3831295
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 35 cost time: 1.5415797233581543
Epoch: 35, Steps: 52 | Train Loss: 0.4245332 Vali Loss: 1.3274026 Test Loss: 0.3829387
Validation loss decreased (1.329135 --> 1.327403).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 36 cost time: 1.5356686115264893
Epoch: 36, Steps: 52 | Train Loss: 0.4246557 Vali Loss: 1.3244398 Test Loss: 0.3815998
Validation loss decreased (1.327403 --> 1.324440).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 37 cost time: 1.5373320579528809
Epoch: 37, Steps: 52 | Train Loss: 0.4235676 Vali Loss: 1.3282675 Test Loss: 0.3824065
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 38 cost time: 1.5383667945861816
Epoch: 38, Steps: 52 | Train Loss: 0.4239314 Vali Loss: 1.3229634 Test Loss: 0.3824629
Validation loss decreased (1.324440 --> 1.322963).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 39 cost time: 1.534109115600586
Epoch: 39, Steps: 52 | Train Loss: 0.4236342 Vali Loss: 1.3334768 Test Loss: 0.3819117
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 40 cost time: 1.527442216873169
Epoch: 40, Steps: 52 | Train Loss: 0.4239413 Vali Loss: 1.3224249 Test Loss: 0.3820199
Validation loss decreased (1.322963 --> 1.322425).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 41 cost time: 1.540738582611084
Epoch: 41, Steps: 52 | Train Loss: 0.4227257 Vali Loss: 1.3269070 Test Loss: 0.3818633
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 42 cost time: 1.5284833908081055
Epoch: 42, Steps: 52 | Train Loss: 0.4234581 Vali Loss: 1.3351133 Test Loss: 0.3822747
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 43 cost time: 1.5400993824005127
Epoch: 43, Steps: 52 | Train Loss: 0.4227352 Vali Loss: 1.3154082 Test Loss: 0.3817474
Validation loss decreased (1.322425 --> 1.315408).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 44 cost time: 1.539245367050171
Epoch: 44, Steps: 52 | Train Loss: 0.4244835 Vali Loss: 1.3249257 Test Loss: 0.3813021
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 45 cost time: 1.5312232971191406
Epoch: 45, Steps: 52 | Train Loss: 0.4237300 Vali Loss: 1.3254731 Test Loss: 0.3817005
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 46 cost time: 1.5395665168762207
Epoch: 46, Steps: 52 | Train Loss: 0.4209587 Vali Loss: 1.3325719 Test Loss: 0.3815466
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 47 cost time: 1.530508041381836
Epoch: 47, Steps: 52 | Train Loss: 0.4236415 Vali Loss: 1.3256360 Test Loss: 0.3808312
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 48 cost time: 1.5435373783111572
Epoch: 48, Steps: 52 | Train Loss: 0.4241892 Vali Loss: 1.3296093 Test Loss: 0.3814356
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 49 cost time: 1.5343670845031738
Epoch: 49, Steps: 52 | Train Loss: 0.4205712 Vali Loss: 1.3284070 Test Loss: 0.3813009
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 50 cost time: 1.532484769821167
Epoch: 50, Steps: 52 | Train Loss: 0.4246191 Vali Loss: 1.3347244 Test Loss: 0.3817023
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 51 cost time: 1.534487009048462
Epoch: 51, Steps: 52 | Train Loss: 0.4230927 Vali Loss: 1.3217641 Test Loss: 0.3810484
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 52 cost time: 1.5392858982086182
Epoch: 52, Steps: 52 | Train Loss: 0.4226133 Vali Loss: 1.3263494 Test Loss: 0.3816584
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 53 cost time: 1.5319435596466064
Epoch: 53, Steps: 52 | Train Loss: 0.4232465 Vali Loss: 1.3273411 Test Loss: 0.3809710
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 54 cost time: 1.535198450088501
Epoch: 54, Steps: 52 | Train Loss: 0.4224811 Vali Loss: 1.3248825 Test Loss: 0.3821295
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 55 cost time: 1.531426191329956
Epoch: 55, Steps: 52 | Train Loss: 0.4241377 Vali Loss: 1.3325553 Test Loss: 0.3813887
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 56 cost time: 1.5254149436950684
Epoch: 56, Steps: 52 | Train Loss: 0.4232123 Vali Loss: 1.3292153 Test Loss: 0.3818296
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 57 cost time: 1.526383876800537
Epoch: 57, Steps: 52 | Train Loss: 0.4225506 Vali Loss: 1.3160254 Test Loss: 0.3809935
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 58 cost time: 1.5307016372680664
Epoch: 58, Steps: 52 | Train Loss: 0.4245029 Vali Loss: 1.3284845 Test Loss: 0.3806830
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 59 cost time: 1.5279662609100342
Epoch: 59, Steps: 52 | Train Loss: 0.4223891 Vali Loss: 1.3259037 Test Loss: 0.3808831
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 60 cost time: 1.5289416313171387
Epoch: 60, Steps: 52 | Train Loss: 0.4228862 Vali Loss: 1.3276875 Test Loss: 0.3811927
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3817473351955414, mae:0.42832624912261963, rse:0.5061704516410828
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.060153961181640625 GB
Epoch: 1 cost time: 2.0857996940612793
Epoch: 1, Steps: 52 | Train Loss: 0.6926487 Vali Loss: 2.0917079 Test Loss: 1.3325429
Validation loss decreased (inf --> 2.091708).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 2 cost time: 0.7350852489471436
Epoch: 2, Steps: 52 | Train Loss: 0.5920038 Vali Loss: 1.5927917 Test Loss: 0.7093824
Validation loss decreased (2.091708 --> 1.592792).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 3 cost time: 0.7047643661499023
Epoch: 3, Steps: 52 | Train Loss: 0.4848017 Vali Loss: 1.4252872 Test Loss: 0.4604804
Validation loss decreased (1.592792 --> 1.425287).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 4 cost time: 0.7737174034118652
Epoch: 4, Steps: 52 | Train Loss: 0.4539912 Vali Loss: 1.3954126 Test Loss: 0.4312244
Validation loss decreased (1.425287 --> 1.395413).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 5 cost time: 0.7310001850128174
Epoch: 5, Steps: 52 | Train Loss: 0.4431325 Vali Loss: 1.3784344 Test Loss: 0.4171412
Validation loss decreased (1.395413 --> 1.378434).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 6 cost time: 1.4695491790771484
Epoch: 6, Steps: 52 | Train Loss: 0.4366855 Vali Loss: 1.3702377 Test Loss: 0.4080237
Validation loss decreased (1.378434 --> 1.370238).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 7 cost time: 1.5984816551208496
Epoch: 7, Steps: 52 | Train Loss: 0.4322474 Vali Loss: 1.3565335 Test Loss: 0.3996191
Validation loss decreased (1.370238 --> 1.356534).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 8 cost time: 1.5962212085723877
Epoch: 8, Steps: 52 | Train Loss: 0.4289511 Vali Loss: 1.3462498 Test Loss: 0.3933097
Validation loss decreased (1.356534 --> 1.346250).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 9 cost time: 1.5975663661956787
Epoch: 9, Steps: 52 | Train Loss: 0.4254764 Vali Loss: 1.3513191 Test Loss: 0.3892725
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 10 cost time: 1.6033101081848145
Epoch: 10, Steps: 52 | Train Loss: 0.4245607 Vali Loss: 1.3432962 Test Loss: 0.3863225
Validation loss decreased (1.346250 --> 1.343296).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 11 cost time: 1.6000540256500244
Epoch: 11, Steps: 52 | Train Loss: 0.4229639 Vali Loss: 1.3349314 Test Loss: 0.3836523
Validation loss decreased (1.343296 --> 1.334931).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 12 cost time: 1.6001675128936768
Epoch: 12, Steps: 52 | Train Loss: 0.4191824 Vali Loss: 1.3341080 Test Loss: 0.3810526
Validation loss decreased (1.334931 --> 1.334108).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 13 cost time: 1.5958881378173828
Epoch: 13, Steps: 52 | Train Loss: 0.4193707 Vali Loss: 1.3284881 Test Loss: 0.3788416
Validation loss decreased (1.334108 --> 1.328488).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 14 cost time: 1.6024901866912842
Epoch: 14, Steps: 52 | Train Loss: 0.4178308 Vali Loss: 1.3291121 Test Loss: 0.3783473
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 15 cost time: 1.5942010879516602
Epoch: 15, Steps: 52 | Train Loss: 0.4180976 Vali Loss: 1.3178364 Test Loss: 0.3758525
Validation loss decreased (1.328488 --> 1.317836).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 16 cost time: 1.600494146347046
Epoch: 16, Steps: 52 | Train Loss: 0.4182961 Vali Loss: 1.3203005 Test Loss: 0.3754686
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 17 cost time: 1.5975217819213867
Epoch: 17, Steps: 52 | Train Loss: 0.4149674 Vali Loss: 1.3201895 Test Loss: 0.3738346
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 18 cost time: 1.6033384799957275
Epoch: 18, Steps: 52 | Train Loss: 0.4154583 Vali Loss: 1.3225843 Test Loss: 0.3740199
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 19 cost time: 1.5934882164001465
Epoch: 19, Steps: 52 | Train Loss: 0.4122568 Vali Loss: 1.3211353 Test Loss: 0.3727558
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 20 cost time: 1.5955405235290527
Epoch: 20, Steps: 52 | Train Loss: 0.4131354 Vali Loss: 1.3129690 Test Loss: 0.3726450
Validation loss decreased (1.317836 --> 1.312969).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 21 cost time: 1.5926611423492432
Epoch: 21, Steps: 52 | Train Loss: 0.4149538 Vali Loss: 1.3174038 Test Loss: 0.3719550
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 22 cost time: 1.5966064929962158
Epoch: 22, Steps: 52 | Train Loss: 0.4126308 Vali Loss: 1.3090928 Test Loss: 0.3713070
Validation loss decreased (1.312969 --> 1.309093).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 23 cost time: 1.5963804721832275
Epoch: 23, Steps: 52 | Train Loss: 0.4116086 Vali Loss: 1.3206637 Test Loss: 0.3709453
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 24 cost time: 1.6018187999725342
Epoch: 24, Steps: 52 | Train Loss: 0.4126390 Vali Loss: 1.3155409 Test Loss: 0.3707127
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 25 cost time: 1.5986683368682861
Epoch: 25, Steps: 52 | Train Loss: 0.4131130 Vali Loss: 1.3125570 Test Loss: 0.3702655
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 26 cost time: 1.5976483821868896
Epoch: 26, Steps: 52 | Train Loss: 0.4100588 Vali Loss: 1.3122087 Test Loss: 0.3700527
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 27 cost time: 1.5963106155395508
Epoch: 27, Steps: 52 | Train Loss: 0.4116292 Vali Loss: 1.3148038 Test Loss: 0.3700039
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 28 cost time: 1.5999698638916016
Epoch: 28, Steps: 52 | Train Loss: 0.4110813 Vali Loss: 1.3144495 Test Loss: 0.3700537
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 29 cost time: 1.5972402095794678
Epoch: 29, Steps: 52 | Train Loss: 0.4111498 Vali Loss: 1.3095634 Test Loss: 0.3692734
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 30 cost time: 1.5945110321044922
Epoch: 30, Steps: 52 | Train Loss: 0.4105443 Vali Loss: 1.3167831 Test Loss: 0.3698801
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 31 cost time: 1.5963964462280273
Epoch: 31, Steps: 52 | Train Loss: 0.4101521 Vali Loss: 1.3070151 Test Loss: 0.3693833
Validation loss decreased (1.309093 --> 1.307015).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 32 cost time: 1.5997121334075928
Epoch: 32, Steps: 52 | Train Loss: 0.4101897 Vali Loss: 1.3045089 Test Loss: 0.3687526
Validation loss decreased (1.307015 --> 1.304509).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 33 cost time: 1.5949065685272217
Epoch: 33, Steps: 52 | Train Loss: 0.4101013 Vali Loss: 1.3120663 Test Loss: 0.3688985
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 34 cost time: 1.5902724266052246
Epoch: 34, Steps: 52 | Train Loss: 0.4116310 Vali Loss: 1.3069973 Test Loss: 0.3689415
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 35 cost time: 1.5931549072265625
Epoch: 35, Steps: 52 | Train Loss: 0.4104581 Vali Loss: 1.3129141 Test Loss: 0.3692983
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 36 cost time: 1.5942623615264893
Epoch: 36, Steps: 52 | Train Loss: 0.4099390 Vali Loss: 1.3077641 Test Loss: 0.3688782
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 37 cost time: 1.5965344905853271
Epoch: 37, Steps: 52 | Train Loss: 0.4106327 Vali Loss: 1.3011429 Test Loss: 0.3688821
Validation loss decreased (1.304509 --> 1.301143).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 38 cost time: 1.5974805355072021
Epoch: 38, Steps: 52 | Train Loss: 0.4089560 Vali Loss: 1.3111162 Test Loss: 0.3687724
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 39 cost time: 1.6052069664001465
Epoch: 39, Steps: 52 | Train Loss: 0.4103465 Vali Loss: 1.3121258 Test Loss: 0.3684998
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 40 cost time: 1.5993952751159668
Epoch: 40, Steps: 52 | Train Loss: 0.4094691 Vali Loss: 1.3104949 Test Loss: 0.3684504
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 41 cost time: 1.5980422496795654
Epoch: 41, Steps: 52 | Train Loss: 0.4110401 Vali Loss: 1.3049061 Test Loss: 0.3685749
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 42 cost time: 1.596445083618164
Epoch: 42, Steps: 52 | Train Loss: 0.4103893 Vali Loss: 1.3144228 Test Loss: 0.3683318
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 43 cost time: 1.603938341140747
Epoch: 43, Steps: 52 | Train Loss: 0.4087830 Vali Loss: 1.3095304 Test Loss: 0.3681795
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 44 cost time: 1.5977494716644287
Epoch: 44, Steps: 52 | Train Loss: 0.4084080 Vali Loss: 1.3091671 Test Loss: 0.3681325
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 45 cost time: 1.6016671657562256
Epoch: 45, Steps: 52 | Train Loss: 0.4090646 Vali Loss: 1.3112993 Test Loss: 0.3681295
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 46 cost time: 1.5966215133666992
Epoch: 46, Steps: 52 | Train Loss: 0.4101436 Vali Loss: 1.3153031 Test Loss: 0.3686504
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 47 cost time: 1.6010611057281494
Epoch: 47, Steps: 52 | Train Loss: 0.4100277 Vali Loss: 1.3134897 Test Loss: 0.3684593
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 48 cost time: 1.6015944480895996
Epoch: 48, Steps: 52 | Train Loss: 0.4096020 Vali Loss: 1.3071768 Test Loss: 0.3680075
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 49 cost time: 1.6032474040985107
Epoch: 49, Steps: 52 | Train Loss: 0.4093819 Vali Loss: 1.3072774 Test Loss: 0.3680245
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 50 cost time: 1.6004209518432617
Epoch: 50, Steps: 52 | Train Loss: 0.4100385 Vali Loss: 1.3047073 Test Loss: 0.3684348
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 51 cost time: 1.6010138988494873
Epoch: 51, Steps: 52 | Train Loss: 0.4104827 Vali Loss: 1.3106227 Test Loss: 0.3683293
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 52 cost time: 1.600205421447754
Epoch: 52, Steps: 52 | Train Loss: 0.4100422 Vali Loss: 1.3114381 Test Loss: 0.3683899
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 53 cost time: 1.6000440120697021
Epoch: 53, Steps: 52 | Train Loss: 0.4101158 Vali Loss: 1.3098874 Test Loss: 0.3681263
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 54 cost time: 1.598815679550171
Epoch: 54, Steps: 52 | Train Loss: 0.4090108 Vali Loss: 1.3125536 Test Loss: 0.3680859
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 55 cost time: 1.6036341190338135
Epoch: 55, Steps: 52 | Train Loss: 0.4087681 Vali Loss: 1.3107762 Test Loss: 0.3684351
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 56 cost time: 1.5981473922729492
Epoch: 56, Steps: 52 | Train Loss: 0.4087119 Vali Loss: 1.3106343 Test Loss: 0.3683862
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 57 cost time: 1.6005477905273438
Epoch: 57, Steps: 52 | Train Loss: 0.4087905 Vali Loss: 1.3140061 Test Loss: 0.3680434
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 58 cost time: 1.5958507061004639
Epoch: 58, Steps: 52 | Train Loss: 0.4089239 Vali Loss: 1.3129289 Test Loss: 0.3681762
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 59 cost time: 1.5975663661956787
Epoch: 59, Steps: 52 | Train Loss: 0.4084486 Vali Loss: 1.3091748 Test Loss: 0.3677597
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 60 cost time: 1.5978796482086182
Epoch: 60, Steps: 52 | Train Loss: 0.4090763 Vali Loss: 1.3139210 Test Loss: 0.3678707
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36888206005096436, mae:0.41531363129615784, rse:0.49756813049316406
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06334877014160156 GB
Epoch: 1 cost time: 2.1367604732513428
Epoch: 1, Steps: 52 | Train Loss: 0.6854712 Vali Loss: 2.0941534 Test Loss: 1.3496009
Validation loss decreased (inf --> 2.094153).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 2 cost time: 0.7340285778045654
Epoch: 2, Steps: 52 | Train Loss: 0.5766184 Vali Loss: 1.4986805 Test Loss: 0.5553243
Validation loss decreased (2.094153 --> 1.498680).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 3 cost time: 0.7385110855102539
Epoch: 3, Steps: 52 | Train Loss: 0.4690777 Vali Loss: 1.3958178 Test Loss: 0.4397140
Validation loss decreased (1.498680 --> 1.395818).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 4 cost time: 0.7392432689666748
Epoch: 4, Steps: 52 | Train Loss: 0.4483914 Vali Loss: 1.3867121 Test Loss: 0.4161849
Validation loss decreased (1.395818 --> 1.386712).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 5 cost time: 0.748448371887207
Epoch: 5, Steps: 52 | Train Loss: 0.4387509 Vali Loss: 1.3637177 Test Loss: 0.4031751
Validation loss decreased (1.386712 --> 1.363718).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 6 cost time: 1.6289222240447998
Epoch: 6, Steps: 52 | Train Loss: 0.4315778 Vali Loss: 1.3579078 Test Loss: 0.3953893
Validation loss decreased (1.363718 --> 1.357908).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 7 cost time: 1.6401286125183105
Epoch: 7, Steps: 52 | Train Loss: 0.4267136 Vali Loss: 1.3460370 Test Loss: 0.3899122
Validation loss decreased (1.357908 --> 1.346037).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 8 cost time: 1.6446466445922852
Epoch: 8, Steps: 52 | Train Loss: 0.4255349 Vali Loss: 1.3299773 Test Loss: 0.3852980
Validation loss decreased (1.346037 --> 1.329977).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 9 cost time: 1.6485440731048584
Epoch: 9, Steps: 52 | Train Loss: 0.4227525 Vali Loss: 1.3359199 Test Loss: 0.3834026
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 10 cost time: 1.649766445159912
Epoch: 10, Steps: 52 | Train Loss: 0.4190855 Vali Loss: 1.3347808 Test Loss: 0.3786959
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 11 cost time: 1.6420152187347412
Epoch: 11, Steps: 52 | Train Loss: 0.4180024 Vali Loss: 1.3235180 Test Loss: 0.3781698
Validation loss decreased (1.329977 --> 1.323518).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 12 cost time: 1.644798755645752
Epoch: 12, Steps: 52 | Train Loss: 0.4178089 Vali Loss: 1.3232933 Test Loss: 0.3760775
Validation loss decreased (1.323518 --> 1.323293).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 13 cost time: 1.6543054580688477
Epoch: 13, Steps: 52 | Train Loss: 0.4148672 Vali Loss: 1.3184528 Test Loss: 0.3749626
Validation loss decreased (1.323293 --> 1.318453).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 14 cost time: 1.647463083267212
Epoch: 14, Steps: 52 | Train Loss: 0.4148078 Vali Loss: 1.3200846 Test Loss: 0.3744577
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 15 cost time: 1.6475474834442139
Epoch: 15, Steps: 52 | Train Loss: 0.4117078 Vali Loss: 1.3224275 Test Loss: 0.3724686
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 16 cost time: 1.6481328010559082
Epoch: 16, Steps: 52 | Train Loss: 0.4110873 Vali Loss: 1.3138694 Test Loss: 0.3721635
Validation loss decreased (1.318453 --> 1.313869).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 17 cost time: 1.6546874046325684
Epoch: 17, Steps: 52 | Train Loss: 0.4119591 Vali Loss: 1.3104503 Test Loss: 0.3715913
Validation loss decreased (1.313869 --> 1.310450).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 18 cost time: 1.6498944759368896
Epoch: 18, Steps: 52 | Train Loss: 0.4118628 Vali Loss: 1.3107125 Test Loss: 0.3713498
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 19 cost time: 1.656217336654663
Epoch: 19, Steps: 52 | Train Loss: 0.4110576 Vali Loss: 1.3155744 Test Loss: 0.3711202
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 20 cost time: 1.6479334831237793
Epoch: 20, Steps: 52 | Train Loss: 0.4113587 Vali Loss: 1.3088944 Test Loss: 0.3708283
Validation loss decreased (1.310450 --> 1.308894).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 21 cost time: 1.6488690376281738
Epoch: 21, Steps: 52 | Train Loss: 0.4107035 Vali Loss: 1.3144146 Test Loss: 0.3707008
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 22 cost time: 1.6469852924346924
Epoch: 22, Steps: 52 | Train Loss: 0.4113166 Vali Loss: 1.3086901 Test Loss: 0.3701749
Validation loss decreased (1.308894 --> 1.308690).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 23 cost time: 1.6494910717010498
Epoch: 23, Steps: 52 | Train Loss: 0.4097374 Vali Loss: 1.3142239 Test Loss: 0.3693016
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 24 cost time: 1.6535069942474365
Epoch: 24, Steps: 52 | Train Loss: 0.4092843 Vali Loss: 1.3074563 Test Loss: 0.3691795
Validation loss decreased (1.308690 --> 1.307456).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 25 cost time: 1.6498162746429443
Epoch: 25, Steps: 52 | Train Loss: 0.4105092 Vali Loss: 1.3117239 Test Loss: 0.3696724
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 26 cost time: 1.6476740837097168
Epoch: 26, Steps: 52 | Train Loss: 0.4098301 Vali Loss: 1.3095828 Test Loss: 0.3692323
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 27 cost time: 1.656864881515503
Epoch: 27, Steps: 52 | Train Loss: 0.4088236 Vali Loss: 1.3114190 Test Loss: 0.3695158
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 28 cost time: 1.6493480205535889
Epoch: 28, Steps: 52 | Train Loss: 0.4082094 Vali Loss: 1.3041894 Test Loss: 0.3690462
Validation loss decreased (1.307456 --> 1.304189).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 29 cost time: 1.6468830108642578
Epoch: 29, Steps: 52 | Train Loss: 0.4069889 Vali Loss: 1.3090804 Test Loss: 0.3689052
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 30 cost time: 1.6456730365753174
Epoch: 30, Steps: 52 | Train Loss: 0.4081463 Vali Loss: 1.3040293 Test Loss: 0.3686952
Validation loss decreased (1.304189 --> 1.304029).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 31 cost time: 1.6470885276794434
Epoch: 31, Steps: 52 | Train Loss: 0.4090658 Vali Loss: 1.3063817 Test Loss: 0.3689178
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 32 cost time: 1.6479012966156006
Epoch: 32, Steps: 52 | Train Loss: 0.4094296 Vali Loss: 1.3099051 Test Loss: 0.3686188
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 33 cost time: 1.658141851425171
Epoch: 33, Steps: 52 | Train Loss: 0.4083772 Vali Loss: 1.3068880 Test Loss: 0.3681754
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 34 cost time: 1.6526193618774414
Epoch: 34, Steps: 52 | Train Loss: 0.4068389 Vali Loss: 1.3113554 Test Loss: 0.3680731
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 35 cost time: 1.6514878273010254
Epoch: 35, Steps: 52 | Train Loss: 0.4067663 Vali Loss: 1.3076918 Test Loss: 0.3680607
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 36 cost time: 1.6461288928985596
Epoch: 36, Steps: 52 | Train Loss: 0.4085653 Vali Loss: 1.3140055 Test Loss: 0.3683688
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 37 cost time: 1.651186227798462
Epoch: 37, Steps: 52 | Train Loss: 0.4086740 Vali Loss: 1.3064659 Test Loss: 0.3683668
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 38 cost time: 1.6531589031219482
Epoch: 38, Steps: 52 | Train Loss: 0.4087716 Vali Loss: 1.3050892 Test Loss: 0.3683122
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 39 cost time: 1.6505413055419922
Epoch: 39, Steps: 52 | Train Loss: 0.4075669 Vali Loss: 1.3118839 Test Loss: 0.3677028
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 40 cost time: 1.6474592685699463
Epoch: 40, Steps: 52 | Train Loss: 0.4082713 Vali Loss: 1.3109033 Test Loss: 0.3677129
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 41 cost time: 1.64772629737854
Epoch: 41, Steps: 52 | Train Loss: 0.4075444 Vali Loss: 1.3039844 Test Loss: 0.3677098
Validation loss decreased (1.304029 --> 1.303984).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 42 cost time: 1.6447539329528809
Epoch: 42, Steps: 52 | Train Loss: 0.4070436 Vali Loss: 1.2940627 Test Loss: 0.3680339
Validation loss decreased (1.303984 --> 1.294063).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 43 cost time: 1.6487524509429932
Epoch: 43, Steps: 52 | Train Loss: 0.4063504 Vali Loss: 1.3086607 Test Loss: 0.3679887
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 44 cost time: 1.64847731590271
Epoch: 44, Steps: 52 | Train Loss: 0.4064896 Vali Loss: 1.3075567 Test Loss: 0.3678461
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 45 cost time: 1.653459072113037
Epoch: 45, Steps: 52 | Train Loss: 0.4092655 Vali Loss: 1.3042897 Test Loss: 0.3678197
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 46 cost time: 1.6464214324951172
Epoch: 46, Steps: 52 | Train Loss: 0.4055355 Vali Loss: 1.3088167 Test Loss: 0.3675997
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 47 cost time: 1.6589689254760742
Epoch: 47, Steps: 52 | Train Loss: 0.4071479 Vali Loss: 1.3080218 Test Loss: 0.3681137
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 48 cost time: 1.6527912616729736
Epoch: 48, Steps: 52 | Train Loss: 0.4083564 Vali Loss: 1.3088176 Test Loss: 0.3675211
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 49 cost time: 1.6532726287841797
Epoch: 49, Steps: 52 | Train Loss: 0.4066052 Vali Loss: 1.3097384 Test Loss: 0.3677036
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 50 cost time: 1.6524863243103027
Epoch: 50, Steps: 52 | Train Loss: 0.4081978 Vali Loss: 1.3103634 Test Loss: 0.3678260
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 51 cost time: 1.6538774967193604
Epoch: 51, Steps: 52 | Train Loss: 0.4083106 Vali Loss: 1.3116450 Test Loss: 0.3676655
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 52 cost time: 1.6534183025360107
Epoch: 52, Steps: 52 | Train Loss: 0.4079529 Vali Loss: 1.3051693 Test Loss: 0.3679196
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 53 cost time: 1.652557134628296
Epoch: 53, Steps: 52 | Train Loss: 0.4060578 Vali Loss: 1.3073102 Test Loss: 0.3678834
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 54 cost time: 1.6530232429504395
Epoch: 54, Steps: 52 | Train Loss: 0.4091899 Vali Loss: 1.3116567 Test Loss: 0.3684664
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 55 cost time: 1.6481082439422607
Epoch: 55, Steps: 52 | Train Loss: 0.4089178 Vali Loss: 1.3086696 Test Loss: 0.3676590
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 56 cost time: 1.646106481552124
Epoch: 56, Steps: 52 | Train Loss: 0.4056376 Vali Loss: 1.3037341 Test Loss: 0.3675708
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 57 cost time: 1.652902364730835
Epoch: 57, Steps: 52 | Train Loss: 0.4074145 Vali Loss: 1.3031100 Test Loss: 0.3682401
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 58 cost time: 1.6519529819488525
Epoch: 58, Steps: 52 | Train Loss: 0.4052149 Vali Loss: 1.3061525 Test Loss: 0.3674111
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 59 cost time: 1.6499392986297607
Epoch: 59, Steps: 52 | Train Loss: 0.4058322 Vali Loss: 1.3085178 Test Loss: 0.3678627
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 60 cost time: 1.6502149105072021
Epoch: 60, Steps: 52 | Train Loss: 0.4078101 Vali Loss: 1.3102520 Test Loss: 0.3678268
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36803388595581055, mae:0.4151146709918976, rse:0.4969957768917084
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05716896057128906 GB
Epoch: 1 cost time: 2.046161413192749
Epoch: 1, Steps: 52 | Train Loss: 0.7904906 Vali Loss: 2.3034515 Test Loss: 1.5348111
Validation loss decreased (inf --> 2.303452).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 2 cost time: 0.7090928554534912
Epoch: 2, Steps: 52 | Train Loss: 0.7384251 Vali Loss: 2.0557883 Test Loss: 1.2673892
Validation loss decreased (2.303452 --> 2.055788).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 3 cost time: 0.7007336616516113
Epoch: 3, Steps: 52 | Train Loss: 0.6605365 Vali Loss: 1.8692476 Test Loss: 1.0600802
Validation loss decreased (2.055788 --> 1.869248).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 4 cost time: 0.702000617980957
Epoch: 4, Steps: 52 | Train Loss: 0.5929939 Vali Loss: 1.6914485 Test Loss: 0.8372002
Validation loss decreased (1.869248 --> 1.691448).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 5 cost time: 0.7072811126708984
Epoch: 5, Steps: 52 | Train Loss: 0.5381146 Vali Loss: 1.5662258 Test Loss: 0.6647099
Validation loss decreased (1.691448 --> 1.566226).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 6 cost time: 1.1730008125305176
Epoch: 6, Steps: 52 | Train Loss: 0.4987573 Vali Loss: 1.4910302 Test Loss: 0.5637717
Validation loss decreased (1.566226 --> 1.491030).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 7 cost time: 1.5516769886016846
Epoch: 7, Steps: 52 | Train Loss: 0.4755820 Vali Loss: 1.4548604 Test Loss: 0.5058458
Validation loss decreased (1.491030 --> 1.454860).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 8 cost time: 1.5536847114562988
Epoch: 8, Steps: 52 | Train Loss: 0.4635776 Vali Loss: 1.4203670 Test Loss: 0.4716234
Validation loss decreased (1.454860 --> 1.420367).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 9 cost time: 1.562269687652588
Epoch: 9, Steps: 52 | Train Loss: 0.4518572 Vali Loss: 1.4099443 Test Loss: 0.4480098
Validation loss decreased (1.420367 --> 1.409944).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 10 cost time: 1.565711498260498
Epoch: 10, Steps: 52 | Train Loss: 0.4461252 Vali Loss: 1.3903452 Test Loss: 0.4326076
Validation loss decreased (1.409944 --> 1.390345).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 11 cost time: 1.5492165088653564
Epoch: 11, Steps: 52 | Train Loss: 0.4418639 Vali Loss: 1.3883815 Test Loss: 0.4216422
Validation loss decreased (1.390345 --> 1.388381).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 12 cost time: 1.5668442249298096
Epoch: 12, Steps: 52 | Train Loss: 0.4389389 Vali Loss: 1.3757391 Test Loss: 0.4140407
Validation loss decreased (1.388381 --> 1.375739).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 13 cost time: 1.5574440956115723
Epoch: 13, Steps: 52 | Train Loss: 0.4362279 Vali Loss: 1.3598121 Test Loss: 0.4082478
Validation loss decreased (1.375739 --> 1.359812).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 14 cost time: 1.5508732795715332
Epoch: 14, Steps: 52 | Train Loss: 0.4342759 Vali Loss: 1.3611724 Test Loss: 0.4041381
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 15 cost time: 1.560713529586792
Epoch: 15, Steps: 52 | Train Loss: 0.4314319 Vali Loss: 1.3585079 Test Loss: 0.4002469
Validation loss decreased (1.359812 --> 1.358508).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 16 cost time: 1.549957513809204
Epoch: 16, Steps: 52 | Train Loss: 0.4295901 Vali Loss: 1.3537390 Test Loss: 0.3975344
Validation loss decreased (1.358508 --> 1.353739).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 17 cost time: 1.5497710704803467
Epoch: 17, Steps: 52 | Train Loss: 0.4262316 Vali Loss: 1.3441455 Test Loss: 0.3946190
Validation loss decreased (1.353739 --> 1.344146).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 18 cost time: 1.5558578968048096
Epoch: 18, Steps: 52 | Train Loss: 0.4279096 Vali Loss: 1.3446712 Test Loss: 0.3936321
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 19 cost time: 1.5507161617279053
Epoch: 19, Steps: 52 | Train Loss: 0.4259149 Vali Loss: 1.3493021 Test Loss: 0.3922773
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 20 cost time: 1.5565752983093262
Epoch: 20, Steps: 52 | Train Loss: 0.4249508 Vali Loss: 1.3448086 Test Loss: 0.3912153
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 21 cost time: 1.544839859008789
Epoch: 21, Steps: 52 | Train Loss: 0.4227829 Vali Loss: 1.3341646 Test Loss: 0.3904424
Validation loss decreased (1.344146 --> 1.334165).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 22 cost time: 1.5610134601593018
Epoch: 22, Steps: 52 | Train Loss: 0.4232593 Vali Loss: 1.3427601 Test Loss: 0.3894905
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 23 cost time: 1.5629603862762451
Epoch: 23, Steps: 52 | Train Loss: 0.4234487 Vali Loss: 1.3399652 Test Loss: 0.3886473
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 24 cost time: 1.552647352218628
Epoch: 24, Steps: 52 | Train Loss: 0.4231854 Vali Loss: 1.3364544 Test Loss: 0.3881978
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 25 cost time: 1.560072898864746
Epoch: 25, Steps: 52 | Train Loss: 0.4212742 Vali Loss: 1.3417401 Test Loss: 0.3871937
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 26 cost time: 1.5664730072021484
Epoch: 26, Steps: 52 | Train Loss: 0.4208670 Vali Loss: 1.3418708 Test Loss: 0.3866134
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 27 cost time: 1.5508389472961426
Epoch: 27, Steps: 52 | Train Loss: 0.4190569 Vali Loss: 1.3373744 Test Loss: 0.3866892
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 28 cost time: 1.5630896091461182
Epoch: 28, Steps: 52 | Train Loss: 0.4217631 Vali Loss: 1.3367929 Test Loss: 0.3858602
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 29 cost time: 1.561269998550415
Epoch: 29, Steps: 52 | Train Loss: 0.4207972 Vali Loss: 1.3365903 Test Loss: 0.3855019
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 30 cost time: 1.5492589473724365
Epoch: 30, Steps: 52 | Train Loss: 0.4203973 Vali Loss: 1.3295367 Test Loss: 0.3854840
Validation loss decreased (1.334165 --> 1.329537).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 31 cost time: 1.5570547580718994
Epoch: 31, Steps: 52 | Train Loss: 0.4190338 Vali Loss: 1.3340788 Test Loss: 0.3848100
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 32 cost time: 1.5464236736297607
Epoch: 32, Steps: 52 | Train Loss: 0.4187339 Vali Loss: 1.3324995 Test Loss: 0.3849614
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 33 cost time: 1.5490813255310059
Epoch: 33, Steps: 52 | Train Loss: 0.4172599 Vali Loss: 1.3306054 Test Loss: 0.3847669
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 34 cost time: 1.5471134185791016
Epoch: 34, Steps: 52 | Train Loss: 0.4189460 Vali Loss: 1.3378332 Test Loss: 0.3847253
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 35 cost time: 1.5496554374694824
Epoch: 35, Steps: 52 | Train Loss: 0.4194389 Vali Loss: 1.3292792 Test Loss: 0.3842984
Validation loss decreased (1.329537 --> 1.329279).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 36 cost time: 1.5471057891845703
Epoch: 36, Steps: 52 | Train Loss: 0.4187215 Vali Loss: 1.3250606 Test Loss: 0.3842714
Validation loss decreased (1.329279 --> 1.325061).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 37 cost time: 1.5472772121429443
Epoch: 37, Steps: 52 | Train Loss: 0.4186212 Vali Loss: 1.3318214 Test Loss: 0.3841000
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 38 cost time: 1.554924726486206
Epoch: 38, Steps: 52 | Train Loss: 0.4191919 Vali Loss: 1.3358607 Test Loss: 0.3835554
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 39 cost time: 1.5503573417663574
Epoch: 39, Steps: 52 | Train Loss: 0.4187851 Vali Loss: 1.3378398 Test Loss: 0.3840089
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 40 cost time: 1.555849313735962
Epoch: 40, Steps: 52 | Train Loss: 0.4178609 Vali Loss: 1.3250911 Test Loss: 0.3838698
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 41 cost time: 1.5591020584106445
Epoch: 41, Steps: 52 | Train Loss: 0.4184400 Vali Loss: 1.3319547 Test Loss: 0.3834506
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 42 cost time: 1.5486843585968018
Epoch: 42, Steps: 52 | Train Loss: 0.4193644 Vali Loss: 1.3369560 Test Loss: 0.3835715
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 43 cost time: 1.5647718906402588
Epoch: 43, Steps: 52 | Train Loss: 0.4189721 Vali Loss: 1.3371687 Test Loss: 0.3836876
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 44 cost time: 1.5492632389068604
Epoch: 44, Steps: 52 | Train Loss: 0.4168087 Vali Loss: 1.3339932 Test Loss: 0.3834636
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 45 cost time: 1.5520820617675781
Epoch: 45, Steps: 52 | Train Loss: 0.4182458 Vali Loss: 1.3341602 Test Loss: 0.3833908
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 46 cost time: 1.549421787261963
Epoch: 46, Steps: 52 | Train Loss: 0.4167144 Vali Loss: 1.3298587 Test Loss: 0.3833010
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 47 cost time: 1.5603463649749756
Epoch: 47, Steps: 52 | Train Loss: 0.4180176 Vali Loss: 1.3318667 Test Loss: 0.3833900
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 48 cost time: 1.5514287948608398
Epoch: 48, Steps: 52 | Train Loss: 0.4180545 Vali Loss: 1.3273325 Test Loss: 0.3833277
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 49 cost time: 1.5564281940460205
Epoch: 49, Steps: 52 | Train Loss: 0.4187631 Vali Loss: 1.3263118 Test Loss: 0.3832022
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 50 cost time: 1.545417308807373
Epoch: 50, Steps: 52 | Train Loss: 0.4184427 Vali Loss: 1.3364339 Test Loss: 0.3836842
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 51 cost time: 1.5661063194274902
Epoch: 51, Steps: 52 | Train Loss: 0.4169643 Vali Loss: 1.3372477 Test Loss: 0.3831402
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 52 cost time: 1.5454943180084229
Epoch: 52, Steps: 52 | Train Loss: 0.4183940 Vali Loss: 1.3289905 Test Loss: 0.3830030
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 53 cost time: 1.5505564212799072
Epoch: 53, Steps: 52 | Train Loss: 0.4177913 Vali Loss: 1.3271289 Test Loss: 0.3831469
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 54 cost time: 1.5475082397460938
Epoch: 54, Steps: 52 | Train Loss: 0.4178917 Vali Loss: 1.3294817 Test Loss: 0.3829553
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 55 cost time: 1.5533928871154785
Epoch: 55, Steps: 52 | Train Loss: 0.4174048 Vali Loss: 1.3314903 Test Loss: 0.3831281
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 56 cost time: 1.5629463195800781
Epoch: 56, Steps: 52 | Train Loss: 0.4178987 Vali Loss: 1.3294802 Test Loss: 0.3828981
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 57 cost time: 1.5491077899932861
Epoch: 57, Steps: 52 | Train Loss: 0.4183684 Vali Loss: 1.3305849 Test Loss: 0.3833559
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 58 cost time: 1.55035400390625
Epoch: 58, Steps: 52 | Train Loss: 0.4185367 Vali Loss: 1.3212254 Test Loss: 0.3829286
Validation loss decreased (1.325061 --> 1.321225).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 59 cost time: 1.558835506439209
Epoch: 59, Steps: 52 | Train Loss: 0.4186609 Vali Loss: 1.3364230 Test Loss: 0.3827440
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 60 cost time: 1.56083345413208
Epoch: 60, Steps: 52 | Train Loss: 0.4171386 Vali Loss: 1.3266774 Test Loss: 0.3828449
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3829285800457001, mae:0.4302755296230316, rse:0.5069530010223389
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06031513214111328 GB
Epoch: 1 cost time: 2.12886118888855
Epoch: 1, Steps: 52 | Train Loss: 0.7112740 Vali Loss: 2.1597638 Test Loss: 1.3940316
Validation loss decreased (inf --> 2.159764).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 2 cost time: 0.7406024932861328
Epoch: 2, Steps: 52 | Train Loss: 0.6138002 Vali Loss: 1.6459992 Test Loss: 0.7893862
Validation loss decreased (2.159764 --> 1.645999).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 3 cost time: 0.7109744548797607
Epoch: 3, Steps: 52 | Train Loss: 0.4872498 Vali Loss: 1.4132638 Test Loss: 0.4348429
Validation loss decreased (1.645999 --> 1.413264).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 4 cost time: 0.7323665618896484
Epoch: 4, Steps: 52 | Train Loss: 0.4464664 Vali Loss: 1.3841491 Test Loss: 0.4024306
Validation loss decreased (1.413264 --> 1.384149).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 5 cost time: 0.7284972667694092
Epoch: 5, Steps: 52 | Train Loss: 0.4358753 Vali Loss: 1.3644856 Test Loss: 0.3940629
Validation loss decreased (1.384149 --> 1.364486).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 6 cost time: 1.4850513935089111
Epoch: 6, Steps: 52 | Train Loss: 0.4279568 Vali Loss: 1.3565960 Test Loss: 0.3857859
Validation loss decreased (1.364486 --> 1.356596).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 7 cost time: 1.6028869152069092
Epoch: 7, Steps: 52 | Train Loss: 0.4249818 Vali Loss: 1.3443577 Test Loss: 0.3824680
Validation loss decreased (1.356596 --> 1.344358).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 8 cost time: 1.6060972213745117
Epoch: 8, Steps: 52 | Train Loss: 0.4207050 Vali Loss: 1.3276980 Test Loss: 0.3779640
Validation loss decreased (1.344358 --> 1.327698).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 9 cost time: 1.6074507236480713
Epoch: 9, Steps: 52 | Train Loss: 0.4167072 Vali Loss: 1.3151333 Test Loss: 0.3767752
Validation loss decreased (1.327698 --> 1.315133).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 10 cost time: 1.6102416515350342
Epoch: 10, Steps: 52 | Train Loss: 0.4156462 Vali Loss: 1.3207041 Test Loss: 0.3749974
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 11 cost time: 1.6087911128997803
Epoch: 11, Steps: 52 | Train Loss: 0.4150795 Vali Loss: 1.3212117 Test Loss: 0.3738997
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 12 cost time: 1.6079332828521729
Epoch: 12, Steps: 52 | Train Loss: 0.4143029 Vali Loss: 1.3199317 Test Loss: 0.3741876
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 13 cost time: 1.6094117164611816
Epoch: 13, Steps: 52 | Train Loss: 0.4106057 Vali Loss: 1.3152840 Test Loss: 0.3732550
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 14 cost time: 1.6118967533111572
Epoch: 14, Steps: 52 | Train Loss: 0.4093226 Vali Loss: 1.3112063 Test Loss: 0.3728047
Validation loss decreased (1.315133 --> 1.311206).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 15 cost time: 1.6029331684112549
Epoch: 15, Steps: 52 | Train Loss: 0.4111166 Vali Loss: 1.3157029 Test Loss: 0.3714217
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 16 cost time: 1.6100349426269531
Epoch: 16, Steps: 52 | Train Loss: 0.4084794 Vali Loss: 1.3067813 Test Loss: 0.3713120
Validation loss decreased (1.311206 --> 1.306781).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 17 cost time: 1.6094496250152588
Epoch: 17, Steps: 52 | Train Loss: 0.4073715 Vali Loss: 1.3087237 Test Loss: 0.3710674
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 18 cost time: 1.6096880435943604
Epoch: 18, Steps: 52 | Train Loss: 0.4071032 Vali Loss: 1.3011525 Test Loss: 0.3705273
Validation loss decreased (1.306781 --> 1.301152).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 19 cost time: 1.6080667972564697
Epoch: 19, Steps: 52 | Train Loss: 0.4084563 Vali Loss: 1.3079145 Test Loss: 0.3708845
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 20 cost time: 1.6125171184539795
Epoch: 20, Steps: 52 | Train Loss: 0.4073027 Vali Loss: 1.3093901 Test Loss: 0.3698295
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 21 cost time: 1.60398530960083
Epoch: 21, Steps: 52 | Train Loss: 0.4060129 Vali Loss: 1.3017545 Test Loss: 0.3699641
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 22 cost time: 1.60677170753479
Epoch: 22, Steps: 52 | Train Loss: 0.4060021 Vali Loss: 1.3049273 Test Loss: 0.3701594
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 23 cost time: 1.606865406036377
Epoch: 23, Steps: 52 | Train Loss: 0.4056586 Vali Loss: 1.3125980 Test Loss: 0.3693437
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 24 cost time: 1.6066322326660156
Epoch: 24, Steps: 52 | Train Loss: 0.4045036 Vali Loss: 1.3063558 Test Loss: 0.3691246
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 25 cost time: 1.6065189838409424
Epoch: 25, Steps: 52 | Train Loss: 0.4057008 Vali Loss: 1.3036885 Test Loss: 0.3694303
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 26 cost time: 1.6093230247497559
Epoch: 26, Steps: 52 | Train Loss: 0.4065957 Vali Loss: 1.3092039 Test Loss: 0.3688257
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 27 cost time: 1.607283353805542
Epoch: 27, Steps: 52 | Train Loss: 0.4047720 Vali Loss: 1.3056023 Test Loss: 0.3689490
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 28 cost time: 1.608659267425537
Epoch: 28, Steps: 52 | Train Loss: 0.4058735 Vali Loss: 1.3027772 Test Loss: 0.3685812
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 29 cost time: 1.6057007312774658
Epoch: 29, Steps: 52 | Train Loss: 0.4056870 Vali Loss: 1.3011885 Test Loss: 0.3691337
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 30 cost time: 1.6093425750732422
Epoch: 30, Steps: 52 | Train Loss: 0.4057547 Vali Loss: 1.3058567 Test Loss: 0.3687789
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 31 cost time: 1.6043767929077148
Epoch: 31, Steps: 52 | Train Loss: 0.4036766 Vali Loss: 1.3006984 Test Loss: 0.3684260
Validation loss decreased (1.301152 --> 1.300698).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 32 cost time: 1.6035430431365967
Epoch: 32, Steps: 52 | Train Loss: 0.4052618 Vali Loss: 1.3065760 Test Loss: 0.3685723
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 33 cost time: 1.6022460460662842
Epoch: 33, Steps: 52 | Train Loss: 0.4030057 Vali Loss: 1.3097389 Test Loss: 0.3684884
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 34 cost time: 1.5994582176208496
Epoch: 34, Steps: 52 | Train Loss: 0.4059531 Vali Loss: 1.3059969 Test Loss: 0.3680556
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 35 cost time: 1.6040475368499756
Epoch: 35, Steps: 52 | Train Loss: 0.4056301 Vali Loss: 1.3013967 Test Loss: 0.3690010
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 36 cost time: 1.606097936630249
Epoch: 36, Steps: 52 | Train Loss: 0.4037797 Vali Loss: 1.3036537 Test Loss: 0.3680505
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 37 cost time: 1.6045963764190674
Epoch: 37, Steps: 52 | Train Loss: 0.4039251 Vali Loss: 1.2972360 Test Loss: 0.3686355
Validation loss decreased (1.300698 --> 1.297236).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 38 cost time: 1.6069488525390625
Epoch: 38, Steps: 52 | Train Loss: 0.4047241 Vali Loss: 1.2964234 Test Loss: 0.3682435
Validation loss decreased (1.297236 --> 1.296423).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 39 cost time: 1.6117744445800781
Epoch: 39, Steps: 52 | Train Loss: 0.4036781 Vali Loss: 1.2973744 Test Loss: 0.3679879
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 40 cost time: 1.6064717769622803
Epoch: 40, Steps: 52 | Train Loss: 0.4029975 Vali Loss: 1.2917171 Test Loss: 0.3683284
Validation loss decreased (1.296423 --> 1.291717).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 41 cost time: 1.6102242469787598
Epoch: 41, Steps: 52 | Train Loss: 0.4023932 Vali Loss: 1.3027334 Test Loss: 0.3679260
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 42 cost time: 1.605936050415039
Epoch: 42, Steps: 52 | Train Loss: 0.4037791 Vali Loss: 1.2994808 Test Loss: 0.3677670
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 43 cost time: 1.6084744930267334
Epoch: 43, Steps: 52 | Train Loss: 0.4046353 Vali Loss: 1.3035175 Test Loss: 0.3682553
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 44 cost time: 1.6090855598449707
Epoch: 44, Steps: 52 | Train Loss: 0.4054560 Vali Loss: 1.2979864 Test Loss: 0.3682216
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 45 cost time: 1.6081781387329102
Epoch: 45, Steps: 52 | Train Loss: 0.4056114 Vali Loss: 1.3059461 Test Loss: 0.3681069
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 46 cost time: 1.6066033840179443
Epoch: 46, Steps: 52 | Train Loss: 0.4024348 Vali Loss: 1.3012340 Test Loss: 0.3679103
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 47 cost time: 1.6086621284484863
Epoch: 47, Steps: 52 | Train Loss: 0.4041910 Vali Loss: 1.3051023 Test Loss: 0.3686146
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 48 cost time: 1.6095120906829834
Epoch: 48, Steps: 52 | Train Loss: 0.4046388 Vali Loss: 1.3000193 Test Loss: 0.3680191
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 49 cost time: 1.6088330745697021
Epoch: 49, Steps: 52 | Train Loss: 0.4037689 Vali Loss: 1.3083951 Test Loss: 0.3682281
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 50 cost time: 1.6105892658233643
Epoch: 50, Steps: 52 | Train Loss: 0.4033541 Vali Loss: 1.3043441 Test Loss: 0.3682938
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 51 cost time: 1.608983039855957
Epoch: 51, Steps: 52 | Train Loss: 0.4032516 Vali Loss: 1.3053110 Test Loss: 0.3681500
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 52 cost time: 1.6091444492340088
Epoch: 52, Steps: 52 | Train Loss: 0.4053609 Vali Loss: 1.3032721 Test Loss: 0.3685042
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 53 cost time: 1.6083667278289795
Epoch: 53, Steps: 52 | Train Loss: 0.4032122 Vali Loss: 1.3027654 Test Loss: 0.3681182
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 54 cost time: 1.6101868152618408
Epoch: 54, Steps: 52 | Train Loss: 0.4025876 Vali Loss: 1.2936761 Test Loss: 0.3679427
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 55 cost time: 1.6099178791046143
Epoch: 55, Steps: 52 | Train Loss: 0.4024931 Vali Loss: 1.3025364 Test Loss: 0.3683692
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 56 cost time: 1.6054155826568604
Epoch: 56, Steps: 52 | Train Loss: 0.4040447 Vali Loss: 1.3065511 Test Loss: 0.3682530
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 57 cost time: 1.6107332706451416
Epoch: 57, Steps: 52 | Train Loss: 0.4039216 Vali Loss: 1.3058717 Test Loss: 0.3684481
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 58 cost time: 1.6061522960662842
Epoch: 58, Steps: 52 | Train Loss: 0.4033623 Vali Loss: 1.3009769 Test Loss: 0.3681211
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 59 cost time: 1.6096856594085693
Epoch: 59, Steps: 52 | Train Loss: 0.4027317 Vali Loss: 1.3043399 Test Loss: 0.3684801
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 60 cost time: 1.6043531894683838
Epoch: 60, Steps: 52 | Train Loss: 0.4036452 Vali Loss: 1.3053904 Test Loss: 0.3680663
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.36832836270332336, mae:0.41818416118621826, rse:0.4971945881843567
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06350994110107422 GB
Epoch: 1 cost time: 2.1285836696624756
Epoch: 1, Steps: 52 | Train Loss: 0.6837958 Vali Loss: 2.0980620 Test Loss: 1.3439481
Validation loss decreased (inf --> 2.098062).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 2 cost time: 0.747683048248291
Epoch: 2, Steps: 52 | Train Loss: 0.5778395 Vali Loss: 1.5067462 Test Loss: 0.5801299
Validation loss decreased (2.098062 --> 1.506746).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 3 cost time: 0.7470009326934814
Epoch: 3, Steps: 52 | Train Loss: 0.4627915 Vali Loss: 1.3922138 Test Loss: 0.4164436
Validation loss decreased (1.506746 --> 1.392214).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 4 cost time: 0.7443118095397949
Epoch: 4, Steps: 52 | Train Loss: 0.4399813 Vali Loss: 1.3619916 Test Loss: 0.4039822
Validation loss decreased (1.392214 --> 1.361992).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 5 cost time: 0.7611842155456543
Epoch: 5, Steps: 52 | Train Loss: 0.4292972 Vali Loss: 1.3581493 Test Loss: 0.3941662
Validation loss decreased (1.361992 --> 1.358149).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 6 cost time: 1.646524429321289
Epoch: 6, Steps: 52 | Train Loss: 0.4245941 Vali Loss: 1.3413334 Test Loss: 0.3876785
Validation loss decreased (1.358149 --> 1.341333).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 7 cost time: 1.6551096439361572
Epoch: 7, Steps: 52 | Train Loss: 0.4212674 Vali Loss: 1.3351073 Test Loss: 0.3837129
Validation loss decreased (1.341333 --> 1.335107).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 8 cost time: 1.6595897674560547
Epoch: 8, Steps: 52 | Train Loss: 0.4172121 Vali Loss: 1.3308752 Test Loss: 0.3792062
Validation loss decreased (1.335107 --> 1.330875).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 9 cost time: 1.66563081741333
Epoch: 9, Steps: 52 | Train Loss: 0.4162103 Vali Loss: 1.3243992 Test Loss: 0.3755826
Validation loss decreased (1.330875 --> 1.324399).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 10 cost time: 1.6629159450531006
Epoch: 10, Steps: 52 | Train Loss: 0.4147366 Vali Loss: 1.3173994 Test Loss: 0.3742165
Validation loss decreased (1.324399 --> 1.317399).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 11 cost time: 1.6619117259979248
Epoch: 11, Steps: 52 | Train Loss: 0.4127774 Vali Loss: 1.3216674 Test Loss: 0.3728167
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 12 cost time: 1.6543755531311035
Epoch: 12, Steps: 52 | Train Loss: 0.4122114 Vali Loss: 1.3121634 Test Loss: 0.3720116
Validation loss decreased (1.317399 --> 1.312163).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 13 cost time: 1.663419485092163
Epoch: 13, Steps: 52 | Train Loss: 0.4108338 Vali Loss: 1.3163915 Test Loss: 0.3714573
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 14 cost time: 1.6621172428131104
Epoch: 14, Steps: 52 | Train Loss: 0.4086620 Vali Loss: 1.3116955 Test Loss: 0.3706654
Validation loss decreased (1.312163 --> 1.311695).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 15 cost time: 1.667083978652954
Epoch: 15, Steps: 52 | Train Loss: 0.4092925 Vali Loss: 1.3133674 Test Loss: 0.3697626
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 16 cost time: 1.6660881042480469
Epoch: 16, Steps: 52 | Train Loss: 0.4091632 Vali Loss: 1.3078698 Test Loss: 0.3691365
Validation loss decreased (1.311695 --> 1.307870).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 17 cost time: 1.666247844696045
Epoch: 17, Steps: 52 | Train Loss: 0.4071858 Vali Loss: 1.3070226 Test Loss: 0.3693175
Validation loss decreased (1.307870 --> 1.307023).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 18 cost time: 1.66518235206604
Epoch: 18, Steps: 52 | Train Loss: 0.4067845 Vali Loss: 1.3071504 Test Loss: 0.3688832
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 19 cost time: 1.6604247093200684
Epoch: 19, Steps: 52 | Train Loss: 0.4077568 Vali Loss: 1.3078761 Test Loss: 0.3696018
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 20 cost time: 1.661134958267212
Epoch: 20, Steps: 52 | Train Loss: 0.4072626 Vali Loss: 1.3116996 Test Loss: 0.3690220
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 21 cost time: 1.6627161502838135
Epoch: 21, Steps: 52 | Train Loss: 0.4078819 Vali Loss: 1.3072873 Test Loss: 0.3675723
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 22 cost time: 1.6559512615203857
Epoch: 22, Steps: 52 | Train Loss: 0.4061091 Vali Loss: 1.3063929 Test Loss: 0.3691218
Validation loss decreased (1.307023 --> 1.306393).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 23 cost time: 1.6599748134613037
Epoch: 23, Steps: 52 | Train Loss: 0.4051208 Vali Loss: 1.3060335 Test Loss: 0.3680538
Validation loss decreased (1.306393 --> 1.306033).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 24 cost time: 1.6565332412719727
Epoch: 24, Steps: 52 | Train Loss: 0.4059510 Vali Loss: 1.3088381 Test Loss: 0.3678297
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 25 cost time: 1.65997314453125
Epoch: 25, Steps: 52 | Train Loss: 0.4047332 Vali Loss: 1.3070965 Test Loss: 0.3668718
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 26 cost time: 1.6659765243530273
Epoch: 26, Steps: 52 | Train Loss: 0.4050775 Vali Loss: 1.3089328 Test Loss: 0.3669888
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 27 cost time: 1.657879114151001
Epoch: 27, Steps: 52 | Train Loss: 0.4039386 Vali Loss: 1.3042035 Test Loss: 0.3670626
Validation loss decreased (1.306033 --> 1.304204).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 28 cost time: 1.663858413696289
Epoch: 28, Steps: 52 | Train Loss: 0.4054819 Vali Loss: 1.3069732 Test Loss: 0.3678493
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 29 cost time: 1.6658134460449219
Epoch: 29, Steps: 52 | Train Loss: 0.4056564 Vali Loss: 1.3026621 Test Loss: 0.3674343
Validation loss decreased (1.304204 --> 1.302662).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 30 cost time: 1.6668753623962402
Epoch: 30, Steps: 52 | Train Loss: 0.4053607 Vali Loss: 1.3026659 Test Loss: 0.3674714
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 31 cost time: 1.6652345657348633
Epoch: 31, Steps: 52 | Train Loss: 0.4050933 Vali Loss: 1.3033524 Test Loss: 0.3676760
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 32 cost time: 1.6673078536987305
Epoch: 32, Steps: 52 | Train Loss: 0.4041751 Vali Loss: 1.3026953 Test Loss: 0.3676487
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 33 cost time: 1.6640567779541016
Epoch: 33, Steps: 52 | Train Loss: 0.4047145 Vali Loss: 1.3081957 Test Loss: 0.3675368
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 34 cost time: 1.6642746925354004
Epoch: 34, Steps: 52 | Train Loss: 0.4048834 Vali Loss: 1.2959640 Test Loss: 0.3671585
Validation loss decreased (1.302662 --> 1.295964).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 35 cost time: 1.6610000133514404
Epoch: 35, Steps: 52 | Train Loss: 0.4049908 Vali Loss: 1.3032279 Test Loss: 0.3670897
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 36 cost time: 1.6627569198608398
Epoch: 36, Steps: 52 | Train Loss: 0.4053538 Vali Loss: 1.3019769 Test Loss: 0.3665699
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 37 cost time: 1.6596424579620361
Epoch: 37, Steps: 52 | Train Loss: 0.4042168 Vali Loss: 1.2962675 Test Loss: 0.3671422
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 38 cost time: 1.6695168018341064
Epoch: 38, Steps: 52 | Train Loss: 0.4042829 Vali Loss: 1.2971398 Test Loss: 0.3670626
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 39 cost time: 1.6629445552825928
Epoch: 39, Steps: 52 | Train Loss: 0.4045028 Vali Loss: 1.3037592 Test Loss: 0.3674438
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 40 cost time: 1.6674809455871582
Epoch: 40, Steps: 52 | Train Loss: 0.4024541 Vali Loss: 1.3026279 Test Loss: 0.3669431
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 41 cost time: 1.6636292934417725
Epoch: 41, Steps: 52 | Train Loss: 0.4040628 Vali Loss: 1.2965593 Test Loss: 0.3672132
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 42 cost time: 1.6666762828826904
Epoch: 42, Steps: 52 | Train Loss: 0.4036980 Vali Loss: 1.2929945 Test Loss: 0.3676108
Validation loss decreased (1.295964 --> 1.292994).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 43 cost time: 1.6654760837554932
Epoch: 43, Steps: 52 | Train Loss: 0.4040189 Vali Loss: 1.3013133 Test Loss: 0.3670019
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 44 cost time: 1.6649847030639648
Epoch: 44, Steps: 52 | Train Loss: 0.4051651 Vali Loss: 1.3050478 Test Loss: 0.3669106
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 45 cost time: 1.6536567211151123
Epoch: 45, Steps: 52 | Train Loss: 0.4035680 Vali Loss: 1.3012322 Test Loss: 0.3670012
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 46 cost time: 1.666027545928955
Epoch: 46, Steps: 52 | Train Loss: 0.4036179 Vali Loss: 1.3043675 Test Loss: 0.3671628
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 47 cost time: 1.6564607620239258
Epoch: 47, Steps: 52 | Train Loss: 0.4035671 Vali Loss: 1.3021157 Test Loss: 0.3666498
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 48 cost time: 1.6674635410308838
Epoch: 48, Steps: 52 | Train Loss: 0.4033424 Vali Loss: 1.3042147 Test Loss: 0.3667681
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 49 cost time: 1.6553905010223389
Epoch: 49, Steps: 52 | Train Loss: 0.4037410 Vali Loss: 1.2977509 Test Loss: 0.3667414
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 50 cost time: 1.6655020713806152
Epoch: 50, Steps: 52 | Train Loss: 0.4041071 Vali Loss: 1.3030787 Test Loss: 0.3675050
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 51 cost time: 1.656036376953125
Epoch: 51, Steps: 52 | Train Loss: 0.4026593 Vali Loss: 1.2981346 Test Loss: 0.3665385
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 52 cost time: 1.66965913772583
Epoch: 52, Steps: 52 | Train Loss: 0.4030674 Vali Loss: 1.3064344 Test Loss: 0.3673403
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 53 cost time: 1.6637203693389893
Epoch: 53, Steps: 52 | Train Loss: 0.4029407 Vali Loss: 1.2967811 Test Loss: 0.3671129
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 54 cost time: 1.664928913116455
Epoch: 54, Steps: 52 | Train Loss: 0.4026297 Vali Loss: 1.3055484 Test Loss: 0.3662121
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 55 cost time: 1.6618168354034424
Epoch: 55, Steps: 52 | Train Loss: 0.4017878 Vali Loss: 1.3031836 Test Loss: 0.3667763
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 56 cost time: 1.6676502227783203
Epoch: 56, Steps: 52 | Train Loss: 0.4035252 Vali Loss: 1.3046150 Test Loss: 0.3674667
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 57 cost time: 1.659391164779663
Epoch: 57, Steps: 52 | Train Loss: 0.4035833 Vali Loss: 1.2980795 Test Loss: 0.3666665
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 58 cost time: 1.6663367748260498
Epoch: 58, Steps: 52 | Train Loss: 0.4048273 Vali Loss: 1.2936326 Test Loss: 0.3669001
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 59 cost time: 1.6643869876861572
Epoch: 59, Steps: 52 | Train Loss: 0.4029479 Vali Loss: 1.2943534 Test Loss: 0.3670284
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 60 cost time: 1.6555571556091309
Epoch: 60, Steps: 52 | Train Loss: 0.4057304 Vali Loss: 1.3059319 Test Loss: 0.3666689
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3676108419895172, mae:0.4209798276424408, rse:0.4967100918292999
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05733013153076172 GB
Epoch: 1 cost time: 2.078049421310425
Epoch: 1, Steps: 52 | Train Loss: 0.7770842 Vali Loss: 2.2403314 Test Loss: 1.4906929
Validation loss decreased (inf --> 2.240331).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 2 cost time: 0.7009890079498291
Epoch: 2, Steps: 52 | Train Loss: 0.7152670 Vali Loss: 1.9495062 Test Loss: 1.1518182
Validation loss decreased (2.240331 --> 1.949506).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 3 cost time: 0.6949999332427979
Epoch: 3, Steps: 52 | Train Loss: 0.6154148 Vali Loss: 1.7042956 Test Loss: 0.8399681
Validation loss decreased (1.949506 --> 1.704296).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 4 cost time: 0.7006218433380127
Epoch: 4, Steps: 52 | Train Loss: 0.5374357 Vali Loss: 1.5408090 Test Loss: 0.6126396
Validation loss decreased (1.704296 --> 1.540809).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 5 cost time: 0.7024390697479248
Epoch: 5, Steps: 52 | Train Loss: 0.4916168 Vali Loss: 1.4752231 Test Loss: 0.5163170
Validation loss decreased (1.540809 --> 1.475223).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 6 cost time: 1.234278678894043
Epoch: 6, Steps: 52 | Train Loss: 0.4672125 Vali Loss: 1.4296651 Test Loss: 0.4687021
Validation loss decreased (1.475223 --> 1.429665).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 7 cost time: 1.5672264099121094
Epoch: 7, Steps: 52 | Train Loss: 0.4530083 Vali Loss: 1.3967594 Test Loss: 0.4401192
Validation loss decreased (1.429665 --> 1.396759).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 8 cost time: 1.58266282081604
Epoch: 8, Steps: 52 | Train Loss: 0.4452503 Vali Loss: 1.3951907 Test Loss: 0.4234443
Validation loss decreased (1.396759 --> 1.395191).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 9 cost time: 1.5619659423828125
Epoch: 9, Steps: 52 | Train Loss: 0.4384653 Vali Loss: 1.3708040 Test Loss: 0.4118718
Validation loss decreased (1.395191 --> 1.370804).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 10 cost time: 1.5786409378051758
Epoch: 10, Steps: 52 | Train Loss: 0.4364552 Vali Loss: 1.3642564 Test Loss: 0.4052531
Validation loss decreased (1.370804 --> 1.364256).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 11 cost time: 1.5760579109191895
Epoch: 11, Steps: 52 | Train Loss: 0.4325439 Vali Loss: 1.3609564 Test Loss: 0.4004782
Validation loss decreased (1.364256 --> 1.360956).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 12 cost time: 1.5669982433319092
Epoch: 12, Steps: 52 | Train Loss: 0.4282690 Vali Loss: 1.3541112 Test Loss: 0.3965637
Validation loss decreased (1.360956 --> 1.354111).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 13 cost time: 1.57651948928833
Epoch: 13, Steps: 52 | Train Loss: 0.4263309 Vali Loss: 1.3527172 Test Loss: 0.3939192
Validation loss decreased (1.354111 --> 1.352717).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 14 cost time: 1.5677542686462402
Epoch: 14, Steps: 52 | Train Loss: 0.4259665 Vali Loss: 1.3521132 Test Loss: 0.3919371
Validation loss decreased (1.352717 --> 1.352113).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 15 cost time: 1.5653376579284668
Epoch: 15, Steps: 52 | Train Loss: 0.4261615 Vali Loss: 1.3443637 Test Loss: 0.3897675
Validation loss decreased (1.352113 --> 1.344364).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 16 cost time: 1.580394983291626
Epoch: 16, Steps: 52 | Train Loss: 0.4223742 Vali Loss: 1.3431034 Test Loss: 0.3884842
Validation loss decreased (1.344364 --> 1.343103).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 17 cost time: 1.574004888534546
Epoch: 17, Steps: 52 | Train Loss: 0.4227021 Vali Loss: 1.3407575 Test Loss: 0.3871288
Validation loss decreased (1.343103 --> 1.340757).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 18 cost time: 1.5645959377288818
Epoch: 18, Steps: 52 | Train Loss: 0.4202485 Vali Loss: 1.3403454 Test Loss: 0.3862878
Validation loss decreased (1.340757 --> 1.340345).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 19 cost time: 1.583604097366333
Epoch: 19, Steps: 52 | Train Loss: 0.4205206 Vali Loss: 1.3405131 Test Loss: 0.3852762
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 20 cost time: 1.5634143352508545
Epoch: 20, Steps: 52 | Train Loss: 0.4190366 Vali Loss: 1.3397975 Test Loss: 0.3844486
Validation loss decreased (1.340345 --> 1.339797).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 21 cost time: 1.5644855499267578
Epoch: 21, Steps: 52 | Train Loss: 0.4184290 Vali Loss: 1.3309968 Test Loss: 0.3842649
Validation loss decreased (1.339797 --> 1.330997).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 22 cost time: 1.5656721591949463
Epoch: 22, Steps: 52 | Train Loss: 0.4183298 Vali Loss: 1.3313806 Test Loss: 0.3831456
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 23 cost time: 1.5679960250854492
Epoch: 23, Steps: 52 | Train Loss: 0.4189313 Vali Loss: 1.3217189 Test Loss: 0.3826977
Validation loss decreased (1.330997 --> 1.321719).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 24 cost time: 1.5694324970245361
Epoch: 24, Steps: 52 | Train Loss: 0.4188653 Vali Loss: 1.3296692 Test Loss: 0.3824224
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 25 cost time: 1.5839645862579346
Epoch: 25, Steps: 52 | Train Loss: 0.4184250 Vali Loss: 1.3294153 Test Loss: 0.3817542
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 26 cost time: 1.5760345458984375
Epoch: 26, Steps: 52 | Train Loss: 0.4177119 Vali Loss: 1.3218867 Test Loss: 0.3812503
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 27 cost time: 1.5699963569641113
Epoch: 27, Steps: 52 | Train Loss: 0.4150593 Vali Loss: 1.3221538 Test Loss: 0.3813528
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 28 cost time: 1.5725882053375244
Epoch: 28, Steps: 52 | Train Loss: 0.4144275 Vali Loss: 1.3205290 Test Loss: 0.3807722
Validation loss decreased (1.321719 --> 1.320529).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 29 cost time: 1.5783934593200684
Epoch: 29, Steps: 52 | Train Loss: 0.4152159 Vali Loss: 1.3256407 Test Loss: 0.3806686
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 30 cost time: 1.5636680126190186
Epoch: 30, Steps: 52 | Train Loss: 0.4163005 Vali Loss: 1.3201107 Test Loss: 0.3806444
Validation loss decreased (1.320529 --> 1.320111).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 31 cost time: 1.575693130493164
Epoch: 31, Steps: 52 | Train Loss: 0.4150865 Vali Loss: 1.3275129 Test Loss: 0.3802425
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 32 cost time: 1.5734143257141113
Epoch: 32, Steps: 52 | Train Loss: 0.4159141 Vali Loss: 1.3251789 Test Loss: 0.3795264
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 33 cost time: 1.5660510063171387
Epoch: 33, Steps: 52 | Train Loss: 0.4160382 Vali Loss: 1.3131435 Test Loss: 0.3801751
Validation loss decreased (1.320111 --> 1.313143).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 34 cost time: 1.5720231533050537
Epoch: 34, Steps: 52 | Train Loss: 0.4145161 Vali Loss: 1.3215977 Test Loss: 0.3795743
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 35 cost time: 1.575575828552246
Epoch: 35, Steps: 52 | Train Loss: 0.4159085 Vali Loss: 1.3243129 Test Loss: 0.3793994
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 36 cost time: 1.565277099609375
Epoch: 36, Steps: 52 | Train Loss: 0.4147785 Vali Loss: 1.3199189 Test Loss: 0.3794734
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 37 cost time: 1.5836021900177002
Epoch: 37, Steps: 52 | Train Loss: 0.4150959 Vali Loss: 1.3244617 Test Loss: 0.3793924
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 38 cost time: 1.575648546218872
Epoch: 38, Steps: 52 | Train Loss: 0.4141158 Vali Loss: 1.3231841 Test Loss: 0.3786240
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 39 cost time: 1.5714690685272217
Epoch: 39, Steps: 52 | Train Loss: 0.4150053 Vali Loss: 1.3207772 Test Loss: 0.3791832
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 40 cost time: 1.5799195766448975
Epoch: 40, Steps: 52 | Train Loss: 0.4128865 Vali Loss: 1.3212967 Test Loss: 0.3788844
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 41 cost time: 1.570267915725708
Epoch: 41, Steps: 52 | Train Loss: 0.4158829 Vali Loss: 1.3193209 Test Loss: 0.3789479
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 42 cost time: 1.5679030418395996
Epoch: 42, Steps: 52 | Train Loss: 0.4143570 Vali Loss: 1.3238130 Test Loss: 0.3788559
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 43 cost time: 1.5798149108886719
Epoch: 43, Steps: 52 | Train Loss: 0.4159390 Vali Loss: 1.3228396 Test Loss: 0.3789748
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 44 cost time: 1.5587503910064697
Epoch: 44, Steps: 52 | Train Loss: 0.4137468 Vali Loss: 1.3249238 Test Loss: 0.3787401
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 45 cost time: 1.5674185752868652
Epoch: 45, Steps: 52 | Train Loss: 0.4148976 Vali Loss: 1.3221676 Test Loss: 0.3786372
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 46 cost time: 1.5669057369232178
Epoch: 46, Steps: 52 | Train Loss: 0.4142736 Vali Loss: 1.3201730 Test Loss: 0.3786559
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 47 cost time: 1.5720953941345215
Epoch: 47, Steps: 52 | Train Loss: 0.4147945 Vali Loss: 1.3209317 Test Loss: 0.3784184
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 48 cost time: 1.5670599937438965
Epoch: 48, Steps: 52 | Train Loss: 0.4154405 Vali Loss: 1.3278810 Test Loss: 0.3781714
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 49 cost time: 1.5667109489440918
Epoch: 49, Steps: 52 | Train Loss: 0.4149224 Vali Loss: 1.3173020 Test Loss: 0.3783134
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 50 cost time: 1.566105842590332
Epoch: 50, Steps: 52 | Train Loss: 0.4151159 Vali Loss: 1.3268185 Test Loss: 0.3785371
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 51 cost time: 1.5672101974487305
Epoch: 51, Steps: 52 | Train Loss: 0.4139653 Vali Loss: 1.3236457 Test Loss: 0.3782647
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 52 cost time: 1.562593698501587
Epoch: 52, Steps: 52 | Train Loss: 0.4154798 Vali Loss: 1.3214663 Test Loss: 0.3783961
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 53 cost time: 1.5670182704925537
Epoch: 53, Steps: 52 | Train Loss: 0.4143614 Vali Loss: 1.3195583 Test Loss: 0.3782534
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 54 cost time: 1.5652132034301758
Epoch: 54, Steps: 52 | Train Loss: 0.4125256 Vali Loss: 1.3237497 Test Loss: 0.3785376
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 55 cost time: 1.560859203338623
Epoch: 55, Steps: 52 | Train Loss: 0.4132831 Vali Loss: 1.3215864 Test Loss: 0.3783198
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 56 cost time: 1.5641586780548096
Epoch: 56, Steps: 52 | Train Loss: 0.4129205 Vali Loss: 1.3196645 Test Loss: 0.3782748
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 57 cost time: 1.5648736953735352
Epoch: 57, Steps: 52 | Train Loss: 0.4128821 Vali Loss: 1.3218722 Test Loss: 0.3781090
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 58 cost time: 1.5638399124145508
Epoch: 58, Steps: 52 | Train Loss: 0.4134493 Vali Loss: 1.3185325 Test Loss: 0.3782712
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 59 cost time: 1.5750212669372559
Epoch: 59, Steps: 52 | Train Loss: 0.4138588 Vali Loss: 1.3226445 Test Loss: 0.3784766
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 60 cost time: 1.5681877136230469
Epoch: 60, Steps: 52 | Train Loss: 0.4148120 Vali Loss: 1.3094195 Test Loss: 0.3780562
Validation loss decreased (1.313143 --> 1.309420).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3780561685562134, mae:0.42617306113243103, rse:0.5037174224853516
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06047630310058594 GB
Epoch: 1 cost time: 2.162848711013794
Epoch: 1, Steps: 52 | Train Loss: 0.7154735 Vali Loss: 2.1539407 Test Loss: 1.3858827
Validation loss decreased (inf --> 2.153941).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 2 cost time: 0.7319996356964111
Epoch: 2, Steps: 52 | Train Loss: 0.6112143 Vali Loss: 1.6403267 Test Loss: 0.7677457
Validation loss decreased (2.153941 --> 1.640327).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 3 cost time: 0.7346246242523193
Epoch: 3, Steps: 52 | Train Loss: 0.4868609 Vali Loss: 1.3952217 Test Loss: 0.4401764
Validation loss decreased (1.640327 --> 1.395222).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 4 cost time: 0.7334396839141846
Epoch: 4, Steps: 52 | Train Loss: 0.4464742 Vali Loss: 1.3717566 Test Loss: 0.4129708
Validation loss decreased (1.395222 --> 1.371757).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 5 cost time: 0.7348349094390869
Epoch: 5, Steps: 52 | Train Loss: 0.4375402 Vali Loss: 1.3668780 Test Loss: 0.4010679
Validation loss decreased (1.371757 --> 1.366878).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 6 cost time: 1.6198384761810303
Epoch: 6, Steps: 52 | Train Loss: 0.4309487 Vali Loss: 1.3556148 Test Loss: 0.3913623
Validation loss decreased (1.366878 --> 1.355615).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 7 cost time: 1.6284973621368408
Epoch: 7, Steps: 52 | Train Loss: 0.4257528 Vali Loss: 1.3404922 Test Loss: 0.3830786
Validation loss decreased (1.355615 --> 1.340492).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 8 cost time: 1.6288487911224365
Epoch: 8, Steps: 52 | Train Loss: 0.4219523 Vali Loss: 1.3296983 Test Loss: 0.3788630
Validation loss decreased (1.340492 --> 1.329698).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 9 cost time: 1.6266047954559326
Epoch: 9, Steps: 52 | Train Loss: 0.4207721 Vali Loss: 1.3304765 Test Loss: 0.3761344
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 10 cost time: 1.6301305294036865
Epoch: 10, Steps: 52 | Train Loss: 0.4174743 Vali Loss: 1.3330588 Test Loss: 0.3729416
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 11 cost time: 1.628981351852417
Epoch: 11, Steps: 52 | Train Loss: 0.4156552 Vali Loss: 1.3202872 Test Loss: 0.3703246
Validation loss decreased (1.329698 --> 1.320287).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 12 cost time: 1.6316750049591064
Epoch: 12, Steps: 52 | Train Loss: 0.4141246 Vali Loss: 1.3241514 Test Loss: 0.3676735
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 13 cost time: 1.6301074028015137
Epoch: 13, Steps: 52 | Train Loss: 0.4131556 Vali Loss: 1.3121600 Test Loss: 0.3664078
Validation loss decreased (1.320287 --> 1.312160).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 14 cost time: 1.6313495635986328
Epoch: 14, Steps: 52 | Train Loss: 0.4134661 Vali Loss: 1.3136675 Test Loss: 0.3656394
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 15 cost time: 1.6439263820648193
Epoch: 15, Steps: 52 | Train Loss: 0.4114835 Vali Loss: 1.3057835 Test Loss: 0.3642478
Validation loss decreased (1.312160 --> 1.305784).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 16 cost time: 1.6313858032226562
Epoch: 16, Steps: 52 | Train Loss: 0.4106110 Vali Loss: 1.3130208 Test Loss: 0.3638949
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 17 cost time: 1.6312024593353271
Epoch: 17, Steps: 52 | Train Loss: 0.4080250 Vali Loss: 1.3141181 Test Loss: 0.3634522
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 18 cost time: 1.6355838775634766
Epoch: 18, Steps: 52 | Train Loss: 0.4102830 Vali Loss: 1.3080209 Test Loss: 0.3627047
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 19 cost time: 1.6300609111785889
Epoch: 19, Steps: 52 | Train Loss: 0.4083144 Vali Loss: 1.3107965 Test Loss: 0.3621330
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 20 cost time: 1.6272237300872803
Epoch: 20, Steps: 52 | Train Loss: 0.4074389 Vali Loss: 1.3121927 Test Loss: 0.3620923
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 21 cost time: 1.6242411136627197
Epoch: 21, Steps: 52 | Train Loss: 0.4067631 Vali Loss: 1.3062923 Test Loss: 0.3614290
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 22 cost time: 1.6295623779296875
Epoch: 22, Steps: 52 | Train Loss: 0.4060346 Vali Loss: 1.3072505 Test Loss: 0.3608682
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 23 cost time: 1.6273188591003418
Epoch: 23, Steps: 52 | Train Loss: 0.4070077 Vali Loss: 1.3073342 Test Loss: 0.3602734
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 24 cost time: 1.6291465759277344
Epoch: 24, Steps: 52 | Train Loss: 0.4059477 Vali Loss: 1.3101362 Test Loss: 0.3605855
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 25 cost time: 1.6298496723175049
Epoch: 25, Steps: 52 | Train Loss: 0.4058062 Vali Loss: 1.2950091 Test Loss: 0.3603184
Validation loss decreased (1.305784 --> 1.295009).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 26 cost time: 1.6300103664398193
Epoch: 26, Steps: 52 | Train Loss: 0.4067746 Vali Loss: 1.3064128 Test Loss: 0.3600969
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 27 cost time: 1.6282312870025635
Epoch: 27, Steps: 52 | Train Loss: 0.4054932 Vali Loss: 1.3083974 Test Loss: 0.3596606
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 28 cost time: 1.6311907768249512
Epoch: 28, Steps: 52 | Train Loss: 0.4047913 Vali Loss: 1.2989926 Test Loss: 0.3593824
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 29 cost time: 1.628556251525879
Epoch: 29, Steps: 52 | Train Loss: 0.4053464 Vali Loss: 1.3034266 Test Loss: 0.3591001
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 30 cost time: 1.6311898231506348
Epoch: 30, Steps: 52 | Train Loss: 0.4048233 Vali Loss: 1.2963412 Test Loss: 0.3592759
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 31 cost time: 1.6273846626281738
Epoch: 31, Steps: 52 | Train Loss: 0.4054304 Vali Loss: 1.3020869 Test Loss: 0.3586924
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 32 cost time: 1.6332333087921143
Epoch: 32, Steps: 52 | Train Loss: 0.4055066 Vali Loss: 1.3072290 Test Loss: 0.3593070
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 33 cost time: 1.6307892799377441
Epoch: 33, Steps: 52 | Train Loss: 0.4052888 Vali Loss: 1.2984933 Test Loss: 0.3588412
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 34 cost time: 1.6285314559936523
Epoch: 34, Steps: 52 | Train Loss: 0.4058225 Vali Loss: 1.3061867 Test Loss: 0.3591750
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 35 cost time: 1.621521234512329
Epoch: 35, Steps: 52 | Train Loss: 0.4054043 Vali Loss: 1.2943934 Test Loss: 0.3586897
Validation loss decreased (1.295009 --> 1.294393).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 36 cost time: 1.6314003467559814
Epoch: 36, Steps: 52 | Train Loss: 0.4031102 Vali Loss: 1.3032303 Test Loss: 0.3591135
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 37 cost time: 1.6281335353851318
Epoch: 37, Steps: 52 | Train Loss: 0.4039295 Vali Loss: 1.2981006 Test Loss: 0.3587472
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 38 cost time: 1.6354327201843262
Epoch: 38, Steps: 52 | Train Loss: 0.4044579 Vali Loss: 1.3058856 Test Loss: 0.3591876
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 39 cost time: 1.626593828201294
Epoch: 39, Steps: 52 | Train Loss: 0.4031674 Vali Loss: 1.2974703 Test Loss: 0.3588644
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 40 cost time: 1.6323657035827637
Epoch: 40, Steps: 52 | Train Loss: 0.4044267 Vali Loss: 1.2957870 Test Loss: 0.3588948
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 41 cost time: 1.6278953552246094
Epoch: 41, Steps: 52 | Train Loss: 0.4040600 Vali Loss: 1.2887242 Test Loss: 0.3588474
Validation loss decreased (1.294393 --> 1.288724).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 42 cost time: 1.6297638416290283
Epoch: 42, Steps: 52 | Train Loss: 0.4040738 Vali Loss: 1.3029349 Test Loss: 0.3587619
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 43 cost time: 1.6265966892242432
Epoch: 43, Steps: 52 | Train Loss: 0.4047691 Vali Loss: 1.3004146 Test Loss: 0.3586522
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 44 cost time: 1.6236066818237305
Epoch: 44, Steps: 52 | Train Loss: 0.4047646 Vali Loss: 1.2958384 Test Loss: 0.3587040
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 45 cost time: 1.629345178604126
Epoch: 45, Steps: 52 | Train Loss: 0.4033554 Vali Loss: 1.3020020 Test Loss: 0.3584408
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 46 cost time: 1.626830816268921
Epoch: 46, Steps: 52 | Train Loss: 0.4042728 Vali Loss: 1.2906073 Test Loss: 0.3592026
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 47 cost time: 1.6246259212493896
Epoch: 47, Steps: 52 | Train Loss: 0.4040551 Vali Loss: 1.2985814 Test Loss: 0.3592356
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 48 cost time: 1.6316213607788086
Epoch: 48, Steps: 52 | Train Loss: 0.4038180 Vali Loss: 1.3009884 Test Loss: 0.3588420
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 49 cost time: 1.6290299892425537
Epoch: 49, Steps: 52 | Train Loss: 0.4046079 Vali Loss: 1.3040611 Test Loss: 0.3580518
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 50 cost time: 1.627612590789795
Epoch: 50, Steps: 52 | Train Loss: 0.4032153 Vali Loss: 1.2989578 Test Loss: 0.3587634
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 51 cost time: 1.6268479824066162
Epoch: 51, Steps: 52 | Train Loss: 0.4038450 Vali Loss: 1.3047670 Test Loss: 0.3592573
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 52 cost time: 1.6233890056610107
Epoch: 52, Steps: 52 | Train Loss: 0.4053609 Vali Loss: 1.2994798 Test Loss: 0.3587196
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 53 cost time: 1.6250078678131104
Epoch: 53, Steps: 52 | Train Loss: 0.4038612 Vali Loss: 1.2954998 Test Loss: 0.3582840
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 54 cost time: 1.630690574645996
Epoch: 54, Steps: 52 | Train Loss: 0.4055012 Vali Loss: 1.2963612 Test Loss: 0.3585773
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 55 cost time: 1.6281459331512451
Epoch: 55, Steps: 52 | Train Loss: 0.4042168 Vali Loss: 1.3011131 Test Loss: 0.3586941
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 56 cost time: 1.6275339126586914
Epoch: 56, Steps: 52 | Train Loss: 0.4050072 Vali Loss: 1.2996678 Test Loss: 0.3588968
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 57 cost time: 1.6292366981506348
Epoch: 57, Steps: 52 | Train Loss: 0.4038880 Vali Loss: 1.3025901 Test Loss: 0.3591692
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 58 cost time: 1.6302781105041504
Epoch: 58, Steps: 52 | Train Loss: 0.4038369 Vali Loss: 1.3007505 Test Loss: 0.3591192
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 59 cost time: 1.6284325122833252
Epoch: 59, Steps: 52 | Train Loss: 0.4027985 Vali Loss: 1.2972759 Test Loss: 0.3587701
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 60 cost time: 1.6279854774475098
Epoch: 60, Steps: 52 | Train Loss: 0.4047163 Vali Loss: 1.3012710 Test Loss: 0.3586292
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35884740948677063, mae:0.4078079164028168, rse:0.4907538890838623
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06367111206054688 GB
Epoch: 1 cost time: 2.122980833053589
Epoch: 1, Steps: 52 | Train Loss: 0.6935499 Vali Loss: 2.1267476 Test Loss: 1.3731271
Validation loss decreased (inf --> 2.126748).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 2 cost time: 0.7436120510101318
Epoch: 2, Steps: 52 | Train Loss: 0.5942994 Vali Loss: 1.5413983 Test Loss: 0.6371893
Validation loss decreased (2.126748 --> 1.541398).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 3 cost time: 0.7488751411437988
Epoch: 3, Steps: 52 | Train Loss: 0.4684809 Vali Loss: 1.3777204 Test Loss: 0.4099193
Validation loss decreased (1.541398 --> 1.377720).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 4 cost time: 0.7509984970092773
Epoch: 4, Steps: 52 | Train Loss: 0.4372000 Vali Loss: 1.3694594 Test Loss: 0.3971137
Validation loss decreased (1.377720 --> 1.369459).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 5 cost time: 0.7529923915863037
Epoch: 5, Steps: 52 | Train Loss: 0.4297079 Vali Loss: 1.3497062 Test Loss: 0.3843664
Validation loss decreased (1.369459 --> 1.349706).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 6 cost time: 1.6657397747039795
Epoch: 6, Steps: 52 | Train Loss: 0.4228417 Vali Loss: 1.3313183 Test Loss: 0.3780540
Validation loss decreased (1.349706 --> 1.331318).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 7 cost time: 1.6686968803405762
Epoch: 7, Steps: 52 | Train Loss: 0.4186668 Vali Loss: 1.3355720 Test Loss: 0.3743930
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 8 cost time: 1.6730563640594482
Epoch: 8, Steps: 52 | Train Loss: 0.4168100 Vali Loss: 1.3175828 Test Loss: 0.3711081
Validation loss decreased (1.331318 --> 1.317583).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 9 cost time: 1.6685235500335693
Epoch: 9, Steps: 52 | Train Loss: 0.4127484 Vali Loss: 1.3213843 Test Loss: 0.3695160
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 10 cost time: 1.6780028343200684
Epoch: 10, Steps: 52 | Train Loss: 0.4118610 Vali Loss: 1.3104191 Test Loss: 0.3668536
Validation loss decreased (1.317583 --> 1.310419).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 11 cost time: 1.6704959869384766
Epoch: 11, Steps: 52 | Train Loss: 0.4111865 Vali Loss: 1.3115952 Test Loss: 0.3673196
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 12 cost time: 1.679023265838623
Epoch: 12, Steps: 52 | Train Loss: 0.4090081 Vali Loss: 1.3134918 Test Loss: 0.3656750
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 13 cost time: 1.6686699390411377
Epoch: 13, Steps: 52 | Train Loss: 0.4079145 Vali Loss: 1.3072157 Test Loss: 0.3651031
Validation loss decreased (1.310419 --> 1.307216).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 14 cost time: 1.6757519245147705
Epoch: 14, Steps: 52 | Train Loss: 0.4072494 Vali Loss: 1.2970362 Test Loss: 0.3654003
Validation loss decreased (1.307216 --> 1.297036).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 15 cost time: 1.682762622833252
Epoch: 15, Steps: 52 | Train Loss: 0.4064038 Vali Loss: 1.3031204 Test Loss: 0.3647096
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 16 cost time: 1.6769936084747314
Epoch: 16, Steps: 52 | Train Loss: 0.4049953 Vali Loss: 1.3047422 Test Loss: 0.3638453
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 17 cost time: 1.6746418476104736
Epoch: 17, Steps: 52 | Train Loss: 0.4040292 Vali Loss: 1.3047544 Test Loss: 0.3638273
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 18 cost time: 1.6674590110778809
Epoch: 18, Steps: 52 | Train Loss: 0.4055453 Vali Loss: 1.2947146 Test Loss: 0.3640448
Validation loss decreased (1.297036 --> 1.294715).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 19 cost time: 1.6744041442871094
Epoch: 19, Steps: 52 | Train Loss: 0.4046467 Vali Loss: 1.3005214 Test Loss: 0.3637368
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 20 cost time: 1.6797568798065186
Epoch: 20, Steps: 52 | Train Loss: 0.4037132 Vali Loss: 1.2992613 Test Loss: 0.3631971
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 21 cost time: 1.6743056774139404
Epoch: 21, Steps: 52 | Train Loss: 0.4039074 Vali Loss: 1.3002892 Test Loss: 0.3633466
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 22 cost time: 1.6776585578918457
Epoch: 22, Steps: 52 | Train Loss: 0.4033963 Vali Loss: 1.2987511 Test Loss: 0.3639750
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 23 cost time: 1.6852281093597412
Epoch: 23, Steps: 52 | Train Loss: 0.4028763 Vali Loss: 1.2966716 Test Loss: 0.3641848
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 24 cost time: 1.6689631938934326
Epoch: 24, Steps: 52 | Train Loss: 0.4041156 Vali Loss: 1.2940245 Test Loss: 0.3637134
Validation loss decreased (1.294715 --> 1.294024).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 25 cost time: 1.6746184825897217
Epoch: 25, Steps: 52 | Train Loss: 0.4029636 Vali Loss: 1.2993971 Test Loss: 0.3629607
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 26 cost time: 1.6743817329406738
Epoch: 26, Steps: 52 | Train Loss: 0.4037055 Vali Loss: 1.2944449 Test Loss: 0.3628926
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 27 cost time: 1.6651277542114258
Epoch: 27, Steps: 52 | Train Loss: 0.4028491 Vali Loss: 1.2976198 Test Loss: 0.3632772
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 28 cost time: 1.6733388900756836
Epoch: 28, Steps: 52 | Train Loss: 0.4004008 Vali Loss: 1.2995808 Test Loss: 0.3625505
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 29 cost time: 1.6772329807281494
Epoch: 29, Steps: 52 | Train Loss: 0.4017240 Vali Loss: 1.2950659 Test Loss: 0.3636564
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 30 cost time: 1.6707637310028076
Epoch: 30, Steps: 52 | Train Loss: 0.4000608 Vali Loss: 1.2855031 Test Loss: 0.3641180
Validation loss decreased (1.294024 --> 1.285503).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 31 cost time: 1.6719160079956055
Epoch: 31, Steps: 52 | Train Loss: 0.4029705 Vali Loss: 1.2945666 Test Loss: 0.3631894
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 32 cost time: 1.6695311069488525
Epoch: 32, Steps: 52 | Train Loss: 0.4022790 Vali Loss: 1.2907312 Test Loss: 0.3632119
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 33 cost time: 1.6773536205291748
Epoch: 33, Steps: 52 | Train Loss: 0.4026143 Vali Loss: 1.2962248 Test Loss: 0.3619306
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 34 cost time: 1.676976203918457
Epoch: 34, Steps: 52 | Train Loss: 0.4027918 Vali Loss: 1.2861108 Test Loss: 0.3621894
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 35 cost time: 1.6784577369689941
Epoch: 35, Steps: 52 | Train Loss: 0.4022691 Vali Loss: 1.2992600 Test Loss: 0.3632827
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 36 cost time: 1.6755638122558594
Epoch: 36, Steps: 52 | Train Loss: 0.4026805 Vali Loss: 1.2931890 Test Loss: 0.3636491
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 37 cost time: 1.6737589836120605
Epoch: 37, Steps: 52 | Train Loss: 0.4021229 Vali Loss: 1.2947311 Test Loss: 0.3624918
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 38 cost time: 1.6724658012390137
Epoch: 38, Steps: 52 | Train Loss: 0.4011692 Vali Loss: 1.2974417 Test Loss: 0.3626668
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 39 cost time: 1.6745045185089111
Epoch: 39, Steps: 52 | Train Loss: 0.4016345 Vali Loss: 1.2992768 Test Loss: 0.3626497
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 40 cost time: 1.6760785579681396
Epoch: 40, Steps: 52 | Train Loss: 0.4021690 Vali Loss: 1.2962420 Test Loss: 0.3623730
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 41 cost time: 1.678846836090088
Epoch: 41, Steps: 52 | Train Loss: 0.4002112 Vali Loss: 1.2975976 Test Loss: 0.3633242
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 42 cost time: 1.6745009422302246
Epoch: 42, Steps: 52 | Train Loss: 0.4010580 Vali Loss: 1.2933700 Test Loss: 0.3630638
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 43 cost time: 1.679262399673462
Epoch: 43, Steps: 52 | Train Loss: 0.4018275 Vali Loss: 1.2945087 Test Loss: 0.3629420
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 44 cost time: 1.6781892776489258
Epoch: 44, Steps: 52 | Train Loss: 0.3997224 Vali Loss: 1.2970543 Test Loss: 0.3621771
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 45 cost time: 1.6747121810913086
Epoch: 45, Steps: 52 | Train Loss: 0.4003710 Vali Loss: 1.2996986 Test Loss: 0.3624106
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 46 cost time: 1.6666061878204346
Epoch: 46, Steps: 52 | Train Loss: 0.3994348 Vali Loss: 1.2859619 Test Loss: 0.3633632
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 47 cost time: 1.6780762672424316
Epoch: 47, Steps: 52 | Train Loss: 0.4012422 Vali Loss: 1.2984517 Test Loss: 0.3634427
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 48 cost time: 1.6780645847320557
Epoch: 48, Steps: 52 | Train Loss: 0.4001405 Vali Loss: 1.2916039 Test Loss: 0.3627120
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 49 cost time: 1.680833101272583
Epoch: 49, Steps: 52 | Train Loss: 0.4016395 Vali Loss: 1.2916591 Test Loss: 0.3634521
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 50 cost time: 1.669386863708496
Epoch: 50, Steps: 52 | Train Loss: 0.4002169 Vali Loss: 1.2937315 Test Loss: 0.3629887
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 51 cost time: 1.6735918521881104
Epoch: 51, Steps: 52 | Train Loss: 0.4023787 Vali Loss: 1.2947619 Test Loss: 0.3630773
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 52 cost time: 1.6751420497894287
Epoch: 52, Steps: 52 | Train Loss: 0.4001120 Vali Loss: 1.2951901 Test Loss: 0.3630183
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 53 cost time: 1.6836330890655518
Epoch: 53, Steps: 52 | Train Loss: 0.4011853 Vali Loss: 1.2983387 Test Loss: 0.3628438
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 54 cost time: 1.6716270446777344
Epoch: 54, Steps: 52 | Train Loss: 0.4009692 Vali Loss: 1.2990506 Test Loss: 0.3632128
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 55 cost time: 1.6719892024993896
Epoch: 55, Steps: 52 | Train Loss: 0.4014519 Vali Loss: 1.2935998 Test Loss: 0.3627553
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 56 cost time: 1.6747140884399414
Epoch: 56, Steps: 52 | Train Loss: 0.4007311 Vali Loss: 1.2888871 Test Loss: 0.3632569
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 57 cost time: 1.6673519611358643
Epoch: 57, Steps: 52 | Train Loss: 0.4014542 Vali Loss: 1.2954093 Test Loss: 0.3631306
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 58 cost time: 1.6698932647705078
Epoch: 58, Steps: 52 | Train Loss: 0.4010557 Vali Loss: 1.2926118 Test Loss: 0.3636660
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 59 cost time: 1.6631605625152588
Epoch: 59, Steps: 52 | Train Loss: 0.4005853 Vali Loss: 1.2949953 Test Loss: 0.3637953
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 60 cost time: 1.6793336868286133
Epoch: 60, Steps: 52 | Train Loss: 0.4006857 Vali Loss: 1.2882839 Test Loss: 0.3640848
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3641180098056793, mae:0.4145658016204834, rse:0.49434471130371094
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05749082565307617 GB
Epoch: 1 cost time: 2.1394224166870117
Epoch: 1, Steps: 52 | Train Loss: 0.7587920 Vali Loss: 2.1998329 Test Loss: 1.4352015
Validation loss decreased (inf --> 2.199833).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 2 cost time: 0.7184112071990967
Epoch: 2, Steps: 52 | Train Loss: 0.6915622 Vali Loss: 1.8915794 Test Loss: 1.0882043
Validation loss decreased (2.199833 --> 1.891579).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 3 cost time: 0.7117514610290527
Epoch: 3, Steps: 52 | Train Loss: 0.5950509 Vali Loss: 1.6776888 Test Loss: 0.8230845
Validation loss decreased (1.891579 --> 1.677689).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 4 cost time: 0.7190005779266357
Epoch: 4, Steps: 52 | Train Loss: 0.5282553 Vali Loss: 1.5369877 Test Loss: 0.6258144
Validation loss decreased (1.677689 --> 1.536988).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 5 cost time: 0.7104058265686035
Epoch: 5, Steps: 52 | Train Loss: 0.4876584 Vali Loss: 1.4630854 Test Loss: 0.5338749
Validation loss decreased (1.536988 --> 1.463085).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 6 cost time: 1.384782075881958
Epoch: 6, Steps: 52 | Train Loss: 0.4653307 Vali Loss: 1.4326751 Test Loss: 0.4845203
Validation loss decreased (1.463085 --> 1.432675).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 7 cost time: 1.589369535446167
Epoch: 7, Steps: 52 | Train Loss: 0.4540253 Vali Loss: 1.3938069 Test Loss: 0.4551848
Validation loss decreased (1.432675 --> 1.393807).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 8 cost time: 1.5909168720245361
Epoch: 8, Steps: 52 | Train Loss: 0.4440864 Vali Loss: 1.3924205 Test Loss: 0.4357906
Validation loss decreased (1.393807 --> 1.392421).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 9 cost time: 1.587313175201416
Epoch: 9, Steps: 52 | Train Loss: 0.4424754 Vali Loss: 1.3703185 Test Loss: 0.4246594
Validation loss decreased (1.392421 --> 1.370319).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 10 cost time: 1.589151382446289
Epoch: 10, Steps: 52 | Train Loss: 0.4356953 Vali Loss: 1.3726203 Test Loss: 0.4144546
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 11 cost time: 1.600071668624878
Epoch: 11, Steps: 52 | Train Loss: 0.4332247 Vali Loss: 1.3657565 Test Loss: 0.4071487
Validation loss decreased (1.370319 --> 1.365757).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 12 cost time: 1.5793538093566895
Epoch: 12, Steps: 52 | Train Loss: 0.4299298 Vali Loss: 1.3468176 Test Loss: 0.4021365
Validation loss decreased (1.365757 --> 1.346818).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 13 cost time: 1.5944149494171143
Epoch: 13, Steps: 52 | Train Loss: 0.4268843 Vali Loss: 1.3489344 Test Loss: 0.3973647
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 14 cost time: 1.5944914817810059
Epoch: 14, Steps: 52 | Train Loss: 0.4251124 Vali Loss: 1.3380401 Test Loss: 0.3940146
Validation loss decreased (1.346818 --> 1.338040).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 15 cost time: 1.583289384841919
Epoch: 15, Steps: 52 | Train Loss: 0.4256827 Vali Loss: 1.3451889 Test Loss: 0.3905115
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 16 cost time: 1.5923261642456055
Epoch: 16, Steps: 52 | Train Loss: 0.4246799 Vali Loss: 1.3444018 Test Loss: 0.3882475
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 17 cost time: 1.5935580730438232
Epoch: 17, Steps: 52 | Train Loss: 0.4245707 Vali Loss: 1.3394722 Test Loss: 0.3862659
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 18 cost time: 1.5773200988769531
Epoch: 18, Steps: 52 | Train Loss: 0.4212869 Vali Loss: 1.3369398 Test Loss: 0.3842384
Validation loss decreased (1.338040 --> 1.336940).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 19 cost time: 1.5935313701629639
Epoch: 19, Steps: 52 | Train Loss: 0.4198813 Vali Loss: 1.3332881 Test Loss: 0.3830275
Validation loss decreased (1.336940 --> 1.333288).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 20 cost time: 1.5896778106689453
Epoch: 20, Steps: 52 | Train Loss: 0.4214840 Vali Loss: 1.3320246 Test Loss: 0.3818557
Validation loss decreased (1.333288 --> 1.332025).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 21 cost time: 1.5845186710357666
Epoch: 21, Steps: 52 | Train Loss: 0.4202636 Vali Loss: 1.3318293 Test Loss: 0.3806714
Validation loss decreased (1.332025 --> 1.331829).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 22 cost time: 1.5920124053955078
Epoch: 22, Steps: 52 | Train Loss: 0.4199830 Vali Loss: 1.3291051 Test Loss: 0.3803838
Validation loss decreased (1.331829 --> 1.329105).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 23 cost time: 1.5960934162139893
Epoch: 23, Steps: 52 | Train Loss: 0.4186912 Vali Loss: 1.3356786 Test Loss: 0.3795542
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 24 cost time: 1.5812513828277588
Epoch: 24, Steps: 52 | Train Loss: 0.4183546 Vali Loss: 1.3284324 Test Loss: 0.3790818
Validation loss decreased (1.329105 --> 1.328432).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 25 cost time: 1.5981523990631104
Epoch: 25, Steps: 52 | Train Loss: 0.4180330 Vali Loss: 1.3309047 Test Loss: 0.3778044
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 26 cost time: 1.5937764644622803
Epoch: 26, Steps: 52 | Train Loss: 0.4197747 Vali Loss: 1.3174620 Test Loss: 0.3770813
Validation loss decreased (1.328432 --> 1.317462).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 27 cost time: 1.5804524421691895
Epoch: 27, Steps: 52 | Train Loss: 0.4166355 Vali Loss: 1.3283393 Test Loss: 0.3769244
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 28 cost time: 1.593156099319458
Epoch: 28, Steps: 52 | Train Loss: 0.4164727 Vali Loss: 1.3310437 Test Loss: 0.3762653
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 29 cost time: 1.5974295139312744
Epoch: 29, Steps: 52 | Train Loss: 0.4170663 Vali Loss: 1.3244965 Test Loss: 0.3762235
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 30 cost time: 1.579808235168457
Epoch: 30, Steps: 52 | Train Loss: 0.4173186 Vali Loss: 1.3241378 Test Loss: 0.3759601
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 31 cost time: 1.5954203605651855
Epoch: 31, Steps: 52 | Train Loss: 0.4177280 Vali Loss: 1.3269272 Test Loss: 0.3751133
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 32 cost time: 1.586322546005249
Epoch: 32, Steps: 52 | Train Loss: 0.4155034 Vali Loss: 1.3241696 Test Loss: 0.3751218
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 33 cost time: 1.5789811611175537
Epoch: 33, Steps: 52 | Train Loss: 0.4164289 Vali Loss: 1.3255420 Test Loss: 0.3746291
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 34 cost time: 1.5855131149291992
Epoch: 34, Steps: 52 | Train Loss: 0.4173133 Vali Loss: 1.3297912 Test Loss: 0.3753263
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 35 cost time: 1.5916759967803955
Epoch: 35, Steps: 52 | Train Loss: 0.4170804 Vali Loss: 1.3238189 Test Loss: 0.3748103
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 36 cost time: 1.5833241939544678
Epoch: 36, Steps: 52 | Train Loss: 0.4173848 Vali Loss: 1.3240151 Test Loss: 0.3745194
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 37 cost time: 1.5969791412353516
Epoch: 37, Steps: 52 | Train Loss: 0.4170102 Vali Loss: 1.3262937 Test Loss: 0.3742799
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 38 cost time: 1.5866734981536865
Epoch: 38, Steps: 52 | Train Loss: 0.4161312 Vali Loss: 1.3258865 Test Loss: 0.3743346
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 39 cost time: 1.5749928951263428
Epoch: 39, Steps: 52 | Train Loss: 0.4162493 Vali Loss: 1.3217405 Test Loss: 0.3741075
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 40 cost time: 1.5965983867645264
Epoch: 40, Steps: 52 | Train Loss: 0.4163223 Vali Loss: 1.3218321 Test Loss: 0.3730521
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 41 cost time: 1.587909460067749
Epoch: 41, Steps: 52 | Train Loss: 0.4144988 Vali Loss: 1.3263797 Test Loss: 0.3737897
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 42 cost time: 1.5782124996185303
Epoch: 42, Steps: 52 | Train Loss: 0.4146414 Vali Loss: 1.3287438 Test Loss: 0.3738137
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 43 cost time: 1.5919599533081055
Epoch: 43, Steps: 52 | Train Loss: 0.4159714 Vali Loss: 1.3191373 Test Loss: 0.3730841
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 44 cost time: 1.585794448852539
Epoch: 44, Steps: 52 | Train Loss: 0.4167549 Vali Loss: 1.3187302 Test Loss: 0.3732997
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 45 cost time: 1.5800275802612305
Epoch: 45, Steps: 52 | Train Loss: 0.4141375 Vali Loss: 1.3260434 Test Loss: 0.3732203
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 46 cost time: 1.5915935039520264
Epoch: 46, Steps: 52 | Train Loss: 0.4163325 Vali Loss: 1.3257899 Test Loss: 0.3731666
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 47 cost time: 1.5799028873443604
Epoch: 47, Steps: 52 | Train Loss: 0.4159211 Vali Loss: 1.3248589 Test Loss: 0.3730840
EarlyStopping counter: 21 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 48 cost time: 1.5792064666748047
Epoch: 48, Steps: 52 | Train Loss: 0.4154445 Vali Loss: 1.3281074 Test Loss: 0.3733002
EarlyStopping counter: 22 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 49 cost time: 1.5901570320129395
Epoch: 49, Steps: 52 | Train Loss: 0.4154326 Vali Loss: 1.3261073 Test Loss: 0.3729743
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 50 cost time: 1.5950145721435547
Epoch: 50, Steps: 52 | Train Loss: 0.4135251 Vali Loss: 1.3187976 Test Loss: 0.3729452
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 51 cost time: 1.5829830169677734
Epoch: 51, Steps: 52 | Train Loss: 0.4156138 Vali Loss: 1.3252521 Test Loss: 0.3732840
EarlyStopping counter: 25 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 52 cost time: 1.5922675132751465
Epoch: 52, Steps: 52 | Train Loss: 0.4158883 Vali Loss: 1.3209410 Test Loss: 0.3730334
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 53 cost time: 1.5996220111846924
Epoch: 53, Steps: 52 | Train Loss: 0.4154985 Vali Loss: 1.3236680 Test Loss: 0.3734186
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 54 cost time: 1.5789248943328857
Epoch: 54, Steps: 52 | Train Loss: 0.4139577 Vali Loss: 1.3180400 Test Loss: 0.3735638
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 55 cost time: 1.5895912647247314
Epoch: 55, Steps: 52 | Train Loss: 0.4153714 Vali Loss: 1.3173430 Test Loss: 0.3729869
Validation loss decreased (1.317462 --> 1.317343).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 56 cost time: 1.6006648540496826
Epoch: 56, Steps: 52 | Train Loss: 0.4144256 Vali Loss: 1.3155049 Test Loss: 0.3727962
Validation loss decreased (1.317343 --> 1.315505).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 57 cost time: 1.5846045017242432
Epoch: 57, Steps: 52 | Train Loss: 0.4170702 Vali Loss: 1.3209041 Test Loss: 0.3730645
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 58 cost time: 1.5960705280303955
Epoch: 58, Steps: 52 | Train Loss: 0.4159246 Vali Loss: 1.3247073 Test Loss: 0.3729969
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 59 cost time: 1.5931565761566162
Epoch: 59, Steps: 52 | Train Loss: 0.4163075 Vali Loss: 1.3229438 Test Loss: 0.3725850
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 60 cost time: 1.580754280090332
Epoch: 60, Steps: 52 | Train Loss: 0.4158319 Vali Loss: 1.3228929 Test Loss: 0.3728589
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3727961480617523, mae:0.42048773169517517, rse:0.5002009272575378
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06063699722290039 GB
Epoch: 1 cost time: 2.1283974647521973
Epoch: 1, Steps: 52 | Train Loss: 0.7074404 Vali Loss: 2.1355906 Test Loss: 1.3854254
Validation loss decreased (inf --> 2.135591).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 2 cost time: 0.7436268329620361
Epoch: 2, Steps: 52 | Train Loss: 0.5999409 Vali Loss: 1.6189029 Test Loss: 0.7507334
Validation loss decreased (2.135591 --> 1.618903).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 3 cost time: 0.7526144981384277
Epoch: 3, Steps: 52 | Train Loss: 0.4755773 Vali Loss: 1.3963358 Test Loss: 0.4241940
Validation loss decreased (1.618903 --> 1.396336).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 4 cost time: 0.7462208271026611
Epoch: 4, Steps: 52 | Train Loss: 0.4398747 Vali Loss: 1.3784564 Test Loss: 0.4068042
Validation loss decreased (1.396336 --> 1.378456).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 5 cost time: 0.742767333984375
Epoch: 5, Steps: 52 | Train Loss: 0.4312521 Vali Loss: 1.3598577 Test Loss: 0.3920407
Validation loss decreased (1.378456 --> 1.359858).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 6 cost time: 1.6389832496643066
Epoch: 6, Steps: 52 | Train Loss: 0.4256025 Vali Loss: 1.3444033 Test Loss: 0.3840198
Validation loss decreased (1.359858 --> 1.344403).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 7 cost time: 1.6418182849884033
Epoch: 7, Steps: 52 | Train Loss: 0.4199393 Vali Loss: 1.3398678 Test Loss: 0.3773690
Validation loss decreased (1.344403 --> 1.339868).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 8 cost time: 1.650754690170288
Epoch: 8, Steps: 52 | Train Loss: 0.4190815 Vali Loss: 1.3263960 Test Loss: 0.3732886
Validation loss decreased (1.339868 --> 1.326396).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 9 cost time: 1.6518750190734863
Epoch: 9, Steps: 52 | Train Loss: 0.4165498 Vali Loss: 1.3220031 Test Loss: 0.3696513
Validation loss decreased (1.326396 --> 1.322003).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 10 cost time: 1.6539669036865234
Epoch: 10, Steps: 52 | Train Loss: 0.4141799 Vali Loss: 1.3206391 Test Loss: 0.3666194
Validation loss decreased (1.322003 --> 1.320639).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 11 cost time: 1.6611690521240234
Epoch: 11, Steps: 52 | Train Loss: 0.4132905 Vali Loss: 1.3110623 Test Loss: 0.3644167
Validation loss decreased (1.320639 --> 1.311062).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 12 cost time: 1.6480865478515625
Epoch: 12, Steps: 52 | Train Loss: 0.4109940 Vali Loss: 1.3141477 Test Loss: 0.3628802
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 13 cost time: 1.651329755783081
Epoch: 13, Steps: 52 | Train Loss: 0.4100437 Vali Loss: 1.3060591 Test Loss: 0.3616013
Validation loss decreased (1.311062 --> 1.306059).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 14 cost time: 1.6511666774749756
Epoch: 14, Steps: 52 | Train Loss: 0.4088405 Vali Loss: 1.3084466 Test Loss: 0.3607210
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 15 cost time: 1.6627459526062012
Epoch: 15, Steps: 52 | Train Loss: 0.4081630 Vali Loss: 1.3020377 Test Loss: 0.3598498
Validation loss decreased (1.306059 --> 1.302038).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 16 cost time: 1.6509130001068115
Epoch: 16, Steps: 52 | Train Loss: 0.4080557 Vali Loss: 1.3049439 Test Loss: 0.3586453
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 17 cost time: 1.6495721340179443
Epoch: 17, Steps: 52 | Train Loss: 0.4066232 Vali Loss: 1.3031145 Test Loss: 0.3575455
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 18 cost time: 1.653043270111084
Epoch: 18, Steps: 52 | Train Loss: 0.4081063 Vali Loss: 1.3027129 Test Loss: 0.3567290
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 19 cost time: 1.646385908126831
Epoch: 19, Steps: 52 | Train Loss: 0.4066538 Vali Loss: 1.3004270 Test Loss: 0.3560804
Validation loss decreased (1.302038 --> 1.300427).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 20 cost time: 1.6622014045715332
Epoch: 20, Steps: 52 | Train Loss: 0.4061522 Vali Loss: 1.2991436 Test Loss: 0.3559131
Validation loss decreased (1.300427 --> 1.299144).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 21 cost time: 1.6460258960723877
Epoch: 21, Steps: 52 | Train Loss: 0.4076997 Vali Loss: 1.3038056 Test Loss: 0.3560505
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 22 cost time: 1.653080701828003
Epoch: 22, Steps: 52 | Train Loss: 0.4057874 Vali Loss: 1.3036513 Test Loss: 0.3555357
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 23 cost time: 1.6480493545532227
Epoch: 23, Steps: 52 | Train Loss: 0.4048131 Vali Loss: 1.2995458 Test Loss: 0.3558050
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 24 cost time: 1.6647846698760986
Epoch: 24, Steps: 52 | Train Loss: 0.4048524 Vali Loss: 1.2950299 Test Loss: 0.3550729
Validation loss decreased (1.299144 --> 1.295030).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 25 cost time: 1.6440412998199463
Epoch: 25, Steps: 52 | Train Loss: 0.4039241 Vali Loss: 1.2959526 Test Loss: 0.3547205
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 26 cost time: 1.6508960723876953
Epoch: 26, Steps: 52 | Train Loss: 0.4049840 Vali Loss: 1.3007474 Test Loss: 0.3547124
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 27 cost time: 1.6478915214538574
Epoch: 27, Steps: 52 | Train Loss: 0.4036637 Vali Loss: 1.2986919 Test Loss: 0.3538535
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 28 cost time: 1.6644768714904785
Epoch: 28, Steps: 52 | Train Loss: 0.4035033 Vali Loss: 1.2857568 Test Loss: 0.3543540
Validation loss decreased (1.295030 --> 1.285757).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 29 cost time: 1.644500494003296
Epoch: 29, Steps: 52 | Train Loss: 0.4025942 Vali Loss: 1.3023403 Test Loss: 0.3541549
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 30 cost time: 1.6519825458526611
Epoch: 30, Steps: 52 | Train Loss: 0.4023250 Vali Loss: 1.2944136 Test Loss: 0.3542858
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 31 cost time: 1.6469857692718506
Epoch: 31, Steps: 52 | Train Loss: 0.4028314 Vali Loss: 1.2992238 Test Loss: 0.3541223
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 32 cost time: 1.6520936489105225
Epoch: 32, Steps: 52 | Train Loss: 0.4036593 Vali Loss: 1.2870603 Test Loss: 0.3537197
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 33 cost time: 1.6621274948120117
Epoch: 33, Steps: 52 | Train Loss: 0.4045241 Vali Loss: 1.2967336 Test Loss: 0.3537035
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 34 cost time: 1.6384360790252686
Epoch: 34, Steps: 52 | Train Loss: 0.4033406 Vali Loss: 1.2939696 Test Loss: 0.3538435
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 35 cost time: 1.6433942317962646
Epoch: 35, Steps: 52 | Train Loss: 0.4029695 Vali Loss: 1.2917905 Test Loss: 0.3534827
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 36 cost time: 1.643418312072754
Epoch: 36, Steps: 52 | Train Loss: 0.4041256 Vali Loss: 1.2937614 Test Loss: 0.3535008
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 37 cost time: 1.6464800834655762
Epoch: 37, Steps: 52 | Train Loss: 0.4034159 Vali Loss: 1.2943177 Test Loss: 0.3542986
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 38 cost time: 1.6498281955718994
Epoch: 38, Steps: 52 | Train Loss: 0.4021323 Vali Loss: 1.2985964 Test Loss: 0.3539222
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 39 cost time: 1.6598780155181885
Epoch: 39, Steps: 52 | Train Loss: 0.4036437 Vali Loss: 1.2849654 Test Loss: 0.3535506
Validation loss decreased (1.285757 --> 1.284965).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 40 cost time: 1.645315170288086
Epoch: 40, Steps: 52 | Train Loss: 0.4042722 Vali Loss: 1.2965059 Test Loss: 0.3532632
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 41 cost time: 1.6521470546722412
Epoch: 41, Steps: 52 | Train Loss: 0.4034311 Vali Loss: 1.2955797 Test Loss: 0.3535553
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 42 cost time: 1.64933443069458
Epoch: 42, Steps: 52 | Train Loss: 0.4033832 Vali Loss: 1.2907480 Test Loss: 0.3535573
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 43 cost time: 1.6490859985351562
Epoch: 43, Steps: 52 | Train Loss: 0.4024961 Vali Loss: 1.2953218 Test Loss: 0.3542259
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 44 cost time: 1.6497955322265625
Epoch: 44, Steps: 52 | Train Loss: 0.4024408 Vali Loss: 1.2934886 Test Loss: 0.3537573
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 45 cost time: 1.6494014263153076
Epoch: 45, Steps: 52 | Train Loss: 0.4029152 Vali Loss: 1.2861744 Test Loss: 0.3533866
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 46 cost time: 1.6593081951141357
Epoch: 46, Steps: 52 | Train Loss: 0.4032840 Vali Loss: 1.2956862 Test Loss: 0.3528165
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 47 cost time: 1.6486845016479492
Epoch: 47, Steps: 52 | Train Loss: 0.4020638 Vali Loss: 1.3009734 Test Loss: 0.3535053
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 48 cost time: 1.6550374031066895
Epoch: 48, Steps: 52 | Train Loss: 0.4027508 Vali Loss: 1.2957428 Test Loss: 0.3534882
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 49 cost time: 1.6525061130523682
Epoch: 49, Steps: 52 | Train Loss: 0.4028804 Vali Loss: 1.2910686 Test Loss: 0.3532685
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 50 cost time: 1.6588191986083984
Epoch: 50, Steps: 52 | Train Loss: 0.4026630 Vali Loss: 1.2910116 Test Loss: 0.3531708
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 51 cost time: 1.6504631042480469
Epoch: 51, Steps: 52 | Train Loss: 0.4023110 Vali Loss: 1.2905443 Test Loss: 0.3531020
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 52 cost time: 1.6504554748535156
Epoch: 52, Steps: 52 | Train Loss: 0.4041706 Vali Loss: 1.2934780 Test Loss: 0.3535548
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 53 cost time: 1.650374174118042
Epoch: 53, Steps: 52 | Train Loss: 0.4034201 Vali Loss: 1.2928517 Test Loss: 0.3533552
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 54 cost time: 1.6619017124176025
Epoch: 54, Steps: 52 | Train Loss: 0.4032836 Vali Loss: 1.2990202 Test Loss: 0.3531149
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 55 cost time: 1.6434321403503418
Epoch: 55, Steps: 52 | Train Loss: 0.4038882 Vali Loss: 1.2971385 Test Loss: 0.3528987
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 56 cost time: 1.6473639011383057
Epoch: 56, Steps: 52 | Train Loss: 0.4025406 Vali Loss: 1.2972566 Test Loss: 0.3531185
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 57 cost time: 1.652230978012085
Epoch: 57, Steps: 52 | Train Loss: 0.4038659 Vali Loss: 1.2991762 Test Loss: 0.3527616
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 58 cost time: 1.645329475402832
Epoch: 58, Steps: 52 | Train Loss: 0.4022148 Vali Loss: 1.2995448 Test Loss: 0.3527279
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 59 cost time: 1.6551084518432617
Epoch: 59, Steps: 52 | Train Loss: 0.4019623 Vali Loss: 1.2883739 Test Loss: 0.3533136
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 60 cost time: 1.651984453201294
Epoch: 60, Steps: 52 | Train Loss: 0.4034547 Vali Loss: 1.2885588 Test Loss: 0.3530331
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3535505533218384, mae:0.40335360169410706, rse:0.4871184527873993
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06383180618286133 GB
Epoch: 1 cost time: 2.156524896621704
Epoch: 1, Steps: 52 | Train Loss: 0.6809693 Vali Loss: 2.1128979 Test Loss: 1.3282954
Validation loss decreased (inf --> 2.112898).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 2 cost time: 0.7679007053375244
Epoch: 2, Steps: 52 | Train Loss: 0.5725460 Vali Loss: 1.4891019 Test Loss: 0.5747085
Validation loss decreased (2.112898 --> 1.489102).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 3 cost time: 0.7653791904449463
Epoch: 3, Steps: 52 | Train Loss: 0.4573239 Vali Loss: 1.3847401 Test Loss: 0.4070743
Validation loss decreased (1.489102 --> 1.384740).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 4 cost time: 0.768028736114502
Epoch: 4, Steps: 52 | Train Loss: 0.4341829 Vali Loss: 1.3601463 Test Loss: 0.3941208
Validation loss decreased (1.384740 --> 1.360146).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 5 cost time: 0.779686450958252
Epoch: 5, Steps: 52 | Train Loss: 0.4265095 Vali Loss: 1.3523234 Test Loss: 0.3863027
Validation loss decreased (1.360146 --> 1.352323).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 6 cost time: 1.6861402988433838
Epoch: 6, Steps: 52 | Train Loss: 0.4220069 Vali Loss: 1.3367779 Test Loss: 0.3803734
Validation loss decreased (1.352323 --> 1.336778).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 7 cost time: 1.6951947212219238
Epoch: 7, Steps: 52 | Train Loss: 0.4193246 Vali Loss: 1.3403047 Test Loss: 0.3745744
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 8 cost time: 1.6968309879302979
Epoch: 8, Steps: 52 | Train Loss: 0.4160312 Vali Loss: 1.3268312 Test Loss: 0.3714288
Validation loss decreased (1.336778 --> 1.326831).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 9 cost time: 1.7001440525054932
Epoch: 9, Steps: 52 | Train Loss: 0.4143496 Vali Loss: 1.3309557 Test Loss: 0.3683614
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 10 cost time: 1.693082332611084
Epoch: 10, Steps: 52 | Train Loss: 0.4136031 Vali Loss: 1.3229178 Test Loss: 0.3668327
Validation loss decreased (1.326831 --> 1.322918).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 11 cost time: 1.7054986953735352
Epoch: 11, Steps: 52 | Train Loss: 0.4099201 Vali Loss: 1.3129649 Test Loss: 0.3645495
Validation loss decreased (1.322918 --> 1.312965).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 12 cost time: 1.6955244541168213
Epoch: 12, Steps: 52 | Train Loss: 0.4095385 Vali Loss: 1.3176712 Test Loss: 0.3643404
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 13 cost time: 1.70243501663208
Epoch: 13, Steps: 52 | Train Loss: 0.4109431 Vali Loss: 1.3147178 Test Loss: 0.3626435
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 14 cost time: 1.6940791606903076
Epoch: 14, Steps: 52 | Train Loss: 0.4099709 Vali Loss: 1.3115528 Test Loss: 0.3621948
Validation loss decreased (1.312965 --> 1.311553).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 15 cost time: 1.6973240375518799
Epoch: 15, Steps: 52 | Train Loss: 0.4068651 Vali Loss: 1.3129065 Test Loss: 0.3612136
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 16 cost time: 1.6964788436889648
Epoch: 16, Steps: 52 | Train Loss: 0.4063633 Vali Loss: 1.3149101 Test Loss: 0.3610670
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 17 cost time: 1.7020745277404785
Epoch: 17, Steps: 52 | Train Loss: 0.4067248 Vali Loss: 1.3155019 Test Loss: 0.3607890
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 18 cost time: 1.6977362632751465
Epoch: 18, Steps: 52 | Train Loss: 0.4081219 Vali Loss: 1.3023648 Test Loss: 0.3598154
Validation loss decreased (1.311553 --> 1.302365).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 19 cost time: 1.6953976154327393
Epoch: 19, Steps: 52 | Train Loss: 0.4061773 Vali Loss: 1.2992897 Test Loss: 0.3605992
Validation loss decreased (1.302365 --> 1.299290).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 20 cost time: 1.694627046585083
Epoch: 20, Steps: 52 | Train Loss: 0.4066264 Vali Loss: 1.3056659 Test Loss: 0.3597210
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 21 cost time: 1.6976118087768555
Epoch: 21, Steps: 52 | Train Loss: 0.4048333 Vali Loss: 1.2963705 Test Loss: 0.3599847
Validation loss decreased (1.299290 --> 1.296371).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 22 cost time: 1.7005743980407715
Epoch: 22, Steps: 52 | Train Loss: 0.4049084 Vali Loss: 1.3052325 Test Loss: 0.3595950
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 23 cost time: 1.6992073059082031
Epoch: 23, Steps: 52 | Train Loss: 0.4033852 Vali Loss: 1.3000906 Test Loss: 0.3599600
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 24 cost time: 1.7014760971069336
Epoch: 24, Steps: 52 | Train Loss: 0.4031514 Vali Loss: 1.3067670 Test Loss: 0.3595263
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 25 cost time: 1.6960713863372803
Epoch: 25, Steps: 52 | Train Loss: 0.4041495 Vali Loss: 1.2939067 Test Loss: 0.3592948
Validation loss decreased (1.296371 --> 1.293907).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 26 cost time: 1.7013263702392578
Epoch: 26, Steps: 52 | Train Loss: 0.4037676 Vali Loss: 1.3014405 Test Loss: 0.3597703
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 27 cost time: 1.6973323822021484
Epoch: 27, Steps: 52 | Train Loss: 0.4029664 Vali Loss: 1.3031669 Test Loss: 0.3584228
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 28 cost time: 1.6970975399017334
Epoch: 28, Steps: 52 | Train Loss: 0.4034575 Vali Loss: 1.3022481 Test Loss: 0.3589101
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 29 cost time: 1.6952767372131348
Epoch: 29, Steps: 52 | Train Loss: 0.4032446 Vali Loss: 1.3014739 Test Loss: 0.3583267
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 30 cost time: 1.70222806930542
Epoch: 30, Steps: 52 | Train Loss: 0.4020842 Vali Loss: 1.3027501 Test Loss: 0.3581563
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 31 cost time: 1.698718547821045
Epoch: 31, Steps: 52 | Train Loss: 0.4023890 Vali Loss: 1.2954810 Test Loss: 0.3585255
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 32 cost time: 1.7021994590759277
Epoch: 32, Steps: 52 | Train Loss: 0.4028431 Vali Loss: 1.2984183 Test Loss: 0.3577182
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 33 cost time: 1.6953589916229248
Epoch: 33, Steps: 52 | Train Loss: 0.4020665 Vali Loss: 1.3010405 Test Loss: 0.3575128
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 34 cost time: 1.699845314025879
Epoch: 34, Steps: 52 | Train Loss: 0.4014481 Vali Loss: 1.2957327 Test Loss: 0.3577744
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 35 cost time: 1.6968750953674316
Epoch: 35, Steps: 52 | Train Loss: 0.4032220 Vali Loss: 1.2968102 Test Loss: 0.3576208
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 36 cost time: 1.6997926235198975
Epoch: 36, Steps: 52 | Train Loss: 0.4018540 Vali Loss: 1.2950587 Test Loss: 0.3580599
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 37 cost time: 1.697176218032837
Epoch: 37, Steps: 52 | Train Loss: 0.4021631 Vali Loss: 1.3030283 Test Loss: 0.3584978
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 38 cost time: 1.694279670715332
Epoch: 38, Steps: 52 | Train Loss: 0.4014892 Vali Loss: 1.2992957 Test Loss: 0.3589300
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 39 cost time: 1.6952528953552246
Epoch: 39, Steps: 52 | Train Loss: 0.4021131 Vali Loss: 1.3069086 Test Loss: 0.3581479
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 40 cost time: 1.6908724308013916
Epoch: 40, Steps: 52 | Train Loss: 0.4015268 Vali Loss: 1.2974626 Test Loss: 0.3579115
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 41 cost time: 1.6996674537658691
Epoch: 41, Steps: 52 | Train Loss: 0.4024288 Vali Loss: 1.3034217 Test Loss: 0.3578491
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 42 cost time: 1.6966772079467773
Epoch: 42, Steps: 52 | Train Loss: 0.4014966 Vali Loss: 1.3042710 Test Loss: 0.3577345
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 43 cost time: 1.6976120471954346
Epoch: 43, Steps: 52 | Train Loss: 0.4013760 Vali Loss: 1.2989372 Test Loss: 0.3581359
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 44 cost time: 1.6962006092071533
Epoch: 44, Steps: 52 | Train Loss: 0.4023254 Vali Loss: 1.3070207 Test Loss: 0.3581358
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 45 cost time: 1.699446201324463
Epoch: 45, Steps: 52 | Train Loss: 0.4035083 Vali Loss: 1.3016369 Test Loss: 0.3582332
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 46 cost time: 1.6960363388061523
Epoch: 46, Steps: 52 | Train Loss: 0.4023069 Vali Loss: 1.2969971 Test Loss: 0.3587574
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 47 cost time: 1.700089931488037
Epoch: 47, Steps: 52 | Train Loss: 0.4013305 Vali Loss: 1.2954986 Test Loss: 0.3577494
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 48 cost time: 1.6959786415100098
Epoch: 48, Steps: 52 | Train Loss: 0.4022813 Vali Loss: 1.2964647 Test Loss: 0.3581516
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 49 cost time: 1.6962406635284424
Epoch: 49, Steps: 52 | Train Loss: 0.4026154 Vali Loss: 1.3021305 Test Loss: 0.3579156
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 50 cost time: 1.6944689750671387
Epoch: 50, Steps: 52 | Train Loss: 0.4011019 Vali Loss: 1.3016299 Test Loss: 0.3585298
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 51 cost time: 1.6971712112426758
Epoch: 51, Steps: 52 | Train Loss: 0.4033948 Vali Loss: 1.3019724 Test Loss: 0.3580081
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 52 cost time: 1.6951358318328857
Epoch: 52, Steps: 52 | Train Loss: 0.4025735 Vali Loss: 1.3050529 Test Loss: 0.3584285
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 53 cost time: 1.701312780380249
Epoch: 53, Steps: 52 | Train Loss: 0.4021554 Vali Loss: 1.2991233 Test Loss: 0.3579863
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 54 cost time: 1.6973187923431396
Epoch: 54, Steps: 52 | Train Loss: 0.4028032 Vali Loss: 1.3013103 Test Loss: 0.3579201
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 55 cost time: 1.6990375518798828
Epoch: 55, Steps: 52 | Train Loss: 0.4029560 Vali Loss: 1.2843907 Test Loss: 0.3575343
Validation loss decreased (1.293907 --> 1.284391).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 56 cost time: 1.6978907585144043
Epoch: 56, Steps: 52 | Train Loss: 0.4024257 Vali Loss: 1.2965573 Test Loss: 0.3578828
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 57 cost time: 1.6972472667694092
Epoch: 57, Steps: 52 | Train Loss: 0.4017145 Vali Loss: 1.2992609 Test Loss: 0.3578403
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 58 cost time: 1.6951055526733398
Epoch: 58, Steps: 52 | Train Loss: 0.4014695 Vali Loss: 1.3061574 Test Loss: 0.3579686
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 59 cost time: 1.6926498413085938
Epoch: 59, Steps: 52 | Train Loss: 0.4015373 Vali Loss: 1.2953415 Test Loss: 0.3577780
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 60 cost time: 1.6949973106384277
Epoch: 60, Steps: 52 | Train Loss: 0.4009029 Vali Loss: 1.2913588 Test Loss: 0.3574891
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3575342893600464, mae:0.4063531458377838, rse:0.4898551106452942
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.05765199661254883 GB
Epoch: 1 cost time: 2.0963313579559326
Epoch: 1, Steps: 52 | Train Loss: 0.7677765 Vali Loss: 2.2434082 Test Loss: 1.4760976
Validation loss decreased (inf --> 2.243408).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 2 cost time: 0.7186169624328613
Epoch: 2, Steps: 52 | Train Loss: 0.6945838 Vali Loss: 1.8977998 Test Loss: 1.0687032
Validation loss decreased (2.243408 --> 1.897800).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 3 cost time: 0.7163827419281006
Epoch: 3, Steps: 52 | Train Loss: 0.5885723 Vali Loss: 1.6467687 Test Loss: 0.7385570
Validation loss decreased (1.897800 --> 1.646769).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 4 cost time: 0.7229981422424316
Epoch: 4, Steps: 52 | Train Loss: 0.5162266 Vali Loss: 1.5157954 Test Loss: 0.5713933
Validation loss decreased (1.646769 --> 1.515795).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 5 cost time: 0.7136209011077881
Epoch: 5, Steps: 52 | Train Loss: 0.4807121 Vali Loss: 1.4649047 Test Loss: 0.4945660
Validation loss decreased (1.515795 --> 1.464905).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 6 cost time: 1.3981688022613525
Epoch: 6, Steps: 52 | Train Loss: 0.4586819 Vali Loss: 1.4251518 Test Loss: 0.4571016
Validation loss decreased (1.464905 --> 1.425152).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 7 cost time: 1.5934998989105225
Epoch: 7, Steps: 52 | Train Loss: 0.4460642 Vali Loss: 1.4092703 Test Loss: 0.4360175
Validation loss decreased (1.425152 --> 1.409270).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 8 cost time: 1.5943570137023926
Epoch: 8, Steps: 52 | Train Loss: 0.4421006 Vali Loss: 1.3801481 Test Loss: 0.4238169
Validation loss decreased (1.409270 --> 1.380148).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 9 cost time: 1.5950267314910889
Epoch: 9, Steps: 52 | Train Loss: 0.4344134 Vali Loss: 1.3813002 Test Loss: 0.4166919
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 10 cost time: 1.5934877395629883
Epoch: 10, Steps: 52 | Train Loss: 0.4309115 Vali Loss: 1.3674308 Test Loss: 0.4126805
Validation loss decreased (1.380148 --> 1.367431).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 11 cost time: 1.6034691333770752
Epoch: 11, Steps: 52 | Train Loss: 0.4269161 Vali Loss: 1.3634174 Test Loss: 0.4089192
Validation loss decreased (1.367431 --> 1.363417).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 12 cost time: 1.600102186203003
Epoch: 12, Steps: 52 | Train Loss: 0.4262997 Vali Loss: 1.3546820 Test Loss: 0.4068889
Validation loss decreased (1.363417 --> 1.354682).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 13 cost time: 1.590714931488037
Epoch: 13, Steps: 52 | Train Loss: 0.4246467 Vali Loss: 1.3565031 Test Loss: 0.4035546
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 14 cost time: 1.5996489524841309
Epoch: 14, Steps: 52 | Train Loss: 0.4227304 Vali Loss: 1.3549590 Test Loss: 0.4023414
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 15 cost time: 1.6012837886810303
Epoch: 15, Steps: 52 | Train Loss: 0.4208679 Vali Loss: 1.3554113 Test Loss: 0.4008718
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 16 cost time: 1.5850083827972412
Epoch: 16, Steps: 52 | Train Loss: 0.4205546 Vali Loss: 1.3526542 Test Loss: 0.3992942
Validation loss decreased (1.354682 --> 1.352654).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 17 cost time: 1.6030139923095703
Epoch: 17, Steps: 52 | Train Loss: 0.4193576 Vali Loss: 1.3481787 Test Loss: 0.3983831
Validation loss decreased (1.352654 --> 1.348179).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 18 cost time: 1.6014420986175537
Epoch: 18, Steps: 52 | Train Loss: 0.4189638 Vali Loss: 1.3445898 Test Loss: 0.3972272
Validation loss decreased (1.348179 --> 1.344590).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 19 cost time: 1.5986230373382568
Epoch: 19, Steps: 52 | Train Loss: 0.4170372 Vali Loss: 1.3428065 Test Loss: 0.3954150
Validation loss decreased (1.344590 --> 1.342806).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 20 cost time: 1.5835480690002441
Epoch: 20, Steps: 52 | Train Loss: 0.4161267 Vali Loss: 1.3330390 Test Loss: 0.3943486
Validation loss decreased (1.342806 --> 1.333039).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 21 cost time: 1.6037569046020508
Epoch: 21, Steps: 52 | Train Loss: 0.4176372 Vali Loss: 1.3408787 Test Loss: 0.3936768
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 22 cost time: 1.6036226749420166
Epoch: 22, Steps: 52 | Train Loss: 0.4178783 Vali Loss: 1.3399272 Test Loss: 0.3934712
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 23 cost time: 1.5947952270507812
Epoch: 23, Steps: 52 | Train Loss: 0.4160995 Vali Loss: 1.3242948 Test Loss: 0.3923203
Validation loss decreased (1.333039 --> 1.324295).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 24 cost time: 1.5897839069366455
Epoch: 24, Steps: 52 | Train Loss: 0.4154038 Vali Loss: 1.3251903 Test Loss: 0.3918813
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 25 cost time: 1.5934414863586426
Epoch: 25, Steps: 52 | Train Loss: 0.4145770 Vali Loss: 1.3333902 Test Loss: 0.3909875
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 26 cost time: 1.5908448696136475
Epoch: 26, Steps: 52 | Train Loss: 0.4165497 Vali Loss: 1.3342994 Test Loss: 0.3907090
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 27 cost time: 1.5940098762512207
Epoch: 27, Steps: 52 | Train Loss: 0.4146431 Vali Loss: 1.3351210 Test Loss: 0.3900854
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 28 cost time: 1.5989573001861572
Epoch: 28, Steps: 52 | Train Loss: 0.4162977 Vali Loss: 1.3178825 Test Loss: 0.3895646
Validation loss decreased (1.324295 --> 1.317883).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 29 cost time: 1.602048635482788
Epoch: 29, Steps: 52 | Train Loss: 0.4154946 Vali Loss: 1.3266441 Test Loss: 0.3892215
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 30 cost time: 1.5896599292755127
Epoch: 30, Steps: 52 | Train Loss: 0.4137662 Vali Loss: 1.3259025 Test Loss: 0.3890328
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 31 cost time: 1.6005771160125732
Epoch: 31, Steps: 52 | Train Loss: 0.4141611 Vali Loss: 1.3223876 Test Loss: 0.3887003
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 32 cost time: 1.6004371643066406
Epoch: 32, Steps: 52 | Train Loss: 0.4136906 Vali Loss: 1.3201504 Test Loss: 0.3878803
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 33 cost time: 1.5930142402648926
Epoch: 33, Steps: 52 | Train Loss: 0.4140901 Vali Loss: 1.3288330 Test Loss: 0.3870938
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 34 cost time: 1.5940091609954834
Epoch: 34, Steps: 52 | Train Loss: 0.4143150 Vali Loss: 1.3291093 Test Loss: 0.3877648
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 35 cost time: 1.6049911975860596
Epoch: 35, Steps: 52 | Train Loss: 0.4132522 Vali Loss: 1.3311898 Test Loss: 0.3870771
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 36 cost time: 1.5883793830871582
Epoch: 36, Steps: 52 | Train Loss: 0.4144373 Vali Loss: 1.3273991 Test Loss: 0.3872888
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 37 cost time: 1.606241226196289
Epoch: 37, Steps: 52 | Train Loss: 0.4135057 Vali Loss: 1.3333441 Test Loss: 0.3869605
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 38 cost time: 1.604407787322998
Epoch: 38, Steps: 52 | Train Loss: 0.4129054 Vali Loss: 1.3235903 Test Loss: 0.3867370
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 39 cost time: 1.5913164615631104
Epoch: 39, Steps: 52 | Train Loss: 0.4136173 Vali Loss: 1.3275616 Test Loss: 0.3866562
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 40 cost time: 1.595686674118042
Epoch: 40, Steps: 52 | Train Loss: 0.4124512 Vali Loss: 1.3278742 Test Loss: 0.3866981
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 41 cost time: 1.6039929389953613
Epoch: 41, Steps: 52 | Train Loss: 0.4127664 Vali Loss: 1.3253510 Test Loss: 0.3862434
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 42 cost time: 1.590930461883545
Epoch: 42, Steps: 52 | Train Loss: 0.4136664 Vali Loss: 1.3265791 Test Loss: 0.3863540
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 43 cost time: 1.6035423278808594
Epoch: 43, Steps: 52 | Train Loss: 0.4121013 Vali Loss: 1.3297151 Test Loss: 0.3864929
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 44 cost time: 1.6035268306732178
Epoch: 44, Steps: 52 | Train Loss: 0.4117905 Vali Loss: 1.3262720 Test Loss: 0.3857920
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 45 cost time: 1.5908119678497314
Epoch: 45, Steps: 52 | Train Loss: 0.4151764 Vali Loss: 1.3227576 Test Loss: 0.3860873
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 46 cost time: 1.6033742427825928
Epoch: 46, Steps: 52 | Train Loss: 0.4116018 Vali Loss: 1.3229630 Test Loss: 0.3859479
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 47 cost time: 1.6013507843017578
Epoch: 47, Steps: 52 | Train Loss: 0.4134875 Vali Loss: 1.3269035 Test Loss: 0.3860438
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 48 cost time: 1.5983622074127197
Epoch: 48, Steps: 52 | Train Loss: 0.4131627 Vali Loss: 1.3294822 Test Loss: 0.3859510
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 49 cost time: 1.607576847076416
Epoch: 49, Steps: 52 | Train Loss: 0.4143143 Vali Loss: 1.3257427 Test Loss: 0.3856982
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 50 cost time: 1.59852933883667
Epoch: 50, Steps: 52 | Train Loss: 0.4121102 Vali Loss: 1.3258522 Test Loss: 0.3856515
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 51 cost time: 1.5901780128479004
Epoch: 51, Steps: 52 | Train Loss: 0.4120324 Vali Loss: 1.3262196 Test Loss: 0.3854445
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 52 cost time: 1.594846248626709
Epoch: 52, Steps: 52 | Train Loss: 0.4113551 Vali Loss: 1.3221288 Test Loss: 0.3854454
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 53 cost time: 1.5964994430541992
Epoch: 53, Steps: 52 | Train Loss: 0.4129960 Vali Loss: 1.3286064 Test Loss: 0.3855376
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 54 cost time: 1.5861012935638428
Epoch: 54, Steps: 52 | Train Loss: 0.4129392 Vali Loss: 1.3236727 Test Loss: 0.3857194
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 55 cost time: 1.5984468460083008
Epoch: 55, Steps: 52 | Train Loss: 0.4126455 Vali Loss: 1.3252970 Test Loss: 0.3852478
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 56 cost time: 1.598891258239746
Epoch: 56, Steps: 52 | Train Loss: 0.4123934 Vali Loss: 1.3241006 Test Loss: 0.3853987
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 57 cost time: 1.5894274711608887
Epoch: 57, Steps: 52 | Train Loss: 0.4126331 Vali Loss: 1.3273745 Test Loss: 0.3850935
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 58 cost time: 1.597346305847168
Epoch: 58, Steps: 52 | Train Loss: 0.4121651 Vali Loss: 1.3221546 Test Loss: 0.3853289
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 59 cost time: 1.5987768173217773
Epoch: 59, Steps: 52 | Train Loss: 0.4120614 Vali Loss: 1.3225713 Test Loss: 0.3853651
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 60 cost time: 1.5902276039123535
Epoch: 60, Steps: 52 | Train Loss: 0.4129290 Vali Loss: 1.3267169 Test Loss: 0.3852497
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3895646333694458, mae:0.43446242809295654, rse:0.511326789855957
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06079816818237305 GB
Epoch: 1 cost time: 2.1132190227508545
Epoch: 1, Steps: 52 | Train Loss: 0.6940475 Vali Loss: 2.0840702 Test Loss: 1.3250184
Validation loss decreased (inf --> 2.084070).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 2 cost time: 0.7537143230438232
Epoch: 2, Steps: 52 | Train Loss: 0.5802042 Vali Loss: 1.5380197 Test Loss: 0.6140766
Validation loss decreased (2.084070 --> 1.538020).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 3 cost time: 0.7423899173736572
Epoch: 3, Steps: 52 | Train Loss: 0.4622329 Vali Loss: 1.3962935 Test Loss: 0.4270031
Validation loss decreased (1.538020 --> 1.396294).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 4 cost time: 0.7397878170013428
Epoch: 4, Steps: 52 | Train Loss: 0.4382671 Vali Loss: 1.3820186 Test Loss: 0.4129933
Validation loss decreased (1.396294 --> 1.382019).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 5 cost time: 0.7440006732940674
Epoch: 5, Steps: 52 | Train Loss: 0.4302371 Vali Loss: 1.3639784 Test Loss: 0.4005675
Validation loss decreased (1.382019 --> 1.363978).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 6 cost time: 1.6582021713256836
Epoch: 6, Steps: 52 | Train Loss: 0.4250459 Vali Loss: 1.3583499 Test Loss: 0.3925798
Validation loss decreased (1.363978 --> 1.358350).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 7 cost time: 1.6605224609375
Epoch: 7, Steps: 52 | Train Loss: 0.4210971 Vali Loss: 1.3397889 Test Loss: 0.3866018
Validation loss decreased (1.358350 --> 1.339789).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 8 cost time: 1.6589937210083008
Epoch: 8, Steps: 52 | Train Loss: 0.4192115 Vali Loss: 1.3327291 Test Loss: 0.3833650
Validation loss decreased (1.339789 --> 1.332729).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 9 cost time: 1.6577165126800537
Epoch: 9, Steps: 52 | Train Loss: 0.4155584 Vali Loss: 1.3272715 Test Loss: 0.3796777
Validation loss decreased (1.332729 --> 1.327271).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 10 cost time: 1.6759533882141113
Epoch: 10, Steps: 52 | Train Loss: 0.4128358 Vali Loss: 1.3281888 Test Loss: 0.3770832
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 11 cost time: 1.6571166515350342
Epoch: 11, Steps: 52 | Train Loss: 0.4124033 Vali Loss: 1.3202724 Test Loss: 0.3746076
Validation loss decreased (1.327271 --> 1.320272).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 12 cost time: 1.662071704864502
Epoch: 12, Steps: 52 | Train Loss: 0.4110870 Vali Loss: 1.3158262 Test Loss: 0.3748466
Validation loss decreased (1.320272 --> 1.315826).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 13 cost time: 1.6608774662017822
Epoch: 13, Steps: 52 | Train Loss: 0.4097954 Vali Loss: 1.3169580 Test Loss: 0.3716988
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 14 cost time: 1.6552224159240723
Epoch: 14, Steps: 52 | Train Loss: 0.4086989 Vali Loss: 1.3136345 Test Loss: 0.3720310
Validation loss decreased (1.315826 --> 1.313635).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 15 cost time: 1.6748542785644531
Epoch: 15, Steps: 52 | Train Loss: 0.4070328 Vali Loss: 1.3027794 Test Loss: 0.3703505
Validation loss decreased (1.313635 --> 1.302779).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 16 cost time: 1.6589477062225342
Epoch: 16, Steps: 52 | Train Loss: 0.4063598 Vali Loss: 1.3078941 Test Loss: 0.3710770
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 17 cost time: 1.659428358078003
Epoch: 17, Steps: 52 | Train Loss: 0.4069550 Vali Loss: 1.3116142 Test Loss: 0.3703201
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 18 cost time: 1.659174919128418
Epoch: 18, Steps: 52 | Train Loss: 0.4060688 Vali Loss: 1.3003521 Test Loss: 0.3692573
Validation loss decreased (1.302779 --> 1.300352).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 19 cost time: 1.6764180660247803
Epoch: 19, Steps: 52 | Train Loss: 0.4061385 Vali Loss: 1.3101747 Test Loss: 0.3695583
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 20 cost time: 1.6594040393829346
Epoch: 20, Steps: 52 | Train Loss: 0.4067638 Vali Loss: 1.3025032 Test Loss: 0.3687517
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 21 cost time: 1.6617467403411865
Epoch: 21, Steps: 52 | Train Loss: 0.4047098 Vali Loss: 1.3063186 Test Loss: 0.3684221
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 22 cost time: 1.6575427055358887
Epoch: 22, Steps: 52 | Train Loss: 0.4057901 Vali Loss: 1.3030672 Test Loss: 0.3689782
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 23 cost time: 1.6642494201660156
Epoch: 23, Steps: 52 | Train Loss: 0.4044708 Vali Loss: 1.3052793 Test Loss: 0.3697643
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 24 cost time: 1.6728556156158447
Epoch: 24, Steps: 52 | Train Loss: 0.4045196 Vali Loss: 1.3046407 Test Loss: 0.3682302
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 25 cost time: 1.655405044555664
Epoch: 25, Steps: 52 | Train Loss: 0.4054726 Vali Loss: 1.3084931 Test Loss: 0.3675516
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 26 cost time: 1.6540584564208984
Epoch: 26, Steps: 52 | Train Loss: 0.4045778 Vali Loss: 1.3048222 Test Loss: 0.3677697
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 27 cost time: 1.6642470359802246
Epoch: 27, Steps: 52 | Train Loss: 0.4021807 Vali Loss: 1.3028684 Test Loss: 0.3669852
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 28 cost time: 1.6544182300567627
Epoch: 28, Steps: 52 | Train Loss: 0.4036096 Vali Loss: 1.3076526 Test Loss: 0.3675574
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 29 cost time: 1.6745858192443848
Epoch: 29, Steps: 52 | Train Loss: 0.4036112 Vali Loss: 1.3064897 Test Loss: 0.3674017
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 30 cost time: 1.6569645404815674
Epoch: 30, Steps: 52 | Train Loss: 0.4032713 Vali Loss: 1.2979376 Test Loss: 0.3685231
Validation loss decreased (1.300352 --> 1.297938).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 31 cost time: 1.6633868217468262
Epoch: 31, Steps: 52 | Train Loss: 0.4017343 Vali Loss: 1.2945204 Test Loss: 0.3673753
Validation loss decreased (1.297938 --> 1.294520).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 32 cost time: 1.6585009098052979
Epoch: 32, Steps: 52 | Train Loss: 0.4036228 Vali Loss: 1.3054129 Test Loss: 0.3667954
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 33 cost time: 1.660508632659912
Epoch: 33, Steps: 52 | Train Loss: 0.4033619 Vali Loss: 1.2987649 Test Loss: 0.3668912
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 34 cost time: 1.6575706005096436
Epoch: 34, Steps: 52 | Train Loss: 0.4021808 Vali Loss: 1.2975805 Test Loss: 0.3657004
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 35 cost time: 1.6591873168945312
Epoch: 35, Steps: 52 | Train Loss: 0.4030446 Vali Loss: 1.3036031 Test Loss: 0.3670636
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 36 cost time: 1.6553888320922852
Epoch: 36, Steps: 52 | Train Loss: 0.4031025 Vali Loss: 1.3000301 Test Loss: 0.3668329
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 37 cost time: 1.6620888710021973
Epoch: 37, Steps: 52 | Train Loss: 0.4021905 Vali Loss: 1.3005915 Test Loss: 0.3665231
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 38 cost time: 1.6708612442016602
Epoch: 38, Steps: 52 | Train Loss: 0.4016220 Vali Loss: 1.2933350 Test Loss: 0.3667100
Validation loss decreased (1.294520 --> 1.293335).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 39 cost time: 1.6542067527770996
Epoch: 39, Steps: 52 | Train Loss: 0.4009024 Vali Loss: 1.3070623 Test Loss: 0.3666622
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 40 cost time: 1.6527025699615479
Epoch: 40, Steps: 52 | Train Loss: 0.4025064 Vali Loss: 1.3010180 Test Loss: 0.3660790
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 41 cost time: 1.6602487564086914
Epoch: 41, Steps: 52 | Train Loss: 0.4009668 Vali Loss: 1.3056555 Test Loss: 0.3658813
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 42 cost time: 1.6602232456207275
Epoch: 42, Steps: 52 | Train Loss: 0.4025847 Vali Loss: 1.3037503 Test Loss: 0.3659751
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 43 cost time: 1.655475378036499
Epoch: 43, Steps: 52 | Train Loss: 0.4009894 Vali Loss: 1.3006774 Test Loss: 0.3662088
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 44 cost time: 1.6582133769989014
Epoch: 44, Steps: 52 | Train Loss: 0.4015060 Vali Loss: 1.3065425 Test Loss: 0.3666642
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 45 cost time: 1.654977798461914
Epoch: 45, Steps: 52 | Train Loss: 0.4008652 Vali Loss: 1.3031763 Test Loss: 0.3663618
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 46 cost time: 1.654588222503662
Epoch: 46, Steps: 52 | Train Loss: 0.4032663 Vali Loss: 1.2970932 Test Loss: 0.3662187
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 47 cost time: 1.6683440208435059
Epoch: 47, Steps: 52 | Train Loss: 0.4012037 Vali Loss: 1.3042480 Test Loss: 0.3663540
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 48 cost time: 1.6558053493499756
Epoch: 48, Steps: 52 | Train Loss: 0.4011770 Vali Loss: 1.2974387 Test Loss: 0.3664469
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 49 cost time: 1.6543066501617432
Epoch: 49, Steps: 52 | Train Loss: 0.4021615 Vali Loss: 1.2953553 Test Loss: 0.3665586
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 50 cost time: 1.6571485996246338
Epoch: 50, Steps: 52 | Train Loss: 0.4017113 Vali Loss: 1.3029034 Test Loss: 0.3665573
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 51 cost time: 1.6687171459197998
Epoch: 51, Steps: 52 | Train Loss: 0.4014994 Vali Loss: 1.3037974 Test Loss: 0.3656968
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 52 cost time: 1.660749912261963
Epoch: 52, Steps: 52 | Train Loss: 0.4015269 Vali Loss: 1.3018565 Test Loss: 0.3662109
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 53 cost time: 1.6516709327697754
Epoch: 53, Steps: 52 | Train Loss: 0.4032313 Vali Loss: 1.2992222 Test Loss: 0.3670200
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 54 cost time: 1.6604137420654297
Epoch: 54, Steps: 52 | Train Loss: 0.4013794 Vali Loss: 1.3037734 Test Loss: 0.3670019
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 55 cost time: 1.6694228649139404
Epoch: 55, Steps: 52 | Train Loss: 0.4005789 Vali Loss: 1.3051755 Test Loss: 0.3667664
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 56 cost time: 1.6620609760284424
Epoch: 56, Steps: 52 | Train Loss: 0.4037997 Vali Loss: 1.2850698 Test Loss: 0.3654490
Validation loss decreased (1.293335 --> 1.285070).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 57 cost time: 1.660114049911499
Epoch: 57, Steps: 52 | Train Loss: 0.4026056 Vali Loss: 1.3047180 Test Loss: 0.3669467
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 58 cost time: 1.6603832244873047
Epoch: 58, Steps: 52 | Train Loss: 0.4009044 Vali Loss: 1.3060333 Test Loss: 0.3670968
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 59 cost time: 1.6702232360839844
Epoch: 59, Steps: 52 | Train Loss: 0.4022349 Vali Loss: 1.3034619 Test Loss: 0.3659719
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 60 cost time: 1.65838623046875
Epoch: 60, Steps: 52 | Train Loss: 0.4015885 Vali Loss: 1.2972295 Test Loss: 0.3661929
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3654489815235138, mae:0.41602471470832825, rse:0.49524736404418945
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06399297714233398 GB
Epoch: 1 cost time: 2.15995454788208
Epoch: 1, Steps: 52 | Train Loss: 0.6762716 Vali Loss: 2.0924776 Test Loss: 1.3276290
Validation loss decreased (inf --> 2.092478).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 2 cost time: 0.762641429901123
Epoch: 2, Steps: 52 | Train Loss: 0.5687590 Vali Loss: 1.4991726 Test Loss: 0.5414594
Validation loss decreased (2.092478 --> 1.499173).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 3 cost time: 0.7719683647155762
Epoch: 3, Steps: 52 | Train Loss: 0.4520439 Vali Loss: 1.3775547 Test Loss: 0.4193706
Validation loss decreased (1.499173 --> 1.377555).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 4 cost time: 0.8308379650115967
Epoch: 4, Steps: 52 | Train Loss: 0.4335122 Vali Loss: 1.3683450 Test Loss: 0.4047824
Validation loss decreased (1.377555 --> 1.368345).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 5 cost time: 0.9860894680023193
Epoch: 5, Steps: 52 | Train Loss: 0.4246213 Vali Loss: 1.3527597 Test Loss: 0.3941064
Validation loss decreased (1.368345 --> 1.352760).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 6 cost time: 1.6969494819641113
Epoch: 6, Steps: 52 | Train Loss: 0.4208024 Vali Loss: 1.3456937 Test Loss: 0.3884878
Validation loss decreased (1.352760 --> 1.345694).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 7 cost time: 1.6967320442199707
Epoch: 7, Steps: 52 | Train Loss: 0.4155183 Vali Loss: 1.3310226 Test Loss: 0.3820121
Validation loss decreased (1.345694 --> 1.331023).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 8 cost time: 1.7038547992706299
Epoch: 8, Steps: 52 | Train Loss: 0.4144733 Vali Loss: 1.3104153 Test Loss: 0.3780985
Validation loss decreased (1.331023 --> 1.310415).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 9 cost time: 1.6997981071472168
Epoch: 9, Steps: 52 | Train Loss: 0.4131355 Vali Loss: 1.3190570 Test Loss: 0.3758760
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 10 cost time: 1.7291984558105469
Epoch: 10, Steps: 52 | Train Loss: 0.4098279 Vali Loss: 1.3165464 Test Loss: 0.3727004
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 11 cost time: 1.7045924663543701
Epoch: 11, Steps: 52 | Train Loss: 0.4092270 Vali Loss: 1.3152518 Test Loss: 0.3708285
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 12 cost time: 1.7047820091247559
Epoch: 12, Steps: 52 | Train Loss: 0.4092738 Vali Loss: 1.3182869 Test Loss: 0.3708293
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 13 cost time: 1.7024574279785156
Epoch: 13, Steps: 52 | Train Loss: 0.4070255 Vali Loss: 1.3108169 Test Loss: 0.3687821
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 14 cost time: 1.7105193138122559
Epoch: 14, Steps: 52 | Train Loss: 0.4045053 Vali Loss: 1.3036520 Test Loss: 0.3686856
Validation loss decreased (1.310415 --> 1.303652).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 15 cost time: 1.6998958587646484
Epoch: 15, Steps: 52 | Train Loss: 0.4063629 Vali Loss: 1.3088123 Test Loss: 0.3677606
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 16 cost time: 1.69773530960083
Epoch: 16, Steps: 52 | Train Loss: 0.4038246 Vali Loss: 1.3037207 Test Loss: 0.3674852
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 17 cost time: 1.7047412395477295
Epoch: 17, Steps: 52 | Train Loss: 0.4041427 Vali Loss: 1.3019831 Test Loss: 0.3671613
Validation loss decreased (1.303652 --> 1.301983).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 18 cost time: 1.698608160018921
Epoch: 18, Steps: 52 | Train Loss: 0.4030657 Vali Loss: 1.3086894 Test Loss: 0.3666943
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 19 cost time: 1.7037854194641113
Epoch: 19, Steps: 52 | Train Loss: 0.4026185 Vali Loss: 1.3026371 Test Loss: 0.3658871
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 20 cost time: 1.6978282928466797
Epoch: 20, Steps: 52 | Train Loss: 0.4022292 Vali Loss: 1.3005151 Test Loss: 0.3673553
Validation loss decreased (1.301983 --> 1.300515).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 21 cost time: 1.6990931034088135
Epoch: 21, Steps: 52 | Train Loss: 0.4035043 Vali Loss: 1.3040272 Test Loss: 0.3661928
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 22 cost time: 1.7037444114685059
Epoch: 22, Steps: 52 | Train Loss: 0.4003132 Vali Loss: 1.3003354 Test Loss: 0.3670003
Validation loss decreased (1.300515 --> 1.300335).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 23 cost time: 1.721752643585205
Epoch: 23, Steps: 52 | Train Loss: 0.4019439 Vali Loss: 1.2952389 Test Loss: 0.3675466
Validation loss decreased (1.300335 --> 1.295239).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 24 cost time: 1.7101175785064697
Epoch: 24, Steps: 52 | Train Loss: 0.4015933 Vali Loss: 1.2971635 Test Loss: 0.3666652
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 25 cost time: 1.7088096141815186
Epoch: 25, Steps: 52 | Train Loss: 0.4011980 Vali Loss: 1.2989848 Test Loss: 0.3648457
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 26 cost time: 1.7027983665466309
Epoch: 26, Steps: 52 | Train Loss: 0.4015447 Vali Loss: 1.3041127 Test Loss: 0.3661818
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 27 cost time: 1.7067298889160156
Epoch: 27, Steps: 52 | Train Loss: 0.4015860 Vali Loss: 1.3052698 Test Loss: 0.3651946
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 28 cost time: 1.7048263549804688
Epoch: 28, Steps: 52 | Train Loss: 0.4006759 Vali Loss: 1.2869980 Test Loss: 0.3661278
Validation loss decreased (1.295239 --> 1.286998).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 29 cost time: 1.698882818222046
Epoch: 29, Steps: 52 | Train Loss: 0.4011305 Vali Loss: 1.3014678 Test Loss: 0.3653704
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 30 cost time: 1.7074496746063232
Epoch: 30, Steps: 52 | Train Loss: 0.4016306 Vali Loss: 1.3040884 Test Loss: 0.3668954
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 31 cost time: 1.7188332080841064
Epoch: 31, Steps: 52 | Train Loss: 0.4006948 Vali Loss: 1.2990587 Test Loss: 0.3651030
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 32 cost time: 1.700479507446289
Epoch: 32, Steps: 52 | Train Loss: 0.4012069 Vali Loss: 1.2991397 Test Loss: 0.3665124
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 33 cost time: 1.703125238418579
Epoch: 33, Steps: 52 | Train Loss: 0.4011657 Vali Loss: 1.2951028 Test Loss: 0.3653426
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 34 cost time: 1.7049529552459717
Epoch: 34, Steps: 52 | Train Loss: 0.4003568 Vali Loss: 1.2942973 Test Loss: 0.3653372
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 35 cost time: 1.7042582035064697
Epoch: 35, Steps: 52 | Train Loss: 0.4004594 Vali Loss: 1.3012624 Test Loss: 0.3658964
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 36 cost time: 1.7085027694702148
Epoch: 36, Steps: 52 | Train Loss: 0.4012685 Vali Loss: 1.3023664 Test Loss: 0.3658831
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 37 cost time: 1.7025420665740967
Epoch: 37, Steps: 52 | Train Loss: 0.4014596 Vali Loss: 1.2975249 Test Loss: 0.3648826
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 38 cost time: 1.708226203918457
Epoch: 38, Steps: 52 | Train Loss: 0.3988605 Vali Loss: 1.2951984 Test Loss: 0.3648895
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 39 cost time: 1.7019097805023193
Epoch: 39, Steps: 52 | Train Loss: 0.4001184 Vali Loss: 1.3032701 Test Loss: 0.3666171
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 40 cost time: 1.7010788917541504
Epoch: 40, Steps: 52 | Train Loss: 0.3994861 Vali Loss: 1.2861266 Test Loss: 0.3652656
Validation loss decreased (1.286998 --> 1.286127).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 41 cost time: 1.7028043270111084
Epoch: 41, Steps: 52 | Train Loss: 0.4014592 Vali Loss: 1.2958130 Test Loss: 0.3646052
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 42 cost time: 1.7024612426757812
Epoch: 42, Steps: 52 | Train Loss: 0.3990954 Vali Loss: 1.3049560 Test Loss: 0.3650537
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 43 cost time: 1.7035822868347168
Epoch: 43, Steps: 52 | Train Loss: 0.4000702 Vali Loss: 1.3040627 Test Loss: 0.3663511
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 44 cost time: 1.709012508392334
Epoch: 44, Steps: 52 | Train Loss: 0.4004828 Vali Loss: 1.3026203 Test Loss: 0.3660300
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 45 cost time: 1.705127477645874
Epoch: 45, Steps: 52 | Train Loss: 0.3976112 Vali Loss: 1.2974484 Test Loss: 0.3657407
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 46 cost time: 1.7091867923736572
Epoch: 46, Steps: 52 | Train Loss: 0.4001773 Vali Loss: 1.3012092 Test Loss: 0.3648702
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 47 cost time: 1.7107138633728027
Epoch: 47, Steps: 52 | Train Loss: 0.4005118 Vali Loss: 1.3026145 Test Loss: 0.3644767
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 48 cost time: 1.704014539718628
Epoch: 48, Steps: 52 | Train Loss: 0.4014965 Vali Loss: 1.2999659 Test Loss: 0.3655072
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 49 cost time: 1.7041051387786865
Epoch: 49, Steps: 52 | Train Loss: 0.4001074 Vali Loss: 1.2959527 Test Loss: 0.3644695
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 50 cost time: 1.709096908569336
Epoch: 50, Steps: 52 | Train Loss: 0.4000360 Vali Loss: 1.3005910 Test Loss: 0.3661494
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 51 cost time: 1.6980407238006592
Epoch: 51, Steps: 52 | Train Loss: 0.3994090 Vali Loss: 1.2984442 Test Loss: 0.3648373
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 52 cost time: 1.7049026489257812
Epoch: 52, Steps: 52 | Train Loss: 0.4002844 Vali Loss: 1.3012069 Test Loss: 0.3653651
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 53 cost time: 1.704791784286499
Epoch: 53, Steps: 52 | Train Loss: 0.4011400 Vali Loss: 1.3013227 Test Loss: 0.3654387
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 54 cost time: 1.7048847675323486
Epoch: 54, Steps: 52 | Train Loss: 0.3992352 Vali Loss: 1.3033564 Test Loss: 0.3643270
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 55 cost time: 1.7080585956573486
Epoch: 55, Steps: 52 | Train Loss: 0.4003562 Vali Loss: 1.3015807 Test Loss: 0.3651945
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 56 cost time: 1.7064874172210693
Epoch: 56, Steps: 52 | Train Loss: 0.3985078 Vali Loss: 1.3047082 Test Loss: 0.3658085
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 57 cost time: 1.706573486328125
Epoch: 57, Steps: 52 | Train Loss: 0.4002628 Vali Loss: 1.2899846 Test Loss: 0.3649902
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 58 cost time: 1.6990389823913574
Epoch: 58, Steps: 52 | Train Loss: 0.4001518 Vali Loss: 1.3011848 Test Loss: 0.3648172
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 59 cost time: 1.7054634094238281
Epoch: 59, Steps: 52 | Train Loss: 0.4005750 Vali Loss: 1.3043599 Test Loss: 0.3651778
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 60 cost time: 1.7017366886138916
Epoch: 60, Steps: 52 | Train Loss: 0.4014279 Vali Loss: 1.2980385 Test Loss: 0.3644124
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3652656078338623, mae:0.41648948192596436, rse:0.49512308835983276
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.053999900817871094 GB
Epoch: 1 cost time: 2.097853183746338
Epoch: 1, Steps: 52 | Train Loss: 0.8108392 Vali Loss: 2.3438680 Test Loss: 1.5700440
Validation loss decreased (inf --> 2.343868).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 2 cost time: 0.6920008659362793
Epoch: 2, Steps: 52 | Train Loss: 0.7346382 Vali Loss: 1.9665766 Test Loss: 1.1446663
Validation loss decreased (2.343868 --> 1.966577).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 3 cost time: 0.6933770179748535
Epoch: 3, Steps: 52 | Train Loss: 0.6262503 Vali Loss: 1.7321184 Test Loss: 0.8527197
Validation loss decreased (1.966577 --> 1.732118).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 4 cost time: 0.6897580623626709
Epoch: 4, Steps: 52 | Train Loss: 0.5520448 Vali Loss: 1.5706028 Test Loss: 0.6201923
Validation loss decreased (1.732118 --> 1.570603).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 5 cost time: 0.691354513168335
Epoch: 5, Steps: 52 | Train Loss: 0.5034943 Vali Loss: 1.4818782 Test Loss: 0.4866980
Validation loss decreased (1.570603 --> 1.481878).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 6 cost time: 1.145404577255249
Epoch: 6, Steps: 52 | Train Loss: 0.4772534 Vali Loss: 1.4323815 Test Loss: 0.4389846
Validation loss decreased (1.481878 --> 1.432382).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 7 cost time: 1.522780418395996
Epoch: 7, Steps: 52 | Train Loss: 0.4631012 Vali Loss: 1.4084969 Test Loss: 0.4199383
Validation loss decreased (1.432382 --> 1.408497).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 8 cost time: 1.5316100120544434
Epoch: 8, Steps: 52 | Train Loss: 0.4544127 Vali Loss: 1.4032756 Test Loss: 0.4077759
Validation loss decreased (1.408497 --> 1.403276).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 9 cost time: 1.536909818649292
Epoch: 9, Steps: 52 | Train Loss: 0.4479843 Vali Loss: 1.3887843 Test Loss: 0.3983722
Validation loss decreased (1.403276 --> 1.388784).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 10 cost time: 1.5332915782928467
Epoch: 10, Steps: 52 | Train Loss: 0.4430609 Vali Loss: 1.3847543 Test Loss: 0.3928732
Validation loss decreased (1.388784 --> 1.384754).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 11 cost time: 1.5326952934265137
Epoch: 11, Steps: 52 | Train Loss: 0.4384976 Vali Loss: 1.3689682 Test Loss: 0.3885604
Validation loss decreased (1.384754 --> 1.368968).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 12 cost time: 1.5390253067016602
Epoch: 12, Steps: 52 | Train Loss: 0.4361411 Vali Loss: 1.3721867 Test Loss: 0.3862772
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 13 cost time: 1.540022850036621
Epoch: 13, Steps: 52 | Train Loss: 0.4325561 Vali Loss: 1.3635614 Test Loss: 0.3829742
Validation loss decreased (1.368968 --> 1.363561).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 14 cost time: 1.5441386699676514
Epoch: 14, Steps: 52 | Train Loss: 0.4329006 Vali Loss: 1.3600658 Test Loss: 0.3807503
Validation loss decreased (1.363561 --> 1.360066).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 15 cost time: 1.5268549919128418
Epoch: 15, Steps: 52 | Train Loss: 0.4283623 Vali Loss: 1.3563946 Test Loss: 0.3794767
Validation loss decreased (1.360066 --> 1.356395).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 16 cost time: 1.5457303524017334
Epoch: 16, Steps: 52 | Train Loss: 0.4279274 Vali Loss: 1.3488255 Test Loss: 0.3775183
Validation loss decreased (1.356395 --> 1.348825).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 17 cost time: 1.5424432754516602
Epoch: 17, Steps: 52 | Train Loss: 0.4273860 Vali Loss: 1.3422515 Test Loss: 0.3770849
Validation loss decreased (1.348825 --> 1.342252).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 18 cost time: 1.541426420211792
Epoch: 18, Steps: 52 | Train Loss: 0.4264186 Vali Loss: 1.3397305 Test Loss: 0.3758258
Validation loss decreased (1.342252 --> 1.339731).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 19 cost time: 1.5257375240325928
Epoch: 19, Steps: 52 | Train Loss: 0.4240507 Vali Loss: 1.3456256 Test Loss: 0.3749243
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 20 cost time: 1.5385732650756836
Epoch: 20, Steps: 52 | Train Loss: 0.4238879 Vali Loss: 1.3437318 Test Loss: 0.3742899
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 21 cost time: 1.529489517211914
Epoch: 21, Steps: 52 | Train Loss: 0.4231285 Vali Loss: 1.3322625 Test Loss: 0.3738644
Validation loss decreased (1.339731 --> 1.332263).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 22 cost time: 1.5388777256011963
Epoch: 22, Steps: 52 | Train Loss: 0.4217669 Vali Loss: 1.3385800 Test Loss: 0.3735059
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 23 cost time: 1.5387134552001953
Epoch: 23, Steps: 52 | Train Loss: 0.4221941 Vali Loss: 1.3292323 Test Loss: 0.3728719
Validation loss decreased (1.332263 --> 1.329232).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 24 cost time: 1.5219917297363281
Epoch: 24, Steps: 52 | Train Loss: 0.4234416 Vali Loss: 1.3354819 Test Loss: 0.3728749
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 25 cost time: 1.5402004718780518
Epoch: 25, Steps: 52 | Train Loss: 0.4227225 Vali Loss: 1.3316393 Test Loss: 0.3726541
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 26 cost time: 1.5285346508026123
Epoch: 26, Steps: 52 | Train Loss: 0.4189676 Vali Loss: 1.3309908 Test Loss: 0.3716977
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 27 cost time: 1.5408036708831787
Epoch: 27, Steps: 52 | Train Loss: 0.4196365 Vali Loss: 1.3324530 Test Loss: 0.3724576
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 28 cost time: 1.5405642986297607
Epoch: 28, Steps: 52 | Train Loss: 0.4188821 Vali Loss: 1.3348145 Test Loss: 0.3714657
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 29 cost time: 1.5445518493652344
Epoch: 29, Steps: 52 | Train Loss: 0.4194566 Vali Loss: 1.3351754 Test Loss: 0.3719054
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 30 cost time: 1.5264136791229248
Epoch: 30, Steps: 52 | Train Loss: 0.4173577 Vali Loss: 1.3227788 Test Loss: 0.3710023
Validation loss decreased (1.329232 --> 1.322779).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 31 cost time: 1.5403833389282227
Epoch: 31, Steps: 52 | Train Loss: 0.4186415 Vali Loss: 1.3200358 Test Loss: 0.3707107
Validation loss decreased (1.322779 --> 1.320036).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 32 cost time: 1.5369951725006104
Epoch: 32, Steps: 52 | Train Loss: 0.4188109 Vali Loss: 1.3283015 Test Loss: 0.3708796
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 33 cost time: 1.5423331260681152
Epoch: 33, Steps: 52 | Train Loss: 0.4168390 Vali Loss: 1.3216157 Test Loss: 0.3710789
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 34 cost time: 1.5202305316925049
Epoch: 34, Steps: 52 | Train Loss: 0.4181292 Vali Loss: 1.3325438 Test Loss: 0.3710875
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 35 cost time: 1.5367693901062012
Epoch: 35, Steps: 52 | Train Loss: 0.4168255 Vali Loss: 1.3312217 Test Loss: 0.3706297
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 36 cost time: 1.5350468158721924
Epoch: 36, Steps: 52 | Train Loss: 0.4177327 Vali Loss: 1.3181531 Test Loss: 0.3708350
Validation loss decreased (1.320036 --> 1.318153).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 37 cost time: 1.527493953704834
Epoch: 37, Steps: 52 | Train Loss: 0.4171744 Vali Loss: 1.3242545 Test Loss: 0.3709305
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 38 cost time: 1.5219080448150635
Epoch: 38, Steps: 52 | Train Loss: 0.4172587 Vali Loss: 1.3307285 Test Loss: 0.3704677
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 39 cost time: 1.5289759635925293
Epoch: 39, Steps: 52 | Train Loss: 0.4157749 Vali Loss: 1.3240391 Test Loss: 0.3704858
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 40 cost time: 1.5314323902130127
Epoch: 40, Steps: 52 | Train Loss: 0.4170607 Vali Loss: 1.3197510 Test Loss: 0.3706695
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 41 cost time: 1.531031608581543
Epoch: 41, Steps: 52 | Train Loss: 0.4176156 Vali Loss: 1.3253682 Test Loss: 0.3704900
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 42 cost time: 1.5385165214538574
Epoch: 42, Steps: 52 | Train Loss: 0.4154026 Vali Loss: 1.3222324 Test Loss: 0.3700187
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 43 cost time: 1.53861665725708
Epoch: 43, Steps: 52 | Train Loss: 0.4171642 Vali Loss: 1.3251296 Test Loss: 0.3701458
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 44 cost time: 1.5383691787719727
Epoch: 44, Steps: 52 | Train Loss: 0.4174157 Vali Loss: 1.3221316 Test Loss: 0.3702542
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 45 cost time: 1.5311503410339355
Epoch: 45, Steps: 52 | Train Loss: 0.4166907 Vali Loss: 1.3264415 Test Loss: 0.3702639
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 46 cost time: 1.5304174423217773
Epoch: 46, Steps: 52 | Train Loss: 0.4150876 Vali Loss: 1.3266920 Test Loss: 0.3706961
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 47 cost time: 1.5373966693878174
Epoch: 47, Steps: 52 | Train Loss: 0.4171684 Vali Loss: 1.3261917 Test Loss: 0.3699660
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 48 cost time: 1.5298058986663818
Epoch: 48, Steps: 52 | Train Loss: 0.4158452 Vali Loss: 1.3254189 Test Loss: 0.3699516
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 49 cost time: 1.538966417312622
Epoch: 49, Steps: 52 | Train Loss: 0.4173197 Vali Loss: 1.3224666 Test Loss: 0.3698123
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 50 cost time: 1.5391380786895752
Epoch: 50, Steps: 52 | Train Loss: 0.4169925 Vali Loss: 1.3259686 Test Loss: 0.3702793
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 51 cost time: 1.5365097522735596
Epoch: 51, Steps: 52 | Train Loss: 0.4180970 Vali Loss: 1.3245149 Test Loss: 0.3706025
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 52 cost time: 1.5223829746246338
Epoch: 52, Steps: 52 | Train Loss: 0.4164042 Vali Loss: 1.3230383 Test Loss: 0.3706976
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 53 cost time: 1.5177810192108154
Epoch: 53, Steps: 52 | Train Loss: 0.4161644 Vali Loss: 1.3221755 Test Loss: 0.3701747
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 54 cost time: 1.5205039978027344
Epoch: 54, Steps: 52 | Train Loss: 0.4161133 Vali Loss: 1.3210473 Test Loss: 0.3700460
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 55 cost time: 1.5260577201843262
Epoch: 55, Steps: 52 | Train Loss: 0.4165766 Vali Loss: 1.3245780 Test Loss: 0.3698695
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 56 cost time: 1.537841558456421
Epoch: 56, Steps: 52 | Train Loss: 0.4152137 Vali Loss: 1.3212115 Test Loss: 0.3699456
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 57 cost time: 1.536665916442871
Epoch: 57, Steps: 52 | Train Loss: 0.4136920 Vali Loss: 1.3295131 Test Loss: 0.3696687
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 58 cost time: 1.5288069248199463
Epoch: 58, Steps: 52 | Train Loss: 0.4167161 Vali Loss: 1.3229139 Test Loss: 0.3701105
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 59 cost time: 1.5364739894866943
Epoch: 59, Steps: 52 | Train Loss: 0.4149433 Vali Loss: 1.3224013 Test Loss: 0.3703187
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 60 cost time: 1.5412025451660156
Epoch: 60, Steps: 52 | Train Loss: 0.4151983 Vali Loss: 1.3197179 Test Loss: 0.3698013
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.37083497643470764, mae:0.4127475917339325, rse:0.49888354539871216
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.058394432067871094 GB
Epoch: 1 cost time: 2.0922441482543945
Epoch: 1, Steps: 52 | Train Loss: 0.6773360 Vali Loss: 2.0508766 Test Loss: 1.2522092
Validation loss decreased (inf --> 2.050877).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 2 cost time: 0.7119817733764648
Epoch: 2, Steps: 52 | Train Loss: 0.5487707 Vali Loss: 1.4890618 Test Loss: 0.5233613
Validation loss decreased (2.050877 --> 1.489062).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 3 cost time: 0.729548454284668
Epoch: 3, Steps: 52 | Train Loss: 0.4592619 Vali Loss: 1.3928925 Test Loss: 0.4142204
Validation loss decreased (1.489062 --> 1.392892).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 4 cost time: 0.7223498821258545
Epoch: 4, Steps: 52 | Train Loss: 0.4369170 Vali Loss: 1.3739289 Test Loss: 0.3931444
Validation loss decreased (1.392892 --> 1.373929).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 5 cost time: 0.7349998950958252
Epoch: 5, Steps: 52 | Train Loss: 0.4281214 Vali Loss: 1.3534405 Test Loss: 0.3800505
Validation loss decreased (1.373929 --> 1.353441).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 6 cost time: 1.4206101894378662
Epoch: 6, Steps: 52 | Train Loss: 0.4222914 Vali Loss: 1.3473451 Test Loss: 0.3724020
Validation loss decreased (1.353441 --> 1.347345).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 7 cost time: 1.5910375118255615
Epoch: 7, Steps: 52 | Train Loss: 0.4191088 Vali Loss: 1.3351185 Test Loss: 0.3681192
Validation loss decreased (1.347345 --> 1.335119).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 8 cost time: 1.5978589057922363
Epoch: 8, Steps: 52 | Train Loss: 0.4154166 Vali Loss: 1.3447049 Test Loss: 0.3653051
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 9 cost time: 1.604008436203003
Epoch: 9, Steps: 52 | Train Loss: 0.4131072 Vali Loss: 1.3320870 Test Loss: 0.3615507
Validation loss decreased (1.335119 --> 1.332087).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 10 cost time: 1.599724531173706
Epoch: 10, Steps: 52 | Train Loss: 0.4108755 Vali Loss: 1.3261809 Test Loss: 0.3606667
Validation loss decreased (1.332087 --> 1.326181).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 11 cost time: 1.5980279445648193
Epoch: 11, Steps: 52 | Train Loss: 0.4112435 Vali Loss: 1.3231471 Test Loss: 0.3591552
Validation loss decreased (1.326181 --> 1.323147).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 12 cost time: 1.6035950183868408
Epoch: 12, Steps: 52 | Train Loss: 0.4081762 Vali Loss: 1.3189176 Test Loss: 0.3583230
Validation loss decreased (1.323147 --> 1.318918).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 13 cost time: 1.5987677574157715
Epoch: 13, Steps: 52 | Train Loss: 0.4072032 Vali Loss: 1.3159459 Test Loss: 0.3574601
Validation loss decreased (1.318918 --> 1.315946).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 14 cost time: 1.601308822631836
Epoch: 14, Steps: 52 | Train Loss: 0.4061883 Vali Loss: 1.3140786 Test Loss: 0.3558892
Validation loss decreased (1.315946 --> 1.314079).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 15 cost time: 1.6021137237548828
Epoch: 15, Steps: 52 | Train Loss: 0.4067151 Vali Loss: 1.3181095 Test Loss: 0.3566207
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 16 cost time: 1.5941367149353027
Epoch: 16, Steps: 52 | Train Loss: 0.4039454 Vali Loss: 1.3060086 Test Loss: 0.3559962
Validation loss decreased (1.314079 --> 1.306009).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 17 cost time: 1.6059606075286865
Epoch: 17, Steps: 52 | Train Loss: 0.4027338 Vali Loss: 1.3116844 Test Loss: 0.3556418
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 18 cost time: 1.6017017364501953
Epoch: 18, Steps: 52 | Train Loss: 0.4038021 Vali Loss: 1.3196001 Test Loss: 0.3548802
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 19 cost time: 1.604036808013916
Epoch: 19, Steps: 52 | Train Loss: 0.4050004 Vali Loss: 1.3116562 Test Loss: 0.3550215
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 20 cost time: 1.6033375263214111
Epoch: 20, Steps: 52 | Train Loss: 0.4025714 Vali Loss: 1.3111260 Test Loss: 0.3540306
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 21 cost time: 1.6023221015930176
Epoch: 21, Steps: 52 | Train Loss: 0.4024576 Vali Loss: 1.3015156 Test Loss: 0.3537702
Validation loss decreased (1.306009 --> 1.301516).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 22 cost time: 1.5963492393493652
Epoch: 22, Steps: 52 | Train Loss: 0.4021417 Vali Loss: 1.3106850 Test Loss: 0.3538273
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 23 cost time: 1.6002702713012695
Epoch: 23, Steps: 52 | Train Loss: 0.4020934 Vali Loss: 1.3124137 Test Loss: 0.3534982
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 24 cost time: 1.6107702255249023
Epoch: 24, Steps: 52 | Train Loss: 0.4017711 Vali Loss: 1.3062992 Test Loss: 0.3539820
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 25 cost time: 1.5952093601226807
Epoch: 25, Steps: 52 | Train Loss: 0.4013580 Vali Loss: 1.3138722 Test Loss: 0.3531510
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 26 cost time: 1.6018626689910889
Epoch: 26, Steps: 52 | Train Loss: 0.4030162 Vali Loss: 1.3132422 Test Loss: 0.3530939
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 27 cost time: 1.5971782207489014
Epoch: 27, Steps: 52 | Train Loss: 0.4019803 Vali Loss: 1.3100941 Test Loss: 0.3537495
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 28 cost time: 1.5974726676940918
Epoch: 28, Steps: 52 | Train Loss: 0.4002229 Vali Loss: 1.3098257 Test Loss: 0.3529166
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 29 cost time: 1.6019175052642822
Epoch: 29, Steps: 52 | Train Loss: 0.3998584 Vali Loss: 1.3133739 Test Loss: 0.3526402
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 30 cost time: 1.604844570159912
Epoch: 30, Steps: 52 | Train Loss: 0.4004806 Vali Loss: 1.3012656 Test Loss: 0.3527129
Validation loss decreased (1.301516 --> 1.301266).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 31 cost time: 1.5999665260314941
Epoch: 31, Steps: 52 | Train Loss: 0.4014706 Vali Loss: 1.3041277 Test Loss: 0.3526677
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 32 cost time: 1.6004128456115723
Epoch: 32, Steps: 52 | Train Loss: 0.4006363 Vali Loss: 1.3128080 Test Loss: 0.3528292
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 33 cost time: 1.5890445709228516
Epoch: 33, Steps: 52 | Train Loss: 0.4007563 Vali Loss: 1.3042430 Test Loss: 0.3528891
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 34 cost time: 1.605560302734375
Epoch: 34, Steps: 52 | Train Loss: 0.4014033 Vali Loss: 1.3002503 Test Loss: 0.3524112
Validation loss decreased (1.301266 --> 1.300250).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 35 cost time: 1.5997314453125
Epoch: 35, Steps: 52 | Train Loss: 0.3996685 Vali Loss: 1.3071864 Test Loss: 0.3525667
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 36 cost time: 1.6090381145477295
Epoch: 36, Steps: 52 | Train Loss: 0.4011146 Vali Loss: 1.3010180 Test Loss: 0.3525032
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 37 cost time: 1.603550672531128
Epoch: 37, Steps: 52 | Train Loss: 0.3999714 Vali Loss: 1.3093901 Test Loss: 0.3525614
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 38 cost time: 1.6046943664550781
Epoch: 38, Steps: 52 | Train Loss: 0.3999067 Vali Loss: 1.3082426 Test Loss: 0.3524305
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 39 cost time: 1.6002998352050781
Epoch: 39, Steps: 52 | Train Loss: 0.3994905 Vali Loss: 1.3113880 Test Loss: 0.3522540
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 40 cost time: 1.6083061695098877
Epoch: 40, Steps: 52 | Train Loss: 0.4009436 Vali Loss: 1.3102548 Test Loss: 0.3521940
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 41 cost time: 1.601405143737793
Epoch: 41, Steps: 52 | Train Loss: 0.4004924 Vali Loss: 1.3069433 Test Loss: 0.3526769
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 42 cost time: 1.6030383110046387
Epoch: 42, Steps: 52 | Train Loss: 0.3980471 Vali Loss: 1.3069700 Test Loss: 0.3528032
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 43 cost time: 1.6019697189331055
Epoch: 43, Steps: 52 | Train Loss: 0.3983732 Vali Loss: 1.3060656 Test Loss: 0.3520885
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 44 cost time: 1.603562831878662
Epoch: 44, Steps: 52 | Train Loss: 0.4008692 Vali Loss: 1.3002863 Test Loss: 0.3521533
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 45 cost time: 1.6011483669281006
Epoch: 45, Steps: 52 | Train Loss: 0.3991002 Vali Loss: 1.2997820 Test Loss: 0.3526002
Validation loss decreased (1.300250 --> 1.299782).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 46 cost time: 1.6047818660736084
Epoch: 46, Steps: 52 | Train Loss: 0.4003271 Vali Loss: 1.3120241 Test Loss: 0.3523681
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 47 cost time: 1.600597858428955
Epoch: 47, Steps: 52 | Train Loss: 0.4006279 Vali Loss: 1.3064537 Test Loss: 0.3521573
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 48 cost time: 1.6060981750488281
Epoch: 48, Steps: 52 | Train Loss: 0.4009133 Vali Loss: 1.3065639 Test Loss: 0.3519471
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 49 cost time: 1.5912377834320068
Epoch: 49, Steps: 52 | Train Loss: 0.3993977 Vali Loss: 1.3091747 Test Loss: 0.3522952
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 50 cost time: 1.60850191116333
Epoch: 50, Steps: 52 | Train Loss: 0.3991952 Vali Loss: 1.2990055 Test Loss: 0.3524176
Validation loss decreased (1.299782 --> 1.299006).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 51 cost time: 1.6032257080078125
Epoch: 51, Steps: 52 | Train Loss: 0.3992730 Vali Loss: 1.3102164 Test Loss: 0.3522318
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 52 cost time: 1.6082336902618408
Epoch: 52, Steps: 52 | Train Loss: 0.3975047 Vali Loss: 1.3024035 Test Loss: 0.3524761
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 53 cost time: 1.5993883609771729
Epoch: 53, Steps: 52 | Train Loss: 0.3982925 Vali Loss: 1.3041480 Test Loss: 0.3523817
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 54 cost time: 1.6041743755340576
Epoch: 54, Steps: 52 | Train Loss: 0.3994507 Vali Loss: 1.3092109 Test Loss: 0.3524888
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 55 cost time: 1.6036207675933838
Epoch: 55, Steps: 52 | Train Loss: 0.3997750 Vali Loss: 1.3082393 Test Loss: 0.3524308
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 56 cost time: 1.6071093082427979
Epoch: 56, Steps: 52 | Train Loss: 0.4000560 Vali Loss: 1.3110385 Test Loss: 0.3522961
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 57 cost time: 1.5963797569274902
Epoch: 57, Steps: 52 | Train Loss: 0.3992397 Vali Loss: 1.3034029 Test Loss: 0.3525836
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 58 cost time: 1.6053109169006348
Epoch: 58, Steps: 52 | Train Loss: 0.3991090 Vali Loss: 1.3012950 Test Loss: 0.3522488
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 59 cost time: 1.6011533737182617
Epoch: 59, Steps: 52 | Train Loss: 0.3994313 Vali Loss: 1.3090199 Test Loss: 0.3526216
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 60 cost time: 1.605504035949707
Epoch: 60, Steps: 52 | Train Loss: 0.3989694 Vali Loss: 1.3117809 Test Loss: 0.3523925
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35241761803627014, mae:0.3996548652648926, rse:0.4863373339176178
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06169319152832031 GB
Epoch: 1 cost time: 2.148495674133301
Epoch: 1, Steps: 52 | Train Loss: 0.6967874 Vali Loss: 2.1281514 Test Loss: 1.3856514
Validation loss decreased (inf --> 2.128151).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 2 cost time: 0.7557480335235596
Epoch: 2, Steps: 52 | Train Loss: 0.5548135 Vali Loss: 1.4655857 Test Loss: 0.4775784
Validation loss decreased (2.128151 --> 1.465586).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 3 cost time: 0.76796555519104
Epoch: 3, Steps: 52 | Train Loss: 0.4530585 Vali Loss: 1.3872992 Test Loss: 0.4164860
Validation loss decreased (1.465586 --> 1.387299).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 4 cost time: 0.7583503723144531
Epoch: 4, Steps: 52 | Train Loss: 0.4322509 Vali Loss: 1.3663774 Test Loss: 0.3874505
Validation loss decreased (1.387299 --> 1.366377).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 5 cost time: 0.7549986839294434
Epoch: 5, Steps: 52 | Train Loss: 0.4241297 Vali Loss: 1.3533912 Test Loss: 0.3792038
Validation loss decreased (1.366377 --> 1.353391).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 6 cost time: 1.6451025009155273
Epoch: 6, Steps: 52 | Train Loss: 0.4191463 Vali Loss: 1.3506666 Test Loss: 0.3732701
Validation loss decreased (1.353391 --> 1.350667).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 7 cost time: 1.660684585571289
Epoch: 7, Steps: 52 | Train Loss: 0.4144993 Vali Loss: 1.3402480 Test Loss: 0.3687741
Validation loss decreased (1.350667 --> 1.340248).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 8 cost time: 1.6643238067626953
Epoch: 8, Steps: 52 | Train Loss: 0.4116874 Vali Loss: 1.3301682 Test Loss: 0.3651168
Validation loss decreased (1.340248 --> 1.330168).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 9 cost time: 1.6626300811767578
Epoch: 9, Steps: 52 | Train Loss: 0.4098392 Vali Loss: 1.3267133 Test Loss: 0.3627193
Validation loss decreased (1.330168 --> 1.326713).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 10 cost time: 1.6673998832702637
Epoch: 10, Steps: 52 | Train Loss: 0.4073370 Vali Loss: 1.3242235 Test Loss: 0.3614606
Validation loss decreased (1.326713 --> 1.324224).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 11 cost time: 1.6672532558441162
Epoch: 11, Steps: 52 | Train Loss: 0.4080109 Vali Loss: 1.3180274 Test Loss: 0.3599163
Validation loss decreased (1.324224 --> 1.318027).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 12 cost time: 1.6698849201202393
Epoch: 12, Steps: 52 | Train Loss: 0.4068715 Vali Loss: 1.3207395 Test Loss: 0.3591444
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 13 cost time: 1.673677921295166
Epoch: 13, Steps: 52 | Train Loss: 0.4058441 Vali Loss: 1.3109317 Test Loss: 0.3577948
Validation loss decreased (1.318027 --> 1.310932).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 14 cost time: 1.6663646697998047
Epoch: 14, Steps: 52 | Train Loss: 0.4054441 Vali Loss: 1.3134017 Test Loss: 0.3575647
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 15 cost time: 1.6600522994995117
Epoch: 15, Steps: 52 | Train Loss: 0.4056608 Vali Loss: 1.3185408 Test Loss: 0.3572052
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 16 cost time: 1.659318447113037
Epoch: 16, Steps: 52 | Train Loss: 0.4033126 Vali Loss: 1.3076918 Test Loss: 0.3563569
Validation loss decreased (1.310932 --> 1.307692).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 17 cost time: 1.665642499923706
Epoch: 17, Steps: 52 | Train Loss: 0.4031138 Vali Loss: 1.3109088 Test Loss: 0.3560755
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 18 cost time: 1.658766269683838
Epoch: 18, Steps: 52 | Train Loss: 0.4032230 Vali Loss: 1.3049095 Test Loss: 0.3549700
Validation loss decreased (1.307692 --> 1.304909).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 19 cost time: 1.6602234840393066
Epoch: 19, Steps: 52 | Train Loss: 0.4020881 Vali Loss: 1.3075197 Test Loss: 0.3556850
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 20 cost time: 1.6588733196258545
Epoch: 20, Steps: 52 | Train Loss: 0.4020194 Vali Loss: 1.3130958 Test Loss: 0.3553205
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 21 cost time: 1.6629068851470947
Epoch: 21, Steps: 52 | Train Loss: 0.4015411 Vali Loss: 1.3105087 Test Loss: 0.3550004
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 22 cost time: 1.667741298675537
Epoch: 22, Steps: 52 | Train Loss: 0.3999203 Vali Loss: 1.3069627 Test Loss: 0.3543615
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 23 cost time: 1.6574461460113525
Epoch: 23, Steps: 52 | Train Loss: 0.3992544 Vali Loss: 1.3060441 Test Loss: 0.3540068
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 24 cost time: 1.6720948219299316
Epoch: 24, Steps: 52 | Train Loss: 0.3996892 Vali Loss: 1.3070790 Test Loss: 0.3541017
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 25 cost time: 1.6551904678344727
Epoch: 25, Steps: 52 | Train Loss: 0.4015874 Vali Loss: 1.2954888 Test Loss: 0.3538786
Validation loss decreased (1.304909 --> 1.295489).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 26 cost time: 1.6661288738250732
Epoch: 26, Steps: 52 | Train Loss: 0.3997880 Vali Loss: 1.3094149 Test Loss: 0.3544646
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 27 cost time: 1.6582651138305664
Epoch: 27, Steps: 52 | Train Loss: 0.3996685 Vali Loss: 1.3030820 Test Loss: 0.3536574
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 28 cost time: 1.6685338020324707
Epoch: 28, Steps: 52 | Train Loss: 0.3996710 Vali Loss: 1.3048418 Test Loss: 0.3539177
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 29 cost time: 1.659390926361084
Epoch: 29, Steps: 52 | Train Loss: 0.3986010 Vali Loss: 1.3024459 Test Loss: 0.3525808
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 30 cost time: 1.6650125980377197
Epoch: 30, Steps: 52 | Train Loss: 0.4006313 Vali Loss: 1.3034662 Test Loss: 0.3537182
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 31 cost time: 1.6653857231140137
Epoch: 31, Steps: 52 | Train Loss: 0.3996426 Vali Loss: 1.3093090 Test Loss: 0.3533384
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 32 cost time: 1.6676678657531738
Epoch: 32, Steps: 52 | Train Loss: 0.4003102 Vali Loss: 1.3043057 Test Loss: 0.3537094
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 33 cost time: 1.6677474975585938
Epoch: 33, Steps: 52 | Train Loss: 0.4002464 Vali Loss: 1.3022854 Test Loss: 0.3533923
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 34 cost time: 1.669884204864502
Epoch: 34, Steps: 52 | Train Loss: 0.3986612 Vali Loss: 1.2993870 Test Loss: 0.3533015
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 35 cost time: 1.6598906517028809
Epoch: 35, Steps: 52 | Train Loss: 0.4001527 Vali Loss: 1.2974782 Test Loss: 0.3530742
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 36 cost time: 1.6693930625915527
Epoch: 36, Steps: 52 | Train Loss: 0.3982193 Vali Loss: 1.2977611 Test Loss: 0.3534254
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 37 cost time: 1.6680498123168945
Epoch: 37, Steps: 52 | Train Loss: 0.3997725 Vali Loss: 1.3070092 Test Loss: 0.3530186
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 38 cost time: 1.667517900466919
Epoch: 38, Steps: 52 | Train Loss: 0.3975408 Vali Loss: 1.3051190 Test Loss: 0.3534228
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 39 cost time: 1.6577064990997314
Epoch: 39, Steps: 52 | Train Loss: 0.3987368 Vali Loss: 1.3062718 Test Loss: 0.3526938
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 40 cost time: 1.6618432998657227
Epoch: 40, Steps: 52 | Train Loss: 0.3977636 Vali Loss: 1.3051612 Test Loss: 0.3529978
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 41 cost time: 1.6646203994750977
Epoch: 41, Steps: 52 | Train Loss: 0.3991246 Vali Loss: 1.3105727 Test Loss: 0.3526718
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 42 cost time: 1.6575186252593994
Epoch: 42, Steps: 52 | Train Loss: 0.4005487 Vali Loss: 1.3068528 Test Loss: 0.3531840
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 43 cost time: 1.6632847785949707
Epoch: 43, Steps: 52 | Train Loss: 0.3978325 Vali Loss: 1.2922701 Test Loss: 0.3533900
Validation loss decreased (1.295489 --> 1.292270).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 44 cost time: 1.6621482372283936
Epoch: 44, Steps: 52 | Train Loss: 0.3980538 Vali Loss: 1.3075521 Test Loss: 0.3535810
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 45 cost time: 1.656829595565796
Epoch: 45, Steps: 52 | Train Loss: 0.3984105 Vali Loss: 1.3041466 Test Loss: 0.3532103
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 46 cost time: 1.6627213954925537
Epoch: 46, Steps: 52 | Train Loss: 0.3987626 Vali Loss: 1.3039206 Test Loss: 0.3536282
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 47 cost time: 1.6650464534759521
Epoch: 47, Steps: 52 | Train Loss: 0.3986104 Vali Loss: 1.2975088 Test Loss: 0.3526471
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 48 cost time: 1.6603186130523682
Epoch: 48, Steps: 52 | Train Loss: 0.3986379 Vali Loss: 1.3000128 Test Loss: 0.3528683
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 49 cost time: 1.6636838912963867
Epoch: 49, Steps: 52 | Train Loss: 0.3988977 Vali Loss: 1.3039174 Test Loss: 0.3534180
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 50 cost time: 1.6640677452087402
Epoch: 50, Steps: 52 | Train Loss: 0.3985813 Vali Loss: 1.3078711 Test Loss: 0.3530331
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 51 cost time: 1.6595122814178467
Epoch: 51, Steps: 52 | Train Loss: 0.3963008 Vali Loss: 1.3087250 Test Loss: 0.3530891
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 52 cost time: 1.6683697700500488
Epoch: 52, Steps: 52 | Train Loss: 0.3969814 Vali Loss: 1.2959059 Test Loss: 0.3529086
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 53 cost time: 1.669771671295166
Epoch: 53, Steps: 52 | Train Loss: 0.3989131 Vali Loss: 1.2917337 Test Loss: 0.3530493
Validation loss decreased (1.292270 --> 1.291734).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 54 cost time: 1.6633665561676025
Epoch: 54, Steps: 52 | Train Loss: 0.3974514 Vali Loss: 1.3050148 Test Loss: 0.3531775
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 55 cost time: 1.659531593322754
Epoch: 55, Steps: 52 | Train Loss: 0.3990759 Vali Loss: 1.3041875 Test Loss: 0.3532597
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 56 cost time: 1.6586511135101318
Epoch: 56, Steps: 52 | Train Loss: 0.3995945 Vali Loss: 1.3043474 Test Loss: 0.3527562
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 57 cost time: 1.6678178310394287
Epoch: 57, Steps: 52 | Train Loss: 0.3978935 Vali Loss: 1.3034928 Test Loss: 0.3525392
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 58 cost time: 1.6658735275268555
Epoch: 58, Steps: 52 | Train Loss: 0.3974119 Vali Loss: 1.2996030 Test Loss: 0.3531190
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 59 cost time: 1.6681005954742432
Epoch: 59, Steps: 52 | Train Loss: 0.3982208 Vali Loss: 1.3004256 Test Loss: 0.3525055
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 60 cost time: 1.6598412990570068
Epoch: 60, Steps: 52 | Train Loss: 0.3986274 Vali Loss: 1.3008773 Test Loss: 0.3530307
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3530493676662445, mae:0.40115106105804443, rse:0.4867730438709259
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05416154861450195 GB
Epoch: 1 cost time: 2.1016933917999268
Epoch: 1, Steps: 52 | Train Loss: 0.8027115 Vali Loss: 2.3100662 Test Loss: 1.5531042
Validation loss decreased (inf --> 2.310066).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 2 cost time: 0.6946179866790771
Epoch: 2, Steps: 52 | Train Loss: 0.7134312 Vali Loss: 1.9019184 Test Loss: 1.0705442
Validation loss decreased (2.310066 --> 1.901918).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 3 cost time: 0.699622631072998
Epoch: 3, Steps: 52 | Train Loss: 0.6047106 Vali Loss: 1.6722591 Test Loss: 0.7729095
Validation loss decreased (1.901918 --> 1.672259).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 4 cost time: 0.6989493370056152
Epoch: 4, Steps: 52 | Train Loss: 0.5292522 Vali Loss: 1.5161762 Test Loss: 0.5542146
Validation loss decreased (1.672259 --> 1.516176).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 5 cost time: 0.6990005970001221
Epoch: 5, Steps: 52 | Train Loss: 0.4869488 Vali Loss: 1.4492123 Test Loss: 0.4518034
Validation loss decreased (1.516176 --> 1.449212).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 6 cost time: 1.2206659317016602
Epoch: 6, Steps: 52 | Train Loss: 0.4673435 Vali Loss: 1.4221177 Test Loss: 0.4182718
Validation loss decreased (1.449212 --> 1.422118).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 7 cost time: 1.5397779941558838
Epoch: 7, Steps: 52 | Train Loss: 0.4548986 Vali Loss: 1.4083718 Test Loss: 0.4016961
Validation loss decreased (1.422118 --> 1.408372).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 8 cost time: 1.5493390560150146
Epoch: 8, Steps: 52 | Train Loss: 0.4474453 Vali Loss: 1.3945429 Test Loss: 0.3924729
Validation loss decreased (1.408372 --> 1.394543).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 9 cost time: 1.5414247512817383
Epoch: 9, Steps: 52 | Train Loss: 0.4442932 Vali Loss: 1.3773975 Test Loss: 0.3858388
Validation loss decreased (1.394543 --> 1.377398).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 10 cost time: 1.5505127906799316
Epoch: 10, Steps: 52 | Train Loss: 0.4382962 Vali Loss: 1.3796635 Test Loss: 0.3808416
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 11 cost time: 1.552955150604248
Epoch: 11, Steps: 52 | Train Loss: 0.4365251 Vali Loss: 1.3788791 Test Loss: 0.3774061
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 12 cost time: 1.5469176769256592
Epoch: 12, Steps: 52 | Train Loss: 0.4330984 Vali Loss: 1.3653030 Test Loss: 0.3741019
Validation loss decreased (1.377398 --> 1.365303).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 13 cost time: 1.55189847946167
Epoch: 13, Steps: 52 | Train Loss: 0.4308349 Vali Loss: 1.3615412 Test Loss: 0.3708610
Validation loss decreased (1.365303 --> 1.361541).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 14 cost time: 1.553452491760254
Epoch: 14, Steps: 52 | Train Loss: 0.4275526 Vali Loss: 1.3673017 Test Loss: 0.3688041
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 15 cost time: 1.5397841930389404
Epoch: 15, Steps: 52 | Train Loss: 0.4269386 Vali Loss: 1.3542051 Test Loss: 0.3664532
Validation loss decreased (1.361541 --> 1.354205).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 16 cost time: 1.5418105125427246
Epoch: 16, Steps: 52 | Train Loss: 0.4247825 Vali Loss: 1.3506161 Test Loss: 0.3651267
Validation loss decreased (1.354205 --> 1.350616).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 17 cost time: 1.538151741027832
Epoch: 17, Steps: 52 | Train Loss: 0.4252132 Vali Loss: 1.3467538 Test Loss: 0.3635635
Validation loss decreased (1.350616 --> 1.346754).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 18 cost time: 1.5378711223602295
Epoch: 18, Steps: 52 | Train Loss: 0.4229258 Vali Loss: 1.3514872 Test Loss: 0.3623802
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 19 cost time: 1.533440351486206
Epoch: 19, Steps: 52 | Train Loss: 0.4221282 Vali Loss: 1.3437436 Test Loss: 0.3611261
Validation loss decreased (1.346754 --> 1.343744).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 20 cost time: 1.5396621227264404
Epoch: 20, Steps: 52 | Train Loss: 0.4210936 Vali Loss: 1.3466165 Test Loss: 0.3602081
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 21 cost time: 1.5474433898925781
Epoch: 21, Steps: 52 | Train Loss: 0.4211900 Vali Loss: 1.3495530 Test Loss: 0.3594397
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 22 cost time: 1.5520765781402588
Epoch: 22, Steps: 52 | Train Loss: 0.4195631 Vali Loss: 1.3406537 Test Loss: 0.3584562
Validation loss decreased (1.343744 --> 1.340654).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 23 cost time: 1.5374746322631836
Epoch: 23, Steps: 52 | Train Loss: 0.4210273 Vali Loss: 1.3474249 Test Loss: 0.3577979
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 24 cost time: 1.549271821975708
Epoch: 24, Steps: 52 | Train Loss: 0.4202458 Vali Loss: 1.3442705 Test Loss: 0.3575568
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 25 cost time: 1.5574016571044922
Epoch: 25, Steps: 52 | Train Loss: 0.4193602 Vali Loss: 1.3371346 Test Loss: 0.3565676
Validation loss decreased (1.340654 --> 1.337135).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 26 cost time: 1.5467267036437988
Epoch: 26, Steps: 52 | Train Loss: 0.4198332 Vali Loss: 1.3429489 Test Loss: 0.3563999
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 27 cost time: 1.5416440963745117
Epoch: 27, Steps: 52 | Train Loss: 0.4194718 Vali Loss: 1.3381741 Test Loss: 0.3560905
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 28 cost time: 1.5417428016662598
Epoch: 28, Steps: 52 | Train Loss: 0.4181515 Vali Loss: 1.3389306 Test Loss: 0.3555264
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 29 cost time: 1.544149398803711
Epoch: 29, Steps: 52 | Train Loss: 0.4165730 Vali Loss: 1.3261085 Test Loss: 0.3554469
Validation loss decreased (1.337135 --> 1.326108).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 30 cost time: 1.53896164894104
Epoch: 30, Steps: 52 | Train Loss: 0.4167106 Vali Loss: 1.3394916 Test Loss: 0.3553470
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 31 cost time: 1.5521624088287354
Epoch: 31, Steps: 52 | Train Loss: 0.4185953 Vali Loss: 1.3382998 Test Loss: 0.3546964
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 32 cost time: 1.5477769374847412
Epoch: 32, Steps: 52 | Train Loss: 0.4157746 Vali Loss: 1.3300248 Test Loss: 0.3542736
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 33 cost time: 1.5561473369598389
Epoch: 33, Steps: 52 | Train Loss: 0.4163714 Vali Loss: 1.3335714 Test Loss: 0.3542048
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 34 cost time: 1.5474014282226562
Epoch: 34, Steps: 52 | Train Loss: 0.4175620 Vali Loss: 1.3393042 Test Loss: 0.3539592
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 35 cost time: 1.5386295318603516
Epoch: 35, Steps: 52 | Train Loss: 0.4169124 Vali Loss: 1.3231885 Test Loss: 0.3538425
Validation loss decreased (1.326108 --> 1.323189).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 36 cost time: 1.5459580421447754
Epoch: 36, Steps: 52 | Train Loss: 0.4174439 Vali Loss: 1.3350291 Test Loss: 0.3538088
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 37 cost time: 1.5476713180541992
Epoch: 37, Steps: 52 | Train Loss: 0.4170742 Vali Loss: 1.3297966 Test Loss: 0.3537051
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 38 cost time: 1.550452709197998
Epoch: 38, Steps: 52 | Train Loss: 0.4165734 Vali Loss: 1.3362718 Test Loss: 0.3534828
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 39 cost time: 1.5523653030395508
Epoch: 39, Steps: 52 | Train Loss: 0.4147189 Vali Loss: 1.3368752 Test Loss: 0.3534241
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 40 cost time: 1.5524208545684814
Epoch: 40, Steps: 52 | Train Loss: 0.4160947 Vali Loss: 1.3265588 Test Loss: 0.3532760
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 41 cost time: 1.5412075519561768
Epoch: 41, Steps: 52 | Train Loss: 0.4163331 Vali Loss: 1.3357244 Test Loss: 0.3535424
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 42 cost time: 1.5409910678863525
Epoch: 42, Steps: 52 | Train Loss: 0.4159732 Vali Loss: 1.3335537 Test Loss: 0.3530802
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 43 cost time: 1.5423614978790283
Epoch: 43, Steps: 52 | Train Loss: 0.4160608 Vali Loss: 1.3335397 Test Loss: 0.3533643
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 44 cost time: 1.5368125438690186
Epoch: 44, Steps: 52 | Train Loss: 0.4152289 Vali Loss: 1.3330078 Test Loss: 0.3531103
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 45 cost time: 1.5391449928283691
Epoch: 45, Steps: 52 | Train Loss: 0.4160034 Vali Loss: 1.3333056 Test Loss: 0.3530739
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 46 cost time: 1.5443060398101807
Epoch: 46, Steps: 52 | Train Loss: 0.4162381 Vali Loss: 1.3247840 Test Loss: 0.3528025
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 47 cost time: 1.543604850769043
Epoch: 47, Steps: 52 | Train Loss: 0.4145945 Vali Loss: 1.3330076 Test Loss: 0.3528768
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 48 cost time: 1.5524420738220215
Epoch: 48, Steps: 52 | Train Loss: 0.4156672 Vali Loss: 1.3303678 Test Loss: 0.3526808
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 49 cost time: 1.5512936115264893
Epoch: 49, Steps: 52 | Train Loss: 0.4149513 Vali Loss: 1.3261421 Test Loss: 0.3528449
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 50 cost time: 1.553586483001709
Epoch: 50, Steps: 52 | Train Loss: 0.4147849 Vali Loss: 1.3342342 Test Loss: 0.3526429
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 51 cost time: 1.539036750793457
Epoch: 51, Steps: 52 | Train Loss: 0.4151611 Vali Loss: 1.3308280 Test Loss: 0.3527281
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 52 cost time: 1.5427491664886475
Epoch: 52, Steps: 52 | Train Loss: 0.4152745 Vali Loss: 1.3324018 Test Loss: 0.3527897
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 53 cost time: 1.533376932144165
Epoch: 53, Steps: 52 | Train Loss: 0.4141112 Vali Loss: 1.3287280 Test Loss: 0.3526963
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 54 cost time: 1.5358412265777588
Epoch: 54, Steps: 52 | Train Loss: 0.4149990 Vali Loss: 1.3328598 Test Loss: 0.3524901
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 55 cost time: 1.5333752632141113
Epoch: 55, Steps: 52 | Train Loss: 0.4158501 Vali Loss: 1.3348010 Test Loss: 0.3523303
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 56 cost time: 1.5391592979431152
Epoch: 56, Steps: 52 | Train Loss: 0.4131964 Vali Loss: 1.3327420 Test Loss: 0.3526520
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 57 cost time: 1.544405460357666
Epoch: 57, Steps: 52 | Train Loss: 0.4159265 Vali Loss: 1.3308102 Test Loss: 0.3526609
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 58 cost time: 1.5519232749938965
Epoch: 58, Steps: 52 | Train Loss: 0.4157654 Vali Loss: 1.3236411 Test Loss: 0.3524686
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 59 cost time: 1.5492935180664062
Epoch: 59, Steps: 52 | Train Loss: 0.4165915 Vali Loss: 1.3357024 Test Loss: 0.3526000
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 60 cost time: 1.5430934429168701
Epoch: 60, Steps: 52 | Train Loss: 0.4156806 Vali Loss: 1.3312492 Test Loss: 0.3522752
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35384252667427063, mae:0.39702868461608887, rse:0.48731955885887146
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05855607986450195 GB
Epoch: 1 cost time: 2.1211555004119873
Epoch: 1, Steps: 52 | Train Loss: 0.7136322 Vali Loss: 2.1527128 Test Loss: 1.3910254
Validation loss decreased (inf --> 2.152713).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 2 cost time: 0.7258510589599609
Epoch: 2, Steps: 52 | Train Loss: 0.5683674 Vali Loss: 1.4798708 Test Loss: 0.5417705
Validation loss decreased (2.152713 --> 1.479871).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 3 cost time: 0.7293660640716553
Epoch: 3, Steps: 52 | Train Loss: 0.4547478 Vali Loss: 1.3942554 Test Loss: 0.4125960
Validation loss decreased (1.479871 --> 1.394255).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 4 cost time: 0.7243850231170654
Epoch: 4, Steps: 52 | Train Loss: 0.4329194 Vali Loss: 1.3723683 Test Loss: 0.3926485
Validation loss decreased (1.394255 --> 1.372368).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 5 cost time: 0.7308273315429688
Epoch: 5, Steps: 52 | Train Loss: 0.4259495 Vali Loss: 1.3596642 Test Loss: 0.3795007
Validation loss decreased (1.372368 --> 1.359664).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 6 cost time: 1.5220708847045898
Epoch: 6, Steps: 52 | Train Loss: 0.4204476 Vali Loss: 1.3544849 Test Loss: 0.3720282
Validation loss decreased (1.359664 --> 1.354485).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 7 cost time: 1.6104540824890137
Epoch: 7, Steps: 52 | Train Loss: 0.4187085 Vali Loss: 1.3449554 Test Loss: 0.3668490
Validation loss decreased (1.354485 --> 1.344955).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 8 cost time: 1.6085805892944336
Epoch: 8, Steps: 52 | Train Loss: 0.4133917 Vali Loss: 1.3315470 Test Loss: 0.3623015
Validation loss decreased (1.344955 --> 1.331547).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 9 cost time: 1.6204063892364502
Epoch: 9, Steps: 52 | Train Loss: 0.4135024 Vali Loss: 1.3319336 Test Loss: 0.3589980
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 10 cost time: 1.6121320724487305
Epoch: 10, Steps: 52 | Train Loss: 0.4096376 Vali Loss: 1.3289508 Test Loss: 0.3570861
Validation loss decreased (1.331547 --> 1.328951).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 11 cost time: 1.61283540725708
Epoch: 11, Steps: 52 | Train Loss: 0.4076421 Vali Loss: 1.3144255 Test Loss: 0.3557065
Validation loss decreased (1.328951 --> 1.314425).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 12 cost time: 1.6126103401184082
Epoch: 12, Steps: 52 | Train Loss: 0.4067639 Vali Loss: 1.3229644 Test Loss: 0.3552991
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 13 cost time: 1.614548921585083
Epoch: 13, Steps: 52 | Train Loss: 0.4052176 Vali Loss: 1.3117070 Test Loss: 0.3541732
Validation loss decreased (1.314425 --> 1.311707).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 14 cost time: 1.6133971214294434
Epoch: 14, Steps: 52 | Train Loss: 0.4069392 Vali Loss: 1.3115730 Test Loss: 0.3537372
Validation loss decreased (1.311707 --> 1.311573).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 15 cost time: 1.6159090995788574
Epoch: 15, Steps: 52 | Train Loss: 0.4048592 Vali Loss: 1.3023664 Test Loss: 0.3532906
Validation loss decreased (1.311573 --> 1.302366).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 16 cost time: 1.6090130805969238
Epoch: 16, Steps: 52 | Train Loss: 0.4026848 Vali Loss: 1.3004832 Test Loss: 0.3524834
Validation loss decreased (1.302366 --> 1.300483).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 17 cost time: 1.6111323833465576
Epoch: 17, Steps: 52 | Train Loss: 0.4041105 Vali Loss: 1.3002213 Test Loss: 0.3539393
Validation loss decreased (1.300483 --> 1.300221).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 18 cost time: 1.6064777374267578
Epoch: 18, Steps: 52 | Train Loss: 0.4039537 Vali Loss: 1.3031671 Test Loss: 0.3529243
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 19 cost time: 1.6182870864868164
Epoch: 19, Steps: 52 | Train Loss: 0.4009539 Vali Loss: 1.3022171 Test Loss: 0.3531741
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 20 cost time: 1.6065988540649414
Epoch: 20, Steps: 52 | Train Loss: 0.4024272 Vali Loss: 1.2939515 Test Loss: 0.3521882
Validation loss decreased (1.300221 --> 1.293952).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 21 cost time: 1.6110167503356934
Epoch: 21, Steps: 52 | Train Loss: 0.4017820 Vali Loss: 1.2950168 Test Loss: 0.3525350
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 22 cost time: 1.6086044311523438
Epoch: 22, Steps: 52 | Train Loss: 0.4034458 Vali Loss: 1.3058435 Test Loss: 0.3521947
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 23 cost time: 1.6143712997436523
Epoch: 23, Steps: 52 | Train Loss: 0.4020188 Vali Loss: 1.3005528 Test Loss: 0.3532206
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 24 cost time: 1.6085662841796875
Epoch: 24, Steps: 52 | Train Loss: 0.4011405 Vali Loss: 1.2955348 Test Loss: 0.3519229
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 25 cost time: 1.611652135848999
Epoch: 25, Steps: 52 | Train Loss: 0.4001474 Vali Loss: 1.2970934 Test Loss: 0.3535019
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 26 cost time: 1.6117162704467773
Epoch: 26, Steps: 52 | Train Loss: 0.4010034 Vali Loss: 1.3016144 Test Loss: 0.3527178
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 27 cost time: 1.615339756011963
Epoch: 27, Steps: 52 | Train Loss: 0.4004861 Vali Loss: 1.3001766 Test Loss: 0.3526434
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 28 cost time: 1.6116290092468262
Epoch: 28, Steps: 52 | Train Loss: 0.3998240 Vali Loss: 1.2967068 Test Loss: 0.3521670
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 29 cost time: 1.613699197769165
Epoch: 29, Steps: 52 | Train Loss: 0.3998516 Vali Loss: 1.2947029 Test Loss: 0.3533927
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 30 cost time: 1.6151463985443115
Epoch: 30, Steps: 52 | Train Loss: 0.4010087 Vali Loss: 1.2906897 Test Loss: 0.3522799
Validation loss decreased (1.293952 --> 1.290690).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 31 cost time: 1.6165876388549805
Epoch: 31, Steps: 52 | Train Loss: 0.3976114 Vali Loss: 1.2920995 Test Loss: 0.3524149
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 32 cost time: 1.6140680313110352
Epoch: 32, Steps: 52 | Train Loss: 0.3995889 Vali Loss: 1.3000482 Test Loss: 0.3539594
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 33 cost time: 1.6183974742889404
Epoch: 33, Steps: 52 | Train Loss: 0.3995617 Vali Loss: 1.2936345 Test Loss: 0.3532351
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 34 cost time: 1.6135284900665283
Epoch: 34, Steps: 52 | Train Loss: 0.3990545 Vali Loss: 1.2948012 Test Loss: 0.3526761
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 35 cost time: 1.6124296188354492
Epoch: 35, Steps: 52 | Train Loss: 0.3995881 Vali Loss: 1.2977519 Test Loss: 0.3527992
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 36 cost time: 1.6152329444885254
Epoch: 36, Steps: 52 | Train Loss: 0.3985505 Vali Loss: 1.2887965 Test Loss: 0.3528580
Validation loss decreased (1.290690 --> 1.288797).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 37 cost time: 1.6178371906280518
Epoch: 37, Steps: 52 | Train Loss: 0.3984457 Vali Loss: 1.2899419 Test Loss: 0.3537925
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 38 cost time: 1.6117675304412842
Epoch: 38, Steps: 52 | Train Loss: 0.3996877 Vali Loss: 1.2994795 Test Loss: 0.3521047
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 39 cost time: 1.6117379665374756
Epoch: 39, Steps: 52 | Train Loss: 0.3995007 Vali Loss: 1.3000710 Test Loss: 0.3523180
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 40 cost time: 1.6111030578613281
Epoch: 40, Steps: 52 | Train Loss: 0.3989715 Vali Loss: 1.2910751 Test Loss: 0.3526134
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 41 cost time: 1.6159684658050537
Epoch: 41, Steps: 52 | Train Loss: 0.3992065 Vali Loss: 1.2954624 Test Loss: 0.3530818
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 42 cost time: 1.6118128299713135
Epoch: 42, Steps: 52 | Train Loss: 0.3987573 Vali Loss: 1.2963622 Test Loss: 0.3527652
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 43 cost time: 1.6128504276275635
Epoch: 43, Steps: 52 | Train Loss: 0.3989154 Vali Loss: 1.2989429 Test Loss: 0.3538463
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 44 cost time: 1.611255168914795
Epoch: 44, Steps: 52 | Train Loss: 0.3984168 Vali Loss: 1.2961364 Test Loss: 0.3533752
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 45 cost time: 1.6104776859283447
Epoch: 45, Steps: 52 | Train Loss: 0.3994511 Vali Loss: 1.2973939 Test Loss: 0.3526888
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 46 cost time: 1.612304449081421
Epoch: 46, Steps: 52 | Train Loss: 0.3983625 Vali Loss: 1.2940655 Test Loss: 0.3527082
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 47 cost time: 1.6178743839263916
Epoch: 47, Steps: 52 | Train Loss: 0.3994393 Vali Loss: 1.2880391 Test Loss: 0.3527134
Validation loss decreased (1.288797 --> 1.288039).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 48 cost time: 1.613767147064209
Epoch: 48, Steps: 52 | Train Loss: 0.3998020 Vali Loss: 1.2882199 Test Loss: 0.3533230
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 49 cost time: 1.61527681350708
Epoch: 49, Steps: 52 | Train Loss: 0.3990800 Vali Loss: 1.2923410 Test Loss: 0.3531065
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 50 cost time: 1.6144814491271973
Epoch: 50, Steps: 52 | Train Loss: 0.3972845 Vali Loss: 1.2880826 Test Loss: 0.3519228
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 51 cost time: 1.612910509109497
Epoch: 51, Steps: 52 | Train Loss: 0.3988657 Vali Loss: 1.2925239 Test Loss: 0.3529990
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 52 cost time: 1.6099166870117188
Epoch: 52, Steps: 52 | Train Loss: 0.3986231 Vali Loss: 1.2908473 Test Loss: 0.3524087
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 53 cost time: 1.6104881763458252
Epoch: 53, Steps: 52 | Train Loss: 0.3979948 Vali Loss: 1.2972591 Test Loss: 0.3531297
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 54 cost time: 1.609971046447754
Epoch: 54, Steps: 52 | Train Loss: 0.3997514 Vali Loss: 1.2909688 Test Loss: 0.3524969
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 55 cost time: 1.612992525100708
Epoch: 55, Steps: 52 | Train Loss: 0.3991935 Vali Loss: 1.3018060 Test Loss: 0.3528764
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 56 cost time: 1.613265037536621
Epoch: 56, Steps: 52 | Train Loss: 0.3999139 Vali Loss: 1.2967516 Test Loss: 0.3537087
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 57 cost time: 1.6153757572174072
Epoch: 57, Steps: 52 | Train Loss: 0.3994634 Vali Loss: 1.2914337 Test Loss: 0.3522313
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 58 cost time: 1.6124277114868164
Epoch: 58, Steps: 52 | Train Loss: 0.3993003 Vali Loss: 1.2947563 Test Loss: 0.3536111
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 59 cost time: 1.6156141757965088
Epoch: 59, Steps: 52 | Train Loss: 0.3993584 Vali Loss: 1.3002063 Test Loss: 0.3525066
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 60 cost time: 1.6096432209014893
Epoch: 60, Steps: 52 | Train Loss: 0.4011506 Vali Loss: 1.2921902 Test Loss: 0.3535467
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3527134358882904, mae:0.40318986773490906, rse:0.48654139041900635
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06185483932495117 GB
Epoch: 1 cost time: 2.1167588233947754
Epoch: 1, Steps: 52 | Train Loss: 0.6900500 Vali Loss: 2.1234667 Test Loss: 1.3653734
Validation loss decreased (inf --> 2.123467).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 2 cost time: 0.7405591011047363
Epoch: 2, Steps: 52 | Train Loss: 0.5422068 Vali Loss: 1.4316082 Test Loss: 0.4439986
Validation loss decreased (2.123467 --> 1.431608).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 3 cost time: 0.7308905124664307
Epoch: 3, Steps: 52 | Train Loss: 0.4440063 Vali Loss: 1.3875850 Test Loss: 0.4119815
Validation loss decreased (1.431608 --> 1.387585).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 4 cost time: 0.7544887065887451
Epoch: 4, Steps: 52 | Train Loss: 0.4274072 Vali Loss: 1.3620353 Test Loss: 0.3832119
Validation loss decreased (1.387585 --> 1.362035).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 5 cost time: 0.756537675857544
Epoch: 5, Steps: 52 | Train Loss: 0.4198308 Vali Loss: 1.3567393 Test Loss: 0.3731474
Validation loss decreased (1.362035 --> 1.356739).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 6 cost time: 1.648789405822754
Epoch: 6, Steps: 52 | Train Loss: 0.4160506 Vali Loss: 1.3357471 Test Loss: 0.3654202
Validation loss decreased (1.356739 --> 1.335747).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 7 cost time: 1.6714015007019043
Epoch: 7, Steps: 52 | Train Loss: 0.4125397 Vali Loss: 1.3292916 Test Loss: 0.3618127
Validation loss decreased (1.335747 --> 1.329292).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 8 cost time: 1.667372226715088
Epoch: 8, Steps: 52 | Train Loss: 0.4090700 Vali Loss: 1.3293942 Test Loss: 0.3596972
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 9 cost time: 1.6734559535980225
Epoch: 9, Steps: 52 | Train Loss: 0.4091980 Vali Loss: 1.3073103 Test Loss: 0.3588547
Validation loss decreased (1.329292 --> 1.307310).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 10 cost time: 1.6706352233886719
Epoch: 10, Steps: 52 | Train Loss: 0.4043812 Vali Loss: 1.3146360 Test Loss: 0.3564859
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 11 cost time: 1.6735928058624268
Epoch: 11, Steps: 52 | Train Loss: 0.4050871 Vali Loss: 1.3139623 Test Loss: 0.3570422
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 12 cost time: 1.6634557247161865
Epoch: 12, Steps: 52 | Train Loss: 0.4042181 Vali Loss: 1.3084008 Test Loss: 0.3571016
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 13 cost time: 1.660301923751831
Epoch: 13, Steps: 52 | Train Loss: 0.4028466 Vali Loss: 1.3111606 Test Loss: 0.3564308
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 14 cost time: 1.6643400192260742
Epoch: 14, Steps: 52 | Train Loss: 0.4022296 Vali Loss: 1.3003101 Test Loss: 0.3547154
Validation loss decreased (1.307310 --> 1.300310).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 15 cost time: 1.6635890007019043
Epoch: 15, Steps: 52 | Train Loss: 0.4019058 Vali Loss: 1.3008819 Test Loss: 0.3561968
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 16 cost time: 1.661475658416748
Epoch: 16, Steps: 52 | Train Loss: 0.4021369 Vali Loss: 1.3066154 Test Loss: 0.3560267
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 17 cost time: 1.6716930866241455
Epoch: 17, Steps: 52 | Train Loss: 0.4002897 Vali Loss: 1.3008523 Test Loss: 0.3567011
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 18 cost time: 1.6622893810272217
Epoch: 18, Steps: 52 | Train Loss: 0.3995182 Vali Loss: 1.2982026 Test Loss: 0.3556220
Validation loss decreased (1.300310 --> 1.298203).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 19 cost time: 1.6722640991210938
Epoch: 19, Steps: 52 | Train Loss: 0.3996018 Vali Loss: 1.2928934 Test Loss: 0.3561925
Validation loss decreased (1.298203 --> 1.292893).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 20 cost time: 1.662614107131958
Epoch: 20, Steps: 52 | Train Loss: 0.4008817 Vali Loss: 1.3045232 Test Loss: 0.3561228
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 21 cost time: 1.6753888130187988
Epoch: 21, Steps: 52 | Train Loss: 0.3977887 Vali Loss: 1.2964492 Test Loss: 0.3562045
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 22 cost time: 1.6664140224456787
Epoch: 22, Steps: 52 | Train Loss: 0.3982305 Vali Loss: 1.3002515 Test Loss: 0.3563207
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 23 cost time: 1.674835205078125
Epoch: 23, Steps: 52 | Train Loss: 0.3999219 Vali Loss: 1.2923944 Test Loss: 0.3559915
Validation loss decreased (1.292893 --> 1.292394).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 24 cost time: 1.6644015312194824
Epoch: 24, Steps: 52 | Train Loss: 0.3978582 Vali Loss: 1.2999971 Test Loss: 0.3558363
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 25 cost time: 1.6724326610565186
Epoch: 25, Steps: 52 | Train Loss: 0.3985183 Vali Loss: 1.2982690 Test Loss: 0.3557033
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 26 cost time: 1.6668689250946045
Epoch: 26, Steps: 52 | Train Loss: 0.3989611 Vali Loss: 1.3036349 Test Loss: 0.3557584
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 27 cost time: 1.671177864074707
Epoch: 27, Steps: 52 | Train Loss: 0.3979934 Vali Loss: 1.2917037 Test Loss: 0.3550900
Validation loss decreased (1.292394 --> 1.291704).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 28 cost time: 1.6630885601043701
Epoch: 28, Steps: 52 | Train Loss: 0.3989957 Vali Loss: 1.2954719 Test Loss: 0.3558683
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 29 cost time: 1.665475845336914
Epoch: 29, Steps: 52 | Train Loss: 0.3990808 Vali Loss: 1.2945162 Test Loss: 0.3548537
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 30 cost time: 1.6666014194488525
Epoch: 30, Steps: 52 | Train Loss: 0.3986949 Vali Loss: 1.2951436 Test Loss: 0.3551470
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 31 cost time: 1.6660480499267578
Epoch: 31, Steps: 52 | Train Loss: 0.3959780 Vali Loss: 1.3020480 Test Loss: 0.3553209
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 32 cost time: 1.6614398956298828
Epoch: 32, Steps: 52 | Train Loss: 0.3989171 Vali Loss: 1.2918661 Test Loss: 0.3559725
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 33 cost time: 1.6639769077301025
Epoch: 33, Steps: 52 | Train Loss: 0.3965335 Vali Loss: 1.2918967 Test Loss: 0.3555058
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 34 cost time: 1.6692450046539307
Epoch: 34, Steps: 52 | Train Loss: 0.3984820 Vali Loss: 1.2922041 Test Loss: 0.3559000
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 35 cost time: 1.6630618572235107
Epoch: 35, Steps: 52 | Train Loss: 0.3965022 Vali Loss: 1.2964041 Test Loss: 0.3553677
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 36 cost time: 1.6734178066253662
Epoch: 36, Steps: 52 | Train Loss: 0.3965655 Vali Loss: 1.2955877 Test Loss: 0.3551653
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 37 cost time: 1.6715152263641357
Epoch: 37, Steps: 52 | Train Loss: 0.3966682 Vali Loss: 1.2939510 Test Loss: 0.3556128
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 38 cost time: 1.6712384223937988
Epoch: 38, Steps: 52 | Train Loss: 0.3974416 Vali Loss: 1.2962036 Test Loss: 0.3560666
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 39 cost time: 1.6721489429473877
Epoch: 39, Steps: 52 | Train Loss: 0.3978530 Vali Loss: 1.2967172 Test Loss: 0.3554188
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 40 cost time: 1.6748158931732178
Epoch: 40, Steps: 52 | Train Loss: 0.3967422 Vali Loss: 1.3008132 Test Loss: 0.3562079
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 41 cost time: 1.6658122539520264
Epoch: 41, Steps: 52 | Train Loss: 0.3966739 Vali Loss: 1.2880495 Test Loss: 0.3551422
Validation loss decreased (1.291704 --> 1.288049).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 42 cost time: 1.664560079574585
Epoch: 42, Steps: 52 | Train Loss: 0.3976401 Vali Loss: 1.2998741 Test Loss: 0.3561017
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 43 cost time: 1.6654772758483887
Epoch: 43, Steps: 52 | Train Loss: 0.3968388 Vali Loss: 1.3012898 Test Loss: 0.3561386
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 44 cost time: 1.6669635772705078
Epoch: 44, Steps: 52 | Train Loss: 0.3974933 Vali Loss: 1.2990242 Test Loss: 0.3556672
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 45 cost time: 1.6689608097076416
Epoch: 45, Steps: 52 | Train Loss: 0.3970254 Vali Loss: 1.2967582 Test Loss: 0.3559839
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 46 cost time: 1.6714227199554443
Epoch: 46, Steps: 52 | Train Loss: 0.3978862 Vali Loss: 1.2897565 Test Loss: 0.3549617
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 47 cost time: 1.6676356792449951
Epoch: 47, Steps: 52 | Train Loss: 0.3979145 Vali Loss: 1.2890129 Test Loss: 0.3568727
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 48 cost time: 1.675947666168213
Epoch: 48, Steps: 52 | Train Loss: 0.3967088 Vali Loss: 1.2892226 Test Loss: 0.3550104
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 49 cost time: 1.66259765625
Epoch: 49, Steps: 52 | Train Loss: 0.3973765 Vali Loss: 1.2980056 Test Loss: 0.3556712
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 50 cost time: 1.6713151931762695
Epoch: 50, Steps: 52 | Train Loss: 0.3971683 Vali Loss: 1.2977993 Test Loss: 0.3558508
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 51 cost time: 1.667252540588379
Epoch: 51, Steps: 52 | Train Loss: 0.3962426 Vali Loss: 1.2834849 Test Loss: 0.3554760
Validation loss decreased (1.288049 --> 1.283485).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 52 cost time: 1.6694364547729492
Epoch: 52, Steps: 52 | Train Loss: 0.3968223 Vali Loss: 1.2929577 Test Loss: 0.3549871
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 53 cost time: 1.6712663173675537
Epoch: 53, Steps: 52 | Train Loss: 0.3973775 Vali Loss: 1.2949575 Test Loss: 0.3561336
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 54 cost time: 1.6748833656311035
Epoch: 54, Steps: 52 | Train Loss: 0.3981105 Vali Loss: 1.3000090 Test Loss: 0.3551649
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 55 cost time: 1.6623122692108154
Epoch: 55, Steps: 52 | Train Loss: 0.3966920 Vali Loss: 1.2954473 Test Loss: 0.3549460
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 56 cost time: 1.6642045974731445
Epoch: 56, Steps: 52 | Train Loss: 0.3964285 Vali Loss: 1.2895288 Test Loss: 0.3547636
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 57 cost time: 1.666121244430542
Epoch: 57, Steps: 52 | Train Loss: 0.3960014 Vali Loss: 1.2929358 Test Loss: 0.3555699
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 58 cost time: 1.6717076301574707
Epoch: 58, Steps: 52 | Train Loss: 0.3977334 Vali Loss: 1.2942454 Test Loss: 0.3553571
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 59 cost time: 1.6693649291992188
Epoch: 59, Steps: 52 | Train Loss: 0.3969203 Vali Loss: 1.2947391 Test Loss: 0.3545408
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 60 cost time: 1.670522689819336
Epoch: 60, Steps: 52 | Train Loss: 0.3982401 Vali Loss: 1.2944434 Test Loss: 0.3551086
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3554759919643402, mae:0.40794625878334045, rse:0.4884430766105652
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.054323673248291016 GB
Epoch: 1 cost time: 2.071112871170044
Epoch: 1, Steps: 52 | Train Loss: 0.7621994 Vali Loss: 2.2062149 Test Loss: 1.4011416
Validation loss decreased (inf --> 2.206215).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 2 cost time: 0.6973412036895752
Epoch: 2, Steps: 52 | Train Loss: 0.6866251 Vali Loss: 1.8224678 Test Loss: 0.9783318
Validation loss decreased (2.206215 --> 1.822468).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 3 cost time: 0.7119991779327393
Epoch: 3, Steps: 52 | Train Loss: 0.5776273 Vali Loss: 1.5845006 Test Loss: 0.6798137
Validation loss decreased (1.822468 --> 1.584501).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 4 cost time: 0.6959896087646484
Epoch: 4, Steps: 52 | Train Loss: 0.5100725 Vali Loss: 1.4578589 Test Loss: 0.4925993
Validation loss decreased (1.584501 --> 1.457859).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 5 cost time: 0.709369421005249
Epoch: 5, Steps: 52 | Train Loss: 0.4744803 Vali Loss: 1.3997303 Test Loss: 0.4273151
Validation loss decreased (1.457859 --> 1.399730).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 6 cost time: 1.2584524154663086
Epoch: 6, Steps: 52 | Train Loss: 0.4551268 Vali Loss: 1.3919954 Test Loss: 0.4057887
Validation loss decreased (1.399730 --> 1.391995).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 7 cost time: 1.5521328449249268
Epoch: 7, Steps: 52 | Train Loss: 0.4468849 Vali Loss: 1.3681500 Test Loss: 0.3920117
Validation loss decreased (1.391995 --> 1.368150).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 8 cost time: 1.6078248023986816
Epoch: 8, Steps: 52 | Train Loss: 0.4421473 Vali Loss: 1.3695443 Test Loss: 0.3837395
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 9 cost time: 1.5722613334655762
Epoch: 9, Steps: 52 | Train Loss: 0.4367778 Vali Loss: 1.3665943 Test Loss: 0.3767585
Validation loss decreased (1.368150 --> 1.366594).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 10 cost time: 1.5538249015808105
Epoch: 10, Steps: 52 | Train Loss: 0.4355918 Vali Loss: 1.3604524 Test Loss: 0.3726143
Validation loss decreased (1.366594 --> 1.360452).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 11 cost time: 1.5554943084716797
Epoch: 11, Steps: 52 | Train Loss: 0.4331187 Vali Loss: 1.3540425 Test Loss: 0.3686781
Validation loss decreased (1.360452 --> 1.354043).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 12 cost time: 1.5538849830627441
Epoch: 12, Steps: 52 | Train Loss: 0.4288140 Vali Loss: 1.3559119 Test Loss: 0.3657393
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 13 cost time: 1.5561573505401611
Epoch: 13, Steps: 52 | Train Loss: 0.4279893 Vali Loss: 1.3525617 Test Loss: 0.3634049
Validation loss decreased (1.354043 --> 1.352562).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 14 cost time: 1.5574455261230469
Epoch: 14, Steps: 52 | Train Loss: 0.4249576 Vali Loss: 1.3412613 Test Loss: 0.3615816
Validation loss decreased (1.352562 --> 1.341261).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 15 cost time: 1.5668113231658936
Epoch: 15, Steps: 52 | Train Loss: 0.4233026 Vali Loss: 1.3470538 Test Loss: 0.3595123
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 16 cost time: 1.5685436725616455
Epoch: 16, Steps: 52 | Train Loss: 0.4229474 Vali Loss: 1.3408785 Test Loss: 0.3583955
Validation loss decreased (1.341261 --> 1.340878).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 17 cost time: 1.5734381675720215
Epoch: 17, Steps: 52 | Train Loss: 0.4207416 Vali Loss: 1.3345040 Test Loss: 0.3571159
Validation loss decreased (1.340878 --> 1.334504).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 18 cost time: 1.5476727485656738
Epoch: 18, Steps: 52 | Train Loss: 0.4202712 Vali Loss: 1.3366351 Test Loss: 0.3561616
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 19 cost time: 1.5682940483093262
Epoch: 19, Steps: 52 | Train Loss: 0.4177545 Vali Loss: 1.3289304 Test Loss: 0.3557090
Validation loss decreased (1.334504 --> 1.328930).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 20 cost time: 1.5702221393585205
Epoch: 20, Steps: 52 | Train Loss: 0.4195957 Vali Loss: 1.3298907 Test Loss: 0.3541906
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 21 cost time: 1.5641019344329834
Epoch: 21, Steps: 52 | Train Loss: 0.4166842 Vali Loss: 1.3276312 Test Loss: 0.3540081
Validation loss decreased (1.328930 --> 1.327631).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 22 cost time: 1.5527102947235107
Epoch: 22, Steps: 52 | Train Loss: 0.4166758 Vali Loss: 1.3306363 Test Loss: 0.3536167
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 23 cost time: 1.5595371723175049
Epoch: 23, Steps: 52 | Train Loss: 0.4182522 Vali Loss: 1.3241107 Test Loss: 0.3527998
Validation loss decreased (1.327631 --> 1.324111).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 24 cost time: 1.5507824420928955
Epoch: 24, Steps: 52 | Train Loss: 0.4177197 Vali Loss: 1.3343331 Test Loss: 0.3522829
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 25 cost time: 1.5597193241119385
Epoch: 25, Steps: 52 | Train Loss: 0.4162212 Vali Loss: 1.3192143 Test Loss: 0.3518505
Validation loss decreased (1.324111 --> 1.319214).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 26 cost time: 1.5552842617034912
Epoch: 26, Steps: 52 | Train Loss: 0.4167290 Vali Loss: 1.3248837 Test Loss: 0.3519370
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 27 cost time: 1.5594127178192139
Epoch: 27, Steps: 52 | Train Loss: 0.4153582 Vali Loss: 1.3235992 Test Loss: 0.3512737
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 28 cost time: 1.549865484237671
Epoch: 28, Steps: 52 | Train Loss: 0.4144289 Vali Loss: 1.3212129 Test Loss: 0.3514021
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 29 cost time: 1.5596177577972412
Epoch: 29, Steps: 52 | Train Loss: 0.4161473 Vali Loss: 1.3185229 Test Loss: 0.3504791
Validation loss decreased (1.319214 --> 1.318523).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 30 cost time: 1.5519521236419678
Epoch: 30, Steps: 52 | Train Loss: 0.4141016 Vali Loss: 1.3222295 Test Loss: 0.3507674
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 31 cost time: 1.5627617835998535
Epoch: 31, Steps: 52 | Train Loss: 0.4145587 Vali Loss: 1.3265404 Test Loss: 0.3509288
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 32 cost time: 1.5609564781188965
Epoch: 32, Steps: 52 | Train Loss: 0.4139554 Vali Loss: 1.3163185 Test Loss: 0.3504584
Validation loss decreased (1.318523 --> 1.316319).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 33 cost time: 1.5689191818237305
Epoch: 33, Steps: 52 | Train Loss: 0.4139356 Vali Loss: 1.3221812 Test Loss: 0.3500000
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 34 cost time: 1.5631537437438965
Epoch: 34, Steps: 52 | Train Loss: 0.4145311 Vali Loss: 1.3114843 Test Loss: 0.3501937
Validation loss decreased (1.316319 --> 1.311484).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 35 cost time: 1.57448148727417
Epoch: 35, Steps: 52 | Train Loss: 0.4134251 Vali Loss: 1.3226522 Test Loss: 0.3498906
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 36 cost time: 1.5692336559295654
Epoch: 36, Steps: 52 | Train Loss: 0.4121030 Vali Loss: 1.3266435 Test Loss: 0.3491738
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 37 cost time: 1.5702786445617676
Epoch: 37, Steps: 52 | Train Loss: 0.4134183 Vali Loss: 1.3202573 Test Loss: 0.3500162
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 38 cost time: 1.5589244365692139
Epoch: 38, Steps: 52 | Train Loss: 0.4131262 Vali Loss: 1.3218112 Test Loss: 0.3503016
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 39 cost time: 1.5660905838012695
Epoch: 39, Steps: 52 | Train Loss: 0.4131169 Vali Loss: 1.3250544 Test Loss: 0.3497040
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 40 cost time: 1.5633821487426758
Epoch: 40, Steps: 52 | Train Loss: 0.4144590 Vali Loss: 1.3197854 Test Loss: 0.3496843
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 41 cost time: 1.5748512744903564
Epoch: 41, Steps: 52 | Train Loss: 0.4135016 Vali Loss: 1.3227293 Test Loss: 0.3497355
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 42 cost time: 1.5697674751281738
Epoch: 42, Steps: 52 | Train Loss: 0.4128362 Vali Loss: 1.3202502 Test Loss: 0.3496991
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 43 cost time: 1.5668070316314697
Epoch: 43, Steps: 52 | Train Loss: 0.4131432 Vali Loss: 1.3146334 Test Loss: 0.3497546
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 44 cost time: 1.5686445236206055
Epoch: 44, Steps: 52 | Train Loss: 0.4138387 Vali Loss: 1.3204807 Test Loss: 0.3494518
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 45 cost time: 1.5568060874938965
Epoch: 45, Steps: 52 | Train Loss: 0.4132118 Vali Loss: 1.3151374 Test Loss: 0.3496865
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 46 cost time: 1.5667328834533691
Epoch: 46, Steps: 52 | Train Loss: 0.4121157 Vali Loss: 1.3116711 Test Loss: 0.3500074
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 47 cost time: 1.5685546398162842
Epoch: 47, Steps: 52 | Train Loss: 0.4123356 Vali Loss: 1.3197291 Test Loss: 0.3499594
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 48 cost time: 1.5646157264709473
Epoch: 48, Steps: 52 | Train Loss: 0.4129959 Vali Loss: 1.3207717 Test Loss: 0.3495366
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 49 cost time: 1.5659966468811035
Epoch: 49, Steps: 52 | Train Loss: 0.4118369 Vali Loss: 1.3197212 Test Loss: 0.3494884
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 50 cost time: 1.5577263832092285
Epoch: 50, Steps: 52 | Train Loss: 0.4131354 Vali Loss: 1.3253322 Test Loss: 0.3497891
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 51 cost time: 1.5557665824890137
Epoch: 51, Steps: 52 | Train Loss: 0.4122278 Vali Loss: 1.3202373 Test Loss: 0.3495176
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 52 cost time: 1.5611217021942139
Epoch: 52, Steps: 52 | Train Loss: 0.4121271 Vali Loss: 1.3241218 Test Loss: 0.3493728
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 53 cost time: 1.55979585647583
Epoch: 53, Steps: 52 | Train Loss: 0.4116929 Vali Loss: 1.3203763 Test Loss: 0.3493137
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 54 cost time: 1.5675327777862549
Epoch: 54, Steps: 52 | Train Loss: 0.4127343 Vali Loss: 1.3129768 Test Loss: 0.3492718
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 55 cost time: 1.5675883293151855
Epoch: 55, Steps: 52 | Train Loss: 0.4103825 Vali Loss: 1.3141866 Test Loss: 0.3490817
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 56 cost time: 1.5614337921142578
Epoch: 56, Steps: 52 | Train Loss: 0.4135846 Vali Loss: 1.3242435 Test Loss: 0.3495142
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 57 cost time: 1.573185920715332
Epoch: 57, Steps: 52 | Train Loss: 0.4134132 Vali Loss: 1.3125205 Test Loss: 0.3492814
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 58 cost time: 1.5715160369873047
Epoch: 58, Steps: 52 | Train Loss: 0.4115100 Vali Loss: 1.3208367 Test Loss: 0.3492158
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 59 cost time: 1.5574569702148438
Epoch: 59, Steps: 52 | Train Loss: 0.4121421 Vali Loss: 1.3192996 Test Loss: 0.3493981
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 60 cost time: 1.5804216861724854
Epoch: 60, Steps: 52 | Train Loss: 0.4135618 Vali Loss: 1.3215586 Test Loss: 0.3493488
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35019373893737793, mae:0.39248910546302795, rse:0.48480042815208435
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.058718204498291016 GB
Epoch: 1 cost time: 2.122821569442749
Epoch: 1, Steps: 52 | Train Loss: 0.6994809 Vali Loss: 2.1321537 Test Loss: 1.3310493
Validation loss decreased (inf --> 2.132154).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 2 cost time: 0.7346086502075195
Epoch: 2, Steps: 52 | Train Loss: 0.5629608 Vali Loss: 1.4769729 Test Loss: 0.5377763
Validation loss decreased (2.132154 --> 1.476973).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 3 cost time: 0.7393536567687988
Epoch: 3, Steps: 52 | Train Loss: 0.4563402 Vali Loss: 1.3767712 Test Loss: 0.4063761
Validation loss decreased (1.476973 --> 1.376771).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 4 cost time: 0.7387185096740723
Epoch: 4, Steps: 52 | Train Loss: 0.4339891 Vali Loss: 1.3512764 Test Loss: 0.3867619
Validation loss decreased (1.376771 --> 1.351276).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 5 cost time: 0.7379999160766602
Epoch: 5, Steps: 52 | Train Loss: 0.4251626 Vali Loss: 1.3559158 Test Loss: 0.3760996
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 6 cost time: 1.5763945579528809
Epoch: 6, Steps: 52 | Train Loss: 0.4191142 Vali Loss: 1.3455750 Test Loss: 0.3695766
Validation loss decreased (1.351276 --> 1.345575).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 7 cost time: 1.6230170726776123
Epoch: 7, Steps: 52 | Train Loss: 0.4159225 Vali Loss: 1.3445934 Test Loss: 0.3642580
Validation loss decreased (1.345575 --> 1.344593).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 8 cost time: 1.6312546730041504
Epoch: 8, Steps: 52 | Train Loss: 0.4145458 Vali Loss: 1.3373735 Test Loss: 0.3606121
Validation loss decreased (1.344593 --> 1.337373).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 9 cost time: 1.6327013969421387
Epoch: 9, Steps: 52 | Train Loss: 0.4111332 Vali Loss: 1.3314292 Test Loss: 0.3584614
Validation loss decreased (1.337373 --> 1.331429).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 10 cost time: 1.6274490356445312
Epoch: 10, Steps: 52 | Train Loss: 0.4083350 Vali Loss: 1.3220475 Test Loss: 0.3569219
Validation loss decreased (1.331429 --> 1.322047).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 11 cost time: 1.6298129558563232
Epoch: 11, Steps: 52 | Train Loss: 0.4065183 Vali Loss: 1.3240681 Test Loss: 0.3556497
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 12 cost time: 1.6363821029663086
Epoch: 12, Steps: 52 | Train Loss: 0.4085388 Vali Loss: 1.3119318 Test Loss: 0.3546818
Validation loss decreased (1.322047 --> 1.311932).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 13 cost time: 1.6243903636932373
Epoch: 13, Steps: 52 | Train Loss: 0.4039127 Vali Loss: 1.3116534 Test Loss: 0.3543403
Validation loss decreased (1.311932 --> 1.311653).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 14 cost time: 1.635955810546875
Epoch: 14, Steps: 52 | Train Loss: 0.4046672 Vali Loss: 1.3131307 Test Loss: 0.3527066
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 15 cost time: 1.6314561367034912
Epoch: 15, Steps: 52 | Train Loss: 0.4041140 Vali Loss: 1.3130972 Test Loss: 0.3524075
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 16 cost time: 1.6270713806152344
Epoch: 16, Steps: 52 | Train Loss: 0.4044589 Vali Loss: 1.3163611 Test Loss: 0.3520170
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 17 cost time: 1.6254158020019531
Epoch: 17, Steps: 52 | Train Loss: 0.4022271 Vali Loss: 1.3002582 Test Loss: 0.3525749
Validation loss decreased (1.311653 --> 1.300258).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 18 cost time: 1.635399580001831
Epoch: 18, Steps: 52 | Train Loss: 0.4018309 Vali Loss: 1.3028338 Test Loss: 0.3515086
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 19 cost time: 1.6256859302520752
Epoch: 19, Steps: 52 | Train Loss: 0.4013961 Vali Loss: 1.3070858 Test Loss: 0.3521893
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 20 cost time: 1.6251652240753174
Epoch: 20, Steps: 52 | Train Loss: 0.4005006 Vali Loss: 1.3045030 Test Loss: 0.3513261
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 21 cost time: 1.6251490116119385
Epoch: 21, Steps: 52 | Train Loss: 0.4015840 Vali Loss: 1.2993231 Test Loss: 0.3506636
Validation loss decreased (1.300258 --> 1.299323).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 22 cost time: 1.6279101371765137
Epoch: 22, Steps: 52 | Train Loss: 0.4007461 Vali Loss: 1.3029799 Test Loss: 0.3513396
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 23 cost time: 1.6286144256591797
Epoch: 23, Steps: 52 | Train Loss: 0.3997808 Vali Loss: 1.3004074 Test Loss: 0.3506664
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 24 cost time: 1.632406234741211
Epoch: 24, Steps: 52 | Train Loss: 0.4005088 Vali Loss: 1.3084471 Test Loss: 0.3511011
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 25 cost time: 1.6264598369598389
Epoch: 25, Steps: 52 | Train Loss: 0.3992239 Vali Loss: 1.3005220 Test Loss: 0.3501847
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 26 cost time: 1.635709524154663
Epoch: 26, Steps: 52 | Train Loss: 0.3997672 Vali Loss: 1.2974041 Test Loss: 0.3500512
Validation loss decreased (1.299323 --> 1.297404).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 27 cost time: 1.6328463554382324
Epoch: 27, Steps: 52 | Train Loss: 0.4011245 Vali Loss: 1.2914259 Test Loss: 0.3505523
Validation loss decreased (1.297404 --> 1.291426).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 28 cost time: 1.6294875144958496
Epoch: 28, Steps: 52 | Train Loss: 0.4003862 Vali Loss: 1.2958705 Test Loss: 0.3509756
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 29 cost time: 1.626206636428833
Epoch: 29, Steps: 52 | Train Loss: 0.3971144 Vali Loss: 1.3032708 Test Loss: 0.3496719
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 30 cost time: 1.6343090534210205
Epoch: 30, Steps: 52 | Train Loss: 0.3987078 Vali Loss: 1.2993989 Test Loss: 0.3497312
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 31 cost time: 1.628594160079956
Epoch: 31, Steps: 52 | Train Loss: 0.3986254 Vali Loss: 1.2950833 Test Loss: 0.3498719
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 32 cost time: 1.6321744918823242
Epoch: 32, Steps: 52 | Train Loss: 0.3988907 Vali Loss: 1.2927413 Test Loss: 0.3495810
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 33 cost time: 1.6318638324737549
Epoch: 33, Steps: 52 | Train Loss: 0.3978974 Vali Loss: 1.2902679 Test Loss: 0.3497317
Validation loss decreased (1.291426 --> 1.290268).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 34 cost time: 1.6306655406951904
Epoch: 34, Steps: 52 | Train Loss: 0.4001256 Vali Loss: 1.2993009 Test Loss: 0.3499114
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 35 cost time: 1.6261184215545654
Epoch: 35, Steps: 52 | Train Loss: 0.3988206 Vali Loss: 1.2972715 Test Loss: 0.3498099
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 36 cost time: 1.6265554428100586
Epoch: 36, Steps: 52 | Train Loss: 0.3989427 Vali Loss: 1.2998585 Test Loss: 0.3500997
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 37 cost time: 1.6234238147735596
Epoch: 37, Steps: 52 | Train Loss: 0.3986524 Vali Loss: 1.3002173 Test Loss: 0.3502164
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 38 cost time: 1.6308166980743408
Epoch: 38, Steps: 52 | Train Loss: 0.3975631 Vali Loss: 1.2948147 Test Loss: 0.3498026
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 39 cost time: 1.6245167255401611
Epoch: 39, Steps: 52 | Train Loss: 0.3989477 Vali Loss: 1.2974870 Test Loss: 0.3492898
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 40 cost time: 1.6295146942138672
Epoch: 40, Steps: 52 | Train Loss: 0.3976576 Vali Loss: 1.2963252 Test Loss: 0.3501160
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 41 cost time: 1.627096176147461
Epoch: 41, Steps: 52 | Train Loss: 0.3993980 Vali Loss: 1.3017745 Test Loss: 0.3499767
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 42 cost time: 1.632035732269287
Epoch: 42, Steps: 52 | Train Loss: 0.3987615 Vali Loss: 1.3010445 Test Loss: 0.3491048
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 43 cost time: 1.6242344379425049
Epoch: 43, Steps: 52 | Train Loss: 0.3976629 Vali Loss: 1.2943392 Test Loss: 0.3495569
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 44 cost time: 1.632502555847168
Epoch: 44, Steps: 52 | Train Loss: 0.3992855 Vali Loss: 1.2934191 Test Loss: 0.3501410
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 45 cost time: 1.6278729438781738
Epoch: 45, Steps: 52 | Train Loss: 0.3968938 Vali Loss: 1.3028207 Test Loss: 0.3494249
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 46 cost time: 1.628352403640747
Epoch: 46, Steps: 52 | Train Loss: 0.3967211 Vali Loss: 1.2983073 Test Loss: 0.3496449
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 47 cost time: 1.6283364295959473
Epoch: 47, Steps: 52 | Train Loss: 0.3996231 Vali Loss: 1.2876914 Test Loss: 0.3493131
Validation loss decreased (1.290268 --> 1.287691).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 48 cost time: 1.6364312171936035
Epoch: 48, Steps: 52 | Train Loss: 0.3976726 Vali Loss: 1.3013172 Test Loss: 0.3499236
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 49 cost time: 1.6215102672576904
Epoch: 49, Steps: 52 | Train Loss: 0.3986499 Vali Loss: 1.2905451 Test Loss: 0.3499541
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 50 cost time: 1.6284117698669434
Epoch: 50, Steps: 52 | Train Loss: 0.3981174 Vali Loss: 1.2944210 Test Loss: 0.3493552
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 51 cost time: 1.6259770393371582
Epoch: 51, Steps: 52 | Train Loss: 0.3990902 Vali Loss: 1.2914495 Test Loss: 0.3496006
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 52 cost time: 1.6324422359466553
Epoch: 52, Steps: 52 | Train Loss: 0.3972577 Vali Loss: 1.2955776 Test Loss: 0.3493054
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 53 cost time: 1.627521276473999
Epoch: 53, Steps: 52 | Train Loss: 0.3988254 Vali Loss: 1.2933266 Test Loss: 0.3490388
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 54 cost time: 1.636960506439209
Epoch: 54, Steps: 52 | Train Loss: 0.3991773 Vali Loss: 1.2876849 Test Loss: 0.3502609
Validation loss decreased (1.287691 --> 1.287685).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 55 cost time: 1.6264886856079102
Epoch: 55, Steps: 52 | Train Loss: 0.4005000 Vali Loss: 1.3022624 Test Loss: 0.3493425
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 56 cost time: 1.629551887512207
Epoch: 56, Steps: 52 | Train Loss: 0.3978060 Vali Loss: 1.2964410 Test Loss: 0.3497850
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 57 cost time: 1.6288459300994873
Epoch: 57, Steps: 52 | Train Loss: 0.3983215 Vali Loss: 1.2930396 Test Loss: 0.3497298
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 58 cost time: 1.632777214050293
Epoch: 58, Steps: 52 | Train Loss: 0.3998514 Vali Loss: 1.3029848 Test Loss: 0.3497285
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 59 cost time: 1.6288855075836182
Epoch: 59, Steps: 52 | Train Loss: 0.3983454 Vali Loss: 1.2976129 Test Loss: 0.3496050
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 60 cost time: 1.6323084831237793
Epoch: 60, Steps: 52 | Train Loss: 0.3998348 Vali Loss: 1.2972946 Test Loss: 0.3496239
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3502609431743622, mae:0.399273157119751, rse:0.48484694957733154
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.062016963958740234 GB
Epoch: 1 cost time: 2.1532020568847656
Epoch: 1, Steps: 52 | Train Loss: 0.6742202 Vali Loss: 2.0805759 Test Loss: 1.3146868
Validation loss decreased (inf --> 2.080576).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 2 cost time: 0.7586266994476318
Epoch: 2, Steps: 52 | Train Loss: 0.5424900 Vali Loss: 1.4217138 Test Loss: 0.4484177
Validation loss decreased (2.080576 --> 1.421714).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 3 cost time: 0.7644610404968262
Epoch: 3, Steps: 52 | Train Loss: 0.4451410 Vali Loss: 1.3794577 Test Loss: 0.4085606
Validation loss decreased (1.421714 --> 1.379458).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 4 cost time: 0.7519998550415039
Epoch: 4, Steps: 52 | Train Loss: 0.4276945 Vali Loss: 1.3552239 Test Loss: 0.3819306
Validation loss decreased (1.379458 --> 1.355224).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 5 cost time: 0.754000186920166
Epoch: 5, Steps: 52 | Train Loss: 0.4213345 Vali Loss: 1.3564802 Test Loss: 0.3724174
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 6 cost time: 1.6629915237426758
Epoch: 6, Steps: 52 | Train Loss: 0.4148312 Vali Loss: 1.3475236 Test Loss: 0.3649122
Validation loss decreased (1.355224 --> 1.347524).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 7 cost time: 1.6741886138916016
Epoch: 7, Steps: 52 | Train Loss: 0.4129669 Vali Loss: 1.3331116 Test Loss: 0.3606963
Validation loss decreased (1.347524 --> 1.333112).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 8 cost time: 1.6869902610778809
Epoch: 8, Steps: 52 | Train Loss: 0.4094338 Vali Loss: 1.3259189 Test Loss: 0.3578146
Validation loss decreased (1.333112 --> 1.325919).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 9 cost time: 1.6804697513580322
Epoch: 9, Steps: 52 | Train Loss: 0.4084298 Vali Loss: 1.3208964 Test Loss: 0.3556734
Validation loss decreased (1.325919 --> 1.320896).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 10 cost time: 1.6845965385437012
Epoch: 10, Steps: 52 | Train Loss: 0.4055525 Vali Loss: 1.3246717 Test Loss: 0.3557644
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 11 cost time: 1.6775100231170654
Epoch: 11, Steps: 52 | Train Loss: 0.4038011 Vali Loss: 1.3196054 Test Loss: 0.3541869
Validation loss decreased (1.320896 --> 1.319605).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 12 cost time: 1.6772489547729492
Epoch: 12, Steps: 52 | Train Loss: 0.4037889 Vali Loss: 1.3058171 Test Loss: 0.3537905
Validation loss decreased (1.319605 --> 1.305817).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 13 cost time: 1.6773009300231934
Epoch: 13, Steps: 52 | Train Loss: 0.4014984 Vali Loss: 1.3114946 Test Loss: 0.3533729
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 14 cost time: 1.6835498809814453
Epoch: 14, Steps: 52 | Train Loss: 0.4025045 Vali Loss: 1.3113720 Test Loss: 0.3536390
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 15 cost time: 1.6810767650604248
Epoch: 15, Steps: 52 | Train Loss: 0.4017377 Vali Loss: 1.2991047 Test Loss: 0.3526995
Validation loss decreased (1.305817 --> 1.299105).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 16 cost time: 1.680311918258667
Epoch: 16, Steps: 52 | Train Loss: 0.3999743 Vali Loss: 1.3090199 Test Loss: 0.3532950
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 17 cost time: 1.6708815097808838
Epoch: 17, Steps: 52 | Train Loss: 0.3996958 Vali Loss: 1.2912080 Test Loss: 0.3522289
Validation loss decreased (1.299105 --> 1.291208).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 18 cost time: 1.682483196258545
Epoch: 18, Steps: 52 | Train Loss: 0.4015185 Vali Loss: 1.3064787 Test Loss: 0.3537913
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 19 cost time: 1.677274227142334
Epoch: 19, Steps: 52 | Train Loss: 0.3974153 Vali Loss: 1.3047026 Test Loss: 0.3524037
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 20 cost time: 1.6800923347473145
Epoch: 20, Steps: 52 | Train Loss: 0.3969905 Vali Loss: 1.2976108 Test Loss: 0.3520175
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 21 cost time: 1.6762795448303223
Epoch: 21, Steps: 52 | Train Loss: 0.3990328 Vali Loss: 1.3013279 Test Loss: 0.3517303
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 22 cost time: 1.6741578578948975
Epoch: 22, Steps: 52 | Train Loss: 0.3981067 Vali Loss: 1.2878933 Test Loss: 0.3523659
Validation loss decreased (1.291208 --> 1.287893).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 23 cost time: 1.6775882244110107
Epoch: 23, Steps: 52 | Train Loss: 0.3978121 Vali Loss: 1.2940427 Test Loss: 0.3520519
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 24 cost time: 1.680250883102417
Epoch: 24, Steps: 52 | Train Loss: 0.3962686 Vali Loss: 1.2944659 Test Loss: 0.3519024
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 25 cost time: 1.6845009326934814
Epoch: 25, Steps: 52 | Train Loss: 0.3961473 Vali Loss: 1.2943993 Test Loss: 0.3510682
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 26 cost time: 1.6871364116668701
Epoch: 26, Steps: 52 | Train Loss: 0.3968916 Vali Loss: 1.2973456 Test Loss: 0.3514117
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 27 cost time: 1.6847248077392578
Epoch: 27, Steps: 52 | Train Loss: 0.3971915 Vali Loss: 1.2950056 Test Loss: 0.3521416
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 28 cost time: 1.6799705028533936
Epoch: 28, Steps: 52 | Train Loss: 0.3981175 Vali Loss: 1.2923278 Test Loss: 0.3525904
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 29 cost time: 1.6851801872253418
Epoch: 29, Steps: 52 | Train Loss: 0.3967165 Vali Loss: 1.2966821 Test Loss: 0.3522737
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 30 cost time: 1.6791346073150635
Epoch: 30, Steps: 52 | Train Loss: 0.3966814 Vali Loss: 1.2900963 Test Loss: 0.3513753
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 31 cost time: 1.6789534091949463
Epoch: 31, Steps: 52 | Train Loss: 0.3967078 Vali Loss: 1.2979647 Test Loss: 0.3528455
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 32 cost time: 1.674088716506958
Epoch: 32, Steps: 52 | Train Loss: 0.3977367 Vali Loss: 1.2925012 Test Loss: 0.3532498
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 33 cost time: 1.6731092929840088
Epoch: 33, Steps: 52 | Train Loss: 0.3953308 Vali Loss: 1.2890829 Test Loss: 0.3527630
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 34 cost time: 1.676379680633545
Epoch: 34, Steps: 52 | Train Loss: 0.3974247 Vali Loss: 1.2939110 Test Loss: 0.3525751
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 35 cost time: 1.679563045501709
Epoch: 35, Steps: 52 | Train Loss: 0.3966638 Vali Loss: 1.2959958 Test Loss: 0.3522626
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 36 cost time: 1.6706576347351074
Epoch: 36, Steps: 52 | Train Loss: 0.3962956 Vali Loss: 1.2880353 Test Loss: 0.3517534
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 37 cost time: 1.6763453483581543
Epoch: 37, Steps: 52 | Train Loss: 0.3946987 Vali Loss: 1.2879896 Test Loss: 0.3530740
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 38 cost time: 1.6799681186676025
Epoch: 38, Steps: 52 | Train Loss: 0.3979834 Vali Loss: 1.2965646 Test Loss: 0.3525314
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 39 cost time: 1.6851651668548584
Epoch: 39, Steps: 52 | Train Loss: 0.3966718 Vali Loss: 1.2933081 Test Loss: 0.3509024
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 40 cost time: 1.6821331977844238
Epoch: 40, Steps: 52 | Train Loss: 0.3969893 Vali Loss: 1.2978282 Test Loss: 0.3525652
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 41 cost time: 1.6814970970153809
Epoch: 41, Steps: 52 | Train Loss: 0.3958938 Vali Loss: 1.2895169 Test Loss: 0.3526871
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 42 cost time: 1.6785039901733398
Epoch: 42, Steps: 52 | Train Loss: 0.3956008 Vali Loss: 1.2912977 Test Loss: 0.3520305
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 43 cost time: 1.6802527904510498
Epoch: 43, Steps: 52 | Train Loss: 0.3954405 Vali Loss: 1.2953706 Test Loss: 0.3523540
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 44 cost time: 1.6807045936584473
Epoch: 44, Steps: 52 | Train Loss: 0.3944808 Vali Loss: 1.2800379 Test Loss: 0.3523140
Validation loss decreased (1.287893 --> 1.280038).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 45 cost time: 1.679546594619751
Epoch: 45, Steps: 52 | Train Loss: 0.3965282 Vali Loss: 1.2902610 Test Loss: 0.3519250
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 46 cost time: 1.678307056427002
Epoch: 46, Steps: 52 | Train Loss: 0.3968789 Vali Loss: 1.2991732 Test Loss: 0.3528566
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 47 cost time: 1.679579257965088
Epoch: 47, Steps: 52 | Train Loss: 0.3967596 Vali Loss: 1.2948842 Test Loss: 0.3523337
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 48 cost time: 1.669565200805664
Epoch: 48, Steps: 52 | Train Loss: 0.3965932 Vali Loss: 1.2934291 Test Loss: 0.3526394
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 49 cost time: 1.6799697875976562
Epoch: 49, Steps: 52 | Train Loss: 0.3950851 Vali Loss: 1.3003837 Test Loss: 0.3525129
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 50 cost time: 1.6853508949279785
Epoch: 50, Steps: 52 | Train Loss: 0.3930311 Vali Loss: 1.2882472 Test Loss: 0.3526384
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 51 cost time: 1.6782846450805664
Epoch: 51, Steps: 52 | Train Loss: 0.3970850 Vali Loss: 1.2960912 Test Loss: 0.3518725
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 52 cost time: 1.6819193363189697
Epoch: 52, Steps: 52 | Train Loss: 0.3955299 Vali Loss: 1.2925625 Test Loss: 0.3520793
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 53 cost time: 1.6827936172485352
Epoch: 53, Steps: 52 | Train Loss: 0.3973940 Vali Loss: 1.2790895 Test Loss: 0.3509160
Validation loss decreased (1.280038 --> 1.279089).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 54 cost time: 1.6778531074523926
Epoch: 54, Steps: 52 | Train Loss: 0.3959817 Vali Loss: 1.2990415 Test Loss: 0.3524076
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 55 cost time: 1.6756458282470703
Epoch: 55, Steps: 52 | Train Loss: 0.3976298 Vali Loss: 1.2887350 Test Loss: 0.3512463
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 56 cost time: 1.6777653694152832
Epoch: 56, Steps: 52 | Train Loss: 0.3960241 Vali Loss: 1.2921360 Test Loss: 0.3524961
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 57 cost time: 1.674856185913086
Epoch: 57, Steps: 52 | Train Loss: 0.3956313 Vali Loss: 1.2830169 Test Loss: 0.3525791
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 58 cost time: 1.6813023090362549
Epoch: 58, Steps: 52 | Train Loss: 0.3953503 Vali Loss: 1.2973990 Test Loss: 0.3531086
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 59 cost time: 1.6774959564208984
Epoch: 59, Steps: 52 | Train Loss: 0.3960388 Vali Loss: 1.2899696 Test Loss: 0.3515482
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 60 cost time: 1.6850755214691162
Epoch: 60, Steps: 52 | Train Loss: 0.3966795 Vali Loss: 1.2938437 Test Loss: 0.3519083
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3509160578250885, mae:0.40230098366737366, rse:0.4853001534938812
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054485321044921875 GB
Epoch: 1 cost time: 2.0634493827819824
Epoch: 1, Steps: 52 | Train Loss: 0.7474189 Vali Loss: 2.1805756 Test Loss: 1.3810149
Validation loss decreased (inf --> 2.180576).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 2 cost time: 0.709414005279541
Epoch: 2, Steps: 52 | Train Loss: 0.6584981 Vali Loss: 1.7537651 Test Loss: 0.8818163
Validation loss decreased (2.180576 --> 1.753765).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 3 cost time: 0.7180001735687256
Epoch: 3, Steps: 52 | Train Loss: 0.5452261 Vali Loss: 1.5364476 Test Loss: 0.5928406
Validation loss decreased (1.753765 --> 1.536448).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 4 cost time: 0.7003700733184814
Epoch: 4, Steps: 52 | Train Loss: 0.4865505 Vali Loss: 1.4432472 Test Loss: 0.4612167
Validation loss decreased (1.536448 --> 1.443247).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 5 cost time: 0.7047972679138184
Epoch: 5, Steps: 52 | Train Loss: 0.4592834 Vali Loss: 1.4135644 Test Loss: 0.4221488
Validation loss decreased (1.443247 --> 1.413564).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 6 cost time: 1.255920171737671
Epoch: 6, Steps: 52 | Train Loss: 0.4515061 Vali Loss: 1.4001054 Test Loss: 0.4060450
Validation loss decreased (1.413564 --> 1.400105).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 7 cost time: 1.5763335227966309
Epoch: 7, Steps: 52 | Train Loss: 0.4425139 Vali Loss: 1.3942590 Test Loss: 0.3967100
Validation loss decreased (1.400105 --> 1.394259).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 8 cost time: 1.5826148986816406
Epoch: 8, Steps: 52 | Train Loss: 0.4381925 Vali Loss: 1.3736008 Test Loss: 0.3891610
Validation loss decreased (1.394259 --> 1.373601).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 9 cost time: 1.5791938304901123
Epoch: 9, Steps: 52 | Train Loss: 0.4332675 Vali Loss: 1.3677813 Test Loss: 0.3846493
Validation loss decreased (1.373601 --> 1.367781).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 10 cost time: 1.574892282485962
Epoch: 10, Steps: 52 | Train Loss: 0.4304430 Vali Loss: 1.3677979 Test Loss: 0.3804045
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 11 cost time: 1.574742078781128
Epoch: 11, Steps: 52 | Train Loss: 0.4272027 Vali Loss: 1.3587888 Test Loss: 0.3766902
Validation loss decreased (1.367781 --> 1.358789).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 12 cost time: 1.572289228439331
Epoch: 12, Steps: 52 | Train Loss: 0.4261375 Vali Loss: 1.3581061 Test Loss: 0.3736757
Validation loss decreased (1.358789 --> 1.358106).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 13 cost time: 1.5742573738098145
Epoch: 13, Steps: 52 | Train Loss: 0.4250709 Vali Loss: 1.3531535 Test Loss: 0.3715034
Validation loss decreased (1.358106 --> 1.353153).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 14 cost time: 1.568669080734253
Epoch: 14, Steps: 52 | Train Loss: 0.4208200 Vali Loss: 1.3484901 Test Loss: 0.3696862
Validation loss decreased (1.353153 --> 1.348490).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 15 cost time: 1.5737147331237793
Epoch: 15, Steps: 52 | Train Loss: 0.4216327 Vali Loss: 1.3516432 Test Loss: 0.3678389
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 16 cost time: 1.5646498203277588
Epoch: 16, Steps: 52 | Train Loss: 0.4193643 Vali Loss: 1.3385267 Test Loss: 0.3662664
Validation loss decreased (1.348490 --> 1.338527).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 17 cost time: 1.5755467414855957
Epoch: 17, Steps: 52 | Train Loss: 0.4188560 Vali Loss: 1.3430023 Test Loss: 0.3645878
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 18 cost time: 1.5733599662780762
Epoch: 18, Steps: 52 | Train Loss: 0.4159024 Vali Loss: 1.3484721 Test Loss: 0.3637667
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 19 cost time: 1.574385166168213
Epoch: 19, Steps: 52 | Train Loss: 0.4182099 Vali Loss: 1.3383342 Test Loss: 0.3629726
Validation loss decreased (1.338527 --> 1.338334).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 20 cost time: 1.5745413303375244
Epoch: 20, Steps: 52 | Train Loss: 0.4165807 Vali Loss: 1.3391142 Test Loss: 0.3619330
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 21 cost time: 1.57340407371521
Epoch: 21, Steps: 52 | Train Loss: 0.4146446 Vali Loss: 1.3333021 Test Loss: 0.3611789
Validation loss decreased (1.338334 --> 1.333302).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 22 cost time: 1.5720274448394775
Epoch: 22, Steps: 52 | Train Loss: 0.4147523 Vali Loss: 1.3328862 Test Loss: 0.3601425
Validation loss decreased (1.333302 --> 1.332886).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 23 cost time: 1.5785942077636719
Epoch: 23, Steps: 52 | Train Loss: 0.4131848 Vali Loss: 1.3366899 Test Loss: 0.3601241
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 24 cost time: 1.5754549503326416
Epoch: 24, Steps: 52 | Train Loss: 0.4142104 Vali Loss: 1.3392071 Test Loss: 0.3594394
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 25 cost time: 1.579024076461792
Epoch: 25, Steps: 52 | Train Loss: 0.4152419 Vali Loss: 1.3310592 Test Loss: 0.3591568
Validation loss decreased (1.332886 --> 1.331059).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 26 cost time: 1.574681282043457
Epoch: 26, Steps: 52 | Train Loss: 0.4134558 Vali Loss: 1.3234401 Test Loss: 0.3586763
Validation loss decreased (1.331059 --> 1.323440).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 27 cost time: 1.5770220756530762
Epoch: 27, Steps: 52 | Train Loss: 0.4140440 Vali Loss: 1.3371007 Test Loss: 0.3585668
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 28 cost time: 1.5739941596984863
Epoch: 28, Steps: 52 | Train Loss: 0.4120617 Vali Loss: 1.3348873 Test Loss: 0.3581107
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 29 cost time: 1.575528860092163
Epoch: 29, Steps: 52 | Train Loss: 0.4128404 Vali Loss: 1.3372755 Test Loss: 0.3576645
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 30 cost time: 1.5721423625946045
Epoch: 30, Steps: 52 | Train Loss: 0.4136045 Vali Loss: 1.3314927 Test Loss: 0.3572952
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 31 cost time: 1.5746216773986816
Epoch: 31, Steps: 52 | Train Loss: 0.4138438 Vali Loss: 1.3339759 Test Loss: 0.3572272
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 32 cost time: 1.573188304901123
Epoch: 32, Steps: 52 | Train Loss: 0.4137454 Vali Loss: 1.3276664 Test Loss: 0.3568983
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 33 cost time: 1.5744690895080566
Epoch: 33, Steps: 52 | Train Loss: 0.4118196 Vali Loss: 1.3306664 Test Loss: 0.3568571
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 34 cost time: 1.5732600688934326
Epoch: 34, Steps: 52 | Train Loss: 0.4128689 Vali Loss: 1.3199823 Test Loss: 0.3566379
Validation loss decreased (1.323440 --> 1.319982).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 35 cost time: 1.5793282985687256
Epoch: 35, Steps: 52 | Train Loss: 0.4122678 Vali Loss: 1.3314921 Test Loss: 0.3565030
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 36 cost time: 1.574662446975708
Epoch: 36, Steps: 52 | Train Loss: 0.4122709 Vali Loss: 1.3229364 Test Loss: 0.3566182
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 37 cost time: 1.5798985958099365
Epoch: 37, Steps: 52 | Train Loss: 0.4116681 Vali Loss: 1.3241129 Test Loss: 0.3558320
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 38 cost time: 1.566417932510376
Epoch: 38, Steps: 52 | Train Loss: 0.4122504 Vali Loss: 1.3298036 Test Loss: 0.3558604
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 39 cost time: 1.573117733001709
Epoch: 39, Steps: 52 | Train Loss: 0.4112622 Vali Loss: 1.3310466 Test Loss: 0.3564349
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 40 cost time: 1.5699079036712646
Epoch: 40, Steps: 52 | Train Loss: 0.4112258 Vali Loss: 1.3271608 Test Loss: 0.3562022
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 41 cost time: 1.5829393863677979
Epoch: 41, Steps: 52 | Train Loss: 0.4106562 Vali Loss: 1.3307970 Test Loss: 0.3561261
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 42 cost time: 1.5703465938568115
Epoch: 42, Steps: 52 | Train Loss: 0.4112473 Vali Loss: 1.3232627 Test Loss: 0.3554361
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 43 cost time: 1.5787172317504883
Epoch: 43, Steps: 52 | Train Loss: 0.4099846 Vali Loss: 1.3303787 Test Loss: 0.3554688
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 44 cost time: 1.5735712051391602
Epoch: 44, Steps: 52 | Train Loss: 0.4118919 Vali Loss: 1.3270246 Test Loss: 0.3554348
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 45 cost time: 1.5719873905181885
Epoch: 45, Steps: 52 | Train Loss: 0.4109242 Vali Loss: 1.3242767 Test Loss: 0.3556387
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 46 cost time: 1.5722408294677734
Epoch: 46, Steps: 52 | Train Loss: 0.4115846 Vali Loss: 1.3232086 Test Loss: 0.3556244
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 47 cost time: 1.57407808303833
Epoch: 47, Steps: 52 | Train Loss: 0.4117641 Vali Loss: 1.3314158 Test Loss: 0.3552976
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 48 cost time: 1.5729568004608154
Epoch: 48, Steps: 52 | Train Loss: 0.4125458 Vali Loss: 1.3338910 Test Loss: 0.3556412
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 49 cost time: 1.5747103691101074
Epoch: 49, Steps: 52 | Train Loss: 0.4106356 Vali Loss: 1.3282061 Test Loss: 0.3553137
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 50 cost time: 1.5712251663208008
Epoch: 50, Steps: 52 | Train Loss: 0.4117254 Vali Loss: 1.3196591 Test Loss: 0.3553390
Validation loss decreased (1.319982 --> 1.319659).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 51 cost time: 1.5704164505004883
Epoch: 51, Steps: 52 | Train Loss: 0.4101849 Vali Loss: 1.3326857 Test Loss: 0.3553240
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 52 cost time: 1.5668790340423584
Epoch: 52, Steps: 52 | Train Loss: 0.4105079 Vali Loss: 1.3276478 Test Loss: 0.3550863
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 53 cost time: 1.575394630432129
Epoch: 53, Steps: 52 | Train Loss: 0.4100658 Vali Loss: 1.3215278 Test Loss: 0.3552517
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 54 cost time: 1.5682191848754883
Epoch: 54, Steps: 52 | Train Loss: 0.4116313 Vali Loss: 1.3204601 Test Loss: 0.3553128
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 55 cost time: 1.5722217559814453
Epoch: 55, Steps: 52 | Train Loss: 0.4112535 Vali Loss: 1.3236232 Test Loss: 0.3548198
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 56 cost time: 1.5698516368865967
Epoch: 56, Steps: 52 | Train Loss: 0.4113535 Vali Loss: 1.3214694 Test Loss: 0.3552552
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 57 cost time: 1.5774860382080078
Epoch: 57, Steps: 52 | Train Loss: 0.4113241 Vali Loss: 1.3302150 Test Loss: 0.3548924
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 58 cost time: 1.569974660873413
Epoch: 58, Steps: 52 | Train Loss: 0.4102877 Vali Loss: 1.3272154 Test Loss: 0.3552200
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 59 cost time: 1.5718061923980713
Epoch: 59, Steps: 52 | Train Loss: 0.4105367 Vali Loss: 1.3224418 Test Loss: 0.3548213
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 60 cost time: 1.5693304538726807
Epoch: 60, Steps: 52 | Train Loss: 0.4104241 Vali Loss: 1.3272650 Test Loss: 0.3549958
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3553389608860016, mae:0.39830899238586426, rse:0.48834890127182007
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.058879852294921875 GB
Epoch: 1 cost time: 2.1319663524627686
Epoch: 1, Steps: 52 | Train Loss: 0.7168234 Vali Loss: 2.1299930 Test Loss: 1.4041893
Validation loss decreased (inf --> 2.129993).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 2 cost time: 0.7510013580322266
Epoch: 2, Steps: 52 | Train Loss: 0.5634176 Vali Loss: 1.4453213 Test Loss: 0.4887282
Validation loss decreased (2.129993 --> 1.445321).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 3 cost time: 0.7308468818664551
Epoch: 3, Steps: 52 | Train Loss: 0.4465346 Vali Loss: 1.3659136 Test Loss: 0.3966005
Validation loss decreased (1.445321 --> 1.365914).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 4 cost time: 0.7557315826416016
Epoch: 4, Steps: 52 | Train Loss: 0.4282191 Vali Loss: 1.3611403 Test Loss: 0.3828800
Validation loss decreased (1.365914 --> 1.361140).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 5 cost time: 0.7506084442138672
Epoch: 5, Steps: 52 | Train Loss: 0.4214725 Vali Loss: 1.3536630 Test Loss: 0.3720935
Validation loss decreased (1.361140 --> 1.353663).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 6 cost time: 1.6266429424285889
Epoch: 6, Steps: 52 | Train Loss: 0.4180284 Vali Loss: 1.3430421 Test Loss: 0.3660862
Validation loss decreased (1.353663 --> 1.343042).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 7 cost time: 1.6338930130004883
Epoch: 7, Steps: 52 | Train Loss: 0.4124985 Vali Loss: 1.3308580 Test Loss: 0.3616118
Validation loss decreased (1.343042 --> 1.330858).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 8 cost time: 1.6447339057922363
Epoch: 8, Steps: 52 | Train Loss: 0.4118582 Vali Loss: 1.3180062 Test Loss: 0.3583516
Validation loss decreased (1.330858 --> 1.318006).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 9 cost time: 1.6451504230499268
Epoch: 9, Steps: 52 | Train Loss: 0.4097115 Vali Loss: 1.3259621 Test Loss: 0.3563216
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 10 cost time: 1.6464829444885254
Epoch: 10, Steps: 52 | Train Loss: 0.4065905 Vali Loss: 1.3221254 Test Loss: 0.3542404
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 11 cost time: 1.6444311141967773
Epoch: 11, Steps: 52 | Train Loss: 0.4060998 Vali Loss: 1.3095154 Test Loss: 0.3528681
Validation loss decreased (1.318006 --> 1.309515).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 12 cost time: 1.6458909511566162
Epoch: 12, Steps: 52 | Train Loss: 0.4048316 Vali Loss: 1.3180852 Test Loss: 0.3515850
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 13 cost time: 1.6457829475402832
Epoch: 13, Steps: 52 | Train Loss: 0.4040943 Vali Loss: 1.3066659 Test Loss: 0.3507837
Validation loss decreased (1.309515 --> 1.306666).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 14 cost time: 1.6443383693695068
Epoch: 14, Steps: 52 | Train Loss: 0.4024199 Vali Loss: 1.3099045 Test Loss: 0.3503338
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 15 cost time: 1.643141269683838
Epoch: 15, Steps: 52 | Train Loss: 0.4008331 Vali Loss: 1.3048311 Test Loss: 0.3499257
Validation loss decreased (1.306666 --> 1.304831).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 16 cost time: 1.6445634365081787
Epoch: 16, Steps: 52 | Train Loss: 0.4001575 Vali Loss: 1.2984912 Test Loss: 0.3491586
Validation loss decreased (1.304831 --> 1.298491).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 17 cost time: 1.6439259052276611
Epoch: 17, Steps: 52 | Train Loss: 0.4012377 Vali Loss: 1.3023307 Test Loss: 0.3480728
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 18 cost time: 1.644458532333374
Epoch: 18, Steps: 52 | Train Loss: 0.4015756 Vali Loss: 1.3010670 Test Loss: 0.3482772
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 19 cost time: 1.6385126113891602
Epoch: 19, Steps: 52 | Train Loss: 0.4011282 Vali Loss: 1.2941334 Test Loss: 0.3482423
Validation loss decreased (1.298491 --> 1.294133).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 20 cost time: 1.6362638473510742
Epoch: 20, Steps: 52 | Train Loss: 0.4002341 Vali Loss: 1.3055519 Test Loss: 0.3473126
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 21 cost time: 1.6413445472717285
Epoch: 21, Steps: 52 | Train Loss: 0.3988830 Vali Loss: 1.3008137 Test Loss: 0.3480617
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 22 cost time: 1.6433942317962646
Epoch: 22, Steps: 52 | Train Loss: 0.3987469 Vali Loss: 1.3020668 Test Loss: 0.3468570
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 23 cost time: 1.6439018249511719
Epoch: 23, Steps: 52 | Train Loss: 0.4003779 Vali Loss: 1.2915881 Test Loss: 0.3473733
Validation loss decreased (1.294133 --> 1.291588).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 24 cost time: 1.6445794105529785
Epoch: 24, Steps: 52 | Train Loss: 0.3998243 Vali Loss: 1.2951947 Test Loss: 0.3473076
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 25 cost time: 1.6447432041168213
Epoch: 25, Steps: 52 | Train Loss: 0.3980667 Vali Loss: 1.2981784 Test Loss: 0.3468668
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 26 cost time: 1.6436655521392822
Epoch: 26, Steps: 52 | Train Loss: 0.3991348 Vali Loss: 1.2946860 Test Loss: 0.3477041
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 27 cost time: 1.6426913738250732
Epoch: 27, Steps: 52 | Train Loss: 0.3977534 Vali Loss: 1.3006089 Test Loss: 0.3470776
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 28 cost time: 1.641503095626831
Epoch: 28, Steps: 52 | Train Loss: 0.3980705 Vali Loss: 1.2852015 Test Loss: 0.3470797
Validation loss decreased (1.291588 --> 1.285202).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 29 cost time: 1.6438307762145996
Epoch: 29, Steps: 52 | Train Loss: 0.3973471 Vali Loss: 1.2969295 Test Loss: 0.3471000
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 30 cost time: 1.6415255069732666
Epoch: 30, Steps: 52 | Train Loss: 0.3957107 Vali Loss: 1.2924873 Test Loss: 0.3474090
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 31 cost time: 1.6465802192687988
Epoch: 31, Steps: 52 | Train Loss: 0.3983932 Vali Loss: 1.3001448 Test Loss: 0.3471293
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 32 cost time: 1.6414954662322998
Epoch: 32, Steps: 52 | Train Loss: 0.3966182 Vali Loss: 1.2913119 Test Loss: 0.3469484
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 33 cost time: 1.64707350730896
Epoch: 33, Steps: 52 | Train Loss: 0.3963612 Vali Loss: 1.2946982 Test Loss: 0.3470377
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 34 cost time: 1.6456124782562256
Epoch: 34, Steps: 52 | Train Loss: 0.3985597 Vali Loss: 1.2976944 Test Loss: 0.3469406
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 35 cost time: 1.6444997787475586
Epoch: 35, Steps: 52 | Train Loss: 0.3976089 Vali Loss: 1.2892089 Test Loss: 0.3472306
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 36 cost time: 1.6416640281677246
Epoch: 36, Steps: 52 | Train Loss: 0.3983127 Vali Loss: 1.2978013 Test Loss: 0.3467932
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 37 cost time: 1.6391839981079102
Epoch: 37, Steps: 52 | Train Loss: 0.3973170 Vali Loss: 1.2980617 Test Loss: 0.3474270
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 38 cost time: 1.6446082592010498
Epoch: 38, Steps: 52 | Train Loss: 0.3968561 Vali Loss: 1.2945638 Test Loss: 0.3463719
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 39 cost time: 1.6447339057922363
Epoch: 39, Steps: 52 | Train Loss: 0.3974771 Vali Loss: 1.2992285 Test Loss: 0.3467712
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 40 cost time: 1.643761157989502
Epoch: 40, Steps: 52 | Train Loss: 0.3967319 Vali Loss: 1.2928684 Test Loss: 0.3465683
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 41 cost time: 1.641610860824585
Epoch: 41, Steps: 52 | Train Loss: 0.3968317 Vali Loss: 1.2774134 Test Loss: 0.3462958
Validation loss decreased (1.285202 --> 1.277413).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 42 cost time: 1.6431212425231934
Epoch: 42, Steps: 52 | Train Loss: 0.3965066 Vali Loss: 1.2906172 Test Loss: 0.3465810
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 43 cost time: 1.650747299194336
Epoch: 43, Steps: 52 | Train Loss: 0.3988208 Vali Loss: 1.2979183 Test Loss: 0.3467892
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 44 cost time: 1.6427817344665527
Epoch: 44, Steps: 52 | Train Loss: 0.3969744 Vali Loss: 1.2887561 Test Loss: 0.3459519
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 45 cost time: 1.6455140113830566
Epoch: 45, Steps: 52 | Train Loss: 0.3966618 Vali Loss: 1.2972206 Test Loss: 0.3469177
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 46 cost time: 1.6392526626586914
Epoch: 46, Steps: 52 | Train Loss: 0.3973321 Vali Loss: 1.2983335 Test Loss: 0.3469784
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 47 cost time: 1.6496827602386475
Epoch: 47, Steps: 52 | Train Loss: 0.3974290 Vali Loss: 1.2980635 Test Loss: 0.3463964
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 48 cost time: 1.6389811038970947
Epoch: 48, Steps: 52 | Train Loss: 0.3954154 Vali Loss: 1.2923365 Test Loss: 0.3470381
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 49 cost time: 1.6448981761932373
Epoch: 49, Steps: 52 | Train Loss: 0.3968925 Vali Loss: 1.2922060 Test Loss: 0.3468131
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 50 cost time: 1.6403920650482178
Epoch: 50, Steps: 52 | Train Loss: 0.3973488 Vali Loss: 1.2916899 Test Loss: 0.3459413
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 51 cost time: 1.6493818759918213
Epoch: 51, Steps: 52 | Train Loss: 0.3970984 Vali Loss: 1.2866907 Test Loss: 0.3460612
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 52 cost time: 1.6419391632080078
Epoch: 52, Steps: 52 | Train Loss: 0.3976697 Vali Loss: 1.2974230 Test Loss: 0.3462917
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 53 cost time: 1.642397165298462
Epoch: 53, Steps: 52 | Train Loss: 0.3957055 Vali Loss: 1.2931349 Test Loss: 0.3460404
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 54 cost time: 1.644104242324829
Epoch: 54, Steps: 52 | Train Loss: 0.3973718 Vali Loss: 1.2876102 Test Loss: 0.3466003
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 55 cost time: 1.6484971046447754
Epoch: 55, Steps: 52 | Train Loss: 0.3961979 Vali Loss: 1.2966052 Test Loss: 0.3461652
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 56 cost time: 1.6448450088500977
Epoch: 56, Steps: 52 | Train Loss: 0.3972929 Vali Loss: 1.2948604 Test Loss: 0.3462968
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 57 cost time: 1.6470510959625244
Epoch: 57, Steps: 52 | Train Loss: 0.3967877 Vali Loss: 1.2987115 Test Loss: 0.3465348
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 58 cost time: 1.6419246196746826
Epoch: 58, Steps: 52 | Train Loss: 0.3967377 Vali Loss: 1.2954037 Test Loss: 0.3466748
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 59 cost time: 1.6416306495666504
Epoch: 59, Steps: 52 | Train Loss: 0.3980041 Vali Loss: 1.2912960 Test Loss: 0.3455996
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 60 cost time: 1.6403639316558838
Epoch: 60, Steps: 52 | Train Loss: 0.3972746 Vali Loss: 1.2918262 Test Loss: 0.3461988
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3462958037853241, mae:0.3958228826522827, rse:0.48209476470947266
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.062178611755371094 GB
Epoch: 1 cost time: 2.1298184394836426
Epoch: 1, Steps: 52 | Train Loss: 0.6811533 Vali Loss: 2.0973022 Test Loss: 1.3331352
Validation loss decreased (inf --> 2.097302).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 2 cost time: 0.7667567729949951
Epoch: 2, Steps: 52 | Train Loss: 0.5415337 Vali Loss: 1.4100723 Test Loss: 0.4335639
Validation loss decreased (2.097302 --> 1.410072).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 3 cost time: 0.7603840827941895
Epoch: 3, Steps: 52 | Train Loss: 0.4399882 Vali Loss: 1.3621650 Test Loss: 0.3989437
Validation loss decreased (1.410072 --> 1.362165).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 4 cost time: 0.7638921737670898
Epoch: 4, Steps: 52 | Train Loss: 0.4234842 Vali Loss: 1.3552403 Test Loss: 0.3789150
Validation loss decreased (1.362165 --> 1.355240).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 5 cost time: 0.7588038444519043
Epoch: 5, Steps: 52 | Train Loss: 0.4150894 Vali Loss: 1.3415737 Test Loss: 0.3715016
Validation loss decreased (1.355240 --> 1.341574).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 6 cost time: 1.6751997470855713
Epoch: 6, Steps: 52 | Train Loss: 0.4136479 Vali Loss: 1.3309309 Test Loss: 0.3651620
Validation loss decreased (1.341574 --> 1.330931).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 7 cost time: 1.6964199542999268
Epoch: 7, Steps: 52 | Train Loss: 0.4094919 Vali Loss: 1.3268623 Test Loss: 0.3623524
Validation loss decreased (1.330931 --> 1.326862).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 8 cost time: 1.6983892917633057
Epoch: 8, Steps: 52 | Train Loss: 0.4072519 Vali Loss: 1.3283660 Test Loss: 0.3585476
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 9 cost time: 1.695801019668579
Epoch: 9, Steps: 52 | Train Loss: 0.4058264 Vali Loss: 1.3133609 Test Loss: 0.3557849
Validation loss decreased (1.326862 --> 1.313361).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 10 cost time: 1.6964054107666016
Epoch: 10, Steps: 52 | Train Loss: 0.4051453 Vali Loss: 1.3197103 Test Loss: 0.3545452
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 11 cost time: 1.6989550590515137
Epoch: 11, Steps: 52 | Train Loss: 0.4022391 Vali Loss: 1.3000170 Test Loss: 0.3521444
Validation loss decreased (1.313361 --> 1.300017).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 12 cost time: 1.6975295543670654
Epoch: 12, Steps: 52 | Train Loss: 0.4039573 Vali Loss: 1.3039498 Test Loss: 0.3523582
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 13 cost time: 1.6964571475982666
Epoch: 13, Steps: 52 | Train Loss: 0.4029088 Vali Loss: 1.3066813 Test Loss: 0.3500938
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 14 cost time: 1.6924242973327637
Epoch: 14, Steps: 52 | Train Loss: 0.4015062 Vali Loss: 1.3064592 Test Loss: 0.3499527
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 15 cost time: 1.6909241676330566
Epoch: 15, Steps: 52 | Train Loss: 0.4007180 Vali Loss: 1.3036231 Test Loss: 0.3485023
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 16 cost time: 1.6942718029022217
Epoch: 16, Steps: 52 | Train Loss: 0.3999876 Vali Loss: 1.3048344 Test Loss: 0.3485272
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 17 cost time: 1.6912257671356201
Epoch: 17, Steps: 52 | Train Loss: 0.3983273 Vali Loss: 1.2924867 Test Loss: 0.3476158
Validation loss decreased (1.300017 --> 1.292487).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 18 cost time: 1.6940171718597412
Epoch: 18, Steps: 52 | Train Loss: 0.3987062 Vali Loss: 1.2977641 Test Loss: 0.3471752
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 19 cost time: 1.6979668140411377
Epoch: 19, Steps: 52 | Train Loss: 0.3964529 Vali Loss: 1.2934952 Test Loss: 0.3466225
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 20 cost time: 1.7038037776947021
Epoch: 20, Steps: 52 | Train Loss: 0.3984562 Vali Loss: 1.2981122 Test Loss: 0.3460270
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 21 cost time: 1.6980469226837158
Epoch: 21, Steps: 52 | Train Loss: 0.3997859 Vali Loss: 1.2998630 Test Loss: 0.3462418
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 22 cost time: 1.70011568069458
Epoch: 22, Steps: 52 | Train Loss: 0.3973555 Vali Loss: 1.2981305 Test Loss: 0.3456954
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 23 cost time: 1.6944527626037598
Epoch: 23, Steps: 52 | Train Loss: 0.3980279 Vali Loss: 1.2896284 Test Loss: 0.3457722
Validation loss decreased (1.292487 --> 1.289628).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 24 cost time: 1.6902472972869873
Epoch: 24, Steps: 52 | Train Loss: 0.3974097 Vali Loss: 1.2942537 Test Loss: 0.3454118
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 25 cost time: 1.6955106258392334
Epoch: 25, Steps: 52 | Train Loss: 0.3974392 Vali Loss: 1.2942280 Test Loss: 0.3453164
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 26 cost time: 1.6983444690704346
Epoch: 26, Steps: 52 | Train Loss: 0.3976934 Vali Loss: 1.2951293 Test Loss: 0.3455699
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 27 cost time: 1.694899559020996
Epoch: 27, Steps: 52 | Train Loss: 0.3953550 Vali Loss: 1.2987356 Test Loss: 0.3453739
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 28 cost time: 1.6966567039489746
Epoch: 28, Steps: 52 | Train Loss: 0.3964483 Vali Loss: 1.2818818 Test Loss: 0.3453653
Validation loss decreased (1.289628 --> 1.281882).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 29 cost time: 1.6929206848144531
Epoch: 29, Steps: 52 | Train Loss: 0.3967650 Vali Loss: 1.2994936 Test Loss: 0.3454292
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 30 cost time: 1.6985681056976318
Epoch: 30, Steps: 52 | Train Loss: 0.3956226 Vali Loss: 1.2857764 Test Loss: 0.3457251
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 31 cost time: 1.6972014904022217
Epoch: 31, Steps: 52 | Train Loss: 0.3968652 Vali Loss: 1.2961986 Test Loss: 0.3450630
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 32 cost time: 1.6977109909057617
Epoch: 32, Steps: 52 | Train Loss: 0.3948270 Vali Loss: 1.2916791 Test Loss: 0.3455772
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 33 cost time: 1.696375846862793
Epoch: 33, Steps: 52 | Train Loss: 0.3962375 Vali Loss: 1.2919809 Test Loss: 0.3448378
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 34 cost time: 1.6920545101165771
Epoch: 34, Steps: 52 | Train Loss: 0.3955486 Vali Loss: 1.2865224 Test Loss: 0.3456911
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 35 cost time: 1.6929171085357666
Epoch: 35, Steps: 52 | Train Loss: 0.3945889 Vali Loss: 1.2888843 Test Loss: 0.3449205
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 36 cost time: 1.6887102127075195
Epoch: 36, Steps: 52 | Train Loss: 0.3941694 Vali Loss: 1.2880433 Test Loss: 0.3451394
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 37 cost time: 1.6997175216674805
Epoch: 37, Steps: 52 | Train Loss: 0.3959846 Vali Loss: 1.2925311 Test Loss: 0.3447648
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 38 cost time: 1.695399284362793
Epoch: 38, Steps: 52 | Train Loss: 0.3938831 Vali Loss: 1.2965746 Test Loss: 0.3445418
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 39 cost time: 1.6936469078063965
Epoch: 39, Steps: 52 | Train Loss: 0.3959290 Vali Loss: 1.2960677 Test Loss: 0.3449170
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 40 cost time: 1.7123603820800781
Epoch: 40, Steps: 52 | Train Loss: 0.3965778 Vali Loss: 1.2935655 Test Loss: 0.3446022
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 41 cost time: 1.707397222518921
Epoch: 41, Steps: 52 | Train Loss: 0.3973661 Vali Loss: 1.2914001 Test Loss: 0.3447492
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 42 cost time: 1.6972308158874512
Epoch: 42, Steps: 52 | Train Loss: 0.3964207 Vali Loss: 1.2930670 Test Loss: 0.3451496
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 43 cost time: 1.7015280723571777
Epoch: 43, Steps: 52 | Train Loss: 0.3960526 Vali Loss: 1.2956916 Test Loss: 0.3447660
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 44 cost time: 1.7051637172698975
Epoch: 44, Steps: 52 | Train Loss: 0.3957369 Vali Loss: 1.2894101 Test Loss: 0.3447198
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 45 cost time: 1.7025041580200195
Epoch: 45, Steps: 52 | Train Loss: 0.3955205 Vali Loss: 1.2918866 Test Loss: 0.3443806
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 46 cost time: 1.6977863311767578
Epoch: 46, Steps: 52 | Train Loss: 0.3964666 Vali Loss: 1.2913430 Test Loss: 0.3447486
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 47 cost time: 1.7045197486877441
Epoch: 47, Steps: 52 | Train Loss: 0.3971697 Vali Loss: 1.2899475 Test Loss: 0.3440577
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 48 cost time: 1.6983842849731445
Epoch: 48, Steps: 52 | Train Loss: 0.3952173 Vali Loss: 1.2876538 Test Loss: 0.3448913
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 49 cost time: 1.703413724899292
Epoch: 49, Steps: 52 | Train Loss: 0.3963691 Vali Loss: 1.2906611 Test Loss: 0.3451214
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 50 cost time: 1.6910021305084229
Epoch: 50, Steps: 52 | Train Loss: 0.3961688 Vali Loss: 1.2905688 Test Loss: 0.3439289
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 51 cost time: 1.692507028579712
Epoch: 51, Steps: 52 | Train Loss: 0.3957244 Vali Loss: 1.2879854 Test Loss: 0.3446481
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 52 cost time: 1.7001206874847412
Epoch: 52, Steps: 52 | Train Loss: 0.3946770 Vali Loss: 1.2920474 Test Loss: 0.3447354
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 53 cost time: 1.694528341293335
Epoch: 53, Steps: 52 | Train Loss: 0.3948899 Vali Loss: 1.2883143 Test Loss: 0.3446603
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 54 cost time: 1.7034690380096436
Epoch: 54, Steps: 52 | Train Loss: 0.3948111 Vali Loss: 1.2917620 Test Loss: 0.3443318
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 55 cost time: 1.694795846939087
Epoch: 55, Steps: 52 | Train Loss: 0.3954676 Vali Loss: 1.2867873 Test Loss: 0.3441988
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 56 cost time: 1.7006962299346924
Epoch: 56, Steps: 52 | Train Loss: 0.3958933 Vali Loss: 1.2917764 Test Loss: 0.3449704
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 57 cost time: 1.6949594020843506
Epoch: 57, Steps: 52 | Train Loss: 0.3939396 Vali Loss: 1.2825074 Test Loss: 0.3440846
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 58 cost time: 1.7010023593902588
Epoch: 58, Steps: 52 | Train Loss: 0.3955404 Vali Loss: 1.2866781 Test Loss: 0.3445741
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 59 cost time: 1.6962904930114746
Epoch: 59, Steps: 52 | Train Loss: 0.3957485 Vali Loss: 1.2896338 Test Loss: 0.3441381
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 60 cost time: 1.6990835666656494
Epoch: 60, Steps: 52 | Train Loss: 0.3954909 Vali Loss: 1.2919328 Test Loss: 0.3446279
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34536540508270264, mae:0.39314571022987366, rse:0.48144668340682983
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.05464744567871094 GB
Epoch: 1 cost time: 2.106144666671753
Epoch: 1, Steps: 52 | Train Loss: 0.7681830 Vali Loss: 2.2480812 Test Loss: 1.4739330
Validation loss decreased (inf --> 2.248081).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 2 cost time: 0.7184326648712158
Epoch: 2, Steps: 52 | Train Loss: 0.6810507 Vali Loss: 1.7998068 Test Loss: 0.9584605
Validation loss decreased (2.248081 --> 1.799807).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 3 cost time: 0.7270021438598633
Epoch: 3, Steps: 52 | Train Loss: 0.5593904 Vali Loss: 1.5500830 Test Loss: 0.6214972
Validation loss decreased (1.799807 --> 1.550083).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 4 cost time: 0.7056236267089844
Epoch: 4, Steps: 52 | Train Loss: 0.4944978 Vali Loss: 1.4487306 Test Loss: 0.4692366
Validation loss decreased (1.550083 --> 1.448731).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 5 cost time: 0.7079615592956543
Epoch: 5, Steps: 52 | Train Loss: 0.4669689 Vali Loss: 1.4139245 Test Loss: 0.4299866
Validation loss decreased (1.448731 --> 1.413924).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 6 cost time: 1.4087600708007812
Epoch: 6, Steps: 52 | Train Loss: 0.4517716 Vali Loss: 1.4047136 Test Loss: 0.4131375
Validation loss decreased (1.413924 --> 1.404714).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 7 cost time: 1.5997459888458252
Epoch: 7, Steps: 52 | Train Loss: 0.4450596 Vali Loss: 1.3885775 Test Loss: 0.4015551
Validation loss decreased (1.404714 --> 1.388577).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 8 cost time: 1.6033642292022705
Epoch: 8, Steps: 52 | Train Loss: 0.4393932 Vali Loss: 1.3774421 Test Loss: 0.3931799
Validation loss decreased (1.388577 --> 1.377442).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 9 cost time: 1.614058494567871
Epoch: 9, Steps: 52 | Train Loss: 0.4357537 Vali Loss: 1.3684100 Test Loss: 0.3877329
Validation loss decreased (1.377442 --> 1.368410).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 10 cost time: 1.5921225547790527
Epoch: 10, Steps: 52 | Train Loss: 0.4316496 Vali Loss: 1.3743117 Test Loss: 0.3822124
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 11 cost time: 1.5951621532440186
Epoch: 11, Steps: 52 | Train Loss: 0.4289420 Vali Loss: 1.3480465 Test Loss: 0.3782835
Validation loss decreased (1.368410 --> 1.348047).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 12 cost time: 1.5861406326293945
Epoch: 12, Steps: 52 | Train Loss: 0.4262084 Vali Loss: 1.3610427 Test Loss: 0.3738977
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 13 cost time: 1.5945584774017334
Epoch: 13, Steps: 52 | Train Loss: 0.4259171 Vali Loss: 1.3569057 Test Loss: 0.3714858
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 14 cost time: 1.5913076400756836
Epoch: 14, Steps: 52 | Train Loss: 0.4223939 Vali Loss: 1.3588579 Test Loss: 0.3688787
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 15 cost time: 1.5955660343170166
Epoch: 15, Steps: 52 | Train Loss: 0.4200826 Vali Loss: 1.3459902 Test Loss: 0.3662677
Validation loss decreased (1.348047 --> 1.345990).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 16 cost time: 1.5890424251556396
Epoch: 16, Steps: 52 | Train Loss: 0.4183079 Vali Loss: 1.3508103 Test Loss: 0.3647745
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 17 cost time: 1.59505033493042
Epoch: 17, Steps: 52 | Train Loss: 0.4199037 Vali Loss: 1.3453919 Test Loss: 0.3631282
Validation loss decreased (1.345990 --> 1.345392).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 18 cost time: 1.587035894393921
Epoch: 18, Steps: 52 | Train Loss: 0.4182750 Vali Loss: 1.3343780 Test Loss: 0.3616617
Validation loss decreased (1.345392 --> 1.334378).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 19 cost time: 1.5918970108032227
Epoch: 19, Steps: 52 | Train Loss: 0.4177400 Vali Loss: 1.3416681 Test Loss: 0.3607297
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 20 cost time: 1.5955486297607422
Epoch: 20, Steps: 52 | Train Loss: 0.4163123 Vali Loss: 1.3315380 Test Loss: 0.3593013
Validation loss decreased (1.334378 --> 1.331538).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 21 cost time: 1.5975661277770996
Epoch: 21, Steps: 52 | Train Loss: 0.4143935 Vali Loss: 1.3339350 Test Loss: 0.3585896
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 22 cost time: 1.6006758213043213
Epoch: 22, Steps: 52 | Train Loss: 0.4156073 Vali Loss: 1.3324645 Test Loss: 0.3575585
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 23 cost time: 1.5911223888397217
Epoch: 23, Steps: 52 | Train Loss: 0.4143437 Vali Loss: 1.3392959 Test Loss: 0.3567902
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 24 cost time: 1.5939438343048096
Epoch: 24, Steps: 52 | Train Loss: 0.4153513 Vali Loss: 1.3386817 Test Loss: 0.3561689
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 25 cost time: 1.5953686237335205
Epoch: 25, Steps: 52 | Train Loss: 0.4145104 Vali Loss: 1.3321602 Test Loss: 0.3552788
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 26 cost time: 1.5964691638946533
Epoch: 26, Steps: 52 | Train Loss: 0.4132249 Vali Loss: 1.3377764 Test Loss: 0.3547044
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 27 cost time: 1.5915486812591553
Epoch: 27, Steps: 52 | Train Loss: 0.4124341 Vali Loss: 1.3329840 Test Loss: 0.3546705
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 28 cost time: 1.604173183441162
Epoch: 28, Steps: 52 | Train Loss: 0.4134168 Vali Loss: 1.3362578 Test Loss: 0.3540831
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 29 cost time: 1.5930638313293457
Epoch: 29, Steps: 52 | Train Loss: 0.4127477 Vali Loss: 1.3326751 Test Loss: 0.3536700
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 30 cost time: 1.6011910438537598
Epoch: 30, Steps: 52 | Train Loss: 0.4105543 Vali Loss: 1.3306841 Test Loss: 0.3534033
Validation loss decreased (1.331538 --> 1.330684).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 31 cost time: 1.604520320892334
Epoch: 31, Steps: 52 | Train Loss: 0.4132130 Vali Loss: 1.3303753 Test Loss: 0.3530524
Validation loss decreased (1.330684 --> 1.330375).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 32 cost time: 1.6023950576782227
Epoch: 32, Steps: 52 | Train Loss: 0.4111697 Vali Loss: 1.3317741 Test Loss: 0.3534585
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 33 cost time: 1.6084392070770264
Epoch: 33, Steps: 52 | Train Loss: 0.4115478 Vali Loss: 1.3256187 Test Loss: 0.3525961
Validation loss decreased (1.330375 --> 1.325619).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 34 cost time: 1.6082689762115479
Epoch: 34, Steps: 52 | Train Loss: 0.4106069 Vali Loss: 1.3280370 Test Loss: 0.3524480
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 35 cost time: 1.6020278930664062
Epoch: 35, Steps: 52 | Train Loss: 0.4105912 Vali Loss: 1.3253586 Test Loss: 0.3523880
Validation loss decreased (1.325619 --> 1.325359).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 36 cost time: 1.6038057804107666
Epoch: 36, Steps: 52 | Train Loss: 0.4091560 Vali Loss: 1.3261178 Test Loss: 0.3523339
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 37 cost time: 1.6065545082092285
Epoch: 37, Steps: 52 | Train Loss: 0.4112342 Vali Loss: 1.3299735 Test Loss: 0.3518862
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 38 cost time: 1.5985572338104248
Epoch: 38, Steps: 52 | Train Loss: 0.4104671 Vali Loss: 1.3331041 Test Loss: 0.3521107
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 39 cost time: 1.611745834350586
Epoch: 39, Steps: 52 | Train Loss: 0.4110543 Vali Loss: 1.3276215 Test Loss: 0.3518502
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 40 cost time: 1.5941548347473145
Epoch: 40, Steps: 52 | Train Loss: 0.4113813 Vali Loss: 1.3313447 Test Loss: 0.3516301
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 41 cost time: 1.5935566425323486
Epoch: 41, Steps: 52 | Train Loss: 0.4111321 Vali Loss: 1.3325861 Test Loss: 0.3511730
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 42 cost time: 1.589906930923462
Epoch: 42, Steps: 52 | Train Loss: 0.4108598 Vali Loss: 1.3231523 Test Loss: 0.3512313
Validation loss decreased (1.325359 --> 1.323152).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 43 cost time: 1.5929157733917236
Epoch: 43, Steps: 52 | Train Loss: 0.4117481 Vali Loss: 1.3301280 Test Loss: 0.3511628
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 44 cost time: 1.5929665565490723
Epoch: 44, Steps: 52 | Train Loss: 0.4097753 Vali Loss: 1.3289843 Test Loss: 0.3511668
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 45 cost time: 1.5981807708740234
Epoch: 45, Steps: 52 | Train Loss: 0.4093812 Vali Loss: 1.3244674 Test Loss: 0.3510079
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 46 cost time: 1.5903527736663818
Epoch: 46, Steps: 52 | Train Loss: 0.4117273 Vali Loss: 1.3300240 Test Loss: 0.3510508
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 47 cost time: 1.60062575340271
Epoch: 47, Steps: 52 | Train Loss: 0.4108476 Vali Loss: 1.3264567 Test Loss: 0.3508638
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 48 cost time: 1.5928642749786377
Epoch: 48, Steps: 52 | Train Loss: 0.4099340 Vali Loss: 1.3250065 Test Loss: 0.3508292
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 49 cost time: 1.6049728393554688
Epoch: 49, Steps: 52 | Train Loss: 0.4125200 Vali Loss: 1.3247988 Test Loss: 0.3507598
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 50 cost time: 1.589956521987915
Epoch: 50, Steps: 52 | Train Loss: 0.4100386 Vali Loss: 1.3312085 Test Loss: 0.3509722
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 51 cost time: 1.5963265895843506
Epoch: 51, Steps: 52 | Train Loss: 0.4089470 Vali Loss: 1.3291880 Test Loss: 0.3510025
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 52 cost time: 1.5864031314849854
Epoch: 52, Steps: 52 | Train Loss: 0.4105913 Vali Loss: 1.3291411 Test Loss: 0.3507641
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 53 cost time: 1.6014111042022705
Epoch: 53, Steps: 52 | Train Loss: 0.4093912 Vali Loss: 1.3172312 Test Loss: 0.3509089
Validation loss decreased (1.323152 --> 1.317231).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 54 cost time: 1.5982944965362549
Epoch: 54, Steps: 52 | Train Loss: 0.4093942 Vali Loss: 1.3261859 Test Loss: 0.3507668
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 55 cost time: 1.6004772186279297
Epoch: 55, Steps: 52 | Train Loss: 0.4088849 Vali Loss: 1.3215753 Test Loss: 0.3508093
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 56 cost time: 1.5933196544647217
Epoch: 56, Steps: 52 | Train Loss: 0.4103810 Vali Loss: 1.3258752 Test Loss: 0.3509251
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 57 cost time: 1.6057488918304443
Epoch: 57, Steps: 52 | Train Loss: 0.4111113 Vali Loss: 1.3251417 Test Loss: 0.3506727
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 58 cost time: 1.6021502017974854
Epoch: 58, Steps: 52 | Train Loss: 0.4102377 Vali Loss: 1.3269062 Test Loss: 0.3505955
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 59 cost time: 1.6076276302337646
Epoch: 59, Steps: 52 | Train Loss: 0.4121319 Vali Loss: 1.3252589 Test Loss: 0.3508450
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 60 cost time: 1.6015288829803467
Epoch: 60, Steps: 52 | Train Loss: 0.4098218 Vali Loss: 1.3203821 Test Loss: 0.3509701
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35090890526771545, mae:0.3948121964931488, rse:0.48529520630836487
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.05904197692871094 GB
Epoch: 1 cost time: 2.1404433250427246
Epoch: 1, Steps: 52 | Train Loss: 0.6798596 Vali Loss: 2.0623050 Test Loss: 1.2736433
Validation loss decreased (inf --> 2.062305).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 2 cost time: 0.729351282119751
Epoch: 2, Steps: 52 | Train Loss: 0.5372028 Vali Loss: 1.4255674 Test Loss: 0.4373683
Validation loss decreased (2.062305 --> 1.425567).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 3 cost time: 0.7489995956420898
Epoch: 3, Steps: 52 | Train Loss: 0.4462388 Vali Loss: 1.3836193 Test Loss: 0.4043800
Validation loss decreased (1.425567 --> 1.383619).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 4 cost time: 0.74934983253479
Epoch: 4, Steps: 52 | Train Loss: 0.4291644 Vali Loss: 1.3632362 Test Loss: 0.3811816
Validation loss decreased (1.383619 --> 1.363236).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 5 cost time: 0.735790491104126
Epoch: 5, Steps: 52 | Train Loss: 0.4204933 Vali Loss: 1.3505208 Test Loss: 0.3714875
Validation loss decreased (1.363236 --> 1.350521).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 6 cost time: 1.6308388710021973
Epoch: 6, Steps: 52 | Train Loss: 0.4137696 Vali Loss: 1.3478496 Test Loss: 0.3652961
Validation loss decreased (1.350521 --> 1.347850).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 7 cost time: 1.6473267078399658
Epoch: 7, Steps: 52 | Train Loss: 0.4118298 Vali Loss: 1.3302891 Test Loss: 0.3612538
Validation loss decreased (1.347850 --> 1.330289).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 8 cost time: 1.6482594013214111
Epoch: 8, Steps: 52 | Train Loss: 0.4099710 Vali Loss: 1.3241585 Test Loss: 0.3579524
Validation loss decreased (1.330289 --> 1.324159).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 9 cost time: 1.6500663757324219
Epoch: 9, Steps: 52 | Train Loss: 0.4059484 Vali Loss: 1.3218548 Test Loss: 0.3559099
Validation loss decreased (1.324159 --> 1.321855).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 10 cost time: 1.653989315032959
Epoch: 10, Steps: 52 | Train Loss: 0.4062142 Vali Loss: 1.3256884 Test Loss: 0.3536343
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 11 cost time: 1.6481983661651611
Epoch: 11, Steps: 52 | Train Loss: 0.4048796 Vali Loss: 1.3151083 Test Loss: 0.3522686
Validation loss decreased (1.321855 --> 1.315108).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 12 cost time: 1.6493446826934814
Epoch: 12, Steps: 52 | Train Loss: 0.4034319 Vali Loss: 1.3134223 Test Loss: 0.3502355
Validation loss decreased (1.315108 --> 1.313422).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 13 cost time: 1.6559357643127441
Epoch: 13, Steps: 52 | Train Loss: 0.4025443 Vali Loss: 1.3082002 Test Loss: 0.3490354
Validation loss decreased (1.313422 --> 1.308200).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 14 cost time: 1.6475212574005127
Epoch: 14, Steps: 52 | Train Loss: 0.4022448 Vali Loss: 1.3125352 Test Loss: 0.3493487
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 15 cost time: 1.651439905166626
Epoch: 15, Steps: 52 | Train Loss: 0.4003368 Vali Loss: 1.3013070 Test Loss: 0.3488478
Validation loss decreased (1.308200 --> 1.301307).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 16 cost time: 1.6514976024627686
Epoch: 16, Steps: 52 | Train Loss: 0.4001880 Vali Loss: 1.3030611 Test Loss: 0.3481276
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 17 cost time: 1.643258810043335
Epoch: 17, Steps: 52 | Train Loss: 0.4001649 Vali Loss: 1.3029523 Test Loss: 0.3476872
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 18 cost time: 1.6493713855743408
Epoch: 18, Steps: 52 | Train Loss: 0.3992301 Vali Loss: 1.3044999 Test Loss: 0.3469398
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 19 cost time: 1.6500873565673828
Epoch: 19, Steps: 52 | Train Loss: 0.3987062 Vali Loss: 1.3034216 Test Loss: 0.3466732
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 20 cost time: 1.645576000213623
Epoch: 20, Steps: 52 | Train Loss: 0.3979653 Vali Loss: 1.3006728 Test Loss: 0.3471892
Validation loss decreased (1.301307 --> 1.300673).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 21 cost time: 1.6527245044708252
Epoch: 21, Steps: 52 | Train Loss: 0.3993897 Vali Loss: 1.2903353 Test Loss: 0.3460904
Validation loss decreased (1.300673 --> 1.290335).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 22 cost time: 1.6524713039398193
Epoch: 22, Steps: 52 | Train Loss: 0.3980472 Vali Loss: 1.3028207 Test Loss: 0.3459880
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 23 cost time: 1.6502196788787842
Epoch: 23, Steps: 52 | Train Loss: 0.3994340 Vali Loss: 1.2950575 Test Loss: 0.3464752
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 24 cost time: 1.6435365676879883
Epoch: 24, Steps: 52 | Train Loss: 0.3959696 Vali Loss: 1.2987826 Test Loss: 0.3451505
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 25 cost time: 1.6457037925720215
Epoch: 25, Steps: 52 | Train Loss: 0.3962638 Vali Loss: 1.2984045 Test Loss: 0.3462003
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 26 cost time: 1.6499090194702148
Epoch: 26, Steps: 52 | Train Loss: 0.3961122 Vali Loss: 1.2974050 Test Loss: 0.3461069
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 27 cost time: 1.6481521129608154
Epoch: 27, Steps: 52 | Train Loss: 0.3957862 Vali Loss: 1.2956415 Test Loss: 0.3463266
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 28 cost time: 1.6443521976470947
Epoch: 28, Steps: 52 | Train Loss: 0.3961815 Vali Loss: 1.2954758 Test Loss: 0.3460043
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 29 cost time: 1.6511104106903076
Epoch: 29, Steps: 52 | Train Loss: 0.3960556 Vali Loss: 1.2948327 Test Loss: 0.3453845
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 30 cost time: 1.6481859683990479
Epoch: 30, Steps: 52 | Train Loss: 0.3950868 Vali Loss: 1.2942910 Test Loss: 0.3459618
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 31 cost time: 1.6465234756469727
Epoch: 31, Steps: 52 | Train Loss: 0.3971076 Vali Loss: 1.2950116 Test Loss: 0.3451680
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 32 cost time: 1.6479744911193848
Epoch: 32, Steps: 52 | Train Loss: 0.3964642 Vali Loss: 1.3015893 Test Loss: 0.3454998
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 33 cost time: 1.638411521911621
Epoch: 33, Steps: 52 | Train Loss: 0.3960747 Vali Loss: 1.2972957 Test Loss: 0.3451597
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 34 cost time: 1.642458438873291
Epoch: 34, Steps: 52 | Train Loss: 0.3954755 Vali Loss: 1.2924725 Test Loss: 0.3452891
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 35 cost time: 1.6471052169799805
Epoch: 35, Steps: 52 | Train Loss: 0.3959562 Vali Loss: 1.2983978 Test Loss: 0.3457484
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 36 cost time: 1.6480348110198975
Epoch: 36, Steps: 52 | Train Loss: 0.3940879 Vali Loss: 1.2934382 Test Loss: 0.3449970
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 37 cost time: 1.6441493034362793
Epoch: 37, Steps: 52 | Train Loss: 0.3950947 Vali Loss: 1.2959775 Test Loss: 0.3457838
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 38 cost time: 1.6485717296600342
Epoch: 38, Steps: 52 | Train Loss: 0.3957129 Vali Loss: 1.2842574 Test Loss: 0.3446730
Validation loss decreased (1.290335 --> 1.284257).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 39 cost time: 1.6457717418670654
Epoch: 39, Steps: 52 | Train Loss: 0.3942697 Vali Loss: 1.2962136 Test Loss: 0.3453989
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 40 cost time: 1.6466307640075684
Epoch: 40, Steps: 52 | Train Loss: 0.3960442 Vali Loss: 1.2955205 Test Loss: 0.3454663
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 41 cost time: 1.6404175758361816
Epoch: 41, Steps: 52 | Train Loss: 0.3950207 Vali Loss: 1.2966990 Test Loss: 0.3447160
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 42 cost time: 1.6432547569274902
Epoch: 42, Steps: 52 | Train Loss: 0.3956492 Vali Loss: 1.2878015 Test Loss: 0.3453459
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 43 cost time: 1.6482665538787842
Epoch: 43, Steps: 52 | Train Loss: 0.3939591 Vali Loss: 1.2912637 Test Loss: 0.3451858
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 44 cost time: 1.6534860134124756
Epoch: 44, Steps: 52 | Train Loss: 0.3945552 Vali Loss: 1.2921522 Test Loss: 0.3450067
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 45 cost time: 1.6481242179870605
Epoch: 45, Steps: 52 | Train Loss: 0.3934379 Vali Loss: 1.2946137 Test Loss: 0.3455132
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 46 cost time: 1.6521930694580078
Epoch: 46, Steps: 52 | Train Loss: 0.3933506 Vali Loss: 1.2926719 Test Loss: 0.3456212
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 47 cost time: 1.6484806537628174
Epoch: 47, Steps: 52 | Train Loss: 0.3949151 Vali Loss: 1.2910771 Test Loss: 0.3447629
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 48 cost time: 1.6492574214935303
Epoch: 48, Steps: 52 | Train Loss: 0.3941745 Vali Loss: 1.2927251 Test Loss: 0.3449004
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 49 cost time: 1.6462287902832031
Epoch: 49, Steps: 52 | Train Loss: 0.3961190 Vali Loss: 1.2982266 Test Loss: 0.3451652
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 50 cost time: 1.6530423164367676
Epoch: 50, Steps: 52 | Train Loss: 0.3945514 Vali Loss: 1.2958443 Test Loss: 0.3446528
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 51 cost time: 1.6484825611114502
Epoch: 51, Steps: 52 | Train Loss: 0.3941342 Vali Loss: 1.2913730 Test Loss: 0.3447948
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 52 cost time: 1.6508448123931885
Epoch: 52, Steps: 52 | Train Loss: 0.3942337 Vali Loss: 1.2917295 Test Loss: 0.3456735
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 53 cost time: 1.6480634212493896
Epoch: 53, Steps: 52 | Train Loss: 0.3945237 Vali Loss: 1.2897854 Test Loss: 0.3452466
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 54 cost time: 1.6510746479034424
Epoch: 54, Steps: 52 | Train Loss: 0.3942055 Vali Loss: 1.2941949 Test Loss: 0.3448909
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 55 cost time: 1.64662504196167
Epoch: 55, Steps: 52 | Train Loss: 0.3952143 Vali Loss: 1.2965093 Test Loss: 0.3451738
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 56 cost time: 1.6486389636993408
Epoch: 56, Steps: 52 | Train Loss: 0.3919240 Vali Loss: 1.2974305 Test Loss: 0.3447043
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 57 cost time: 1.6480402946472168
Epoch: 57, Steps: 52 | Train Loss: 0.3951713 Vali Loss: 1.2846096 Test Loss: 0.3454286
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 58 cost time: 1.6534233093261719
Epoch: 58, Steps: 52 | Train Loss: 0.3960795 Vali Loss: 1.2935053 Test Loss: 0.3454818
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 59 cost time: 1.6472303867340088
Epoch: 59, Steps: 52 | Train Loss: 0.3955104 Vali Loss: 1.2787147 Test Loss: 0.3453173
Validation loss decreased (1.284257 --> 1.278715).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 60 cost time: 1.6530613899230957
Epoch: 60, Steps: 52 | Train Loss: 0.3961347 Vali Loss: 1.2929527 Test Loss: 0.3445314
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3453172743320465, mae:0.39453020691871643, rse:0.48141318559646606
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.062340736389160156 GB
Epoch: 1 cost time: 2.1319081783294678
Epoch: 1, Steps: 52 | Train Loss: 0.6916371 Vali Loss: 2.1245074 Test Loss: 1.3589380
Validation loss decreased (inf --> 2.124507).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 2 cost time: 0.7864124774932861
Epoch: 2, Steps: 52 | Train Loss: 0.5409537 Vali Loss: 1.4316264 Test Loss: 0.4292124
Validation loss decreased (2.124507 --> 1.431626).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 3 cost time: 0.7758681774139404
Epoch: 3, Steps: 52 | Train Loss: 0.4414812 Vali Loss: 1.3838904 Test Loss: 0.4036396
Validation loss decreased (1.431626 --> 1.383890).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 4 cost time: 0.7769999504089355
Epoch: 4, Steps: 52 | Train Loss: 0.4250891 Vali Loss: 1.3673407 Test Loss: 0.3822601
Validation loss decreased (1.383890 --> 1.367341).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 5 cost time: 0.8416323661804199
Epoch: 5, Steps: 52 | Train Loss: 0.4181865 Vali Loss: 1.3560497 Test Loss: 0.3720220
Validation loss decreased (1.367341 --> 1.356050).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 6 cost time: 1.696603536605835
Epoch: 6, Steps: 52 | Train Loss: 0.4136974 Vali Loss: 1.3454462 Test Loss: 0.3660631
Validation loss decreased (1.356050 --> 1.345446).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 7 cost time: 1.7080028057098389
Epoch: 7, Steps: 52 | Train Loss: 0.4102748 Vali Loss: 1.3370101 Test Loss: 0.3614212
Validation loss decreased (1.345446 --> 1.337010).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 8 cost time: 1.7167387008666992
Epoch: 8, Steps: 52 | Train Loss: 0.4076982 Vali Loss: 1.3279016 Test Loss: 0.3575980
Validation loss decreased (1.337010 --> 1.327902).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 9 cost time: 1.7191798686981201
Epoch: 9, Steps: 52 | Train Loss: 0.4040033 Vali Loss: 1.3225664 Test Loss: 0.3552178
Validation loss decreased (1.327902 --> 1.322566).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 10 cost time: 1.7159621715545654
Epoch: 10, Steps: 52 | Train Loss: 0.4031054 Vali Loss: 1.3209609 Test Loss: 0.3532899
Validation loss decreased (1.322566 --> 1.320961).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 11 cost time: 1.7181594371795654
Epoch: 11, Steps: 52 | Train Loss: 0.4025600 Vali Loss: 1.3181922 Test Loss: 0.3530959
Validation loss decreased (1.320961 --> 1.318192).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 12 cost time: 1.7182445526123047
Epoch: 12, Steps: 52 | Train Loss: 0.4019248 Vali Loss: 1.3145981 Test Loss: 0.3509999
Validation loss decreased (1.318192 --> 1.314598).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 13 cost time: 1.7240023612976074
Epoch: 13, Steps: 52 | Train Loss: 0.4011490 Vali Loss: 1.3108375 Test Loss: 0.3493345
Validation loss decreased (1.314598 --> 1.310838).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 14 cost time: 1.7185099124908447
Epoch: 14, Steps: 52 | Train Loss: 0.4000507 Vali Loss: 1.3090991 Test Loss: 0.3497164
Validation loss decreased (1.310838 --> 1.309099).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 15 cost time: 1.7184762954711914
Epoch: 15, Steps: 52 | Train Loss: 0.3999866 Vali Loss: 1.3029574 Test Loss: 0.3481652
Validation loss decreased (1.309099 --> 1.302957).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 16 cost time: 1.7218594551086426
Epoch: 16, Steps: 52 | Train Loss: 0.3982731 Vali Loss: 1.2998228 Test Loss: 0.3473262
Validation loss decreased (1.302957 --> 1.299823).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 17 cost time: 1.7246439456939697
Epoch: 17, Steps: 52 | Train Loss: 0.3962132 Vali Loss: 1.3024656 Test Loss: 0.3477665
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 18 cost time: 1.723099946975708
Epoch: 18, Steps: 52 | Train Loss: 0.3981092 Vali Loss: 1.3011539 Test Loss: 0.3469782
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 19 cost time: 1.7251620292663574
Epoch: 19, Steps: 52 | Train Loss: 0.3963937 Vali Loss: 1.2902374 Test Loss: 0.3472528
Validation loss decreased (1.299823 --> 1.290237).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 20 cost time: 1.7204828262329102
Epoch: 20, Steps: 52 | Train Loss: 0.3952283 Vali Loss: 1.3012626 Test Loss: 0.3459646
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 21 cost time: 1.7222871780395508
Epoch: 21, Steps: 52 | Train Loss: 0.3965053 Vali Loss: 1.2837795 Test Loss: 0.3460951
Validation loss decreased (1.290237 --> 1.283780).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 22 cost time: 1.7178549766540527
Epoch: 22, Steps: 52 | Train Loss: 0.3963954 Vali Loss: 1.2850223 Test Loss: 0.3451888
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 23 cost time: 1.7180235385894775
Epoch: 23, Steps: 52 | Train Loss: 0.3949939 Vali Loss: 1.2952883 Test Loss: 0.3459543
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 24 cost time: 1.7212915420532227
Epoch: 24, Steps: 52 | Train Loss: 0.3950935 Vali Loss: 1.2926016 Test Loss: 0.3464201
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 25 cost time: 1.7155044078826904
Epoch: 25, Steps: 52 | Train Loss: 0.3951742 Vali Loss: 1.2953467 Test Loss: 0.3459367
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 26 cost time: 1.7231764793395996
Epoch: 26, Steps: 52 | Train Loss: 0.3972842 Vali Loss: 1.2919402 Test Loss: 0.3456448
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 27 cost time: 1.7193410396575928
Epoch: 27, Steps: 52 | Train Loss: 0.3935177 Vali Loss: 1.2885060 Test Loss: 0.3465095
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 28 cost time: 1.7207553386688232
Epoch: 28, Steps: 52 | Train Loss: 0.3954555 Vali Loss: 1.2964994 Test Loss: 0.3457518
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 29 cost time: 1.7271804809570312
Epoch: 29, Steps: 52 | Train Loss: 0.3952740 Vali Loss: 1.2899063 Test Loss: 0.3456351
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 30 cost time: 1.722752571105957
Epoch: 30, Steps: 52 | Train Loss: 0.3956498 Vali Loss: 1.2819712 Test Loss: 0.3453357
Validation loss decreased (1.283780 --> 1.281971).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 31 cost time: 1.723836898803711
Epoch: 31, Steps: 52 | Train Loss: 0.3948063 Vali Loss: 1.2939513 Test Loss: 0.3457971
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 32 cost time: 1.723301649093628
Epoch: 32, Steps: 52 | Train Loss: 0.3950690 Vali Loss: 1.2947053 Test Loss: 0.3459277
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 33 cost time: 1.723982810974121
Epoch: 33, Steps: 52 | Train Loss: 0.3935010 Vali Loss: 1.2873194 Test Loss: 0.3450037
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 34 cost time: 1.721165657043457
Epoch: 34, Steps: 52 | Train Loss: 0.3933963 Vali Loss: 1.2915132 Test Loss: 0.3459680
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 35 cost time: 1.7164270877838135
Epoch: 35, Steps: 52 | Train Loss: 0.3927295 Vali Loss: 1.2936134 Test Loss: 0.3454301
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 36 cost time: 1.7213056087493896
Epoch: 36, Steps: 52 | Train Loss: 0.3953273 Vali Loss: 1.2935457 Test Loss: 0.3457536
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 37 cost time: 1.7231214046478271
Epoch: 37, Steps: 52 | Train Loss: 0.3943903 Vali Loss: 1.2943966 Test Loss: 0.3457035
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 38 cost time: 1.723379373550415
Epoch: 38, Steps: 52 | Train Loss: 0.3926274 Vali Loss: 1.2809398 Test Loss: 0.3452103
Validation loss decreased (1.281971 --> 1.280940).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 39 cost time: 1.721935749053955
Epoch: 39, Steps: 52 | Train Loss: 0.3943248 Vali Loss: 1.2923003 Test Loss: 0.3452495
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 40 cost time: 1.7196540832519531
Epoch: 40, Steps: 52 | Train Loss: 0.3930319 Vali Loss: 1.2941376 Test Loss: 0.3458824
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 41 cost time: 1.725367546081543
Epoch: 41, Steps: 52 | Train Loss: 0.3939836 Vali Loss: 1.2923831 Test Loss: 0.3450510
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 42 cost time: 1.7197365760803223
Epoch: 42, Steps: 52 | Train Loss: 0.3932465 Vali Loss: 1.2894278 Test Loss: 0.3447749
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 43 cost time: 1.7202849388122559
Epoch: 43, Steps: 52 | Train Loss: 0.3934973 Vali Loss: 1.2896519 Test Loss: 0.3449511
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 44 cost time: 1.717639684677124
Epoch: 44, Steps: 52 | Train Loss: 0.3948205 Vali Loss: 1.2935555 Test Loss: 0.3448945
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 45 cost time: 1.7212927341461182
Epoch: 45, Steps: 52 | Train Loss: 0.3936139 Vali Loss: 1.2868350 Test Loss: 0.3457848
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 46 cost time: 1.718702793121338
Epoch: 46, Steps: 52 | Train Loss: 0.3940170 Vali Loss: 1.2924192 Test Loss: 0.3448040
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 47 cost time: 1.7174577713012695
Epoch: 47, Steps: 52 | Train Loss: 0.3934613 Vali Loss: 1.2883017 Test Loss: 0.3448811
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 48 cost time: 1.7174296379089355
Epoch: 48, Steps: 52 | Train Loss: 0.3933156 Vali Loss: 1.2848456 Test Loss: 0.3448073
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 49 cost time: 1.7242507934570312
Epoch: 49, Steps: 52 | Train Loss: 0.3948074 Vali Loss: 1.2883391 Test Loss: 0.3455065
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 50 cost time: 1.7155299186706543
Epoch: 50, Steps: 52 | Train Loss: 0.3942216 Vali Loss: 1.2880483 Test Loss: 0.3455144
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 51 cost time: 1.7114264965057373
Epoch: 51, Steps: 52 | Train Loss: 0.3928693 Vali Loss: 1.2874717 Test Loss: 0.3450693
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 52 cost time: 1.7155418395996094
Epoch: 52, Steps: 52 | Train Loss: 0.3935797 Vali Loss: 1.2873051 Test Loss: 0.3449874
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 53 cost time: 1.7151129245758057
Epoch: 53, Steps: 52 | Train Loss: 0.3947999 Vali Loss: 1.2907333 Test Loss: 0.3448926
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 54 cost time: 1.7190957069396973
Epoch: 54, Steps: 52 | Train Loss: 0.3939037 Vali Loss: 1.2850212 Test Loss: 0.3458933
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 55 cost time: 1.7141938209533691
Epoch: 55, Steps: 52 | Train Loss: 0.3942024 Vali Loss: 1.2865052 Test Loss: 0.3449751
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 56 cost time: 1.7162835597991943
Epoch: 56, Steps: 52 | Train Loss: 0.3942069 Vali Loss: 1.2867246 Test Loss: 0.3451014
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 57 cost time: 1.7182226181030273
Epoch: 57, Steps: 52 | Train Loss: 0.3933013 Vali Loss: 1.2904114 Test Loss: 0.3465031
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 58 cost time: 1.7221357822418213
Epoch: 58, Steps: 52 | Train Loss: 0.3924286 Vali Loss: 1.2919250 Test Loss: 0.3457297
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 59 cost time: 1.7157390117645264
Epoch: 59, Steps: 52 | Train Loss: 0.3937491 Vali Loss: 1.2823105 Test Loss: 0.3452992
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 60 cost time: 1.722254753112793
Epoch: 60, Steps: 52 | Train Loss: 0.3935580 Vali Loss: 1.2780006 Test Loss: 0.3454742
Validation loss decreased (1.280940 --> 1.278001).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34547415375709534, mae:0.3954637348651886, rse:0.4815225303173065
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.057959556579589844 GB
Epoch: 1 cost time: 2.057405471801758
Epoch: 1, Steps: 52 | Train Loss: 0.7690641 Vali Loss: 2.2584324 Test Loss: 1.4795836
Validation loss decreased (inf --> 2.258432).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 2 cost time: 0.695631742477417
Epoch: 2, Steps: 52 | Train Loss: 0.6987884 Vali Loss: 1.9163823 Test Loss: 1.1002039
Validation loss decreased (2.258432 --> 1.916382).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 3 cost time: 0.7008485794067383
Epoch: 3, Steps: 52 | Train Loss: 0.6001298 Vali Loss: 1.6832454 Test Loss: 0.8072015
Validation loss decreased (1.916382 --> 1.683245).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 4 cost time: 0.6917979717254639
Epoch: 4, Steps: 52 | Train Loss: 0.5272411 Vali Loss: 1.5305724 Test Loss: 0.5764499
Validation loss decreased (1.683245 --> 1.530572).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 5 cost time: 0.6850314140319824
Epoch: 5, Steps: 52 | Train Loss: 0.4815723 Vali Loss: 1.4496015 Test Loss: 0.4676062
Validation loss decreased (1.530572 --> 1.449602).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 6 cost time: 1.076188087463379
Epoch: 6, Steps: 52 | Train Loss: 0.4606936 Vali Loss: 1.4199445 Test Loss: 0.4273264
Validation loss decreased (1.449602 --> 1.419945).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 7 cost time: 1.542135238647461
Epoch: 7, Steps: 52 | Train Loss: 0.4503643 Vali Loss: 1.4021392 Test Loss: 0.4058828
Validation loss decreased (1.419945 --> 1.402139).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 8 cost time: 1.5394847393035889
Epoch: 8, Steps: 52 | Train Loss: 0.4427981 Vali Loss: 1.3923627 Test Loss: 0.3923935
Validation loss decreased (1.402139 --> 1.392363).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 9 cost time: 1.5504627227783203
Epoch: 9, Steps: 52 | Train Loss: 0.4384598 Vali Loss: 1.3721528 Test Loss: 0.3834837
Validation loss decreased (1.392363 --> 1.372153).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 10 cost time: 1.5375053882598877
Epoch: 10, Steps: 52 | Train Loss: 0.4328342 Vali Loss: 1.3714095 Test Loss: 0.3768125
Validation loss decreased (1.372153 --> 1.371410).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 11 cost time: 1.545595645904541
Epoch: 11, Steps: 52 | Train Loss: 0.4302163 Vali Loss: 1.3530762 Test Loss: 0.3728312
Validation loss decreased (1.371410 --> 1.353076).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 12 cost time: 1.5466480255126953
Epoch: 12, Steps: 52 | Train Loss: 0.4267902 Vali Loss: 1.3515449 Test Loss: 0.3691644
Validation loss decreased (1.353076 --> 1.351545).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 13 cost time: 1.5385162830352783
Epoch: 13, Steps: 52 | Train Loss: 0.4249572 Vali Loss: 1.3385820 Test Loss: 0.3662717
Validation loss decreased (1.351545 --> 1.338582).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 14 cost time: 1.5440750122070312
Epoch: 14, Steps: 52 | Train Loss: 0.4236583 Vali Loss: 1.3458762 Test Loss: 0.3637495
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 15 cost time: 1.5403566360473633
Epoch: 15, Steps: 52 | Train Loss: 0.4227237 Vali Loss: 1.3434339 Test Loss: 0.3623190
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 16 cost time: 1.5413177013397217
Epoch: 16, Steps: 52 | Train Loss: 0.4199162 Vali Loss: 1.3433040 Test Loss: 0.3607353
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 17 cost time: 1.539045810699463
Epoch: 17, Steps: 52 | Train Loss: 0.4197593 Vali Loss: 1.3322775 Test Loss: 0.3593115
Validation loss decreased (1.338582 --> 1.332278).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 18 cost time: 1.5362272262573242
Epoch: 18, Steps: 52 | Train Loss: 0.4189747 Vali Loss: 1.3360492 Test Loss: 0.3579987
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 19 cost time: 1.5505380630493164
Epoch: 19, Steps: 52 | Train Loss: 0.4173151 Vali Loss: 1.3280442 Test Loss: 0.3572719
Validation loss decreased (1.332278 --> 1.328044).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 20 cost time: 1.535386562347412
Epoch: 20, Steps: 52 | Train Loss: 0.4143025 Vali Loss: 1.3345098 Test Loss: 0.3561659
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 21 cost time: 1.537306308746338
Epoch: 21, Steps: 52 | Train Loss: 0.4175282 Vali Loss: 1.3290000 Test Loss: 0.3560030
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 22 cost time: 1.5385584831237793
Epoch: 22, Steps: 52 | Train Loss: 0.4134268 Vali Loss: 1.3329000 Test Loss: 0.3549381
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 23 cost time: 1.5399413108825684
Epoch: 23, Steps: 52 | Train Loss: 0.4139569 Vali Loss: 1.3243512 Test Loss: 0.3545094
Validation loss decreased (1.328044 --> 1.324351).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 24 cost time: 1.5462541580200195
Epoch: 24, Steps: 52 | Train Loss: 0.4148795 Vali Loss: 1.3266488 Test Loss: 0.3539466
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 25 cost time: 1.5363829135894775
Epoch: 25, Steps: 52 | Train Loss: 0.4130179 Vali Loss: 1.3226368 Test Loss: 0.3537112
Validation loss decreased (1.324351 --> 1.322637).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 26 cost time: 1.5437650680541992
Epoch: 26, Steps: 52 | Train Loss: 0.4148888 Vali Loss: 1.3275790 Test Loss: 0.3527886
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 27 cost time: 1.535614013671875
Epoch: 27, Steps: 52 | Train Loss: 0.4115575 Vali Loss: 1.3243716 Test Loss: 0.3528616
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 28 cost time: 1.5442333221435547
Epoch: 28, Steps: 52 | Train Loss: 0.4114007 Vali Loss: 1.3228462 Test Loss: 0.3525198
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 29 cost time: 1.5336501598358154
Epoch: 29, Steps: 52 | Train Loss: 0.4125719 Vali Loss: 1.3159873 Test Loss: 0.3518758
Validation loss decreased (1.322637 --> 1.315987).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 30 cost time: 1.5400447845458984
Epoch: 30, Steps: 52 | Train Loss: 0.4121240 Vali Loss: 1.3188765 Test Loss: 0.3519512
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 31 cost time: 1.5376317501068115
Epoch: 31, Steps: 52 | Train Loss: 0.4109252 Vali Loss: 1.3175534 Test Loss: 0.3517903
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 32 cost time: 1.5400855541229248
Epoch: 32, Steps: 52 | Train Loss: 0.4104354 Vali Loss: 1.3165878 Test Loss: 0.3515886
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 33 cost time: 1.544156789779663
Epoch: 33, Steps: 52 | Train Loss: 0.4114209 Vali Loss: 1.3145900 Test Loss: 0.3516154
Validation loss decreased (1.315987 --> 1.314590).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 34 cost time: 1.5446503162384033
Epoch: 34, Steps: 52 | Train Loss: 0.4124738 Vali Loss: 1.3125489 Test Loss: 0.3513965
Validation loss decreased (1.314590 --> 1.312549).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 35 cost time: 1.5313470363616943
Epoch: 35, Steps: 52 | Train Loss: 0.4116005 Vali Loss: 1.3163584 Test Loss: 0.3511552
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 36 cost time: 1.538454294204712
Epoch: 36, Steps: 52 | Train Loss: 0.4115904 Vali Loss: 1.3178624 Test Loss: 0.3508531
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 37 cost time: 1.5330040454864502
Epoch: 37, Steps: 52 | Train Loss: 0.4097304 Vali Loss: 1.3141444 Test Loss: 0.3511414
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 38 cost time: 1.53794264793396
Epoch: 38, Steps: 52 | Train Loss: 0.4113839 Vali Loss: 1.3181179 Test Loss: 0.3509018
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 39 cost time: 1.5357396602630615
Epoch: 39, Steps: 52 | Train Loss: 0.4105243 Vali Loss: 1.3174326 Test Loss: 0.3508555
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 40 cost time: 1.5482897758483887
Epoch: 40, Steps: 52 | Train Loss: 0.4110881 Vali Loss: 1.3129439 Test Loss: 0.3509827
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 41 cost time: 1.5372071266174316
Epoch: 41, Steps: 52 | Train Loss: 0.4097931 Vali Loss: 1.3138925 Test Loss: 0.3509033
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 42 cost time: 1.5462167263031006
Epoch: 42, Steps: 52 | Train Loss: 0.4092427 Vali Loss: 1.3196743 Test Loss: 0.3505080
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 43 cost time: 1.5373797416687012
Epoch: 43, Steps: 52 | Train Loss: 0.4115198 Vali Loss: 1.3087661 Test Loss: 0.3505723
Validation loss decreased (1.312549 --> 1.308766).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 44 cost time: 1.5392138957977295
Epoch: 44, Steps: 52 | Train Loss: 0.4104288 Vali Loss: 1.3191577 Test Loss: 0.3505329
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 45 cost time: 1.5362751483917236
Epoch: 45, Steps: 52 | Train Loss: 0.4104902 Vali Loss: 1.3189521 Test Loss: 0.3504980
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 46 cost time: 1.5455186367034912
Epoch: 46, Steps: 52 | Train Loss: 0.4104447 Vali Loss: 1.3116148 Test Loss: 0.3506675
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 47 cost time: 1.539832353591919
Epoch: 47, Steps: 52 | Train Loss: 0.4116926 Vali Loss: 1.3136015 Test Loss: 0.3504517
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 48 cost time: 1.5373735427856445
Epoch: 48, Steps: 52 | Train Loss: 0.4104504 Vali Loss: 1.3180909 Test Loss: 0.3505695
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 49 cost time: 1.545907974243164
Epoch: 49, Steps: 52 | Train Loss: 0.4113862 Vali Loss: 1.3140051 Test Loss: 0.3505365
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 50 cost time: 1.5370769500732422
Epoch: 50, Steps: 52 | Train Loss: 0.4098429 Vali Loss: 1.3157279 Test Loss: 0.3503605
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 51 cost time: 1.5448808670043945
Epoch: 51, Steps: 52 | Train Loss: 0.4100614 Vali Loss: 1.3113132 Test Loss: 0.3502001
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 52 cost time: 1.5302190780639648
Epoch: 52, Steps: 52 | Train Loss: 0.4103625 Vali Loss: 1.3122106 Test Loss: 0.3507476
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 53 cost time: 1.545039415359497
Epoch: 53, Steps: 52 | Train Loss: 0.4115293 Vali Loss: 1.3161416 Test Loss: 0.3501390
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 54 cost time: 1.545520305633545
Epoch: 54, Steps: 52 | Train Loss: 0.4088613 Vali Loss: 1.3121414 Test Loss: 0.3498910
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 55 cost time: 1.542414665222168
Epoch: 55, Steps: 52 | Train Loss: 0.4095405 Vali Loss: 1.3158112 Test Loss: 0.3501923
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 56 cost time: 1.548457145690918
Epoch: 56, Steps: 52 | Train Loss: 0.4092305 Vali Loss: 1.3165078 Test Loss: 0.3504050
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 57 cost time: 1.5413429737091064
Epoch: 57, Steps: 52 | Train Loss: 0.4112547 Vali Loss: 1.3118436 Test Loss: 0.3501801
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 58 cost time: 1.5362625122070312
Epoch: 58, Steps: 52 | Train Loss: 0.4101093 Vali Loss: 1.3199656 Test Loss: 0.3502013
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 59 cost time: 1.5407257080078125
Epoch: 59, Steps: 52 | Train Loss: 0.4092199 Vali Loss: 1.3118415 Test Loss: 0.3502195
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 60 cost time: 1.5372731685638428
Epoch: 60, Steps: 52 | Train Loss: 0.4106092 Vali Loss: 1.3152629 Test Loss: 0.3499954
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3505723178386688, mae:0.3946903645992279, rse:0.4850623905658722
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.062354087829589844 GB
Epoch: 1 cost time: 2.1205146312713623
Epoch: 1, Steps: 52 | Train Loss: 0.6806493 Vali Loss: 2.0795481 Test Loss: 1.2908045
Validation loss decreased (inf --> 2.079548).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 2 cost time: 0.7223775386810303
Epoch: 2, Steps: 52 | Train Loss: 0.5588261 Vali Loss: 1.5141418 Test Loss: 0.5480077
Validation loss decreased (2.079548 --> 1.514142).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 3 cost time: 0.7056639194488525
Epoch: 3, Steps: 52 | Train Loss: 0.4609200 Vali Loss: 1.4110408 Test Loss: 0.4160690
Validation loss decreased (1.514142 --> 1.411041).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 4 cost time: 0.7063682079315186
Epoch: 4, Steps: 52 | Train Loss: 0.4364979 Vali Loss: 1.3856149 Test Loss: 0.3903169
Validation loss decreased (1.411041 --> 1.385615).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 5 cost time: 0.7073712348937988
Epoch: 5, Steps: 52 | Train Loss: 0.4274784 Vali Loss: 1.3727403 Test Loss: 0.3781195
Validation loss decreased (1.385615 --> 1.372740).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 6 cost time: 1.3808350563049316
Epoch: 6, Steps: 52 | Train Loss: 0.4215817 Vali Loss: 1.3584439 Test Loss: 0.3711485
Validation loss decreased (1.372740 --> 1.358444).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 7 cost time: 1.587740421295166
Epoch: 7, Steps: 52 | Train Loss: 0.4175826 Vali Loss: 1.3492682 Test Loss: 0.3661791
Validation loss decreased (1.358444 --> 1.349268).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 8 cost time: 1.5987508296966553
Epoch: 8, Steps: 52 | Train Loss: 0.4144672 Vali Loss: 1.3441408 Test Loss: 0.3622008
Validation loss decreased (1.349268 --> 1.344141).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 9 cost time: 1.5975611209869385
Epoch: 9, Steps: 52 | Train Loss: 0.4108429 Vali Loss: 1.3285282 Test Loss: 0.3598033
Validation loss decreased (1.344141 --> 1.328528).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 10 cost time: 1.5956196784973145
Epoch: 10, Steps: 52 | Train Loss: 0.4102431 Vali Loss: 1.3310194 Test Loss: 0.3573789
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 11 cost time: 1.5971405506134033
Epoch: 11, Steps: 52 | Train Loss: 0.4082836 Vali Loss: 1.3308363 Test Loss: 0.3563860
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 12 cost time: 1.6000473499298096
Epoch: 12, Steps: 52 | Train Loss: 0.4073056 Vali Loss: 1.3248231 Test Loss: 0.3550630
Validation loss decreased (1.328528 --> 1.324823).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 13 cost time: 1.5939583778381348
Epoch: 13, Steps: 52 | Train Loss: 0.4046293 Vali Loss: 1.3118936 Test Loss: 0.3540736
Validation loss decreased (1.324823 --> 1.311894).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 14 cost time: 1.60048508644104
Epoch: 14, Steps: 52 | Train Loss: 0.4046410 Vali Loss: 1.3156369 Test Loss: 0.3534696
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 15 cost time: 1.594820261001587
Epoch: 15, Steps: 52 | Train Loss: 0.4044225 Vali Loss: 1.3118411 Test Loss: 0.3524228
Validation loss decreased (1.311894 --> 1.311841).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 16 cost time: 1.5950767993927002
Epoch: 16, Steps: 52 | Train Loss: 0.4016486 Vali Loss: 1.3143657 Test Loss: 0.3521785
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 17 cost time: 1.595304250717163
Epoch: 17, Steps: 52 | Train Loss: 0.4012620 Vali Loss: 1.3070641 Test Loss: 0.3517619
Validation loss decreased (1.311841 --> 1.307064).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 18 cost time: 1.6003825664520264
Epoch: 18, Steps: 52 | Train Loss: 0.4022802 Vali Loss: 1.3085513 Test Loss: 0.3516895
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 19 cost time: 1.5951311588287354
Epoch: 19, Steps: 52 | Train Loss: 0.4007424 Vali Loss: 1.3057451 Test Loss: 0.3507458
Validation loss decreased (1.307064 --> 1.305745).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 20 cost time: 1.6003270149230957
Epoch: 20, Steps: 52 | Train Loss: 0.3995441 Vali Loss: 1.3045877 Test Loss: 0.3506106
Validation loss decreased (1.305745 --> 1.304588).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 21 cost time: 1.5970299243927002
Epoch: 21, Steps: 52 | Train Loss: 0.4012785 Vali Loss: 1.2963057 Test Loss: 0.3506051
Validation loss decreased (1.304588 --> 1.296306).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 22 cost time: 1.597428321838379
Epoch: 22, Steps: 52 | Train Loss: 0.3993663 Vali Loss: 1.2977717 Test Loss: 0.3502046
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 23 cost time: 1.5925474166870117
Epoch: 23, Steps: 52 | Train Loss: 0.4006840 Vali Loss: 1.2990041 Test Loss: 0.3503934
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 24 cost time: 1.5976996421813965
Epoch: 24, Steps: 52 | Train Loss: 0.3989757 Vali Loss: 1.3040875 Test Loss: 0.3502071
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 25 cost time: 1.5976626873016357
Epoch: 25, Steps: 52 | Train Loss: 0.3988787 Vali Loss: 1.2925911 Test Loss: 0.3500594
Validation loss decreased (1.296306 --> 1.292591).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 26 cost time: 1.5994954109191895
Epoch: 26, Steps: 52 | Train Loss: 0.4007418 Vali Loss: 1.2976257 Test Loss: 0.3503172
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 27 cost time: 1.594677209854126
Epoch: 27, Steps: 52 | Train Loss: 0.3999350 Vali Loss: 1.3017323 Test Loss: 0.3511374
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 28 cost time: 1.5988759994506836
Epoch: 28, Steps: 52 | Train Loss: 0.3985436 Vali Loss: 1.2922362 Test Loss: 0.3499181
Validation loss decreased (1.292591 --> 1.292236).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 29 cost time: 1.5944178104400635
Epoch: 29, Steps: 52 | Train Loss: 0.3995265 Vali Loss: 1.2975731 Test Loss: 0.3504905
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 30 cost time: 1.597480058670044
Epoch: 30, Steps: 52 | Train Loss: 0.3989414 Vali Loss: 1.3026767 Test Loss: 0.3508801
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 31 cost time: 1.5929155349731445
Epoch: 31, Steps: 52 | Train Loss: 0.3985702 Vali Loss: 1.3019607 Test Loss: 0.3504623
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 32 cost time: 1.5949673652648926
Epoch: 32, Steps: 52 | Train Loss: 0.3976257 Vali Loss: 1.2995944 Test Loss: 0.3497306
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 33 cost time: 1.5902690887451172
Epoch: 33, Steps: 52 | Train Loss: 0.3989652 Vali Loss: 1.2988687 Test Loss: 0.3493701
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 34 cost time: 1.5954699516296387
Epoch: 34, Steps: 52 | Train Loss: 0.3983994 Vali Loss: 1.3014692 Test Loss: 0.3510070
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 35 cost time: 1.5979304313659668
Epoch: 35, Steps: 52 | Train Loss: 0.3998366 Vali Loss: 1.2982675 Test Loss: 0.3505962
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 36 cost time: 1.5968587398529053
Epoch: 36, Steps: 52 | Train Loss: 0.3983216 Vali Loss: 1.3014356 Test Loss: 0.3497950
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 37 cost time: 1.5972185134887695
Epoch: 37, Steps: 52 | Train Loss: 0.3979776 Vali Loss: 1.2974373 Test Loss: 0.3507943
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 38 cost time: 1.5963122844696045
Epoch: 38, Steps: 52 | Train Loss: 0.3972547 Vali Loss: 1.3004615 Test Loss: 0.3506382
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 39 cost time: 1.5949122905731201
Epoch: 39, Steps: 52 | Train Loss: 0.3987882 Vali Loss: 1.2962809 Test Loss: 0.3509242
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 40 cost time: 1.593991994857788
Epoch: 40, Steps: 52 | Train Loss: 0.3974097 Vali Loss: 1.2937880 Test Loss: 0.3508023
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 41 cost time: 1.5938763618469238
Epoch: 41, Steps: 52 | Train Loss: 0.3975983 Vali Loss: 1.2968636 Test Loss: 0.3501835
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 42 cost time: 1.5939812660217285
Epoch: 42, Steps: 52 | Train Loss: 0.3986501 Vali Loss: 1.2954468 Test Loss: 0.3499080
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 43 cost time: 1.593998670578003
Epoch: 43, Steps: 52 | Train Loss: 0.3965278 Vali Loss: 1.2927500 Test Loss: 0.3499401
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 44 cost time: 1.5971200466156006
Epoch: 44, Steps: 52 | Train Loss: 0.3979823 Vali Loss: 1.2926149 Test Loss: 0.3496802
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 45 cost time: 1.5966475009918213
Epoch: 45, Steps: 52 | Train Loss: 0.3980772 Vali Loss: 1.2921151 Test Loss: 0.3504263
Validation loss decreased (1.292236 --> 1.292115).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 46 cost time: 1.5974650382995605
Epoch: 46, Steps: 52 | Train Loss: 0.3977755 Vali Loss: 1.2907143 Test Loss: 0.3493311
Validation loss decreased (1.292115 --> 1.290714).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 47 cost time: 1.5913972854614258
Epoch: 47, Steps: 52 | Train Loss: 0.3976530 Vali Loss: 1.3004322 Test Loss: 0.3500646
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 48 cost time: 1.595818042755127
Epoch: 48, Steps: 52 | Train Loss: 0.3964994 Vali Loss: 1.2964211 Test Loss: 0.3508611
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 49 cost time: 1.5968642234802246
Epoch: 49, Steps: 52 | Train Loss: 0.3966562 Vali Loss: 1.2967966 Test Loss: 0.3500126
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 50 cost time: 1.5968544483184814
Epoch: 50, Steps: 52 | Train Loss: 0.3965474 Vali Loss: 1.3012638 Test Loss: 0.3497838
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 51 cost time: 1.599790096282959
Epoch: 51, Steps: 52 | Train Loss: 0.3985896 Vali Loss: 1.2998540 Test Loss: 0.3498159
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 52 cost time: 1.5913918018341064
Epoch: 52, Steps: 52 | Train Loss: 0.3990643 Vali Loss: 1.2957850 Test Loss: 0.3497363
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 53 cost time: 1.5998575687408447
Epoch: 53, Steps: 52 | Train Loss: 0.3974153 Vali Loss: 1.2878792 Test Loss: 0.3499224
Validation loss decreased (1.290714 --> 1.287879).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 54 cost time: 1.5948302745819092
Epoch: 54, Steps: 52 | Train Loss: 0.3976589 Vali Loss: 1.2894886 Test Loss: 0.3500324
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 55 cost time: 1.5982582569122314
Epoch: 55, Steps: 52 | Train Loss: 0.3983718 Vali Loss: 1.2952907 Test Loss: 0.3500343
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 56 cost time: 1.5967206954956055
Epoch: 56, Steps: 52 | Train Loss: 0.3985936 Vali Loss: 1.2931814 Test Loss: 0.3512415
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 57 cost time: 1.5946698188781738
Epoch: 57, Steps: 52 | Train Loss: 0.3983190 Vali Loss: 1.2952528 Test Loss: 0.3497376
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 58 cost time: 1.5990357398986816
Epoch: 58, Steps: 52 | Train Loss: 0.3976423 Vali Loss: 1.3024756 Test Loss: 0.3504272
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 59 cost time: 1.5982944965362549
Epoch: 59, Steps: 52 | Train Loss: 0.3983224 Vali Loss: 1.2990295 Test Loss: 0.3496645
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 60 cost time: 1.5979249477386475
Epoch: 60, Steps: 52 | Train Loss: 0.3975661 Vali Loss: 1.2992141 Test Loss: 0.3500470
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34992238879203796, mae:0.39949798583984375, rse:0.4846125543117523
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.06565284729003906 GB
Epoch: 1 cost time: 2.133460521697998
Epoch: 1, Steps: 52 | Train Loss: 0.7018202 Vali Loss: 2.1470342 Test Loss: 1.4029303
Validation loss decreased (inf --> 2.147034).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 2 cost time: 0.7596321105957031
Epoch: 2, Steps: 52 | Train Loss: 0.5687393 Vali Loss: 1.4849012 Test Loss: 0.5007232
Validation loss decreased (2.147034 --> 1.484901).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 3 cost time: 0.7594027519226074
Epoch: 3, Steps: 52 | Train Loss: 0.4517229 Vali Loss: 1.3913703 Test Loss: 0.4069275
Validation loss decreased (1.484901 --> 1.391370).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 4 cost time: 0.7595036029815674
Epoch: 4, Steps: 52 | Train Loss: 0.4302370 Vali Loss: 1.3744439 Test Loss: 0.3785215
Validation loss decreased (1.391370 --> 1.374444).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 5 cost time: 0.7570004463195801
Epoch: 5, Steps: 52 | Train Loss: 0.4227871 Vali Loss: 1.3541777 Test Loss: 0.3730747
Validation loss decreased (1.374444 --> 1.354178).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 6 cost time: 1.6473782062530518
Epoch: 6, Steps: 52 | Train Loss: 0.4169657 Vali Loss: 1.3530658 Test Loss: 0.3675228
Validation loss decreased (1.354178 --> 1.353066).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 7 cost time: 1.66872239112854
Epoch: 7, Steps: 52 | Train Loss: 0.4143016 Vali Loss: 1.3304503 Test Loss: 0.3637019
Validation loss decreased (1.353066 --> 1.330450).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 8 cost time: 1.6703412532806396
Epoch: 8, Steps: 52 | Train Loss: 0.4121827 Vali Loss: 1.3363005 Test Loss: 0.3601378
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 9 cost time: 1.6704809665679932
Epoch: 9, Steps: 52 | Train Loss: 0.4090306 Vali Loss: 1.3216503 Test Loss: 0.3585436
Validation loss decreased (1.330450 --> 1.321650).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 10 cost time: 1.6705751419067383
Epoch: 10, Steps: 52 | Train Loss: 0.4073710 Vali Loss: 1.3227174 Test Loss: 0.3573645
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 11 cost time: 1.6722216606140137
Epoch: 11, Steps: 52 | Train Loss: 0.4059674 Vali Loss: 1.3131220 Test Loss: 0.3563524
Validation loss decreased (1.321650 --> 1.313122).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 12 cost time: 1.6730015277862549
Epoch: 12, Steps: 52 | Train Loss: 0.4048133 Vali Loss: 1.3119717 Test Loss: 0.3550538
Validation loss decreased (1.313122 --> 1.311972).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 13 cost time: 1.676626205444336
Epoch: 13, Steps: 52 | Train Loss: 0.4029627 Vali Loss: 1.3114457 Test Loss: 0.3547081
Validation loss decreased (1.311972 --> 1.311446).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 14 cost time: 1.6727571487426758
Epoch: 14, Steps: 52 | Train Loss: 0.4021030 Vali Loss: 1.3071332 Test Loss: 0.3545014
Validation loss decreased (1.311446 --> 1.307133).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 15 cost time: 1.6700515747070312
Epoch: 15, Steps: 52 | Train Loss: 0.4018199 Vali Loss: 1.3036646 Test Loss: 0.3540973
Validation loss decreased (1.307133 --> 1.303665).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 16 cost time: 1.6690006256103516
Epoch: 16, Steps: 52 | Train Loss: 0.4005706 Vali Loss: 1.3099582 Test Loss: 0.3547243
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 17 cost time: 1.6720106601715088
Epoch: 17, Steps: 52 | Train Loss: 0.4013044 Vali Loss: 1.3087831 Test Loss: 0.3539545
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 18 cost time: 1.673072338104248
Epoch: 18, Steps: 52 | Train Loss: 0.4001406 Vali Loss: 1.3045843 Test Loss: 0.3533212
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 19 cost time: 1.6736094951629639
Epoch: 19, Steps: 52 | Train Loss: 0.3982453 Vali Loss: 1.3099272 Test Loss: 0.3532898
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 20 cost time: 1.6730587482452393
Epoch: 20, Steps: 52 | Train Loss: 0.3999496 Vali Loss: 1.2983897 Test Loss: 0.3527181
Validation loss decreased (1.303665 --> 1.298390).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 21 cost time: 1.6750710010528564
Epoch: 21, Steps: 52 | Train Loss: 0.3999406 Vali Loss: 1.2991569 Test Loss: 0.3525849
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 22 cost time: 1.670180320739746
Epoch: 22, Steps: 52 | Train Loss: 0.3985664 Vali Loss: 1.2958640 Test Loss: 0.3520490
Validation loss decreased (1.298390 --> 1.295864).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 23 cost time: 1.6698179244995117
Epoch: 23, Steps: 52 | Train Loss: 0.3987891 Vali Loss: 1.2962401 Test Loss: 0.3515109
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 24 cost time: 1.667539358139038
Epoch: 24, Steps: 52 | Train Loss: 0.3961927 Vali Loss: 1.2995009 Test Loss: 0.3520424
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 25 cost time: 1.6701231002807617
Epoch: 25, Steps: 52 | Train Loss: 0.3985269 Vali Loss: 1.2936593 Test Loss: 0.3523300
Validation loss decreased (1.295864 --> 1.293659).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 26 cost time: 1.6705780029296875
Epoch: 26, Steps: 52 | Train Loss: 0.3973585 Vali Loss: 1.2987473 Test Loss: 0.3522688
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 27 cost time: 1.671224594116211
Epoch: 27, Steps: 52 | Train Loss: 0.3975574 Vali Loss: 1.2941008 Test Loss: 0.3517746
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 28 cost time: 1.6661067008972168
Epoch: 28, Steps: 52 | Train Loss: 0.3993427 Vali Loss: 1.2986295 Test Loss: 0.3523970
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 29 cost time: 1.6671137809753418
Epoch: 29, Steps: 52 | Train Loss: 0.3974578 Vali Loss: 1.2950215 Test Loss: 0.3521474
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 30 cost time: 1.6750519275665283
Epoch: 30, Steps: 52 | Train Loss: 0.3969047 Vali Loss: 1.3032649 Test Loss: 0.3521174
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 31 cost time: 1.669497013092041
Epoch: 31, Steps: 52 | Train Loss: 0.3983926 Vali Loss: 1.2868228 Test Loss: 0.3509808
Validation loss decreased (1.293659 --> 1.286823).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 32 cost time: 1.679185152053833
Epoch: 32, Steps: 52 | Train Loss: 0.3954075 Vali Loss: 1.2887357 Test Loss: 0.3513426
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 33 cost time: 1.668048620223999
Epoch: 33, Steps: 52 | Train Loss: 0.3965457 Vali Loss: 1.2921743 Test Loss: 0.3523096
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 34 cost time: 1.6763136386871338
Epoch: 34, Steps: 52 | Train Loss: 0.3976860 Vali Loss: 1.3013266 Test Loss: 0.3521751
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 35 cost time: 1.6691234111785889
Epoch: 35, Steps: 52 | Train Loss: 0.3970050 Vali Loss: 1.2981443 Test Loss: 0.3514638
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 36 cost time: 1.6755363941192627
Epoch: 36, Steps: 52 | Train Loss: 0.3974332 Vali Loss: 1.3042965 Test Loss: 0.3516891
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 37 cost time: 1.6697335243225098
Epoch: 37, Steps: 52 | Train Loss: 0.3972029 Vali Loss: 1.2891717 Test Loss: 0.3523530
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 38 cost time: 1.676255464553833
Epoch: 38, Steps: 52 | Train Loss: 0.3956218 Vali Loss: 1.2981646 Test Loss: 0.3514196
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 39 cost time: 1.664947271347046
Epoch: 39, Steps: 52 | Train Loss: 0.3963549 Vali Loss: 1.3002024 Test Loss: 0.3519771
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 40 cost time: 1.6769194602966309
Epoch: 40, Steps: 52 | Train Loss: 0.3974469 Vali Loss: 1.2941797 Test Loss: 0.3514936
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 41 cost time: 1.671227216720581
Epoch: 41, Steps: 52 | Train Loss: 0.3964186 Vali Loss: 1.2959770 Test Loss: 0.3512426
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 42 cost time: 1.6691792011260986
Epoch: 42, Steps: 52 | Train Loss: 0.3960884 Vali Loss: 1.2931979 Test Loss: 0.3511302
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 43 cost time: 1.6713855266571045
Epoch: 43, Steps: 52 | Train Loss: 0.3967277 Vali Loss: 1.3028774 Test Loss: 0.3515576
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 44 cost time: 1.6701934337615967
Epoch: 44, Steps: 52 | Train Loss: 0.3955867 Vali Loss: 1.3016679 Test Loss: 0.3512921
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 45 cost time: 1.668138027191162
Epoch: 45, Steps: 52 | Train Loss: 0.3969486 Vali Loss: 1.3021984 Test Loss: 0.3517922
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 46 cost time: 1.676224708557129
Epoch: 46, Steps: 52 | Train Loss: 0.3960479 Vali Loss: 1.2972733 Test Loss: 0.3507674
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 47 cost time: 1.6752095222473145
Epoch: 47, Steps: 52 | Train Loss: 0.3951862 Vali Loss: 1.3008999 Test Loss: 0.3516666
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 48 cost time: 1.6723968982696533
Epoch: 48, Steps: 52 | Train Loss: 0.3955298 Vali Loss: 1.2972274 Test Loss: 0.3510317
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 49 cost time: 1.6671721935272217
Epoch: 49, Steps: 52 | Train Loss: 0.3967872 Vali Loss: 1.2913108 Test Loss: 0.3515942
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 50 cost time: 1.6708683967590332
Epoch: 50, Steps: 52 | Train Loss: 0.3965070 Vali Loss: 1.2972488 Test Loss: 0.3512725
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 51 cost time: 1.6732268333435059
Epoch: 51, Steps: 52 | Train Loss: 0.3967055 Vali Loss: 1.2948437 Test Loss: 0.3515539
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 52 cost time: 1.6747236251831055
Epoch: 52, Steps: 52 | Train Loss: 0.3962803 Vali Loss: 1.2960844 Test Loss: 0.3517459
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 53 cost time: 1.673288106918335
Epoch: 53, Steps: 52 | Train Loss: 0.3966761 Vali Loss: 1.2962346 Test Loss: 0.3511301
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 54 cost time: 1.6729319095611572
Epoch: 54, Steps: 52 | Train Loss: 0.3967660 Vali Loss: 1.3022411 Test Loss: 0.3513863
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 55 cost time: 1.6698193550109863
Epoch: 55, Steps: 52 | Train Loss: 0.3970211 Vali Loss: 1.3009996 Test Loss: 0.3510129
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 56 cost time: 1.6740241050720215
Epoch: 56, Steps: 52 | Train Loss: 0.3954010 Vali Loss: 1.2985568 Test Loss: 0.3509781
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 57 cost time: 1.6709771156311035
Epoch: 57, Steps: 52 | Train Loss: 0.3959833 Vali Loss: 1.2952094 Test Loss: 0.3508552
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 58 cost time: 1.6645305156707764
Epoch: 58, Steps: 52 | Train Loss: 0.3950022 Vali Loss: 1.2944417 Test Loss: 0.3510909
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 59 cost time: 1.6694929599761963
Epoch: 59, Steps: 52 | Train Loss: 0.3966264 Vali Loss: 1.2946138 Test Loss: 0.3513404
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 60 cost time: 1.674165964126587
Epoch: 60, Steps: 52 | Train Loss: 0.3955881 Vali Loss: 1.2955141 Test Loss: 0.3512844
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3509807884693146, mae:0.3992599546909332, rse:0.48534491658210754
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.0581212043762207 GB
Epoch: 1 cost time: 2.0540213584899902
Epoch: 1, Steps: 52 | Train Loss: 0.7909765 Vali Loss: 2.2793899 Test Loss: 1.5335475
Validation loss decreased (inf --> 2.279390).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 2 cost time: 0.703366756439209
Epoch: 2, Steps: 52 | Train Loss: 0.6908125 Vali Loss: 1.8097891 Test Loss: 0.9601843
Validation loss decreased (2.279390 --> 1.809789).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 3 cost time: 0.6786370277404785
Epoch: 3, Steps: 52 | Train Loss: 0.5632071 Vali Loss: 1.5573324 Test Loss: 0.6052673
Validation loss decreased (1.809789 --> 1.557332).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 4 cost time: 0.6944065093994141
Epoch: 4, Steps: 52 | Train Loss: 0.4937174 Vali Loss: 1.4586933 Test Loss: 0.4655397
Validation loss decreased (1.557332 --> 1.458693).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 5 cost time: 0.6917603015899658
Epoch: 5, Steps: 52 | Train Loss: 0.4692335 Vali Loss: 1.4241281 Test Loss: 0.4272527
Validation loss decreased (1.458693 --> 1.424128).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 6 cost time: 1.1174111366271973
Epoch: 6, Steps: 52 | Train Loss: 0.4542956 Vali Loss: 1.4088433 Test Loss: 0.4054189
Validation loss decreased (1.424128 --> 1.408843).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 7 cost time: 1.542405128479004
Epoch: 7, Steps: 52 | Train Loss: 0.4445903 Vali Loss: 1.3816872 Test Loss: 0.3909331
Validation loss decreased (1.408843 --> 1.381687).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 8 cost time: 1.5432946681976318
Epoch: 8, Steps: 52 | Train Loss: 0.4399348 Vali Loss: 1.3778892 Test Loss: 0.3817356
Validation loss decreased (1.381687 --> 1.377889).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 9 cost time: 1.5555472373962402
Epoch: 9, Steps: 52 | Train Loss: 0.4354261 Vali Loss: 1.3768275 Test Loss: 0.3751891
Validation loss decreased (1.377889 --> 1.376827).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 10 cost time: 1.5440309047698975
Epoch: 10, Steps: 52 | Train Loss: 0.4306762 Vali Loss: 1.3630826 Test Loss: 0.3702070
Validation loss decreased (1.376827 --> 1.363083).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 11 cost time: 1.5542922019958496
Epoch: 11, Steps: 52 | Train Loss: 0.4272997 Vali Loss: 1.3527033 Test Loss: 0.3659976
Validation loss decreased (1.363083 --> 1.352703).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 12 cost time: 1.5408778190612793
Epoch: 12, Steps: 52 | Train Loss: 0.4254338 Vali Loss: 1.3433026 Test Loss: 0.3634984
Validation loss decreased (1.352703 --> 1.343303).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 13 cost time: 1.5539655685424805
Epoch: 13, Steps: 52 | Train Loss: 0.4236847 Vali Loss: 1.3523817 Test Loss: 0.3607735
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 14 cost time: 1.5462770462036133
Epoch: 14, Steps: 52 | Train Loss: 0.4199714 Vali Loss: 1.3457971 Test Loss: 0.3595788
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 15 cost time: 1.5490589141845703
Epoch: 15, Steps: 52 | Train Loss: 0.4199407 Vali Loss: 1.3425915 Test Loss: 0.3580595
Validation loss decreased (1.343303 --> 1.342592).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 16 cost time: 1.542816162109375
Epoch: 16, Steps: 52 | Train Loss: 0.4173678 Vali Loss: 1.3352029 Test Loss: 0.3569091
Validation loss decreased (1.342592 --> 1.335203).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 17 cost time: 1.5472705364227295
Epoch: 17, Steps: 52 | Train Loss: 0.4153598 Vali Loss: 1.3335948 Test Loss: 0.3560706
Validation loss decreased (1.335203 --> 1.333595).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 18 cost time: 1.5485544204711914
Epoch: 18, Steps: 52 | Train Loss: 0.4164654 Vali Loss: 1.3365841 Test Loss: 0.3554233
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 19 cost time: 1.5494976043701172
Epoch: 19, Steps: 52 | Train Loss: 0.4147336 Vali Loss: 1.3336023 Test Loss: 0.3549615
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 20 cost time: 1.5465853214263916
Epoch: 20, Steps: 52 | Train Loss: 0.4140252 Vali Loss: 1.3241186 Test Loss: 0.3544629
Validation loss decreased (1.333595 --> 1.324119).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 21 cost time: 1.5534532070159912
Epoch: 21, Steps: 52 | Train Loss: 0.4117259 Vali Loss: 1.3274045 Test Loss: 0.3537152
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 22 cost time: 1.5422847270965576
Epoch: 22, Steps: 52 | Train Loss: 0.4134419 Vali Loss: 1.3260596 Test Loss: 0.3535708
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 23 cost time: 1.5614242553710938
Epoch: 23, Steps: 52 | Train Loss: 0.4133041 Vali Loss: 1.3298630 Test Loss: 0.3527962
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 24 cost time: 1.5434818267822266
Epoch: 24, Steps: 52 | Train Loss: 0.4132852 Vali Loss: 1.3207291 Test Loss: 0.3521574
Validation loss decreased (1.324119 --> 1.320729).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 25 cost time: 1.5601263046264648
Epoch: 25, Steps: 52 | Train Loss: 0.4127124 Vali Loss: 1.3193663 Test Loss: 0.3522086
Validation loss decreased (1.320729 --> 1.319366).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 26 cost time: 1.5446810722351074
Epoch: 26, Steps: 52 | Train Loss: 0.4116707 Vali Loss: 1.3273883 Test Loss: 0.3523549
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 27 cost time: 1.5522074699401855
Epoch: 27, Steps: 52 | Train Loss: 0.4106925 Vali Loss: 1.3217733 Test Loss: 0.3522100
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 28 cost time: 1.5430629253387451
Epoch: 28, Steps: 52 | Train Loss: 0.4106340 Vali Loss: 1.3203384 Test Loss: 0.3519880
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 29 cost time: 1.5559954643249512
Epoch: 29, Steps: 52 | Train Loss: 0.4105957 Vali Loss: 1.3177040 Test Loss: 0.3521820
Validation loss decreased (1.319366 --> 1.317704).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 30 cost time: 1.5432665348052979
Epoch: 30, Steps: 52 | Train Loss: 0.4105888 Vali Loss: 1.3161232 Test Loss: 0.3511879
Validation loss decreased (1.317704 --> 1.316123).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 31 cost time: 1.5400056838989258
Epoch: 31, Steps: 52 | Train Loss: 0.4103257 Vali Loss: 1.3208430 Test Loss: 0.3511140
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 32 cost time: 1.5449316501617432
Epoch: 32, Steps: 52 | Train Loss: 0.4098601 Vali Loss: 1.3224611 Test Loss: 0.3510348
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 33 cost time: 1.539505958557129
Epoch: 33, Steps: 52 | Train Loss: 0.4090875 Vali Loss: 1.3193446 Test Loss: 0.3510817
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 34 cost time: 1.5498528480529785
Epoch: 34, Steps: 52 | Train Loss: 0.4087259 Vali Loss: 1.3156140 Test Loss: 0.3510941
Validation loss decreased (1.316123 --> 1.315614).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 35 cost time: 1.54107666015625
Epoch: 35, Steps: 52 | Train Loss: 0.4112081 Vali Loss: 1.3181312 Test Loss: 0.3512395
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 36 cost time: 1.5441429615020752
Epoch: 36, Steps: 52 | Train Loss: 0.4088091 Vali Loss: 1.3130004 Test Loss: 0.3506349
Validation loss decreased (1.315614 --> 1.313000).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 37 cost time: 1.537626028060913
Epoch: 37, Steps: 52 | Train Loss: 0.4088267 Vali Loss: 1.3180367 Test Loss: 0.3511941
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 38 cost time: 1.5432167053222656
Epoch: 38, Steps: 52 | Train Loss: 0.4084950 Vali Loss: 1.3169132 Test Loss: 0.3505710
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 39 cost time: 1.5386850833892822
Epoch: 39, Steps: 52 | Train Loss: 0.4074515 Vali Loss: 1.3135004 Test Loss: 0.3504492
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 40 cost time: 1.548621416091919
Epoch: 40, Steps: 52 | Train Loss: 0.4083438 Vali Loss: 1.3064296 Test Loss: 0.3508849
Validation loss decreased (1.313000 --> 1.306430).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 41 cost time: 1.5433969497680664
Epoch: 41, Steps: 52 | Train Loss: 0.4093869 Vali Loss: 1.3111322 Test Loss: 0.3503903
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 42 cost time: 1.5441553592681885
Epoch: 42, Steps: 52 | Train Loss: 0.4086407 Vali Loss: 1.3147957 Test Loss: 0.3508595
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 43 cost time: 1.5409741401672363
Epoch: 43, Steps: 52 | Train Loss: 0.4079084 Vali Loss: 1.3210640 Test Loss: 0.3505281
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 44 cost time: 1.5451664924621582
Epoch: 44, Steps: 52 | Train Loss: 0.4075846 Vali Loss: 1.3113292 Test Loss: 0.3504120
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 45 cost time: 1.542633295059204
Epoch: 45, Steps: 52 | Train Loss: 0.4088767 Vali Loss: 1.3137510 Test Loss: 0.3503774
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 46 cost time: 1.547372579574585
Epoch: 46, Steps: 52 | Train Loss: 0.4078430 Vali Loss: 1.3167586 Test Loss: 0.3502485
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 47 cost time: 1.5430493354797363
Epoch: 47, Steps: 52 | Train Loss: 0.4080856 Vali Loss: 1.3038999 Test Loss: 0.3499100
Validation loss decreased (1.306430 --> 1.303900).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 48 cost time: 1.54457688331604
Epoch: 48, Steps: 52 | Train Loss: 0.4081980 Vali Loss: 1.3199234 Test Loss: 0.3503626
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 49 cost time: 1.5395548343658447
Epoch: 49, Steps: 52 | Train Loss: 0.4086284 Vali Loss: 1.3195354 Test Loss: 0.3503578
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 50 cost time: 1.5405216217041016
Epoch: 50, Steps: 52 | Train Loss: 0.4074180 Vali Loss: 1.3191130 Test Loss: 0.3506214
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 51 cost time: 1.5444388389587402
Epoch: 51, Steps: 52 | Train Loss: 0.4069949 Vali Loss: 1.3163749 Test Loss: 0.3505901
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 52 cost time: 1.5489976406097412
Epoch: 52, Steps: 52 | Train Loss: 0.4081314 Vali Loss: 1.3196504 Test Loss: 0.3504177
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 53 cost time: 1.5333037376403809
Epoch: 53, Steps: 52 | Train Loss: 0.4078417 Vali Loss: 1.3109260 Test Loss: 0.3504702
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 54 cost time: 1.5457687377929688
Epoch: 54, Steps: 52 | Train Loss: 0.4074507 Vali Loss: 1.3216708 Test Loss: 0.3504304
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 55 cost time: 1.5471713542938232
Epoch: 55, Steps: 52 | Train Loss: 0.4076853 Vali Loss: 1.3138924 Test Loss: 0.3502324
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 56 cost time: 1.5445702075958252
Epoch: 56, Steps: 52 | Train Loss: 0.4103368 Vali Loss: 1.3148599 Test Loss: 0.3503379
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 57 cost time: 1.5483629703521729
Epoch: 57, Steps: 52 | Train Loss: 0.4083653 Vali Loss: 1.3217049 Test Loss: 0.3500417
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 58 cost time: 1.5470380783081055
Epoch: 58, Steps: 52 | Train Loss: 0.4069176 Vali Loss: 1.3031560 Test Loss: 0.3502086
Validation loss decreased (1.303900 --> 1.303156).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 59 cost time: 1.5421946048736572
Epoch: 59, Steps: 52 | Train Loss: 0.4078255 Vali Loss: 1.3213286 Test Loss: 0.3497449
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 60 cost time: 1.5427331924438477
Epoch: 60, Steps: 52 | Train Loss: 0.4070532 Vali Loss: 1.3105052 Test Loss: 0.3502319
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3502085208892822, mae:0.39569640159606934, rse:0.4848106801509857
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.0625157356262207 GB
Epoch: 1 cost time: 2.0872764587402344
Epoch: 1, Steps: 52 | Train Loss: 0.7077492 Vali Loss: 2.1394658 Test Loss: 1.3675678
Validation loss decreased (inf --> 2.139466).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 2 cost time: 0.7262506484985352
Epoch: 2, Steps: 52 | Train Loss: 0.5497944 Vali Loss: 1.4478061 Test Loss: 0.4769611
Validation loss decreased (2.139466 --> 1.447806).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 3 cost time: 0.7208042144775391
Epoch: 3, Steps: 52 | Train Loss: 0.4466120 Vali Loss: 1.3876798 Test Loss: 0.4132484
Validation loss decreased (1.447806 --> 1.387680).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 4 cost time: 0.7199997901916504
Epoch: 4, Steps: 52 | Train Loss: 0.4268981 Vali Loss: 1.3625178 Test Loss: 0.3901511
Validation loss decreased (1.387680 --> 1.362518).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 5 cost time: 0.7327272891998291
Epoch: 5, Steps: 52 | Train Loss: 0.4193878 Vali Loss: 1.3500216 Test Loss: 0.3792017
Validation loss decreased (1.362518 --> 1.350022).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 6 cost time: 1.4091770648956299
Epoch: 6, Steps: 52 | Train Loss: 0.4156722 Vali Loss: 1.3459263 Test Loss: 0.3724329
Validation loss decreased (1.350022 --> 1.345926).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 7 cost time: 1.6074779033660889
Epoch: 7, Steps: 52 | Train Loss: 0.4113264 Vali Loss: 1.3278826 Test Loss: 0.3679509
Validation loss decreased (1.345926 --> 1.327883).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 8 cost time: 1.6075048446655273
Epoch: 8, Steps: 52 | Train Loss: 0.4085123 Vali Loss: 1.3285413 Test Loss: 0.3646788
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 9 cost time: 1.6159429550170898
Epoch: 9, Steps: 52 | Train Loss: 0.4044190 Vali Loss: 1.3245522 Test Loss: 0.3620395
Validation loss decreased (1.327883 --> 1.324552).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 10 cost time: 1.6113324165344238
Epoch: 10, Steps: 52 | Train Loss: 0.4036052 Vali Loss: 1.3176936 Test Loss: 0.3604990
Validation loss decreased (1.324552 --> 1.317694).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 11 cost time: 1.615201711654663
Epoch: 11, Steps: 52 | Train Loss: 0.4036072 Vali Loss: 1.3150468 Test Loss: 0.3604158
Validation loss decreased (1.317694 --> 1.315047).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 12 cost time: 1.6161572933197021
Epoch: 12, Steps: 52 | Train Loss: 0.4017909 Vali Loss: 1.3139565 Test Loss: 0.3584907
Validation loss decreased (1.315047 --> 1.313956).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 13 cost time: 1.6180849075317383
Epoch: 13, Steps: 52 | Train Loss: 0.4002960 Vali Loss: 1.2953824 Test Loss: 0.3577399
Validation loss decreased (1.313956 --> 1.295382).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 14 cost time: 1.6141257286071777
Epoch: 14, Steps: 52 | Train Loss: 0.3993960 Vali Loss: 1.3043768 Test Loss: 0.3573747
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 15 cost time: 1.6174850463867188
Epoch: 15, Steps: 52 | Train Loss: 0.4006189 Vali Loss: 1.2992734 Test Loss: 0.3567310
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 16 cost time: 1.614135980606079
Epoch: 16, Steps: 52 | Train Loss: 0.3986173 Vali Loss: 1.3011178 Test Loss: 0.3561286
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 17 cost time: 1.620962381362915
Epoch: 17, Steps: 52 | Train Loss: 0.3980429 Vali Loss: 1.2932478 Test Loss: 0.3561572
Validation loss decreased (1.295382 --> 1.293248).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 18 cost time: 1.6160523891448975
Epoch: 18, Steps: 52 | Train Loss: 0.3978232 Vali Loss: 1.2888515 Test Loss: 0.3551475
Validation loss decreased (1.293248 --> 1.288851).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 19 cost time: 1.61674165725708
Epoch: 19, Steps: 52 | Train Loss: 0.3966548 Vali Loss: 1.2898192 Test Loss: 0.3559763
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 20 cost time: 1.6085686683654785
Epoch: 20, Steps: 52 | Train Loss: 0.3946539 Vali Loss: 1.3018074 Test Loss: 0.3555329
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 21 cost time: 1.6182384490966797
Epoch: 21, Steps: 52 | Train Loss: 0.3967198 Vali Loss: 1.2989821 Test Loss: 0.3551765
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 22 cost time: 1.6125335693359375
Epoch: 22, Steps: 52 | Train Loss: 0.3966618 Vali Loss: 1.2985847 Test Loss: 0.3550951
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 23 cost time: 1.6165409088134766
Epoch: 23, Steps: 52 | Train Loss: 0.3949689 Vali Loss: 1.2967659 Test Loss: 0.3551945
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 24 cost time: 1.6128926277160645
Epoch: 24, Steps: 52 | Train Loss: 0.3942866 Vali Loss: 1.2843293 Test Loss: 0.3548177
Validation loss decreased (1.288851 --> 1.284329).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 25 cost time: 1.6149022579193115
Epoch: 25, Steps: 52 | Train Loss: 0.3955210 Vali Loss: 1.2924426 Test Loss: 0.3548100
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 26 cost time: 1.6137418746948242
Epoch: 26, Steps: 52 | Train Loss: 0.3946403 Vali Loss: 1.2907021 Test Loss: 0.3546187
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 27 cost time: 1.6178596019744873
Epoch: 27, Steps: 52 | Train Loss: 0.3956685 Vali Loss: 1.2903128 Test Loss: 0.3546636
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 28 cost time: 1.6135070323944092
Epoch: 28, Steps: 52 | Train Loss: 0.3946145 Vali Loss: 1.2914671 Test Loss: 0.3546029
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 29 cost time: 1.6158843040466309
Epoch: 29, Steps: 52 | Train Loss: 0.3956289 Vali Loss: 1.2860278 Test Loss: 0.3547387
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 30 cost time: 1.615776538848877
Epoch: 30, Steps: 52 | Train Loss: 0.3939566 Vali Loss: 1.2926329 Test Loss: 0.3543662
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 31 cost time: 1.6170921325683594
Epoch: 31, Steps: 52 | Train Loss: 0.3945929 Vali Loss: 1.2883816 Test Loss: 0.3537865
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 32 cost time: 1.6149773597717285
Epoch: 32, Steps: 52 | Train Loss: 0.3944140 Vali Loss: 1.2954340 Test Loss: 0.3541507
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 33 cost time: 1.6184849739074707
Epoch: 33, Steps: 52 | Train Loss: 0.3949058 Vali Loss: 1.2937562 Test Loss: 0.3541383
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 34 cost time: 1.6127688884735107
Epoch: 34, Steps: 52 | Train Loss: 0.3930789 Vali Loss: 1.2973890 Test Loss: 0.3537791
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 35 cost time: 1.6140785217285156
Epoch: 35, Steps: 52 | Train Loss: 0.3951914 Vali Loss: 1.2913456 Test Loss: 0.3539237
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 36 cost time: 1.6083958148956299
Epoch: 36, Steps: 52 | Train Loss: 0.3949165 Vali Loss: 1.2907717 Test Loss: 0.3533864
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 37 cost time: 1.6158757209777832
Epoch: 37, Steps: 52 | Train Loss: 0.3919952 Vali Loss: 1.2880592 Test Loss: 0.3533231
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 38 cost time: 1.6134071350097656
Epoch: 38, Steps: 52 | Train Loss: 0.3939412 Vali Loss: 1.2934313 Test Loss: 0.3538030
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 39 cost time: 1.6082239151000977
Epoch: 39, Steps: 52 | Train Loss: 0.3936974 Vali Loss: 1.2879113 Test Loss: 0.3539586
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 40 cost time: 1.613321304321289
Epoch: 40, Steps: 52 | Train Loss: 0.3931157 Vali Loss: 1.2938106 Test Loss: 0.3534760
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 41 cost time: 1.610445499420166
Epoch: 41, Steps: 52 | Train Loss: 0.3941525 Vali Loss: 1.2911121 Test Loss: 0.3527109
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 42 cost time: 1.610384225845337
Epoch: 42, Steps: 52 | Train Loss: 0.3951106 Vali Loss: 1.2960449 Test Loss: 0.3541662
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 43 cost time: 1.6123294830322266
Epoch: 43, Steps: 52 | Train Loss: 0.3936080 Vali Loss: 1.2938094 Test Loss: 0.3536682
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 44 cost time: 1.6113648414611816
Epoch: 44, Steps: 52 | Train Loss: 0.3942508 Vali Loss: 1.2924463 Test Loss: 0.3537905
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 45 cost time: 1.6142630577087402
Epoch: 45, Steps: 52 | Train Loss: 0.3939405 Vali Loss: 1.2939082 Test Loss: 0.3533925
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 46 cost time: 1.6083216667175293
Epoch: 46, Steps: 52 | Train Loss: 0.3937742 Vali Loss: 1.2921214 Test Loss: 0.3532092
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 47 cost time: 1.6080644130706787
Epoch: 47, Steps: 52 | Train Loss: 0.3943711 Vali Loss: 1.2918493 Test Loss: 0.3538881
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 48 cost time: 1.6118509769439697
Epoch: 48, Steps: 52 | Train Loss: 0.3938325 Vali Loss: 1.2923923 Test Loss: 0.3536306
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 49 cost time: 1.6129934787750244
Epoch: 49, Steps: 52 | Train Loss: 0.3938762 Vali Loss: 1.2964003 Test Loss: 0.3544498
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 50 cost time: 1.6150016784667969
Epoch: 50, Steps: 52 | Train Loss: 0.3936718 Vali Loss: 1.2915968 Test Loss: 0.3539511
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 51 cost time: 1.6134917736053467
Epoch: 51, Steps: 52 | Train Loss: 0.3937752 Vali Loss: 1.2904272 Test Loss: 0.3541604
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 52 cost time: 1.6155340671539307
Epoch: 52, Steps: 52 | Train Loss: 0.3943707 Vali Loss: 1.2930669 Test Loss: 0.3542866
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 53 cost time: 1.6118450164794922
Epoch: 53, Steps: 52 | Train Loss: 0.3943410 Vali Loss: 1.2947516 Test Loss: 0.3539239
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 54 cost time: 1.6114978790283203
Epoch: 54, Steps: 52 | Train Loss: 0.3951816 Vali Loss: 1.2839123 Test Loss: 0.3530207
Validation loss decreased (1.284329 --> 1.283912).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 55 cost time: 1.6063663959503174
Epoch: 55, Steps: 52 | Train Loss: 0.3932676 Vali Loss: 1.2914963 Test Loss: 0.3545616
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 56 cost time: 1.604994773864746
Epoch: 56, Steps: 52 | Train Loss: 0.3927710 Vali Loss: 1.2878351 Test Loss: 0.3537606
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 57 cost time: 1.6086626052856445
Epoch: 57, Steps: 52 | Train Loss: 0.3919137 Vali Loss: 1.2892014 Test Loss: 0.3534209
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 58 cost time: 1.6175076961517334
Epoch: 58, Steps: 52 | Train Loss: 0.3920460 Vali Loss: 1.2897404 Test Loss: 0.3538821
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 59 cost time: 1.613473653793335
Epoch: 59, Steps: 52 | Train Loss: 0.3934429 Vali Loss: 1.2951243 Test Loss: 0.3532256
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 60 cost time: 1.6148266792297363
Epoch: 60, Steps: 52 | Train Loss: 0.3936228 Vali Loss: 1.2846857 Test Loss: 0.3537139
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3530207574367523, mae:0.4020105302333832, rse:0.48675328493118286
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06581449508666992 GB
Epoch: 1 cost time: 2.094161033630371
Epoch: 1, Steps: 52 | Train Loss: 0.6869203 Vali Loss: 2.1135464 Test Loss: 1.3604290
Validation loss decreased (inf --> 2.113546).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 2 cost time: 0.7540004253387451
Epoch: 2, Steps: 52 | Train Loss: 0.5351599 Vali Loss: 1.4261909 Test Loss: 0.4352327
Validation loss decreased (2.113546 --> 1.426191).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 3 cost time: 0.7559633255004883
Epoch: 3, Steps: 52 | Train Loss: 0.4355071 Vali Loss: 1.3730786 Test Loss: 0.3963904
Validation loss decreased (1.426191 --> 1.373079).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 4 cost time: 0.7514922618865967
Epoch: 4, Steps: 52 | Train Loss: 0.4203195 Vali Loss: 1.3504148 Test Loss: 0.3767145
Validation loss decreased (1.373079 --> 1.350415).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 5 cost time: 0.7588047981262207
Epoch: 5, Steps: 52 | Train Loss: 0.4129334 Vali Loss: 1.3334918 Test Loss: 0.3688692
Validation loss decreased (1.350415 --> 1.333492).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 6 cost time: 1.652862548828125
Epoch: 6, Steps: 52 | Train Loss: 0.4083893 Vali Loss: 1.3237288 Test Loss: 0.3634906
Validation loss decreased (1.333492 --> 1.323729).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 7 cost time: 1.6684470176696777
Epoch: 7, Steps: 52 | Train Loss: 0.4062393 Vali Loss: 1.3112609 Test Loss: 0.3610755
Validation loss decreased (1.323729 --> 1.311261).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 8 cost time: 1.6712207794189453
Epoch: 8, Steps: 52 | Train Loss: 0.4063262 Vali Loss: 1.3129966 Test Loss: 0.3589815
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 9 cost time: 1.6763994693756104
Epoch: 9, Steps: 52 | Train Loss: 0.4024554 Vali Loss: 1.3024478 Test Loss: 0.3573776
Validation loss decreased (1.311261 --> 1.302448).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 10 cost time: 1.6814332008361816
Epoch: 10, Steps: 52 | Train Loss: 0.4009306 Vali Loss: 1.3052595 Test Loss: 0.3564654
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 11 cost time: 1.6769986152648926
Epoch: 11, Steps: 52 | Train Loss: 0.4004112 Vali Loss: 1.2956955 Test Loss: 0.3559370
Validation loss decreased (1.302448 --> 1.295696).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 12 cost time: 1.6744892597198486
Epoch: 12, Steps: 52 | Train Loss: 0.3987788 Vali Loss: 1.2982152 Test Loss: 0.3558215
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 13 cost time: 1.6678824424743652
Epoch: 13, Steps: 52 | Train Loss: 0.3985036 Vali Loss: 1.2872708 Test Loss: 0.3543497
Validation loss decreased (1.295696 --> 1.287271).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 14 cost time: 1.672238826751709
Epoch: 14, Steps: 52 | Train Loss: 0.3990892 Vali Loss: 1.2940352 Test Loss: 0.3551412
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 15 cost time: 1.6736040115356445
Epoch: 15, Steps: 52 | Train Loss: 0.3970153 Vali Loss: 1.2908013 Test Loss: 0.3534837
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 16 cost time: 1.6757175922393799
Epoch: 16, Steps: 52 | Train Loss: 0.3964709 Vali Loss: 1.2923992 Test Loss: 0.3541549
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 17 cost time: 1.6683807373046875
Epoch: 17, Steps: 52 | Train Loss: 0.3950418 Vali Loss: 1.2914102 Test Loss: 0.3532948
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 18 cost time: 1.674168348312378
Epoch: 18, Steps: 52 | Train Loss: 0.3968210 Vali Loss: 1.2903447 Test Loss: 0.3544056
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 19 cost time: 1.6689963340759277
Epoch: 19, Steps: 52 | Train Loss: 0.3941155 Vali Loss: 1.2878902 Test Loss: 0.3536909
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 20 cost time: 1.6713666915893555
Epoch: 20, Steps: 52 | Train Loss: 0.3951861 Vali Loss: 1.2878392 Test Loss: 0.3530538
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 21 cost time: 1.6769938468933105
Epoch: 21, Steps: 52 | Train Loss: 0.3940008 Vali Loss: 1.2889611 Test Loss: 0.3518239
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 22 cost time: 1.6720147132873535
Epoch: 22, Steps: 52 | Train Loss: 0.3943853 Vali Loss: 1.2880142 Test Loss: 0.3515503
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 23 cost time: 1.6672775745391846
Epoch: 23, Steps: 52 | Train Loss: 0.3917275 Vali Loss: 1.2922604 Test Loss: 0.3520749
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 24 cost time: 1.6733789443969727
Epoch: 24, Steps: 52 | Train Loss: 0.3926219 Vali Loss: 1.2859888 Test Loss: 0.3520212
Validation loss decreased (1.287271 --> 1.285989).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 25 cost time: 1.6720631122589111
Epoch: 25, Steps: 52 | Train Loss: 0.3922902 Vali Loss: 1.2883995 Test Loss: 0.3518170
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 26 cost time: 1.6701321601867676
Epoch: 26, Steps: 52 | Train Loss: 0.3924362 Vali Loss: 1.2849464 Test Loss: 0.3517638
Validation loss decreased (1.285989 --> 1.284946).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 27 cost time: 1.679314374923706
Epoch: 27, Steps: 52 | Train Loss: 0.3936747 Vali Loss: 1.2872936 Test Loss: 0.3524753
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 28 cost time: 1.6732447147369385
Epoch: 28, Steps: 52 | Train Loss: 0.3945611 Vali Loss: 1.2804524 Test Loss: 0.3510179
Validation loss decreased (1.284946 --> 1.280452).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 29 cost time: 1.6740171909332275
Epoch: 29, Steps: 52 | Train Loss: 0.3919246 Vali Loss: 1.2916844 Test Loss: 0.3500993
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 30 cost time: 1.6722347736358643
Epoch: 30, Steps: 52 | Train Loss: 0.3932619 Vali Loss: 1.2878249 Test Loss: 0.3525296
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 31 cost time: 1.6789956092834473
Epoch: 31, Steps: 52 | Train Loss: 0.3918213 Vali Loss: 1.2745380 Test Loss: 0.3511753
Validation loss decreased (1.280452 --> 1.274538).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 32 cost time: 1.6746788024902344
Epoch: 32, Steps: 52 | Train Loss: 0.3924829 Vali Loss: 1.2825005 Test Loss: 0.3504530
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 33 cost time: 1.6735451221466064
Epoch: 33, Steps: 52 | Train Loss: 0.3925187 Vali Loss: 1.2801542 Test Loss: 0.3509587
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 34 cost time: 1.6709647178649902
Epoch: 34, Steps: 52 | Train Loss: 0.3932819 Vali Loss: 1.2854892 Test Loss: 0.3508630
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 35 cost time: 1.6809368133544922
Epoch: 35, Steps: 52 | Train Loss: 0.3926443 Vali Loss: 1.2885634 Test Loss: 0.3511367
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 36 cost time: 1.6770298480987549
Epoch: 36, Steps: 52 | Train Loss: 0.3913301 Vali Loss: 1.2860041 Test Loss: 0.3511608
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 37 cost time: 1.6742455959320068
Epoch: 37, Steps: 52 | Train Loss: 0.3919915 Vali Loss: 1.2831709 Test Loss: 0.3498159
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 38 cost time: 1.6714715957641602
Epoch: 38, Steps: 52 | Train Loss: 0.3927695 Vali Loss: 1.2886072 Test Loss: 0.3507202
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 39 cost time: 1.67946195602417
Epoch: 39, Steps: 52 | Train Loss: 0.3936263 Vali Loss: 1.2799566 Test Loss: 0.3508727
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 40 cost time: 1.6741247177124023
Epoch: 40, Steps: 52 | Train Loss: 0.3917362 Vali Loss: 1.2842950 Test Loss: 0.3507816
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 41 cost time: 1.6753485202789307
Epoch: 41, Steps: 52 | Train Loss: 0.3913219 Vali Loss: 1.2838094 Test Loss: 0.3502944
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 42 cost time: 1.6671645641326904
Epoch: 42, Steps: 52 | Train Loss: 0.3936682 Vali Loss: 1.2878090 Test Loss: 0.3509617
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 43 cost time: 1.675459861755371
Epoch: 43, Steps: 52 | Train Loss: 0.3921203 Vali Loss: 1.2672166 Test Loss: 0.3497649
Validation loss decreased (1.274538 --> 1.267217).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 44 cost time: 1.6689422130584717
Epoch: 44, Steps: 52 | Train Loss: 0.3910117 Vali Loss: 1.2799410 Test Loss: 0.3508431
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 45 cost time: 1.6703429222106934
Epoch: 45, Steps: 52 | Train Loss: 0.3919491 Vali Loss: 1.2810301 Test Loss: 0.3499493
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 46 cost time: 1.666001319885254
Epoch: 46, Steps: 52 | Train Loss: 0.3937332 Vali Loss: 1.2768230 Test Loss: 0.3512320
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 47 cost time: 1.6742384433746338
Epoch: 47, Steps: 52 | Train Loss: 0.3920190 Vali Loss: 1.2832921 Test Loss: 0.3500443
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 48 cost time: 1.67026686668396
Epoch: 48, Steps: 52 | Train Loss: 0.3931363 Vali Loss: 1.2857814 Test Loss: 0.3501564
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 49 cost time: 1.661400318145752
Epoch: 49, Steps: 52 | Train Loss: 0.3920436 Vali Loss: 1.2817690 Test Loss: 0.3493281
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 50 cost time: 1.6776962280273438
Epoch: 50, Steps: 52 | Train Loss: 0.3908355 Vali Loss: 1.2843256 Test Loss: 0.3494332
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 51 cost time: 1.6719794273376465
Epoch: 51, Steps: 52 | Train Loss: 0.3919807 Vali Loss: 1.2766345 Test Loss: 0.3497416
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 52 cost time: 1.6756765842437744
Epoch: 52, Steps: 52 | Train Loss: 0.3903673 Vali Loss: 1.2854356 Test Loss: 0.3501519
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 53 cost time: 1.674576997756958
Epoch: 53, Steps: 52 | Train Loss: 0.3914452 Vali Loss: 1.2832053 Test Loss: 0.3494621
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 54 cost time: 1.6700937747955322
Epoch: 54, Steps: 52 | Train Loss: 0.3914815 Vali Loss: 1.2819669 Test Loss: 0.3510887
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 55 cost time: 1.6694283485412598
Epoch: 55, Steps: 52 | Train Loss: 0.3932553 Vali Loss: 1.2873490 Test Loss: 0.3510769
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 56 cost time: 1.6758477687835693
Epoch: 56, Steps: 52 | Train Loss: 0.3917202 Vali Loss: 1.2793133 Test Loss: 0.3494909
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 57 cost time: 1.6722075939178467
Epoch: 57, Steps: 52 | Train Loss: 0.3926070 Vali Loss: 1.2824444 Test Loss: 0.3507853
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 58 cost time: 1.6739630699157715
Epoch: 58, Steps: 52 | Train Loss: 0.3916930 Vali Loss: 1.2849965 Test Loss: 0.3505330
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 59 cost time: 1.6687102317810059
Epoch: 59, Steps: 52 | Train Loss: 0.3935736 Vali Loss: 1.2774892 Test Loss: 0.3507806
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 60 cost time: 1.6755352020263672
Epoch: 60, Steps: 52 | Train Loss: 0.3922509 Vali Loss: 1.2836820 Test Loss: 0.3493669
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3497648239135742, mae:0.4009765684604645, rse:0.48450344800949097
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.058283329010009766 GB
Epoch: 1 cost time: 2.07247257232666
Epoch: 1, Steps: 52 | Train Loss: 0.7329915 Vali Loss: 2.1321125 Test Loss: 1.3539324
Validation loss decreased (inf --> 2.132113).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 2 cost time: 0.6986136436462402
Epoch: 2, Steps: 52 | Train Loss: 0.6591136 Vali Loss: 1.7553604 Test Loss: 0.9229100
Validation loss decreased (2.132113 --> 1.755360).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 3 cost time: 0.6992268562316895
Epoch: 3, Steps: 52 | Train Loss: 0.5534494 Vali Loss: 1.5450488 Test Loss: 0.6362948
Validation loss decreased (1.755360 --> 1.545049).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 4 cost time: 0.6967728137969971
Epoch: 4, Steps: 52 | Train Loss: 0.4898880 Vali Loss: 1.4348996 Test Loss: 0.4790184
Validation loss decreased (1.545049 --> 1.434900).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 5 cost time: 0.7019999027252197
Epoch: 5, Steps: 52 | Train Loss: 0.4587295 Vali Loss: 1.4010216 Test Loss: 0.4218304
Validation loss decreased (1.434900 --> 1.401022).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 6 cost time: 1.2056446075439453
Epoch: 6, Steps: 52 | Train Loss: 0.4459879 Vali Loss: 1.3794466 Test Loss: 0.3991813
Validation loss decreased (1.401022 --> 1.379447).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 7 cost time: 1.5708961486816406
Epoch: 7, Steps: 52 | Train Loss: 0.4364780 Vali Loss: 1.3663676 Test Loss: 0.3849652
Validation loss decreased (1.379447 --> 1.366368).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 8 cost time: 1.5649495124816895
Epoch: 8, Steps: 52 | Train Loss: 0.4337828 Vali Loss: 1.3592739 Test Loss: 0.3766507
Validation loss decreased (1.366368 --> 1.359274).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 9 cost time: 1.5691447257995605
Epoch: 9, Steps: 52 | Train Loss: 0.4289425 Vali Loss: 1.3491510 Test Loss: 0.3703206
Validation loss decreased (1.359274 --> 1.349151).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 10 cost time: 1.5653789043426514
Epoch: 10, Steps: 52 | Train Loss: 0.4251307 Vali Loss: 1.3448962 Test Loss: 0.3657357
Validation loss decreased (1.349151 --> 1.344896).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 11 cost time: 1.573012351989746
Epoch: 11, Steps: 52 | Train Loss: 0.4217367 Vali Loss: 1.3349035 Test Loss: 0.3619460
Validation loss decreased (1.344896 --> 1.334903).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 12 cost time: 1.5661661624908447
Epoch: 12, Steps: 52 | Train Loss: 0.4207880 Vali Loss: 1.3354771 Test Loss: 0.3592075
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 13 cost time: 1.5657613277435303
Epoch: 13, Steps: 52 | Train Loss: 0.4161334 Vali Loss: 1.3219702 Test Loss: 0.3573204
Validation loss decreased (1.334903 --> 1.321970).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 14 cost time: 1.565828800201416
Epoch: 14, Steps: 52 | Train Loss: 0.4160683 Vali Loss: 1.3256794 Test Loss: 0.3559455
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 15 cost time: 1.56614089012146
Epoch: 15, Steps: 52 | Train Loss: 0.4132726 Vali Loss: 1.3177271 Test Loss: 0.3544016
Validation loss decreased (1.321970 --> 1.317727).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 16 cost time: 1.5682361125946045
Epoch: 16, Steps: 52 | Train Loss: 0.4140131 Vali Loss: 1.3196089 Test Loss: 0.3532220
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 17 cost time: 1.5708293914794922
Epoch: 17, Steps: 52 | Train Loss: 0.4136996 Vali Loss: 1.3155525 Test Loss: 0.3527789
Validation loss decreased (1.317727 --> 1.315552).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 18 cost time: 1.567748785018921
Epoch: 18, Steps: 52 | Train Loss: 0.4110752 Vali Loss: 1.3177269 Test Loss: 0.3507881
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 19 cost time: 1.575505018234253
Epoch: 19, Steps: 52 | Train Loss: 0.4090667 Vali Loss: 1.3155885 Test Loss: 0.3505836
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 20 cost time: 1.565518856048584
Epoch: 20, Steps: 52 | Train Loss: 0.4096505 Vali Loss: 1.3067261 Test Loss: 0.3499562
Validation loss decreased (1.315552 --> 1.306726).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 21 cost time: 1.5814430713653564
Epoch: 21, Steps: 52 | Train Loss: 0.4087305 Vali Loss: 1.3016051 Test Loss: 0.3492760
Validation loss decreased (1.306726 --> 1.301605).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 22 cost time: 1.566575050354004
Epoch: 22, Steps: 52 | Train Loss: 0.4106875 Vali Loss: 1.3093437 Test Loss: 0.3486406
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 23 cost time: 1.5693800449371338
Epoch: 23, Steps: 52 | Train Loss: 0.4077121 Vali Loss: 1.3107961 Test Loss: 0.3482268
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 24 cost time: 1.5651423931121826
Epoch: 24, Steps: 52 | Train Loss: 0.4068562 Vali Loss: 1.3136064 Test Loss: 0.3481688
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 25 cost time: 1.5701231956481934
Epoch: 25, Steps: 52 | Train Loss: 0.4083000 Vali Loss: 1.3007112 Test Loss: 0.3481115
Validation loss decreased (1.301605 --> 1.300711).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 26 cost time: 1.56538724899292
Epoch: 26, Steps: 52 | Train Loss: 0.4080399 Vali Loss: 1.3043218 Test Loss: 0.3483018
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 27 cost time: 1.569455623626709
Epoch: 27, Steps: 52 | Train Loss: 0.4076051 Vali Loss: 1.3094722 Test Loss: 0.3483136
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 28 cost time: 1.567202091217041
Epoch: 28, Steps: 52 | Train Loss: 0.4072884 Vali Loss: 1.3043909 Test Loss: 0.3469394
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 29 cost time: 1.5828239917755127
Epoch: 29, Steps: 52 | Train Loss: 0.4070345 Vali Loss: 1.3080940 Test Loss: 0.3472195
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 30 cost time: 1.581193447113037
Epoch: 30, Steps: 52 | Train Loss: 0.4078381 Vali Loss: 1.3089603 Test Loss: 0.3466733
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 31 cost time: 1.5713262557983398
Epoch: 31, Steps: 52 | Train Loss: 0.4051558 Vali Loss: 1.3058648 Test Loss: 0.3466571
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 32 cost time: 1.5669384002685547
Epoch: 32, Steps: 52 | Train Loss: 0.4059272 Vali Loss: 1.3093622 Test Loss: 0.3466267
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 33 cost time: 1.5678324699401855
Epoch: 33, Steps: 52 | Train Loss: 0.4058374 Vali Loss: 1.3025472 Test Loss: 0.3468218
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 34 cost time: 1.5632734298706055
Epoch: 34, Steps: 52 | Train Loss: 0.4054504 Vali Loss: 1.3063376 Test Loss: 0.3458082
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 35 cost time: 1.562197208404541
Epoch: 35, Steps: 52 | Train Loss: 0.4065056 Vali Loss: 1.3078541 Test Loss: 0.3463070
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 36 cost time: 1.5605430603027344
Epoch: 36, Steps: 52 | Train Loss: 0.4058546 Vali Loss: 1.3074116 Test Loss: 0.3456326
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 37 cost time: 1.5651297569274902
Epoch: 37, Steps: 52 | Train Loss: 0.4059688 Vali Loss: 1.3041515 Test Loss: 0.3455265
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 38 cost time: 1.55845046043396
Epoch: 38, Steps: 52 | Train Loss: 0.4062112 Vali Loss: 1.3074242 Test Loss: 0.3460256
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 39 cost time: 1.564720869064331
Epoch: 39, Steps: 52 | Train Loss: 0.4043966 Vali Loss: 1.3030702 Test Loss: 0.3455616
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 40 cost time: 1.5656702518463135
Epoch: 40, Steps: 52 | Train Loss: 0.4047052 Vali Loss: 1.3002346 Test Loss: 0.3455821
Validation loss decreased (1.300711 --> 1.300235).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 41 cost time: 1.56516432762146
Epoch: 41, Steps: 52 | Train Loss: 0.4057351 Vali Loss: 1.2954478 Test Loss: 0.3456603
Validation loss decreased (1.300235 --> 1.295448).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 42 cost time: 1.5743563175201416
Epoch: 42, Steps: 52 | Train Loss: 0.4066370 Vali Loss: 1.3077015 Test Loss: 0.3455973
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 43 cost time: 1.5618715286254883
Epoch: 43, Steps: 52 | Train Loss: 0.4043679 Vali Loss: 1.2980520 Test Loss: 0.3457561
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 44 cost time: 1.5730369091033936
Epoch: 44, Steps: 52 | Train Loss: 0.4042022 Vali Loss: 1.3072851 Test Loss: 0.3449489
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 45 cost time: 1.564255952835083
Epoch: 45, Steps: 52 | Train Loss: 0.4049890 Vali Loss: 1.2923706 Test Loss: 0.3453046
Validation loss decreased (1.295448 --> 1.292371).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 46 cost time: 1.5735971927642822
Epoch: 46, Steps: 52 | Train Loss: 0.4054146 Vali Loss: 1.3043170 Test Loss: 0.3451535
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 47 cost time: 1.5645191669464111
Epoch: 47, Steps: 52 | Train Loss: 0.4049696 Vali Loss: 1.3041232 Test Loss: 0.3458477
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 48 cost time: 1.5670084953308105
Epoch: 48, Steps: 52 | Train Loss: 0.4058533 Vali Loss: 1.3003945 Test Loss: 0.3456784
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 49 cost time: 1.566511631011963
Epoch: 49, Steps: 52 | Train Loss: 0.4058691 Vali Loss: 1.2950928 Test Loss: 0.3457051
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 50 cost time: 1.570516586303711
Epoch: 50, Steps: 52 | Train Loss: 0.4048300 Vali Loss: 1.3055316 Test Loss: 0.3463548
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 51 cost time: 1.5768253803253174
Epoch: 51, Steps: 52 | Train Loss: 0.4034454 Vali Loss: 1.3026733 Test Loss: 0.3449842
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 52 cost time: 1.5718252658843994
Epoch: 52, Steps: 52 | Train Loss: 0.4048214 Vali Loss: 1.3010278 Test Loss: 0.3456553
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 53 cost time: 1.576526403427124
Epoch: 53, Steps: 52 | Train Loss: 0.4030117 Vali Loss: 1.3069956 Test Loss: 0.3453659
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 54 cost time: 1.5710198879241943
Epoch: 54, Steps: 52 | Train Loss: 0.4045811 Vali Loss: 1.3058143 Test Loss: 0.3454956
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 55 cost time: 1.5674116611480713
Epoch: 55, Steps: 52 | Train Loss: 0.4047813 Vali Loss: 1.3007119 Test Loss: 0.3449441
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 56 cost time: 1.5704946517944336
Epoch: 56, Steps: 52 | Train Loss: 0.4034904 Vali Loss: 1.3034673 Test Loss: 0.3454232
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 57 cost time: 1.5654287338256836
Epoch: 57, Steps: 52 | Train Loss: 0.4039727 Vali Loss: 1.3026581 Test Loss: 0.3455990
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 58 cost time: 1.5723834037780762
Epoch: 58, Steps: 52 | Train Loss: 0.4049046 Vali Loss: 1.3031651 Test Loss: 0.3451042
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 59 cost time: 1.563753604888916
Epoch: 59, Steps: 52 | Train Loss: 0.4049358 Vali Loss: 1.2988225 Test Loss: 0.3452317
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 60 cost time: 1.5661449432373047
Epoch: 60, Steps: 52 | Train Loss: 0.4041043 Vali Loss: 1.3052132 Test Loss: 0.3449683
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34530457854270935, mae:0.3934295177459717, rse:0.48140427470207214
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06267786026000977 GB
Epoch: 1 cost time: 2.1482279300689697
Epoch: 1, Steps: 52 | Train Loss: 0.6897223 Vali Loss: 2.0740590 Test Loss: 1.3242102
Validation loss decreased (inf --> 2.074059).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 2 cost time: 0.7227706909179688
Epoch: 2, Steps: 52 | Train Loss: 0.5531692 Vali Loss: 1.4468392 Test Loss: 0.4786533
Validation loss decreased (2.074059 --> 1.446839).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 3 cost time: 0.749436616897583
Epoch: 3, Steps: 52 | Train Loss: 0.4450042 Vali Loss: 1.3799109 Test Loss: 0.3961460
Validation loss decreased (1.446839 --> 1.379911).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 4 cost time: 0.7219517230987549
Epoch: 4, Steps: 52 | Train Loss: 0.4249764 Vali Loss: 1.3533421 Test Loss: 0.3804215
Validation loss decreased (1.379911 --> 1.353342).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 5 cost time: 0.7403383255004883
Epoch: 5, Steps: 52 | Train Loss: 0.4184165 Vali Loss: 1.3521378 Test Loss: 0.3724954
Validation loss decreased (1.353342 --> 1.352138).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 6 cost time: 1.5906128883361816
Epoch: 6, Steps: 52 | Train Loss: 0.4116138 Vali Loss: 1.3308647 Test Loss: 0.3672354
Validation loss decreased (1.352138 --> 1.330865).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 7 cost time: 1.619455099105835
Epoch: 7, Steps: 52 | Train Loss: 0.4100156 Vali Loss: 1.3306143 Test Loss: 0.3637510
Validation loss decreased (1.330865 --> 1.330614).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 8 cost time: 1.6268830299377441
Epoch: 8, Steps: 52 | Train Loss: 0.4065509 Vali Loss: 1.3188136 Test Loss: 0.3617490
Validation loss decreased (1.330614 --> 1.318814).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 9 cost time: 1.6291487216949463
Epoch: 9, Steps: 52 | Train Loss: 0.4068334 Vali Loss: 1.3155588 Test Loss: 0.3595861
Validation loss decreased (1.318814 --> 1.315559).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 10 cost time: 1.634782075881958
Epoch: 10, Steps: 52 | Train Loss: 0.4037227 Vali Loss: 1.3096895 Test Loss: 0.3599318
Validation loss decreased (1.315559 --> 1.309690).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 11 cost time: 1.6295549869537354
Epoch: 11, Steps: 52 | Train Loss: 0.4007453 Vali Loss: 1.3055158 Test Loss: 0.3589807
Validation loss decreased (1.309690 --> 1.305516).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 12 cost time: 1.628375768661499
Epoch: 12, Steps: 52 | Train Loss: 0.4020685 Vali Loss: 1.3022614 Test Loss: 0.3591219
Validation loss decreased (1.305516 --> 1.302261).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 13 cost time: 1.6299526691436768
Epoch: 13, Steps: 52 | Train Loss: 0.3998118 Vali Loss: 1.3032099 Test Loss: 0.3592843
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 14 cost time: 1.630352258682251
Epoch: 14, Steps: 52 | Train Loss: 0.3992866 Vali Loss: 1.3003697 Test Loss: 0.3598434
Validation loss decreased (1.302261 --> 1.300370).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 15 cost time: 1.6323719024658203
Epoch: 15, Steps: 52 | Train Loss: 0.4002321 Vali Loss: 1.3027647 Test Loss: 0.3586510
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 16 cost time: 1.629338264465332
Epoch: 16, Steps: 52 | Train Loss: 0.3987648 Vali Loss: 1.2974633 Test Loss: 0.3597187
Validation loss decreased (1.300370 --> 1.297463).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 17 cost time: 1.630507230758667
Epoch: 17, Steps: 52 | Train Loss: 0.3995661 Vali Loss: 1.2959183 Test Loss: 0.3583104
Validation loss decreased (1.297463 --> 1.295918).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 18 cost time: 1.6311461925506592
Epoch: 18, Steps: 52 | Train Loss: 0.3983071 Vali Loss: 1.3025085 Test Loss: 0.3594280
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 19 cost time: 1.6184816360473633
Epoch: 19, Steps: 52 | Train Loss: 0.3981837 Vali Loss: 1.2996994 Test Loss: 0.3588722
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 20 cost time: 1.627225637435913
Epoch: 20, Steps: 52 | Train Loss: 0.3972467 Vali Loss: 1.2970347 Test Loss: 0.3587716
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 21 cost time: 1.6288392543792725
Epoch: 21, Steps: 52 | Train Loss: 0.3986005 Vali Loss: 1.2916156 Test Loss: 0.3589874
Validation loss decreased (1.295918 --> 1.291616).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 22 cost time: 1.6306891441345215
Epoch: 22, Steps: 52 | Train Loss: 0.3969167 Vali Loss: 1.2891462 Test Loss: 0.3596122
Validation loss decreased (1.291616 --> 1.289146).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 23 cost time: 1.6292979717254639
Epoch: 23, Steps: 52 | Train Loss: 0.3970268 Vali Loss: 1.2961688 Test Loss: 0.3598181
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 24 cost time: 1.6347131729125977
Epoch: 24, Steps: 52 | Train Loss: 0.3962987 Vali Loss: 1.2954948 Test Loss: 0.3591431
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 25 cost time: 1.6297836303710938
Epoch: 25, Steps: 52 | Train Loss: 0.3946850 Vali Loss: 1.2920783 Test Loss: 0.3594266
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 26 cost time: 1.6322875022888184
Epoch: 26, Steps: 52 | Train Loss: 0.3965277 Vali Loss: 1.2963212 Test Loss: 0.3602467
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 27 cost time: 1.6252598762512207
Epoch: 27, Steps: 52 | Train Loss: 0.3966417 Vali Loss: 1.2853513 Test Loss: 0.3588810
Validation loss decreased (1.289146 --> 1.285351).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 28 cost time: 1.6288185119628906
Epoch: 28, Steps: 52 | Train Loss: 0.3955881 Vali Loss: 1.2995253 Test Loss: 0.3583824
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 29 cost time: 1.6278438568115234
Epoch: 29, Steps: 52 | Train Loss: 0.3952120 Vali Loss: 1.2952991 Test Loss: 0.3591888
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 30 cost time: 1.6271693706512451
Epoch: 30, Steps: 52 | Train Loss: 0.3962041 Vali Loss: 1.2905920 Test Loss: 0.3595167
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 31 cost time: 1.624131679534912
Epoch: 31, Steps: 52 | Train Loss: 0.3947995 Vali Loss: 1.2972478 Test Loss: 0.3589503
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 32 cost time: 1.6334953308105469
Epoch: 32, Steps: 52 | Train Loss: 0.3955614 Vali Loss: 1.2909484 Test Loss: 0.3595787
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 33 cost time: 1.6282105445861816
Epoch: 33, Steps: 52 | Train Loss: 0.3954914 Vali Loss: 1.2875546 Test Loss: 0.3588288
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 34 cost time: 1.6292104721069336
Epoch: 34, Steps: 52 | Train Loss: 0.3962872 Vali Loss: 1.2955372 Test Loss: 0.3586346
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 35 cost time: 1.6268377304077148
Epoch: 35, Steps: 52 | Train Loss: 0.3951179 Vali Loss: 1.2991828 Test Loss: 0.3591041
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 36 cost time: 1.627450942993164
Epoch: 36, Steps: 52 | Train Loss: 0.3942503 Vali Loss: 1.2951550 Test Loss: 0.3591398
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 37 cost time: 1.624868392944336
Epoch: 37, Steps: 52 | Train Loss: 0.3936111 Vali Loss: 1.2916083 Test Loss: 0.3586523
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 38 cost time: 1.6285393238067627
Epoch: 38, Steps: 52 | Train Loss: 0.3946741 Vali Loss: 1.2979382 Test Loss: 0.3599006
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 39 cost time: 1.6269662380218506
Epoch: 39, Steps: 52 | Train Loss: 0.3948439 Vali Loss: 1.2912078 Test Loss: 0.3579841
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 40 cost time: 1.632070541381836
Epoch: 40, Steps: 52 | Train Loss: 0.3958679 Vali Loss: 1.2887254 Test Loss: 0.3594917
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 41 cost time: 1.6281647682189941
Epoch: 41, Steps: 52 | Train Loss: 0.3947395 Vali Loss: 1.2948203 Test Loss: 0.3589786
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 42 cost time: 1.6255900859832764
Epoch: 42, Steps: 52 | Train Loss: 0.3950533 Vali Loss: 1.2913439 Test Loss: 0.3587712
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 43 cost time: 1.6253387928009033
Epoch: 43, Steps: 52 | Train Loss: 0.3943056 Vali Loss: 1.2990463 Test Loss: 0.3590189
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 44 cost time: 1.627004861831665
Epoch: 44, Steps: 52 | Train Loss: 0.3941985 Vali Loss: 1.2856320 Test Loss: 0.3592647
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 45 cost time: 1.6234657764434814
Epoch: 45, Steps: 52 | Train Loss: 0.3944965 Vali Loss: 1.2981479 Test Loss: 0.3585213
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 46 cost time: 1.630422830581665
Epoch: 46, Steps: 52 | Train Loss: 0.3942900 Vali Loss: 1.2914916 Test Loss: 0.3591453
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 47 cost time: 1.6280536651611328
Epoch: 47, Steps: 52 | Train Loss: 0.3943572 Vali Loss: 1.2949685 Test Loss: 0.3574165
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 48 cost time: 1.6298577785491943
Epoch: 48, Steps: 52 | Train Loss: 0.3937814 Vali Loss: 1.2929456 Test Loss: 0.3586603
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 49 cost time: 1.6254360675811768
Epoch: 49, Steps: 52 | Train Loss: 0.3933395 Vali Loss: 1.2981269 Test Loss: 0.3575847
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 50 cost time: 1.6294622421264648
Epoch: 50, Steps: 52 | Train Loss: 0.3929379 Vali Loss: 1.2894375 Test Loss: 0.3587747
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 51 cost time: 1.627589464187622
Epoch: 51, Steps: 52 | Train Loss: 0.3946354 Vali Loss: 1.2980962 Test Loss: 0.3587750
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 52 cost time: 1.6304421424865723
Epoch: 52, Steps: 52 | Train Loss: 0.3945605 Vali Loss: 1.2991083 Test Loss: 0.3585855
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 53 cost time: 1.6229228973388672
Epoch: 53, Steps: 52 | Train Loss: 0.3949818 Vali Loss: 1.2977331 Test Loss: 0.3592119
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 54 cost time: 1.6238858699798584
Epoch: 54, Steps: 52 | Train Loss: 0.3945429 Vali Loss: 1.2941587 Test Loss: 0.3590910
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 55 cost time: 1.6250672340393066
Epoch: 55, Steps: 52 | Train Loss: 0.3945006 Vali Loss: 1.2960969 Test Loss: 0.3590169
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 56 cost time: 1.6298556327819824
Epoch: 56, Steps: 52 | Train Loss: 0.3950034 Vali Loss: 1.2923605 Test Loss: 0.3588092
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 57 cost time: 1.625260829925537
Epoch: 57, Steps: 52 | Train Loss: 0.3946764 Vali Loss: 1.2946100 Test Loss: 0.3582110
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 58 cost time: 1.627166748046875
Epoch: 58, Steps: 52 | Train Loss: 0.3953421 Vali Loss: 1.2941308 Test Loss: 0.3596188
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 59 cost time: 1.6292872428894043
Epoch: 59, Steps: 52 | Train Loss: 0.3934751 Vali Loss: 1.2875403 Test Loss: 0.3584407
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 60 cost time: 1.6299176216125488
Epoch: 60, Steps: 52 | Train Loss: 0.3922698 Vali Loss: 1.2947783 Test Loss: 0.3574285
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35888099670410156, mae:0.4102034866809845, rse:0.49077683687210083
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06597661972045898 GB
Epoch: 1 cost time: 2.127471446990967
Epoch: 1, Steps: 52 | Train Loss: 0.6910886 Vali Loss: 2.1247344 Test Loss: 1.3553637
Validation loss decreased (inf --> 2.124734).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 2 cost time: 0.7726168632507324
Epoch: 2, Steps: 52 | Train Loss: 0.5495420 Vali Loss: 1.4385021 Test Loss: 0.4481314
Validation loss decreased (2.124734 --> 1.438502).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 3 cost time: 0.7610859870910645
Epoch: 3, Steps: 52 | Train Loss: 0.4389382 Vali Loss: 1.3773488 Test Loss: 0.3946991
Validation loss decreased (1.438502 --> 1.377349).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 4 cost time: 0.7487454414367676
Epoch: 4, Steps: 52 | Train Loss: 0.4228154 Vali Loss: 1.3543930 Test Loss: 0.3717567
Validation loss decreased (1.377349 --> 1.354393).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 5 cost time: 0.7760000228881836
Epoch: 5, Steps: 52 | Train Loss: 0.4157611 Vali Loss: 1.3445632 Test Loss: 0.3642760
Validation loss decreased (1.354393 --> 1.344563).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 6 cost time: 1.659865140914917
Epoch: 6, Steps: 52 | Train Loss: 0.4128534 Vali Loss: 1.3357201 Test Loss: 0.3593600
Validation loss decreased (1.344563 --> 1.335720).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 7 cost time: 1.6694140434265137
Epoch: 7, Steps: 52 | Train Loss: 0.4069352 Vali Loss: 1.3242955 Test Loss: 0.3569241
Validation loss decreased (1.335720 --> 1.324296).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 8 cost time: 1.675124168395996
Epoch: 8, Steps: 52 | Train Loss: 0.4053963 Vali Loss: 1.3177192 Test Loss: 0.3569625
Validation loss decreased (1.324296 --> 1.317719).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 9 cost time: 1.677682638168335
Epoch: 9, Steps: 52 | Train Loss: 0.4017187 Vali Loss: 1.3165188 Test Loss: 0.3541603
Validation loss decreased (1.317719 --> 1.316519).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 10 cost time: 1.6798887252807617
Epoch: 10, Steps: 52 | Train Loss: 0.4020141 Vali Loss: 1.3071382 Test Loss: 0.3535696
Validation loss decreased (1.316519 --> 1.307138).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 11 cost time: 1.676966667175293
Epoch: 11, Steps: 52 | Train Loss: 0.4008959 Vali Loss: 1.3056898 Test Loss: 0.3541016
Validation loss decreased (1.307138 --> 1.305690).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 12 cost time: 1.6879246234893799
Epoch: 12, Steps: 52 | Train Loss: 0.3991595 Vali Loss: 1.3048905 Test Loss: 0.3530337
Validation loss decreased (1.305690 --> 1.304891).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 13 cost time: 1.6777632236480713
Epoch: 13, Steps: 52 | Train Loss: 0.3989751 Vali Loss: 1.3047483 Test Loss: 0.3530532
Validation loss decreased (1.304891 --> 1.304748).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 14 cost time: 1.6815648078918457
Epoch: 14, Steps: 52 | Train Loss: 0.3980879 Vali Loss: 1.2994721 Test Loss: 0.3533464
Validation loss decreased (1.304748 --> 1.299472).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 15 cost time: 1.6804990768432617
Epoch: 15, Steps: 52 | Train Loss: 0.3968823 Vali Loss: 1.3023446 Test Loss: 0.3520476
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 16 cost time: 1.6890888214111328
Epoch: 16, Steps: 52 | Train Loss: 0.3956758 Vali Loss: 1.2921175 Test Loss: 0.3521810
Validation loss decreased (1.299472 --> 1.292117).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 17 cost time: 1.6816093921661377
Epoch: 17, Steps: 52 | Train Loss: 0.3962583 Vali Loss: 1.2935004 Test Loss: 0.3503262
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 18 cost time: 1.6839983463287354
Epoch: 18, Steps: 52 | Train Loss: 0.3948009 Vali Loss: 1.2935258 Test Loss: 0.3507361
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 19 cost time: 1.6736953258514404
Epoch: 19, Steps: 52 | Train Loss: 0.3959854 Vali Loss: 1.2957841 Test Loss: 0.3503593
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 20 cost time: 1.674133062362671
Epoch: 20, Steps: 52 | Train Loss: 0.3938672 Vali Loss: 1.2971901 Test Loss: 0.3510063
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 21 cost time: 1.6803007125854492
Epoch: 21, Steps: 52 | Train Loss: 0.3935723 Vali Loss: 1.2915771 Test Loss: 0.3498983
Validation loss decreased (1.292117 --> 1.291577).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 22 cost time: 1.6766841411590576
Epoch: 22, Steps: 52 | Train Loss: 0.3952340 Vali Loss: 1.2909379 Test Loss: 0.3510419
Validation loss decreased (1.291577 --> 1.290938).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 23 cost time: 1.6835503578186035
Epoch: 23, Steps: 52 | Train Loss: 0.3925466 Vali Loss: 1.2950783 Test Loss: 0.3507105
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 24 cost time: 1.673403024673462
Epoch: 24, Steps: 52 | Train Loss: 0.3932282 Vali Loss: 1.2907801 Test Loss: 0.3491808
Validation loss decreased (1.290938 --> 1.290780).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 25 cost time: 1.6810452938079834
Epoch: 25, Steps: 52 | Train Loss: 0.3922356 Vali Loss: 1.2937641 Test Loss: 0.3508224
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 26 cost time: 1.6806299686431885
Epoch: 26, Steps: 52 | Train Loss: 0.3922163 Vali Loss: 1.2937388 Test Loss: 0.3501770
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 27 cost time: 1.685239553451538
Epoch: 27, Steps: 52 | Train Loss: 0.3920193 Vali Loss: 1.2912688 Test Loss: 0.3493397
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 28 cost time: 1.6797256469726562
Epoch: 28, Steps: 52 | Train Loss: 0.3926737 Vali Loss: 1.2945800 Test Loss: 0.3491888
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 29 cost time: 1.6854186058044434
Epoch: 29, Steps: 52 | Train Loss: 0.3930603 Vali Loss: 1.2924927 Test Loss: 0.3492942
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 30 cost time: 1.6791934967041016
Epoch: 30, Steps: 52 | Train Loss: 0.3931724 Vali Loss: 1.2916104 Test Loss: 0.3494518
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 31 cost time: 1.6821374893188477
Epoch: 31, Steps: 52 | Train Loss: 0.3929050 Vali Loss: 1.2969015 Test Loss: 0.3484494
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 32 cost time: 1.6827917098999023
Epoch: 32, Steps: 52 | Train Loss: 0.3926149 Vali Loss: 1.2911968 Test Loss: 0.3493853
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 33 cost time: 1.688711166381836
Epoch: 33, Steps: 52 | Train Loss: 0.3925967 Vali Loss: 1.2922456 Test Loss: 0.3490735
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 34 cost time: 1.6785118579864502
Epoch: 34, Steps: 52 | Train Loss: 0.3934639 Vali Loss: 1.2855599 Test Loss: 0.3493905
Validation loss decreased (1.290780 --> 1.285560).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 35 cost time: 1.6752336025238037
Epoch: 35, Steps: 52 | Train Loss: 0.3922275 Vali Loss: 1.2880304 Test Loss: 0.3499274
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 36 cost time: 1.6829297542572021
Epoch: 36, Steps: 52 | Train Loss: 0.3938272 Vali Loss: 1.2886715 Test Loss: 0.3497812
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 37 cost time: 1.6873571872711182
Epoch: 37, Steps: 52 | Train Loss: 0.3923162 Vali Loss: 1.2895775 Test Loss: 0.3488229
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 38 cost time: 1.680952548980713
Epoch: 38, Steps: 52 | Train Loss: 0.3911187 Vali Loss: 1.2913603 Test Loss: 0.3492965
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 39 cost time: 1.677515983581543
Epoch: 39, Steps: 52 | Train Loss: 0.3924601 Vali Loss: 1.2888536 Test Loss: 0.3485153
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 40 cost time: 1.6787593364715576
Epoch: 40, Steps: 52 | Train Loss: 0.3912091 Vali Loss: 1.2847205 Test Loss: 0.3491899
Validation loss decreased (1.285560 --> 1.284721).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 41 cost time: 1.6826226711273193
Epoch: 41, Steps: 52 | Train Loss: 0.3917139 Vali Loss: 1.2896107 Test Loss: 0.3493164
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 42 cost time: 1.675428867340088
Epoch: 42, Steps: 52 | Train Loss: 0.3931930 Vali Loss: 1.2807856 Test Loss: 0.3481731
Validation loss decreased (1.284721 --> 1.280786).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 43 cost time: 1.6778130531311035
Epoch: 43, Steps: 52 | Train Loss: 0.3918896 Vali Loss: 1.2863038 Test Loss: 0.3490832
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 44 cost time: 1.670811414718628
Epoch: 44, Steps: 52 | Train Loss: 0.3912300 Vali Loss: 1.2876720 Test Loss: 0.3494479
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 45 cost time: 1.682356834411621
Epoch: 45, Steps: 52 | Train Loss: 0.3908967 Vali Loss: 1.2896712 Test Loss: 0.3485646
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 46 cost time: 1.6786246299743652
Epoch: 46, Steps: 52 | Train Loss: 0.3931858 Vali Loss: 1.2927868 Test Loss: 0.3480912
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 47 cost time: 1.6810493469238281
Epoch: 47, Steps: 52 | Train Loss: 0.3908711 Vali Loss: 1.2925310 Test Loss: 0.3484863
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 48 cost time: 1.67622971534729
Epoch: 48, Steps: 52 | Train Loss: 0.3922699 Vali Loss: 1.2854009 Test Loss: 0.3484399
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 49 cost time: 1.673370361328125
Epoch: 49, Steps: 52 | Train Loss: 0.3929578 Vali Loss: 1.2877555 Test Loss: 0.3489013
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 50 cost time: 1.6825010776519775
Epoch: 50, Steps: 52 | Train Loss: 0.3924214 Vali Loss: 1.2847908 Test Loss: 0.3489647
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 51 cost time: 1.682450771331787
Epoch: 51, Steps: 52 | Train Loss: 0.3915880 Vali Loss: 1.2860954 Test Loss: 0.3488430
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 52 cost time: 1.6849017143249512
Epoch: 52, Steps: 52 | Train Loss: 0.3932461 Vali Loss: 1.2964971 Test Loss: 0.3487986
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 53 cost time: 1.6771025657653809
Epoch: 53, Steps: 52 | Train Loss: 0.3923841 Vali Loss: 1.2941613 Test Loss: 0.3483803
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 54 cost time: 1.6841909885406494
Epoch: 54, Steps: 52 | Train Loss: 0.3919770 Vali Loss: 1.2869658 Test Loss: 0.3489685
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 55 cost time: 1.681638479232788
Epoch: 55, Steps: 52 | Train Loss: 0.3927116 Vali Loss: 1.2939155 Test Loss: 0.3493145
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 56 cost time: 1.6842875480651855
Epoch: 56, Steps: 52 | Train Loss: 0.3922181 Vali Loss: 1.2912588 Test Loss: 0.3483916
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 57 cost time: 1.6815271377563477
Epoch: 57, Steps: 52 | Train Loss: 0.3925926 Vali Loss: 1.2888758 Test Loss: 0.3485719
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 58 cost time: 1.6805577278137207
Epoch: 58, Steps: 52 | Train Loss: 0.3930992 Vali Loss: 1.2929912 Test Loss: 0.3492910
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 59 cost time: 1.6793696880340576
Epoch: 59, Steps: 52 | Train Loss: 0.3915703 Vali Loss: 1.2876687 Test Loss: 0.3480411
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 60 cost time: 1.6843817234039307
Epoch: 60, Steps: 52 | Train Loss: 0.3926602 Vali Loss: 1.2900486 Test Loss: 0.3491334
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3481731116771698, mae:0.39838728308677673, rse:0.48339971899986267
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058444976806640625 GB
Epoch: 1 cost time: 2.0903167724609375
Epoch: 1, Steps: 52 | Train Loss: 0.8050931 Vali Loss: 2.3817461 Test Loss: 1.5735586
Validation loss decreased (inf --> 2.381746).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 2 cost time: 0.7163984775543213
Epoch: 2, Steps: 52 | Train Loss: 0.7106181 Vali Loss: 1.8918760 Test Loss: 1.0399470
Validation loss decreased (2.381746 --> 1.891876).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 3 cost time: 0.717287540435791
Epoch: 3, Steps: 52 | Train Loss: 0.5819042 Vali Loss: 1.6079012 Test Loss: 0.6836400
Validation loss decreased (1.891876 --> 1.607901).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 4 cost time: 0.7040004730224609
Epoch: 4, Steps: 52 | Train Loss: 0.5071205 Vali Loss: 1.4686983 Test Loss: 0.5019908
Validation loss decreased (1.607901 --> 1.468698).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 5 cost time: 0.7073848247528076
Epoch: 5, Steps: 52 | Train Loss: 0.4720235 Vali Loss: 1.4217131 Test Loss: 0.4416156
Validation loss decreased (1.468698 --> 1.421713).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 6 cost time: 1.346552848815918
Epoch: 6, Steps: 52 | Train Loss: 0.4547342 Vali Loss: 1.3978908 Test Loss: 0.4131165
Validation loss decreased (1.421713 --> 1.397891).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 7 cost time: 1.5780787467956543
Epoch: 7, Steps: 52 | Train Loss: 0.4447223 Vali Loss: 1.3814914 Test Loss: 0.3957762
Validation loss decreased (1.397891 --> 1.381491).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 8 cost time: 1.5755252838134766
Epoch: 8, Steps: 52 | Train Loss: 0.4380118 Vali Loss: 1.3753245 Test Loss: 0.3849842
Validation loss decreased (1.381491 --> 1.375324).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 9 cost time: 1.5789783000946045
Epoch: 9, Steps: 52 | Train Loss: 0.4348436 Vali Loss: 1.3658094 Test Loss: 0.3770090
Validation loss decreased (1.375324 --> 1.365809).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 10 cost time: 1.5767006874084473
Epoch: 10, Steps: 52 | Train Loss: 0.4306069 Vali Loss: 1.3375652 Test Loss: 0.3696652
Validation loss decreased (1.365809 --> 1.337565).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 11 cost time: 1.581573486328125
Epoch: 11, Steps: 52 | Train Loss: 0.4275613 Vali Loss: 1.3549484 Test Loss: 0.3657601
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 12 cost time: 1.5858409404754639
Epoch: 12, Steps: 52 | Train Loss: 0.4258926 Vali Loss: 1.3413229 Test Loss: 0.3612822
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 13 cost time: 1.5823166370391846
Epoch: 13, Steps: 52 | Train Loss: 0.4232213 Vali Loss: 1.3389859 Test Loss: 0.3581000
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 14 cost time: 1.5883986949920654
Epoch: 14, Steps: 52 | Train Loss: 0.4195560 Vali Loss: 1.3444860 Test Loss: 0.3560193
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 15 cost time: 1.5778284072875977
Epoch: 15, Steps: 52 | Train Loss: 0.4185405 Vali Loss: 1.3369758 Test Loss: 0.3540289
Validation loss decreased (1.337565 --> 1.336976).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 16 cost time: 1.5862963199615479
Epoch: 16, Steps: 52 | Train Loss: 0.4176512 Vali Loss: 1.3352938 Test Loss: 0.3535847
Validation loss decreased (1.336976 --> 1.335294).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 17 cost time: 1.580354928970337
Epoch: 17, Steps: 52 | Train Loss: 0.4157867 Vali Loss: 1.3319411 Test Loss: 0.3515140
Validation loss decreased (1.335294 --> 1.331941).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 18 cost time: 1.5736191272735596
Epoch: 18, Steps: 52 | Train Loss: 0.4158892 Vali Loss: 1.3297950 Test Loss: 0.3507485
Validation loss decreased (1.331941 --> 1.329795).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 19 cost time: 1.5792491436004639
Epoch: 19, Steps: 52 | Train Loss: 0.4149462 Vali Loss: 1.3205642 Test Loss: 0.3493472
Validation loss decreased (1.329795 --> 1.320564).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 20 cost time: 1.5894277095794678
Epoch: 20, Steps: 52 | Train Loss: 0.4151904 Vali Loss: 1.3212640 Test Loss: 0.3487010
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 21 cost time: 1.5813236236572266
Epoch: 21, Steps: 52 | Train Loss: 0.4133603 Vali Loss: 1.3259121 Test Loss: 0.3479443
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 22 cost time: 1.5841426849365234
Epoch: 22, Steps: 52 | Train Loss: 0.4128367 Vali Loss: 1.3237692 Test Loss: 0.3480940
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 23 cost time: 1.5796082019805908
Epoch: 23, Steps: 52 | Train Loss: 0.4125891 Vali Loss: 1.3245168 Test Loss: 0.3471032
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 24 cost time: 1.5788750648498535
Epoch: 24, Steps: 52 | Train Loss: 0.4109973 Vali Loss: 1.3184695 Test Loss: 0.3468776
Validation loss decreased (1.320564 --> 1.318470).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 25 cost time: 1.5837359428405762
Epoch: 25, Steps: 52 | Train Loss: 0.4095241 Vali Loss: 1.3136556 Test Loss: 0.3463903
Validation loss decreased (1.318470 --> 1.313656).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 26 cost time: 1.5883448123931885
Epoch: 26, Steps: 52 | Train Loss: 0.4105315 Vali Loss: 1.3191030 Test Loss: 0.3463978
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 27 cost time: 1.578946590423584
Epoch: 27, Steps: 52 | Train Loss: 0.4115674 Vali Loss: 1.3141582 Test Loss: 0.3463776
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 28 cost time: 1.5858871936798096
Epoch: 28, Steps: 52 | Train Loss: 0.4093175 Vali Loss: 1.3172557 Test Loss: 0.3462455
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 29 cost time: 1.578665018081665
Epoch: 29, Steps: 52 | Train Loss: 0.4111483 Vali Loss: 1.3183142 Test Loss: 0.3456501
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 30 cost time: 1.576538324356079
Epoch: 30, Steps: 52 | Train Loss: 0.4103843 Vali Loss: 1.3132397 Test Loss: 0.3457922
Validation loss decreased (1.313656 --> 1.313240).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 31 cost time: 1.5837945938110352
Epoch: 31, Steps: 52 | Train Loss: 0.4098309 Vali Loss: 1.3062099 Test Loss: 0.3454686
Validation loss decreased (1.313240 --> 1.306210).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 32 cost time: 1.5754327774047852
Epoch: 32, Steps: 52 | Train Loss: 0.4092200 Vali Loss: 1.3157648 Test Loss: 0.3453751
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 33 cost time: 1.5814692974090576
Epoch: 33, Steps: 52 | Train Loss: 0.4108192 Vali Loss: 1.3205891 Test Loss: 0.3450821
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 34 cost time: 1.5790009498596191
Epoch: 34, Steps: 52 | Train Loss: 0.4099398 Vali Loss: 1.3187892 Test Loss: 0.3454875
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 35 cost time: 1.5896427631378174
Epoch: 35, Steps: 52 | Train Loss: 0.4091549 Vali Loss: 1.3162827 Test Loss: 0.3448614
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 36 cost time: 1.5751969814300537
Epoch: 36, Steps: 52 | Train Loss: 0.4089581 Vali Loss: 1.3168931 Test Loss: 0.3451130
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 37 cost time: 1.5851366519927979
Epoch: 37, Steps: 52 | Train Loss: 0.4097693 Vali Loss: 1.3095367 Test Loss: 0.3459085
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 38 cost time: 1.57277250289917
Epoch: 38, Steps: 52 | Train Loss: 0.4088873 Vali Loss: 1.3117862 Test Loss: 0.3450336
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 39 cost time: 1.5808253288269043
Epoch: 39, Steps: 52 | Train Loss: 0.4098111 Vali Loss: 1.3093740 Test Loss: 0.3444698
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 40 cost time: 1.5770187377929688
Epoch: 40, Steps: 52 | Train Loss: 0.4086042 Vali Loss: 1.3084699 Test Loss: 0.3449758
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 41 cost time: 1.5927612781524658
Epoch: 41, Steps: 52 | Train Loss: 0.4080660 Vali Loss: 1.3171581 Test Loss: 0.3448392
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 42 cost time: 1.5744826793670654
Epoch: 42, Steps: 52 | Train Loss: 0.4090322 Vali Loss: 1.3157697 Test Loss: 0.3447223
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 43 cost time: 1.5909507274627686
Epoch: 43, Steps: 52 | Train Loss: 0.4084580 Vali Loss: 1.3144598 Test Loss: 0.3451984
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 44 cost time: 1.57598876953125
Epoch: 44, Steps: 52 | Train Loss: 0.4099073 Vali Loss: 1.3133116 Test Loss: 0.3448548
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 45 cost time: 1.5893986225128174
Epoch: 45, Steps: 52 | Train Loss: 0.4073183 Vali Loss: 1.3119949 Test Loss: 0.3443909
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 46 cost time: 1.5761713981628418
Epoch: 46, Steps: 52 | Train Loss: 0.4081465 Vali Loss: 1.3092957 Test Loss: 0.3450447
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 47 cost time: 1.5891461372375488
Epoch: 47, Steps: 52 | Train Loss: 0.4070577 Vali Loss: 1.3092208 Test Loss: 0.3450665
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 48 cost time: 1.5735065937042236
Epoch: 48, Steps: 52 | Train Loss: 0.4094596 Vali Loss: 1.3158019 Test Loss: 0.3449492
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 49 cost time: 1.588491439819336
Epoch: 49, Steps: 52 | Train Loss: 0.4073880 Vali Loss: 1.3132513 Test Loss: 0.3446380
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 50 cost time: 1.5760328769683838
Epoch: 50, Steps: 52 | Train Loss: 0.4087951 Vali Loss: 1.3145216 Test Loss: 0.3445117
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 51 cost time: 1.5864498615264893
Epoch: 51, Steps: 52 | Train Loss: 0.4090875 Vali Loss: 1.3188965 Test Loss: 0.3450077
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 52 cost time: 1.5721461772918701
Epoch: 52, Steps: 52 | Train Loss: 0.4092184 Vali Loss: 1.3024151 Test Loss: 0.3450789
Validation loss decreased (1.306210 --> 1.302415).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 53 cost time: 1.5832762718200684
Epoch: 53, Steps: 52 | Train Loss: 0.4067440 Vali Loss: 1.3098079 Test Loss: 0.3445634
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 54 cost time: 1.5771892070770264
Epoch: 54, Steps: 52 | Train Loss: 0.4076141 Vali Loss: 1.3130803 Test Loss: 0.3454505
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 55 cost time: 1.5873913764953613
Epoch: 55, Steps: 52 | Train Loss: 0.4066506 Vali Loss: 1.3147670 Test Loss: 0.3452220
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 56 cost time: 1.5825846195220947
Epoch: 56, Steps: 52 | Train Loss: 0.4086221 Vali Loss: 1.3163872 Test Loss: 0.3445970
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 57 cost time: 1.5775504112243652
Epoch: 57, Steps: 52 | Train Loss: 0.4081174 Vali Loss: 1.3129747 Test Loss: 0.3446808
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 58 cost time: 1.5859639644622803
Epoch: 58, Steps: 52 | Train Loss: 0.4067902 Vali Loss: 1.3138667 Test Loss: 0.3444276
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 59 cost time: 1.5797069072723389
Epoch: 59, Steps: 52 | Train Loss: 0.4086350 Vali Loss: 1.3150089 Test Loss: 0.3448640
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 60 cost time: 1.5750665664672852
Epoch: 60, Steps: 52 | Train Loss: 0.4088930 Vali Loss: 1.3098348 Test Loss: 0.3448690
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3450789153575897, mae:0.39225006103515625, rse:0.4812469780445099
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.06283950805664062 GB
Epoch: 1 cost time: 2.105581283569336
Epoch: 1, Steps: 52 | Train Loss: 0.6944425 Vali Loss: 2.1217334 Test Loss: 1.3374195
Validation loss decreased (inf --> 2.121733).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 2 cost time: 0.7454113960266113
Epoch: 2, Steps: 52 | Train Loss: 0.5459578 Vali Loss: 1.4388363 Test Loss: 0.4577837
Validation loss decreased (2.121733 --> 1.438836).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 3 cost time: 0.736393928527832
Epoch: 3, Steps: 52 | Train Loss: 0.4460368 Vali Loss: 1.3917112 Test Loss: 0.4075493
Validation loss decreased (1.438836 --> 1.391711).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 4 cost time: 0.7250974178314209
Epoch: 4, Steps: 52 | Train Loss: 0.4258099 Vali Loss: 1.3759180 Test Loss: 0.3861908
Validation loss decreased (1.391711 --> 1.375918).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 5 cost time: 0.7369997501373291
Epoch: 5, Steps: 52 | Train Loss: 0.4203174 Vali Loss: 1.3630190 Test Loss: 0.3765588
Validation loss decreased (1.375918 --> 1.363019).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 6 cost time: 1.6286656856536865
Epoch: 6, Steps: 52 | Train Loss: 0.4158675 Vali Loss: 1.3511049 Test Loss: 0.3682753
Validation loss decreased (1.363019 --> 1.351105).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 7 cost time: 1.6403331756591797
Epoch: 7, Steps: 52 | Train Loss: 0.4098639 Vali Loss: 1.3459327 Test Loss: 0.3639084
Validation loss decreased (1.351105 --> 1.345933).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 8 cost time: 1.649775505065918
Epoch: 8, Steps: 52 | Train Loss: 0.4072750 Vali Loss: 1.3257773 Test Loss: 0.3598338
Validation loss decreased (1.345933 --> 1.325777).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 9 cost time: 1.64589262008667
Epoch: 9, Steps: 52 | Train Loss: 0.4066734 Vali Loss: 1.3300185 Test Loss: 0.3582928
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 10 cost time: 1.6456282138824463
Epoch: 10, Steps: 52 | Train Loss: 0.4050854 Vali Loss: 1.3229259 Test Loss: 0.3558189
Validation loss decreased (1.325777 --> 1.322926).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 11 cost time: 1.6468429565429688
Epoch: 11, Steps: 52 | Train Loss: 0.4024107 Vali Loss: 1.3191655 Test Loss: 0.3549873
Validation loss decreased (1.322926 --> 1.319165).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 12 cost time: 1.6540002822875977
Epoch: 12, Steps: 52 | Train Loss: 0.4031147 Vali Loss: 1.3205427 Test Loss: 0.3533609
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 13 cost time: 1.6486907005310059
Epoch: 13, Steps: 52 | Train Loss: 0.4013191 Vali Loss: 1.3154606 Test Loss: 0.3530013
Validation loss decreased (1.319165 --> 1.315461).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 14 cost time: 1.647254228591919
Epoch: 14, Steps: 52 | Train Loss: 0.4002335 Vali Loss: 1.3099914 Test Loss: 0.3525148
Validation loss decreased (1.315461 --> 1.309991).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 15 cost time: 1.7663676738739014
Epoch: 15, Steps: 52 | Train Loss: 0.4001090 Vali Loss: 1.3097529 Test Loss: 0.3527173
Validation loss decreased (1.309991 --> 1.309753).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 16 cost time: 1.6491281986236572
Epoch: 16, Steps: 52 | Train Loss: 0.3993222 Vali Loss: 1.3030539 Test Loss: 0.3525754
Validation loss decreased (1.309753 --> 1.303054).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 17 cost time: 1.642655611038208
Epoch: 17, Steps: 52 | Train Loss: 0.3985060 Vali Loss: 1.2960800 Test Loss: 0.3514224
Validation loss decreased (1.303054 --> 1.296080).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 18 cost time: 1.656874656677246
Epoch: 18, Steps: 52 | Train Loss: 0.3981035 Vali Loss: 1.3047669 Test Loss: 0.3509815
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 19 cost time: 1.6440305709838867
Epoch: 19, Steps: 52 | Train Loss: 0.3978139 Vali Loss: 1.2941642 Test Loss: 0.3508409
Validation loss decreased (1.296080 --> 1.294164).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 20 cost time: 1.6382474899291992
Epoch: 20, Steps: 52 | Train Loss: 0.3984394 Vali Loss: 1.2933773 Test Loss: 0.3507960
Validation loss decreased (1.294164 --> 1.293377).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 21 cost time: 1.6471757888793945
Epoch: 21, Steps: 52 | Train Loss: 0.3978792 Vali Loss: 1.3039792 Test Loss: 0.3504859
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 22 cost time: 1.6442887783050537
Epoch: 22, Steps: 52 | Train Loss: 0.3981005 Vali Loss: 1.3029449 Test Loss: 0.3512206
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 23 cost time: 1.6500096321105957
Epoch: 23, Steps: 52 | Train Loss: 0.3970310 Vali Loss: 1.3054113 Test Loss: 0.3505995
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 24 cost time: 1.6449761390686035
Epoch: 24, Steps: 52 | Train Loss: 0.3965295 Vali Loss: 1.3013619 Test Loss: 0.3506608
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 25 cost time: 1.6436347961425781
Epoch: 25, Steps: 52 | Train Loss: 0.3966992 Vali Loss: 1.2965031 Test Loss: 0.3513187
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 26 cost time: 1.6435604095458984
Epoch: 26, Steps: 52 | Train Loss: 0.3965209 Vali Loss: 1.2965910 Test Loss: 0.3503383
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 27 cost time: 1.6528387069702148
Epoch: 27, Steps: 52 | Train Loss: 0.3964594 Vali Loss: 1.3002818 Test Loss: 0.3507911
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 28 cost time: 1.645395040512085
Epoch: 28, Steps: 52 | Train Loss: 0.3966702 Vali Loss: 1.3006274 Test Loss: 0.3506527
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 29 cost time: 1.6546494960784912
Epoch: 29, Steps: 52 | Train Loss: 0.3952966 Vali Loss: 1.2841172 Test Loss: 0.3504404
Validation loss decreased (1.293377 --> 1.284117).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 30 cost time: 1.6471507549285889
Epoch: 30, Steps: 52 | Train Loss: 0.3959302 Vali Loss: 1.2962509 Test Loss: 0.3501588
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 31 cost time: 1.651857852935791
Epoch: 31, Steps: 52 | Train Loss: 0.3967200 Vali Loss: 1.3019798 Test Loss: 0.3499996
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 32 cost time: 1.648357629776001
Epoch: 32, Steps: 52 | Train Loss: 0.3963743 Vali Loss: 1.2849023 Test Loss: 0.3498061
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 33 cost time: 1.649073600769043
Epoch: 33, Steps: 52 | Train Loss: 0.3945013 Vali Loss: 1.2942843 Test Loss: 0.3495324
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 34 cost time: 1.6470308303833008
Epoch: 34, Steps: 52 | Train Loss: 0.3958584 Vali Loss: 1.2924550 Test Loss: 0.3497380
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 35 cost time: 1.6514501571655273
Epoch: 35, Steps: 52 | Train Loss: 0.3950450 Vali Loss: 1.2962258 Test Loss: 0.3495279
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 36 cost time: 1.648723840713501
Epoch: 36, Steps: 52 | Train Loss: 0.3960753 Vali Loss: 1.2964811 Test Loss: 0.3504247
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 37 cost time: 1.6414892673492432
Epoch: 37, Steps: 52 | Train Loss: 0.3950531 Vali Loss: 1.2996323 Test Loss: 0.3505561
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 38 cost time: 1.647423267364502
Epoch: 38, Steps: 52 | Train Loss: 0.3938095 Vali Loss: 1.2935280 Test Loss: 0.3501590
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 39 cost time: 1.6512115001678467
Epoch: 39, Steps: 52 | Train Loss: 0.3953544 Vali Loss: 1.2946122 Test Loss: 0.3495221
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 40 cost time: 1.64890456199646
Epoch: 40, Steps: 52 | Train Loss: 0.3957724 Vali Loss: 1.2996975 Test Loss: 0.3501467
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 41 cost time: 1.652604341506958
Epoch: 41, Steps: 52 | Train Loss: 0.3965739 Vali Loss: 1.2984619 Test Loss: 0.3500068
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 42 cost time: 1.6477582454681396
Epoch: 42, Steps: 52 | Train Loss: 0.3937603 Vali Loss: 1.2974179 Test Loss: 0.3496889
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 43 cost time: 1.6485962867736816
Epoch: 43, Steps: 52 | Train Loss: 0.3954386 Vali Loss: 1.2989399 Test Loss: 0.3497408
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 44 cost time: 1.6420199871063232
Epoch: 44, Steps: 52 | Train Loss: 0.3935467 Vali Loss: 1.2934313 Test Loss: 0.3504813
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 45 cost time: 1.6508874893188477
Epoch: 45, Steps: 52 | Train Loss: 0.3932618 Vali Loss: 1.2933006 Test Loss: 0.3505404
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 46 cost time: 1.6467063426971436
Epoch: 46, Steps: 52 | Train Loss: 0.3954626 Vali Loss: 1.2924324 Test Loss: 0.3504666
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 47 cost time: 1.6506049633026123
Epoch: 47, Steps: 52 | Train Loss: 0.3961308 Vali Loss: 1.3010803 Test Loss: 0.3503043
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 48 cost time: 1.6448783874511719
Epoch: 48, Steps: 52 | Train Loss: 0.3934772 Vali Loss: 1.2930628 Test Loss: 0.3499886
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 49 cost time: 1.6490652561187744
Epoch: 49, Steps: 52 | Train Loss: 0.3941266 Vali Loss: 1.3011028 Test Loss: 0.3510334
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 50 cost time: 1.6492011547088623
Epoch: 50, Steps: 52 | Train Loss: 0.3963043 Vali Loss: 1.2929423 Test Loss: 0.3495676
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 51 cost time: 1.6462419033050537
Epoch: 51, Steps: 52 | Train Loss: 0.3940647 Vali Loss: 1.2924899 Test Loss: 0.3493543
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 52 cost time: 1.6436073780059814
Epoch: 52, Steps: 52 | Train Loss: 0.3943843 Vali Loss: 1.2941067 Test Loss: 0.3494942
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 53 cost time: 1.6428189277648926
Epoch: 53, Steps: 52 | Train Loss: 0.3943457 Vali Loss: 1.2923033 Test Loss: 0.3488465
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 54 cost time: 1.6414823532104492
Epoch: 54, Steps: 52 | Train Loss: 0.3945286 Vali Loss: 1.2945874 Test Loss: 0.3499224
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 55 cost time: 1.6472158432006836
Epoch: 55, Steps: 52 | Train Loss: 0.3944826 Vali Loss: 1.2995462 Test Loss: 0.3492542
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 56 cost time: 1.6453351974487305
Epoch: 56, Steps: 52 | Train Loss: 0.3949896 Vali Loss: 1.2954695 Test Loss: 0.3495926
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 57 cost time: 1.649163007736206
Epoch: 57, Steps: 52 | Train Loss: 0.3953052 Vali Loss: 1.2923146 Test Loss: 0.3489519
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 58 cost time: 1.6441779136657715
Epoch: 58, Steps: 52 | Train Loss: 0.3925479 Vali Loss: 1.2904803 Test Loss: 0.3491649
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 59 cost time: 1.6471691131591797
Epoch: 59, Steps: 52 | Train Loss: 0.3949742 Vali Loss: 1.3023293 Test Loss: 0.3504708
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 60 cost time: 1.6524407863616943
Epoch: 60, Steps: 52 | Train Loss: 0.3948635 Vali Loss: 1.2920150 Test Loss: 0.3502079
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3504404127597809, mae:0.40036702156066895, rse:0.48497116565704346
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06613826751708984 GB
Epoch: 1 cost time: 2.138817548751831
Epoch: 1, Steps: 52 | Train Loss: 0.6896482 Vali Loss: 2.1125631 Test Loss: 1.3615937
Validation loss decreased (inf --> 2.112563).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 2 cost time: 0.762000322341919
Epoch: 2, Steps: 52 | Train Loss: 0.5390103 Vali Loss: 1.4280601 Test Loss: 0.4373917
Validation loss decreased (2.112563 --> 1.428060).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 3 cost time: 0.7656300067901611
Epoch: 3, Steps: 52 | Train Loss: 0.4398018 Vali Loss: 1.3835808 Test Loss: 0.4011063
Validation loss decreased (1.428060 --> 1.383581).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 4 cost time: 0.7743918895721436
Epoch: 4, Steps: 52 | Train Loss: 0.4218306 Vali Loss: 1.3595254 Test Loss: 0.3802354
Validation loss decreased (1.383581 --> 1.359525).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 5 cost time: 0.7571549415588379
Epoch: 5, Steps: 52 | Train Loss: 0.4155624 Vali Loss: 1.3490267 Test Loss: 0.3704860
Validation loss decreased (1.359525 --> 1.349027).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 6 cost time: 1.6733877658843994
Epoch: 6, Steps: 52 | Train Loss: 0.4103648 Vali Loss: 1.3383558 Test Loss: 0.3643203
Validation loss decreased (1.349027 --> 1.338356).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 7 cost time: 1.6893665790557861
Epoch: 7, Steps: 52 | Train Loss: 0.4071431 Vali Loss: 1.3298719 Test Loss: 0.3610290
Validation loss decreased (1.338356 --> 1.329872).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 8 cost time: 1.6902408599853516
Epoch: 8, Steps: 52 | Train Loss: 0.4069863 Vali Loss: 1.3290509 Test Loss: 0.3586069
Validation loss decreased (1.329872 --> 1.329051).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 9 cost time: 1.6960911750793457
Epoch: 9, Steps: 52 | Train Loss: 0.4035884 Vali Loss: 1.3271334 Test Loss: 0.3566413
Validation loss decreased (1.329051 --> 1.327133).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 10 cost time: 1.6934559345245361
Epoch: 10, Steps: 52 | Train Loss: 0.4037800 Vali Loss: 1.3227549 Test Loss: 0.3550311
Validation loss decreased (1.327133 --> 1.322755).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 11 cost time: 1.6946837902069092
Epoch: 11, Steps: 52 | Train Loss: 0.4020600 Vali Loss: 1.3171219 Test Loss: 0.3542851
Validation loss decreased (1.322755 --> 1.317122).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 12 cost time: 1.6921720504760742
Epoch: 12, Steps: 52 | Train Loss: 0.4015317 Vali Loss: 1.3048522 Test Loss: 0.3528475
Validation loss decreased (1.317122 --> 1.304852).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 13 cost time: 1.6928200721740723
Epoch: 13, Steps: 52 | Train Loss: 0.4005688 Vali Loss: 1.3094459 Test Loss: 0.3531246
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 14 cost time: 1.698162317276001
Epoch: 14, Steps: 52 | Train Loss: 0.3984206 Vali Loss: 1.3122550 Test Loss: 0.3524119
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 15 cost time: 1.6931264400482178
Epoch: 15, Steps: 52 | Train Loss: 0.3997487 Vali Loss: 1.2994757 Test Loss: 0.3525542
Validation loss decreased (1.304852 --> 1.299476).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 16 cost time: 1.6967298984527588
Epoch: 16, Steps: 52 | Train Loss: 0.3981821 Vali Loss: 1.3085461 Test Loss: 0.3518297
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 17 cost time: 1.6883535385131836
Epoch: 17, Steps: 52 | Train Loss: 0.3977525 Vali Loss: 1.2991339 Test Loss: 0.3514678
Validation loss decreased (1.299476 --> 1.299134).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 18 cost time: 1.699113130569458
Epoch: 18, Steps: 52 | Train Loss: 0.3966192 Vali Loss: 1.3095956 Test Loss: 0.3503681
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 19 cost time: 1.6895689964294434
Epoch: 19, Steps: 52 | Train Loss: 0.3960581 Vali Loss: 1.3006005 Test Loss: 0.3502294
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 20 cost time: 1.6941285133361816
Epoch: 20, Steps: 52 | Train Loss: 0.3951835 Vali Loss: 1.3076856 Test Loss: 0.3494959
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 21 cost time: 1.6950225830078125
Epoch: 21, Steps: 52 | Train Loss: 0.3953018 Vali Loss: 1.3020935 Test Loss: 0.3490806
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 22 cost time: 1.6935253143310547
Epoch: 22, Steps: 52 | Train Loss: 0.3960895 Vali Loss: 1.2978313 Test Loss: 0.3495587
Validation loss decreased (1.299134 --> 1.297831).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 23 cost time: 1.6918199062347412
Epoch: 23, Steps: 52 | Train Loss: 0.3950908 Vali Loss: 1.3021708 Test Loss: 0.3493370
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 24 cost time: 1.6970672607421875
Epoch: 24, Steps: 52 | Train Loss: 0.3964547 Vali Loss: 1.3037173 Test Loss: 0.3491912
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 25 cost time: 1.690948486328125
Epoch: 25, Steps: 52 | Train Loss: 0.3959358 Vali Loss: 1.3002739 Test Loss: 0.3488752
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 26 cost time: 1.691267490386963
Epoch: 26, Steps: 52 | Train Loss: 0.3938092 Vali Loss: 1.3043448 Test Loss: 0.3485233
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 27 cost time: 1.6959588527679443
Epoch: 27, Steps: 52 | Train Loss: 0.3957402 Vali Loss: 1.2958302 Test Loss: 0.3490145
Validation loss decreased (1.297831 --> 1.295830).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 28 cost time: 1.6975431442260742
Epoch: 28, Steps: 52 | Train Loss: 0.3936096 Vali Loss: 1.2960260 Test Loss: 0.3487479
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 29 cost time: 1.6902034282684326
Epoch: 29, Steps: 52 | Train Loss: 0.3950625 Vali Loss: 1.3004744 Test Loss: 0.3485831
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 30 cost time: 1.6902146339416504
Epoch: 30, Steps: 52 | Train Loss: 0.3949844 Vali Loss: 1.2861823 Test Loss: 0.3484701
Validation loss decreased (1.295830 --> 1.286182).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 31 cost time: 1.692324161529541
Epoch: 31, Steps: 52 | Train Loss: 0.3942066 Vali Loss: 1.2903708 Test Loss: 0.3483441
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 32 cost time: 1.691969394683838
Epoch: 32, Steps: 52 | Train Loss: 0.3945559 Vali Loss: 1.2970762 Test Loss: 0.3486772
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 33 cost time: 1.698347568511963
Epoch: 33, Steps: 52 | Train Loss: 0.3939213 Vali Loss: 1.3017269 Test Loss: 0.3486006
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 34 cost time: 1.6962196826934814
Epoch: 34, Steps: 52 | Train Loss: 0.3952511 Vali Loss: 1.2994446 Test Loss: 0.3480373
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 35 cost time: 1.6970136165618896
Epoch: 35, Steps: 52 | Train Loss: 0.3944634 Vali Loss: 1.3001814 Test Loss: 0.3478158
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 36 cost time: 1.693239450454712
Epoch: 36, Steps: 52 | Train Loss: 0.3950258 Vali Loss: 1.2910349 Test Loss: 0.3480732
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 37 cost time: 1.6964221000671387
Epoch: 37, Steps: 52 | Train Loss: 0.3941954 Vali Loss: 1.2905216 Test Loss: 0.3478352
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 38 cost time: 1.6955127716064453
Epoch: 38, Steps: 52 | Train Loss: 0.3935895 Vali Loss: 1.2931173 Test Loss: 0.3478804
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 39 cost time: 1.6993260383605957
Epoch: 39, Steps: 52 | Train Loss: 0.3945396 Vali Loss: 1.2975497 Test Loss: 0.3484124
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 40 cost time: 1.693969488143921
Epoch: 40, Steps: 52 | Train Loss: 0.3939765 Vali Loss: 1.2912986 Test Loss: 0.3474986
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 41 cost time: 1.6959190368652344
Epoch: 41, Steps: 52 | Train Loss: 0.3929926 Vali Loss: 1.2966673 Test Loss: 0.3479650
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 42 cost time: 1.6938443183898926
Epoch: 42, Steps: 52 | Train Loss: 0.3932419 Vali Loss: 1.2958698 Test Loss: 0.3473963
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 43 cost time: 1.6955716609954834
Epoch: 43, Steps: 52 | Train Loss: 0.3947391 Vali Loss: 1.2975624 Test Loss: 0.3479303
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 44 cost time: 1.694373607635498
Epoch: 44, Steps: 52 | Train Loss: 0.3937439 Vali Loss: 1.2882119 Test Loss: 0.3479351
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 45 cost time: 1.6933925151824951
Epoch: 45, Steps: 52 | Train Loss: 0.3934652 Vali Loss: 1.2897718 Test Loss: 0.3471296
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 46 cost time: 1.6929512023925781
Epoch: 46, Steps: 52 | Train Loss: 0.3926221 Vali Loss: 1.3018932 Test Loss: 0.3479494
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 47 cost time: 1.6968557834625244
Epoch: 47, Steps: 52 | Train Loss: 0.3946991 Vali Loss: 1.2970138 Test Loss: 0.3474668
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 48 cost time: 1.6935005187988281
Epoch: 48, Steps: 52 | Train Loss: 0.3926744 Vali Loss: 1.3029209 Test Loss: 0.3475272
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 49 cost time: 1.6941068172454834
Epoch: 49, Steps: 52 | Train Loss: 0.3932997 Vali Loss: 1.2967014 Test Loss: 0.3472875
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 50 cost time: 1.6959025859832764
Epoch: 50, Steps: 52 | Train Loss: 0.3936082 Vali Loss: 1.2966599 Test Loss: 0.3477955
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 51 cost time: 1.691899299621582
Epoch: 51, Steps: 52 | Train Loss: 0.3934422 Vali Loss: 1.2990439 Test Loss: 0.3476615
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 52 cost time: 1.6942224502563477
Epoch: 52, Steps: 52 | Train Loss: 0.3931178 Vali Loss: 1.2950981 Test Loss: 0.3472885
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 53 cost time: 1.690269947052002
Epoch: 53, Steps: 52 | Train Loss: 0.3928845 Vali Loss: 1.2991004 Test Loss: 0.3477319
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 54 cost time: 1.6958250999450684
Epoch: 54, Steps: 52 | Train Loss: 0.3943203 Vali Loss: 1.2984488 Test Loss: 0.3476152
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 55 cost time: 1.6927125453948975
Epoch: 55, Steps: 52 | Train Loss: 0.3931162 Vali Loss: 1.2977968 Test Loss: 0.3473032
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 56 cost time: 1.6964526176452637
Epoch: 56, Steps: 52 | Train Loss: 0.3940045 Vali Loss: 1.3012525 Test Loss: 0.3479823
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 57 cost time: 1.6953604221343994
Epoch: 57, Steps: 52 | Train Loss: 0.3945268 Vali Loss: 1.2935624 Test Loss: 0.3478360
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 58 cost time: 1.6972858905792236
Epoch: 58, Steps: 52 | Train Loss: 0.3934449 Vali Loss: 1.3006531 Test Loss: 0.3476093
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 59 cost time: 1.689404010772705
Epoch: 59, Steps: 52 | Train Loss: 0.3935385 Vali Loss: 1.2988904 Test Loss: 0.3472001
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 60 cost time: 1.6973745822906494
Epoch: 60, Steps: 52 | Train Loss: 0.3958426 Vali Loss: 1.2940502 Test Loss: 0.3468743
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34847012162208557, mae:0.39512595534324646, rse:0.48360586166381836
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.05860710144042969 GB
Epoch: 1 cost time: 2.1302902698516846
Epoch: 1, Steps: 52 | Train Loss: 0.7550471 Vali Loss: 2.1806369 Test Loss: 1.4038569
Validation loss decreased (inf --> 2.180637).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 2 cost time: 0.720630407333374
Epoch: 2, Steps: 52 | Train Loss: 0.6608114 Vali Loss: 1.7364020 Test Loss: 0.8688058
Validation loss decreased (2.180637 --> 1.736402).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 3 cost time: 0.7323598861694336
Epoch: 3, Steps: 52 | Train Loss: 0.5394151 Vali Loss: 1.5067778 Test Loss: 0.5642359
Validation loss decreased (1.736402 --> 1.506778).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 4 cost time: 0.7080004215240479
Epoch: 4, Steps: 52 | Train Loss: 0.4810530 Vali Loss: 1.4226158 Test Loss: 0.4474636
Validation loss decreased (1.506778 --> 1.422616).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 5 cost time: 0.7164051532745361
Epoch: 5, Steps: 52 | Train Loss: 0.4558459 Vali Loss: 1.3953578 Test Loss: 0.4114497
Validation loss decreased (1.422616 --> 1.395358).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 6 cost time: 1.482013463973999
Epoch: 6, Steps: 52 | Train Loss: 0.4449489 Vali Loss: 1.3833830 Test Loss: 0.3952715
Validation loss decreased (1.395358 --> 1.383383).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 7 cost time: 1.598912000656128
Epoch: 7, Steps: 52 | Train Loss: 0.4367912 Vali Loss: 1.3655142 Test Loss: 0.3833110
Validation loss decreased (1.383383 --> 1.365514).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 8 cost time: 1.6103148460388184
Epoch: 8, Steps: 52 | Train Loss: 0.4317102 Vali Loss: 1.3584298 Test Loss: 0.3753477
Validation loss decreased (1.365514 --> 1.358430).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 9 cost time: 1.5983662605285645
Epoch: 9, Steps: 52 | Train Loss: 0.4276205 Vali Loss: 1.3507435 Test Loss: 0.3696154
Validation loss decreased (1.358430 --> 1.350744).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 10 cost time: 1.6088104248046875
Epoch: 10, Steps: 52 | Train Loss: 0.4243851 Vali Loss: 1.3491495 Test Loss: 0.3645065
Validation loss decreased (1.350744 --> 1.349149).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 11 cost time: 1.608992576599121
Epoch: 11, Steps: 52 | Train Loss: 0.4218348 Vali Loss: 1.3478448 Test Loss: 0.3608221
Validation loss decreased (1.349149 --> 1.347845).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 12 cost time: 1.5961356163024902
Epoch: 12, Steps: 52 | Train Loss: 0.4207157 Vali Loss: 1.3440460 Test Loss: 0.3582018
Validation loss decreased (1.347845 --> 1.344046).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 13 cost time: 1.6041712760925293
Epoch: 13, Steps: 52 | Train Loss: 0.4185138 Vali Loss: 1.3424358 Test Loss: 0.3555444
Validation loss decreased (1.344046 --> 1.342436).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 14 cost time: 1.5946106910705566
Epoch: 14, Steps: 52 | Train Loss: 0.4155845 Vali Loss: 1.3282645 Test Loss: 0.3533475
Validation loss decreased (1.342436 --> 1.328264).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 15 cost time: 1.599694013595581
Epoch: 15, Steps: 52 | Train Loss: 0.4156642 Vali Loss: 1.3316325 Test Loss: 0.3522629
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 16 cost time: 1.6005256175994873
Epoch: 16, Steps: 52 | Train Loss: 0.4158813 Vali Loss: 1.3254831 Test Loss: 0.3515212
Validation loss decreased (1.328264 --> 1.325483).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 17 cost time: 1.603743076324463
Epoch: 17, Steps: 52 | Train Loss: 0.4130415 Vali Loss: 1.3183544 Test Loss: 0.3506465
Validation loss decreased (1.325483 --> 1.318354).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 18 cost time: 1.5985262393951416
Epoch: 18, Steps: 52 | Train Loss: 0.4125435 Vali Loss: 1.3181012 Test Loss: 0.3495004
Validation loss decreased (1.318354 --> 1.318101).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 19 cost time: 1.5976576805114746
Epoch: 19, Steps: 52 | Train Loss: 0.4101289 Vali Loss: 1.3276155 Test Loss: 0.3487440
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 20 cost time: 1.5980863571166992
Epoch: 20, Steps: 52 | Train Loss: 0.4104488 Vali Loss: 1.3214551 Test Loss: 0.3484783
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 21 cost time: 1.6069304943084717
Epoch: 21, Steps: 52 | Train Loss: 0.4116168 Vali Loss: 1.3223871 Test Loss: 0.3470238
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 22 cost time: 1.5980727672576904
Epoch: 22, Steps: 52 | Train Loss: 0.4089564 Vali Loss: 1.3184948 Test Loss: 0.3466550
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 23 cost time: 1.5963077545166016
Epoch: 23, Steps: 52 | Train Loss: 0.4074154 Vali Loss: 1.3150795 Test Loss: 0.3459177
Validation loss decreased (1.318101 --> 1.315079).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 24 cost time: 1.5973689556121826
Epoch: 24, Steps: 52 | Train Loss: 0.4090414 Vali Loss: 1.3182689 Test Loss: 0.3461974
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 25 cost time: 1.5928189754486084
Epoch: 25, Steps: 52 | Train Loss: 0.4080451 Vali Loss: 1.3151405 Test Loss: 0.3446124
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 26 cost time: 1.5928728580474854
Epoch: 26, Steps: 52 | Train Loss: 0.4065944 Vali Loss: 1.3049462 Test Loss: 0.3450847
Validation loss decreased (1.315079 --> 1.304946).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 27 cost time: 1.59440279006958
Epoch: 27, Steps: 52 | Train Loss: 0.4067011 Vali Loss: 1.3168724 Test Loss: 0.3447039
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 28 cost time: 1.59653902053833
Epoch: 28, Steps: 52 | Train Loss: 0.4073108 Vali Loss: 1.3124533 Test Loss: 0.3447853
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 29 cost time: 1.606827974319458
Epoch: 29, Steps: 52 | Train Loss: 0.4065635 Vali Loss: 1.3146715 Test Loss: 0.3449207
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 30 cost time: 1.5958960056304932
Epoch: 30, Steps: 52 | Train Loss: 0.4075690 Vali Loss: 1.3140894 Test Loss: 0.3445129
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 31 cost time: 1.5932977199554443
Epoch: 31, Steps: 52 | Train Loss: 0.4083485 Vali Loss: 1.3026099 Test Loss: 0.3441216
Validation loss decreased (1.304946 --> 1.302610).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 32 cost time: 1.603700876235962
Epoch: 32, Steps: 52 | Train Loss: 0.4057762 Vali Loss: 1.3102101 Test Loss: 0.3435453
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 33 cost time: 1.5967097282409668
Epoch: 33, Steps: 52 | Train Loss: 0.4070209 Vali Loss: 1.3048270 Test Loss: 0.3438647
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 34 cost time: 1.5941686630249023
Epoch: 34, Steps: 52 | Train Loss: 0.4061016 Vali Loss: 1.3150334 Test Loss: 0.3438473
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 35 cost time: 1.597316026687622
Epoch: 35, Steps: 52 | Train Loss: 0.4069630 Vali Loss: 1.3035609 Test Loss: 0.3439819
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 36 cost time: 1.5916707515716553
Epoch: 36, Steps: 52 | Train Loss: 0.4057639 Vali Loss: 1.3128000 Test Loss: 0.3440477
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 37 cost time: 1.5923693180084229
Epoch: 37, Steps: 52 | Train Loss: 0.4045669 Vali Loss: 1.3069869 Test Loss: 0.3438632
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 38 cost time: 1.5972545146942139
Epoch: 38, Steps: 52 | Train Loss: 0.4052411 Vali Loss: 1.3118107 Test Loss: 0.3428023
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 39 cost time: 1.603996753692627
Epoch: 39, Steps: 52 | Train Loss: 0.4060246 Vali Loss: 1.3133976 Test Loss: 0.3433529
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 40 cost time: 1.594825029373169
Epoch: 40, Steps: 52 | Train Loss: 0.4063421 Vali Loss: 1.3104074 Test Loss: 0.3433534
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 41 cost time: 1.6042461395263672
Epoch: 41, Steps: 52 | Train Loss: 0.4057667 Vali Loss: 1.3021843 Test Loss: 0.3430282
Validation loss decreased (1.302610 --> 1.302184).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 42 cost time: 1.6067347526550293
Epoch: 42, Steps: 52 | Train Loss: 0.4056161 Vali Loss: 1.3026495 Test Loss: 0.3425958
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 43 cost time: 1.5954134464263916
Epoch: 43, Steps: 52 | Train Loss: 0.4046602 Vali Loss: 1.3101385 Test Loss: 0.3435504
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 44 cost time: 1.609931230545044
Epoch: 44, Steps: 52 | Train Loss: 0.4057881 Vali Loss: 1.3082968 Test Loss: 0.3432580
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 45 cost time: 1.5925936698913574
Epoch: 45, Steps: 52 | Train Loss: 0.4048049 Vali Loss: 1.2997067 Test Loss: 0.3429917
Validation loss decreased (1.302184 --> 1.299707).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 46 cost time: 1.6004586219787598
Epoch: 46, Steps: 52 | Train Loss: 0.4045921 Vali Loss: 1.3112884 Test Loss: 0.3433917
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 47 cost time: 1.5973236560821533
Epoch: 47, Steps: 52 | Train Loss: 0.4045913 Vali Loss: 1.2988873 Test Loss: 0.3434649
Validation loss decreased (1.299707 --> 1.298887).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 48 cost time: 1.5941474437713623
Epoch: 48, Steps: 52 | Train Loss: 0.4046023 Vali Loss: 1.3055538 Test Loss: 0.3429238
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 49 cost time: 1.5928146839141846
Epoch: 49, Steps: 52 | Train Loss: 0.4058166 Vali Loss: 1.2973702 Test Loss: 0.3429702
Validation loss decreased (1.298887 --> 1.297370).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 50 cost time: 1.5928590297698975
Epoch: 50, Steps: 52 | Train Loss: 0.4044686 Vali Loss: 1.3059382 Test Loss: 0.3422629
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 51 cost time: 1.5908493995666504
Epoch: 51, Steps: 52 | Train Loss: 0.4050440 Vali Loss: 1.3094308 Test Loss: 0.3437287
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 52 cost time: 1.5957696437835693
Epoch: 52, Steps: 52 | Train Loss: 0.4045519 Vali Loss: 1.3118503 Test Loss: 0.3432945
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 53 cost time: 1.5947778224945068
Epoch: 53, Steps: 52 | Train Loss: 0.4061704 Vali Loss: 1.3034840 Test Loss: 0.3430791
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 54 cost time: 1.6057891845703125
Epoch: 54, Steps: 52 | Train Loss: 0.4044728 Vali Loss: 1.3088443 Test Loss: 0.3431028
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 55 cost time: 1.5964641571044922
Epoch: 55, Steps: 52 | Train Loss: 0.4033439 Vali Loss: 1.3075700 Test Loss: 0.3425096
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 56 cost time: 1.6035842895507812
Epoch: 56, Steps: 52 | Train Loss: 0.4044084 Vali Loss: 1.3091416 Test Loss: 0.3432823
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 57 cost time: 1.6062333583831787
Epoch: 57, Steps: 52 | Train Loss: 0.4055405 Vali Loss: 1.3031751 Test Loss: 0.3421316
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 58 cost time: 1.5961191654205322
Epoch: 58, Steps: 52 | Train Loss: 0.4047682 Vali Loss: 1.3098037 Test Loss: 0.3428314
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 59 cost time: 1.5987510681152344
Epoch: 59, Steps: 52 | Train Loss: 0.4039114 Vali Loss: 1.3066024 Test Loss: 0.3426572
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 60 cost time: 1.6063947677612305
Epoch: 60, Steps: 52 | Train Loss: 0.4048177 Vali Loss: 1.3117111 Test Loss: 0.3434972
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34297022223472595, mae:0.3917282521724701, rse:0.4797743260860443
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.06300163269042969 GB
Epoch: 1 cost time: 2.120656728744507
Epoch: 1, Steps: 52 | Train Loss: 0.7193976 Vali Loss: 2.1604354 Test Loss: 1.4156638
Validation loss decreased (inf --> 2.160435).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 2 cost time: 0.7495956420898438
Epoch: 2, Steps: 52 | Train Loss: 0.5682462 Vali Loss: 1.4685357 Test Loss: 0.5162982
Validation loss decreased (2.160435 --> 1.468536).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 3 cost time: 0.741999626159668
Epoch: 3, Steps: 52 | Train Loss: 0.4457456 Vali Loss: 1.3709661 Test Loss: 0.3964769
Validation loss decreased (1.468536 --> 1.370966).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 4 cost time: 0.7426164150238037
Epoch: 4, Steps: 52 | Train Loss: 0.4259378 Vali Loss: 1.3551003 Test Loss: 0.3772035
Validation loss decreased (1.370966 --> 1.355100).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 5 cost time: 0.7423710823059082
Epoch: 5, Steps: 52 | Train Loss: 0.4181246 Vali Loss: 1.3445070 Test Loss: 0.3688261
Validation loss decreased (1.355100 --> 1.344507).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 6 cost time: 1.6342902183532715
Epoch: 6, Steps: 52 | Train Loss: 0.4127563 Vali Loss: 1.3346548 Test Loss: 0.3614849
Validation loss decreased (1.344507 --> 1.334655).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 7 cost time: 1.6477429866790771
Epoch: 7, Steps: 52 | Train Loss: 0.4103132 Vali Loss: 1.3268209 Test Loss: 0.3582891
Validation loss decreased (1.334655 --> 1.326821).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 8 cost time: 1.6550142765045166
Epoch: 8, Steps: 52 | Train Loss: 0.4082991 Vali Loss: 1.3098170 Test Loss: 0.3550989
Validation loss decreased (1.326821 --> 1.309817).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 9 cost time: 1.6570184230804443
Epoch: 9, Steps: 52 | Train Loss: 0.4045809 Vali Loss: 1.3130510 Test Loss: 0.3517322
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 10 cost time: 1.651750087738037
Epoch: 10, Steps: 52 | Train Loss: 0.4039009 Vali Loss: 1.3131468 Test Loss: 0.3508383
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 11 cost time: 1.6538434028625488
Epoch: 11, Steps: 52 | Train Loss: 0.4026128 Vali Loss: 1.3134179 Test Loss: 0.3488777
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 12 cost time: 1.6503005027770996
Epoch: 12, Steps: 52 | Train Loss: 0.4014406 Vali Loss: 1.3004215 Test Loss: 0.3477933
Validation loss decreased (1.309817 --> 1.300421).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 13 cost time: 1.655174732208252
Epoch: 13, Steps: 52 | Train Loss: 0.3996388 Vali Loss: 1.2974249 Test Loss: 0.3464532
Validation loss decreased (1.300421 --> 1.297425).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 14 cost time: 1.6605682373046875
Epoch: 14, Steps: 52 | Train Loss: 0.3986595 Vali Loss: 1.3012745 Test Loss: 0.3452025
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 15 cost time: 1.6583354473114014
Epoch: 15, Steps: 52 | Train Loss: 0.3981143 Vali Loss: 1.2971289 Test Loss: 0.3447940
Validation loss decreased (1.297425 --> 1.297129).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 16 cost time: 1.6490867137908936
Epoch: 16, Steps: 52 | Train Loss: 0.3976217 Vali Loss: 1.2962017 Test Loss: 0.3447772
Validation loss decreased (1.297129 --> 1.296202).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 17 cost time: 1.656836986541748
Epoch: 17, Steps: 52 | Train Loss: 0.3988053 Vali Loss: 1.2951574 Test Loss: 0.3450454
Validation loss decreased (1.296202 --> 1.295157).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 18 cost time: 1.6530687808990479
Epoch: 18, Steps: 52 | Train Loss: 0.3958664 Vali Loss: 1.2950062 Test Loss: 0.3429130
Validation loss decreased (1.295157 --> 1.295006).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 19 cost time: 1.6523301601409912
Epoch: 19, Steps: 52 | Train Loss: 0.3957287 Vali Loss: 1.2954426 Test Loss: 0.3425694
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 20 cost time: 1.6509239673614502
Epoch: 20, Steps: 52 | Train Loss: 0.3949035 Vali Loss: 1.2960609 Test Loss: 0.3428733
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 21 cost time: 1.6542129516601562
Epoch: 21, Steps: 52 | Train Loss: 0.3954529 Vali Loss: 1.2940731 Test Loss: 0.3421837
Validation loss decreased (1.295006 --> 1.294073).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 22 cost time: 1.6566953659057617
Epoch: 22, Steps: 52 | Train Loss: 0.3954331 Vali Loss: 1.2859378 Test Loss: 0.3425129
Validation loss decreased (1.294073 --> 1.285938).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 23 cost time: 1.6580548286437988
Epoch: 23, Steps: 52 | Train Loss: 0.3949160 Vali Loss: 1.2895813 Test Loss: 0.3423097
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 24 cost time: 1.6551671028137207
Epoch: 24, Steps: 52 | Train Loss: 0.3940042 Vali Loss: 1.2934320 Test Loss: 0.3421023
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 25 cost time: 1.6537635326385498
Epoch: 25, Steps: 52 | Train Loss: 0.3954128 Vali Loss: 1.2897191 Test Loss: 0.3422104
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 26 cost time: 1.6588537693023682
Epoch: 26, Steps: 52 | Train Loss: 0.3934560 Vali Loss: 1.2928189 Test Loss: 0.3428367
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 27 cost time: 1.6496694087982178
Epoch: 27, Steps: 52 | Train Loss: 0.3933311 Vali Loss: 1.2819732 Test Loss: 0.3418834
Validation loss decreased (1.285938 --> 1.281973).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 28 cost time: 1.6525616645812988
Epoch: 28, Steps: 52 | Train Loss: 0.3927321 Vali Loss: 1.2927829 Test Loss: 0.3416781
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 29 cost time: 1.6510467529296875
Epoch: 29, Steps: 52 | Train Loss: 0.3938491 Vali Loss: 1.2856889 Test Loss: 0.3423486
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 30 cost time: 1.6524009704589844
Epoch: 30, Steps: 52 | Train Loss: 0.3916654 Vali Loss: 1.2788484 Test Loss: 0.3414770
Validation loss decreased (1.281973 --> 1.278848).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 31 cost time: 1.6528820991516113
Epoch: 31, Steps: 52 | Train Loss: 0.3946081 Vali Loss: 1.2933564 Test Loss: 0.3412207
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 32 cost time: 1.6540653705596924
Epoch: 32, Steps: 52 | Train Loss: 0.3929872 Vali Loss: 1.2858453 Test Loss: 0.3415945
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 33 cost time: 1.6576344966888428
Epoch: 33, Steps: 52 | Train Loss: 0.3942330 Vali Loss: 1.2859700 Test Loss: 0.3411607
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 34 cost time: 1.6601831912994385
Epoch: 34, Steps: 52 | Train Loss: 0.3925959 Vali Loss: 1.2868125 Test Loss: 0.3412225
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 35 cost time: 1.6498403549194336
Epoch: 35, Steps: 52 | Train Loss: 0.3931494 Vali Loss: 1.2888110 Test Loss: 0.3412800
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 36 cost time: 1.6587066650390625
Epoch: 36, Steps: 52 | Train Loss: 0.3928879 Vali Loss: 1.2885354 Test Loss: 0.3408157
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 37 cost time: 1.6535348892211914
Epoch: 37, Steps: 52 | Train Loss: 0.3912491 Vali Loss: 1.2876959 Test Loss: 0.3414823
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 38 cost time: 1.6520085334777832
Epoch: 38, Steps: 52 | Train Loss: 0.3927544 Vali Loss: 1.2826749 Test Loss: 0.3413468
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 39 cost time: 1.653480052947998
Epoch: 39, Steps: 52 | Train Loss: 0.3932317 Vali Loss: 1.2923932 Test Loss: 0.3415692
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 40 cost time: 1.653001308441162
Epoch: 40, Steps: 52 | Train Loss: 0.3927120 Vali Loss: 1.2803142 Test Loss: 0.3411700
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 41 cost time: 1.6562254428863525
Epoch: 41, Steps: 52 | Train Loss: 0.3930164 Vali Loss: 1.2867836 Test Loss: 0.3407723
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 42 cost time: 1.659350872039795
Epoch: 42, Steps: 52 | Train Loss: 0.3924869 Vali Loss: 1.2892416 Test Loss: 0.3412362
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 43 cost time: 1.6550729274749756
Epoch: 43, Steps: 52 | Train Loss: 0.3903756 Vali Loss: 1.2820716 Test Loss: 0.3397832
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 44 cost time: 1.657522439956665
Epoch: 44, Steps: 52 | Train Loss: 0.3920948 Vali Loss: 1.2906554 Test Loss: 0.3411402
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 45 cost time: 1.6526782512664795
Epoch: 45, Steps: 52 | Train Loss: 0.3929256 Vali Loss: 1.2775760 Test Loss: 0.3410639
Validation loss decreased (1.278848 --> 1.277576).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 46 cost time: 1.6552999019622803
Epoch: 46, Steps: 52 | Train Loss: 0.3929199 Vali Loss: 1.2852329 Test Loss: 0.3416750
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 47 cost time: 1.6580102443695068
Epoch: 47, Steps: 52 | Train Loss: 0.3932655 Vali Loss: 1.2902668 Test Loss: 0.3411349
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 48 cost time: 1.6525368690490723
Epoch: 48, Steps: 52 | Train Loss: 0.3920887 Vali Loss: 1.2888894 Test Loss: 0.3405277
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 49 cost time: 1.6469924449920654
Epoch: 49, Steps: 52 | Train Loss: 0.3933542 Vali Loss: 1.2835687 Test Loss: 0.3417289
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 50 cost time: 1.651484727859497
Epoch: 50, Steps: 52 | Train Loss: 0.3901799 Vali Loss: 1.2854807 Test Loss: 0.3414914
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 51 cost time: 1.6504380702972412
Epoch: 51, Steps: 52 | Train Loss: 0.3934657 Vali Loss: 1.2862809 Test Loss: 0.3417190
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 52 cost time: 1.6528427600860596
Epoch: 52, Steps: 52 | Train Loss: 0.3927528 Vali Loss: 1.2807397 Test Loss: 0.3412902
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 53 cost time: 1.6550171375274658
Epoch: 53, Steps: 52 | Train Loss: 0.3931872 Vali Loss: 1.2796521 Test Loss: 0.3405075
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 54 cost time: 1.6534311771392822
Epoch: 54, Steps: 52 | Train Loss: 0.3907379 Vali Loss: 1.2715442 Test Loss: 0.3408307
Validation loss decreased (1.277576 --> 1.271544).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 55 cost time: 1.6586315631866455
Epoch: 55, Steps: 52 | Train Loss: 0.3930670 Vali Loss: 1.2869632 Test Loss: 0.3409681
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 56 cost time: 1.6512937545776367
Epoch: 56, Steps: 52 | Train Loss: 0.3921505 Vali Loss: 1.2877589 Test Loss: 0.3411315
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 57 cost time: 1.6514296531677246
Epoch: 57, Steps: 52 | Train Loss: 0.3926454 Vali Loss: 1.2816603 Test Loss: 0.3407227
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 58 cost time: 1.6553082466125488
Epoch: 58, Steps: 52 | Train Loss: 0.3920429 Vali Loss: 1.2924409 Test Loss: 0.3404680
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 59 cost time: 1.6736314296722412
Epoch: 59, Steps: 52 | Train Loss: 0.3927960 Vali Loss: 1.2702423 Test Loss: 0.3407867
Validation loss decreased (1.271544 --> 1.270242).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 60 cost time: 1.6500320434570312
Epoch: 60, Steps: 52 | Train Loss: 0.3918268 Vali Loss: 1.2910912 Test Loss: 0.3411919
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3407866656780243, mae:0.38965415954589844, rse:0.4782446324825287
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.0663003921508789 GB
Epoch: 1 cost time: 2.162383556365967
Epoch: 1, Steps: 52 | Train Loss: 0.6903414 Vali Loss: 2.1160078 Test Loss: 1.3600563
Validation loss decreased (inf --> 2.116008).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 2 cost time: 0.7618486881256104
Epoch: 2, Steps: 52 | Train Loss: 0.5382679 Vali Loss: 1.4305010 Test Loss: 0.4237384
Validation loss decreased (2.116008 --> 1.430501).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 3 cost time: 0.7749996185302734
Epoch: 3, Steps: 52 | Train Loss: 0.4385860 Vali Loss: 1.3672934 Test Loss: 0.3978884
Validation loss decreased (1.430501 --> 1.367293).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 4 cost time: 0.7663800716400146
Epoch: 4, Steps: 52 | Train Loss: 0.4214796 Vali Loss: 1.3506553 Test Loss: 0.3787995
Validation loss decreased (1.367293 --> 1.350655).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 5 cost time: 0.8213982582092285
Epoch: 5, Steps: 52 | Train Loss: 0.4162926 Vali Loss: 1.3360224 Test Loss: 0.3666967
Validation loss decreased (1.350655 --> 1.336022).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 6 cost time: 1.7013218402862549
Epoch: 6, Steps: 52 | Train Loss: 0.4116926 Vali Loss: 1.3247960 Test Loss: 0.3598943
Validation loss decreased (1.336022 --> 1.324796).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 7 cost time: 1.7153117656707764
Epoch: 7, Steps: 52 | Train Loss: 0.4068544 Vali Loss: 1.3142259 Test Loss: 0.3546611
Validation loss decreased (1.324796 --> 1.314226).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 8 cost time: 1.7164521217346191
Epoch: 8, Steps: 52 | Train Loss: 0.4037492 Vali Loss: 1.3160511 Test Loss: 0.3528971
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 9 cost time: 1.7138724327087402
Epoch: 9, Steps: 52 | Train Loss: 0.4021679 Vali Loss: 1.3078777 Test Loss: 0.3498352
Validation loss decreased (1.314226 --> 1.307878).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 10 cost time: 1.7198381423950195
Epoch: 10, Steps: 52 | Train Loss: 0.4024635 Vali Loss: 1.2993271 Test Loss: 0.3481719
Validation loss decreased (1.307878 --> 1.299327).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 11 cost time: 1.7207162380218506
Epoch: 11, Steps: 52 | Train Loss: 0.4004912 Vali Loss: 1.2989285 Test Loss: 0.3485690
Validation loss decreased (1.299327 --> 1.298928).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 12 cost time: 1.7241253852844238
Epoch: 12, Steps: 52 | Train Loss: 0.3993082 Vali Loss: 1.2939593 Test Loss: 0.3467036
Validation loss decreased (1.298928 --> 1.293959).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 13 cost time: 1.7231378555297852
Epoch: 13, Steps: 52 | Train Loss: 0.3971368 Vali Loss: 1.2870530 Test Loss: 0.3458097
Validation loss decreased (1.293959 --> 1.287053).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 14 cost time: 1.7256383895874023
Epoch: 14, Steps: 52 | Train Loss: 0.3954754 Vali Loss: 1.2947311 Test Loss: 0.3462504
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 15 cost time: 1.7252566814422607
Epoch: 15, Steps: 52 | Train Loss: 0.3970603 Vali Loss: 1.2913864 Test Loss: 0.3463396
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 16 cost time: 1.7119102478027344
Epoch: 16, Steps: 52 | Train Loss: 0.3961043 Vali Loss: 1.2852008 Test Loss: 0.3457873
Validation loss decreased (1.287053 --> 1.285201).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 17 cost time: 1.7231206893920898
Epoch: 17, Steps: 52 | Train Loss: 0.3954379 Vali Loss: 1.2808700 Test Loss: 0.3444684
Validation loss decreased (1.285201 --> 1.280870).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 18 cost time: 1.7186975479125977
Epoch: 18, Steps: 52 | Train Loss: 0.3954786 Vali Loss: 1.2885169 Test Loss: 0.3459955
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 19 cost time: 1.713327407836914
Epoch: 19, Steps: 52 | Train Loss: 0.3947707 Vali Loss: 1.2878766 Test Loss: 0.3460240
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 20 cost time: 1.7185561656951904
Epoch: 20, Steps: 52 | Train Loss: 0.3948642 Vali Loss: 1.2855155 Test Loss: 0.3451879
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 21 cost time: 1.7166216373443604
Epoch: 21, Steps: 52 | Train Loss: 0.3939376 Vali Loss: 1.2856872 Test Loss: 0.3445909
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 22 cost time: 1.7260160446166992
Epoch: 22, Steps: 52 | Train Loss: 0.3936761 Vali Loss: 1.2854306 Test Loss: 0.3450119
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 23 cost time: 1.7166240215301514
Epoch: 23, Steps: 52 | Train Loss: 0.3931304 Vali Loss: 1.2813799 Test Loss: 0.3454192
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 24 cost time: 1.721930742263794
Epoch: 24, Steps: 52 | Train Loss: 0.3943066 Vali Loss: 1.2718601 Test Loss: 0.3445165
Validation loss decreased (1.280870 --> 1.271860).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 25 cost time: 1.7153129577636719
Epoch: 25, Steps: 52 | Train Loss: 0.3940149 Vali Loss: 1.2815394 Test Loss: 0.3441911
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 26 cost time: 1.7230315208435059
Epoch: 26, Steps: 52 | Train Loss: 0.3925643 Vali Loss: 1.2876617 Test Loss: 0.3447722
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 27 cost time: 1.715573787689209
Epoch: 27, Steps: 52 | Train Loss: 0.3919385 Vali Loss: 1.2752439 Test Loss: 0.3447064
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 28 cost time: 1.7179923057556152
Epoch: 28, Steps: 52 | Train Loss: 0.3925452 Vali Loss: 1.2856556 Test Loss: 0.3445757
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 29 cost time: 1.714198350906372
Epoch: 29, Steps: 52 | Train Loss: 0.3926500 Vali Loss: 1.2836454 Test Loss: 0.3453952
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 30 cost time: 1.7175254821777344
Epoch: 30, Steps: 52 | Train Loss: 0.3924621 Vali Loss: 1.2820686 Test Loss: 0.3440883
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 31 cost time: 1.7216644287109375
Epoch: 31, Steps: 52 | Train Loss: 0.3934656 Vali Loss: 1.2766103 Test Loss: 0.3441879
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 32 cost time: 1.717369794845581
Epoch: 32, Steps: 52 | Train Loss: 0.3924886 Vali Loss: 1.2837163 Test Loss: 0.3449935
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 33 cost time: 1.713425874710083
Epoch: 33, Steps: 52 | Train Loss: 0.3926168 Vali Loss: 1.2808051 Test Loss: 0.3434623
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 34 cost time: 1.7171106338500977
Epoch: 34, Steps: 52 | Train Loss: 0.3919738 Vali Loss: 1.2796984 Test Loss: 0.3446560
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 35 cost time: 1.7244586944580078
Epoch: 35, Steps: 52 | Train Loss: 0.3925897 Vali Loss: 1.2741947 Test Loss: 0.3454747
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 36 cost time: 1.7154631614685059
Epoch: 36, Steps: 52 | Train Loss: 0.3926048 Vali Loss: 1.2857847 Test Loss: 0.3443482
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 37 cost time: 1.7177958488464355
Epoch: 37, Steps: 52 | Train Loss: 0.3925733 Vali Loss: 1.2789619 Test Loss: 0.3458330
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 38 cost time: 1.7160489559173584
Epoch: 38, Steps: 52 | Train Loss: 0.3924195 Vali Loss: 1.2813224 Test Loss: 0.3445601
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 39 cost time: 1.7200312614440918
Epoch: 39, Steps: 52 | Train Loss: 0.3921747 Vali Loss: 1.2756586 Test Loss: 0.3448145
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 40 cost time: 1.717470645904541
Epoch: 40, Steps: 52 | Train Loss: 0.3930409 Vali Loss: 1.2764442 Test Loss: 0.3440031
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 41 cost time: 1.718104362487793
Epoch: 41, Steps: 52 | Train Loss: 0.3914689 Vali Loss: 1.2814926 Test Loss: 0.3438994
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 42 cost time: 1.714909315109253
Epoch: 42, Steps: 52 | Train Loss: 0.3922819 Vali Loss: 1.2834510 Test Loss: 0.3442035
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 43 cost time: 1.7254376411437988
Epoch: 43, Steps: 52 | Train Loss: 0.3917648 Vali Loss: 1.2864503 Test Loss: 0.3447151
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 44 cost time: 1.7213020324707031
Epoch: 44, Steps: 52 | Train Loss: 0.3924460 Vali Loss: 1.2778587 Test Loss: 0.3437787
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 45 cost time: 1.7240543365478516
Epoch: 45, Steps: 52 | Train Loss: 0.3920096 Vali Loss: 1.2827187 Test Loss: 0.3444103
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 46 cost time: 1.716193675994873
Epoch: 46, Steps: 52 | Train Loss: 0.3917523 Vali Loss: 1.2735993 Test Loss: 0.3439721
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 47 cost time: 1.7158803939819336
Epoch: 47, Steps: 52 | Train Loss: 0.3911142 Vali Loss: 1.2783675 Test Loss: 0.3443871
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 48 cost time: 1.7158844470977783
Epoch: 48, Steps: 52 | Train Loss: 0.3915232 Vali Loss: 1.2873081 Test Loss: 0.3440818
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 49 cost time: 1.7202844619750977
Epoch: 49, Steps: 52 | Train Loss: 0.3907369 Vali Loss: 1.2823372 Test Loss: 0.3452281
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 50 cost time: 1.7248146533966064
Epoch: 50, Steps: 52 | Train Loss: 0.3926730 Vali Loss: 1.2717128 Test Loss: 0.3437654
Validation loss decreased (1.271860 --> 1.271713).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 51 cost time: 1.7201166152954102
Epoch: 51, Steps: 52 | Train Loss: 0.3911089 Vali Loss: 1.2866358 Test Loss: 0.3440260
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 52 cost time: 1.7206943035125732
Epoch: 52, Steps: 52 | Train Loss: 0.3910575 Vali Loss: 1.2769291 Test Loss: 0.3439537
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 53 cost time: 1.7178120613098145
Epoch: 53, Steps: 52 | Train Loss: 0.3922523 Vali Loss: 1.2855719 Test Loss: 0.3445913
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 54 cost time: 1.7221827507019043
Epoch: 54, Steps: 52 | Train Loss: 0.3923777 Vali Loss: 1.2880616 Test Loss: 0.3448722
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 55 cost time: 1.714163064956665
Epoch: 55, Steps: 52 | Train Loss: 0.3920736 Vali Loss: 1.2848200 Test Loss: 0.3443884
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 56 cost time: 1.7200126647949219
Epoch: 56, Steps: 52 | Train Loss: 0.3908172 Vali Loss: 1.2797370 Test Loss: 0.3460454
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 57 cost time: 1.7180778980255127
Epoch: 57, Steps: 52 | Train Loss: 0.3918471 Vali Loss: 1.2823169 Test Loss: 0.3444269
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 58 cost time: 1.718273401260376
Epoch: 58, Steps: 52 | Train Loss: 0.3915188 Vali Loss: 1.2789562 Test Loss: 0.3452907
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 59 cost time: 1.7183902263641357
Epoch: 59, Steps: 52 | Train Loss: 0.3908178 Vali Loss: 1.2856075 Test Loss: 0.3444627
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 60 cost time: 1.7246739864349365
Epoch: 60, Steps: 52 | Train Loss: 0.3909688 Vali Loss: 1.2750173 Test Loss: 0.3445137
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34376540780067444, mae:0.3937908113002777, rse:0.480330228805542
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06551265716552734 GB
Epoch: 1 cost time: 2.060971736907959
Epoch: 1, Steps: 52 | Train Loss: 0.7408278 Vali Loss: 2.1533124 Test Loss: 1.3708000
Validation loss decreased (inf --> 2.153312).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 2 cost time: 0.6807031631469727
Epoch: 2, Steps: 52 | Train Loss: 0.6611660 Vali Loss: 1.7468044 Test Loss: 0.9070160
Validation loss decreased (2.153312 --> 1.746804).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 3 cost time: 0.67799973487854
Epoch: 3, Steps: 52 | Train Loss: 0.5486068 Vali Loss: 1.5262489 Test Loss: 0.5857726
Validation loss decreased (1.746804 --> 1.526249).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 4 cost time: 0.6793675422668457
Epoch: 4, Steps: 52 | Train Loss: 0.4842225 Vali Loss: 1.4154425 Test Loss: 0.4457814
Validation loss decreased (1.526249 --> 1.415442).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 5 cost time: 0.6843469142913818
Epoch: 5, Steps: 52 | Train Loss: 0.4571864 Vali Loss: 1.3952605 Test Loss: 0.4123882
Validation loss decreased (1.415442 --> 1.395260).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 6 cost time: 1.0333895683288574
Epoch: 6, Steps: 52 | Train Loss: 0.4467587 Vali Loss: 1.3782045 Test Loss: 0.3947695
Validation loss decreased (1.395260 --> 1.378204).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 7 cost time: 1.536566972732544
Epoch: 7, Steps: 52 | Train Loss: 0.4363027 Vali Loss: 1.3595350 Test Loss: 0.3837759
Validation loss decreased (1.378204 --> 1.359535).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 8 cost time: 1.53277587890625
Epoch: 8, Steps: 52 | Train Loss: 0.4316114 Vali Loss: 1.3502723 Test Loss: 0.3766432
Validation loss decreased (1.359535 --> 1.350272).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 9 cost time: 1.5380995273590088
Epoch: 9, Steps: 52 | Train Loss: 0.4280328 Vali Loss: 1.3358809 Test Loss: 0.3715604
Validation loss decreased (1.350272 --> 1.335881).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 10 cost time: 1.535780668258667
Epoch: 10, Steps: 52 | Train Loss: 0.4226832 Vali Loss: 1.3306925 Test Loss: 0.3672900
Validation loss decreased (1.335881 --> 1.330693).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 11 cost time: 1.5402090549468994
Epoch: 11, Steps: 52 | Train Loss: 0.4224183 Vali Loss: 1.3289323 Test Loss: 0.3653622
Validation loss decreased (1.330693 --> 1.328932).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 12 cost time: 1.5340876579284668
Epoch: 12, Steps: 52 | Train Loss: 0.4178166 Vali Loss: 1.3256795 Test Loss: 0.3628902
Validation loss decreased (1.328932 --> 1.325680).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 13 cost time: 1.536733627319336
Epoch: 13, Steps: 52 | Train Loss: 0.4177954 Vali Loss: 1.3195475 Test Loss: 0.3614245
Validation loss decreased (1.325680 --> 1.319548).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 14 cost time: 1.5349509716033936
Epoch: 14, Steps: 52 | Train Loss: 0.4180838 Vali Loss: 1.3227401 Test Loss: 0.3604620
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 15 cost time: 1.5370502471923828
Epoch: 15, Steps: 52 | Train Loss: 0.4160123 Vali Loss: 1.3187385 Test Loss: 0.3593293
Validation loss decreased (1.319548 --> 1.318738).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 16 cost time: 1.5357420444488525
Epoch: 16, Steps: 52 | Train Loss: 0.4139078 Vali Loss: 1.3105267 Test Loss: 0.3579507
Validation loss decreased (1.318738 --> 1.310527).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 17 cost time: 1.541546106338501
Epoch: 17, Steps: 52 | Train Loss: 0.4131877 Vali Loss: 1.3111751 Test Loss: 0.3574958
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 18 cost time: 1.5371875762939453
Epoch: 18, Steps: 52 | Train Loss: 0.4126397 Vali Loss: 1.3088337 Test Loss: 0.3569048
Validation loss decreased (1.310527 --> 1.308834).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 19 cost time: 1.5356016159057617
Epoch: 19, Steps: 52 | Train Loss: 0.4125693 Vali Loss: 1.3045030 Test Loss: 0.3550958
Validation loss decreased (1.308834 --> 1.304503).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 20 cost time: 1.5281362533569336
Epoch: 20, Steps: 52 | Train Loss: 0.4109201 Vali Loss: 1.3034378 Test Loss: 0.3550309
Validation loss decreased (1.304503 --> 1.303438).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 21 cost time: 1.5416364669799805
Epoch: 21, Steps: 52 | Train Loss: 0.4120190 Vali Loss: 1.3068281 Test Loss: 0.3552613
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 22 cost time: 1.5344626903533936
Epoch: 22, Steps: 52 | Train Loss: 0.4099277 Vali Loss: 1.3069696 Test Loss: 0.3542852
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 23 cost time: 1.5350487232208252
Epoch: 23, Steps: 52 | Train Loss: 0.4095370 Vali Loss: 1.3042276 Test Loss: 0.3542286
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 24 cost time: 1.5314960479736328
Epoch: 24, Steps: 52 | Train Loss: 0.4081840 Vali Loss: 1.2926633 Test Loss: 0.3542339
Validation loss decreased (1.303438 --> 1.292663).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 25 cost time: 1.5342085361480713
Epoch: 25, Steps: 52 | Train Loss: 0.4079572 Vali Loss: 1.2984335 Test Loss: 0.3535556
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 26 cost time: 1.5359840393066406
Epoch: 26, Steps: 52 | Train Loss: 0.4078520 Vali Loss: 1.3058476 Test Loss: 0.3526962
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 27 cost time: 1.533625841140747
Epoch: 27, Steps: 52 | Train Loss: 0.4077882 Vali Loss: 1.3004981 Test Loss: 0.3517131
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 28 cost time: 1.539250373840332
Epoch: 28, Steps: 52 | Train Loss: 0.4076928 Vali Loss: 1.2987359 Test Loss: 0.3531049
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 29 cost time: 1.536264181137085
Epoch: 29, Steps: 52 | Train Loss: 0.4091006 Vali Loss: 1.3050174 Test Loss: 0.3517897
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 30 cost time: 1.5388524532318115
Epoch: 30, Steps: 52 | Train Loss: 0.4082782 Vali Loss: 1.2954838 Test Loss: 0.3516729
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 31 cost time: 1.5330572128295898
Epoch: 31, Steps: 52 | Train Loss: 0.4045066 Vali Loss: 1.2982500 Test Loss: 0.3520513
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 32 cost time: 1.53202223777771
Epoch: 32, Steps: 52 | Train Loss: 0.4057196 Vali Loss: 1.2951913 Test Loss: 0.3519373
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 33 cost time: 1.5330233573913574
Epoch: 33, Steps: 52 | Train Loss: 0.4071179 Vali Loss: 1.2988698 Test Loss: 0.3513620
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 34 cost time: 1.531426191329956
Epoch: 34, Steps: 52 | Train Loss: 0.4064149 Vali Loss: 1.2960038 Test Loss: 0.3514645
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 35 cost time: 1.5274677276611328
Epoch: 35, Steps: 52 | Train Loss: 0.4052301 Vali Loss: 1.3038526 Test Loss: 0.3516201
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 36 cost time: 1.5314605236053467
Epoch: 36, Steps: 52 | Train Loss: 0.4056654 Vali Loss: 1.2888178 Test Loss: 0.3516295
Validation loss decreased (1.292663 --> 1.288818).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 37 cost time: 1.5289885997772217
Epoch: 37, Steps: 52 | Train Loss: 0.4064713 Vali Loss: 1.2922896 Test Loss: 0.3517204
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 38 cost time: 1.5341753959655762
Epoch: 38, Steps: 52 | Train Loss: 0.4073455 Vali Loss: 1.3010834 Test Loss: 0.3516286
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 39 cost time: 1.527414321899414
Epoch: 39, Steps: 52 | Train Loss: 0.4052035 Vali Loss: 1.3009386 Test Loss: 0.3512441
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 40 cost time: 1.5325653553009033
Epoch: 40, Steps: 52 | Train Loss: 0.4071210 Vali Loss: 1.2963943 Test Loss: 0.3521093
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 41 cost time: 1.5336737632751465
Epoch: 41, Steps: 52 | Train Loss: 0.4057964 Vali Loss: 1.2881603 Test Loss: 0.3521780
Validation loss decreased (1.288818 --> 1.288160).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 42 cost time: 1.536482334136963
Epoch: 42, Steps: 52 | Train Loss: 0.4047537 Vali Loss: 1.2970350 Test Loss: 0.3516278
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 43 cost time: 1.5384507179260254
Epoch: 43, Steps: 52 | Train Loss: 0.4062814 Vali Loss: 1.2894779 Test Loss: 0.3510305
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 44 cost time: 1.5338587760925293
Epoch: 44, Steps: 52 | Train Loss: 0.4068244 Vali Loss: 1.2949593 Test Loss: 0.3528283
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 45 cost time: 1.5403597354888916
Epoch: 45, Steps: 52 | Train Loss: 0.4053648 Vali Loss: 1.3011694 Test Loss: 0.3510885
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 46 cost time: 1.5325126647949219
Epoch: 46, Steps: 52 | Train Loss: 0.4067797 Vali Loss: 1.2978499 Test Loss: 0.3516854
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 47 cost time: 1.5351202487945557
Epoch: 47, Steps: 52 | Train Loss: 0.4061081 Vali Loss: 1.2993002 Test Loss: 0.3509087
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 48 cost time: 1.5331175327301025
Epoch: 48, Steps: 52 | Train Loss: 0.4063488 Vali Loss: 1.2961543 Test Loss: 0.3513389
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 49 cost time: 1.5349414348602295
Epoch: 49, Steps: 52 | Train Loss: 0.4079238 Vali Loss: 1.2938287 Test Loss: 0.3508832
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 50 cost time: 1.5329203605651855
Epoch: 50, Steps: 52 | Train Loss: 0.4068979 Vali Loss: 1.2954202 Test Loss: 0.3508466
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 51 cost time: 1.5312347412109375
Epoch: 51, Steps: 52 | Train Loss: 0.4047706 Vali Loss: 1.2938292 Test Loss: 0.3506927
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 52 cost time: 1.53411865234375
Epoch: 52, Steps: 52 | Train Loss: 0.4052527 Vali Loss: 1.2957623 Test Loss: 0.3505011
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 53 cost time: 1.5400042533874512
Epoch: 53, Steps: 52 | Train Loss: 0.4063140 Vali Loss: 1.2909914 Test Loss: 0.3508225
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 54 cost time: 1.537015438079834
Epoch: 54, Steps: 52 | Train Loss: 0.4061808 Vali Loss: 1.2939699 Test Loss: 0.3512216
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 55 cost time: 1.5339365005493164
Epoch: 55, Steps: 52 | Train Loss: 0.4048772 Vali Loss: 1.2914077 Test Loss: 0.3513867
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 56 cost time: 1.5383636951446533
Epoch: 56, Steps: 52 | Train Loss: 0.4034210 Vali Loss: 1.2917047 Test Loss: 0.3506125
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 57 cost time: 1.5398893356323242
Epoch: 57, Steps: 52 | Train Loss: 0.4040010 Vali Loss: 1.3008657 Test Loss: 0.3506058
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 58 cost time: 1.5350849628448486
Epoch: 58, Steps: 52 | Train Loss: 0.4057883 Vali Loss: 1.2957447 Test Loss: 0.3501236
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 59 cost time: 1.5322294235229492
Epoch: 59, Steps: 52 | Train Loss: 0.4069265 Vali Loss: 1.2851424 Test Loss: 0.3496287
Validation loss decreased (1.288160 --> 1.285142).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 60 cost time: 1.534379005432129
Epoch: 60, Steps: 52 | Train Loss: 0.4048076 Vali Loss: 1.2992191 Test Loss: 0.3512060
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3496286869049072, mae:0.4002560079097748, rse:0.4844091832637787
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.06978511810302734 GB
Epoch: 1 cost time: 2.1256103515625
Epoch: 1, Steps: 52 | Train Loss: 0.7106828 Vali Loss: 2.1674581 Test Loss: 1.3671609
Validation loss decreased (inf --> 2.167458).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 2 cost time: 0.732234001159668
Epoch: 2, Steps: 52 | Train Loss: 0.5696533 Vali Loss: 1.4849877 Test Loss: 0.5074081
Validation loss decreased (2.167458 --> 1.484988).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 3 cost time: 0.7136185169219971
Epoch: 3, Steps: 52 | Train Loss: 0.4520563 Vali Loss: 1.3894238 Test Loss: 0.4093630
Validation loss decreased (1.484988 --> 1.389424).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 4 cost time: 0.706343412399292
Epoch: 4, Steps: 52 | Train Loss: 0.4297296 Vali Loss: 1.3663844 Test Loss: 0.3851319
Validation loss decreased (1.389424 --> 1.366384).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 5 cost time: 0.7326123714447021
Epoch: 5, Steps: 52 | Train Loss: 0.4215132 Vali Loss: 1.3423085 Test Loss: 0.3745196
Validation loss decreased (1.366384 --> 1.342309).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 6 cost time: 1.419053077697754
Epoch: 6, Steps: 52 | Train Loss: 0.4160157 Vali Loss: 1.3259444 Test Loss: 0.3668586
Validation loss decreased (1.342309 --> 1.325944).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 7 cost time: 1.5870046615600586
Epoch: 7, Steps: 52 | Train Loss: 0.4129787 Vali Loss: 1.3155886 Test Loss: 0.3622649
Validation loss decreased (1.325944 --> 1.315589).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 8 cost time: 1.5956509113311768
Epoch: 8, Steps: 52 | Train Loss: 0.4108632 Vali Loss: 1.3212762 Test Loss: 0.3609404
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 9 cost time: 1.5926411151885986
Epoch: 9, Steps: 52 | Train Loss: 0.4074397 Vali Loss: 1.3062875 Test Loss: 0.3577237
Validation loss decreased (1.315589 --> 1.306288).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 10 cost time: 1.6018664836883545
Epoch: 10, Steps: 52 | Train Loss: 0.4041774 Vali Loss: 1.3063076 Test Loss: 0.3548774
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 11 cost time: 1.5939412117004395
Epoch: 11, Steps: 52 | Train Loss: 0.4037457 Vali Loss: 1.3071711 Test Loss: 0.3544018
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 12 cost time: 1.600332260131836
Epoch: 12, Steps: 52 | Train Loss: 0.4032598 Vali Loss: 1.3032254 Test Loss: 0.3536401
Validation loss decreased (1.306288 --> 1.303225).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 13 cost time: 1.5989468097686768
Epoch: 13, Steps: 52 | Train Loss: 0.4012810 Vali Loss: 1.3019683 Test Loss: 0.3512134
Validation loss decreased (1.303225 --> 1.301968).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 14 cost time: 1.598555326461792
Epoch: 14, Steps: 52 | Train Loss: 0.4020275 Vali Loss: 1.2937022 Test Loss: 0.3517117
Validation loss decreased (1.301968 --> 1.293702).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 15 cost time: 1.5961956977844238
Epoch: 15, Steps: 52 | Train Loss: 0.3999405 Vali Loss: 1.2968972 Test Loss: 0.3517076
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 16 cost time: 1.6011886596679688
Epoch: 16, Steps: 52 | Train Loss: 0.3982787 Vali Loss: 1.2921329 Test Loss: 0.3510216
Validation loss decreased (1.293702 --> 1.292133).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 17 cost time: 1.5990300178527832
Epoch: 17, Steps: 52 | Train Loss: 0.3995249 Vali Loss: 1.2907072 Test Loss: 0.3514395
Validation loss decreased (1.292133 --> 1.290707).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 18 cost time: 1.601426124572754
Epoch: 18, Steps: 52 | Train Loss: 0.3974079 Vali Loss: 1.2876140 Test Loss: 0.3506070
Validation loss decreased (1.290707 --> 1.287614).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 19 cost time: 1.5954976081848145
Epoch: 19, Steps: 52 | Train Loss: 0.3976514 Vali Loss: 1.2910796 Test Loss: 0.3510495
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 20 cost time: 1.600409984588623
Epoch: 20, Steps: 52 | Train Loss: 0.3967625 Vali Loss: 1.2920834 Test Loss: 0.3507639
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 21 cost time: 1.594834804534912
Epoch: 21, Steps: 52 | Train Loss: 0.3978333 Vali Loss: 1.2981294 Test Loss: 0.3485841
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 22 cost time: 1.5963969230651855
Epoch: 22, Steps: 52 | Train Loss: 0.3952734 Vali Loss: 1.2891691 Test Loss: 0.3501929
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 23 cost time: 1.5969974994659424
Epoch: 23, Steps: 52 | Train Loss: 0.3953537 Vali Loss: 1.2909534 Test Loss: 0.3481734
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 24 cost time: 1.5909979343414307
Epoch: 24, Steps: 52 | Train Loss: 0.3948317 Vali Loss: 1.2856646 Test Loss: 0.3493295
Validation loss decreased (1.287614 --> 1.285665).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 25 cost time: 1.5991315841674805
Epoch: 25, Steps: 52 | Train Loss: 0.3949818 Vali Loss: 1.2870090 Test Loss: 0.3486982
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 26 cost time: 1.5905234813690186
Epoch: 26, Steps: 52 | Train Loss: 0.3938741 Vali Loss: 1.2910198 Test Loss: 0.3499404
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 27 cost time: 1.5884425640106201
Epoch: 27, Steps: 52 | Train Loss: 0.3952388 Vali Loss: 1.2727926 Test Loss: 0.3478986
Validation loss decreased (1.285665 --> 1.272793).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 28 cost time: 1.5882067680358887
Epoch: 28, Steps: 52 | Train Loss: 0.3946473 Vali Loss: 1.2911215 Test Loss: 0.3482950
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 29 cost time: 1.5944194793701172
Epoch: 29, Steps: 52 | Train Loss: 0.3945247 Vali Loss: 1.2826408 Test Loss: 0.3484824
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 30 cost time: 1.5969274044036865
Epoch: 30, Steps: 52 | Train Loss: 0.3942524 Vali Loss: 1.2950521 Test Loss: 0.3496436
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 31 cost time: 1.5936830043792725
Epoch: 31, Steps: 52 | Train Loss: 0.3949008 Vali Loss: 1.2899796 Test Loss: 0.3480210
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 32 cost time: 1.5974483489990234
Epoch: 32, Steps: 52 | Train Loss: 0.3949473 Vali Loss: 1.2906425 Test Loss: 0.3494892
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 33 cost time: 1.5944790840148926
Epoch: 33, Steps: 52 | Train Loss: 0.3937282 Vali Loss: 1.2899382 Test Loss: 0.3495321
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 34 cost time: 1.589353084564209
Epoch: 34, Steps: 52 | Train Loss: 0.3943493 Vali Loss: 1.2928724 Test Loss: 0.3482602
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 35 cost time: 1.5945909023284912
Epoch: 35, Steps: 52 | Train Loss: 0.3935053 Vali Loss: 1.2923524 Test Loss: 0.3481581
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 36 cost time: 1.5886435508728027
Epoch: 36, Steps: 52 | Train Loss: 0.3940001 Vali Loss: 1.2901289 Test Loss: 0.3485626
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 37 cost time: 1.5935204029083252
Epoch: 37, Steps: 52 | Train Loss: 0.3930679 Vali Loss: 1.2850199 Test Loss: 0.3485657
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 38 cost time: 1.5946381092071533
Epoch: 38, Steps: 52 | Train Loss: 0.3935448 Vali Loss: 1.2821978 Test Loss: 0.3485397
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 39 cost time: 1.600525140762329
Epoch: 39, Steps: 52 | Train Loss: 0.3942172 Vali Loss: 1.2931159 Test Loss: 0.3480001
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 40 cost time: 1.5962355136871338
Epoch: 40, Steps: 52 | Train Loss: 0.3935983 Vali Loss: 1.2938522 Test Loss: 0.3487009
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 41 cost time: 1.5994782447814941
Epoch: 41, Steps: 52 | Train Loss: 0.3925887 Vali Loss: 1.2872976 Test Loss: 0.3471838
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 42 cost time: 1.5959506034851074
Epoch: 42, Steps: 52 | Train Loss: 0.3935658 Vali Loss: 1.2828211 Test Loss: 0.3483504
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 43 cost time: 1.5964395999908447
Epoch: 43, Steps: 52 | Train Loss: 0.3925901 Vali Loss: 1.2928027 Test Loss: 0.3485406
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 44 cost time: 1.5944390296936035
Epoch: 44, Steps: 52 | Train Loss: 0.3932071 Vali Loss: 1.2820730 Test Loss: 0.3486268
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 45 cost time: 1.600283145904541
Epoch: 45, Steps: 52 | Train Loss: 0.3941269 Vali Loss: 1.2905096 Test Loss: 0.3479125
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 46 cost time: 1.5962419509887695
Epoch: 46, Steps: 52 | Train Loss: 0.3929766 Vali Loss: 1.2871525 Test Loss: 0.3489825
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 47 cost time: 1.5956530570983887
Epoch: 47, Steps: 52 | Train Loss: 0.3946723 Vali Loss: 1.2872169 Test Loss: 0.3479598
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 48 cost time: 1.5931570529937744
Epoch: 48, Steps: 52 | Train Loss: 0.3944327 Vali Loss: 1.2890621 Test Loss: 0.3474641
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 49 cost time: 1.6023962497711182
Epoch: 49, Steps: 52 | Train Loss: 0.3939231 Vali Loss: 1.2875259 Test Loss: 0.3480247
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 50 cost time: 1.5965509414672852
Epoch: 50, Steps: 52 | Train Loss: 0.3928970 Vali Loss: 1.2884704 Test Loss: 0.3477982
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 51 cost time: 1.5965304374694824
Epoch: 51, Steps: 52 | Train Loss: 0.3937572 Vali Loss: 1.2862545 Test Loss: 0.3476745
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 52 cost time: 1.5944643020629883
Epoch: 52, Steps: 52 | Train Loss: 0.3930385 Vali Loss: 1.2878939 Test Loss: 0.3478836
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 53 cost time: 1.5980348587036133
Epoch: 53, Steps: 52 | Train Loss: 0.3925601 Vali Loss: 1.2870083 Test Loss: 0.3480281
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 54 cost time: 1.5956873893737793
Epoch: 54, Steps: 52 | Train Loss: 0.3932645 Vali Loss: 1.2886078 Test Loss: 0.3482097
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 55 cost time: 1.5974230766296387
Epoch: 55, Steps: 52 | Train Loss: 0.3915272 Vali Loss: 1.2894813 Test Loss: 0.3485035
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 56 cost time: 1.5944554805755615
Epoch: 56, Steps: 52 | Train Loss: 0.3943652 Vali Loss: 1.2904496 Test Loss: 0.3471723
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 57 cost time: 1.5951590538024902
Epoch: 57, Steps: 52 | Train Loss: 0.3945186 Vali Loss: 1.2852589 Test Loss: 0.3478246
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 58 cost time: 1.5954639911651611
Epoch: 58, Steps: 52 | Train Loss: 0.3928096 Vali Loss: 1.2883511 Test Loss: 0.3485931
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 59 cost time: 1.6012861728668213
Epoch: 59, Steps: 52 | Train Loss: 0.3909534 Vali Loss: 1.2853241 Test Loss: 0.3477024
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 60 cost time: 1.5987493991851807
Epoch: 60, Steps: 52 | Train Loss: 0.3933316 Vali Loss: 1.2901845 Test Loss: 0.3480212
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34789860248565674, mae:0.3970669209957123, rse:0.48320913314819336
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.07290077209472656 GB
Epoch: 1 cost time: 2.168118476867676
Epoch: 1, Steps: 52 | Train Loss: 0.6828550 Vali Loss: 2.1134844 Test Loss: 1.3371894
Validation loss decreased (inf --> 2.113484).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 2 cost time: 0.7481424808502197
Epoch: 2, Steps: 52 | Train Loss: 0.5486801 Vali Loss: 1.4438207 Test Loss: 0.4480410
Validation loss decreased (2.113484 --> 1.443821).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 3 cost time: 0.751570463180542
Epoch: 3, Steps: 52 | Train Loss: 0.4401449 Vali Loss: 1.3663200 Test Loss: 0.3934102
Validation loss decreased (1.443821 --> 1.366320).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 4 cost time: 0.7459995746612549
Epoch: 4, Steps: 52 | Train Loss: 0.4249899 Vali Loss: 1.3413634 Test Loss: 0.3753166
Validation loss decreased (1.366320 --> 1.341363).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 5 cost time: 0.7533056735992432
Epoch: 5, Steps: 52 | Train Loss: 0.4165884 Vali Loss: 1.3220984 Test Loss: 0.3653237
Validation loss decreased (1.341363 --> 1.322098).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 6 cost time: 1.6421449184417725
Epoch: 6, Steps: 52 | Train Loss: 0.4115118 Vali Loss: 1.3238251 Test Loss: 0.3608842
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 7 cost time: 1.6479735374450684
Epoch: 7, Steps: 52 | Train Loss: 0.4092182 Vali Loss: 1.3205173 Test Loss: 0.3577806
Validation loss decreased (1.322098 --> 1.320517).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 8 cost time: 1.658236026763916
Epoch: 8, Steps: 52 | Train Loss: 0.4053005 Vali Loss: 1.3058946 Test Loss: 0.3551919
Validation loss decreased (1.320517 --> 1.305895).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 9 cost time: 1.6537730693817139
Epoch: 9, Steps: 52 | Train Loss: 0.4039164 Vali Loss: 1.3067745 Test Loss: 0.3551423
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 10 cost time: 1.6568570137023926
Epoch: 10, Steps: 52 | Train Loss: 0.4031588 Vali Loss: 1.2904592 Test Loss: 0.3527158
Validation loss decreased (1.305895 --> 1.290459).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 11 cost time: 1.6598842144012451
Epoch: 11, Steps: 52 | Train Loss: 0.4014697 Vali Loss: 1.3050733 Test Loss: 0.3524239
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 12 cost time: 1.6533253192901611
Epoch: 12, Steps: 52 | Train Loss: 0.4003439 Vali Loss: 1.2834053 Test Loss: 0.3533797
Validation loss decreased (1.290459 --> 1.283405).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 13 cost time: 1.6563377380371094
Epoch: 13, Steps: 52 | Train Loss: 0.3988950 Vali Loss: 1.2878907 Test Loss: 0.3515400
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 14 cost time: 1.6579976081848145
Epoch: 14, Steps: 52 | Train Loss: 0.3984798 Vali Loss: 1.2953554 Test Loss: 0.3502455
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 15 cost time: 1.6546123027801514
Epoch: 15, Steps: 52 | Train Loss: 0.3980506 Vali Loss: 1.2879332 Test Loss: 0.3496757
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 16 cost time: 1.6519758701324463
Epoch: 16, Steps: 52 | Train Loss: 0.3969050 Vali Loss: 1.2910928 Test Loss: 0.3486681
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 17 cost time: 1.6541755199432373
Epoch: 17, Steps: 52 | Train Loss: 0.3957707 Vali Loss: 1.2899947 Test Loss: 0.3490565
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 18 cost time: 1.6529908180236816
Epoch: 18, Steps: 52 | Train Loss: 0.3958332 Vali Loss: 1.2953334 Test Loss: 0.3482609
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 19 cost time: 1.6599600315093994
Epoch: 19, Steps: 52 | Train Loss: 0.3955081 Vali Loss: 1.2941759 Test Loss: 0.3495501
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 20 cost time: 1.654271125793457
Epoch: 20, Steps: 52 | Train Loss: 0.3949723 Vali Loss: 1.2901679 Test Loss: 0.3481621
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 21 cost time: 1.6618483066558838
Epoch: 21, Steps: 52 | Train Loss: 0.3947359 Vali Loss: 1.2910718 Test Loss: 0.3490226
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 22 cost time: 1.656794786453247
Epoch: 22, Steps: 52 | Train Loss: 0.3935572 Vali Loss: 1.2839322 Test Loss: 0.3473788
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 23 cost time: 1.657705307006836
Epoch: 23, Steps: 52 | Train Loss: 0.3939964 Vali Loss: 1.2892441 Test Loss: 0.3489872
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 24 cost time: 1.666473627090454
Epoch: 24, Steps: 52 | Train Loss: 0.3942736 Vali Loss: 1.2916948 Test Loss: 0.3479536
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 25 cost time: 1.6583950519561768
Epoch: 25, Steps: 52 | Train Loss: 0.3921632 Vali Loss: 1.2911520 Test Loss: 0.3485286
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 26 cost time: 1.6540169715881348
Epoch: 26, Steps: 52 | Train Loss: 0.3938430 Vali Loss: 1.2877772 Test Loss: 0.3478450
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 27 cost time: 1.6596269607543945
Epoch: 27, Steps: 52 | Train Loss: 0.3918637 Vali Loss: 1.2890686 Test Loss: 0.3472187
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 28 cost time: 1.6575677394866943
Epoch: 28, Steps: 52 | Train Loss: 0.3937200 Vali Loss: 1.2905718 Test Loss: 0.3474324
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 29 cost time: 1.6599996089935303
Epoch: 29, Steps: 52 | Train Loss: 0.3938400 Vali Loss: 1.2708547 Test Loss: 0.3478768
Validation loss decreased (1.283405 --> 1.270855).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 30 cost time: 1.6583447456359863
Epoch: 30, Steps: 52 | Train Loss: 0.3926198 Vali Loss: 1.2844381 Test Loss: 0.3473309
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 31 cost time: 1.661142349243164
Epoch: 31, Steps: 52 | Train Loss: 0.3929725 Vali Loss: 1.2860428 Test Loss: 0.3479193
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 32 cost time: 1.6518347263336182
Epoch: 32, Steps: 52 | Train Loss: 0.3919174 Vali Loss: 1.2853029 Test Loss: 0.3478872
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 33 cost time: 1.6503145694732666
Epoch: 33, Steps: 52 | Train Loss: 0.3920032 Vali Loss: 1.2837878 Test Loss: 0.3468510
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 34 cost time: 1.6567587852478027
Epoch: 34, Steps: 52 | Train Loss: 0.3914334 Vali Loss: 1.2877121 Test Loss: 0.3475619
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 35 cost time: 1.6526272296905518
Epoch: 35, Steps: 52 | Train Loss: 0.3928490 Vali Loss: 1.2888215 Test Loss: 0.3469958
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 36 cost time: 1.65861177444458
Epoch: 36, Steps: 52 | Train Loss: 0.3927627 Vali Loss: 1.2785897 Test Loss: 0.3469048
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 37 cost time: 1.6552870273590088
Epoch: 37, Steps: 52 | Train Loss: 0.3918306 Vali Loss: 1.2837398 Test Loss: 0.3483632
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 38 cost time: 1.6602318286895752
Epoch: 38, Steps: 52 | Train Loss: 0.3924139 Vali Loss: 1.2887399 Test Loss: 0.3481067
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 39 cost time: 1.6628000736236572
Epoch: 39, Steps: 52 | Train Loss: 0.3920705 Vali Loss: 1.2794509 Test Loss: 0.3473316
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 40 cost time: 1.6525819301605225
Epoch: 40, Steps: 52 | Train Loss: 0.3917636 Vali Loss: 1.2911257 Test Loss: 0.3476987
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 41 cost time: 1.6550571918487549
Epoch: 41, Steps: 52 | Train Loss: 0.3912967 Vali Loss: 1.2892214 Test Loss: 0.3483471
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 42 cost time: 1.659461259841919
Epoch: 42, Steps: 52 | Train Loss: 0.3929433 Vali Loss: 1.2845482 Test Loss: 0.3469471
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 43 cost time: 1.6594831943511963
Epoch: 43, Steps: 52 | Train Loss: 0.3926651 Vali Loss: 1.2890174 Test Loss: 0.3481883
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 44 cost time: 1.6558117866516113
Epoch: 44, Steps: 52 | Train Loss: 0.3913371 Vali Loss: 1.2888457 Test Loss: 0.3479412
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 45 cost time: 1.653210163116455
Epoch: 45, Steps: 52 | Train Loss: 0.3903637 Vali Loss: 1.2903843 Test Loss: 0.3478421
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 46 cost time: 1.6529834270477295
Epoch: 46, Steps: 52 | Train Loss: 0.3930185 Vali Loss: 1.2845000 Test Loss: 0.3470782
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 47 cost time: 1.6606314182281494
Epoch: 47, Steps: 52 | Train Loss: 0.3910025 Vali Loss: 1.2833600 Test Loss: 0.3484905
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 48 cost time: 1.654409408569336
Epoch: 48, Steps: 52 | Train Loss: 0.3917616 Vali Loss: 1.2862242 Test Loss: 0.3469880
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 49 cost time: 1.6584563255310059
Epoch: 49, Steps: 52 | Train Loss: 0.3918764 Vali Loss: 1.2825366 Test Loss: 0.3478920
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 50 cost time: 1.6520640850067139
Epoch: 50, Steps: 52 | Train Loss: 0.3916067 Vali Loss: 1.2837229 Test Loss: 0.3483662
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 51 cost time: 1.6594035625457764
Epoch: 51, Steps: 52 | Train Loss: 0.3912983 Vali Loss: 1.2875072 Test Loss: 0.3479034
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 52 cost time: 1.659090280532837
Epoch: 52, Steps: 52 | Train Loss: 0.3908050 Vali Loss: 1.2767112 Test Loss: 0.3471093
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 53 cost time: 1.6601924896240234
Epoch: 53, Steps: 52 | Train Loss: 0.3903609 Vali Loss: 1.2789018 Test Loss: 0.3476677
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 54 cost time: 1.6562848091125488
Epoch: 54, Steps: 52 | Train Loss: 0.3906100 Vali Loss: 1.2872423 Test Loss: 0.3477004
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 55 cost time: 1.6547818183898926
Epoch: 55, Steps: 52 | Train Loss: 0.3911624 Vali Loss: 1.2843621 Test Loss: 0.3473437
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 56 cost time: 1.650996208190918
Epoch: 56, Steps: 52 | Train Loss: 0.3932931 Vali Loss: 1.2817814 Test Loss: 0.3477531
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 57 cost time: 1.6577107906341553
Epoch: 57, Steps: 52 | Train Loss: 0.3916455 Vali Loss: 1.2894742 Test Loss: 0.3478867
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 58 cost time: 1.651731252670288
Epoch: 58, Steps: 52 | Train Loss: 0.3923699 Vali Loss: 1.2891221 Test Loss: 0.3475405
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 59 cost time: 1.6594164371490479
Epoch: 59, Steps: 52 | Train Loss: 0.3919203 Vali Loss: 1.2849877 Test Loss: 0.3487185
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 60 cost time: 1.651198148727417
Epoch: 60, Steps: 52 | Train Loss: 0.3904756 Vali Loss: 1.2834983 Test Loss: 0.3475775
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3478768765926361, mae:0.39734336733818054, rse:0.4831940233707428
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.0656743049621582 GB
Epoch: 1 cost time: 2.1013569831848145
Epoch: 1, Steps: 52 | Train Loss: 0.7318519 Vali Loss: 2.1226325 Test Loss: 1.3454293
Validation loss decreased (inf --> 2.122633).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 2 cost time: 0.7076032161712646
Epoch: 2, Steps: 52 | Train Loss: 0.6385075 Vali Loss: 1.6860042 Test Loss: 0.8038251
Validation loss decreased (2.122633 --> 1.686004).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 3 cost time: 0.7056303024291992
Epoch: 3, Steps: 52 | Train Loss: 0.5263070 Vali Loss: 1.4977632 Test Loss: 0.5360954
Validation loss decreased (1.686004 --> 1.497763).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 4 cost time: 0.7123377323150635
Epoch: 4, Steps: 52 | Train Loss: 0.4741324 Vali Loss: 1.4280047 Test Loss: 0.4386356
Validation loss decreased (1.497763 --> 1.428005).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 5 cost time: 0.7001826763153076
Epoch: 5, Steps: 52 | Train Loss: 0.4509995 Vali Loss: 1.3890195 Test Loss: 0.4029041
Validation loss decreased (1.428005 --> 1.389019).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 6 cost time: 1.250791072845459
Epoch: 6, Steps: 52 | Train Loss: 0.4389394 Vali Loss: 1.3747785 Test Loss: 0.3827589
Validation loss decreased (1.389019 --> 1.374779).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 7 cost time: 1.5574326515197754
Epoch: 7, Steps: 52 | Train Loss: 0.4352684 Vali Loss: 1.3475668 Test Loss: 0.3711001
Validation loss decreased (1.374779 --> 1.347567).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 8 cost time: 1.5550289154052734
Epoch: 8, Steps: 52 | Train Loss: 0.4281853 Vali Loss: 1.3379245 Test Loss: 0.3634008
Validation loss decreased (1.347567 --> 1.337924).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 9 cost time: 1.5579543113708496
Epoch: 9, Steps: 52 | Train Loss: 0.4234604 Vali Loss: 1.3337052 Test Loss: 0.3584930
Validation loss decreased (1.337924 --> 1.333705).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 10 cost time: 1.5532565116882324
Epoch: 10, Steps: 52 | Train Loss: 0.4214326 Vali Loss: 1.3247864 Test Loss: 0.3551046
Validation loss decreased (1.333705 --> 1.324786).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 11 cost time: 1.5570766925811768
Epoch: 11, Steps: 52 | Train Loss: 0.4176603 Vali Loss: 1.3272388 Test Loss: 0.3518443
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 12 cost time: 1.5545923709869385
Epoch: 12, Steps: 52 | Train Loss: 0.4152306 Vali Loss: 1.3205693 Test Loss: 0.3495550
Validation loss decreased (1.324786 --> 1.320569).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 13 cost time: 1.5555839538574219
Epoch: 13, Steps: 52 | Train Loss: 0.4146612 Vali Loss: 1.3108857 Test Loss: 0.3489931
Validation loss decreased (1.320569 --> 1.310886).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 14 cost time: 1.5544252395629883
Epoch: 14, Steps: 52 | Train Loss: 0.4130274 Vali Loss: 1.3127980 Test Loss: 0.3477031
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 15 cost time: 1.550374984741211
Epoch: 15, Steps: 52 | Train Loss: 0.4118827 Vali Loss: 1.3039061 Test Loss: 0.3462515
Validation loss decreased (1.310886 --> 1.303906).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 16 cost time: 1.5528953075408936
Epoch: 16, Steps: 52 | Train Loss: 0.4111352 Vali Loss: 1.2982566 Test Loss: 0.3450994
Validation loss decreased (1.303906 --> 1.298257).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 17 cost time: 1.5521903038024902
Epoch: 17, Steps: 52 | Train Loss: 0.4082416 Vali Loss: 1.3055496 Test Loss: 0.3447721
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 18 cost time: 1.5526692867279053
Epoch: 18, Steps: 52 | Train Loss: 0.4058627 Vali Loss: 1.3085418 Test Loss: 0.3440340
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 19 cost time: 1.55055832862854
Epoch: 19, Steps: 52 | Train Loss: 0.4077994 Vali Loss: 1.2930959 Test Loss: 0.3446411
Validation loss decreased (1.298257 --> 1.293096).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 20 cost time: 1.5542635917663574
Epoch: 20, Steps: 52 | Train Loss: 0.4074541 Vali Loss: 1.2943355 Test Loss: 0.3440375
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 21 cost time: 1.5508790016174316
Epoch: 21, Steps: 52 | Train Loss: 0.4054992 Vali Loss: 1.3047922 Test Loss: 0.3430040
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 22 cost time: 1.5567781925201416
Epoch: 22, Steps: 52 | Train Loss: 0.4063760 Vali Loss: 1.2985502 Test Loss: 0.3428323
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 23 cost time: 1.555483341217041
Epoch: 23, Steps: 52 | Train Loss: 0.4050639 Vali Loss: 1.2978507 Test Loss: 0.3425094
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 24 cost time: 1.5628609657287598
Epoch: 24, Steps: 52 | Train Loss: 0.4057075 Vali Loss: 1.2968960 Test Loss: 0.3417924
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 25 cost time: 1.5560715198516846
Epoch: 25, Steps: 52 | Train Loss: 0.4057467 Vali Loss: 1.2986268 Test Loss: 0.3415602
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 26 cost time: 1.5584893226623535
Epoch: 26, Steps: 52 | Train Loss: 0.4050282 Vali Loss: 1.2948663 Test Loss: 0.3415314
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 27 cost time: 1.5524942874908447
Epoch: 27, Steps: 52 | Train Loss: 0.4052263 Vali Loss: 1.2954788 Test Loss: 0.3422392
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 28 cost time: 1.5578546524047852
Epoch: 28, Steps: 52 | Train Loss: 0.4059787 Vali Loss: 1.2952832 Test Loss: 0.3412973
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 29 cost time: 1.555776834487915
Epoch: 29, Steps: 52 | Train Loss: 0.4040401 Vali Loss: 1.2927220 Test Loss: 0.3415647
Validation loss decreased (1.293096 --> 1.292722).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 30 cost time: 1.558077096939087
Epoch: 30, Steps: 52 | Train Loss: 0.4037192 Vali Loss: 1.2913287 Test Loss: 0.3408449
Validation loss decreased (1.292722 --> 1.291329).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 31 cost time: 1.551255702972412
Epoch: 31, Steps: 52 | Train Loss: 0.4029562 Vali Loss: 1.2882185 Test Loss: 0.3413129
Validation loss decreased (1.291329 --> 1.288218).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 32 cost time: 1.5564606189727783
Epoch: 32, Steps: 52 | Train Loss: 0.4030542 Vali Loss: 1.2934823 Test Loss: 0.3412769
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 33 cost time: 1.5535032749176025
Epoch: 33, Steps: 52 | Train Loss: 0.4027615 Vali Loss: 1.2929735 Test Loss: 0.3422018
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 34 cost time: 1.553255319595337
Epoch: 34, Steps: 52 | Train Loss: 0.4039824 Vali Loss: 1.2970356 Test Loss: 0.3401967
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 35 cost time: 1.5500104427337646
Epoch: 35, Steps: 52 | Train Loss: 0.4026240 Vali Loss: 1.2899022 Test Loss: 0.3412672
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 36 cost time: 1.5509991645812988
Epoch: 36, Steps: 52 | Train Loss: 0.4033943 Vali Loss: 1.2923057 Test Loss: 0.3408632
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 37 cost time: 1.5524375438690186
Epoch: 37, Steps: 52 | Train Loss: 0.4028649 Vali Loss: 1.2958310 Test Loss: 0.3409999
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 38 cost time: 1.552597999572754
Epoch: 38, Steps: 52 | Train Loss: 0.4046507 Vali Loss: 1.2955117 Test Loss: 0.3401873
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 39 cost time: 1.5590901374816895
Epoch: 39, Steps: 52 | Train Loss: 0.4035070 Vali Loss: 1.2922385 Test Loss: 0.3409808
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 40 cost time: 1.5583596229553223
Epoch: 40, Steps: 52 | Train Loss: 0.4042941 Vali Loss: 1.2952321 Test Loss: 0.3402348
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 41 cost time: 1.560584306716919
Epoch: 41, Steps: 52 | Train Loss: 0.4031363 Vali Loss: 1.2841871 Test Loss: 0.3405890
Validation loss decreased (1.288218 --> 1.284187).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 42 cost time: 1.5563180446624756
Epoch: 42, Steps: 52 | Train Loss: 0.4019410 Vali Loss: 1.2867315 Test Loss: 0.3423317
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 43 cost time: 1.5603299140930176
Epoch: 43, Steps: 52 | Train Loss: 0.4022456 Vali Loss: 1.2887702 Test Loss: 0.3406509
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 44 cost time: 1.555044412612915
Epoch: 44, Steps: 52 | Train Loss: 0.4034943 Vali Loss: 1.2925925 Test Loss: 0.3402880
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 45 cost time: 1.5563368797302246
Epoch: 45, Steps: 52 | Train Loss: 0.4031709 Vali Loss: 1.2887344 Test Loss: 0.3402627
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 46 cost time: 1.5544278621673584
Epoch: 46, Steps: 52 | Train Loss: 0.4032802 Vali Loss: 1.2868012 Test Loss: 0.3409981
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 47 cost time: 1.5576539039611816
Epoch: 47, Steps: 52 | Train Loss: 0.4018985 Vali Loss: 1.2908008 Test Loss: 0.3407509
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 48 cost time: 1.5540595054626465
Epoch: 48, Steps: 52 | Train Loss: 0.4038849 Vali Loss: 1.2954404 Test Loss: 0.3416062
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 49 cost time: 1.5578584671020508
Epoch: 49, Steps: 52 | Train Loss: 0.4031147 Vali Loss: 1.2930622 Test Loss: 0.3406167
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 50 cost time: 1.5551068782806396
Epoch: 50, Steps: 52 | Train Loss: 0.4034781 Vali Loss: 1.2872031 Test Loss: 0.3395956
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 51 cost time: 1.558243751525879
Epoch: 51, Steps: 52 | Train Loss: 0.4022557 Vali Loss: 1.2810814 Test Loss: 0.3404621
Validation loss decreased (1.284187 --> 1.281081).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 52 cost time: 1.5543699264526367
Epoch: 52, Steps: 52 | Train Loss: 0.4030470 Vali Loss: 1.2915320 Test Loss: 0.3401591
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 53 cost time: 1.5567967891693115
Epoch: 53, Steps: 52 | Train Loss: 0.4026415 Vali Loss: 1.2907751 Test Loss: 0.3406885
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 54 cost time: 1.558763027191162
Epoch: 54, Steps: 52 | Train Loss: 0.4025789 Vali Loss: 1.2900624 Test Loss: 0.3405855
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 55 cost time: 1.5620019435882568
Epoch: 55, Steps: 52 | Train Loss: 0.4028158 Vali Loss: 1.2873149 Test Loss: 0.3407247
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 56 cost time: 1.5575451850891113
Epoch: 56, Steps: 52 | Train Loss: 0.4043076 Vali Loss: 1.2933555 Test Loss: 0.3409370
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 57 cost time: 1.5548553466796875
Epoch: 57, Steps: 52 | Train Loss: 0.4011920 Vali Loss: 1.2931581 Test Loss: 0.3408090
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 58 cost time: 1.5558741092681885
Epoch: 58, Steps: 52 | Train Loss: 0.4027210 Vali Loss: 1.2894332 Test Loss: 0.3397866
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 59 cost time: 1.5509099960327148
Epoch: 59, Steps: 52 | Train Loss: 0.4020276 Vali Loss: 1.2918055 Test Loss: 0.3397386
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 60 cost time: 1.5565664768218994
Epoch: 60, Steps: 52 | Train Loss: 0.4016843 Vali Loss: 1.2732663 Test Loss: 0.3401970
Validation loss decreased (1.281081 --> 1.273266).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34019696712493896, mae:0.3916950225830078, rse:0.4778306484222412
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.0699467658996582 GB
Epoch: 1 cost time: 2.0960371494293213
Epoch: 1, Steps: 52 | Train Loss: 0.7209955 Vali Loss: 2.1674535 Test Loss: 1.4118264
Validation loss decreased (inf --> 2.167454).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 2 cost time: 0.7395331859588623
Epoch: 2, Steps: 52 | Train Loss: 0.5521899 Vali Loss: 1.4531631 Test Loss: 0.4641219
Validation loss decreased (2.167454 --> 1.453163).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 3 cost time: 0.7290000915527344
Epoch: 3, Steps: 52 | Train Loss: 0.4396668 Vali Loss: 1.3567801 Test Loss: 0.3998540
Validation loss decreased (1.453163 --> 1.356780).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 4 cost time: 0.7316188812255859
Epoch: 4, Steps: 52 | Train Loss: 0.4221443 Vali Loss: 1.3381782 Test Loss: 0.3799386
Validation loss decreased (1.356780 --> 1.338178).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 5 cost time: 0.7304377555847168
Epoch: 5, Steps: 52 | Train Loss: 0.4158037 Vali Loss: 1.3261111 Test Loss: 0.3699522
Validation loss decreased (1.338178 --> 1.326111).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 6 cost time: 1.522378921508789
Epoch: 6, Steps: 52 | Train Loss: 0.4108026 Vali Loss: 1.3231769 Test Loss: 0.3651582
Validation loss decreased (1.326111 --> 1.323177).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 7 cost time: 1.606400728225708
Epoch: 7, Steps: 52 | Train Loss: 0.4077742 Vali Loss: 1.3152610 Test Loss: 0.3627831
Validation loss decreased (1.323177 --> 1.315261).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 8 cost time: 1.6204948425292969
Epoch: 8, Steps: 52 | Train Loss: 0.4055976 Vali Loss: 1.3071731 Test Loss: 0.3599306
Validation loss decreased (1.315261 --> 1.307173).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 9 cost time: 1.614924669265747
Epoch: 9, Steps: 52 | Train Loss: 0.4037805 Vali Loss: 1.3065636 Test Loss: 0.3588957
Validation loss decreased (1.307173 --> 1.306564).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 10 cost time: 1.6209566593170166
Epoch: 10, Steps: 52 | Train Loss: 0.4018258 Vali Loss: 1.3017094 Test Loss: 0.3571957
Validation loss decreased (1.306564 --> 1.301709).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 11 cost time: 1.6165168285369873
Epoch: 11, Steps: 52 | Train Loss: 0.4009897 Vali Loss: 1.2995565 Test Loss: 0.3583208
Validation loss decreased (1.301709 --> 1.299556).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 12 cost time: 1.6215369701385498
Epoch: 12, Steps: 52 | Train Loss: 0.4013008 Vali Loss: 1.3003665 Test Loss: 0.3567535
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 13 cost time: 1.6170754432678223
Epoch: 13, Steps: 52 | Train Loss: 0.3979711 Vali Loss: 1.2911304 Test Loss: 0.3579663
Validation loss decreased (1.299556 --> 1.291130).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 14 cost time: 1.6228468418121338
Epoch: 14, Steps: 52 | Train Loss: 0.3972777 Vali Loss: 1.2968036 Test Loss: 0.3552228
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 15 cost time: 1.6133668422698975
Epoch: 15, Steps: 52 | Train Loss: 0.3978729 Vali Loss: 1.2965441 Test Loss: 0.3555075
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 16 cost time: 1.6152582168579102
Epoch: 16, Steps: 52 | Train Loss: 0.3962384 Vali Loss: 1.2908952 Test Loss: 0.3549581
Validation loss decreased (1.291130 --> 1.290895).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 17 cost time: 1.6134684085845947
Epoch: 17, Steps: 52 | Train Loss: 0.3967940 Vali Loss: 1.2986691 Test Loss: 0.3566002
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 18 cost time: 1.6125662326812744
Epoch: 18, Steps: 52 | Train Loss: 0.3960525 Vali Loss: 1.2894416 Test Loss: 0.3546267
Validation loss decreased (1.290895 --> 1.289442).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 19 cost time: 1.617542028427124
Epoch: 19, Steps: 52 | Train Loss: 0.3952902 Vali Loss: 1.2962749 Test Loss: 0.3560496
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 20 cost time: 1.6212007999420166
Epoch: 20, Steps: 52 | Train Loss: 0.3958631 Vali Loss: 1.2876740 Test Loss: 0.3540827
Validation loss decreased (1.289442 --> 1.287674).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 21 cost time: 1.6120665073394775
Epoch: 21, Steps: 52 | Train Loss: 0.3959398 Vali Loss: 1.2947206 Test Loss: 0.3551890
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 22 cost time: 1.6163480281829834
Epoch: 22, Steps: 52 | Train Loss: 0.3944265 Vali Loss: 1.2896626 Test Loss: 0.3542241
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 23 cost time: 1.616527795791626
Epoch: 23, Steps: 52 | Train Loss: 0.3939249 Vali Loss: 1.2896537 Test Loss: 0.3552246
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 24 cost time: 1.6168980598449707
Epoch: 24, Steps: 52 | Train Loss: 0.3940137 Vali Loss: 1.2939548 Test Loss: 0.3546375
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 25 cost time: 1.613466739654541
Epoch: 25, Steps: 52 | Train Loss: 0.3953112 Vali Loss: 1.2930846 Test Loss: 0.3547474
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 26 cost time: 1.614074945449829
Epoch: 26, Steps: 52 | Train Loss: 0.3963613 Vali Loss: 1.2925622 Test Loss: 0.3563994
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 27 cost time: 1.6150901317596436
Epoch: 27, Steps: 52 | Train Loss: 0.3917802 Vali Loss: 1.2940097 Test Loss: 0.3562283
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 28 cost time: 1.6127052307128906
Epoch: 28, Steps: 52 | Train Loss: 0.3932954 Vali Loss: 1.2947943 Test Loss: 0.3559674
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 29 cost time: 1.6166093349456787
Epoch: 29, Steps: 52 | Train Loss: 0.3943098 Vali Loss: 1.2898406 Test Loss: 0.3561721
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 30 cost time: 1.6187305450439453
Epoch: 30, Steps: 52 | Train Loss: 0.3930577 Vali Loss: 1.2871039 Test Loss: 0.3540941
Validation loss decreased (1.287674 --> 1.287104).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 31 cost time: 1.6166579723358154
Epoch: 31, Steps: 52 | Train Loss: 0.3938442 Vali Loss: 1.2923286 Test Loss: 0.3564128
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 32 cost time: 1.6197850704193115
Epoch: 32, Steps: 52 | Train Loss: 0.3927412 Vali Loss: 1.2855026 Test Loss: 0.3547034
Validation loss decreased (1.287104 --> 1.285503).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 33 cost time: 1.6269848346710205
Epoch: 33, Steps: 52 | Train Loss: 0.3939856 Vali Loss: 1.2899148 Test Loss: 0.3547411
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 34 cost time: 1.6159629821777344
Epoch: 34, Steps: 52 | Train Loss: 0.3922654 Vali Loss: 1.2797046 Test Loss: 0.3545614
Validation loss decreased (1.285503 --> 1.279705).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 35 cost time: 1.609586477279663
Epoch: 35, Steps: 52 | Train Loss: 0.3939995 Vali Loss: 1.2884121 Test Loss: 0.3552705
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 36 cost time: 1.6186490058898926
Epoch: 36, Steps: 52 | Train Loss: 0.3933346 Vali Loss: 1.2921809 Test Loss: 0.3553907
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 37 cost time: 1.614959716796875
Epoch: 37, Steps: 52 | Train Loss: 0.3921864 Vali Loss: 1.2851758 Test Loss: 0.3565214
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 38 cost time: 1.6188726425170898
Epoch: 38, Steps: 52 | Train Loss: 0.3933248 Vali Loss: 1.2887255 Test Loss: 0.3557112
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 39 cost time: 1.6161186695098877
Epoch: 39, Steps: 52 | Train Loss: 0.3929152 Vali Loss: 1.2849697 Test Loss: 0.3548017
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 40 cost time: 1.6285951137542725
Epoch: 40, Steps: 52 | Train Loss: 0.3932465 Vali Loss: 1.2774272 Test Loss: 0.3529963
Validation loss decreased (1.279705 --> 1.277427).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 41 cost time: 1.6184003353118896
Epoch: 41, Steps: 52 | Train Loss: 0.3931317 Vali Loss: 1.2941428 Test Loss: 0.3552448
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 42 cost time: 1.6211926937103271
Epoch: 42, Steps: 52 | Train Loss: 0.3931649 Vali Loss: 1.2762259 Test Loss: 0.3547644
Validation loss decreased (1.277427 --> 1.276226).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 43 cost time: 1.615394115447998
Epoch: 43, Steps: 52 | Train Loss: 0.3940664 Vali Loss: 1.2884881 Test Loss: 0.3543113
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 44 cost time: 1.6183671951293945
Epoch: 44, Steps: 52 | Train Loss: 0.3921981 Vali Loss: 1.2914168 Test Loss: 0.3549455
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 45 cost time: 1.6167089939117432
Epoch: 45, Steps: 52 | Train Loss: 0.3919520 Vali Loss: 1.2888378 Test Loss: 0.3561393
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 46 cost time: 1.6186423301696777
Epoch: 46, Steps: 52 | Train Loss: 0.3926887 Vali Loss: 1.2849231 Test Loss: 0.3574505
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 47 cost time: 1.612926959991455
Epoch: 47, Steps: 52 | Train Loss: 0.3937261 Vali Loss: 1.2844788 Test Loss: 0.3566961
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 48 cost time: 1.6190166473388672
Epoch: 48, Steps: 52 | Train Loss: 0.3922774 Vali Loss: 1.2788033 Test Loss: 0.3532600
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 49 cost time: 1.615755558013916
Epoch: 49, Steps: 52 | Train Loss: 0.3928320 Vali Loss: 1.2796587 Test Loss: 0.3542603
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 50 cost time: 1.6210803985595703
Epoch: 50, Steps: 52 | Train Loss: 0.3923257 Vali Loss: 1.2885766 Test Loss: 0.3559423
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 51 cost time: 1.6176621913909912
Epoch: 51, Steps: 52 | Train Loss: 0.3919785 Vali Loss: 1.2895284 Test Loss: 0.3553166
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 52 cost time: 1.6194941997528076
Epoch: 52, Steps: 52 | Train Loss: 0.3938200 Vali Loss: 1.2807640 Test Loss: 0.3541632
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 53 cost time: 1.6177864074707031
Epoch: 53, Steps: 52 | Train Loss: 0.3940413 Vali Loss: 1.2883980 Test Loss: 0.3556843
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 54 cost time: 1.6203088760375977
Epoch: 54, Steps: 52 | Train Loss: 0.3930703 Vali Loss: 1.2825929 Test Loss: 0.3537903
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 55 cost time: 1.618379831314087
Epoch: 55, Steps: 52 | Train Loss: 0.3913582 Vali Loss: 1.2836018 Test Loss: 0.3544355
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 56 cost time: 1.6187107563018799
Epoch: 56, Steps: 52 | Train Loss: 0.3931497 Vali Loss: 1.2893324 Test Loss: 0.3563344
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 57 cost time: 1.6148173809051514
Epoch: 57, Steps: 52 | Train Loss: 0.3920698 Vali Loss: 1.2912043 Test Loss: 0.3559648
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 58 cost time: 1.62019944190979
Epoch: 58, Steps: 52 | Train Loss: 0.3920110 Vali Loss: 1.2877932 Test Loss: 0.3545501
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 59 cost time: 1.6139872074127197
Epoch: 59, Steps: 52 | Train Loss: 0.3918345 Vali Loss: 1.2881646 Test Loss: 0.3551010
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 60 cost time: 1.619032621383667
Epoch: 60, Steps: 52 | Train Loss: 0.3924649 Vali Loss: 1.2883096 Test Loss: 0.3545196
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.354764461517334, mae:0.4058516025543213, rse:0.4879539906978607
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07306241989135742 GB
Epoch: 1 cost time: 2.1634600162506104
Epoch: 1, Steps: 52 | Train Loss: 0.6734016 Vali Loss: 2.0766497 Test Loss: 1.3073455
Validation loss decreased (inf --> 2.076650).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 2 cost time: 0.7633328437805176
Epoch: 2, Steps: 52 | Train Loss: 0.5226584 Vali Loss: 1.4077151 Test Loss: 0.4125171
Validation loss decreased (2.076650 --> 1.407715).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 3 cost time: 0.7603287696838379
Epoch: 3, Steps: 52 | Train Loss: 0.4319862 Vali Loss: 1.3561559 Test Loss: 0.3821434
Validation loss decreased (1.407715 --> 1.356156).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 4 cost time: 0.7343544960021973
Epoch: 4, Steps: 52 | Train Loss: 0.4147661 Vali Loss: 1.3253367 Test Loss: 0.3680665
Validation loss decreased (1.356156 --> 1.325337).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 5 cost time: 0.7648029327392578
Epoch: 5, Steps: 52 | Train Loss: 0.4092895 Vali Loss: 1.3196753 Test Loss: 0.3625669
Validation loss decreased (1.325337 --> 1.319675).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 6 cost time: 1.6508593559265137
Epoch: 6, Steps: 52 | Train Loss: 0.4071187 Vali Loss: 1.3144404 Test Loss: 0.3587069
Validation loss decreased (1.319675 --> 1.314440).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 7 cost time: 1.6644871234893799
Epoch: 7, Steps: 52 | Train Loss: 0.4037756 Vali Loss: 1.3060296 Test Loss: 0.3591695
Validation loss decreased (1.314440 --> 1.306030).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 8 cost time: 1.6690828800201416
Epoch: 8, Steps: 52 | Train Loss: 0.4011842 Vali Loss: 1.3010718 Test Loss: 0.3558500
Validation loss decreased (1.306030 --> 1.301072).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 9 cost time: 1.6714580059051514
Epoch: 9, Steps: 52 | Train Loss: 0.4006580 Vali Loss: 1.3000523 Test Loss: 0.3564210
Validation loss decreased (1.301072 --> 1.300052).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 10 cost time: 1.6710658073425293
Epoch: 10, Steps: 52 | Train Loss: 0.3999861 Vali Loss: 1.2867842 Test Loss: 0.3545033
Validation loss decreased (1.300052 --> 1.286784).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 11 cost time: 1.6694588661193848
Epoch: 11, Steps: 52 | Train Loss: 0.3987547 Vali Loss: 1.2967699 Test Loss: 0.3541808
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 12 cost time: 1.6648306846618652
Epoch: 12, Steps: 52 | Train Loss: 0.3963981 Vali Loss: 1.2867069 Test Loss: 0.3544857
Validation loss decreased (1.286784 --> 1.286707).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 13 cost time: 1.668196678161621
Epoch: 13, Steps: 52 | Train Loss: 0.3973992 Vali Loss: 1.2969084 Test Loss: 0.3552646
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 14 cost time: 1.677677869796753
Epoch: 14, Steps: 52 | Train Loss: 0.3946913 Vali Loss: 1.2901697 Test Loss: 0.3537331
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 15 cost time: 1.673854112625122
Epoch: 15, Steps: 52 | Train Loss: 0.3939325 Vali Loss: 1.2935672 Test Loss: 0.3546605
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 16 cost time: 1.6716639995574951
Epoch: 16, Steps: 52 | Train Loss: 0.3961436 Vali Loss: 1.2848206 Test Loss: 0.3525598
Validation loss decreased (1.286707 --> 1.284821).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 17 cost time: 1.6700522899627686
Epoch: 17, Steps: 52 | Train Loss: 0.3953155 Vali Loss: 1.2934532 Test Loss: 0.3543306
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 18 cost time: 1.6671199798583984
Epoch: 18, Steps: 52 | Train Loss: 0.3942269 Vali Loss: 1.2856761 Test Loss: 0.3542972
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 19 cost time: 1.6692266464233398
Epoch: 19, Steps: 52 | Train Loss: 0.3944721 Vali Loss: 1.2921418 Test Loss: 0.3521803
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 20 cost time: 1.6740238666534424
Epoch: 20, Steps: 52 | Train Loss: 0.3914563 Vali Loss: 1.2851667 Test Loss: 0.3539169
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 21 cost time: 1.6706874370574951
Epoch: 21, Steps: 52 | Train Loss: 0.3935080 Vali Loss: 1.2851200 Test Loss: 0.3539554
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 22 cost time: 1.6745691299438477
Epoch: 22, Steps: 52 | Train Loss: 0.3923326 Vali Loss: 1.2846260 Test Loss: 0.3521533
Validation loss decreased (1.284821 --> 1.284626).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 23 cost time: 1.676443099975586
Epoch: 23, Steps: 52 | Train Loss: 0.3921805 Vali Loss: 1.2809752 Test Loss: 0.3533528
Validation loss decreased (1.284626 --> 1.280975).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 24 cost time: 1.676541805267334
Epoch: 24, Steps: 52 | Train Loss: 0.3918565 Vali Loss: 1.2793628 Test Loss: 0.3526227
Validation loss decreased (1.280975 --> 1.279363).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 25 cost time: 1.6687827110290527
Epoch: 25, Steps: 52 | Train Loss: 0.3905866 Vali Loss: 1.2791405 Test Loss: 0.3525460
Validation loss decreased (1.279363 --> 1.279140).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 26 cost time: 1.6748559474945068
Epoch: 26, Steps: 52 | Train Loss: 0.3914134 Vali Loss: 1.2772985 Test Loss: 0.3532518
Validation loss decreased (1.279140 --> 1.277298).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 27 cost time: 1.6677861213684082
Epoch: 27, Steps: 52 | Train Loss: 0.3920476 Vali Loss: 1.2791125 Test Loss: 0.3526385
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 28 cost time: 1.6790714263916016
Epoch: 28, Steps: 52 | Train Loss: 0.3917608 Vali Loss: 1.2806853 Test Loss: 0.3535883
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 29 cost time: 1.668196678161621
Epoch: 29, Steps: 52 | Train Loss: 0.3909267 Vali Loss: 1.2822763 Test Loss: 0.3532828
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 30 cost time: 1.6783981323242188
Epoch: 30, Steps: 52 | Train Loss: 0.3909299 Vali Loss: 1.2877377 Test Loss: 0.3529148
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 31 cost time: 1.672086477279663
Epoch: 31, Steps: 52 | Train Loss: 0.3907505 Vali Loss: 1.2888030 Test Loss: 0.3531941
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 32 cost time: 1.6678905487060547
Epoch: 32, Steps: 52 | Train Loss: 0.3901119 Vali Loss: 1.2765464 Test Loss: 0.3527964
Validation loss decreased (1.277298 --> 1.276546).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 33 cost time: 1.6703486442565918
Epoch: 33, Steps: 52 | Train Loss: 0.3910963 Vali Loss: 1.2887039 Test Loss: 0.3524462
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 34 cost time: 1.6644163131713867
Epoch: 34, Steps: 52 | Train Loss: 0.3926683 Vali Loss: 1.2770498 Test Loss: 0.3532003
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 35 cost time: 1.6700475215911865
Epoch: 35, Steps: 52 | Train Loss: 0.3896180 Vali Loss: 1.2806787 Test Loss: 0.3530972
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 36 cost time: 1.6745057106018066
Epoch: 36, Steps: 52 | Train Loss: 0.3901590 Vali Loss: 1.2864550 Test Loss: 0.3529565
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 37 cost time: 1.6713578701019287
Epoch: 37, Steps: 52 | Train Loss: 0.3905206 Vali Loss: 1.2847308 Test Loss: 0.3535874
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 38 cost time: 1.6697900295257568
Epoch: 38, Steps: 52 | Train Loss: 0.3904663 Vali Loss: 1.2805896 Test Loss: 0.3531823
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 39 cost time: 1.671215295791626
Epoch: 39, Steps: 52 | Train Loss: 0.3893368 Vali Loss: 1.2822616 Test Loss: 0.3524991
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 40 cost time: 1.6717596054077148
Epoch: 40, Steps: 52 | Train Loss: 0.3911635 Vali Loss: 1.2834388 Test Loss: 0.3530365
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 41 cost time: 1.6731910705566406
Epoch: 41, Steps: 52 | Train Loss: 0.3918950 Vali Loss: 1.2784929 Test Loss: 0.3517052
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 42 cost time: 1.6650135517120361
Epoch: 42, Steps: 52 | Train Loss: 0.3913367 Vali Loss: 1.2794139 Test Loss: 0.3528823
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 43 cost time: 1.671950340270996
Epoch: 43, Steps: 52 | Train Loss: 0.3900489 Vali Loss: 1.2827487 Test Loss: 0.3523314
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 44 cost time: 1.664435863494873
Epoch: 44, Steps: 52 | Train Loss: 0.3902766 Vali Loss: 1.2871547 Test Loss: 0.3532922
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 45 cost time: 1.6712274551391602
Epoch: 45, Steps: 52 | Train Loss: 0.3912923 Vali Loss: 1.2873372 Test Loss: 0.3529722
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 46 cost time: 1.6696546077728271
Epoch: 46, Steps: 52 | Train Loss: 0.3898117 Vali Loss: 1.2884007 Test Loss: 0.3527075
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 47 cost time: 1.6793315410614014
Epoch: 47, Steps: 52 | Train Loss: 0.3895085 Vali Loss: 1.2808428 Test Loss: 0.3527897
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 48 cost time: 1.6693236827850342
Epoch: 48, Steps: 52 | Train Loss: 0.3893944 Vali Loss: 1.2811103 Test Loss: 0.3536604
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 49 cost time: 1.6788668632507324
Epoch: 49, Steps: 52 | Train Loss: 0.3904841 Vali Loss: 1.2866249 Test Loss: 0.3530980
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 50 cost time: 1.672548532485962
Epoch: 50, Steps: 52 | Train Loss: 0.3903457 Vali Loss: 1.2782876 Test Loss: 0.3525519
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 51 cost time: 1.6699061393737793
Epoch: 51, Steps: 52 | Train Loss: 0.3906405 Vali Loss: 1.2878560 Test Loss: 0.3520338
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 52 cost time: 1.6657476425170898
Epoch: 52, Steps: 52 | Train Loss: 0.3893024 Vali Loss: 1.2731385 Test Loss: 0.3533027
Validation loss decreased (1.276546 --> 1.273139).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 53 cost time: 1.6758012771606445
Epoch: 53, Steps: 52 | Train Loss: 0.3901477 Vali Loss: 1.2883161 Test Loss: 0.3526287
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 54 cost time: 1.6722502708435059
Epoch: 54, Steps: 52 | Train Loss: 0.3899743 Vali Loss: 1.2805005 Test Loss: 0.3521397
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 55 cost time: 1.6745920181274414
Epoch: 55, Steps: 52 | Train Loss: 0.3894832 Vali Loss: 1.2832892 Test Loss: 0.3529999
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 56 cost time: 1.6673154830932617
Epoch: 56, Steps: 52 | Train Loss: 0.3875673 Vali Loss: 1.2842698 Test Loss: 0.3528490
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 57 cost time: 1.6702451705932617
Epoch: 57, Steps: 52 | Train Loss: 0.3909966 Vali Loss: 1.2880740 Test Loss: 0.3537992
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 58 cost time: 1.666966438293457
Epoch: 58, Steps: 52 | Train Loss: 0.3894979 Vali Loss: 1.2854877 Test Loss: 0.3540694
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 59 cost time: 1.677861213684082
Epoch: 59, Steps: 52 | Train Loss: 0.3908944 Vali Loss: 1.2800581 Test Loss: 0.3529938
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 60 cost time: 1.6663479804992676
Epoch: 60, Steps: 52 | Train Loss: 0.3907232 Vali Loss: 1.2779874 Test Loss: 0.3528041
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.35330262780189514, mae:0.4042436182498932, rse:0.48694759607315063
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06583642959594727 GB
Epoch: 1 cost time: 2.102252721786499
Epoch: 1, Steps: 52 | Train Loss: 0.7441002 Vali Loss: 2.1627386 Test Loss: 1.3629620
Validation loss decreased (inf --> 2.162739).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 2 cost time: 0.7059645652770996
Epoch: 2, Steps: 52 | Train Loss: 0.6439412 Vali Loss: 1.6934181 Test Loss: 0.8027371
Validation loss decreased (2.162739 --> 1.693418).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 3 cost time: 0.7041704654693604
Epoch: 3, Steps: 52 | Train Loss: 0.5257147 Vali Loss: 1.5001509 Test Loss: 0.5331267
Validation loss decreased (1.693418 --> 1.500151).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 4 cost time: 0.7027971744537354
Epoch: 4, Steps: 52 | Train Loss: 0.4734066 Vali Loss: 1.4228370 Test Loss: 0.4402322
Validation loss decreased (1.500151 --> 1.422837).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 5 cost time: 0.7099997997283936
Epoch: 5, Steps: 52 | Train Loss: 0.4493459 Vali Loss: 1.3882508 Test Loss: 0.4090212
Validation loss decreased (1.422837 --> 1.388251).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 6 cost time: 1.3162200450897217
Epoch: 6, Steps: 52 | Train Loss: 0.4394650 Vali Loss: 1.3828661 Test Loss: 0.3929079
Validation loss decreased (1.388251 --> 1.382866).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 7 cost time: 1.5671014785766602
Epoch: 7, Steps: 52 | Train Loss: 0.4323280 Vali Loss: 1.3605242 Test Loss: 0.3814691
Validation loss decreased (1.382866 --> 1.360524).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 8 cost time: 1.5687308311462402
Epoch: 8, Steps: 52 | Train Loss: 0.4275496 Vali Loss: 1.3504741 Test Loss: 0.3746386
Validation loss decreased (1.360524 --> 1.350474).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 9 cost time: 1.5702476501464844
Epoch: 9, Steps: 52 | Train Loss: 0.4237854 Vali Loss: 1.3468254 Test Loss: 0.3694103
Validation loss decreased (1.350474 --> 1.346825).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 10 cost time: 1.5662040710449219
Epoch: 10, Steps: 52 | Train Loss: 0.4212831 Vali Loss: 1.3400836 Test Loss: 0.3662472
Validation loss decreased (1.346825 --> 1.340084).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 11 cost time: 1.5673542022705078
Epoch: 11, Steps: 52 | Train Loss: 0.4177404 Vali Loss: 1.3254905 Test Loss: 0.3633232
Validation loss decreased (1.340084 --> 1.325490).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 12 cost time: 1.5722682476043701
Epoch: 12, Steps: 52 | Train Loss: 0.4158041 Vali Loss: 1.3217895 Test Loss: 0.3617122
Validation loss decreased (1.325490 --> 1.321790).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 13 cost time: 1.5758655071258545
Epoch: 13, Steps: 52 | Train Loss: 0.4137144 Vali Loss: 1.3216362 Test Loss: 0.3594320
Validation loss decreased (1.321790 --> 1.321636).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 14 cost time: 1.572972297668457
Epoch: 14, Steps: 52 | Train Loss: 0.4144686 Vali Loss: 1.3202555 Test Loss: 0.3586665
Validation loss decreased (1.321636 --> 1.320256).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 15 cost time: 1.569507122039795
Epoch: 15, Steps: 52 | Train Loss: 0.4119893 Vali Loss: 1.3168774 Test Loss: 0.3576358
Validation loss decreased (1.320256 --> 1.316877).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 16 cost time: 1.56538987159729
Epoch: 16, Steps: 52 | Train Loss: 0.4117824 Vali Loss: 1.3149570 Test Loss: 0.3565688
Validation loss decreased (1.316877 --> 1.314957).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 17 cost time: 1.5711817741394043
Epoch: 17, Steps: 52 | Train Loss: 0.4096472 Vali Loss: 1.3170767 Test Loss: 0.3554687
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 18 cost time: 1.5774579048156738
Epoch: 18, Steps: 52 | Train Loss: 0.4093757 Vali Loss: 1.3112280 Test Loss: 0.3553277
Validation loss decreased (1.314957 --> 1.311228).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 19 cost time: 1.571793794631958
Epoch: 19, Steps: 52 | Train Loss: 0.4076479 Vali Loss: 1.3024304 Test Loss: 0.3555358
Validation loss decreased (1.311228 --> 1.302430).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 20 cost time: 1.5729742050170898
Epoch: 20, Steps: 52 | Train Loss: 0.4076078 Vali Loss: 1.2998290 Test Loss: 0.3541663
Validation loss decreased (1.302430 --> 1.299829).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 21 cost time: 1.5632219314575195
Epoch: 21, Steps: 52 | Train Loss: 0.4081008 Vali Loss: 1.3117136 Test Loss: 0.3535821
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 22 cost time: 1.5684585571289062
Epoch: 22, Steps: 52 | Train Loss: 0.4074329 Vali Loss: 1.3020415 Test Loss: 0.3538336
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 23 cost time: 1.5661036968231201
Epoch: 23, Steps: 52 | Train Loss: 0.4065510 Vali Loss: 1.2984676 Test Loss: 0.3526086
Validation loss decreased (1.299829 --> 1.298468).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 24 cost time: 1.570462942123413
Epoch: 24, Steps: 52 | Train Loss: 0.4055514 Vali Loss: 1.3012525 Test Loss: 0.3533837
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 25 cost time: 1.5821681022644043
Epoch: 25, Steps: 52 | Train Loss: 0.4046153 Vali Loss: 1.2993119 Test Loss: 0.3523274
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 26 cost time: 1.5635254383087158
Epoch: 26, Steps: 52 | Train Loss: 0.4043603 Vali Loss: 1.2998827 Test Loss: 0.3518363
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 27 cost time: 1.5721416473388672
Epoch: 27, Steps: 52 | Train Loss: 0.4045744 Vali Loss: 1.3043454 Test Loss: 0.3519666
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 28 cost time: 1.5674262046813965
Epoch: 28, Steps: 52 | Train Loss: 0.4052889 Vali Loss: 1.3012278 Test Loss: 0.3520638
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 29 cost time: 1.5588228702545166
Epoch: 29, Steps: 52 | Train Loss: 0.4043866 Vali Loss: 1.2923634 Test Loss: 0.3518927
Validation loss decreased (1.298468 --> 1.292363).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 30 cost time: 1.570878028869629
Epoch: 30, Steps: 52 | Train Loss: 0.4032498 Vali Loss: 1.3007305 Test Loss: 0.3513576
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 31 cost time: 1.5668644905090332
Epoch: 31, Steps: 52 | Train Loss: 0.4042872 Vali Loss: 1.3031149 Test Loss: 0.3507271
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 32 cost time: 1.5680491924285889
Epoch: 32, Steps: 52 | Train Loss: 0.4034616 Vali Loss: 1.2948419 Test Loss: 0.3527424
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 33 cost time: 1.567695140838623
Epoch: 33, Steps: 52 | Train Loss: 0.4026540 Vali Loss: 1.2951583 Test Loss: 0.3502525
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 34 cost time: 1.5694591999053955
Epoch: 34, Steps: 52 | Train Loss: 0.4013935 Vali Loss: 1.2944095 Test Loss: 0.3512258
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 35 cost time: 1.5718910694122314
Epoch: 35, Steps: 52 | Train Loss: 0.4025821 Vali Loss: 1.2933445 Test Loss: 0.3507633
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 36 cost time: 1.5713975429534912
Epoch: 36, Steps: 52 | Train Loss: 0.4035717 Vali Loss: 1.2926090 Test Loss: 0.3501430
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 37 cost time: 1.5682978630065918
Epoch: 37, Steps: 52 | Train Loss: 0.4020408 Vali Loss: 1.3031645 Test Loss: 0.3496403
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 38 cost time: 1.5648488998413086
Epoch: 38, Steps: 52 | Train Loss: 0.4028869 Vali Loss: 1.2993059 Test Loss: 0.3492074
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 39 cost time: 1.5686757564544678
Epoch: 39, Steps: 52 | Train Loss: 0.4035149 Vali Loss: 1.3000653 Test Loss: 0.3491162
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 40 cost time: 1.5660924911499023
Epoch: 40, Steps: 52 | Train Loss: 0.4025495 Vali Loss: 1.2936698 Test Loss: 0.3492447
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 41 cost time: 1.5689976215362549
Epoch: 41, Steps: 52 | Train Loss: 0.4039446 Vali Loss: 1.2977756 Test Loss: 0.3497331
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 42 cost time: 1.5665109157562256
Epoch: 42, Steps: 52 | Train Loss: 0.4022244 Vali Loss: 1.2983530 Test Loss: 0.3504511
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 43 cost time: 1.5666921138763428
Epoch: 43, Steps: 52 | Train Loss: 0.4032533 Vali Loss: 1.2926979 Test Loss: 0.3494413
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 44 cost time: 1.564767599105835
Epoch: 44, Steps: 52 | Train Loss: 0.4017737 Vali Loss: 1.2968295 Test Loss: 0.3506478
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 45 cost time: 1.5707435607910156
Epoch: 45, Steps: 52 | Train Loss: 0.4008293 Vali Loss: 1.3029437 Test Loss: 0.3498597
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 46 cost time: 1.567455530166626
Epoch: 46, Steps: 52 | Train Loss: 0.4039959 Vali Loss: 1.2970985 Test Loss: 0.3501896
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 47 cost time: 1.5667026042938232
Epoch: 47, Steps: 52 | Train Loss: 0.4040290 Vali Loss: 1.3011453 Test Loss: 0.3506978
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 48 cost time: 1.5665078163146973
Epoch: 48, Steps: 52 | Train Loss: 0.4021101 Vali Loss: 1.2965324 Test Loss: 0.3503036
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 49 cost time: 1.57082200050354
Epoch: 49, Steps: 52 | Train Loss: 0.4030514 Vali Loss: 1.2960677 Test Loss: 0.3508940
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 50 cost time: 1.5659892559051514
Epoch: 50, Steps: 52 | Train Loss: 0.4025043 Vali Loss: 1.2939990 Test Loss: 0.3496234
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 51 cost time: 1.5741543769836426
Epoch: 51, Steps: 52 | Train Loss: 0.4026823 Vali Loss: 1.2964437 Test Loss: 0.3497707
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 52 cost time: 1.5684895515441895
Epoch: 52, Steps: 52 | Train Loss: 0.4019129 Vali Loss: 1.2927141 Test Loss: 0.3504581
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 53 cost time: 1.5695257186889648
Epoch: 53, Steps: 52 | Train Loss: 0.4017298 Vali Loss: 1.3007199 Test Loss: 0.3497955
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 54 cost time: 1.5684354305267334
Epoch: 54, Steps: 52 | Train Loss: 0.4015182 Vali Loss: 1.3011367 Test Loss: 0.3499392
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 55 cost time: 1.573340654373169
Epoch: 55, Steps: 52 | Train Loss: 0.4028267 Vali Loss: 1.2932796 Test Loss: 0.3503810
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 56 cost time: 1.5611400604248047
Epoch: 56, Steps: 52 | Train Loss: 0.4003490 Vali Loss: 1.2986898 Test Loss: 0.3502111
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 57 cost time: 1.5675270557403564
Epoch: 57, Steps: 52 | Train Loss: 0.4025954 Vali Loss: 1.2941176 Test Loss: 0.3482989
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 58 cost time: 1.569045066833496
Epoch: 58, Steps: 52 | Train Loss: 0.4013698 Vali Loss: 1.2993793 Test Loss: 0.3513745
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 59 cost time: 1.5735597610473633
Epoch: 59, Steps: 52 | Train Loss: 0.4017976 Vali Loss: 1.2863853 Test Loss: 0.3495524
Validation loss decreased (1.292363 --> 1.286385).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 60 cost time: 1.5669598579406738
Epoch: 60, Steps: 52 | Train Loss: 0.4022584 Vali Loss: 1.2918589 Test Loss: 0.3501430
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3495523929595947, mae:0.4011141359806061, rse:0.4843562841415405
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07010889053344727 GB
Epoch: 1 cost time: 2.1677422523498535
Epoch: 1, Steps: 52 | Train Loss: 0.6880529 Vali Loss: 2.0869951 Test Loss: 1.3106575
Validation loss decreased (inf --> 2.086995).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 2 cost time: 0.7444350719451904
Epoch: 2, Steps: 52 | Train Loss: 0.5483785 Vali Loss: 1.4446356 Test Loss: 0.4606934
Validation loss decreased (2.086995 --> 1.444636).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 3 cost time: 0.7410006523132324
Epoch: 3, Steps: 52 | Train Loss: 0.4438992 Vali Loss: 1.3804781 Test Loss: 0.3943569
Validation loss decreased (1.444636 --> 1.380478).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 4 cost time: 0.7423486709594727
Epoch: 4, Steps: 52 | Train Loss: 0.4241742 Vali Loss: 1.3517050 Test Loss: 0.3761855
Validation loss decreased (1.380478 --> 1.351705).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 5 cost time: 0.7431426048278809
Epoch: 5, Steps: 52 | Train Loss: 0.4162003 Vali Loss: 1.3441491 Test Loss: 0.3667843
Validation loss decreased (1.351705 --> 1.344149).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 6 cost time: 1.6168439388275146
Epoch: 6, Steps: 52 | Train Loss: 0.4096536 Vali Loss: 1.3245513 Test Loss: 0.3604799
Validation loss decreased (1.344149 --> 1.324551).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 7 cost time: 1.6252384185791016
Epoch: 7, Steps: 52 | Train Loss: 0.4081224 Vali Loss: 1.3238996 Test Loss: 0.3563716
Validation loss decreased (1.324551 --> 1.323900).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 8 cost time: 1.6274993419647217
Epoch: 8, Steps: 52 | Train Loss: 0.4051368 Vali Loss: 1.3178475 Test Loss: 0.3545384
Validation loss decreased (1.323900 --> 1.317847).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 9 cost time: 1.6306815147399902
Epoch: 9, Steps: 52 | Train Loss: 0.4023458 Vali Loss: 1.3067849 Test Loss: 0.3524799
Validation loss decreased (1.317847 --> 1.306785).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 10 cost time: 1.6289372444152832
Epoch: 10, Steps: 52 | Train Loss: 0.4025918 Vali Loss: 1.3068129 Test Loss: 0.3505164
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 11 cost time: 1.6286461353302002
Epoch: 11, Steps: 52 | Train Loss: 0.4015720 Vali Loss: 1.3019750 Test Loss: 0.3509838
Validation loss decreased (1.306785 --> 1.301975).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 12 cost time: 1.626537799835205
Epoch: 12, Steps: 52 | Train Loss: 0.3987503 Vali Loss: 1.3024352 Test Loss: 0.3499857
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 13 cost time: 1.6326510906219482
Epoch: 13, Steps: 52 | Train Loss: 0.3988602 Vali Loss: 1.2949798 Test Loss: 0.3482783
Validation loss decreased (1.301975 --> 1.294980).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 14 cost time: 1.6292877197265625
Epoch: 14, Steps: 52 | Train Loss: 0.3978477 Vali Loss: 1.2873464 Test Loss: 0.3480450
Validation loss decreased (1.294980 --> 1.287346).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 15 cost time: 1.6331233978271484
Epoch: 15, Steps: 52 | Train Loss: 0.3967377 Vali Loss: 1.2979517 Test Loss: 0.3488349
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 16 cost time: 1.6308598518371582
Epoch: 16, Steps: 52 | Train Loss: 0.3964733 Vali Loss: 1.2950956 Test Loss: 0.3484213
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 17 cost time: 1.6302967071533203
Epoch: 17, Steps: 52 | Train Loss: 0.3952046 Vali Loss: 1.2962430 Test Loss: 0.3496562
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 18 cost time: 1.6287469863891602
Epoch: 18, Steps: 52 | Train Loss: 0.3952230 Vali Loss: 1.2956171 Test Loss: 0.3473311
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 19 cost time: 1.634573221206665
Epoch: 19, Steps: 52 | Train Loss: 0.3956005 Vali Loss: 1.2977687 Test Loss: 0.3483566
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 20 cost time: 1.629504919052124
Epoch: 20, Steps: 52 | Train Loss: 0.3944524 Vali Loss: 1.2925692 Test Loss: 0.3476165
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 21 cost time: 1.629612922668457
Epoch: 21, Steps: 52 | Train Loss: 0.3935451 Vali Loss: 1.2958450 Test Loss: 0.3482416
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 22 cost time: 1.6293468475341797
Epoch: 22, Steps: 52 | Train Loss: 0.3934081 Vali Loss: 1.2884712 Test Loss: 0.3476599
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 23 cost time: 1.634598970413208
Epoch: 23, Steps: 52 | Train Loss: 0.3934337 Vali Loss: 1.2924582 Test Loss: 0.3460963
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 24 cost time: 1.6305148601531982
Epoch: 24, Steps: 52 | Train Loss: 0.3928750 Vali Loss: 1.2890725 Test Loss: 0.3470084
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 25 cost time: 1.6357545852661133
Epoch: 25, Steps: 52 | Train Loss: 0.3914753 Vali Loss: 1.2904691 Test Loss: 0.3488746
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 26 cost time: 1.629410982131958
Epoch: 26, Steps: 52 | Train Loss: 0.3929470 Vali Loss: 1.2879301 Test Loss: 0.3448341
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 27 cost time: 1.6359930038452148
Epoch: 27, Steps: 52 | Train Loss: 0.3932478 Vali Loss: 1.2926064 Test Loss: 0.3462497
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 28 cost time: 1.6287486553192139
Epoch: 28, Steps: 52 | Train Loss: 0.3937622 Vali Loss: 1.2851921 Test Loss: 0.3452700
Validation loss decreased (1.287346 --> 1.285192).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 29 cost time: 1.633223533630371
Epoch: 29, Steps: 52 | Train Loss: 0.3921183 Vali Loss: 1.2893969 Test Loss: 0.3479847
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 30 cost time: 1.62957763671875
Epoch: 30, Steps: 52 | Train Loss: 0.3913334 Vali Loss: 1.2871182 Test Loss: 0.3452246
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 31 cost time: 1.6280620098114014
Epoch: 31, Steps: 52 | Train Loss: 0.3925675 Vali Loss: 1.2799253 Test Loss: 0.3457997
Validation loss decreased (1.285192 --> 1.279925).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 32 cost time: 1.6198182106018066
Epoch: 32, Steps: 52 | Train Loss: 0.3922290 Vali Loss: 1.2851264 Test Loss: 0.3459672
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 33 cost time: 1.6320457458496094
Epoch: 33, Steps: 52 | Train Loss: 0.3926177 Vali Loss: 1.2909470 Test Loss: 0.3457462
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 34 cost time: 1.6303703784942627
Epoch: 34, Steps: 52 | Train Loss: 0.3908000 Vali Loss: 1.2806339 Test Loss: 0.3448543
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 35 cost time: 1.6380579471588135
Epoch: 35, Steps: 52 | Train Loss: 0.3927573 Vali Loss: 1.2884240 Test Loss: 0.3451367
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 36 cost time: 1.6294891834259033
Epoch: 36, Steps: 52 | Train Loss: 0.3896211 Vali Loss: 1.2823994 Test Loss: 0.3460504
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 37 cost time: 1.628352165222168
Epoch: 37, Steps: 52 | Train Loss: 0.3919466 Vali Loss: 1.2860382 Test Loss: 0.3450894
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 38 cost time: 1.6299412250518799
Epoch: 38, Steps: 52 | Train Loss: 0.3921980 Vali Loss: 1.2907798 Test Loss: 0.3471815
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 39 cost time: 1.6371960639953613
Epoch: 39, Steps: 52 | Train Loss: 0.3923828 Vali Loss: 1.2830558 Test Loss: 0.3443398
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 40 cost time: 1.627605676651001
Epoch: 40, Steps: 52 | Train Loss: 0.3903352 Vali Loss: 1.2832129 Test Loss: 0.3440415
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 41 cost time: 1.6296954154968262
Epoch: 41, Steps: 52 | Train Loss: 0.3923414 Vali Loss: 1.2908831 Test Loss: 0.3452972
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 42 cost time: 1.6315290927886963
Epoch: 42, Steps: 52 | Train Loss: 0.3914508 Vali Loss: 1.2863784 Test Loss: 0.3451853
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 43 cost time: 1.6314232349395752
Epoch: 43, Steps: 52 | Train Loss: 0.3892035 Vali Loss: 1.2842281 Test Loss: 0.3448516
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 44 cost time: 1.6316249370574951
Epoch: 44, Steps: 52 | Train Loss: 0.3903094 Vali Loss: 1.2863333 Test Loss: 0.3456020
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 45 cost time: 1.6333937644958496
Epoch: 45, Steps: 52 | Train Loss: 0.3916084 Vali Loss: 1.2876158 Test Loss: 0.3450131
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 46 cost time: 1.6295180320739746
Epoch: 46, Steps: 52 | Train Loss: 0.3897047 Vali Loss: 1.2849174 Test Loss: 0.3457588
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 47 cost time: 1.63730788230896
Epoch: 47, Steps: 52 | Train Loss: 0.3913127 Vali Loss: 1.2878017 Test Loss: 0.3447728
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 48 cost time: 1.63319993019104
Epoch: 48, Steps: 52 | Train Loss: 0.3919029 Vali Loss: 1.2821847 Test Loss: 0.3456915
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 49 cost time: 1.6324646472930908
Epoch: 49, Steps: 52 | Train Loss: 0.3926728 Vali Loss: 1.2907715 Test Loss: 0.3463431
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 50 cost time: 1.628389835357666
Epoch: 50, Steps: 52 | Train Loss: 0.3917335 Vali Loss: 1.2905633 Test Loss: 0.3447718
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 51 cost time: 1.6339914798736572
Epoch: 51, Steps: 52 | Train Loss: 0.3921469 Vali Loss: 1.2813332 Test Loss: 0.3447085
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 52 cost time: 1.6303045749664307
Epoch: 52, Steps: 52 | Train Loss: 0.3919854 Vali Loss: 1.2838656 Test Loss: 0.3445331
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 53 cost time: 1.6349847316741943
Epoch: 53, Steps: 52 | Train Loss: 0.3918228 Vali Loss: 1.2857094 Test Loss: 0.3451086
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 54 cost time: 1.6287422180175781
Epoch: 54, Steps: 52 | Train Loss: 0.3919935 Vali Loss: 1.2897228 Test Loss: 0.3449268
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 55 cost time: 1.6348865032196045
Epoch: 55, Steps: 52 | Train Loss: 0.3895526 Vali Loss: 1.2776554 Test Loss: 0.3442242
Validation loss decreased (1.279925 --> 1.277655).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 56 cost time: 1.634009838104248
Epoch: 56, Steps: 52 | Train Loss: 0.3917004 Vali Loss: 1.2839020 Test Loss: 0.3447622
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 57 cost time: 1.6329588890075684
Epoch: 57, Steps: 52 | Train Loss: 0.3910989 Vali Loss: 1.2832073 Test Loss: 0.3445732
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 58 cost time: 1.6286046504974365
Epoch: 58, Steps: 52 | Train Loss: 0.3902481 Vali Loss: 1.2891073 Test Loss: 0.3456011
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 59 cost time: 1.6300013065338135
Epoch: 59, Steps: 52 | Train Loss: 0.3908648 Vali Loss: 1.2801472 Test Loss: 0.3452760
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 60 cost time: 1.629002571105957
Epoch: 60, Steps: 52 | Train Loss: 0.3917104 Vali Loss: 1.2874479 Test Loss: 0.3454144
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.344224214553833, mae:0.3929990530014038, rse:0.4806506633758545
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07322454452514648 GB
Epoch: 1 cost time: 2.1313676834106445
Epoch: 1, Steps: 52 | Train Loss: 0.6679020 Vali Loss: 2.0424998 Test Loss: 1.2923992
Validation loss decreased (inf --> 2.042500).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 2 cost time: 0.7618167400360107
Epoch: 2, Steps: 52 | Train Loss: 0.5337945 Vali Loss: 1.4166259 Test Loss: 0.4228563
Validation loss decreased (2.042500 --> 1.416626).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 3 cost time: 0.7608895301818848
Epoch: 3, Steps: 52 | Train Loss: 0.4359998 Vali Loss: 1.3661882 Test Loss: 0.3913062
Validation loss decreased (1.416626 --> 1.366188).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 4 cost time: 0.7584257125854492
Epoch: 4, Steps: 52 | Train Loss: 0.4183147 Vali Loss: 1.3360376 Test Loss: 0.3716897
Validation loss decreased (1.366188 --> 1.336038).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 5 cost time: 0.7709383964538574
Epoch: 5, Steps: 52 | Train Loss: 0.4107413 Vali Loss: 1.3199098 Test Loss: 0.3614556
Validation loss decreased (1.336038 --> 1.319910).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 6 cost time: 1.6703917980194092
Epoch: 6, Steps: 52 | Train Loss: 0.4070183 Vali Loss: 1.3104117 Test Loss: 0.3555342
Validation loss decreased (1.319910 --> 1.310412).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 7 cost time: 1.6868298053741455
Epoch: 7, Steps: 52 | Train Loss: 0.4041457 Vali Loss: 1.3088613 Test Loss: 0.3524255
Validation loss decreased (1.310412 --> 1.308861).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 8 cost time: 1.6878399848937988
Epoch: 8, Steps: 52 | Train Loss: 0.4002667 Vali Loss: 1.2941331 Test Loss: 0.3520637
Validation loss decreased (1.308861 --> 1.294133).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 9 cost time: 1.6927533149719238
Epoch: 9, Steps: 52 | Train Loss: 0.3991035 Vali Loss: 1.2991453 Test Loss: 0.3520200
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 10 cost time: 1.6862726211547852
Epoch: 10, Steps: 52 | Train Loss: 0.3976026 Vali Loss: 1.2939594 Test Loss: 0.3504343
Validation loss decreased (1.294133 --> 1.293959).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 11 cost time: 1.691943645477295
Epoch: 11, Steps: 52 | Train Loss: 0.3963899 Vali Loss: 1.2934333 Test Loss: 0.3505666
Validation loss decreased (1.293959 --> 1.293433).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 12 cost time: 1.6942589282989502
Epoch: 12, Steps: 52 | Train Loss: 0.3953982 Vali Loss: 1.2874923 Test Loss: 0.3500466
Validation loss decreased (1.293433 --> 1.287492).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 13 cost time: 1.6935961246490479
Epoch: 13, Steps: 52 | Train Loss: 0.3946185 Vali Loss: 1.2887299 Test Loss: 0.3496188
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 14 cost time: 1.6854932308197021
Epoch: 14, Steps: 52 | Train Loss: 0.3957602 Vali Loss: 1.2821908 Test Loss: 0.3473486
Validation loss decreased (1.287492 --> 1.282191).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 15 cost time: 1.687474250793457
Epoch: 15, Steps: 52 | Train Loss: 0.3941283 Vali Loss: 1.2783682 Test Loss: 0.3479557
Validation loss decreased (1.282191 --> 1.278368).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 16 cost time: 1.681549072265625
Epoch: 16, Steps: 52 | Train Loss: 0.3940573 Vali Loss: 1.2879367 Test Loss: 0.3471009
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 17 cost time: 1.6916992664337158
Epoch: 17, Steps: 52 | Train Loss: 0.3932184 Vali Loss: 1.2837117 Test Loss: 0.3452141
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 18 cost time: 1.6807608604431152
Epoch: 18, Steps: 52 | Train Loss: 0.3915127 Vali Loss: 1.2667155 Test Loss: 0.3453671
Validation loss decreased (1.278368 --> 1.266716).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 19 cost time: 1.6932377815246582
Epoch: 19, Steps: 52 | Train Loss: 0.3918257 Vali Loss: 1.2830766 Test Loss: 0.3451605
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 20 cost time: 1.6911745071411133
Epoch: 20, Steps: 52 | Train Loss: 0.3903781 Vali Loss: 1.2860718 Test Loss: 0.3445956
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 21 cost time: 1.681356430053711
Epoch: 21, Steps: 52 | Train Loss: 0.3911092 Vali Loss: 1.2830194 Test Loss: 0.3450710
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 22 cost time: 1.6842467784881592
Epoch: 22, Steps: 52 | Train Loss: 0.3899300 Vali Loss: 1.2800909 Test Loss: 0.3464174
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 23 cost time: 1.687328577041626
Epoch: 23, Steps: 52 | Train Loss: 0.3888747 Vali Loss: 1.2845517 Test Loss: 0.3461716
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 24 cost time: 1.6885030269622803
Epoch: 24, Steps: 52 | Train Loss: 0.3908476 Vali Loss: 1.2798331 Test Loss: 0.3455188
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 25 cost time: 1.684676170349121
Epoch: 25, Steps: 52 | Train Loss: 0.3909196 Vali Loss: 1.2759924 Test Loss: 0.3464071
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 26 cost time: 1.69026780128479
Epoch: 26, Steps: 52 | Train Loss: 0.3900107 Vali Loss: 1.2818730 Test Loss: 0.3459695
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 27 cost time: 1.6845946311950684
Epoch: 27, Steps: 52 | Train Loss: 0.3902798 Vali Loss: 1.2792628 Test Loss: 0.3450644
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 28 cost time: 1.6903371810913086
Epoch: 28, Steps: 52 | Train Loss: 0.3897928 Vali Loss: 1.2740135 Test Loss: 0.3445877
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 29 cost time: 1.687976598739624
Epoch: 29, Steps: 52 | Train Loss: 0.3893071 Vali Loss: 1.2744789 Test Loss: 0.3435706
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 30 cost time: 1.6935458183288574
Epoch: 30, Steps: 52 | Train Loss: 0.3895519 Vali Loss: 1.2841827 Test Loss: 0.3450462
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 31 cost time: 1.6834397315979004
Epoch: 31, Steps: 52 | Train Loss: 0.3885991 Vali Loss: 1.2783704 Test Loss: 0.3449731
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 32 cost time: 1.6868493556976318
Epoch: 32, Steps: 52 | Train Loss: 0.3900910 Vali Loss: 1.2760113 Test Loss: 0.3456802
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 33 cost time: 1.6842756271362305
Epoch: 33, Steps: 52 | Train Loss: 0.3886798 Vali Loss: 1.2802658 Test Loss: 0.3451695
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 34 cost time: 1.6942625045776367
Epoch: 34, Steps: 52 | Train Loss: 0.3905938 Vali Loss: 1.2643251 Test Loss: 0.3448740
Validation loss decreased (1.266716 --> 1.264325).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 35 cost time: 1.6876327991485596
Epoch: 35, Steps: 52 | Train Loss: 0.3883761 Vali Loss: 1.2689528 Test Loss: 0.3440663
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 36 cost time: 1.6916050910949707
Epoch: 36, Steps: 52 | Train Loss: 0.3900618 Vali Loss: 1.2784631 Test Loss: 0.3440798
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 37 cost time: 1.6843492984771729
Epoch: 37, Steps: 52 | Train Loss: 0.3901607 Vali Loss: 1.2701309 Test Loss: 0.3442530
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 38 cost time: 1.6924176216125488
Epoch: 38, Steps: 52 | Train Loss: 0.3885687 Vali Loss: 1.2825296 Test Loss: 0.3437943
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 39 cost time: 1.6826930046081543
Epoch: 39, Steps: 52 | Train Loss: 0.3891772 Vali Loss: 1.2756029 Test Loss: 0.3436295
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 40 cost time: 1.6931965351104736
Epoch: 40, Steps: 52 | Train Loss: 0.3876096 Vali Loss: 1.2770665 Test Loss: 0.3427888
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 41 cost time: 1.6870815753936768
Epoch: 41, Steps: 52 | Train Loss: 0.3893267 Vali Loss: 1.2773290 Test Loss: 0.3437414
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 42 cost time: 1.6882336139678955
Epoch: 42, Steps: 52 | Train Loss: 0.3883070 Vali Loss: 1.2756889 Test Loss: 0.3437628
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 43 cost time: 1.692821741104126
Epoch: 43, Steps: 52 | Train Loss: 0.3894370 Vali Loss: 1.2786669 Test Loss: 0.3443953
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 44 cost time: 1.6874454021453857
Epoch: 44, Steps: 52 | Train Loss: 0.3883402 Vali Loss: 1.2821989 Test Loss: 0.3443740
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 45 cost time: 1.6844227313995361
Epoch: 45, Steps: 52 | Train Loss: 0.3880238 Vali Loss: 1.2804896 Test Loss: 0.3434168
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 46 cost time: 1.6865105628967285
Epoch: 46, Steps: 52 | Train Loss: 0.3888518 Vali Loss: 1.2712836 Test Loss: 0.3452284
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 47 cost time: 1.6814486980438232
Epoch: 47, Steps: 52 | Train Loss: 0.3883552 Vali Loss: 1.2740554 Test Loss: 0.3439459
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 48 cost time: 1.686431646347046
Epoch: 48, Steps: 52 | Train Loss: 0.3899831 Vali Loss: 1.2746706 Test Loss: 0.3446252
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 49 cost time: 1.6945111751556396
Epoch: 49, Steps: 52 | Train Loss: 0.3897923 Vali Loss: 1.2766526 Test Loss: 0.3446506
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 50 cost time: 1.6918156147003174
Epoch: 50, Steps: 52 | Train Loss: 0.3878346 Vali Loss: 1.2699914 Test Loss: 0.3426596
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 51 cost time: 1.6909949779510498
Epoch: 51, Steps: 52 | Train Loss: 0.3888620 Vali Loss: 1.2775707 Test Loss: 0.3460515
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 52 cost time: 1.6836891174316406
Epoch: 52, Steps: 52 | Train Loss: 0.3882157 Vali Loss: 1.2772990 Test Loss: 0.3447079
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 53 cost time: 1.6848711967468262
Epoch: 53, Steps: 52 | Train Loss: 0.3875674 Vali Loss: 1.2783120 Test Loss: 0.3452960
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 54 cost time: 1.6902439594268799
Epoch: 54, Steps: 52 | Train Loss: 0.3874661 Vali Loss: 1.2760035 Test Loss: 0.3440336
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 55 cost time: 1.689692735671997
Epoch: 55, Steps: 52 | Train Loss: 0.3894001 Vali Loss: 1.2734430 Test Loss: 0.3433627
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 56 cost time: 1.6849548816680908
Epoch: 56, Steps: 52 | Train Loss: 0.3883604 Vali Loss: 1.2802639 Test Loss: 0.3436320
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 57 cost time: 1.6886639595031738
Epoch: 57, Steps: 52 | Train Loss: 0.3884795 Vali Loss: 1.2780836 Test Loss: 0.3424610
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 58 cost time: 1.6873884201049805
Epoch: 58, Steps: 52 | Train Loss: 0.3881573 Vali Loss: 1.2769613 Test Loss: 0.3438288
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 59 cost time: 1.6897180080413818
Epoch: 59, Steps: 52 | Train Loss: 0.3902423 Vali Loss: 1.2789230 Test Loss: 0.3432385
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 60 cost time: 1.689136028289795
Epoch: 60, Steps: 52 | Train Loss: 0.3884007 Vali Loss: 1.2806597 Test Loss: 0.3436370
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34487399458885193, mae:0.3959236443042755, rse:0.4811040461063385
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.06599807739257812 GB
Epoch: 1 cost time: 2.1076853275299072
Epoch: 1, Steps: 52 | Train Loss: 0.7861000 Vali Loss: 2.2643044 Test Loss: 1.5106798
Validation loss decreased (inf --> 2.264304).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 2 cost time: 0.7136037349700928
Epoch: 2, Steps: 52 | Train Loss: 0.6621120 Vali Loss: 1.7008500 Test Loss: 0.8293144
Validation loss decreased (2.264304 --> 1.700850).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 3 cost time: 0.7116119861602783
Epoch: 3, Steps: 52 | Train Loss: 0.5325424 Vali Loss: 1.4966583 Test Loss: 0.5433875
Validation loss decreased (1.700850 --> 1.496658).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 4 cost time: 0.7139678001403809
Epoch: 4, Steps: 52 | Train Loss: 0.4744516 Vali Loss: 1.4237180 Test Loss: 0.4457371
Validation loss decreased (1.496658 --> 1.423718).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 5 cost time: 0.7159981727600098
Epoch: 5, Steps: 52 | Train Loss: 0.4521964 Vali Loss: 1.3866702 Test Loss: 0.4079360
Validation loss decreased (1.423718 --> 1.386670).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 6 cost time: 1.358719825744629
Epoch: 6, Steps: 52 | Train Loss: 0.4402499 Vali Loss: 1.3719947 Test Loss: 0.3891715
Validation loss decreased (1.386670 --> 1.371995).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 7 cost time: 1.5910108089447021
Epoch: 7, Steps: 52 | Train Loss: 0.4310987 Vali Loss: 1.3581741 Test Loss: 0.3778104
Validation loss decreased (1.371995 --> 1.358174).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 8 cost time: 1.5879311561584473
Epoch: 8, Steps: 52 | Train Loss: 0.4273387 Vali Loss: 1.3505813 Test Loss: 0.3712998
Validation loss decreased (1.358174 --> 1.350581).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 9 cost time: 1.5874583721160889
Epoch: 9, Steps: 52 | Train Loss: 0.4232523 Vali Loss: 1.3358221 Test Loss: 0.3663598
Validation loss decreased (1.350581 --> 1.335822).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 10 cost time: 1.5854320526123047
Epoch: 10, Steps: 52 | Train Loss: 0.4191600 Vali Loss: 1.3371363 Test Loss: 0.3631318
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 11 cost time: 1.5846498012542725
Epoch: 11, Steps: 52 | Train Loss: 0.4188100 Vali Loss: 1.3285757 Test Loss: 0.3605677
Validation loss decreased (1.335822 --> 1.328576).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 12 cost time: 1.5910389423370361
Epoch: 12, Steps: 52 | Train Loss: 0.4155729 Vali Loss: 1.3285728 Test Loss: 0.3588678
Validation loss decreased (1.328576 --> 1.328573).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 13 cost time: 1.5879108905792236
Epoch: 13, Steps: 52 | Train Loss: 0.4131415 Vali Loss: 1.3145542 Test Loss: 0.3575001
Validation loss decreased (1.328573 --> 1.314554).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 14 cost time: 1.585623025894165
Epoch: 14, Steps: 52 | Train Loss: 0.4141501 Vali Loss: 1.3183862 Test Loss: 0.3564660
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 15 cost time: 1.5846197605133057
Epoch: 15, Steps: 52 | Train Loss: 0.4102502 Vali Loss: 1.3143803 Test Loss: 0.3546637
Validation loss decreased (1.314554 --> 1.314380).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 16 cost time: 1.5889368057250977
Epoch: 16, Steps: 52 | Train Loss: 0.4104345 Vali Loss: 1.3101594 Test Loss: 0.3539855
Validation loss decreased (1.314380 --> 1.310159).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 17 cost time: 1.5829236507415771
Epoch: 17, Steps: 52 | Train Loss: 0.4099584 Vali Loss: 1.3051702 Test Loss: 0.3531716
Validation loss decreased (1.310159 --> 1.305170).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 18 cost time: 1.590393304824829
Epoch: 18, Steps: 52 | Train Loss: 0.4088618 Vali Loss: 1.3007222 Test Loss: 0.3531464
Validation loss decreased (1.305170 --> 1.300722).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 19 cost time: 1.5807955265045166
Epoch: 19, Steps: 52 | Train Loss: 0.4067585 Vali Loss: 1.3073623 Test Loss: 0.3526235
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 20 cost time: 1.5818257331848145
Epoch: 20, Steps: 52 | Train Loss: 0.4051354 Vali Loss: 1.3026977 Test Loss: 0.3521823
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 21 cost time: 1.5839006900787354
Epoch: 21, Steps: 52 | Train Loss: 0.4072280 Vali Loss: 1.3065844 Test Loss: 0.3519495
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 22 cost time: 1.5881168842315674
Epoch: 22, Steps: 52 | Train Loss: 0.4076995 Vali Loss: 1.3059170 Test Loss: 0.3512956
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 23 cost time: 1.5856890678405762
Epoch: 23, Steps: 52 | Train Loss: 0.4045023 Vali Loss: 1.2978654 Test Loss: 0.3513030
Validation loss decreased (1.300722 --> 1.297865).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 24 cost time: 1.5888125896453857
Epoch: 24, Steps: 52 | Train Loss: 0.4052114 Vali Loss: 1.3042243 Test Loss: 0.3502241
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 25 cost time: 1.5858702659606934
Epoch: 25, Steps: 52 | Train Loss: 0.4057061 Vali Loss: 1.3028513 Test Loss: 0.3504013
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 26 cost time: 1.5866432189941406
Epoch: 26, Steps: 52 | Train Loss: 0.4044065 Vali Loss: 1.3065575 Test Loss: 0.3500386
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 27 cost time: 1.5849106311798096
Epoch: 27, Steps: 52 | Train Loss: 0.4033852 Vali Loss: 1.3013505 Test Loss: 0.3503452
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 28 cost time: 1.5896105766296387
Epoch: 28, Steps: 52 | Train Loss: 0.4042077 Vali Loss: 1.2983011 Test Loss: 0.3494477
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 29 cost time: 1.582592248916626
Epoch: 29, Steps: 52 | Train Loss: 0.4056292 Vali Loss: 1.2893118 Test Loss: 0.3491693
Validation loss decreased (1.297865 --> 1.289312).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 30 cost time: 1.5890746116638184
Epoch: 30, Steps: 52 | Train Loss: 0.4033959 Vali Loss: 1.2991155 Test Loss: 0.3491920
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 31 cost time: 1.5824575424194336
Epoch: 31, Steps: 52 | Train Loss: 0.4046864 Vali Loss: 1.2994435 Test Loss: 0.3494417
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 32 cost time: 1.5873830318450928
Epoch: 32, Steps: 52 | Train Loss: 0.4047790 Vali Loss: 1.3022927 Test Loss: 0.3497843
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 33 cost time: 1.5843408107757568
Epoch: 33, Steps: 52 | Train Loss: 0.4036189 Vali Loss: 1.2979119 Test Loss: 0.3485812
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 34 cost time: 1.5803906917572021
Epoch: 34, Steps: 52 | Train Loss: 0.4044712 Vali Loss: 1.2965087 Test Loss: 0.3493004
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 35 cost time: 1.581315517425537
Epoch: 35, Steps: 52 | Train Loss: 0.4038548 Vali Loss: 1.2960023 Test Loss: 0.3489565
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 36 cost time: 1.58799409866333
Epoch: 36, Steps: 52 | Train Loss: 0.4030895 Vali Loss: 1.2959769 Test Loss: 0.3487866
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 37 cost time: 1.5864133834838867
Epoch: 37, Steps: 52 | Train Loss: 0.4042981 Vali Loss: 1.3008389 Test Loss: 0.3492691
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 38 cost time: 1.5820295810699463
Epoch: 38, Steps: 52 | Train Loss: 0.4018883 Vali Loss: 1.2914778 Test Loss: 0.3487987
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 39 cost time: 1.5814998149871826
Epoch: 39, Steps: 52 | Train Loss: 0.4039149 Vali Loss: 1.2963729 Test Loss: 0.3486941
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 40 cost time: 1.5917470455169678
Epoch: 40, Steps: 52 | Train Loss: 0.4030630 Vali Loss: 1.2864623 Test Loss: 0.3490314
Validation loss decreased (1.289312 --> 1.286462).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 41 cost time: 1.5849244594573975
Epoch: 41, Steps: 52 | Train Loss: 0.4014760 Vali Loss: 1.2960064 Test Loss: 0.3501775
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 42 cost time: 1.5887064933776855
Epoch: 42, Steps: 52 | Train Loss: 0.4026619 Vali Loss: 1.2929790 Test Loss: 0.3490826
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 43 cost time: 1.5837900638580322
Epoch: 43, Steps: 52 | Train Loss: 0.4002079 Vali Loss: 1.2980678 Test Loss: 0.3502699
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 44 cost time: 1.585383415222168
Epoch: 44, Steps: 52 | Train Loss: 0.4012525 Vali Loss: 1.3019785 Test Loss: 0.3482366
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 45 cost time: 1.578195333480835
Epoch: 45, Steps: 52 | Train Loss: 0.4015084 Vali Loss: 1.3010074 Test Loss: 0.3494219
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 46 cost time: 1.5825016498565674
Epoch: 46, Steps: 52 | Train Loss: 0.4031881 Vali Loss: 1.2946066 Test Loss: 0.3497865
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 47 cost time: 1.5784077644348145
Epoch: 47, Steps: 52 | Train Loss: 0.4020788 Vali Loss: 1.2993499 Test Loss: 0.3489096
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 48 cost time: 1.577254295349121
Epoch: 48, Steps: 52 | Train Loss: 0.4026864 Vali Loss: 1.2982087 Test Loss: 0.3478437
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 49 cost time: 1.5806851387023926
Epoch: 49, Steps: 52 | Train Loss: 0.4035736 Vali Loss: 1.2924033 Test Loss: 0.3490515
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 50 cost time: 1.5817818641662598
Epoch: 50, Steps: 52 | Train Loss: 0.4028647 Vali Loss: 1.3024824 Test Loss: 0.3488408
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 51 cost time: 1.5740673542022705
Epoch: 51, Steps: 52 | Train Loss: 0.4028139 Vali Loss: 1.2934191 Test Loss: 0.3490601
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 52 cost time: 1.5763907432556152
Epoch: 52, Steps: 52 | Train Loss: 0.4024711 Vali Loss: 1.2959983 Test Loss: 0.3487911
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 53 cost time: 1.575608730316162
Epoch: 53, Steps: 52 | Train Loss: 0.3996967 Vali Loss: 1.2916331 Test Loss: 0.3481824
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 54 cost time: 1.5829665660858154
Epoch: 54, Steps: 52 | Train Loss: 0.4025066 Vali Loss: 1.2992523 Test Loss: 0.3486906
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 55 cost time: 1.5829746723175049
Epoch: 55, Steps: 52 | Train Loss: 0.4010947 Vali Loss: 1.2966779 Test Loss: 0.3487487
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 56 cost time: 1.578763484954834
Epoch: 56, Steps: 52 | Train Loss: 0.4033106 Vali Loss: 1.3004754 Test Loss: 0.3491968
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 57 cost time: 1.5851047039031982
Epoch: 57, Steps: 52 | Train Loss: 0.4012651 Vali Loss: 1.2909138 Test Loss: 0.3482353
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 58 cost time: 1.588487148284912
Epoch: 58, Steps: 52 | Train Loss: 0.4010697 Vali Loss: 1.2935805 Test Loss: 0.3488135
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 59 cost time: 1.5843725204467773
Epoch: 59, Steps: 52 | Train Loss: 0.4032187 Vali Loss: 1.2853262 Test Loss: 0.3484350
Validation loss decreased (1.286462 --> 1.285326).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 60 cost time: 1.5832550525665283
Epoch: 60, Steps: 52 | Train Loss: 0.4012490 Vali Loss: 1.2880858 Test Loss: 0.3492609
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3484349250793457, mae:0.3995048701763153, rse:0.48358145356178284
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.07027053833007812 GB
Epoch: 1 cost time: 2.131537437438965
Epoch: 1, Steps: 52 | Train Loss: 0.7107477 Vali Loss: 2.1265097 Test Loss: 1.3763143
Validation loss decreased (inf --> 2.126510).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 2 cost time: 0.747382640838623
Epoch: 2, Steps: 52 | Train Loss: 0.5527253 Vali Loss: 1.4296300 Test Loss: 0.4572393
Validation loss decreased (2.126510 --> 1.429630).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 3 cost time: 0.7439990043640137
Epoch: 3, Steps: 52 | Train Loss: 0.4384759 Vali Loss: 1.3677235 Test Loss: 0.3924638
Validation loss decreased (1.429630 --> 1.367723).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 4 cost time: 0.7596423625946045
Epoch: 4, Steps: 52 | Train Loss: 0.4219472 Vali Loss: 1.3399271 Test Loss: 0.3753382
Validation loss decreased (1.367723 --> 1.339927).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 5 cost time: 0.7314445972442627
Epoch: 5, Steps: 52 | Train Loss: 0.4151776 Vali Loss: 1.3364694 Test Loss: 0.3684632
Validation loss decreased (1.339927 --> 1.336469).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 6 cost time: 1.628629446029663
Epoch: 6, Steps: 52 | Train Loss: 0.4108183 Vali Loss: 1.3304694 Test Loss: 0.3631244
Validation loss decreased (1.336469 --> 1.330469).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 7 cost time: 1.6380159854888916
Epoch: 7, Steps: 52 | Train Loss: 0.4063330 Vali Loss: 1.3231648 Test Loss: 0.3597528
Validation loss decreased (1.330469 --> 1.323165).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 8 cost time: 1.6445708274841309
Epoch: 8, Steps: 52 | Train Loss: 0.4064946 Vali Loss: 1.3181295 Test Loss: 0.3581358
Validation loss decreased (1.323165 --> 1.318130).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 9 cost time: 1.6459341049194336
Epoch: 9, Steps: 52 | Train Loss: 0.4030558 Vali Loss: 1.3113387 Test Loss: 0.3558666
Validation loss decreased (1.318130 --> 1.311339).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 10 cost time: 1.6477842330932617
Epoch: 10, Steps: 52 | Train Loss: 0.3995589 Vali Loss: 1.3099546 Test Loss: 0.3536209
Validation loss decreased (1.311339 --> 1.309955).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 11 cost time: 1.6468393802642822
Epoch: 11, Steps: 52 | Train Loss: 0.3997435 Vali Loss: 1.3025150 Test Loss: 0.3525269
Validation loss decreased (1.309955 --> 1.302515).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 12 cost time: 1.6514184474945068
Epoch: 12, Steps: 52 | Train Loss: 0.3987025 Vali Loss: 1.2957599 Test Loss: 0.3517368
Validation loss decreased (1.302515 --> 1.295760).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 13 cost time: 1.6513416767120361
Epoch: 13, Steps: 52 | Train Loss: 0.3974456 Vali Loss: 1.2987864 Test Loss: 0.3515534
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 14 cost time: 1.6493127346038818
Epoch: 14, Steps: 52 | Train Loss: 0.3956915 Vali Loss: 1.2841566 Test Loss: 0.3495277
Validation loss decreased (1.295760 --> 1.284157).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 15 cost time: 1.645172119140625
Epoch: 15, Steps: 52 | Train Loss: 0.3957274 Vali Loss: 1.2946649 Test Loss: 0.3498489
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 16 cost time: 1.640368938446045
Epoch: 16, Steps: 52 | Train Loss: 0.3954995 Vali Loss: 1.2852798 Test Loss: 0.3491128
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 17 cost time: 1.6423938274383545
Epoch: 17, Steps: 52 | Train Loss: 0.3957208 Vali Loss: 1.2953336 Test Loss: 0.3490842
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 18 cost time: 1.638253927230835
Epoch: 18, Steps: 52 | Train Loss: 0.3950914 Vali Loss: 1.2780195 Test Loss: 0.3484413
Validation loss decreased (1.284157 --> 1.278020).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 19 cost time: 1.6474366188049316
Epoch: 19, Steps: 52 | Train Loss: 0.3930314 Vali Loss: 1.2932987 Test Loss: 0.3477712
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 20 cost time: 1.6433818340301514
Epoch: 20, Steps: 52 | Train Loss: 0.3949638 Vali Loss: 1.2800252 Test Loss: 0.3480595
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 21 cost time: 1.6420860290527344
Epoch: 21, Steps: 52 | Train Loss: 0.3944783 Vali Loss: 1.2905667 Test Loss: 0.3478469
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 22 cost time: 1.6400737762451172
Epoch: 22, Steps: 52 | Train Loss: 0.3953120 Vali Loss: 1.2829275 Test Loss: 0.3473519
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 23 cost time: 1.6453802585601807
Epoch: 23, Steps: 52 | Train Loss: 0.3917403 Vali Loss: 1.2873793 Test Loss: 0.3469436
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 24 cost time: 1.6477885246276855
Epoch: 24, Steps: 52 | Train Loss: 0.3935736 Vali Loss: 1.2786360 Test Loss: 0.3472103
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 25 cost time: 1.6484498977661133
Epoch: 25, Steps: 52 | Train Loss: 0.3934605 Vali Loss: 1.2808779 Test Loss: 0.3472435
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 26 cost time: 1.6454334259033203
Epoch: 26, Steps: 52 | Train Loss: 0.3927272 Vali Loss: 1.2846398 Test Loss: 0.3470420
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 27 cost time: 1.644482135772705
Epoch: 27, Steps: 52 | Train Loss: 0.3914837 Vali Loss: 1.2854290 Test Loss: 0.3466569
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 28 cost time: 1.6437385082244873
Epoch: 28, Steps: 52 | Train Loss: 0.3912361 Vali Loss: 1.2870829 Test Loss: 0.3464564
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 29 cost time: 1.641247034072876
Epoch: 29, Steps: 52 | Train Loss: 0.3928725 Vali Loss: 1.2790556 Test Loss: 0.3462109
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 30 cost time: 1.6430160999298096
Epoch: 30, Steps: 52 | Train Loss: 0.3922062 Vali Loss: 1.2822224 Test Loss: 0.3460325
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 31 cost time: 1.6459946632385254
Epoch: 31, Steps: 52 | Train Loss: 0.3918661 Vali Loss: 1.2829630 Test Loss: 0.3464627
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 32 cost time: 1.6647346019744873
Epoch: 32, Steps: 52 | Train Loss: 0.3926084 Vali Loss: 1.2842855 Test Loss: 0.3464300
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 33 cost time: 1.6470987796783447
Epoch: 33, Steps: 52 | Train Loss: 0.3909380 Vali Loss: 1.2799821 Test Loss: 0.3461574
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 34 cost time: 1.6448729038238525
Epoch: 34, Steps: 52 | Train Loss: 0.3923465 Vali Loss: 1.2855530 Test Loss: 0.3457654
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 35 cost time: 1.6434955596923828
Epoch: 35, Steps: 52 | Train Loss: 0.3919574 Vali Loss: 1.2805622 Test Loss: 0.3457016
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 36 cost time: 1.6512153148651123
Epoch: 36, Steps: 52 | Train Loss: 0.3914504 Vali Loss: 1.2859080 Test Loss: 0.3455133
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 37 cost time: 1.6492300033569336
Epoch: 37, Steps: 52 | Train Loss: 0.3908152 Vali Loss: 1.2801104 Test Loss: 0.3453523
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 38 cost time: 1.648174524307251
Epoch: 38, Steps: 52 | Train Loss: 0.3908024 Vali Loss: 1.2858671 Test Loss: 0.3464818
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 39 cost time: 1.644906759262085
Epoch: 39, Steps: 52 | Train Loss: 0.3913345 Vali Loss: 1.2850947 Test Loss: 0.3458214
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 40 cost time: 1.6487841606140137
Epoch: 40, Steps: 52 | Train Loss: 0.3921915 Vali Loss: 1.2842944 Test Loss: 0.3454695
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 41 cost time: 1.6439979076385498
Epoch: 41, Steps: 52 | Train Loss: 0.3908324 Vali Loss: 1.2798755 Test Loss: 0.3452377
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 42 cost time: 1.6495790481567383
Epoch: 42, Steps: 52 | Train Loss: 0.3903636 Vali Loss: 1.2687460 Test Loss: 0.3460860
Validation loss decreased (1.278020 --> 1.268746).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 43 cost time: 1.6461284160614014
Epoch: 43, Steps: 52 | Train Loss: 0.3923834 Vali Loss: 1.2849340 Test Loss: 0.3454128
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 44 cost time: 1.650862693786621
Epoch: 44, Steps: 52 | Train Loss: 0.3901227 Vali Loss: 1.2746196 Test Loss: 0.3461545
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 45 cost time: 1.6463806629180908
Epoch: 45, Steps: 52 | Train Loss: 0.3902751 Vali Loss: 1.2810472 Test Loss: 0.3457104
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 46 cost time: 1.6515145301818848
Epoch: 46, Steps: 52 | Train Loss: 0.3918415 Vali Loss: 1.2769165 Test Loss: 0.3453651
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 47 cost time: 1.6437997817993164
Epoch: 47, Steps: 52 | Train Loss: 0.3907874 Vali Loss: 1.2859560 Test Loss: 0.3467253
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 48 cost time: 1.6478333473205566
Epoch: 48, Steps: 52 | Train Loss: 0.3922712 Vali Loss: 1.2831171 Test Loss: 0.3454590
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 49 cost time: 1.6448001861572266
Epoch: 49, Steps: 52 | Train Loss: 0.3901576 Vali Loss: 1.2855237 Test Loss: 0.3454064
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 50 cost time: 1.6485316753387451
Epoch: 50, Steps: 52 | Train Loss: 0.3903685 Vali Loss: 1.2707460 Test Loss: 0.3460994
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 51 cost time: 1.6432933807373047
Epoch: 51, Steps: 52 | Train Loss: 0.3918183 Vali Loss: 1.2833215 Test Loss: 0.3451080
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 52 cost time: 1.6404314041137695
Epoch: 52, Steps: 52 | Train Loss: 0.3907322 Vali Loss: 1.2809933 Test Loss: 0.3452558
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 53 cost time: 1.6437005996704102
Epoch: 53, Steps: 52 | Train Loss: 0.3900888 Vali Loss: 1.2762802 Test Loss: 0.3448230
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 54 cost time: 1.6502037048339844
Epoch: 54, Steps: 52 | Train Loss: 0.3913458 Vali Loss: 1.2792709 Test Loss: 0.3462276
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 55 cost time: 1.643256664276123
Epoch: 55, Steps: 52 | Train Loss: 0.3917418 Vali Loss: 1.2798626 Test Loss: 0.3450546
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 56 cost time: 1.64570951461792
Epoch: 56, Steps: 52 | Train Loss: 0.3915801 Vali Loss: 1.2769055 Test Loss: 0.3466176
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 57 cost time: 1.6425938606262207
Epoch: 57, Steps: 52 | Train Loss: 0.3900061 Vali Loss: 1.2770581 Test Loss: 0.3453180
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 58 cost time: 1.6462340354919434
Epoch: 58, Steps: 52 | Train Loss: 0.3899021 Vali Loss: 1.2826915 Test Loss: 0.3459492
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 59 cost time: 1.645493984222412
Epoch: 59, Steps: 52 | Train Loss: 0.3900348 Vali Loss: 1.2831306 Test Loss: 0.3466454
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 60 cost time: 1.6447803974151611
Epoch: 60, Steps: 52 | Train Loss: 0.3899709 Vali Loss: 1.2848686 Test Loss: 0.3457620
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3460860550403595, mae:0.39608922600746155, rse:0.48194873332977295
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07338619232177734 GB
Epoch: 1 cost time: 2.121875047683716
Epoch: 1, Steps: 52 | Train Loss: 0.6782027 Vali Loss: 2.0954995 Test Loss: 1.3294460
Validation loss decreased (inf --> 2.095500).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 2 cost time: 0.7704229354858398
Epoch: 2, Steps: 52 | Train Loss: 0.5308229 Vali Loss: 1.4102722 Test Loss: 0.4187862
Validation loss decreased (2.095500 --> 1.410272).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 3 cost time: 0.7579998970031738
Epoch: 3, Steps: 52 | Train Loss: 0.4307016 Vali Loss: 1.3596973 Test Loss: 0.3895354
Validation loss decreased (1.410272 --> 1.359697).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 4 cost time: 0.7734105587005615
Epoch: 4, Steps: 52 | Train Loss: 0.4153991 Vali Loss: 1.3291990 Test Loss: 0.3704132
Validation loss decreased (1.359697 --> 1.329199).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 5 cost time: 0.7674949169158936
Epoch: 5, Steps: 52 | Train Loss: 0.4093940 Vali Loss: 1.3242666 Test Loss: 0.3622901
Validation loss decreased (1.329199 --> 1.324267).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 6 cost time: 1.680224895477295
Epoch: 6, Steps: 52 | Train Loss: 0.4053363 Vali Loss: 1.3182781 Test Loss: 0.3575217
Validation loss decreased (1.324267 --> 1.318278).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 7 cost time: 1.6859455108642578
Epoch: 7, Steps: 52 | Train Loss: 0.4011038 Vali Loss: 1.3033880 Test Loss: 0.3545673
Validation loss decreased (1.318278 --> 1.303388).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 8 cost time: 1.7093219757080078
Epoch: 8, Steps: 52 | Train Loss: 0.4005895 Vali Loss: 1.3073936 Test Loss: 0.3545927
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 9 cost time: 1.7014033794403076
Epoch: 9, Steps: 52 | Train Loss: 0.4001146 Vali Loss: 1.2987354 Test Loss: 0.3525076
Validation loss decreased (1.303388 --> 1.298735).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 10 cost time: 1.7067170143127441
Epoch: 10, Steps: 52 | Train Loss: 0.3979810 Vali Loss: 1.2954878 Test Loss: 0.3517281
Validation loss decreased (1.298735 --> 1.295488).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 11 cost time: 1.6996233463287354
Epoch: 11, Steps: 52 | Train Loss: 0.3956879 Vali Loss: 1.2859298 Test Loss: 0.3507982
Validation loss decreased (1.295488 --> 1.285930).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 12 cost time: 1.7089083194732666
Epoch: 12, Steps: 52 | Train Loss: 0.3952864 Vali Loss: 1.2843096 Test Loss: 0.3493220
Validation loss decreased (1.285930 --> 1.284310).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 13 cost time: 1.698455810546875
Epoch: 13, Steps: 52 | Train Loss: 0.3944383 Vali Loss: 1.2884171 Test Loss: 0.3491154
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 14 cost time: 1.695469856262207
Epoch: 14, Steps: 52 | Train Loss: 0.3945545 Vali Loss: 1.2854011 Test Loss: 0.3502715
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 15 cost time: 1.693141222000122
Epoch: 15, Steps: 52 | Train Loss: 0.3922584 Vali Loss: 1.2850420 Test Loss: 0.3494300
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 16 cost time: 1.6997723579406738
Epoch: 16, Steps: 52 | Train Loss: 0.3928432 Vali Loss: 1.2799827 Test Loss: 0.3500232
Validation loss decreased (1.284310 --> 1.279983).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 17 cost time: 1.6937594413757324
Epoch: 17, Steps: 52 | Train Loss: 0.3922055 Vali Loss: 1.2796996 Test Loss: 0.3497041
Validation loss decreased (1.279983 --> 1.279700).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 18 cost time: 1.6920957565307617
Epoch: 18, Steps: 52 | Train Loss: 0.3926003 Vali Loss: 1.2731841 Test Loss: 0.3489415
Validation loss decreased (1.279700 --> 1.273184).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 19 cost time: 1.6952576637268066
Epoch: 19, Steps: 52 | Train Loss: 0.3916879 Vali Loss: 1.2863178 Test Loss: 0.3478947
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 20 cost time: 1.6920173168182373
Epoch: 20, Steps: 52 | Train Loss: 0.3913105 Vali Loss: 1.2791495 Test Loss: 0.3491122
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 21 cost time: 1.6996479034423828
Epoch: 21, Steps: 52 | Train Loss: 0.3896763 Vali Loss: 1.2807876 Test Loss: 0.3470027
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 22 cost time: 1.6960625648498535
Epoch: 22, Steps: 52 | Train Loss: 0.3895689 Vali Loss: 1.2776985 Test Loss: 0.3475370
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 23 cost time: 1.6938040256500244
Epoch: 23, Steps: 52 | Train Loss: 0.3901765 Vali Loss: 1.2761452 Test Loss: 0.3466134
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 24 cost time: 1.6952533721923828
Epoch: 24, Steps: 52 | Train Loss: 0.3907579 Vali Loss: 1.2833359 Test Loss: 0.3471239
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 25 cost time: 1.697087287902832
Epoch: 25, Steps: 52 | Train Loss: 0.3893361 Vali Loss: 1.2815009 Test Loss: 0.3481187
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 26 cost time: 1.6947920322418213
Epoch: 26, Steps: 52 | Train Loss: 0.3898659 Vali Loss: 1.2817078 Test Loss: 0.3459793
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 27 cost time: 1.7020657062530518
Epoch: 27, Steps: 52 | Train Loss: 0.3899233 Vali Loss: 1.2842038 Test Loss: 0.3478543
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 28 cost time: 1.6961543560028076
Epoch: 28, Steps: 52 | Train Loss: 0.3886962 Vali Loss: 1.2808641 Test Loss: 0.3468672
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 29 cost time: 1.6944246292114258
Epoch: 29, Steps: 52 | Train Loss: 0.3892199 Vali Loss: 1.2711725 Test Loss: 0.3474984
Validation loss decreased (1.273184 --> 1.271173).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 30 cost time: 1.6943342685699463
Epoch: 30, Steps: 52 | Train Loss: 0.3902290 Vali Loss: 1.2752645 Test Loss: 0.3467172
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 31 cost time: 1.6999828815460205
Epoch: 31, Steps: 52 | Train Loss: 0.3881405 Vali Loss: 1.2780973 Test Loss: 0.3471003
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 32 cost time: 1.6940391063690186
Epoch: 32, Steps: 52 | Train Loss: 0.3907015 Vali Loss: 1.2790322 Test Loss: 0.3474669
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 33 cost time: 1.6982641220092773
Epoch: 33, Steps: 52 | Train Loss: 0.3907925 Vali Loss: 1.2794194 Test Loss: 0.3455138
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 34 cost time: 1.6947925090789795
Epoch: 34, Steps: 52 | Train Loss: 0.3893388 Vali Loss: 1.2790706 Test Loss: 0.3455502
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 35 cost time: 1.693436622619629
Epoch: 35, Steps: 52 | Train Loss: 0.3867531 Vali Loss: 1.2651901 Test Loss: 0.3466888
Validation loss decreased (1.271173 --> 1.265190).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 36 cost time: 1.6960058212280273
Epoch: 36, Steps: 52 | Train Loss: 0.3883783 Vali Loss: 1.2723339 Test Loss: 0.3468652
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 37 cost time: 1.6966884136199951
Epoch: 37, Steps: 52 | Train Loss: 0.3893205 Vali Loss: 1.2777324 Test Loss: 0.3470124
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 38 cost time: 1.700026035308838
Epoch: 38, Steps: 52 | Train Loss: 0.3887379 Vali Loss: 1.2815028 Test Loss: 0.3454481
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 39 cost time: 1.6944501399993896
Epoch: 39, Steps: 52 | Train Loss: 0.3880925 Vali Loss: 1.2772779 Test Loss: 0.3469390
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 40 cost time: 1.6958436965942383
Epoch: 40, Steps: 52 | Train Loss: 0.3885172 Vali Loss: 1.2744579 Test Loss: 0.3472290
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 41 cost time: 1.695385456085205
Epoch: 41, Steps: 52 | Train Loss: 0.3883251 Vali Loss: 1.2705808 Test Loss: 0.3463217
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 42 cost time: 1.7028729915618896
Epoch: 42, Steps: 52 | Train Loss: 0.3884821 Vali Loss: 1.2805336 Test Loss: 0.3465332
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 43 cost time: 1.6972754001617432
Epoch: 43, Steps: 52 | Train Loss: 0.3884656 Vali Loss: 1.2804015 Test Loss: 0.3466579
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 44 cost time: 1.699695110321045
Epoch: 44, Steps: 52 | Train Loss: 0.3886087 Vali Loss: 1.2772151 Test Loss: 0.3463584
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 45 cost time: 1.6958494186401367
Epoch: 45, Steps: 52 | Train Loss: 0.3894332 Vali Loss: 1.2782779 Test Loss: 0.3470277
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 46 cost time: 1.702784776687622
Epoch: 46, Steps: 52 | Train Loss: 0.3877145 Vali Loss: 1.2722719 Test Loss: 0.3459427
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 47 cost time: 1.6956377029418945
Epoch: 47, Steps: 52 | Train Loss: 0.3885558 Vali Loss: 1.2759788 Test Loss: 0.3461210
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 48 cost time: 1.700307846069336
Epoch: 48, Steps: 52 | Train Loss: 0.3883160 Vali Loss: 1.2797387 Test Loss: 0.3464950
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 49 cost time: 1.6989719867706299
Epoch: 49, Steps: 52 | Train Loss: 0.3890315 Vali Loss: 1.2733042 Test Loss: 0.3461671
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 50 cost time: 1.702824592590332
Epoch: 50, Steps: 52 | Train Loss: 0.3888231 Vali Loss: 1.2709937 Test Loss: 0.3464537
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 51 cost time: 1.6932992935180664
Epoch: 51, Steps: 52 | Train Loss: 0.3889393 Vali Loss: 1.2820287 Test Loss: 0.3456602
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 52 cost time: 1.6969645023345947
Epoch: 52, Steps: 52 | Train Loss: 0.3880019 Vali Loss: 1.2770798 Test Loss: 0.3458229
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 53 cost time: 1.6955664157867432
Epoch: 53, Steps: 52 | Train Loss: 0.3885837 Vali Loss: 1.2775581 Test Loss: 0.3457187
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 54 cost time: 1.692511796951294
Epoch: 54, Steps: 52 | Train Loss: 0.3889359 Vali Loss: 1.2751234 Test Loss: 0.3457939
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 55 cost time: 1.6976025104522705
Epoch: 55, Steps: 52 | Train Loss: 0.3892710 Vali Loss: 1.2733126 Test Loss: 0.3463898
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 56 cost time: 1.6905741691589355
Epoch: 56, Steps: 52 | Train Loss: 0.3899602 Vali Loss: 1.2820235 Test Loss: 0.3456654
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 57 cost time: 1.691237211227417
Epoch: 57, Steps: 52 | Train Loss: 0.3883638 Vali Loss: 1.2814215 Test Loss: 0.3469042
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 58 cost time: 1.695594310760498
Epoch: 58, Steps: 52 | Train Loss: 0.3881144 Vali Loss: 1.2776539 Test Loss: 0.3456294
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 59 cost time: 1.6981358528137207
Epoch: 59, Steps: 52 | Train Loss: 0.3896736 Vali Loss: 1.2760558 Test Loss: 0.3456225
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 60 cost time: 1.6942768096923828
Epoch: 60, Steps: 52 | Train Loss: 0.3895856 Vali Loss: 1.2705103 Test Loss: 0.3454165
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34668877720832825, mae:0.39856478571891785, rse:0.48236823081970215
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.06616020202636719 GB
Epoch: 1 cost time: 2.104203701019287
Epoch: 1, Steps: 52 | Train Loss: 0.7766979 Vali Loss: 2.2614202 Test Loss: 1.4647442
Validation loss decreased (inf --> 2.261420).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 2 cost time: 0.7147176265716553
Epoch: 2, Steps: 52 | Train Loss: 0.6673469 Vali Loss: 1.7345457 Test Loss: 0.8602562
Validation loss decreased (2.261420 --> 1.734546).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 3 cost time: 0.7123456001281738
Epoch: 3, Steps: 52 | Train Loss: 0.5321468 Vali Loss: 1.4992568 Test Loss: 0.5392646
Validation loss decreased (1.734546 --> 1.499257).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 4 cost time: 0.7199997901916504
Epoch: 4, Steps: 52 | Train Loss: 0.4725081 Vali Loss: 1.4133660 Test Loss: 0.4355291
Validation loss decreased (1.499257 --> 1.413366).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 5 cost time: 0.7159876823425293
Epoch: 5, Steps: 52 | Train Loss: 0.4472009 Vali Loss: 1.3934031 Test Loss: 0.4025630
Validation loss decreased (1.413366 --> 1.393403).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 6 cost time: 1.4167935848236084
Epoch: 6, Steps: 52 | Train Loss: 0.4391529 Vali Loss: 1.3708065 Test Loss: 0.3854297
Validation loss decreased (1.393403 --> 1.370806).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 7 cost time: 1.601086139678955
Epoch: 7, Steps: 52 | Train Loss: 0.4303089 Vali Loss: 1.3535444 Test Loss: 0.3755344
Validation loss decreased (1.370806 --> 1.353544).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 8 cost time: 1.5991010665893555
Epoch: 8, Steps: 52 | Train Loss: 0.4239987 Vali Loss: 1.3472478 Test Loss: 0.3686168
Validation loss decreased (1.353544 --> 1.347248).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 9 cost time: 1.5990617275238037
Epoch: 9, Steps: 52 | Train Loss: 0.4202579 Vali Loss: 1.3349576 Test Loss: 0.3647611
Validation loss decreased (1.347248 --> 1.334958).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 10 cost time: 1.6041557788848877
Epoch: 10, Steps: 52 | Train Loss: 0.4164617 Vali Loss: 1.3193834 Test Loss: 0.3607133
Validation loss decreased (1.334958 --> 1.319383).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 11 cost time: 1.5993232727050781
Epoch: 11, Steps: 52 | Train Loss: 0.4146129 Vali Loss: 1.3280659 Test Loss: 0.3587648
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 12 cost time: 1.5996298789978027
Epoch: 12, Steps: 52 | Train Loss: 0.4139001 Vali Loss: 1.3181479 Test Loss: 0.3566670
Validation loss decreased (1.319383 --> 1.318148).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 13 cost time: 1.5958564281463623
Epoch: 13, Steps: 52 | Train Loss: 0.4118292 Vali Loss: 1.3184465 Test Loss: 0.3550138
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 14 cost time: 1.6002721786499023
Epoch: 14, Steps: 52 | Train Loss: 0.4109751 Vali Loss: 1.3125341 Test Loss: 0.3540851
Validation loss decreased (1.318148 --> 1.312534).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 15 cost time: 1.6019511222839355
Epoch: 15, Steps: 52 | Train Loss: 0.4102367 Vali Loss: 1.3091381 Test Loss: 0.3521762
Validation loss decreased (1.312534 --> 1.309138).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 16 cost time: 1.6065399646759033
Epoch: 16, Steps: 52 | Train Loss: 0.4082265 Vali Loss: 1.3099185 Test Loss: 0.3514623
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 17 cost time: 1.599426031112671
Epoch: 17, Steps: 52 | Train Loss: 0.4053151 Vali Loss: 1.2994272 Test Loss: 0.3509638
Validation loss decreased (1.309138 --> 1.299427).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 18 cost time: 1.6017448902130127
Epoch: 18, Steps: 52 | Train Loss: 0.4063482 Vali Loss: 1.3052902 Test Loss: 0.3502887
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 19 cost time: 1.5963473320007324
Epoch: 19, Steps: 52 | Train Loss: 0.4061758 Vali Loss: 1.3091927 Test Loss: 0.3492370
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 20 cost time: 1.597285270690918
Epoch: 20, Steps: 52 | Train Loss: 0.4053001 Vali Loss: 1.3021296 Test Loss: 0.3484770
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 21 cost time: 1.5961809158325195
Epoch: 21, Steps: 52 | Train Loss: 0.4054658 Vali Loss: 1.3050299 Test Loss: 0.3480636
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 22 cost time: 1.6050376892089844
Epoch: 22, Steps: 52 | Train Loss: 0.4036325 Vali Loss: 1.3015113 Test Loss: 0.3478510
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 23 cost time: 1.5977325439453125
Epoch: 23, Steps: 52 | Train Loss: 0.4061485 Vali Loss: 1.3048568 Test Loss: 0.3478800
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 24 cost time: 1.6055142879486084
Epoch: 24, Steps: 52 | Train Loss: 0.4035449 Vali Loss: 1.2923292 Test Loss: 0.3473914
Validation loss decreased (1.299427 --> 1.292329).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 25 cost time: 1.6010468006134033
Epoch: 25, Steps: 52 | Train Loss: 0.4020364 Vali Loss: 1.2976867 Test Loss: 0.3465471
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 26 cost time: 1.6134040355682373
Epoch: 26, Steps: 52 | Train Loss: 0.4031669 Vali Loss: 1.3018574 Test Loss: 0.3468040
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 27 cost time: 1.6401166915893555
Epoch: 27, Steps: 52 | Train Loss: 0.4037161 Vali Loss: 1.3036972 Test Loss: 0.3463157
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 28 cost time: 1.6089985370635986
Epoch: 28, Steps: 52 | Train Loss: 0.4017852 Vali Loss: 1.2967052 Test Loss: 0.3456369
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 29 cost time: 1.6100027561187744
Epoch: 29, Steps: 52 | Train Loss: 0.4013543 Vali Loss: 1.2851225 Test Loss: 0.3455672
Validation loss decreased (1.292329 --> 1.285123).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 30 cost time: 1.613002061843872
Epoch: 30, Steps: 52 | Train Loss: 0.4010454 Vali Loss: 1.2889988 Test Loss: 0.3442820
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 31 cost time: 1.6099987030029297
Epoch: 31, Steps: 52 | Train Loss: 0.4008492 Vali Loss: 1.2956975 Test Loss: 0.3449548
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 32 cost time: 1.6089973449707031
Epoch: 32, Steps: 52 | Train Loss: 0.4016366 Vali Loss: 1.2956932 Test Loss: 0.3438481
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 33 cost time: 1.6089987754821777
Epoch: 33, Steps: 52 | Train Loss: 0.4006837 Vali Loss: 1.2927485 Test Loss: 0.3453648
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 34 cost time: 1.609001874923706
Epoch: 34, Steps: 52 | Train Loss: 0.4011296 Vali Loss: 1.2963212 Test Loss: 0.3447374
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 35 cost time: 1.607001781463623
Epoch: 35, Steps: 52 | Train Loss: 0.4016679 Vali Loss: 1.2944089 Test Loss: 0.3444788
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 36 cost time: 1.6109981536865234
Epoch: 36, Steps: 52 | Train Loss: 0.4004897 Vali Loss: 1.2967395 Test Loss: 0.3445613
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 37 cost time: 1.7059986591339111
Epoch: 37, Steps: 52 | Train Loss: 0.3997820 Vali Loss: 1.3003974 Test Loss: 0.3451576
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 38 cost time: 1.672642469406128
Epoch: 38, Steps: 52 | Train Loss: 0.4011359 Vali Loss: 1.2869210 Test Loss: 0.3455597
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 39 cost time: 1.6688222885131836
Epoch: 39, Steps: 52 | Train Loss: 0.4010807 Vali Loss: 1.2852666 Test Loss: 0.3447563
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 40 cost time: 1.6735124588012695
Epoch: 40, Steps: 52 | Train Loss: 0.4011656 Vali Loss: 1.3005280 Test Loss: 0.3442439
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 41 cost time: 1.6676216125488281
Epoch: 41, Steps: 52 | Train Loss: 0.4019415 Vali Loss: 1.2827618 Test Loss: 0.3444051
Validation loss decreased (1.285123 --> 1.282762).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 42 cost time: 1.6724858283996582
Epoch: 42, Steps: 52 | Train Loss: 0.4020670 Vali Loss: 1.2912083 Test Loss: 0.3446631
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 43 cost time: 1.6701972484588623
Epoch: 43, Steps: 52 | Train Loss: 0.4004422 Vali Loss: 1.2952039 Test Loss: 0.3448533
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 44 cost time: 1.6699073314666748
Epoch: 44, Steps: 52 | Train Loss: 0.4008788 Vali Loss: 1.2901809 Test Loss: 0.3446090
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 45 cost time: 1.666553020477295
Epoch: 45, Steps: 52 | Train Loss: 0.4001359 Vali Loss: 1.2954209 Test Loss: 0.3442545
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 46 cost time: 1.6683447360992432
Epoch: 46, Steps: 52 | Train Loss: 0.4002781 Vali Loss: 1.2852106 Test Loss: 0.3426264
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 47 cost time: 1.6618738174438477
Epoch: 47, Steps: 52 | Train Loss: 0.4003173 Vali Loss: 1.2936804 Test Loss: 0.3434164
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 48 cost time: 1.6671810150146484
Epoch: 48, Steps: 52 | Train Loss: 0.4006089 Vali Loss: 1.2856586 Test Loss: 0.3431680
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 49 cost time: 1.668539047241211
Epoch: 49, Steps: 52 | Train Loss: 0.4003494 Vali Loss: 1.2939007 Test Loss: 0.3435702
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 50 cost time: 1.665921688079834
Epoch: 50, Steps: 52 | Train Loss: 0.4013666 Vali Loss: 1.2987752 Test Loss: 0.3437385
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 51 cost time: 1.669206142425537
Epoch: 51, Steps: 52 | Train Loss: 0.4000012 Vali Loss: 1.2880102 Test Loss: 0.3437465
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 52 cost time: 1.6655032634735107
Epoch: 52, Steps: 52 | Train Loss: 0.4003227 Vali Loss: 1.2883810 Test Loss: 0.3440381
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 53 cost time: 1.6632096767425537
Epoch: 53, Steps: 52 | Train Loss: 0.3997814 Vali Loss: 1.2974837 Test Loss: 0.3429423
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 54 cost time: 1.6648592948913574
Epoch: 54, Steps: 52 | Train Loss: 0.4004101 Vali Loss: 1.2940972 Test Loss: 0.3446530
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 55 cost time: 1.66145658493042
Epoch: 55, Steps: 52 | Train Loss: 0.4016176 Vali Loss: 1.2951890 Test Loss: 0.3439147
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 56 cost time: 1.6656737327575684
Epoch: 56, Steps: 52 | Train Loss: 0.4019630 Vali Loss: 1.2921054 Test Loss: 0.3444113
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 57 cost time: 1.6689984798431396
Epoch: 57, Steps: 52 | Train Loss: 0.3991742 Vali Loss: 1.2886717 Test Loss: 0.3434554
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 58 cost time: 1.668999433517456
Epoch: 58, Steps: 52 | Train Loss: 0.4011239 Vali Loss: 1.2862422 Test Loss: 0.3435188
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 59 cost time: 1.6660029888153076
Epoch: 59, Steps: 52 | Train Loss: 0.4007161 Vali Loss: 1.2891371 Test Loss: 0.3437831
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 60 cost time: 1.667999505996704
Epoch: 60, Steps: 52 | Train Loss: 0.4003456 Vali Loss: 1.2886659 Test Loss: 0.3440848
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34440508484840393, mae:0.3927598297595978, rse:0.48077690601348877
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.07043266296386719 GB
Epoch: 1 cost time: 2.1570003032684326
Epoch: 1, Steps: 52 | Train Loss: 0.6950565 Vali Loss: 2.1102948 Test Loss: 1.3025773
Validation loss decreased (inf --> 2.110295).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 2 cost time: 0.7560014724731445
Epoch: 2, Steps: 52 | Train Loss: 0.5413813 Vali Loss: 1.4243200 Test Loss: 0.4421219
Validation loss decreased (2.110295 --> 1.424320).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 3 cost time: 0.7590022087097168
Epoch: 3, Steps: 52 | Train Loss: 0.4419162 Vali Loss: 1.3667200 Test Loss: 0.4026220
Validation loss decreased (1.424320 --> 1.366720).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 4 cost time: 0.7716200351715088
Epoch: 4, Steps: 52 | Train Loss: 0.4250031 Vali Loss: 1.3510010 Test Loss: 0.3777173
Validation loss decreased (1.366720 --> 1.351001).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 5 cost time: 0.7820010185241699
Epoch: 5, Steps: 52 | Train Loss: 0.4145316 Vali Loss: 1.3357215 Test Loss: 0.3685069
Validation loss decreased (1.351001 --> 1.335721).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 6 cost time: 1.7223501205444336
Epoch: 6, Steps: 52 | Train Loss: 0.4097221 Vali Loss: 1.3178437 Test Loss: 0.3621566
Validation loss decreased (1.335721 --> 1.317844).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 7 cost time: 1.7400131225585938
Epoch: 7, Steps: 52 | Train Loss: 0.4065509 Vali Loss: 1.3111353 Test Loss: 0.3593494
Validation loss decreased (1.317844 --> 1.311135).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 8 cost time: 1.7363924980163574
Epoch: 8, Steps: 52 | Train Loss: 0.4043092 Vali Loss: 1.3027447 Test Loss: 0.3573346
Validation loss decreased (1.311135 --> 1.302745).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 9 cost time: 1.7375640869140625
Epoch: 9, Steps: 52 | Train Loss: 0.4022992 Vali Loss: 1.3014067 Test Loss: 0.3548491
Validation loss decreased (1.302745 --> 1.301407).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 10 cost time: 1.735476016998291
Epoch: 10, Steps: 52 | Train Loss: 0.4006762 Vali Loss: 1.2905972 Test Loss: 0.3528201
Validation loss decreased (1.301407 --> 1.290597).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 11 cost time: 1.7352850437164307
Epoch: 11, Steps: 52 | Train Loss: 0.3988921 Vali Loss: 1.2881994 Test Loss: 0.3523433
Validation loss decreased (1.290597 --> 1.288199).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 12 cost time: 1.737104892730713
Epoch: 12, Steps: 52 | Train Loss: 0.3978053 Vali Loss: 1.2888505 Test Loss: 0.3526329
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 13 cost time: 1.7363331317901611
Epoch: 13, Steps: 52 | Train Loss: 0.3980063 Vali Loss: 1.2888620 Test Loss: 0.3507236
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 14 cost time: 1.7345185279846191
Epoch: 14, Steps: 52 | Train Loss: 0.3954848 Vali Loss: 1.2855895 Test Loss: 0.3509829
Validation loss decreased (1.288199 --> 1.285589).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 15 cost time: 1.7440412044525146
Epoch: 15, Steps: 52 | Train Loss: 0.3944869 Vali Loss: 1.2862065 Test Loss: 0.3504539
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 16 cost time: 1.7790040969848633
Epoch: 16, Steps: 52 | Train Loss: 0.3971323 Vali Loss: 1.2790525 Test Loss: 0.3501005
Validation loss decreased (1.285589 --> 1.279052).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 17 cost time: 1.7646148204803467
Epoch: 17, Steps: 52 | Train Loss: 0.3954649 Vali Loss: 1.2831562 Test Loss: 0.3504591
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 18 cost time: 1.689455270767212
Epoch: 18, Steps: 52 | Train Loss: 0.3931771 Vali Loss: 1.2868323 Test Loss: 0.3510348
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 19 cost time: 1.6743245124816895
Epoch: 19, Steps: 52 | Train Loss: 0.3931137 Vali Loss: 1.2851032 Test Loss: 0.3496546
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 20 cost time: 1.6810073852539062
Epoch: 20, Steps: 52 | Train Loss: 0.3945822 Vali Loss: 1.2856860 Test Loss: 0.3492450
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 21 cost time: 1.7166132926940918
Epoch: 21, Steps: 52 | Train Loss: 0.3930489 Vali Loss: 1.2777441 Test Loss: 0.3487523
Validation loss decreased (1.279052 --> 1.277744).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 22 cost time: 1.797001838684082
Epoch: 22, Steps: 52 | Train Loss: 0.3926663 Vali Loss: 1.2859402 Test Loss: 0.3495867
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 23 cost time: 1.7859625816345215
Epoch: 23, Steps: 52 | Train Loss: 0.3933627 Vali Loss: 1.2793094 Test Loss: 0.3504666
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 24 cost time: 1.783583641052246
Epoch: 24, Steps: 52 | Train Loss: 0.3915135 Vali Loss: 1.2842826 Test Loss: 0.3494445
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 25 cost time: 1.7809996604919434
Epoch: 25, Steps: 52 | Train Loss: 0.3916225 Vali Loss: 1.2749944 Test Loss: 0.3499696
Validation loss decreased (1.277744 --> 1.274994).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 26 cost time: 1.7376437187194824
Epoch: 26, Steps: 52 | Train Loss: 0.3929768 Vali Loss: 1.2759978 Test Loss: 0.3487361
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 27 cost time: 1.7199592590332031
Epoch: 27, Steps: 52 | Train Loss: 0.3917083 Vali Loss: 1.2766120 Test Loss: 0.3479633
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 28 cost time: 1.7171297073364258
Epoch: 28, Steps: 52 | Train Loss: 0.3914219 Vali Loss: 1.2769010 Test Loss: 0.3489910
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 29 cost time: 1.7178857326507568
Epoch: 29, Steps: 52 | Train Loss: 0.3905931 Vali Loss: 1.2832336 Test Loss: 0.3492396
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 30 cost time: 1.7185258865356445
Epoch: 30, Steps: 52 | Train Loss: 0.3917131 Vali Loss: 1.2826669 Test Loss: 0.3486277
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 31 cost time: 1.7252562046051025
Epoch: 31, Steps: 52 | Train Loss: 0.3918551 Vali Loss: 1.2780857 Test Loss: 0.3490650
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 32 cost time: 1.7242889404296875
Epoch: 32, Steps: 52 | Train Loss: 0.3924934 Vali Loss: 1.2862668 Test Loss: 0.3499204
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 33 cost time: 1.736907720565796
Epoch: 33, Steps: 52 | Train Loss: 0.3921982 Vali Loss: 1.2823642 Test Loss: 0.3480190
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 34 cost time: 1.7327146530151367
Epoch: 34, Steps: 52 | Train Loss: 0.3893477 Vali Loss: 1.2817082 Test Loss: 0.3486671
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 35 cost time: 1.7401931285858154
Epoch: 35, Steps: 52 | Train Loss: 0.3914307 Vali Loss: 1.2807289 Test Loss: 0.3481034
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 36 cost time: 1.7359514236450195
Epoch: 36, Steps: 52 | Train Loss: 0.3920685 Vali Loss: 1.2773044 Test Loss: 0.3480694
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 37 cost time: 1.7309536933898926
Epoch: 37, Steps: 52 | Train Loss: 0.3916558 Vali Loss: 1.2811376 Test Loss: 0.3484239
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 38 cost time: 1.7275230884552002
Epoch: 38, Steps: 52 | Train Loss: 0.3913857 Vali Loss: 1.2762380 Test Loss: 0.3478531
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 39 cost time: 1.733229160308838
Epoch: 39, Steps: 52 | Train Loss: 0.3905100 Vali Loss: 1.2729157 Test Loss: 0.3477814
Validation loss decreased (1.274994 --> 1.272916).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 40 cost time: 1.7297477722167969
Epoch: 40, Steps: 52 | Train Loss: 0.3908851 Vali Loss: 1.2862030 Test Loss: 0.3489898
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 41 cost time: 1.7423195838928223
Epoch: 41, Steps: 52 | Train Loss: 0.3908227 Vali Loss: 1.2784492 Test Loss: 0.3483198
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 42 cost time: 1.7354121208190918
Epoch: 42, Steps: 52 | Train Loss: 0.3915345 Vali Loss: 1.2767861 Test Loss: 0.3481461
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 43 cost time: 1.7438290119171143
Epoch: 43, Steps: 52 | Train Loss: 0.3903921 Vali Loss: 1.2798131 Test Loss: 0.3484087
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 44 cost time: 1.9189989566802979
Epoch: 44, Steps: 52 | Train Loss: 0.3906781 Vali Loss: 1.2773294 Test Loss: 0.3474744
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 45 cost time: 1.8750007152557373
Epoch: 45, Steps: 52 | Train Loss: 0.3914636 Vali Loss: 1.2780641 Test Loss: 0.3488102
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 46 cost time: 1.8490009307861328
Epoch: 46, Steps: 52 | Train Loss: 0.3907877 Vali Loss: 1.2764332 Test Loss: 0.3489041
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 47 cost time: 1.8330020904541016
Epoch: 47, Steps: 52 | Train Loss: 0.3904659 Vali Loss: 1.2735868 Test Loss: 0.3485925
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 48 cost time: 1.8400006294250488
Epoch: 48, Steps: 52 | Train Loss: 0.3920875 Vali Loss: 1.2748582 Test Loss: 0.3482671
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 49 cost time: 1.8510003089904785
Epoch: 49, Steps: 52 | Train Loss: 0.3916698 Vali Loss: 1.2722239 Test Loss: 0.3486255
Validation loss decreased (1.272916 --> 1.272224).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 50 cost time: 1.7700772285461426
Epoch: 50, Steps: 52 | Train Loss: 0.3909227 Vali Loss: 1.2740691 Test Loss: 0.3479896
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 51 cost time: 1.7538602352142334
Epoch: 51, Steps: 52 | Train Loss: 0.3906927 Vali Loss: 1.2792014 Test Loss: 0.3482800
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 52 cost time: 1.7638227939605713
Epoch: 52, Steps: 52 | Train Loss: 0.3910365 Vali Loss: 1.2808714 Test Loss: 0.3493007
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 53 cost time: 1.7612264156341553
Epoch: 53, Steps: 52 | Train Loss: 0.3904828 Vali Loss: 1.2769594 Test Loss: 0.3484995
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 54 cost time: 1.7461416721343994
Epoch: 54, Steps: 52 | Train Loss: 0.3906936 Vali Loss: 1.2695248 Test Loss: 0.3478346
Validation loss decreased (1.272224 --> 1.269525).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 55 cost time: 1.7570714950561523
Epoch: 55, Steps: 52 | Train Loss: 0.3907613 Vali Loss: 1.2805462 Test Loss: 0.3480814
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 56 cost time: 1.7520015239715576
Epoch: 56, Steps: 52 | Train Loss: 0.3912082 Vali Loss: 1.2806222 Test Loss: 0.3481775
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 57 cost time: 1.7430014610290527
Epoch: 57, Steps: 52 | Train Loss: 0.3921988 Vali Loss: 1.2766167 Test Loss: 0.3473974
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 58 cost time: 1.7427477836608887
Epoch: 58, Steps: 52 | Train Loss: 0.3911582 Vali Loss: 1.2825804 Test Loss: 0.3481244
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 59 cost time: 1.745999813079834
Epoch: 59, Steps: 52 | Train Loss: 0.3920787 Vali Loss: 1.2855756 Test Loss: 0.3475664
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 60 cost time: 1.746647596359253
Epoch: 60, Steps: 52 | Train Loss: 0.3911676 Vali Loss: 1.2812524 Test Loss: 0.3486580
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.3478345572948456, mae:0.399036169052124, rse:0.4831646680831909
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='NetTh_336_96', model='PerioDformer', data='NetTh', root_path='./dataset/', data_path='NetTh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6769
val 2065
test 2065
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.0735483169555664 GB
Epoch: 1 cost time: 2.2168002128601074
Epoch: 1, Steps: 52 | Train Loss: 0.6860184 Vali Loss: 2.1010275 Test Loss: 1.3446386
Validation loss decreased (inf --> 2.101027).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 2 cost time: 0.7927641868591309
Epoch: 2, Steps: 52 | Train Loss: 0.5393428 Vali Loss: 1.4268670 Test Loss: 0.4268254
Validation loss decreased (2.101027 --> 1.426867).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 3 cost time: 0.7774350643157959
Epoch: 3, Steps: 52 | Train Loss: 0.4332603 Vali Loss: 1.3726153 Test Loss: 0.3888688
Validation loss decreased (1.426867 --> 1.372615).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 4 cost time: 0.775792121887207
Epoch: 4, Steps: 52 | Train Loss: 0.4150304 Vali Loss: 1.3439672 Test Loss: 0.3720984
Validation loss decreased (1.372615 --> 1.343967).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 5 cost time: 1.1423730850219727
Epoch: 5, Steps: 52 | Train Loss: 0.4104471 Vali Loss: 1.3253627 Test Loss: 0.3629929
Validation loss decreased (1.343967 --> 1.325363).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 6 cost time: 1.7875535488128662
Epoch: 6, Steps: 52 | Train Loss: 0.4054675 Vali Loss: 1.3092699 Test Loss: 0.3569169
Validation loss decreased (1.325363 --> 1.309270).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 7 cost time: 1.738891839981079
Epoch: 7, Steps: 52 | Train Loss: 0.4020948 Vali Loss: 1.3052075 Test Loss: 0.3546290
Validation loss decreased (1.309270 --> 1.305207).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 8 cost time: 1.8570899963378906
Epoch: 8, Steps: 52 | Train Loss: 0.3994994 Vali Loss: 1.2881004 Test Loss: 0.3532407
Validation loss decreased (1.305207 --> 1.288100).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 9 cost time: 1.729292631149292
Epoch: 9, Steps: 52 | Train Loss: 0.3975790 Vali Loss: 1.2954090 Test Loss: 0.3523418
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 10 cost time: 1.7240939140319824
Epoch: 10, Steps: 52 | Train Loss: 0.3983066 Vali Loss: 1.2932305 Test Loss: 0.3502015
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 11 cost time: 1.7181601524353027
Epoch: 11, Steps: 52 | Train Loss: 0.3971417 Vali Loss: 1.2828918 Test Loss: 0.3490050
Validation loss decreased (1.288100 --> 1.282892).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 12 cost time: 1.719299077987671
Epoch: 12, Steps: 52 | Train Loss: 0.3966814 Vali Loss: 1.2887461 Test Loss: 0.3479095
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 13 cost time: 1.716747760772705
Epoch: 13, Steps: 52 | Train Loss: 0.3941860 Vali Loss: 1.2825031 Test Loss: 0.3492944
Validation loss decreased (1.282892 --> 1.282503).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 14 cost time: 1.7180979251861572
Epoch: 14, Steps: 52 | Train Loss: 0.3924294 Vali Loss: 1.2851759 Test Loss: 0.3480711
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 15 cost time: 1.717503309249878
Epoch: 15, Steps: 52 | Train Loss: 0.3934986 Vali Loss: 1.2824478 Test Loss: 0.3476452
Validation loss decreased (1.282503 --> 1.282448).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 16 cost time: 1.7156798839569092
Epoch: 16, Steps: 52 | Train Loss: 0.3910512 Vali Loss: 1.2729013 Test Loss: 0.3463324
Validation loss decreased (1.282448 --> 1.272901).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 17 cost time: 1.7221755981445312
Epoch: 17, Steps: 52 | Train Loss: 0.3921614 Vali Loss: 1.2795743 Test Loss: 0.3464731
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 18 cost time: 1.7195048332214355
Epoch: 18, Steps: 52 | Train Loss: 0.3899617 Vali Loss: 1.2766615 Test Loss: 0.3468725
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 19 cost time: 1.7208025455474854
Epoch: 19, Steps: 52 | Train Loss: 0.3913283 Vali Loss: 1.2740523 Test Loss: 0.3457816
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 20 cost time: 1.715146541595459
Epoch: 20, Steps: 52 | Train Loss: 0.3913857 Vali Loss: 1.2759678 Test Loss: 0.3465472
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 21 cost time: 1.7236435413360596
Epoch: 21, Steps: 52 | Train Loss: 0.3894591 Vali Loss: 1.2768958 Test Loss: 0.3466622
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 22 cost time: 1.717693567276001
Epoch: 22, Steps: 52 | Train Loss: 0.3911669 Vali Loss: 1.2737261 Test Loss: 0.3460831
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 23 cost time: 1.7185418605804443
Epoch: 23, Steps: 52 | Train Loss: 0.3900864 Vali Loss: 1.2788762 Test Loss: 0.3463558
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 24 cost time: 1.7112758159637451
Epoch: 24, Steps: 52 | Train Loss: 0.3888036 Vali Loss: 1.2773974 Test Loss: 0.3465212
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 25 cost time: 1.7208683490753174
Epoch: 25, Steps: 52 | Train Loss: 0.3907694 Vali Loss: 1.2744459 Test Loss: 0.3445379
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 26 cost time: 1.7120537757873535
Epoch: 26, Steps: 52 | Train Loss: 0.3891457 Vali Loss: 1.2766728 Test Loss: 0.3446835
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 27 cost time: 1.71974778175354
Epoch: 27, Steps: 52 | Train Loss: 0.3891437 Vali Loss: 1.2763841 Test Loss: 0.3460083
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 28 cost time: 1.716644048690796
Epoch: 28, Steps: 52 | Train Loss: 0.3882231 Vali Loss: 1.2789150 Test Loss: 0.3459941
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 29 cost time: 1.7149410247802734
Epoch: 29, Steps: 52 | Train Loss: 0.3897424 Vali Loss: 1.2728342 Test Loss: 0.3442199
Validation loss decreased (1.272901 --> 1.272834).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 30 cost time: 1.7150399684906006
Epoch: 30, Steps: 52 | Train Loss: 0.3891158 Vali Loss: 1.2720822 Test Loss: 0.3455683
Validation loss decreased (1.272834 --> 1.272082).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 31 cost time: 1.7193751335144043
Epoch: 31, Steps: 52 | Train Loss: 0.3888075 Vali Loss: 1.2785876 Test Loss: 0.3447658
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 32 cost time: 1.7215766906738281
Epoch: 32, Steps: 52 | Train Loss: 0.3895060 Vali Loss: 1.2666576 Test Loss: 0.3447842
Validation loss decreased (1.272082 --> 1.266658).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 33 cost time: 1.7194077968597412
Epoch: 33, Steps: 52 | Train Loss: 0.3899342 Vali Loss: 1.2719581 Test Loss: 0.3456781
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 34 cost time: 1.7155847549438477
Epoch: 34, Steps: 52 | Train Loss: 0.3883541 Vali Loss: 1.2750915 Test Loss: 0.3450533
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 35 cost time: 1.7106714248657227
Epoch: 35, Steps: 52 | Train Loss: 0.3896050 Vali Loss: 1.2691371 Test Loss: 0.3446046
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 36 cost time: 1.7168011665344238
Epoch: 36, Steps: 52 | Train Loss: 0.3889868 Vali Loss: 1.2773975 Test Loss: 0.3449470
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 37 cost time: 1.718440294265747
Epoch: 37, Steps: 52 | Train Loss: 0.3888971 Vali Loss: 1.2777544 Test Loss: 0.3460634
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 38 cost time: 1.7185306549072266
Epoch: 38, Steps: 52 | Train Loss: 0.3896918 Vali Loss: 1.2671614 Test Loss: 0.3449147
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 39 cost time: 1.714095115661621
Epoch: 39, Steps: 52 | Train Loss: 0.3894188 Vali Loss: 1.2737454 Test Loss: 0.3448984
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 40 cost time: 1.7225301265716553
Epoch: 40, Steps: 52 | Train Loss: 0.3885595 Vali Loss: 1.2734494 Test Loss: 0.3439554
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 41 cost time: 1.7134897708892822
Epoch: 41, Steps: 52 | Train Loss: 0.3867515 Vali Loss: 1.2803658 Test Loss: 0.3457821
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 42 cost time: 1.7201740741729736
Epoch: 42, Steps: 52 | Train Loss: 0.3889926 Vali Loss: 1.2683129 Test Loss: 0.3443350
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 43 cost time: 1.7150235176086426
Epoch: 43, Steps: 52 | Train Loss: 0.3884311 Vali Loss: 1.2655683 Test Loss: 0.3470293
Validation loss decreased (1.266658 --> 1.265568).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 44 cost time: 1.7138464450836182
Epoch: 44, Steps: 52 | Train Loss: 0.3878070 Vali Loss: 1.2747481 Test Loss: 0.3449721
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 45 cost time: 1.7183213233947754
Epoch: 45, Steps: 52 | Train Loss: 0.3877855 Vali Loss: 1.2702398 Test Loss: 0.3434224
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 46 cost time: 1.7197539806365967
Epoch: 46, Steps: 52 | Train Loss: 0.3898306 Vali Loss: 1.2773163 Test Loss: 0.3452560
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 47 cost time: 1.7238962650299072
Epoch: 47, Steps: 52 | Train Loss: 0.3874040 Vali Loss: 1.2696145 Test Loss: 0.3442216
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 48 cost time: 1.7173411846160889
Epoch: 48, Steps: 52 | Train Loss: 0.3877592 Vali Loss: 1.2765188 Test Loss: 0.3439097
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 49 cost time: 1.7245111465454102
Epoch: 49, Steps: 52 | Train Loss: 0.3883328 Vali Loss: 1.2750299 Test Loss: 0.3445162
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 50 cost time: 1.715104579925537
Epoch: 50, Steps: 52 | Train Loss: 0.3911455 Vali Loss: 1.2746001 Test Loss: 0.3445036
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 51 cost time: 1.7198359966278076
Epoch: 51, Steps: 52 | Train Loss: 0.3883434 Vali Loss: 1.2728872 Test Loss: 0.3451421
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 52 cost time: 1.714895248413086
Epoch: 52, Steps: 52 | Train Loss: 0.3866485 Vali Loss: 1.2725141 Test Loss: 0.3452197
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 53 cost time: 1.7199163436889648
Epoch: 53, Steps: 52 | Train Loss: 0.3881043 Vali Loss: 1.2714007 Test Loss: 0.3452521
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 54 cost time: 1.716019630432129
Epoch: 54, Steps: 52 | Train Loss: 0.3872700 Vali Loss: 1.2716894 Test Loss: 0.3442860
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 55 cost time: 1.7208869457244873
Epoch: 55, Steps: 52 | Train Loss: 0.3891960 Vali Loss: 1.2736827 Test Loss: 0.3447944
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 56 cost time: 1.7186450958251953
Epoch: 56, Steps: 52 | Train Loss: 0.3889549 Vali Loss: 1.2689164 Test Loss: 0.3454938
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 57 cost time: 1.7202258110046387
Epoch: 57, Steps: 52 | Train Loss: 0.3870962 Vali Loss: 1.2740638 Test Loss: 0.3455049
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 58 cost time: 1.7146635055541992
Epoch: 58, Steps: 52 | Train Loss: 0.3889338 Vali Loss: 1.2743129 Test Loss: 0.3449806
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 59 cost time: 1.7161731719970703
Epoch: 59, Steps: 52 | Train Loss: 0.3886897 Vali Loss: 1.2712233 Test Loss: 0.3448583
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 60 cost time: 1.7141129970550537
Epoch: 60, Steps: 52 | Train Loss: 0.3897413 Vali Loss: 1.2759695 Test Loss: 0.3436259
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : NetTh_336_96_PerioDformer_NetTh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2065
test-mse:0.34702935814857483, mae:0.3945044279098511, rse:0.48260509967803955
