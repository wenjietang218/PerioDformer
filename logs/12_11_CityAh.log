nohup: ignoring input
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03554582595825195 GB
Epoch: 1 cost time: 2.306532859802246
Epoch: 1, Steps: 64 | Train Loss: 1.0760209 Vali Loss: 2.2511361 Test Loss: 4.3727460
Validation loss decreased (inf --> 2.251136).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 2 cost time: 0.8976407051086426
Epoch: 2, Steps: 64 | Train Loss: 0.9160282 Vali Loss: 1.5868096 Test Loss: 2.9585552
Validation loss decreased (2.251136 --> 1.586810).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 3 cost time: 0.8964278697967529
Epoch: 3, Steps: 64 | Train Loss: 0.6681488 Vali Loss: 1.1235980 Test Loss: 1.9805273
Validation loss decreased (1.586810 --> 1.123598).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 4 cost time: 0.8992667198181152
Epoch: 4, Steps: 64 | Train Loss: 0.4848201 Vali Loss: 0.7984757 Test Loss: 1.3044115
Validation loss decreased (1.123598 --> 0.798476).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 5 cost time: 0.9152472019195557
Epoch: 5, Steps: 64 | Train Loss: 0.3635965 Vali Loss: 0.6050694 Test Loss: 0.9125968
Validation loss decreased (0.798476 --> 0.605069).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 6 cost time: 0.917428731918335
Epoch: 6, Steps: 64 | Train Loss: 0.2905966 Vali Loss: 0.4890718 Test Loss: 0.6787680
Validation loss decreased (0.605069 --> 0.489072).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 7 cost time: 0.9117507934570312
Epoch: 7, Steps: 64 | Train Loss: 0.2493949 Vali Loss: 0.4171090 Test Loss: 0.5385413
Validation loss decreased (0.489072 --> 0.417109).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 8 cost time: 0.874000072479248
Epoch: 8, Steps: 64 | Train Loss: 0.2231232 Vali Loss: 0.3735931 Test Loss: 0.4549485
Validation loss decreased (0.417109 --> 0.373593).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 9 cost time: 0.8846580982208252
Epoch: 9, Steps: 64 | Train Loss: 0.2044674 Vali Loss: 0.3398001 Test Loss: 0.3928430
Validation loss decreased (0.373593 --> 0.339800).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 10 cost time: 0.895362377166748
Epoch: 10, Steps: 64 | Train Loss: 0.1915059 Vali Loss: 0.3195248 Test Loss: 0.3479868
Validation loss decreased (0.339800 --> 0.319525).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 11 cost time: 0.9174957275390625
Epoch: 11, Steps: 64 | Train Loss: 0.1822412 Vali Loss: 0.2978179 Test Loss: 0.3109770
Validation loss decreased (0.319525 --> 0.297818).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 12 cost time: 0.9264218807220459
Epoch: 12, Steps: 64 | Train Loss: 0.1738465 Vali Loss: 0.2821864 Test Loss: 0.2875412
Validation loss decreased (0.297818 --> 0.282186).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 13 cost time: 0.9228239059448242
Epoch: 13, Steps: 64 | Train Loss: 0.1676397 Vali Loss: 0.2711265 Test Loss: 0.2692467
Validation loss decreased (0.282186 --> 0.271126).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 14 cost time: 0.929757833480835
Epoch: 14, Steps: 64 | Train Loss: 0.1637762 Vali Loss: 0.2621799 Test Loss: 0.2534392
Validation loss decreased (0.271126 --> 0.262180).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 15 cost time: 0.9110000133514404
Epoch: 15, Steps: 64 | Train Loss: 0.1597103 Vali Loss: 0.2543772 Test Loss: 0.2405318
Validation loss decreased (0.262180 --> 0.254377).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 16 cost time: 0.9092450141906738
Epoch: 16, Steps: 64 | Train Loss: 0.1560468 Vali Loss: 0.2497508 Test Loss: 0.2319697
Validation loss decreased (0.254377 --> 0.249751).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 17 cost time: 0.908790111541748
Epoch: 17, Steps: 64 | Train Loss: 0.1524328 Vali Loss: 0.2447859 Test Loss: 0.2230010
Validation loss decreased (0.249751 --> 0.244786).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 18 cost time: 0.9193780422210693
Epoch: 18, Steps: 64 | Train Loss: 0.1505397 Vali Loss: 0.2354186 Test Loss: 0.2145933
Validation loss decreased (0.244786 --> 0.235419).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 19 cost time: 0.9196467399597168
Epoch: 19, Steps: 64 | Train Loss: 0.1482468 Vali Loss: 0.2332718 Test Loss: 0.2096152
Validation loss decreased (0.235419 --> 0.233272).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 20 cost time: 0.9203901290893555
Epoch: 20, Steps: 64 | Train Loss: 0.1462319 Vali Loss: 0.2310556 Test Loss: 0.2049974
Validation loss decreased (0.233272 --> 0.231056).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 21 cost time: 0.9220008850097656
Epoch: 21, Steps: 64 | Train Loss: 0.1449717 Vali Loss: 0.2306287 Test Loss: 0.2034337
Validation loss decreased (0.231056 --> 0.230629).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 22 cost time: 0.9166405200958252
Epoch: 22, Steps: 64 | Train Loss: 0.1436806 Vali Loss: 0.2256188 Test Loss: 0.1977936
Validation loss decreased (0.230629 --> 0.225619).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 23 cost time: 0.9126429557800293
Epoch: 23, Steps: 64 | Train Loss: 0.1419534 Vali Loss: 0.2206030 Test Loss: 0.1926802
Validation loss decreased (0.225619 --> 0.220603).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 24 cost time: 0.9154369831085205
Epoch: 24, Steps: 64 | Train Loss: 0.1412488 Vali Loss: 0.2196268 Test Loss: 0.1921456
Validation loss decreased (0.220603 --> 0.219627).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 25 cost time: 0.895439624786377
Epoch: 25, Steps: 64 | Train Loss: 0.1403833 Vali Loss: 0.2200698 Test Loss: 0.1896774
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 26 cost time: 0.8833634853363037
Epoch: 26, Steps: 64 | Train Loss: 0.1386838 Vali Loss: 0.2200452 Test Loss: 0.1884585
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 27 cost time: 0.9045872688293457
Epoch: 27, Steps: 64 | Train Loss: 0.1388954 Vali Loss: 0.2191294 Test Loss: 0.1873608
Validation loss decreased (0.219627 --> 0.219129).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 28 cost time: 0.9120004177093506
Epoch: 28, Steps: 64 | Train Loss: 0.1380487 Vali Loss: 0.2149833 Test Loss: 0.1860862
Validation loss decreased (0.219129 --> 0.214983).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 29 cost time: 0.9046435356140137
Epoch: 29, Steps: 64 | Train Loss: 0.1373728 Vali Loss: 0.2150625 Test Loss: 0.1837773
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 30 cost time: 0.9045822620391846
Epoch: 30, Steps: 64 | Train Loss: 0.1366989 Vali Loss: 0.2143143 Test Loss: 0.1827825
Validation loss decreased (0.214983 --> 0.214314).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 31 cost time: 0.9104056358337402
Epoch: 31, Steps: 64 | Train Loss: 0.1363804 Vali Loss: 0.2124566 Test Loss: 0.1812406
Validation loss decreased (0.214314 --> 0.212457).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 32 cost time: 0.9154374599456787
Epoch: 32, Steps: 64 | Train Loss: 0.1356664 Vali Loss: 0.2125044 Test Loss: 0.1805578
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 33 cost time: 0.9077837467193604
Epoch: 33, Steps: 64 | Train Loss: 0.1358604 Vali Loss: 0.2102303 Test Loss: 0.1785393
Validation loss decreased (0.212457 --> 0.210230).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 34 cost time: 0.9146425724029541
Epoch: 34, Steps: 64 | Train Loss: 0.1356830 Vali Loss: 0.2124857 Test Loss: 0.1802581
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 35 cost time: 0.9146430492401123
Epoch: 35, Steps: 64 | Train Loss: 0.1351163 Vali Loss: 0.2114543 Test Loss: 0.1786303
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 36 cost time: 0.9156379699707031
Epoch: 36, Steps: 64 | Train Loss: 0.1354833 Vali Loss: 0.2125811 Test Loss: 0.1781483
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 37 cost time: 0.9233763217926025
Epoch: 37, Steps: 64 | Train Loss: 0.1344384 Vali Loss: 0.2118557 Test Loss: 0.1773389
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 38 cost time: 0.9323015213012695
Epoch: 38, Steps: 64 | Train Loss: 0.1349794 Vali Loss: 0.2084913 Test Loss: 0.1788324
Validation loss decreased (0.210230 --> 0.208491).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 39 cost time: 0.9329051971435547
Epoch: 39, Steps: 64 | Train Loss: 0.1341709 Vali Loss: 0.2103509 Test Loss: 0.1759858
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 40 cost time: 0.9260914325714111
Epoch: 40, Steps: 64 | Train Loss: 0.1333400 Vali Loss: 0.2111076 Test Loss: 0.1773402
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 41 cost time: 0.9048757553100586
Epoch: 41, Steps: 64 | Train Loss: 0.1333982 Vali Loss: 0.2088432 Test Loss: 0.1765140
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 42 cost time: 0.8964099884033203
Epoch: 42, Steps: 64 | Train Loss: 0.1335250 Vali Loss: 0.2086877 Test Loss: 0.1752851
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 43 cost time: 0.9008827209472656
Epoch: 43, Steps: 64 | Train Loss: 0.1333910 Vali Loss: 0.2085274 Test Loss: 0.1755023
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 44 cost time: 0.8959298133850098
Epoch: 44, Steps: 64 | Train Loss: 0.1329568 Vali Loss: 0.2067132 Test Loss: 0.1748432
Validation loss decreased (0.208491 --> 0.206713).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 45 cost time: 0.9023702144622803
Epoch: 45, Steps: 64 | Train Loss: 0.1326968 Vali Loss: 0.2091853 Test Loss: 0.1758154
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 46 cost time: 0.9101352691650391
Epoch: 46, Steps: 64 | Train Loss: 0.1330909 Vali Loss: 0.2080059 Test Loss: 0.1747608
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 47 cost time: 0.9066309928894043
Epoch: 47, Steps: 64 | Train Loss: 0.1331954 Vali Loss: 0.2070493 Test Loss: 0.1736363
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 48 cost time: 0.9046390056610107
Epoch: 48, Steps: 64 | Train Loss: 0.1331519 Vali Loss: 0.2070240 Test Loss: 0.1749769
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 49 cost time: 0.9074206352233887
Epoch: 49, Steps: 64 | Train Loss: 0.1332168 Vali Loss: 0.2078392 Test Loss: 0.1727039
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 50 cost time: 0.8963921070098877
Epoch: 50, Steps: 64 | Train Loss: 0.1326358 Vali Loss: 0.2082935 Test Loss: 0.1745995
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 51 cost time: 0.8944177627563477
Epoch: 51, Steps: 64 | Train Loss: 0.1325846 Vali Loss: 0.2074756 Test Loss: 0.1743580
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 52 cost time: 0.9060521125793457
Epoch: 52, Steps: 64 | Train Loss: 0.1324330 Vali Loss: 0.2073369 Test Loss: 0.1747103
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 53 cost time: 0.9177746772766113
Epoch: 53, Steps: 64 | Train Loss: 0.1324839 Vali Loss: 0.2053863 Test Loss: 0.1737640
Validation loss decreased (0.206713 --> 0.205386).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 54 cost time: 0.9324629306793213
Epoch: 54, Steps: 64 | Train Loss: 0.1330160 Vali Loss: 0.2077153 Test Loss: 0.1733486
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 55 cost time: 0.9192969799041748
Epoch: 55, Steps: 64 | Train Loss: 0.1317869 Vali Loss: 0.2084809 Test Loss: 0.1739914
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 56 cost time: 0.9232499599456787
Epoch: 56, Steps: 64 | Train Loss: 0.1325985 Vali Loss: 0.2089344 Test Loss: 0.1733090
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 57 cost time: 0.9214372634887695
Epoch: 57, Steps: 64 | Train Loss: 0.1320002 Vali Loss: 0.2079653 Test Loss: 0.1726489
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 58 cost time: 0.9124948978424072
Epoch: 58, Steps: 64 | Train Loss: 0.1321381 Vali Loss: 0.2062760 Test Loss: 0.1731845
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 59 cost time: 0.9149417877197266
Epoch: 59, Steps: 64 | Train Loss: 0.1327137 Vali Loss: 0.2069345 Test Loss: 0.1728863
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017530441284179688 GB
GPU已分配内存的峰值：0.03598213195800781 GB
Epoch: 60 cost time: 0.9200003147125244
Epoch: 60, Steps: 64 | Train Loss: 0.1322377 Vali Loss: 0.2058205 Test Loss: 0.1724459
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.17376403510570526, mae:0.3183515667915344, rse:0.22187118232250214
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.03624725341796875 GB
Epoch: 1 cost time: 2.336747646331787
Epoch: 1, Steps: 64 | Train Loss: 1.0077356 Vali Loss: 2.2563615 Test Loss: 4.3742852
Validation loss decreased (inf --> 2.256361).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 2 cost time: 0.9564409255981445
Epoch: 2, Steps: 64 | Train Loss: 0.8157131 Vali Loss: 1.4632351 Test Loss: 2.7019718
Validation loss decreased (2.256361 --> 1.463235).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 3 cost time: 0.957998514175415
Epoch: 3, Steps: 64 | Train Loss: 0.5379584 Vali Loss: 0.9432569 Test Loss: 1.6238539
Validation loss decreased (1.463235 --> 0.943257).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 4 cost time: 0.9286203384399414
Epoch: 4, Steps: 64 | Train Loss: 0.3475700 Vali Loss: 0.5716217 Test Loss: 0.8736125
Validation loss decreased (0.943257 --> 0.571622).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 5 cost time: 0.9184205532073975
Epoch: 5, Steps: 64 | Train Loss: 0.2329451 Vali Loss: 0.3887334 Test Loss: 0.4993647
Validation loss decreased (0.571622 --> 0.388733).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 6 cost time: 0.9114172458648682
Epoch: 6, Steps: 64 | Train Loss: 0.1771688 Vali Loss: 0.2976547 Test Loss: 0.3227532
Validation loss decreased (0.388733 --> 0.297655).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 7 cost time: 0.912426233291626
Epoch: 7, Steps: 64 | Train Loss: 0.1501800 Vali Loss: 0.2550121 Test Loss: 0.2435007
Validation loss decreased (0.297655 --> 0.255012).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 8 cost time: 0.9104182720184326
Epoch: 8, Steps: 64 | Train Loss: 0.1370504 Vali Loss: 0.2324204 Test Loss: 0.2077081
Validation loss decreased (0.255012 --> 0.232420).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 9 cost time: 0.9171557426452637
Epoch: 9, Steps: 64 | Train Loss: 0.1302594 Vali Loss: 0.2212304 Test Loss: 0.1921849
Validation loss decreased (0.232420 --> 0.221230).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 10 cost time: 0.9567744731903076
Epoch: 10, Steps: 64 | Train Loss: 0.1259328 Vali Loss: 0.2133950 Test Loss: 0.1821883
Validation loss decreased (0.221230 --> 0.213395).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 11 cost time: 0.952000617980957
Epoch: 11, Steps: 64 | Train Loss: 0.1224339 Vali Loss: 0.2083025 Test Loss: 0.1768234
Validation loss decreased (0.213395 --> 0.208303).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 12 cost time: 0.955639123916626
Epoch: 12, Steps: 64 | Train Loss: 0.1198634 Vali Loss: 0.2033174 Test Loss: 0.1740038
Validation loss decreased (0.208303 --> 0.203317).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 13 cost time: 0.9623007774353027
Epoch: 13, Steps: 64 | Train Loss: 0.1187621 Vali Loss: 0.2032258 Test Loss: 0.1722425
Validation loss decreased (0.203317 --> 0.203226).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 14 cost time: 0.9388353824615479
Epoch: 14, Steps: 64 | Train Loss: 0.1167128 Vali Loss: 0.2012627 Test Loss: 0.1709521
Validation loss decreased (0.203226 --> 0.201263).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 15 cost time: 0.9384152889251709
Epoch: 15, Steps: 64 | Train Loss: 0.1162236 Vali Loss: 0.1991463 Test Loss: 0.1703572
Validation loss decreased (0.201263 --> 0.199146).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 16 cost time: 0.94140625
Epoch: 16, Steps: 64 | Train Loss: 0.1148154 Vali Loss: 0.1980010 Test Loss: 0.1696617
Validation loss decreased (0.199146 --> 0.198001).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 17 cost time: 0.94938063621521
Epoch: 17, Steps: 64 | Train Loss: 0.1135928 Vali Loss: 0.1980422 Test Loss: 0.1705311
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 18 cost time: 0.9498322010040283
Epoch: 18, Steps: 64 | Train Loss: 0.1129031 Vali Loss: 0.1943382 Test Loss: 0.1692208
Validation loss decreased (0.198001 --> 0.194338).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 19 cost time: 0.9544234275817871
Epoch: 19, Steps: 64 | Train Loss: 0.1122219 Vali Loss: 0.1946779 Test Loss: 0.1679413
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 20 cost time: 0.9526402950286865
Epoch: 20, Steps: 64 | Train Loss: 0.1111671 Vali Loss: 0.1958862 Test Loss: 0.1692368
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 21 cost time: 0.9226326942443848
Epoch: 21, Steps: 64 | Train Loss: 0.1110257 Vali Loss: 0.1938709 Test Loss: 0.1683916
Validation loss decreased (0.194338 --> 0.193871).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 22 cost time: 0.9181265830993652
Epoch: 22, Steps: 64 | Train Loss: 0.1106443 Vali Loss: 0.1944734 Test Loss: 0.1684486
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 23 cost time: 0.9056081771850586
Epoch: 23, Steps: 64 | Train Loss: 0.1099993 Vali Loss: 0.1912721 Test Loss: 0.1677642
Validation loss decreased (0.193871 --> 0.191272).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 24 cost time: 0.9207475185394287
Epoch: 24, Steps: 64 | Train Loss: 0.1095948 Vali Loss: 0.1935528 Test Loss: 0.1680515
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 25 cost time: 0.9084038734436035
Epoch: 25, Steps: 64 | Train Loss: 0.1090273 Vali Loss: 0.1908189 Test Loss: 0.1691855
Validation loss decreased (0.191272 --> 0.190819).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 26 cost time: 0.9136583805084229
Epoch: 26, Steps: 64 | Train Loss: 0.1090859 Vali Loss: 0.1922008 Test Loss: 0.1681474
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 27 cost time: 0.9358255863189697
Epoch: 27, Steps: 64 | Train Loss: 0.1091824 Vali Loss: 0.1916523 Test Loss: 0.1687928
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 28 cost time: 0.9275717735290527
Epoch: 28, Steps: 64 | Train Loss: 0.1085644 Vali Loss: 0.1894249 Test Loss: 0.1679122
Validation loss decreased (0.190819 --> 0.189425).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 29 cost time: 0.9351205825805664
Epoch: 29, Steps: 64 | Train Loss: 0.1074518 Vali Loss: 0.1925095 Test Loss: 0.1679023
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 30 cost time: 0.9457616806030273
Epoch: 30, Steps: 64 | Train Loss: 0.1076375 Vali Loss: 0.1927942 Test Loss: 0.1681426
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 31 cost time: 0.9599823951721191
Epoch: 31, Steps: 64 | Train Loss: 0.1079041 Vali Loss: 0.1924390 Test Loss: 0.1686985
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 32 cost time: 0.9433977603912354
Epoch: 32, Steps: 64 | Train Loss: 0.1070105 Vali Loss: 0.1906099 Test Loss: 0.1674450
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 33 cost time: 0.9373924732208252
Epoch: 33, Steps: 64 | Train Loss: 0.1075889 Vali Loss: 0.1924274 Test Loss: 0.1677996
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 34 cost time: 0.9400005340576172
Epoch: 34, Steps: 64 | Train Loss: 0.1072217 Vali Loss: 0.1924774 Test Loss: 0.1687772
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 35 cost time: 0.9366476535797119
Epoch: 35, Steps: 64 | Train Loss: 0.1066538 Vali Loss: 0.1913067 Test Loss: 0.1679452
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 36 cost time: 0.9554789066314697
Epoch: 36, Steps: 64 | Train Loss: 0.1064920 Vali Loss: 0.1903181 Test Loss: 0.1684169
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 37 cost time: 0.956324577331543
Epoch: 37, Steps: 64 | Train Loss: 0.1069271 Vali Loss: 0.1892760 Test Loss: 0.1684198
Validation loss decreased (0.189425 --> 0.189276).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 38 cost time: 0.953465461730957
Epoch: 38, Steps: 64 | Train Loss: 0.1065271 Vali Loss: 0.1917534 Test Loss: 0.1682620
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 39 cost time: 0.9524455070495605
Epoch: 39, Steps: 64 | Train Loss: 0.1063359 Vali Loss: 0.1885484 Test Loss: 0.1682872
Validation loss decreased (0.189276 --> 0.188548).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 40 cost time: 0.890789270401001
Epoch: 40, Steps: 64 | Train Loss: 0.1061121 Vali Loss: 0.1902812 Test Loss: 0.1671770
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 41 cost time: 0.9069983959197998
Epoch: 41, Steps: 64 | Train Loss: 0.1063699 Vali Loss: 0.1902650 Test Loss: 0.1672024
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 42 cost time: 0.9062891006469727
Epoch: 42, Steps: 64 | Train Loss: 0.1060167 Vali Loss: 0.1886294 Test Loss: 0.1685925
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 43 cost time: 0.9136009216308594
Epoch: 43, Steps: 64 | Train Loss: 0.1061887 Vali Loss: 0.1876068 Test Loss: 0.1670964
Validation loss decreased (0.188548 --> 0.187607).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 44 cost time: 0.9154782295227051
Epoch: 44, Steps: 64 | Train Loss: 0.1062445 Vali Loss: 0.1901721 Test Loss: 0.1682934
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 45 cost time: 0.9263572692871094
Epoch: 45, Steps: 64 | Train Loss: 0.1062272 Vali Loss: 0.1905780 Test Loss: 0.1676795
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 46 cost time: 0.9273767471313477
Epoch: 46, Steps: 64 | Train Loss: 0.1059409 Vali Loss: 0.1895900 Test Loss: 0.1680954
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 47 cost time: 0.9534440040588379
Epoch: 47, Steps: 64 | Train Loss: 0.1061560 Vali Loss: 0.1890920 Test Loss: 0.1676268
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 48 cost time: 0.9545857906341553
Epoch: 48, Steps: 64 | Train Loss: 0.1058055 Vali Loss: 0.1896268 Test Loss: 0.1678950
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 49 cost time: 0.9169998168945312
Epoch: 49, Steps: 64 | Train Loss: 0.1059367 Vali Loss: 0.1903623 Test Loss: 0.1679392
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 50 cost time: 0.9436092376708984
Epoch: 50, Steps: 64 | Train Loss: 0.1058848 Vali Loss: 0.1877932 Test Loss: 0.1679695
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 51 cost time: 0.9323358535766602
Epoch: 51, Steps: 64 | Train Loss: 0.1061597 Vali Loss: 0.1882457 Test Loss: 0.1680247
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 52 cost time: 0.9313845634460449
Epoch: 52, Steps: 64 | Train Loss: 0.1063554 Vali Loss: 0.1858083 Test Loss: 0.1679185
Validation loss decreased (0.187607 --> 0.185808).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 53 cost time: 0.9594535827636719
Epoch: 53, Steps: 64 | Train Loss: 0.1058334 Vali Loss: 0.1896311 Test Loss: 0.1680802
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 54 cost time: 0.9639098644256592
Epoch: 54, Steps: 64 | Train Loss: 0.1057265 Vali Loss: 0.1874705 Test Loss: 0.1683896
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 55 cost time: 0.9681365489959717
Epoch: 55, Steps: 64 | Train Loss: 0.1059528 Vali Loss: 0.1873580 Test Loss: 0.1676698
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 56 cost time: 0.9640014171600342
Epoch: 56, Steps: 64 | Train Loss: 0.1055468 Vali Loss: 0.1911108 Test Loss: 0.1685878
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 57 cost time: 0.9569997787475586
Epoch: 57, Steps: 64 | Train Loss: 0.1057035 Vali Loss: 0.1890443 Test Loss: 0.1677635
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 58 cost time: 0.9636440277099609
Epoch: 58, Steps: 64 | Train Loss: 0.1057182 Vali Loss: 0.1880038 Test Loss: 0.1684231
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 59 cost time: 0.9237759113311768
Epoch: 59, Steps: 64 | Train Loss: 0.1054077 Vali Loss: 0.1912584 Test Loss: 0.1684223
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017568588256835938 GB
GPU已分配内存的峰值：0.0367431640625 GB
Epoch: 60 cost time: 0.9113953113555908
Epoch: 60, Steps: 64 | Train Loss: 0.1058547 Vali Loss: 0.1881418 Test Loss: 0.1677865
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.16791847348213196, mae:0.318602591753006, rse:0.21810729801654816
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03681135177612305 GB
Epoch: 1 cost time: 2.3381762504577637
Epoch: 1, Steps: 64 | Train Loss: 0.8251807 Vali Loss: 1.9142115 Test Loss: 3.6976089
Validation loss decreased (inf --> 1.914212).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 2 cost time: 0.9664268493652344
Epoch: 2, Steps: 64 | Train Loss: 0.7054433 Vali Loss: 1.3708096 Test Loss: 2.5571318
Validation loss decreased (1.914212 --> 1.370810).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 3 cost time: 0.9692568778991699
Epoch: 3, Steps: 64 | Train Loss: 0.4902297 Vali Loss: 0.8574035 Test Loss: 1.4828250
Validation loss decreased (1.370810 --> 0.857403).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 4 cost time: 0.9638097286224365
Epoch: 4, Steps: 64 | Train Loss: 0.2989421 Vali Loss: 0.4548237 Test Loss: 0.6493720
Validation loss decreased (0.857403 --> 0.454824).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 5 cost time: 0.9615843296051025
Epoch: 5, Steps: 64 | Train Loss: 0.1831767 Vali Loss: 0.2859451 Test Loss: 0.3238796
Validation loss decreased (0.454824 --> 0.285945).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 6 cost time: 0.9367234706878662
Epoch: 6, Steps: 64 | Train Loss: 0.1419788 Vali Loss: 0.2350053 Test Loss: 0.2255576
Validation loss decreased (0.285945 --> 0.235005).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 7 cost time: 0.9380002021789551
Epoch: 7, Steps: 64 | Train Loss: 0.1270575 Vali Loss: 0.2166272 Test Loss: 0.1957382
Validation loss decreased (0.235005 --> 0.216627).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 8 cost time: 0.9504480361938477
Epoch: 8, Steps: 64 | Train Loss: 0.1208702 Vali Loss: 0.2028482 Test Loss: 0.1818382
Validation loss decreased (0.216627 --> 0.202848).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 9 cost time: 0.9536528587341309
Epoch: 9, Steps: 64 | Train Loss: 0.1172338 Vali Loss: 0.2001417 Test Loss: 0.1742696
Validation loss decreased (0.202848 --> 0.200142).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 10 cost time: 0.9853928089141846
Epoch: 10, Steps: 64 | Train Loss: 0.1139003 Vali Loss: 0.1959288 Test Loss: 0.1707720
Validation loss decreased (0.200142 --> 0.195929).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 11 cost time: 0.9974091053009033
Epoch: 11, Steps: 64 | Train Loss: 0.1116307 Vali Loss: 0.1915784 Test Loss: 0.1679510
Validation loss decreased (0.195929 --> 0.191578).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 12 cost time: 1.019965648651123
Epoch: 12, Steps: 64 | Train Loss: 0.1100812 Vali Loss: 0.1923916 Test Loss: 0.1659736
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 13 cost time: 0.9812722206115723
Epoch: 13, Steps: 64 | Train Loss: 0.1086258 Vali Loss: 0.1874914 Test Loss: 0.1645780
Validation loss decreased (0.191578 --> 0.187491).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 14 cost time: 0.973142147064209
Epoch: 14, Steps: 64 | Train Loss: 0.1079166 Vali Loss: 0.1878741 Test Loss: 0.1635412
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 15 cost time: 0.9813816547393799
Epoch: 15, Steps: 64 | Train Loss: 0.1067782 Vali Loss: 0.1884939 Test Loss: 0.1634004
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 16 cost time: 0.9662313461303711
Epoch: 16, Steps: 64 | Train Loss: 0.1058912 Vali Loss: 0.1865641 Test Loss: 0.1623151
Validation loss decreased (0.187491 --> 0.186564).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 17 cost time: 0.9657406806945801
Epoch: 17, Steps: 64 | Train Loss: 0.1048044 Vali Loss: 0.1861446 Test Loss: 0.1614616
Validation loss decreased (0.186564 --> 0.186145).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 18 cost time: 0.9879977703094482
Epoch: 18, Steps: 64 | Train Loss: 0.1041987 Vali Loss: 0.1857490 Test Loss: 0.1614081
Validation loss decreased (0.186145 --> 0.185749).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 19 cost time: 0.9716448783874512
Epoch: 19, Steps: 64 | Train Loss: 0.1038716 Vali Loss: 0.1869157 Test Loss: 0.1614009
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 20 cost time: 0.9600043296813965
Epoch: 20, Steps: 64 | Train Loss: 0.1030966 Vali Loss: 0.1830746 Test Loss: 0.1611496
Validation loss decreased (0.185749 --> 0.183075).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 21 cost time: 0.9743719100952148
Epoch: 21, Steps: 64 | Train Loss: 0.1031252 Vali Loss: 0.1854020 Test Loss: 0.1616035
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 22 cost time: 0.98649001121521
Epoch: 22, Steps: 64 | Train Loss: 0.1025233 Vali Loss: 0.1844954 Test Loss: 0.1609932
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 23 cost time: 0.9374680519104004
Epoch: 23, Steps: 64 | Train Loss: 0.1019140 Vali Loss: 0.1841792 Test Loss: 0.1606885
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 24 cost time: 0.9443743228912354
Epoch: 24, Steps: 64 | Train Loss: 0.1016571 Vali Loss: 0.1839264 Test Loss: 0.1604075
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 25 cost time: 0.9514410495758057
Epoch: 25, Steps: 64 | Train Loss: 0.1014202 Vali Loss: 0.1815277 Test Loss: 0.1603840
Validation loss decreased (0.183075 --> 0.181528).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 26 cost time: 0.9537653923034668
Epoch: 26, Steps: 64 | Train Loss: 0.1015206 Vali Loss: 0.1838904 Test Loss: 0.1605712
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 27 cost time: 0.9570000171661377
Epoch: 27, Steps: 64 | Train Loss: 0.1011140 Vali Loss: 0.1827541 Test Loss: 0.1605218
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 28 cost time: 0.9724137783050537
Epoch: 28, Steps: 64 | Train Loss: 0.1012609 Vali Loss: 0.1811714 Test Loss: 0.1613969
Validation loss decreased (0.181528 --> 0.181171).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 29 cost time: 0.9906265735626221
Epoch: 29, Steps: 64 | Train Loss: 0.1006032 Vali Loss: 0.1831132 Test Loss: 0.1610465
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 30 cost time: 0.9854271411895752
Epoch: 30, Steps: 64 | Train Loss: 0.1012855 Vali Loss: 0.1803722 Test Loss: 0.1601440
Validation loss decreased (0.181171 --> 0.180372).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 31 cost time: 0.9974713325500488
Epoch: 31, Steps: 64 | Train Loss: 0.1002271 Vali Loss: 0.1827060 Test Loss: 0.1610069
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 32 cost time: 0.9681379795074463
Epoch: 32, Steps: 64 | Train Loss: 0.1002296 Vali Loss: 0.1813916 Test Loss: 0.1600310
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 33 cost time: 0.9623725414276123
Epoch: 33, Steps: 64 | Train Loss: 0.1005053 Vali Loss: 0.1813777 Test Loss: 0.1609009
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 34 cost time: 0.9719178676605225
Epoch: 34, Steps: 64 | Train Loss: 0.0999164 Vali Loss: 0.1803316 Test Loss: 0.1605143
Validation loss decreased (0.180372 --> 0.180332).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 35 cost time: 0.9937281608581543
Epoch: 35, Steps: 64 | Train Loss: 0.1001905 Vali Loss: 0.1808341 Test Loss: 0.1600039
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 36 cost time: 0.9827816486358643
Epoch: 36, Steps: 64 | Train Loss: 0.0998281 Vali Loss: 0.1810466 Test Loss: 0.1600320
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 37 cost time: 0.9836411476135254
Epoch: 37, Steps: 64 | Train Loss: 0.1001461 Vali Loss: 0.1820401 Test Loss: 0.1605797
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 38 cost time: 0.9870009422302246
Epoch: 38, Steps: 64 | Train Loss: 0.1000208 Vali Loss: 0.1807477 Test Loss: 0.1599203
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 39 cost time: 0.9296503067016602
Epoch: 39, Steps: 64 | Train Loss: 0.0993929 Vali Loss: 0.1782870 Test Loss: 0.1598345
Validation loss decreased (0.180332 --> 0.178287).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 40 cost time: 0.9403738975524902
Epoch: 40, Steps: 64 | Train Loss: 0.0998035 Vali Loss: 0.1825346 Test Loss: 0.1607429
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 41 cost time: 0.9302980899810791
Epoch: 41, Steps: 64 | Train Loss: 0.0998040 Vali Loss: 0.1809023 Test Loss: 0.1604742
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 42 cost time: 0.9409825801849365
Epoch: 42, Steps: 64 | Train Loss: 0.1001020 Vali Loss: 0.1802747 Test Loss: 0.1600369
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 43 cost time: 0.9453544616699219
Epoch: 43, Steps: 64 | Train Loss: 0.0992050 Vali Loss: 0.1820225 Test Loss: 0.1599283
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 44 cost time: 0.9537744522094727
Epoch: 44, Steps: 64 | Train Loss: 0.0995544 Vali Loss: 0.1806028 Test Loss: 0.1601668
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 45 cost time: 0.9665031433105469
Epoch: 45, Steps: 64 | Train Loss: 0.0995631 Vali Loss: 0.1820883 Test Loss: 0.1604234
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 46 cost time: 0.966526985168457
Epoch: 46, Steps: 64 | Train Loss: 0.0992532 Vali Loss: 0.1791504 Test Loss: 0.1606252
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 47 cost time: 0.9826200008392334
Epoch: 47, Steps: 64 | Train Loss: 0.0997852 Vali Loss: 0.1808558 Test Loss: 0.1600331
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 48 cost time: 0.9722001552581787
Epoch: 48, Steps: 64 | Train Loss: 0.0992299 Vali Loss: 0.1814645 Test Loss: 0.1604922
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 49 cost time: 0.9805440902709961
Epoch: 49, Steps: 64 | Train Loss: 0.0993828 Vali Loss: 0.1809516 Test Loss: 0.1611322
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 50 cost time: 0.9693558216094971
Epoch: 50, Steps: 64 | Train Loss: 0.0990373 Vali Loss: 0.1809448 Test Loss: 0.1603011
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 51 cost time: 0.9624278545379639
Epoch: 51, Steps: 64 | Train Loss: 0.0992966 Vali Loss: 0.1823477 Test Loss: 0.1605098
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 52 cost time: 0.9273912906646729
Epoch: 52, Steps: 64 | Train Loss: 0.0991910 Vali Loss: 0.1814761 Test Loss: 0.1601518
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 53 cost time: 0.9763014316558838
Epoch: 53, Steps: 64 | Train Loss: 0.0989824 Vali Loss: 0.1801107 Test Loss: 0.1597527
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 54 cost time: 0.9817466735839844
Epoch: 54, Steps: 64 | Train Loss: 0.0991781 Vali Loss: 0.1816151 Test Loss: 0.1603740
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 55 cost time: 0.9899997711181641
Epoch: 55, Steps: 64 | Train Loss: 0.0993758 Vali Loss: 0.1798262 Test Loss: 0.1604528
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 56 cost time: 0.9586329460144043
Epoch: 56, Steps: 64 | Train Loss: 0.0989230 Vali Loss: 0.1823257 Test Loss: 0.1599830
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 57 cost time: 0.9346251487731934
Epoch: 57, Steps: 64 | Train Loss: 0.0989360 Vali Loss: 0.1789871 Test Loss: 0.1598973
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 58 cost time: 0.9452497959136963
Epoch: 58, Steps: 64 | Train Loss: 0.0992255 Vali Loss: 0.1790397 Test Loss: 0.1602775
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 59 cost time: 0.9354503154754639
Epoch: 59, Steps: 64 | Train Loss: 0.0993389 Vali Loss: 0.1817850 Test Loss: 0.1604303
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017591476440429688 GB
GPU已分配内存的峰值：0.03749275207519531 GB
Epoch: 60 cost time: 0.9363594055175781
Epoch: 60, Steps: 64 | Train Loss: 0.0993012 Vali Loss: 0.1797997 Test Loss: 0.1602395
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15983451902866364, mae:0.3068842589855194, rse:0.21279247105121613
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03570699691772461 GB
Epoch: 1 cost time: 2.297485589981079
Epoch: 1, Steps: 64 | Train Loss: 1.1319521 Vali Loss: 2.4062777 Test Loss: 4.5746388
Validation loss decreased (inf --> 2.406278).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 2 cost time: 0.9100735187530518
Epoch: 2, Steps: 64 | Train Loss: 0.9140737 Vali Loss: 1.5453141 Test Loss: 2.7894850
Validation loss decreased (2.406278 --> 1.545314).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 3 cost time: 0.906440258026123
Epoch: 3, Steps: 64 | Train Loss: 0.6163884 Vali Loss: 0.9990555 Test Loss: 1.6545049
Validation loss decreased (1.545314 --> 0.999056).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 4 cost time: 0.9097476005554199
Epoch: 4, Steps: 64 | Train Loss: 0.4046668 Vali Loss: 0.6677336 Test Loss: 0.9901697
Validation loss decreased (0.999056 --> 0.667734).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 5 cost time: 0.9080002307891846
Epoch: 5, Steps: 64 | Train Loss: 0.3069100 Vali Loss: 0.5389982 Test Loss: 0.7453681
Validation loss decreased (0.667734 --> 0.538998).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 6 cost time: 0.8786342144012451
Epoch: 6, Steps: 64 | Train Loss: 0.2553721 Vali Loss: 0.4567629 Test Loss: 0.5980092
Validation loss decreased (0.538998 --> 0.456763).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 7 cost time: 0.8861808776855469
Epoch: 7, Steps: 64 | Train Loss: 0.2217724 Vali Loss: 0.4028846 Test Loss: 0.5058352
Validation loss decreased (0.456763 --> 0.402885).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 8 cost time: 0.8984260559082031
Epoch: 8, Steps: 64 | Train Loss: 0.2003140 Vali Loss: 0.3645652 Test Loss: 0.4344956
Validation loss decreased (0.402885 --> 0.364565).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 9 cost time: 0.9194684028625488
Epoch: 9, Steps: 64 | Train Loss: 0.1816218 Vali Loss: 0.3276696 Test Loss: 0.3795630
Validation loss decreased (0.364565 --> 0.327670).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 10 cost time: 0.93072509765625
Epoch: 10, Steps: 64 | Train Loss: 0.1706124 Vali Loss: 0.3057680 Test Loss: 0.3417509
Validation loss decreased (0.327670 --> 0.305768).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 11 cost time: 0.9352321624755859
Epoch: 11, Steps: 64 | Train Loss: 0.1614211 Vali Loss: 0.2828350 Test Loss: 0.3091853
Validation loss decreased (0.305768 --> 0.282835).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 12 cost time: 0.9500010013580322
Epoch: 12, Steps: 64 | Train Loss: 0.1533291 Vali Loss: 0.2699328 Test Loss: 0.2863178
Validation loss decreased (0.282835 --> 0.269933).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 13 cost time: 0.9326469898223877
Epoch: 13, Steps: 64 | Train Loss: 0.1479224 Vali Loss: 0.2584049 Test Loss: 0.2689895
Validation loss decreased (0.269933 --> 0.258405).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 14 cost time: 0.9084007740020752
Epoch: 14, Steps: 64 | Train Loss: 0.1429771 Vali Loss: 0.2478630 Test Loss: 0.2520246
Validation loss decreased (0.258405 --> 0.247863).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 15 cost time: 0.9140303134918213
Epoch: 15, Steps: 64 | Train Loss: 0.1397485 Vali Loss: 0.2400927 Test Loss: 0.2413727
Validation loss decreased (0.247863 --> 0.240093).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 16 cost time: 0.9055089950561523
Epoch: 16, Steps: 64 | Train Loss: 0.1377264 Vali Loss: 0.2341002 Test Loss: 0.2321147
Validation loss decreased (0.240093 --> 0.234100).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 17 cost time: 0.908390998840332
Epoch: 17, Steps: 64 | Train Loss: 0.1343178 Vali Loss: 0.2270098 Test Loss: 0.2225244
Validation loss decreased (0.234100 --> 0.227010).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 18 cost time: 0.9208078384399414
Epoch: 18, Steps: 64 | Train Loss: 0.1330292 Vali Loss: 0.2218364 Test Loss: 0.2167766
Validation loss decreased (0.227010 --> 0.221836).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 19 cost time: 1.0108647346496582
Epoch: 19, Steps: 64 | Train Loss: 0.1311222 Vali Loss: 0.2196239 Test Loss: 0.2117857
Validation loss decreased (0.221836 --> 0.219624).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 20 cost time: 1.0279054641723633
Epoch: 20, Steps: 64 | Train Loss: 0.1293146 Vali Loss: 0.2168156 Test Loss: 0.2081118
Validation loss decreased (0.219624 --> 0.216816).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 21 cost time: 1.0187604427337646
Epoch: 21, Steps: 64 | Train Loss: 0.1280355 Vali Loss: 0.2150724 Test Loss: 0.2072460
Validation loss decreased (0.216816 --> 0.215072).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 22 cost time: 1.0062408447265625
Epoch: 22, Steps: 64 | Train Loss: 0.1277256 Vali Loss: 0.2119672 Test Loss: 0.2028977
Validation loss decreased (0.215072 --> 0.211967).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 23 cost time: 0.9486138820648193
Epoch: 23, Steps: 64 | Train Loss: 0.1263302 Vali Loss: 0.2092102 Test Loss: 0.1988502
Validation loss decreased (0.211967 --> 0.209210).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 24 cost time: 0.9224650859832764
Epoch: 24, Steps: 64 | Train Loss: 0.1252917 Vali Loss: 0.2084737 Test Loss: 0.1980355
Validation loss decreased (0.209210 --> 0.208474).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 25 cost time: 0.9249286651611328
Epoch: 25, Steps: 64 | Train Loss: 0.1244494 Vali Loss: 0.2079277 Test Loss: 0.1958744
Validation loss decreased (0.208474 --> 0.207928).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 26 cost time: 0.9012961387634277
Epoch: 26, Steps: 64 | Train Loss: 0.1242835 Vali Loss: 0.2051493 Test Loss: 0.1934338
Validation loss decreased (0.207928 --> 0.205149).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 27 cost time: 0.9074480533599854
Epoch: 27, Steps: 64 | Train Loss: 0.1238179 Vali Loss: 0.2030416 Test Loss: 0.1919384
Validation loss decreased (0.205149 --> 0.203042).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 28 cost time: 0.9174153804779053
Epoch: 28, Steps: 64 | Train Loss: 0.1226201 Vali Loss: 0.2009406 Test Loss: 0.1919055
Validation loss decreased (0.203042 --> 0.200941).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 29 cost time: 0.9009978771209717
Epoch: 29, Steps: 64 | Train Loss: 0.1222179 Vali Loss: 0.1996121 Test Loss: 0.1888200
Validation loss decreased (0.200941 --> 0.199612).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 30 cost time: 0.8886456489562988
Epoch: 30, Steps: 64 | Train Loss: 0.1217165 Vali Loss: 0.2013290 Test Loss: 0.1897899
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 31 cost time: 0.9083962440490723
Epoch: 31, Steps: 64 | Train Loss: 0.1217884 Vali Loss: 0.2014374 Test Loss: 0.1890338
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 32 cost time: 0.9123373031616211
Epoch: 32, Steps: 64 | Train Loss: 0.1214571 Vali Loss: 0.1978660 Test Loss: 0.1857584
Validation loss decreased (0.199612 --> 0.197866).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 33 cost time: 0.9074103832244873
Epoch: 33, Steps: 64 | Train Loss: 0.1212120 Vali Loss: 0.1986265 Test Loss: 0.1863861
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 34 cost time: 0.9137213230133057
Epoch: 34, Steps: 64 | Train Loss: 0.1213793 Vali Loss: 0.1983892 Test Loss: 0.1857857
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 35 cost time: 0.9209988117218018
Epoch: 35, Steps: 64 | Train Loss: 0.1205177 Vali Loss: 0.1984302 Test Loss: 0.1855424
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 36 cost time: 0.9409787654876709
Epoch: 36, Steps: 64 | Train Loss: 0.1204895 Vali Loss: 0.1974891 Test Loss: 0.1854229
Validation loss decreased (0.197866 --> 0.197489).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 37 cost time: 0.9256200790405273
Epoch: 37, Steps: 64 | Train Loss: 0.1204389 Vali Loss: 0.1959518 Test Loss: 0.1851668
Validation loss decreased (0.197489 --> 0.195952).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 38 cost time: 0.9334025382995605
Epoch: 38, Steps: 64 | Train Loss: 0.1203479 Vali Loss: 0.1984355 Test Loss: 0.1838346
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 39 cost time: 0.9293875694274902
Epoch: 39, Steps: 64 | Train Loss: 0.1197374 Vali Loss: 0.1974386 Test Loss: 0.1842331
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 40 cost time: 0.907153844833374
Epoch: 40, Steps: 64 | Train Loss: 0.1190353 Vali Loss: 0.1965967 Test Loss: 0.1829009
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 41 cost time: 0.876816987991333
Epoch: 41, Steps: 64 | Train Loss: 0.1192864 Vali Loss: 0.1946887 Test Loss: 0.1821729
Validation loss decreased (0.195952 --> 0.194689).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 42 cost time: 0.880000114440918
Epoch: 42, Steps: 64 | Train Loss: 0.1202515 Vali Loss: 0.1958704 Test Loss: 0.1821340
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 43 cost time: 0.8946247100830078
Epoch: 43, Steps: 64 | Train Loss: 0.1199487 Vali Loss: 0.1971208 Test Loss: 0.1810921
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 44 cost time: 0.9046347141265869
Epoch: 44, Steps: 64 | Train Loss: 0.1188445 Vali Loss: 0.1934048 Test Loss: 0.1825639
Validation loss decreased (0.194689 --> 0.193405).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 45 cost time: 0.8984105587005615
Epoch: 45, Steps: 64 | Train Loss: 0.1191420 Vali Loss: 0.1934400 Test Loss: 0.1810802
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 46 cost time: 0.9019112586975098
Epoch: 46, Steps: 64 | Train Loss: 0.1191600 Vali Loss: 0.1952336 Test Loss: 0.1818812
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 47 cost time: 0.9068200588226318
Epoch: 47, Steps: 64 | Train Loss: 0.1194774 Vali Loss: 0.1946118 Test Loss: 0.1807502
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 48 cost time: 0.9227821826934814
Epoch: 48, Steps: 64 | Train Loss: 0.1197959 Vali Loss: 0.1968275 Test Loss: 0.1819308
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 49 cost time: 0.9184005260467529
Epoch: 49, Steps: 64 | Train Loss: 0.1188246 Vali Loss: 0.1956935 Test Loss: 0.1816904
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 50 cost time: 0.9246373176574707
Epoch: 50, Steps: 64 | Train Loss: 0.1191787 Vali Loss: 0.1963369 Test Loss: 0.1811966
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 51 cost time: 0.8984010219573975
Epoch: 51, Steps: 64 | Train Loss: 0.1194907 Vali Loss: 0.1936845 Test Loss: 0.1805882
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 52 cost time: 0.9083936214447021
Epoch: 52, Steps: 64 | Train Loss: 0.1190500 Vali Loss: 0.1961537 Test Loss: 0.1817190
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 53 cost time: 0.9253993034362793
Epoch: 53, Steps: 64 | Train Loss: 0.1192496 Vali Loss: 0.1907398 Test Loss: 0.1794569
Validation loss decreased (0.193405 --> 0.190740).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 54 cost time: 0.9324295520782471
Epoch: 54, Steps: 64 | Train Loss: 0.1190178 Vali Loss: 0.1943692 Test Loss: 0.1804073
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 55 cost time: 0.9229996204376221
Epoch: 55, Steps: 64 | Train Loss: 0.1192306 Vali Loss: 0.1962939 Test Loss: 0.1815875
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 56 cost time: 0.92563796043396
Epoch: 56, Steps: 64 | Train Loss: 0.1191449 Vali Loss: 0.1918775 Test Loss: 0.1796602
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 57 cost time: 0.9284119606018066
Epoch: 57, Steps: 64 | Train Loss: 0.1188116 Vali Loss: 0.1917961 Test Loss: 0.1810754
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 58 cost time: 0.9124112129211426
Epoch: 58, Steps: 64 | Train Loss: 0.1187345 Vali Loss: 0.1932279 Test Loss: 0.1789732
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 59 cost time: 0.908576250076294
Epoch: 59, Steps: 64 | Train Loss: 0.1190598 Vali Loss: 0.1952692 Test Loss: 0.1813751
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017534255981445312 GB
GPU已分配内存的峰值：0.03614521026611328 GB
Epoch: 60 cost time: 0.9114646911621094
Epoch: 60, Steps: 64 | Train Loss: 0.1184845 Vali Loss: 0.1914181 Test Loss: 0.1798018
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1794569045305252, mae:0.32966938614845276, rse:0.22547638416290283
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.036408424377441406 GB
Epoch: 1 cost time: 2.324603796005249
Epoch: 1, Steps: 64 | Train Loss: 0.8361066 Vali Loss: 1.8906955 Test Loss: 3.5605245
Validation loss decreased (inf --> 1.890695).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 2 cost time: 0.9374017715454102
Epoch: 2, Steps: 64 | Train Loss: 0.6779720 Vali Loss: 1.1908251 Test Loss: 2.1028371
Validation loss decreased (1.890695 --> 1.190825).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 3 cost time: 0.9425868988037109
Epoch: 3, Steps: 64 | Train Loss: 0.4162446 Vali Loss: 0.7011223 Test Loss: 1.0746595
Validation loss decreased (1.190825 --> 0.701122).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 4 cost time: 0.9480009078979492
Epoch: 4, Steps: 64 | Train Loss: 0.2536030 Vali Loss: 0.4442733 Test Loss: 0.5494410
Validation loss decreased (0.701122 --> 0.444273).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 5 cost time: 0.9259991645812988
Epoch: 5, Steps: 64 | Train Loss: 0.1779050 Vali Loss: 0.3255519 Test Loss: 0.3411274
Validation loss decreased (0.444273 --> 0.325552).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 6 cost time: 0.9276366233825684
Epoch: 6, Steps: 64 | Train Loss: 0.1467018 Vali Loss: 0.2724090 Test Loss: 0.2452719
Validation loss decreased (0.325552 --> 0.272409).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 7 cost time: 0.9373815059661865
Epoch: 7, Steps: 64 | Train Loss: 0.1311172 Vali Loss: 0.2412566 Test Loss: 0.2029188
Validation loss decreased (0.272409 --> 0.241257).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 8 cost time: 0.925194501876831
Epoch: 8, Steps: 64 | Train Loss: 0.1221022 Vali Loss: 0.2201377 Test Loss: 0.1815317
Validation loss decreased (0.241257 --> 0.220138).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 9 cost time: 0.9394395351409912
Epoch: 9, Steps: 64 | Train Loss: 0.1165284 Vali Loss: 0.2100010 Test Loss: 0.1711523
Validation loss decreased (0.220138 --> 0.210001).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 10 cost time: 0.9434342384338379
Epoch: 10, Steps: 64 | Train Loss: 0.1139645 Vali Loss: 0.1977873 Test Loss: 0.1658290
Validation loss decreased (0.210001 --> 0.197787).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 11 cost time: 0.9657936096191406
Epoch: 11, Steps: 64 | Train Loss: 0.1109500 Vali Loss: 0.1921218 Test Loss: 0.1595841
Validation loss decreased (0.197787 --> 0.192122).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 12 cost time: 0.9577562808990479
Epoch: 12, Steps: 64 | Train Loss: 0.1085390 Vali Loss: 0.1879373 Test Loss: 0.1595538
Validation loss decreased (0.192122 --> 0.187937).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 13 cost time: 0.9599997997283936
Epoch: 13, Steps: 64 | Train Loss: 0.1066951 Vali Loss: 0.1861961 Test Loss: 0.1577048
Validation loss decreased (0.187937 --> 0.186196).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 14 cost time: 0.9566555023193359
Epoch: 14, Steps: 64 | Train Loss: 0.1063106 Vali Loss: 0.1801847 Test Loss: 0.1561370
Validation loss decreased (0.186196 --> 0.180185).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 15 cost time: 0.9430296421051025
Epoch: 15, Steps: 64 | Train Loss: 0.1041640 Vali Loss: 0.1806703 Test Loss: 0.1553290
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 16 cost time: 0.9424114227294922
Epoch: 16, Steps: 64 | Train Loss: 0.1036101 Vali Loss: 0.1787414 Test Loss: 0.1564518
Validation loss decreased (0.180185 --> 0.178741).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 17 cost time: 0.9417040348052979
Epoch: 17, Steps: 64 | Train Loss: 0.1025621 Vali Loss: 0.1782164 Test Loss: 0.1547654
Validation loss decreased (0.178741 --> 0.178216).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 18 cost time: 0.9597010612487793
Epoch: 18, Steps: 64 | Train Loss: 0.1024926 Vali Loss: 0.1771336 Test Loss: 0.1544269
Validation loss decreased (0.178216 --> 0.177134).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 19 cost time: 0.9599974155426025
Epoch: 19, Steps: 64 | Train Loss: 0.1019265 Vali Loss: 0.1743141 Test Loss: 0.1536526
Validation loss decreased (0.177134 --> 0.174314).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 20 cost time: 0.9550323486328125
Epoch: 20, Steps: 64 | Train Loss: 0.1010120 Vali Loss: 0.1750960 Test Loss: 0.1551381
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 21 cost time: 0.9577121734619141
Epoch: 21, Steps: 64 | Train Loss: 0.1006143 Vali Loss: 0.1742541 Test Loss: 0.1552229
Validation loss decreased (0.174314 --> 0.174254).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 22 cost time: 0.925999641418457
Epoch: 22, Steps: 64 | Train Loss: 0.1003742 Vali Loss: 0.1736891 Test Loss: 0.1544419
Validation loss decreased (0.174254 --> 0.173689).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 23 cost time: 0.9316494464874268
Epoch: 23, Steps: 64 | Train Loss: 0.1000560 Vali Loss: 0.1743735 Test Loss: 0.1538822
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 24 cost time: 0.9441061019897461
Epoch: 24, Steps: 64 | Train Loss: 0.0995971 Vali Loss: 0.1726930 Test Loss: 0.1540163
Validation loss decreased (0.173689 --> 0.172693).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 25 cost time: 0.9305260181427002
Epoch: 25, Steps: 64 | Train Loss: 0.0994236 Vali Loss: 0.1722455 Test Loss: 0.1541251
Validation loss decreased (0.172693 --> 0.172246).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 26 cost time: 0.9361951351165771
Epoch: 26, Steps: 64 | Train Loss: 0.0990738 Vali Loss: 0.1719775 Test Loss: 0.1532767
Validation loss decreased (0.172246 --> 0.171977).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 27 cost time: 0.9474318027496338
Epoch: 27, Steps: 64 | Train Loss: 0.0991706 Vali Loss: 0.1728913 Test Loss: 0.1536532
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 28 cost time: 0.9503540992736816
Epoch: 28, Steps: 64 | Train Loss: 0.0988426 Vali Loss: 0.1720930 Test Loss: 0.1541932
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 29 cost time: 0.93475341796875
Epoch: 29, Steps: 64 | Train Loss: 0.0985203 Vali Loss: 0.1724542 Test Loss: 0.1534242
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 30 cost time: 0.9579977989196777
Epoch: 30, Steps: 64 | Train Loss: 0.0982494 Vali Loss: 0.1713741 Test Loss: 0.1532697
Validation loss decreased (0.171977 --> 0.171374).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 31 cost time: 0.9562017917633057
Epoch: 31, Steps: 64 | Train Loss: 0.0984234 Vali Loss: 0.1723680 Test Loss: 0.1547558
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 32 cost time: 0.9536426067352295
Epoch: 32, Steps: 64 | Train Loss: 0.0979807 Vali Loss: 0.1725977 Test Loss: 0.1540409
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 33 cost time: 0.9564113616943359
Epoch: 33, Steps: 64 | Train Loss: 0.0978384 Vali Loss: 0.1707962 Test Loss: 0.1537278
Validation loss decreased (0.171374 --> 0.170796).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 34 cost time: 0.9660577774047852
Epoch: 34, Steps: 64 | Train Loss: 0.0979141 Vali Loss: 0.1697612 Test Loss: 0.1536596
Validation loss decreased (0.170796 --> 0.169761).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 35 cost time: 0.9632265567779541
Epoch: 35, Steps: 64 | Train Loss: 0.0978379 Vali Loss: 0.1725434 Test Loss: 0.1544232
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 36 cost time: 0.9574570655822754
Epoch: 36, Steps: 64 | Train Loss: 0.0975090 Vali Loss: 0.1700296 Test Loss: 0.1543731
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 37 cost time: 0.965590238571167
Epoch: 37, Steps: 64 | Train Loss: 0.0973005 Vali Loss: 0.1717005 Test Loss: 0.1542228
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 38 cost time: 0.9709281921386719
Epoch: 38, Steps: 64 | Train Loss: 0.0972936 Vali Loss: 0.1715442 Test Loss: 0.1542313
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 39 cost time: 0.9549996852874756
Epoch: 39, Steps: 64 | Train Loss: 0.0975543 Vali Loss: 0.1721344 Test Loss: 0.1539894
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 40 cost time: 0.955000638961792
Epoch: 40, Steps: 64 | Train Loss: 0.0976286 Vali Loss: 0.1711870 Test Loss: 0.1541439
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 41 cost time: 0.9536144733428955
Epoch: 41, Steps: 64 | Train Loss: 0.0970008 Vali Loss: 0.1709134 Test Loss: 0.1538463
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 42 cost time: 0.9273955821990967
Epoch: 42, Steps: 64 | Train Loss: 0.0974155 Vali Loss: 0.1680184 Test Loss: 0.1531573
Validation loss decreased (0.169761 --> 0.168018).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 43 cost time: 0.9324512481689453
Epoch: 43, Steps: 64 | Train Loss: 0.0969892 Vali Loss: 0.1701771 Test Loss: 0.1539021
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 44 cost time: 0.9424631595611572
Epoch: 44, Steps: 64 | Train Loss: 0.0970841 Vali Loss: 0.1689823 Test Loss: 0.1542709
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 45 cost time: 0.9423866271972656
Epoch: 45, Steps: 64 | Train Loss: 0.0975315 Vali Loss: 0.1720704 Test Loss: 0.1533502
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 46 cost time: 0.9348254203796387
Epoch: 46, Steps: 64 | Train Loss: 0.0966212 Vali Loss: 0.1711425 Test Loss: 0.1544567
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 47 cost time: 0.9227118492126465
Epoch: 47, Steps: 64 | Train Loss: 0.0975138 Vali Loss: 0.1696590 Test Loss: 0.1540495
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 48 cost time: 0.9170002937316895
Epoch: 48, Steps: 64 | Train Loss: 0.0967119 Vali Loss: 0.1723385 Test Loss: 0.1540589
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 49 cost time: 0.9116237163543701
Epoch: 49, Steps: 64 | Train Loss: 0.0967057 Vali Loss: 0.1710079 Test Loss: 0.1541214
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 50 cost time: 0.9464209079742432
Epoch: 50, Steps: 64 | Train Loss: 0.0969947 Vali Loss: 0.1713631 Test Loss: 0.1541995
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 51 cost time: 0.9440245628356934
Epoch: 51, Steps: 64 | Train Loss: 0.0970556 Vali Loss: 0.1708869 Test Loss: 0.1541218
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 52 cost time: 0.9630646705627441
Epoch: 52, Steps: 64 | Train Loss: 0.0971335 Vali Loss: 0.1714473 Test Loss: 0.1539925
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 53 cost time: 0.959564208984375
Epoch: 53, Steps: 64 | Train Loss: 0.0971508 Vali Loss: 0.1706072 Test Loss: 0.1533913
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 54 cost time: 0.9527530670166016
Epoch: 54, Steps: 64 | Train Loss: 0.0965144 Vali Loss: 0.1691815 Test Loss: 0.1533438
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 55 cost time: 0.9760010242462158
Epoch: 55, Steps: 64 | Train Loss: 0.0968659 Vali Loss: 0.1714322 Test Loss: 0.1538842
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 56 cost time: 0.9536323547363281
Epoch: 56, Steps: 64 | Train Loss: 0.0967242 Vali Loss: 0.1708245 Test Loss: 0.1543517
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 57 cost time: 0.954639196395874
Epoch: 57, Steps: 64 | Train Loss: 0.0968432 Vali Loss: 0.1705763 Test Loss: 0.1539782
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 58 cost time: 0.9591708183288574
Epoch: 58, Steps: 64 | Train Loss: 0.0971496 Vali Loss: 0.1702432 Test Loss: 0.1533980
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 59 cost time: 0.9454150199890137
Epoch: 59, Steps: 64 | Train Loss: 0.0970043 Vali Loss: 0.1708483 Test Loss: 0.1536842
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017572402954101562 GB
GPU已分配内存的峰值：0.03690624237060547 GB
Epoch: 60 cost time: 0.9483819007873535
Epoch: 60, Steps: 64 | Train Loss: 0.0966914 Vali Loss: 0.1704931 Test Loss: 0.1538389
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1531573235988617, mae:0.29658108949661255, rse:0.20830027759075165
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.0369725227355957 GB
Epoch: 1 cost time: 2.366833209991455
Epoch: 1, Steps: 64 | Train Loss: 0.8026736 Vali Loss: 1.8832617 Test Loss: 3.6141393
Validation loss decreased (inf --> 1.883262).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 2 cost time: 0.95992112159729
Epoch: 2, Steps: 64 | Train Loss: 0.6788773 Vali Loss: 1.3117174 Test Loss: 2.4176807
Validation loss decreased (1.883262 --> 1.311717).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 3 cost time: 0.9745066165924072
Epoch: 3, Steps: 64 | Train Loss: 0.4525565 Vali Loss: 0.7661473 Test Loss: 1.2844061
Validation loss decreased (1.311717 --> 0.766147).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 4 cost time: 0.9631264209747314
Epoch: 4, Steps: 64 | Train Loss: 0.2670131 Vali Loss: 0.4128895 Test Loss: 0.5672171
Validation loss decreased (0.766147 --> 0.412889).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 5 cost time: 0.9373948574066162
Epoch: 5, Steps: 64 | Train Loss: 0.1626939 Vali Loss: 0.2548804 Test Loss: 0.2689128
Validation loss decreased (0.412889 --> 0.254880).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 6 cost time: 0.9307982921600342
Epoch: 6, Steps: 64 | Train Loss: 0.1252564 Vali Loss: 0.2014099 Test Loss: 0.1786398
Validation loss decreased (0.254880 --> 0.201410).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 7 cost time: 0.9370005130767822
Epoch: 7, Steps: 64 | Train Loss: 0.1134209 Vali Loss: 0.1880559 Test Loss: 0.1611309
Validation loss decreased (0.201410 --> 0.188056).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 8 cost time: 0.9409995079040527
Epoch: 8, Steps: 64 | Train Loss: 0.1095055 Vali Loss: 0.1777362 Test Loss: 0.1542340
Validation loss decreased (0.188056 --> 0.177736).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 9 cost time: 0.9649794101715088
Epoch: 9, Steps: 64 | Train Loss: 0.1072181 Vali Loss: 0.1769243 Test Loss: 0.1532664
Validation loss decreased (0.177736 --> 0.176924).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 10 cost time: 0.9840362071990967
Epoch: 10, Steps: 64 | Train Loss: 0.1058043 Vali Loss: 0.1778865 Test Loss: 0.1529457
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 11 cost time: 1.00748872756958
Epoch: 11, Steps: 64 | Train Loss: 0.1040291 Vali Loss: 0.1725240 Test Loss: 0.1503182
Validation loss decreased (0.176924 --> 0.172524).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 12 cost time: 0.9874680042266846
Epoch: 12, Steps: 64 | Train Loss: 0.1025900 Vali Loss: 0.1713457 Test Loss: 0.1514243
Validation loss decreased (0.172524 --> 0.171346).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 13 cost time: 0.9820809364318848
Epoch: 13, Steps: 64 | Train Loss: 0.1016725 Vali Loss: 0.1722852 Test Loss: 0.1505647
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 14 cost time: 0.982405424118042
Epoch: 14, Steps: 64 | Train Loss: 0.1008614 Vali Loss: 0.1706683 Test Loss: 0.1494617
Validation loss decreased (0.171346 --> 0.170668).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 15 cost time: 0.9706704616546631
Epoch: 15, Steps: 64 | Train Loss: 0.0999577 Vali Loss: 0.1696262 Test Loss: 0.1492976
Validation loss decreased (0.170668 --> 0.169626).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 16 cost time: 0.9791793823242188
Epoch: 16, Steps: 64 | Train Loss: 0.0993565 Vali Loss: 0.1703736 Test Loss: 0.1495660
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 17 cost time: 0.9807264804840088
Epoch: 17, Steps: 64 | Train Loss: 0.0994133 Vali Loss: 0.1697818 Test Loss: 0.1491947
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 18 cost time: 0.9919788837432861
Epoch: 18, Steps: 64 | Train Loss: 0.0989232 Vali Loss: 0.1712028 Test Loss: 0.1494681
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 19 cost time: 0.9916403293609619
Epoch: 19, Steps: 64 | Train Loss: 0.0980798 Vali Loss: 0.1706302 Test Loss: 0.1496918
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 20 cost time: 0.9826459884643555
Epoch: 20, Steps: 64 | Train Loss: 0.0979499 Vali Loss: 0.1683332 Test Loss: 0.1484821
Validation loss decreased (0.169626 --> 0.168333).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 21 cost time: 0.9896135330200195
Epoch: 21, Steps: 64 | Train Loss: 0.0974801 Vali Loss: 0.1705240 Test Loss: 0.1495269
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 22 cost time: 0.93501877784729
Epoch: 22, Steps: 64 | Train Loss: 0.0973245 Vali Loss: 0.1694216 Test Loss: 0.1500982
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 23 cost time: 0.9303717613220215
Epoch: 23, Steps: 64 | Train Loss: 0.0962513 Vali Loss: 0.1702067 Test Loss: 0.1497102
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 24 cost time: 0.932373046875
Epoch: 24, Steps: 64 | Train Loss: 0.0971287 Vali Loss: 0.1691750 Test Loss: 0.1496254
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 25 cost time: 0.9413752555847168
Epoch: 25, Steps: 64 | Train Loss: 0.0959764 Vali Loss: 0.1681859 Test Loss: 0.1489774
Validation loss decreased (0.168333 --> 0.168186).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 26 cost time: 0.9661381244659424
Epoch: 26, Steps: 64 | Train Loss: 0.0958785 Vali Loss: 0.1686697 Test Loss: 0.1491762
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 27 cost time: 0.9566159248352051
Epoch: 27, Steps: 64 | Train Loss: 0.0962467 Vali Loss: 0.1682497 Test Loss: 0.1492076
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 28 cost time: 0.9459998607635498
Epoch: 28, Steps: 64 | Train Loss: 0.0957580 Vali Loss: 0.1669209 Test Loss: 0.1499484
Validation loss decreased (0.168186 --> 0.166921).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 29 cost time: 0.9778213500976562
Epoch: 29, Steps: 64 | Train Loss: 0.0956028 Vali Loss: 0.1665905 Test Loss: 0.1485343
Validation loss decreased (0.166921 --> 0.166591).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 30 cost time: 0.9844155311584473
Epoch: 30, Steps: 64 | Train Loss: 0.0955123 Vali Loss: 0.1665566 Test Loss: 0.1487807
Validation loss decreased (0.166591 --> 0.166557).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 31 cost time: 0.9906401634216309
Epoch: 31, Steps: 64 | Train Loss: 0.0953048 Vali Loss: 0.1671132 Test Loss: 0.1492117
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 32 cost time: 0.9853973388671875
Epoch: 32, Steps: 64 | Train Loss: 0.0953141 Vali Loss: 0.1668680 Test Loss: 0.1490036
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 33 cost time: 0.9844465255737305
Epoch: 33, Steps: 64 | Train Loss: 0.0953344 Vali Loss: 0.1671045 Test Loss: 0.1486650
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 34 cost time: 0.9824390411376953
Epoch: 34, Steps: 64 | Train Loss: 0.0953799 Vali Loss: 0.1675702 Test Loss: 0.1482665
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 35 cost time: 0.9959156513214111
Epoch: 35, Steps: 64 | Train Loss: 0.0952847 Vali Loss: 0.1683488 Test Loss: 0.1492501
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 36 cost time: 0.9885084629058838
Epoch: 36, Steps: 64 | Train Loss: 0.0946978 Vali Loss: 0.1664635 Test Loss: 0.1490756
Validation loss decreased (0.166557 --> 0.166463).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 37 cost time: 0.9768102169036865
Epoch: 37, Steps: 64 | Train Loss: 0.0949053 Vali Loss: 0.1681235 Test Loss: 0.1492962
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 38 cost time: 1.0118682384490967
Epoch: 38, Steps: 64 | Train Loss: 0.0947600 Vali Loss: 0.1650176 Test Loss: 0.1494144
Validation loss decreased (0.166463 --> 0.165018).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 39 cost time: 0.9627730846405029
Epoch: 39, Steps: 64 | Train Loss: 0.0952702 Vali Loss: 0.1663207 Test Loss: 0.1495506
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 40 cost time: 0.9576590061187744
Epoch: 40, Steps: 64 | Train Loss: 0.0952998 Vali Loss: 0.1672573 Test Loss: 0.1491835
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 41 cost time: 0.950533390045166
Epoch: 41, Steps: 64 | Train Loss: 0.0945382 Vali Loss: 0.1659971 Test Loss: 0.1488198
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 42 cost time: 0.9355132579803467
Epoch: 42, Steps: 64 | Train Loss: 0.0950986 Vali Loss: 0.1656435 Test Loss: 0.1484582
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 43 cost time: 0.962609052658081
Epoch: 43, Steps: 64 | Train Loss: 0.0943479 Vali Loss: 0.1671193 Test Loss: 0.1494611
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 44 cost time: 0.9621560573577881
Epoch: 44, Steps: 64 | Train Loss: 0.0947146 Vali Loss: 0.1673653 Test Loss: 0.1491668
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 45 cost time: 0.9573392868041992
Epoch: 45, Steps: 64 | Train Loss: 0.0947333 Vali Loss: 0.1674774 Test Loss: 0.1491514
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 46 cost time: 0.9787335395812988
Epoch: 46, Steps: 64 | Train Loss: 0.0945508 Vali Loss: 0.1661480 Test Loss: 0.1492047
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 47 cost time: 0.9333221912384033
Epoch: 47, Steps: 64 | Train Loss: 0.0942001 Vali Loss: 0.1663348 Test Loss: 0.1490021
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 48 cost time: 0.9683272838592529
Epoch: 48, Steps: 64 | Train Loss: 0.0943740 Vali Loss: 0.1670252 Test Loss: 0.1491089
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 49 cost time: 0.9806392192840576
Epoch: 49, Steps: 64 | Train Loss: 0.0945969 Vali Loss: 0.1654488 Test Loss: 0.1492097
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 50 cost time: 0.9704387187957764
Epoch: 50, Steps: 64 | Train Loss: 0.0945513 Vali Loss: 0.1681091 Test Loss: 0.1496340
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 51 cost time: 0.9793682098388672
Epoch: 51, Steps: 64 | Train Loss: 0.0947195 Vali Loss: 0.1679494 Test Loss: 0.1493482
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 52 cost time: 0.9993855953216553
Epoch: 52, Steps: 64 | Train Loss: 0.0943197 Vali Loss: 0.1668477 Test Loss: 0.1490674
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 53 cost time: 0.9917869567871094
Epoch: 53, Steps: 64 | Train Loss: 0.0944232 Vali Loss: 0.1678388 Test Loss: 0.1489401
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 54 cost time: 0.9795663356781006
Epoch: 54, Steps: 64 | Train Loss: 0.0941156 Vali Loss: 0.1668333 Test Loss: 0.1495035
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 55 cost time: 0.97879958152771
Epoch: 55, Steps: 64 | Train Loss: 0.0945590 Vali Loss: 0.1650663 Test Loss: 0.1486792
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 56 cost time: 0.9838771820068359
Epoch: 56, Steps: 64 | Train Loss: 0.0942515 Vali Loss: 0.1669283 Test Loss: 0.1492609
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 57 cost time: 0.9731869697570801
Epoch: 57, Steps: 64 | Train Loss: 0.0940376 Vali Loss: 0.1674421 Test Loss: 0.1499880
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 58 cost time: 0.9520001411437988
Epoch: 58, Steps: 64 | Train Loss: 0.0946248 Vali Loss: 0.1667452 Test Loss: 0.1496203
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 59 cost time: 0.938640832901001
Epoch: 59, Steps: 64 | Train Loss: 0.0945146 Vali Loss: 0.1674590 Test Loss: 0.1491924
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017595291137695312 GB
GPU已分配内存的峰值：0.03765583038330078 GB
Epoch: 60 cost time: 0.9843871593475342
Epoch: 60, Steps: 64 | Train Loss: 0.0941708 Vali Loss: 0.1648535 Test Loss: 0.1488224
Validation loss decreased (0.165018 --> 0.164854).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14882239699363708, mae:0.289994478225708, rse:0.20533128082752228
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.035868167877197266 GB
Epoch: 1 cost time: 2.2815651893615723
Epoch: 1, Steps: 64 | Train Loss: 1.1939166 Vali Loss: 2.4135065 Test Loss: 4.7631431
Validation loss decreased (inf --> 2.413507).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 2 cost time: 0.9100499153137207
Epoch: 2, Steps: 64 | Train Loss: 0.8357502 Vali Loss: 0.9617891 Test Loss: 1.6799972
Validation loss decreased (2.413507 --> 0.961789).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 3 cost time: 0.9124925136566162
Epoch: 3, Steps: 64 | Train Loss: 0.3994858 Vali Loss: 0.5552047 Test Loss: 0.8058376
Validation loss decreased (0.961789 --> 0.555205).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 4 cost time: 0.9262876510620117
Epoch: 4, Steps: 64 | Train Loss: 0.2819414 Vali Loss: 0.4288710 Test Loss: 0.5472190
Validation loss decreased (0.555205 --> 0.428871).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 5 cost time: 0.888045072555542
Epoch: 5, Steps: 64 | Train Loss: 0.2290468 Vali Loss: 0.3651716 Test Loss: 0.4231070
Validation loss decreased (0.428871 --> 0.365172).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 6 cost time: 0.8987777233123779
Epoch: 6, Steps: 64 | Train Loss: 0.2005491 Vali Loss: 0.3252817 Test Loss: 0.3458507
Validation loss decreased (0.365172 --> 0.325282).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 7 cost time: 0.9037466049194336
Epoch: 7, Steps: 64 | Train Loss: 0.1807381 Vali Loss: 0.2932878 Test Loss: 0.2910278
Validation loss decreased (0.325282 --> 0.293288).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 8 cost time: 0.9039981365203857
Epoch: 8, Steps: 64 | Train Loss: 0.1683738 Vali Loss: 0.2743089 Test Loss: 0.2590682
Validation loss decreased (0.293288 --> 0.274309).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 9 cost time: 0.9026293754577637
Epoch: 9, Steps: 64 | Train Loss: 0.1593669 Vali Loss: 0.2576550 Test Loss: 0.2332525
Validation loss decreased (0.274309 --> 0.257655).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 10 cost time: 0.9184548854827881
Epoch: 10, Steps: 64 | Train Loss: 0.1510927 Vali Loss: 0.2449186 Test Loss: 0.2143861
Validation loss decreased (0.257655 --> 0.244919).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 11 cost time: 0.9454278945922852
Epoch: 11, Steps: 64 | Train Loss: 0.1470013 Vali Loss: 0.2353266 Test Loss: 0.2010544
Validation loss decreased (0.244919 --> 0.235327).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 12 cost time: 0.9353756904602051
Epoch: 12, Steps: 64 | Train Loss: 0.1423416 Vali Loss: 0.2294945 Test Loss: 0.1942274
Validation loss decreased (0.235327 --> 0.229495).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 13 cost time: 0.938413143157959
Epoch: 13, Steps: 64 | Train Loss: 0.1407224 Vali Loss: 0.2205268 Test Loss: 0.1852035
Validation loss decreased (0.229495 --> 0.220527).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 14 cost time: 0.9147324562072754
Epoch: 14, Steps: 64 | Train Loss: 0.1369576 Vali Loss: 0.2167752 Test Loss: 0.1812308
Validation loss decreased (0.220527 --> 0.216775).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 15 cost time: 0.9257180690765381
Epoch: 15, Steps: 64 | Train Loss: 0.1357702 Vali Loss: 0.2143446 Test Loss: 0.1775012
Validation loss decreased (0.216775 --> 0.214345).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 16 cost time: 0.9156477451324463
Epoch: 16, Steps: 64 | Train Loss: 0.1332972 Vali Loss: 0.2120446 Test Loss: 0.1747396
Validation loss decreased (0.214345 --> 0.212045).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 17 cost time: 0.9156403541564941
Epoch: 17, Steps: 64 | Train Loss: 0.1311533 Vali Loss: 0.2095929 Test Loss: 0.1721537
Validation loss decreased (0.212045 --> 0.209593).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 18 cost time: 0.9424300193786621
Epoch: 18, Steps: 64 | Train Loss: 0.1298597 Vali Loss: 0.2055233 Test Loss: 0.1690917
Validation loss decreased (0.209593 --> 0.205523).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 19 cost time: 0.9333746433258057
Epoch: 19, Steps: 64 | Train Loss: 0.1289836 Vali Loss: 0.2030201 Test Loss: 0.1659159
Validation loss decreased (0.205523 --> 0.203020).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 20 cost time: 0.9380326271057129
Epoch: 20, Steps: 64 | Train Loss: 0.1283341 Vali Loss: 0.2013015 Test Loss: 0.1657616
Validation loss decreased (0.203020 --> 0.201301).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 21 cost time: 0.922602653503418
Epoch: 21, Steps: 64 | Train Loss: 0.1277673 Vali Loss: 0.1991788 Test Loss: 0.1649490
Validation loss decreased (0.201301 --> 0.199179).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 22 cost time: 0.931748628616333
Epoch: 22, Steps: 64 | Train Loss: 0.1268103 Vali Loss: 0.1970373 Test Loss: 0.1644356
Validation loss decreased (0.199179 --> 0.197037).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 23 cost time: 0.9340016841888428
Epoch: 23, Steps: 64 | Train Loss: 0.1257114 Vali Loss: 0.1981005 Test Loss: 0.1620442
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 24 cost time: 0.9149904251098633
Epoch: 24, Steps: 64 | Train Loss: 0.1253949 Vali Loss: 0.1970521 Test Loss: 0.1613120
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 25 cost time: 0.9142675399780273
Epoch: 25, Steps: 64 | Train Loss: 0.1246327 Vali Loss: 0.1955673 Test Loss: 0.1613120
Validation loss decreased (0.197037 --> 0.195567).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 26 cost time: 0.9033820629119873
Epoch: 26, Steps: 64 | Train Loss: 0.1244321 Vali Loss: 0.1958773 Test Loss: 0.1612988
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 27 cost time: 0.9258532524108887
Epoch: 27, Steps: 64 | Train Loss: 0.1235580 Vali Loss: 0.1928704 Test Loss: 0.1604974
Validation loss decreased (0.195567 --> 0.192870).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 28 cost time: 0.9213848114013672
Epoch: 28, Steps: 64 | Train Loss: 0.1230657 Vali Loss: 0.1935905 Test Loss: 0.1596706
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 29 cost time: 0.9197428226470947
Epoch: 29, Steps: 64 | Train Loss: 0.1227016 Vali Loss: 0.1920285 Test Loss: 0.1594958
Validation loss decreased (0.192870 --> 0.192028).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 30 cost time: 0.9166324138641357
Epoch: 30, Steps: 64 | Train Loss: 0.1228628 Vali Loss: 0.1937219 Test Loss: 0.1599430
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 31 cost time: 0.9176361560821533
Epoch: 31, Steps: 64 | Train Loss: 0.1226691 Vali Loss: 0.1906447 Test Loss: 0.1601022
Validation loss decreased (0.192028 --> 0.190645).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 32 cost time: 0.9162039756774902
Epoch: 32, Steps: 64 | Train Loss: 0.1227338 Vali Loss: 0.1911028 Test Loss: 0.1576839
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 33 cost time: 0.9234848022460938
Epoch: 33, Steps: 64 | Train Loss: 0.1222095 Vali Loss: 0.1899247 Test Loss: 0.1584313
Validation loss decreased (0.190645 --> 0.189925).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 34 cost time: 0.9164042472839355
Epoch: 34, Steps: 64 | Train Loss: 0.1219564 Vali Loss: 0.1920248 Test Loss: 0.1588033
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 35 cost time: 0.9300074577331543
Epoch: 35, Steps: 64 | Train Loss: 0.1221671 Vali Loss: 0.1898124 Test Loss: 0.1584490
Validation loss decreased (0.189925 --> 0.189812).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 36 cost time: 0.9387717247009277
Epoch: 36, Steps: 64 | Train Loss: 0.1214776 Vali Loss: 0.1899360 Test Loss: 0.1578419
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 37 cost time: 0.9498410224914551
Epoch: 37, Steps: 64 | Train Loss: 0.1217583 Vali Loss: 0.1905313 Test Loss: 0.1580600
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 38 cost time: 0.9406249523162842
Epoch: 38, Steps: 64 | Train Loss: 0.1213726 Vali Loss: 0.1903697 Test Loss: 0.1577027
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 39 cost time: 0.9466123580932617
Epoch: 39, Steps: 64 | Train Loss: 0.1208821 Vali Loss: 0.1896259 Test Loss: 0.1572878
Validation loss decreased (0.189812 --> 0.189626).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 40 cost time: 0.9183788299560547
Epoch: 40, Steps: 64 | Train Loss: 0.1211021 Vali Loss: 0.1876303 Test Loss: 0.1574802
Validation loss decreased (0.189626 --> 0.187630).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 41 cost time: 0.9064691066741943
Epoch: 41, Steps: 64 | Train Loss: 0.1203655 Vali Loss: 0.1904047 Test Loss: 0.1570018
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 42 cost time: 0.9193742275238037
Epoch: 42, Steps: 64 | Train Loss: 0.1208681 Vali Loss: 0.1901235 Test Loss: 0.1574319
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 43 cost time: 0.8773856163024902
Epoch: 43, Steps: 64 | Train Loss: 0.1207559 Vali Loss: 0.1872168 Test Loss: 0.1568276
Validation loss decreased (0.187630 --> 0.187217).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 44 cost time: 0.9079999923706055
Epoch: 44, Steps: 64 | Train Loss: 0.1210021 Vali Loss: 0.1885872 Test Loss: 0.1564564
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 45 cost time: 0.9069986343383789
Epoch: 45, Steps: 64 | Train Loss: 0.1201536 Vali Loss: 0.1890881 Test Loss: 0.1573037
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 46 cost time: 0.9166362285614014
Epoch: 46, Steps: 64 | Train Loss: 0.1202180 Vali Loss: 0.1904241 Test Loss: 0.1568156
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 47 cost time: 0.9194228649139404
Epoch: 47, Steps: 64 | Train Loss: 0.1200711 Vali Loss: 0.1887781 Test Loss: 0.1569655
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 48 cost time: 0.8994030952453613
Epoch: 48, Steps: 64 | Train Loss: 0.1202113 Vali Loss: 0.1870918 Test Loss: 0.1565509
Validation loss decreased (0.187217 --> 0.187092).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 49 cost time: 0.8884546756744385
Epoch: 49, Steps: 64 | Train Loss: 0.1203015 Vali Loss: 0.1877690 Test Loss: 0.1561913
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 50 cost time: 0.8867464065551758
Epoch: 50, Steps: 64 | Train Loss: 0.1201386 Vali Loss: 0.1874972 Test Loss: 0.1561437
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 51 cost time: 0.8917243480682373
Epoch: 51, Steps: 64 | Train Loss: 0.1202310 Vali Loss: 0.1892795 Test Loss: 0.1567608
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 52 cost time: 0.9256415367126465
Epoch: 52, Steps: 64 | Train Loss: 0.1200497 Vali Loss: 0.1870993 Test Loss: 0.1566077
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 53 cost time: 0.9374270439147949
Epoch: 53, Steps: 64 | Train Loss: 0.1194711 Vali Loss: 0.1862513 Test Loss: 0.1563616
Validation loss decreased (0.187092 --> 0.186251).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 54 cost time: 0.9343757629394531
Epoch: 54, Steps: 64 | Train Loss: 0.1197880 Vali Loss: 0.1905026 Test Loss: 0.1567479
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 55 cost time: 0.9324026107788086
Epoch: 55, Steps: 64 | Train Loss: 0.1199513 Vali Loss: 0.1880668 Test Loss: 0.1560372
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 56 cost time: 0.9531145095825195
Epoch: 56, Steps: 64 | Train Loss: 0.1198875 Vali Loss: 0.1881058 Test Loss: 0.1570010
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 57 cost time: 0.9269819259643555
Epoch: 57, Steps: 64 | Train Loss: 0.1196125 Vali Loss: 0.1863185 Test Loss: 0.1559500
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 58 cost time: 0.9170022010803223
Epoch: 58, Steps: 64 | Train Loss: 0.1204528 Vali Loss: 0.1898787 Test Loss: 0.1569840
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 59 cost time: 0.9206774234771729
Epoch: 59, Steps: 64 | Train Loss: 0.1198803 Vali Loss: 0.1865258 Test Loss: 0.1556391
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017538070678710938 GB
GPU已分配内存的峰值：0.03630828857421875 GB
Epoch: 60 cost time: 0.9224884510040283
Epoch: 60, Steps: 64 | Train Loss: 0.1197517 Vali Loss: 0.1877694 Test Loss: 0.1558840
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15636160969734192, mae:0.2973325550556183, rse:0.21046797931194305
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03656959533691406 GB
Epoch: 1 cost time: 2.3354737758636475
Epoch: 1, Steps: 64 | Train Loss: 0.7308953 Vali Loss: 1.6461476 Test Loss: 3.0968633
Validation loss decreased (inf --> 1.646148).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 2 cost time: 0.9722514152526855
Epoch: 2, Steps: 64 | Train Loss: 0.5437841 Vali Loss: 0.8317803 Test Loss: 1.3685410
Validation loss decreased (1.646148 --> 0.831780).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 3 cost time: 0.9713642597198486
Epoch: 3, Steps: 64 | Train Loss: 0.2822905 Vali Loss: 0.4167802 Test Loss: 0.5153171
Validation loss decreased (0.831780 --> 0.416780).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 4 cost time: 0.962693452835083
Epoch: 4, Steps: 64 | Train Loss: 0.1636804 Vali Loss: 0.2675129 Test Loss: 0.2402329
Validation loss decreased (0.416780 --> 0.267513).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 5 cost time: 0.9416444301605225
Epoch: 5, Steps: 64 | Train Loss: 0.1277940 Vali Loss: 0.2235913 Test Loss: 0.1814796
Validation loss decreased (0.267513 --> 0.223591).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 6 cost time: 0.9356169700622559
Epoch: 6, Steps: 64 | Train Loss: 0.1178873 Vali Loss: 0.2044074 Test Loss: 0.1639017
Validation loss decreased (0.223591 --> 0.204407).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 7 cost time: 0.9350194931030273
Epoch: 7, Steps: 64 | Train Loss: 0.1134171 Vali Loss: 0.1940241 Test Loss: 0.1587597
Validation loss decreased (0.204407 --> 0.194024).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 8 cost time: 0.932732343673706
Epoch: 8, Steps: 64 | Train Loss: 0.1107690 Vali Loss: 0.1928271 Test Loss: 0.1536408
Validation loss decreased (0.194024 --> 0.192827).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 9 cost time: 0.9449994564056396
Epoch: 9, Steps: 64 | Train Loss: 0.1089382 Vali Loss: 0.1874499 Test Loss: 0.1530783
Validation loss decreased (0.192827 --> 0.187450).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 10 cost time: 0.9799995422363281
Epoch: 10, Steps: 64 | Train Loss: 0.1071778 Vali Loss: 0.1843887 Test Loss: 0.1506514
Validation loss decreased (0.187450 --> 0.184389).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 11 cost time: 0.98264479637146
Epoch: 11, Steps: 64 | Train Loss: 0.1062101 Vali Loss: 0.1813675 Test Loss: 0.1497403
Validation loss decreased (0.184389 --> 0.181368).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 12 cost time: 0.9786272048950195
Epoch: 12, Steps: 64 | Train Loss: 0.1050611 Vali Loss: 0.1808567 Test Loss: 0.1498917
Validation loss decreased (0.181368 --> 0.180857).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 13 cost time: 0.978278636932373
Epoch: 13, Steps: 64 | Train Loss: 0.1041245 Vali Loss: 0.1775424 Test Loss: 0.1484573
Validation loss decreased (0.180857 --> 0.177542).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 14 cost time: 0.9773805141448975
Epoch: 14, Steps: 64 | Train Loss: 0.1035054 Vali Loss: 0.1759330 Test Loss: 0.1488594
Validation loss decreased (0.177542 --> 0.175933).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 15 cost time: 0.9613873958587646
Epoch: 15, Steps: 64 | Train Loss: 0.1027522 Vali Loss: 0.1761917 Test Loss: 0.1479236
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 16 cost time: 0.9682290554046631
Epoch: 16, Steps: 64 | Train Loss: 0.1024166 Vali Loss: 0.1769875 Test Loss: 0.1478029
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 17 cost time: 0.9620442390441895
Epoch: 17, Steps: 64 | Train Loss: 0.1017800 Vali Loss: 0.1752557 Test Loss: 0.1480390
Validation loss decreased (0.175933 --> 0.175256).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 18 cost time: 0.9797768592834473
Epoch: 18, Steps: 64 | Train Loss: 0.1008683 Vali Loss: 0.1742173 Test Loss: 0.1477107
Validation loss decreased (0.175256 --> 0.174217).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 19 cost time: 0.9817790985107422
Epoch: 19, Steps: 64 | Train Loss: 0.1006823 Vali Loss: 0.1749626 Test Loss: 0.1471027
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 20 cost time: 0.9390013217926025
Epoch: 20, Steps: 64 | Train Loss: 0.1001497 Vali Loss: 0.1739536 Test Loss: 0.1469373
Validation loss decreased (0.174217 --> 0.173954).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 21 cost time: 0.9492752552032471
Epoch: 21, Steps: 64 | Train Loss: 0.1001794 Vali Loss: 0.1717348 Test Loss: 0.1470582
Validation loss decreased (0.173954 --> 0.171735).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 22 cost time: 0.9346401691436768
Epoch: 22, Steps: 64 | Train Loss: 0.0998864 Vali Loss: 0.1730205 Test Loss: 0.1466922
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 23 cost time: 0.9363687038421631
Epoch: 23, Steps: 64 | Train Loss: 0.0998693 Vali Loss: 0.1702553 Test Loss: 0.1466724
Validation loss decreased (0.171735 --> 0.170255).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 24 cost time: 0.9294857978820801
Epoch: 24, Steps: 64 | Train Loss: 0.0995312 Vali Loss: 0.1713793 Test Loss: 0.1463520
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 25 cost time: 0.9279866218566895
Epoch: 25, Steps: 64 | Train Loss: 0.0991742 Vali Loss: 0.1727192 Test Loss: 0.1468804
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 26 cost time: 0.947070837020874
Epoch: 26, Steps: 64 | Train Loss: 0.0991622 Vali Loss: 0.1716819 Test Loss: 0.1462846
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 27 cost time: 0.9557561874389648
Epoch: 27, Steps: 64 | Train Loss: 0.0989263 Vali Loss: 0.1713087 Test Loss: 0.1463557
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 28 cost time: 0.9570002555847168
Epoch: 28, Steps: 64 | Train Loss: 0.0988417 Vali Loss: 0.1720949 Test Loss: 0.1461028
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 29 cost time: 0.9700560569763184
Epoch: 29, Steps: 64 | Train Loss: 0.0986145 Vali Loss: 0.1718114 Test Loss: 0.1466344
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 30 cost time: 0.9866483211517334
Epoch: 30, Steps: 64 | Train Loss: 0.0988620 Vali Loss: 0.1715450 Test Loss: 0.1461538
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 31 cost time: 0.9635345935821533
Epoch: 31, Steps: 64 | Train Loss: 0.0981051 Vali Loss: 0.1703666 Test Loss: 0.1464121
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 32 cost time: 0.9572908878326416
Epoch: 32, Steps: 64 | Train Loss: 0.0983826 Vali Loss: 0.1672763 Test Loss: 0.1452945
Validation loss decreased (0.170255 --> 0.167276).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 33 cost time: 0.9650046825408936
Epoch: 33, Steps: 64 | Train Loss: 0.0979172 Vali Loss: 0.1713973 Test Loss: 0.1467649
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 34 cost time: 0.9592745304107666
Epoch: 34, Steps: 64 | Train Loss: 0.0983395 Vali Loss: 0.1693641 Test Loss: 0.1457163
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 35 cost time: 0.9784755706787109
Epoch: 35, Steps: 64 | Train Loss: 0.0981505 Vali Loss: 0.1697682 Test Loss: 0.1462270
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 36 cost time: 0.9918577671051025
Epoch: 36, Steps: 64 | Train Loss: 0.0977369 Vali Loss: 0.1697781 Test Loss: 0.1461657
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 37 cost time: 0.9823970794677734
Epoch: 37, Steps: 64 | Train Loss: 0.0980517 Vali Loss: 0.1711782 Test Loss: 0.1462817
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 38 cost time: 0.9738190174102783
Epoch: 38, Steps: 64 | Train Loss: 0.0980093 Vali Loss: 0.1690127 Test Loss: 0.1461687
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 39 cost time: 0.9676172733306885
Epoch: 39, Steps: 64 | Train Loss: 0.0980897 Vali Loss: 0.1686532 Test Loss: 0.1456138
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 40 cost time: 0.9456205368041992
Epoch: 40, Steps: 64 | Train Loss: 0.0980189 Vali Loss: 0.1702121 Test Loss: 0.1464563
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 41 cost time: 0.9313607215881348
Epoch: 41, Steps: 64 | Train Loss: 0.0975519 Vali Loss: 0.1697259 Test Loss: 0.1465150
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 42 cost time: 0.9243466854095459
Epoch: 42, Steps: 64 | Train Loss: 0.0978732 Vali Loss: 0.1680893 Test Loss: 0.1463395
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 43 cost time: 0.9504539966583252
Epoch: 43, Steps: 64 | Train Loss: 0.0977575 Vali Loss: 0.1701439 Test Loss: 0.1460996
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 44 cost time: 0.9583649635314941
Epoch: 44, Steps: 64 | Train Loss: 0.0976367 Vali Loss: 0.1690466 Test Loss: 0.1462379
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 45 cost time: 0.9497716426849365
Epoch: 45, Steps: 64 | Train Loss: 0.0978779 Vali Loss: 0.1695490 Test Loss: 0.1457022
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 46 cost time: 0.9509997367858887
Epoch: 46, Steps: 64 | Train Loss: 0.0974972 Vali Loss: 0.1698132 Test Loss: 0.1459475
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 47 cost time: 0.9546377658843994
Epoch: 47, Steps: 64 | Train Loss: 0.0976288 Vali Loss: 0.1696335 Test Loss: 0.1452832
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 48 cost time: 0.9456355571746826
Epoch: 48, Steps: 64 | Train Loss: 0.0973759 Vali Loss: 0.1700370 Test Loss: 0.1457855
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 49 cost time: 0.9674098491668701
Epoch: 49, Steps: 64 | Train Loss: 0.0981361 Vali Loss: 0.1709124 Test Loss: 0.1462276
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 50 cost time: 0.9736294746398926
Epoch: 50, Steps: 64 | Train Loss: 0.0976084 Vali Loss: 0.1697463 Test Loss: 0.1462563
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 51 cost time: 0.963066577911377
Epoch: 51, Steps: 64 | Train Loss: 0.0975922 Vali Loss: 0.1720707 Test Loss: 0.1458733
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 52 cost time: 0.9807443618774414
Epoch: 52, Steps: 64 | Train Loss: 0.0972366 Vali Loss: 0.1692727 Test Loss: 0.1461693
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 53 cost time: 0.9945254325866699
Epoch: 53, Steps: 64 | Train Loss: 0.0982239 Vali Loss: 0.1691831 Test Loss: 0.1454991
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 54 cost time: 0.9797248840332031
Epoch: 54, Steps: 64 | Train Loss: 0.0976561 Vali Loss: 0.1691142 Test Loss: 0.1459981
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 55 cost time: 0.984321117401123
Epoch: 55, Steps: 64 | Train Loss: 0.0973558 Vali Loss: 0.1693312 Test Loss: 0.1458673
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 56 cost time: 0.974999189376831
Epoch: 56, Steps: 64 | Train Loss: 0.0972788 Vali Loss: 0.1699362 Test Loss: 0.1460883
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 57 cost time: 0.9516408443450928
Epoch: 57, Steps: 64 | Train Loss: 0.0975569 Vali Loss: 0.1676100 Test Loss: 0.1456985
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 58 cost time: 0.9276444911956787
Epoch: 58, Steps: 64 | Train Loss: 0.0975413 Vali Loss: 0.1707395 Test Loss: 0.1461379
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 59 cost time: 0.9253871440887451
Epoch: 59, Steps: 64 | Train Loss: 0.0970235 Vali Loss: 0.1689388 Test Loss: 0.1457427
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017576217651367188 GB
GPU已分配内存的峰值：0.03706932067871094 GB
Epoch: 60 cost time: 0.9422783851623535
Epoch: 60, Steps: 64 | Train Loss: 0.0972102 Vali Loss: 0.1691708 Test Loss: 0.1458088
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1452944427728653, mae:0.27948227524757385, rse:0.20288291573524475
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03713369369506836 GB
Epoch: 1 cost time: 2.364459991455078
Epoch: 1, Steps: 64 | Train Loss: 0.8330181 Vali Loss: 1.9628848 Test Loss: 3.7509108
Validation loss decreased (inf --> 1.962885).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 2 cost time: 0.9703032970428467
Epoch: 2, Steps: 64 | Train Loss: 0.7334014 Vali Loss: 1.5171075 Test Loss: 2.8096752
Validation loss decreased (1.962885 --> 1.517107).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 3 cost time: 0.9873816967010498
Epoch: 3, Steps: 64 | Train Loss: 0.5469580 Vali Loss: 1.0269080 Test Loss: 1.7648875
Validation loss decreased (1.517107 --> 1.026908).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 4 cost time: 0.9904160499572754
Epoch: 4, Steps: 64 | Train Loss: 0.3341665 Vali Loss: 0.5389328 Test Loss: 0.7651777
Validation loss decreased (1.026908 --> 0.538933).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 5 cost time: 0.9863855838775635
Epoch: 5, Steps: 64 | Train Loss: 0.1798158 Vali Loss: 0.2961541 Test Loss: 0.2985934
Validation loss decreased (0.538933 --> 0.296154).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 6 cost time: 0.9834733009338379
Epoch: 6, Steps: 64 | Train Loss: 0.1277309 Vali Loss: 0.2261253 Test Loss: 0.1906998
Validation loss decreased (0.296154 --> 0.226125).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 7 cost time: 0.9427452087402344
Epoch: 7, Steps: 64 | Train Loss: 0.1167871 Vali Loss: 0.2075540 Test Loss: 0.1727026
Validation loss decreased (0.226125 --> 0.207554).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 8 cost time: 0.9427261352539062
Epoch: 8, Steps: 64 | Train Loss: 0.1123270 Vali Loss: 0.1968383 Test Loss: 0.1636592
Validation loss decreased (0.207554 --> 0.196838).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 9 cost time: 0.9669992923736572
Epoch: 9, Steps: 64 | Train Loss: 0.1090243 Vali Loss: 0.1941497 Test Loss: 0.1644755
Validation loss decreased (0.196838 --> 0.194150).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 10 cost time: 0.9826498031616211
Epoch: 10, Steps: 64 | Train Loss: 0.1073142 Vali Loss: 0.1890036 Test Loss: 0.1609905
Validation loss decreased (0.194150 --> 0.189004).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 11 cost time: 0.9886128902435303
Epoch: 11, Steps: 64 | Train Loss: 0.1059972 Vali Loss: 0.1855929 Test Loss: 0.1581335
Validation loss decreased (0.189004 --> 0.185593).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 12 cost time: 0.9962863922119141
Epoch: 12, Steps: 64 | Train Loss: 0.1044780 Vali Loss: 0.1818606 Test Loss: 0.1577417
Validation loss decreased (0.185593 --> 0.181861).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 13 cost time: 0.9774575233459473
Epoch: 13, Steps: 64 | Train Loss: 0.1031884 Vali Loss: 0.1812477 Test Loss: 0.1558316
Validation loss decreased (0.181861 --> 0.181248).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 14 cost time: 0.9743640422821045
Epoch: 14, Steps: 64 | Train Loss: 0.1023204 Vali Loss: 0.1801864 Test Loss: 0.1554708
Validation loss decreased (0.181248 --> 0.180186).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 15 cost time: 0.974412202835083
Epoch: 15, Steps: 64 | Train Loss: 0.1015376 Vali Loss: 0.1759593 Test Loss: 0.1548650
Validation loss decreased (0.180186 --> 0.175959).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 16 cost time: 0.9839990139007568
Epoch: 16, Steps: 64 | Train Loss: 0.1010607 Vali Loss: 0.1776831 Test Loss: 0.1550668
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 17 cost time: 0.9805140495300293
Epoch: 17, Steps: 64 | Train Loss: 0.0999529 Vali Loss: 0.1764976 Test Loss: 0.1543930
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 18 cost time: 0.9887773990631104
Epoch: 18, Steps: 64 | Train Loss: 0.0999975 Vali Loss: 0.1758256 Test Loss: 0.1533005
Validation loss decreased (0.175959 --> 0.175826).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 19 cost time: 1.0058228969573975
Epoch: 19, Steps: 64 | Train Loss: 0.0991615 Vali Loss: 0.1754624 Test Loss: 0.1531607
Validation loss decreased (0.175826 --> 0.175462).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 20 cost time: 0.9704384803771973
Epoch: 20, Steps: 64 | Train Loss: 0.0987764 Vali Loss: 0.1754360 Test Loss: 0.1541094
Validation loss decreased (0.175462 --> 0.175436).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 21 cost time: 0.9708859920501709
Epoch: 21, Steps: 64 | Train Loss: 0.0991824 Vali Loss: 0.1745650 Test Loss: 0.1533942
Validation loss decreased (0.175436 --> 0.174565).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 22 cost time: 0.9549221992492676
Epoch: 22, Steps: 64 | Train Loss: 0.0982301 Vali Loss: 0.1735404 Test Loss: 0.1539031
Validation loss decreased (0.174565 --> 0.173540).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 23 cost time: 0.9576473236083984
Epoch: 23, Steps: 64 | Train Loss: 0.0979993 Vali Loss: 0.1753691 Test Loss: 0.1538225
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 24 cost time: 0.9507739543914795
Epoch: 24, Steps: 64 | Train Loss: 0.0979539 Vali Loss: 0.1739729 Test Loss: 0.1537210
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 25 cost time: 0.9455626010894775
Epoch: 25, Steps: 64 | Train Loss: 0.0975967 Vali Loss: 0.1716584 Test Loss: 0.1539353
Validation loss decreased (0.173540 --> 0.171658).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 26 cost time: 0.98038649559021
Epoch: 26, Steps: 64 | Train Loss: 0.0970558 Vali Loss: 0.1724662 Test Loss: 0.1534918
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 27 cost time: 0.9774284362792969
Epoch: 27, Steps: 64 | Train Loss: 0.0970136 Vali Loss: 0.1720378 Test Loss: 0.1538158
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 28 cost time: 0.9785034656524658
Epoch: 28, Steps: 64 | Train Loss: 0.0970409 Vali Loss: 0.1735955 Test Loss: 0.1538981
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 29 cost time: 0.9929385185241699
Epoch: 29, Steps: 64 | Train Loss: 0.0967325 Vali Loss: 0.1727845 Test Loss: 0.1539505
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 30 cost time: 0.9968326091766357
Epoch: 30, Steps: 64 | Train Loss: 0.0968216 Vali Loss: 0.1699939 Test Loss: 0.1535157
Validation loss decreased (0.171658 --> 0.169994).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 31 cost time: 0.9860000610351562
Epoch: 31, Steps: 64 | Train Loss: 0.0968943 Vali Loss: 0.1720494 Test Loss: 0.1534564
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 32 cost time: 0.9889543056488037
Epoch: 32, Steps: 64 | Train Loss: 0.0968013 Vali Loss: 0.1715257 Test Loss: 0.1533959
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 33 cost time: 0.97662353515625
Epoch: 33, Steps: 64 | Train Loss: 0.0965949 Vali Loss: 0.1675353 Test Loss: 0.1540634
Validation loss decreased (0.169994 --> 0.167535).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 34 cost time: 0.9875609874725342
Epoch: 34, Steps: 64 | Train Loss: 0.0961470 Vali Loss: 0.1706080 Test Loss: 0.1541209
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 35 cost time: 1.0005271434783936
Epoch: 35, Steps: 64 | Train Loss: 0.0962260 Vali Loss: 0.1722448 Test Loss: 0.1534089
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 36 cost time: 1.0000829696655273
Epoch: 36, Steps: 64 | Train Loss: 0.0962222 Vali Loss: 0.1728365 Test Loss: 0.1532375
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 37 cost time: 0.9944295883178711
Epoch: 37, Steps: 64 | Train Loss: 0.0962185 Vali Loss: 0.1718568 Test Loss: 0.1539915
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 38 cost time: 0.9704494476318359
Epoch: 38, Steps: 64 | Train Loss: 0.0961308 Vali Loss: 0.1725057 Test Loss: 0.1544577
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 39 cost time: 0.9504611492156982
Epoch: 39, Steps: 64 | Train Loss: 0.0961354 Vali Loss: 0.1680433 Test Loss: 0.1535792
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 40 cost time: 0.9487330913543701
Epoch: 40, Steps: 64 | Train Loss: 0.0957119 Vali Loss: 0.1716409 Test Loss: 0.1536256
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 41 cost time: 0.9416353702545166
Epoch: 41, Steps: 64 | Train Loss: 0.0958980 Vali Loss: 0.1703680 Test Loss: 0.1537502
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 42 cost time: 0.9469993114471436
Epoch: 42, Steps: 64 | Train Loss: 0.0963456 Vali Loss: 0.1697356 Test Loss: 0.1530470
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 43 cost time: 0.9656388759613037
Epoch: 43, Steps: 64 | Train Loss: 0.0955630 Vali Loss: 0.1710172 Test Loss: 0.1538364
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 44 cost time: 0.9623782634735107
Epoch: 44, Steps: 64 | Train Loss: 0.0961284 Vali Loss: 0.1712151 Test Loss: 0.1536916
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 45 cost time: 0.9837629795074463
Epoch: 45, Steps: 64 | Train Loss: 0.0955901 Vali Loss: 0.1717360 Test Loss: 0.1536019
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 46 cost time: 0.9890642166137695
Epoch: 46, Steps: 64 | Train Loss: 0.0956579 Vali Loss: 0.1724235 Test Loss: 0.1545109
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 47 cost time: 0.9473884105682373
Epoch: 47, Steps: 64 | Train Loss: 0.0955484 Vali Loss: 0.1697341 Test Loss: 0.1529880
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 48 cost time: 0.973848819732666
Epoch: 48, Steps: 64 | Train Loss: 0.0960332 Vali Loss: 0.1699817 Test Loss: 0.1540616
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 49 cost time: 0.983783483505249
Epoch: 49, Steps: 64 | Train Loss: 0.0958711 Vali Loss: 0.1710105 Test Loss: 0.1537332
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 50 cost time: 0.9747209548950195
Epoch: 50, Steps: 64 | Train Loss: 0.0958747 Vali Loss: 0.1711737 Test Loss: 0.1542282
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 51 cost time: 0.9947388172149658
Epoch: 51, Steps: 64 | Train Loss: 0.0955449 Vali Loss: 0.1703091 Test Loss: 0.1541650
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 52 cost time: 0.9979977607727051
Epoch: 52, Steps: 64 | Train Loss: 0.0958658 Vali Loss: 0.1714131 Test Loss: 0.1536832
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 53 cost time: 0.9970047473907471
Epoch: 53, Steps: 64 | Train Loss: 0.0952982 Vali Loss: 0.1717739 Test Loss: 0.1538985
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 54 cost time: 1.0015041828155518
Epoch: 54, Steps: 64 | Train Loss: 0.0958049 Vali Loss: 0.1718173 Test Loss: 0.1532770
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 55 cost time: 0.9764003753662109
Epoch: 55, Steps: 64 | Train Loss: 0.0958352 Vali Loss: 0.1729503 Test Loss: 0.1541096
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 56 cost time: 0.9837977886199951
Epoch: 56, Steps: 64 | Train Loss: 0.0957934 Vali Loss: 0.1711900 Test Loss: 0.1544446
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 57 cost time: 0.9844324588775635
Epoch: 57, Steps: 64 | Train Loss: 0.0957287 Vali Loss: 0.1718730 Test Loss: 0.1539292
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 58 cost time: 0.9884355068206787
Epoch: 58, Steps: 64 | Train Loss: 0.0954893 Vali Loss: 0.1713858 Test Loss: 0.1537419
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 59 cost time: 0.9879825115203857
Epoch: 59, Steps: 64 | Train Loss: 0.0955620 Vali Loss: 0.1690773 Test Loss: 0.1537998
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017599105834960938 GB
GPU已分配内存的峰值：0.03781890869140625 GB
Epoch: 60 cost time: 0.9724307060241699
Epoch: 60, Steps: 64 | Train Loss: 0.0953714 Vali Loss: 0.1706036 Test Loss: 0.1537159
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15406344830989838, mae:0.2985703647136688, rse:0.20891554653644562
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03602886199951172 GB
Epoch: 1 cost time: 2.2994632720947266
Epoch: 1, Steps: 64 | Train Loss: 1.0076932 Vali Loss: 2.1462450 Test Loss: 3.8932579
Validation loss decreased (inf --> 2.146245).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 2 cost time: 0.9562582969665527
Epoch: 2, Steps: 64 | Train Loss: 0.8040842 Vali Loss: 1.2071321 Test Loss: 2.0213702
Validation loss decreased (2.146245 --> 1.207132).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 3 cost time: 0.9219975471496582
Epoch: 3, Steps: 64 | Train Loss: 0.4804815 Vali Loss: 0.7852432 Test Loss: 1.1654955
Validation loss decreased (1.207132 --> 0.785243).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 4 cost time: 0.9303712844848633
Epoch: 4, Steps: 64 | Train Loss: 0.3434069 Vali Loss: 0.5946480 Test Loss: 0.7879345
Validation loss decreased (0.785243 --> 0.594648).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 5 cost time: 0.9001784324645996
Epoch: 5, Steps: 64 | Train Loss: 0.2688648 Vali Loss: 0.4777100 Test Loss: 0.5654272
Validation loss decreased (0.594648 --> 0.477710).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 6 cost time: 0.8986420631408691
Epoch: 6, Steps: 64 | Train Loss: 0.2230067 Vali Loss: 0.3993677 Test Loss: 0.4258102
Validation loss decreased (0.477710 --> 0.399368).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 7 cost time: 0.8996987342834473
Epoch: 7, Steps: 64 | Train Loss: 0.1950617 Vali Loss: 0.3507723 Test Loss: 0.3495886
Validation loss decreased (0.399368 --> 0.350772).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 8 cost time: 0.9108967781066895
Epoch: 8, Steps: 64 | Train Loss: 0.1789653 Vali Loss: 0.3109064 Test Loss: 0.2980407
Validation loss decreased (0.350772 --> 0.310906).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 9 cost time: 0.9227936267852783
Epoch: 9, Steps: 64 | Train Loss: 0.1658858 Vali Loss: 0.2922649 Test Loss: 0.2688119
Validation loss decreased (0.310906 --> 0.292265).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 10 cost time: 0.930072546005249
Epoch: 10, Steps: 64 | Train Loss: 0.1573507 Vali Loss: 0.2714432 Test Loss: 0.2416040
Validation loss decreased (0.292265 --> 0.271443).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 11 cost time: 0.9507997035980225
Epoch: 11, Steps: 64 | Train Loss: 0.1511050 Vali Loss: 0.2545834 Test Loss: 0.2223714
Validation loss decreased (0.271443 --> 0.254583).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 12 cost time: 0.9498991966247559
Epoch: 12, Steps: 64 | Train Loss: 0.1464329 Vali Loss: 0.2472038 Test Loss: 0.2104578
Validation loss decreased (0.254583 --> 0.247204).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 13 cost time: 0.9480001926422119
Epoch: 13, Steps: 64 | Train Loss: 0.1422273 Vali Loss: 0.2336114 Test Loss: 0.2010208
Validation loss decreased (0.247204 --> 0.233611).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 14 cost time: 0.9296104907989502
Epoch: 14, Steps: 64 | Train Loss: 0.1385363 Vali Loss: 0.2294113 Test Loss: 0.1940151
Validation loss decreased (0.233611 --> 0.229411).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 15 cost time: 0.9303922653198242
Epoch: 15, Steps: 64 | Train Loss: 0.1362385 Vali Loss: 0.2226967 Test Loss: 0.1846397
Validation loss decreased (0.229411 --> 0.222697).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 16 cost time: 0.9332256317138672
Epoch: 16, Steps: 64 | Train Loss: 0.1343241 Vali Loss: 0.2179785 Test Loss: 0.1816256
Validation loss decreased (0.222697 --> 0.217978).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 17 cost time: 0.9313759803771973
Epoch: 17, Steps: 64 | Train Loss: 0.1327646 Vali Loss: 0.2158517 Test Loss: 0.1776555
Validation loss decreased (0.217978 --> 0.215852).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 18 cost time: 0.9541666507720947
Epoch: 18, Steps: 64 | Train Loss: 0.1306588 Vali Loss: 0.2089737 Test Loss: 0.1745602
Validation loss decreased (0.215852 --> 0.208974).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 19 cost time: 0.9726207256317139
Epoch: 19, Steps: 64 | Train Loss: 0.1295204 Vali Loss: 0.2029031 Test Loss: 0.1703243
Validation loss decreased (0.208974 --> 0.202903).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 20 cost time: 0.9560844898223877
Epoch: 20, Steps: 64 | Train Loss: 0.1279413 Vali Loss: 0.2054514 Test Loss: 0.1683367
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 21 cost time: 0.9250013828277588
Epoch: 21, Steps: 64 | Train Loss: 0.1278129 Vali Loss: 0.2013774 Test Loss: 0.1681132
Validation loss decreased (0.202903 --> 0.201377).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 22 cost time: 0.9110012054443359
Epoch: 22, Steps: 64 | Train Loss: 0.1265286 Vali Loss: 0.2009615 Test Loss: 0.1647669
Validation loss decreased (0.201377 --> 0.200962).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 23 cost time: 0.9026336669921875
Epoch: 23, Steps: 64 | Train Loss: 0.1250753 Vali Loss: 0.1995817 Test Loss: 0.1637282
Validation loss decreased (0.200962 --> 0.199582).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 24 cost time: 0.9019150733947754
Epoch: 24, Steps: 64 | Train Loss: 0.1251252 Vali Loss: 0.1982484 Test Loss: 0.1620748
Validation loss decreased (0.199582 --> 0.198248).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 25 cost time: 0.8987329006195068
Epoch: 25, Steps: 64 | Train Loss: 0.1245742 Vali Loss: 0.1978889 Test Loss: 0.1626629
Validation loss decreased (0.198248 --> 0.197889).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 26 cost time: 0.9224693775177002
Epoch: 26, Steps: 64 | Train Loss: 0.1239512 Vali Loss: 0.1957678 Test Loss: 0.1608382
Validation loss decreased (0.197889 --> 0.195768).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 27 cost time: 0.927457332611084
Epoch: 27, Steps: 64 | Train Loss: 0.1228362 Vali Loss: 0.1982515 Test Loss: 0.1610329
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 28 cost time: 0.9196922779083252
Epoch: 28, Steps: 64 | Train Loss: 0.1231356 Vali Loss: 0.1960839 Test Loss: 0.1597581
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 29 cost time: 0.9249992370605469
Epoch: 29, Steps: 64 | Train Loss: 0.1222069 Vali Loss: 0.1942656 Test Loss: 0.1587546
Validation loss decreased (0.195768 --> 0.194266).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 30 cost time: 0.9156367778778076
Epoch: 30, Steps: 64 | Train Loss: 0.1225026 Vali Loss: 0.1935560 Test Loss: 0.1584944
Validation loss decreased (0.194266 --> 0.193556).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 31 cost time: 0.9263889789581299
Epoch: 31, Steps: 64 | Train Loss: 0.1215398 Vali Loss: 0.1941398 Test Loss: 0.1582001
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 32 cost time: 0.9243552684783936
Epoch: 32, Steps: 64 | Train Loss: 0.1216466 Vali Loss: 0.1906632 Test Loss: 0.1566450
Validation loss decreased (0.193556 --> 0.190663).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 33 cost time: 0.9355981349945068
Epoch: 33, Steps: 64 | Train Loss: 0.1212907 Vali Loss: 0.1926133 Test Loss: 0.1564830
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 34 cost time: 0.9263677597045898
Epoch: 34, Steps: 64 | Train Loss: 0.1209190 Vali Loss: 0.1916154 Test Loss: 0.1566181
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 35 cost time: 0.9499547481536865
Epoch: 35, Steps: 64 | Train Loss: 0.1208012 Vali Loss: 0.1916923 Test Loss: 0.1571224
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 36 cost time: 0.9830429553985596
Epoch: 36, Steps: 64 | Train Loss: 0.1209135 Vali Loss: 0.1897882 Test Loss: 0.1569738
Validation loss decreased (0.190663 --> 0.189788).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 37 cost time: 0.9748592376708984
Epoch: 37, Steps: 64 | Train Loss: 0.1199883 Vali Loss: 0.1887683 Test Loss: 0.1562115
Validation loss decreased (0.189788 --> 0.188768).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 38 cost time: 0.9689521789550781
Epoch: 38, Steps: 64 | Train Loss: 0.1200151 Vali Loss: 0.1900177 Test Loss: 0.1563392
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 39 cost time: 0.9346098899841309
Epoch: 39, Steps: 64 | Train Loss: 0.1203782 Vali Loss: 0.1894846 Test Loss: 0.1558120
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 40 cost time: 0.9353621006011963
Epoch: 40, Steps: 64 | Train Loss: 0.1200002 Vali Loss: 0.1900581 Test Loss: 0.1557044
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 41 cost time: 0.9114835262298584
Epoch: 41, Steps: 64 | Train Loss: 0.1201561 Vali Loss: 0.1888367 Test Loss: 0.1570013
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 42 cost time: 0.9070656299591064
Epoch: 42, Steps: 64 | Train Loss: 0.1202657 Vali Loss: 0.1878373 Test Loss: 0.1548471
Validation loss decreased (0.188768 --> 0.187837).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 43 cost time: 0.916801929473877
Epoch: 43, Steps: 64 | Train Loss: 0.1189807 Vali Loss: 0.1888155 Test Loss: 0.1558087
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 44 cost time: 0.9313514232635498
Epoch: 44, Steps: 64 | Train Loss: 0.1187864 Vali Loss: 0.1890331 Test Loss: 0.1558974
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 45 cost time: 0.9263582229614258
Epoch: 45, Steps: 64 | Train Loss: 0.1197931 Vali Loss: 0.1895026 Test Loss: 0.1560376
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 46 cost time: 0.9281027317047119
Epoch: 46, Steps: 64 | Train Loss: 0.1191197 Vali Loss: 0.1894731 Test Loss: 0.1551022
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 47 cost time: 0.9343948364257812
Epoch: 47, Steps: 64 | Train Loss: 0.1195457 Vali Loss: 0.1891714 Test Loss: 0.1545879
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 48 cost time: 0.9084432125091553
Epoch: 48, Steps: 64 | Train Loss: 0.1195533 Vali Loss: 0.1870270 Test Loss: 0.1550211
Validation loss decreased (0.187837 --> 0.187027).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 49 cost time: 0.9133050441741943
Epoch: 49, Steps: 64 | Train Loss: 0.1195785 Vali Loss: 0.1860883 Test Loss: 0.1547348
Validation loss decreased (0.187027 --> 0.186088).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 50 cost time: 0.9223527908325195
Epoch: 50, Steps: 64 | Train Loss: 0.1190944 Vali Loss: 0.1898308 Test Loss: 0.1553102
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 51 cost time: 0.9238462448120117
Epoch: 51, Steps: 64 | Train Loss: 0.1187701 Vali Loss: 0.1887133 Test Loss: 0.1543530
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 52 cost time: 0.946998119354248
Epoch: 52, Steps: 64 | Train Loss: 0.1193557 Vali Loss: 0.1870063 Test Loss: 0.1549303
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 53 cost time: 0.9476134777069092
Epoch: 53, Steps: 64 | Train Loss: 0.1188778 Vali Loss: 0.1869569 Test Loss: 0.1549595
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 54 cost time: 0.9476132392883301
Epoch: 54, Steps: 64 | Train Loss: 0.1195384 Vali Loss: 0.1873613 Test Loss: 0.1547959
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 55 cost time: 0.957399845123291
Epoch: 55, Steps: 64 | Train Loss: 0.1192501 Vali Loss: 0.1864387 Test Loss: 0.1546724
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 56 cost time: 0.9491434097290039
Epoch: 56, Steps: 64 | Train Loss: 0.1182992 Vali Loss: 0.1840060 Test Loss: 0.1546427
Validation loss decreased (0.186088 --> 0.184006).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 57 cost time: 0.961925745010376
Epoch: 57, Steps: 64 | Train Loss: 0.1188249 Vali Loss: 0.1872569 Test Loss: 0.1543419
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 58 cost time: 0.9280109405517578
Epoch: 58, Steps: 64 | Train Loss: 0.1191242 Vali Loss: 0.1889520 Test Loss: 0.1539960
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 59 cost time: 0.9317162036895752
Epoch: 59, Steps: 64 | Train Loss: 0.1187835 Vali Loss: 0.1874545 Test Loss: 0.1538638
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01753997802734375 GB
GPU已分配内存的峰值：0.03646993637084961 GB
Epoch: 60 cost time: 0.9296386241912842
Epoch: 60, Steps: 64 | Train Loss: 0.1190497 Vali Loss: 0.1871355 Test Loss: 0.1541739
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15464268624782562, mae:0.29571452736854553, rse:0.20930790901184082
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.036730289459228516 GB
Epoch: 1 cost time: 2.34786319732666
Epoch: 1, Steps: 64 | Train Loss: 0.8053097 Vali Loss: 1.7646223 Test Loss: 3.3668413
Validation loss decreased (inf --> 1.764622).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 2 cost time: 0.9648017883300781
Epoch: 2, Steps: 64 | Train Loss: 0.5883366 Vali Loss: 0.8847463 Test Loss: 1.4980760
Validation loss decreased (1.764622 --> 0.884746).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 3 cost time: 0.9569981098175049
Epoch: 3, Steps: 64 | Train Loss: 0.3251137 Vali Loss: 0.4934602 Test Loss: 0.6876491
Validation loss decreased (0.884746 --> 0.493460).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 4 cost time: 0.949394702911377
Epoch: 4, Steps: 64 | Train Loss: 0.2016521 Vali Loss: 0.3245879 Test Loss: 0.3502155
Validation loss decreased (0.493460 --> 0.324588).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 5 cost time: 0.9416630268096924
Epoch: 5, Steps: 64 | Train Loss: 0.1507716 Vali Loss: 0.2490673 Test Loss: 0.2359753
Validation loss decreased (0.324588 --> 0.249067).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 6 cost time: 0.9283692836761475
Epoch: 6, Steps: 64 | Train Loss: 0.1328056 Vali Loss: 0.2181878 Test Loss: 0.1901857
Validation loss decreased (0.249067 --> 0.218188).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 7 cost time: 0.9363315105438232
Epoch: 7, Steps: 64 | Train Loss: 0.1230257 Vali Loss: 0.1939623 Test Loss: 0.1712688
Validation loss decreased (0.218188 --> 0.193962).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 8 cost time: 0.9377114772796631
Epoch: 8, Steps: 64 | Train Loss: 0.1184598 Vali Loss: 0.1867384 Test Loss: 0.1625561
Validation loss decreased (0.193962 --> 0.186738).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 9 cost time: 0.951789140701294
Epoch: 9, Steps: 64 | Train Loss: 0.1151784 Vali Loss: 0.1843134 Test Loss: 0.1576449
Validation loss decreased (0.186738 --> 0.184313).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 10 cost time: 0.9753737449645996
Epoch: 10, Steps: 64 | Train Loss: 0.1125488 Vali Loss: 0.1788206 Test Loss: 0.1529243
Validation loss decreased (0.184313 --> 0.178821).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 11 cost time: 0.9727487564086914
Epoch: 11, Steps: 64 | Train Loss: 0.1105256 Vali Loss: 0.1758372 Test Loss: 0.1501613
Validation loss decreased (0.178821 --> 0.175837).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 12 cost time: 0.9790911674499512
Epoch: 12, Steps: 64 | Train Loss: 0.1077702 Vali Loss: 0.1770438 Test Loss: 0.1488911
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 13 cost time: 0.9857046604156494
Epoch: 13, Steps: 64 | Train Loss: 0.1070905 Vali Loss: 0.1703412 Test Loss: 0.1465942
Validation loss decreased (0.175837 --> 0.170341).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 14 cost time: 0.956000566482544
Epoch: 14, Steps: 64 | Train Loss: 0.1061139 Vali Loss: 0.1701258 Test Loss: 0.1453197
Validation loss decreased (0.170341 --> 0.170126).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 15 cost time: 0.9586331844329834
Epoch: 15, Steps: 64 | Train Loss: 0.1048822 Vali Loss: 0.1692951 Test Loss: 0.1451571
Validation loss decreased (0.170126 --> 0.169295).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 16 cost time: 0.9533843994140625
Epoch: 16, Steps: 64 | Train Loss: 0.1038732 Vali Loss: 0.1673177 Test Loss: 0.1439929
Validation loss decreased (0.169295 --> 0.167318).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 17 cost time: 0.9673945903778076
Epoch: 17, Steps: 64 | Train Loss: 0.1034505 Vali Loss: 0.1685022 Test Loss: 0.1431819
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 18 cost time: 0.9813508987426758
Epoch: 18, Steps: 64 | Train Loss: 0.1028108 Vali Loss: 0.1660718 Test Loss: 0.1427832
Validation loss decreased (0.167318 --> 0.166072).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 19 cost time: 0.9834473133087158
Epoch: 19, Steps: 64 | Train Loss: 0.1016714 Vali Loss: 0.1665854 Test Loss: 0.1419873
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 20 cost time: 1.026576042175293
Epoch: 20, Steps: 64 | Train Loss: 0.1017805 Vali Loss: 0.1645449 Test Loss: 0.1423629
Validation loss decreased (0.166072 --> 0.164545).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 21 cost time: 0.9547526836395264
Epoch: 21, Steps: 64 | Train Loss: 0.1009643 Vali Loss: 0.1646961 Test Loss: 0.1416330
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 22 cost time: 0.9462063312530518
Epoch: 22, Steps: 64 | Train Loss: 0.1006589 Vali Loss: 0.1627579 Test Loss: 0.1416019
Validation loss decreased (0.164545 --> 0.162758).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 23 cost time: 0.9543602466583252
Epoch: 23, Steps: 64 | Train Loss: 0.1002796 Vali Loss: 0.1643618 Test Loss: 0.1416371
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 24 cost time: 0.9339978694915771
Epoch: 24, Steps: 64 | Train Loss: 0.1004832 Vali Loss: 0.1643741 Test Loss: 0.1408806
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 25 cost time: 0.9356281757354736
Epoch: 25, Steps: 64 | Train Loss: 0.1004866 Vali Loss: 0.1639255 Test Loss: 0.1415564
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 26 cost time: 0.97979736328125
Epoch: 26, Steps: 64 | Train Loss: 0.0995676 Vali Loss: 0.1644141 Test Loss: 0.1410468
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 27 cost time: 0.931389570236206
Epoch: 27, Steps: 64 | Train Loss: 0.0997386 Vali Loss: 0.1623966 Test Loss: 0.1408265
Validation loss decreased (0.162758 --> 0.162397).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 28 cost time: 0.9559791088104248
Epoch: 28, Steps: 64 | Train Loss: 0.0994484 Vali Loss: 0.1628368 Test Loss: 0.1409080
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 29 cost time: 0.9610042572021484
Epoch: 29, Steps: 64 | Train Loss: 0.0990894 Vali Loss: 0.1619598 Test Loss: 0.1404996
Validation loss decreased (0.162397 --> 0.161960).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 30 cost time: 0.9600145816802979
Epoch: 30, Steps: 64 | Train Loss: 0.0990422 Vali Loss: 0.1625552 Test Loss: 0.1402727
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 31 cost time: 0.9602992534637451
Epoch: 31, Steps: 64 | Train Loss: 0.0988491 Vali Loss: 0.1632728 Test Loss: 0.1406803
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 32 cost time: 0.9567592144012451
Epoch: 32, Steps: 64 | Train Loss: 0.0986629 Vali Loss: 0.1615400 Test Loss: 0.1400710
Validation loss decreased (0.161960 --> 0.161540).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 33 cost time: 0.9518063068389893
Epoch: 33, Steps: 64 | Train Loss: 0.0987014 Vali Loss: 0.1605444 Test Loss: 0.1401436
Validation loss decreased (0.161540 --> 0.160544).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 34 cost time: 0.9836180210113525
Epoch: 34, Steps: 64 | Train Loss: 0.0981615 Vali Loss: 0.1624824 Test Loss: 0.1407226
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 35 cost time: 0.9896206855773926
Epoch: 35, Steps: 64 | Train Loss: 0.0984840 Vali Loss: 0.1604391 Test Loss: 0.1396825
Validation loss decreased (0.160544 --> 0.160439).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 36 cost time: 0.982363224029541
Epoch: 36, Steps: 64 | Train Loss: 0.0983580 Vali Loss: 0.1613746 Test Loss: 0.1402834
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 37 cost time: 0.9942598342895508
Epoch: 37, Steps: 64 | Train Loss: 0.0980883 Vali Loss: 0.1609466 Test Loss: 0.1408657
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 38 cost time: 0.9786872863769531
Epoch: 38, Steps: 64 | Train Loss: 0.0980941 Vali Loss: 0.1624212 Test Loss: 0.1404196
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 39 cost time: 0.9624087810516357
Epoch: 39, Steps: 64 | Train Loss: 0.0979124 Vali Loss: 0.1598591 Test Loss: 0.1402276
Validation loss decreased (0.160439 --> 0.159859).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 40 cost time: 0.948162317276001
Epoch: 40, Steps: 64 | Train Loss: 0.0981865 Vali Loss: 0.1612227 Test Loss: 0.1398354
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 41 cost time: 0.9402472972869873
Epoch: 41, Steps: 64 | Train Loss: 0.0974349 Vali Loss: 0.1617183 Test Loss: 0.1398443
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 42 cost time: 0.9558987617492676
Epoch: 42, Steps: 64 | Train Loss: 0.0980016 Vali Loss: 0.1618224 Test Loss: 0.1400506
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 43 cost time: 0.9566287994384766
Epoch: 43, Steps: 64 | Train Loss: 0.0977168 Vali Loss: 0.1607232 Test Loss: 0.1404588
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 44 cost time: 0.951632022857666
Epoch: 44, Steps: 64 | Train Loss: 0.0979094 Vali Loss: 0.1606203 Test Loss: 0.1399861
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 45 cost time: 0.9552934169769287
Epoch: 45, Steps: 64 | Train Loss: 0.0977269 Vali Loss: 0.1572547 Test Loss: 0.1402331
Validation loss decreased (0.159859 --> 0.157255).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 46 cost time: 0.954397439956665
Epoch: 46, Steps: 64 | Train Loss: 0.0973579 Vali Loss: 0.1612320 Test Loss: 0.1404107
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 47 cost time: 0.9459984302520752
Epoch: 47, Steps: 64 | Train Loss: 0.0976787 Vali Loss: 0.1597841 Test Loss: 0.1398694
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 48 cost time: 0.9279999732971191
Epoch: 48, Steps: 64 | Train Loss: 0.0977219 Vali Loss: 0.1599644 Test Loss: 0.1401089
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 49 cost time: 0.9526369571685791
Epoch: 49, Steps: 64 | Train Loss: 0.0974499 Vali Loss: 0.1605721 Test Loss: 0.1403540
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 50 cost time: 0.9654285907745361
Epoch: 50, Steps: 64 | Train Loss: 0.0972307 Vali Loss: 0.1608819 Test Loss: 0.1403900
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 51 cost time: 0.9907457828521729
Epoch: 51, Steps: 64 | Train Loss: 0.0977489 Vali Loss: 0.1595979 Test Loss: 0.1403622
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 52 cost time: 0.9809987545013428
Epoch: 52, Steps: 64 | Train Loss: 0.0976777 Vali Loss: 0.1608681 Test Loss: 0.1398092
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 53 cost time: 0.9839291572570801
Epoch: 53, Steps: 64 | Train Loss: 0.0974998 Vali Loss: 0.1596193 Test Loss: 0.1401834
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 54 cost time: 0.9853711128234863
Epoch: 54, Steps: 64 | Train Loss: 0.0975955 Vali Loss: 0.1632839 Test Loss: 0.1401133
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 55 cost time: 0.9550001621246338
Epoch: 55, Steps: 64 | Train Loss: 0.0975890 Vali Loss: 0.1579644 Test Loss: 0.1395438
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 56 cost time: 0.9576447010040283
Epoch: 56, Steps: 64 | Train Loss: 0.0972512 Vali Loss: 0.1608396 Test Loss: 0.1401600
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 57 cost time: 0.9739987850189209
Epoch: 57, Steps: 64 | Train Loss: 0.0972016 Vali Loss: 0.1606899 Test Loss: 0.1397162
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 58 cost time: 0.9776411056518555
Epoch: 58, Steps: 64 | Train Loss: 0.0972037 Vali Loss: 0.1598799 Test Loss: 0.1398731
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 59 cost time: 0.9859440326690674
Epoch: 59, Steps: 64 | Train Loss: 0.0973657 Vali Loss: 0.1604785 Test Loss: 0.1402764
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017578125 GB
GPU已分配内存的峰值：0.0372309684753418 GB
Epoch: 60 cost time: 0.980363130569458
Epoch: 60, Steps: 64 | Train Loss: 0.0975058 Vali Loss: 0.1612442 Test Loss: 0.1402688
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14023306965827942, mae:0.2731904685497284, rse:0.19931785762310028
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03729438781738281 GB
Epoch: 1 cost time: 2.4087822437286377
Epoch: 1, Steps: 64 | Train Loss: 0.7681670 Vali Loss: 1.7975423 Test Loss: 3.4164205
Validation loss decreased (inf --> 1.797542).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 2 cost time: 1.006436824798584
Epoch: 2, Steps: 64 | Train Loss: 0.6418569 Vali Loss: 1.2081076 Test Loss: 2.1565788
Validation loss decreased (1.797542 --> 1.208108).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 3 cost time: 1.005220890045166
Epoch: 3, Steps: 64 | Train Loss: 0.4048264 Vali Loss: 0.6676399 Test Loss: 1.0106180
Validation loss decreased (1.208108 --> 0.667640).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 4 cost time: 0.9798760414123535
Epoch: 4, Steps: 64 | Train Loss: 0.2218584 Vali Loss: 0.3651866 Test Loss: 0.4042291
Validation loss decreased (0.667640 --> 0.365187).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 5 cost time: 1.0105996131896973
Epoch: 5, Steps: 64 | Train Loss: 0.1422724 Vali Loss: 0.2587638 Test Loss: 0.2221763
Validation loss decreased (0.365187 --> 0.258764).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 6 cost time: 0.9926669597625732
Epoch: 6, Steps: 64 | Train Loss: 0.1191426 Vali Loss: 0.2172786 Test Loss: 0.1782231
Validation loss decreased (0.258764 --> 0.217279).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 7 cost time: 0.9541604518890381
Epoch: 7, Steps: 64 | Train Loss: 0.1115917 Vali Loss: 0.1986096 Test Loss: 0.1650859
Validation loss decreased (0.217279 --> 0.198610).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 8 cost time: 0.9562761783599854
Epoch: 8, Steps: 64 | Train Loss: 0.1079802 Vali Loss: 0.1907102 Test Loss: 0.1578761
Validation loss decreased (0.198610 --> 0.190710).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 9 cost time: 0.9886307716369629
Epoch: 9, Steps: 64 | Train Loss: 0.1052505 Vali Loss: 0.1834437 Test Loss: 0.1540533
Validation loss decreased (0.190710 --> 0.183444).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 10 cost time: 1.005631446838379
Epoch: 10, Steps: 64 | Train Loss: 0.1027908 Vali Loss: 0.1813080 Test Loss: 0.1525756
Validation loss decreased (0.183444 --> 0.181308).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 11 cost time: 1.0006449222564697
Epoch: 11, Steps: 64 | Train Loss: 0.1022280 Vali Loss: 0.1741097 Test Loss: 0.1486539
Validation loss decreased (0.181308 --> 0.174110).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 12 cost time: 0.9996452331542969
Epoch: 12, Steps: 64 | Train Loss: 0.1007565 Vali Loss: 0.1762869 Test Loss: 0.1496790
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 13 cost time: 0.9812259674072266
Epoch: 13, Steps: 64 | Train Loss: 0.1000390 Vali Loss: 0.1733301 Test Loss: 0.1478288
Validation loss decreased (0.174110 --> 0.173330).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 14 cost time: 0.9793863296508789
Epoch: 14, Steps: 64 | Train Loss: 0.0990900 Vali Loss: 0.1756835 Test Loss: 0.1484300
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 15 cost time: 0.9820346832275391
Epoch: 15, Steps: 64 | Train Loss: 0.0982439 Vali Loss: 0.1717250 Test Loss: 0.1463290
Validation loss decreased (0.173330 --> 0.171725).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 16 cost time: 0.9830000400543213
Epoch: 16, Steps: 64 | Train Loss: 0.0978071 Vali Loss: 0.1710153 Test Loss: 0.1471176
Validation loss decreased (0.171725 --> 0.171015).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 17 cost time: 1.0022563934326172
Epoch: 17, Steps: 64 | Train Loss: 0.0973488 Vali Loss: 0.1694244 Test Loss: 0.1460121
Validation loss decreased (0.171015 --> 0.169424).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 18 cost time: 1.0054523944854736
Epoch: 18, Steps: 64 | Train Loss: 0.0968512 Vali Loss: 0.1704505 Test Loss: 0.1461866
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 19 cost time: 1.0137016773223877
Epoch: 19, Steps: 64 | Train Loss: 0.0961184 Vali Loss: 0.1686057 Test Loss: 0.1453970
Validation loss decreased (0.169424 --> 0.168606).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 20 cost time: 0.9787371158599854
Epoch: 20, Steps: 64 | Train Loss: 0.0957436 Vali Loss: 0.1688947 Test Loss: 0.1457980
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 21 cost time: 0.9742467403411865
Epoch: 21, Steps: 64 | Train Loss: 0.0957963 Vali Loss: 0.1687644 Test Loss: 0.1465758
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 22 cost time: 0.97161865234375
Epoch: 22, Steps: 64 | Train Loss: 0.0957253 Vali Loss: 0.1656054 Test Loss: 0.1456071
Validation loss decreased (0.168606 --> 0.165605).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 23 cost time: 0.963634729385376
Epoch: 23, Steps: 64 | Train Loss: 0.0953268 Vali Loss: 0.1679610 Test Loss: 0.1450004
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 24 cost time: 0.9636220932006836
Epoch: 24, Steps: 64 | Train Loss: 0.0947779 Vali Loss: 0.1667150 Test Loss: 0.1453230
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 25 cost time: 0.9703941345214844
Epoch: 25, Steps: 64 | Train Loss: 0.0948839 Vali Loss: 0.1685303 Test Loss: 0.1462489
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 26 cost time: 0.9864320755004883
Epoch: 26, Steps: 64 | Train Loss: 0.0944709 Vali Loss: 0.1659887 Test Loss: 0.1456441
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 27 cost time: 0.9811022281646729
Epoch: 27, Steps: 64 | Train Loss: 0.0940429 Vali Loss: 0.1670863 Test Loss: 0.1456467
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 28 cost time: 0.9833803176879883
Epoch: 28, Steps: 64 | Train Loss: 0.0945202 Vali Loss: 0.1652547 Test Loss: 0.1447672
Validation loss decreased (0.165605 --> 0.165255).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 29 cost time: 0.9963655471801758
Epoch: 29, Steps: 64 | Train Loss: 0.0939407 Vali Loss: 0.1654320 Test Loss: 0.1447971
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 30 cost time: 0.9804491996765137
Epoch: 30, Steps: 64 | Train Loss: 0.0942539 Vali Loss: 0.1661797 Test Loss: 0.1454495
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 31 cost time: 0.9921045303344727
Epoch: 31, Steps: 64 | Train Loss: 0.0941024 Vali Loss: 0.1655240 Test Loss: 0.1451468
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 32 cost time: 0.9919707775115967
Epoch: 32, Steps: 64 | Train Loss: 0.0941053 Vali Loss: 0.1652816 Test Loss: 0.1447487
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 33 cost time: 0.991999626159668
Epoch: 33, Steps: 64 | Train Loss: 0.0938879 Vali Loss: 0.1677495 Test Loss: 0.1455346
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 34 cost time: 1.0068984031677246
Epoch: 34, Steps: 64 | Train Loss: 0.0937224 Vali Loss: 0.1670316 Test Loss: 0.1453094
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 35 cost time: 1.0254263877868652
Epoch: 35, Steps: 64 | Train Loss: 0.0938204 Vali Loss: 0.1656866 Test Loss: 0.1452796
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 36 cost time: 1.006335973739624
Epoch: 36, Steps: 64 | Train Loss: 0.0937967 Vali Loss: 0.1666804 Test Loss: 0.1456486
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 37 cost time: 1.0076167583465576
Epoch: 37, Steps: 64 | Train Loss: 0.0932063 Vali Loss: 0.1657794 Test Loss: 0.1447770
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 38 cost time: 0.9713990688323975
Epoch: 38, Steps: 64 | Train Loss: 0.0939414 Vali Loss: 0.1669474 Test Loss: 0.1450053
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 39 cost time: 0.9991860389709473
Epoch: 39, Steps: 64 | Train Loss: 0.0935413 Vali Loss: 0.1635280 Test Loss: 0.1453194
Validation loss decreased (0.165255 --> 0.163528).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 40 cost time: 0.9930810928344727
Epoch: 40, Steps: 64 | Train Loss: 0.0937091 Vali Loss: 0.1663971 Test Loss: 0.1455112
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 41 cost time: 0.9724395275115967
Epoch: 41, Steps: 64 | Train Loss: 0.0936965 Vali Loss: 0.1656429 Test Loss: 0.1446981
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 42 cost time: 0.9789106845855713
Epoch: 42, Steps: 64 | Train Loss: 0.0936758 Vali Loss: 0.1634310 Test Loss: 0.1449288
Validation loss decreased (0.163528 --> 0.163431).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 43 cost time: 0.9512939453125
Epoch: 43, Steps: 64 | Train Loss: 0.0933252 Vali Loss: 0.1654188 Test Loss: 0.1447279
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 44 cost time: 1.0123958587646484
Epoch: 44, Steps: 64 | Train Loss: 0.0932311 Vali Loss: 0.1649395 Test Loss: 0.1447827
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 45 cost time: 0.991441011428833
Epoch: 45, Steps: 64 | Train Loss: 0.0936683 Vali Loss: 0.1660389 Test Loss: 0.1446434
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 46 cost time: 0.9675917625427246
Epoch: 46, Steps: 64 | Train Loss: 0.0930476 Vali Loss: 0.1670939 Test Loss: 0.1454475
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 47 cost time: 0.9706406593322754
Epoch: 47, Steps: 64 | Train Loss: 0.0932969 Vali Loss: 0.1644684 Test Loss: 0.1445022
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 48 cost time: 0.9931685924530029
Epoch: 48, Steps: 64 | Train Loss: 0.0929977 Vali Loss: 0.1661570 Test Loss: 0.1448042
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 49 cost time: 0.9924838542938232
Epoch: 49, Steps: 64 | Train Loss: 0.0933428 Vali Loss: 0.1647795 Test Loss: 0.1449828
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 50 cost time: 1.0023527145385742
Epoch: 50, Steps: 64 | Train Loss: 0.0936693 Vali Loss: 0.1652064 Test Loss: 0.1453639
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 51 cost time: 1.0149834156036377
Epoch: 51, Steps: 64 | Train Loss: 0.0930544 Vali Loss: 0.1665784 Test Loss: 0.1447660
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 52 cost time: 1.0169992446899414
Epoch: 52, Steps: 64 | Train Loss: 0.0937069 Vali Loss: 0.1658739 Test Loss: 0.1448967
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 53 cost time: 1.0113298892974854
Epoch: 53, Steps: 64 | Train Loss: 0.0927582 Vali Loss: 0.1636355 Test Loss: 0.1448562
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 54 cost time: 0.9921975135803223
Epoch: 54, Steps: 64 | Train Loss: 0.0932951 Vali Loss: 0.1657501 Test Loss: 0.1447818
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 55 cost time: 0.9844381809234619
Epoch: 55, Steps: 64 | Train Loss: 0.0930636 Vali Loss: 0.1661912 Test Loss: 0.1451160
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 56 cost time: 0.979773998260498
Epoch: 56, Steps: 64 | Train Loss: 0.0927439 Vali Loss: 0.1643809 Test Loss: 0.1445960
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 57 cost time: 0.9582891464233398
Epoch: 57, Steps: 64 | Train Loss: 0.0931745 Vali Loss: 0.1658423 Test Loss: 0.1446932
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 58 cost time: 0.988001823425293
Epoch: 58, Steps: 64 | Train Loss: 0.0932023 Vali Loss: 0.1660580 Test Loss: 0.1448574
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 59 cost time: 0.9833321571350098
Epoch: 59, Steps: 64 | Train Loss: 0.0934388 Vali Loss: 0.1676316 Test Loss: 0.1452910
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01760101318359375 GB
GPU已分配内存的峰值：0.03798055648803711 GB
Epoch: 60 cost time: 0.9836444854736328
Epoch: 60, Steps: 64 | Train Loss: 0.0931811 Vali Loss: 0.1650026 Test Loss: 0.1445240
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14492881298065186, mae:0.2832722067832947, rse:0.20262748003005981
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.036190032958984375 GB
Epoch: 1 cost time: 2.3252341747283936
Epoch: 1, Steps: 64 | Train Loss: 1.0410437 Vali Loss: 2.2193649 Test Loss: 3.9559093
Validation loss decreased (inf --> 2.219365).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 2 cost time: 0.9363555908203125
Epoch: 2, Steps: 64 | Train Loss: 0.6182568 Vali Loss: 0.7757851 Test Loss: 1.1228255
Validation loss decreased (2.219365 --> 0.775785).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 3 cost time: 0.9296247959136963
Epoch: 3, Steps: 64 | Train Loss: 0.3495209 Vali Loss: 0.5884856 Test Loss: 0.7894852
Validation loss decreased (0.775785 --> 0.588486).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 4 cost time: 0.925410270690918
Epoch: 4, Steps: 64 | Train Loss: 0.2707296 Vali Loss: 0.4664949 Test Loss: 0.5634711
Validation loss decreased (0.588486 --> 0.466495).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 5 cost time: 0.9043920040130615
Epoch: 5, Steps: 64 | Train Loss: 0.2224623 Vali Loss: 0.3875733 Test Loss: 0.4312506
Validation loss decreased (0.466495 --> 0.387573).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 6 cost time: 0.9051022529602051
Epoch: 6, Steps: 64 | Train Loss: 0.1940614 Vali Loss: 0.3366491 Test Loss: 0.3455667
Validation loss decreased (0.387573 --> 0.336649).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 7 cost time: 0.9122941493988037
Epoch: 7, Steps: 64 | Train Loss: 0.1748136 Vali Loss: 0.2989939 Test Loss: 0.2923692
Validation loss decreased (0.336649 --> 0.298994).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 8 cost time: 0.9052925109863281
Epoch: 8, Steps: 64 | Train Loss: 0.1623237 Vali Loss: 0.2705588 Test Loss: 0.2582620
Validation loss decreased (0.298994 --> 0.270559).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 9 cost time: 0.9206204414367676
Epoch: 9, Steps: 64 | Train Loss: 0.1539224 Vali Loss: 0.2543825 Test Loss: 0.2337187
Validation loss decreased (0.270559 --> 0.254382).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 10 cost time: 0.9337656497955322
Epoch: 10, Steps: 64 | Train Loss: 0.1468633 Vali Loss: 0.2367662 Test Loss: 0.2156208
Validation loss decreased (0.254382 --> 0.236766).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 11 cost time: 0.965644359588623
Epoch: 11, Steps: 64 | Train Loss: 0.1410446 Vali Loss: 0.2232134 Test Loss: 0.2015101
Validation loss decreased (0.236766 --> 0.223213).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 12 cost time: 0.9603760242462158
Epoch: 12, Steps: 64 | Train Loss: 0.1373430 Vali Loss: 0.2136433 Test Loss: 0.1916606
Validation loss decreased (0.223213 --> 0.213643).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 13 cost time: 0.9543917179107666
Epoch: 13, Steps: 64 | Train Loss: 0.1341762 Vali Loss: 0.2072591 Test Loss: 0.1828367
Validation loss decreased (0.213643 --> 0.207259).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 14 cost time: 0.9372463226318359
Epoch: 14, Steps: 64 | Train Loss: 0.1322689 Vali Loss: 0.2006027 Test Loss: 0.1798002
Validation loss decreased (0.207259 --> 0.200603).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 15 cost time: 0.9413967132568359
Epoch: 15, Steps: 64 | Train Loss: 0.1305631 Vali Loss: 0.2008594 Test Loss: 0.1762917
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 16 cost time: 0.9364285469055176
Epoch: 16, Steps: 64 | Train Loss: 0.1289159 Vali Loss: 0.1944496 Test Loss: 0.1718200
Validation loss decreased (0.200603 --> 0.194450).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 17 cost time: 0.9426174163818359
Epoch: 17, Steps: 64 | Train Loss: 0.1271859 Vali Loss: 0.1924352 Test Loss: 0.1688763
Validation loss decreased (0.194450 --> 0.192435).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 18 cost time: 0.968623161315918
Epoch: 18, Steps: 64 | Train Loss: 0.1253158 Vali Loss: 0.1913259 Test Loss: 0.1674490
Validation loss decreased (0.192435 --> 0.191326).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 19 cost time: 0.962529182434082
Epoch: 19, Steps: 64 | Train Loss: 0.1245618 Vali Loss: 0.1895032 Test Loss: 0.1647663
Validation loss decreased (0.191326 --> 0.189503).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 20 cost time: 0.9742727279663086
Epoch: 20, Steps: 64 | Train Loss: 0.1229737 Vali Loss: 0.1848641 Test Loss: 0.1628932
Validation loss decreased (0.189503 --> 0.184864).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 21 cost time: 0.9396278858184814
Epoch: 21, Steps: 64 | Train Loss: 0.1225572 Vali Loss: 0.1861475 Test Loss: 0.1619192
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 22 cost time: 0.9164988994598389
Epoch: 22, Steps: 64 | Train Loss: 0.1214070 Vali Loss: 0.1854866 Test Loss: 0.1617937
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 23 cost time: 0.9150004386901855
Epoch: 23, Steps: 64 | Train Loss: 0.1210521 Vali Loss: 0.1845590 Test Loss: 0.1604137
Validation loss decreased (0.184864 --> 0.184559).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 24 cost time: 0.9263949394226074
Epoch: 24, Steps: 64 | Train Loss: 0.1206555 Vali Loss: 0.1836977 Test Loss: 0.1586710
Validation loss decreased (0.184559 --> 0.183698).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 25 cost time: 0.9304678440093994
Epoch: 25, Steps: 64 | Train Loss: 0.1205757 Vali Loss: 0.1825867 Test Loss: 0.1587396
Validation loss decreased (0.183698 --> 0.182587).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 26 cost time: 0.9257142543792725
Epoch: 26, Steps: 64 | Train Loss: 0.1204436 Vali Loss: 0.1800991 Test Loss: 0.1575869
Validation loss decreased (0.182587 --> 0.180099).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 27 cost time: 0.9436123371124268
Epoch: 27, Steps: 64 | Train Loss: 0.1188101 Vali Loss: 0.1813056 Test Loss: 0.1586597
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 28 cost time: 0.9480001926422119
Epoch: 28, Steps: 64 | Train Loss: 0.1196642 Vali Loss: 0.1815869 Test Loss: 0.1570819
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 29 cost time: 0.9323439598083496
Epoch: 29, Steps: 64 | Train Loss: 0.1187602 Vali Loss: 0.1792591 Test Loss: 0.1564114
Validation loss decreased (0.180099 --> 0.179259).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 30 cost time: 0.9233987331390381
Epoch: 30, Steps: 64 | Train Loss: 0.1185908 Vali Loss: 0.1778236 Test Loss: 0.1561776
Validation loss decreased (0.179259 --> 0.177824).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 31 cost time: 0.9260468482971191
Epoch: 31, Steps: 64 | Train Loss: 0.1183180 Vali Loss: 0.1790570 Test Loss: 0.1564804
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 32 cost time: 0.9423770904541016
Epoch: 32, Steps: 64 | Train Loss: 0.1184695 Vali Loss: 0.1788214 Test Loss: 0.1560570
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 33 cost time: 0.9373972415924072
Epoch: 33, Steps: 64 | Train Loss: 0.1169352 Vali Loss: 0.1768149 Test Loss: 0.1558300
Validation loss decreased (0.177824 --> 0.176815).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 34 cost time: 0.9387567043304443
Epoch: 34, Steps: 64 | Train Loss: 0.1173157 Vali Loss: 0.1764021 Test Loss: 0.1553365
Validation loss decreased (0.176815 --> 0.176402).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 35 cost time: 0.9748778343200684
Epoch: 35, Steps: 64 | Train Loss: 0.1177831 Vali Loss: 0.1796222 Test Loss: 0.1561657
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 36 cost time: 0.9579989910125732
Epoch: 36, Steps: 64 | Train Loss: 0.1175636 Vali Loss: 0.1773334 Test Loss: 0.1550475
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 37 cost time: 0.9566366672515869
Epoch: 37, Steps: 64 | Train Loss: 0.1172041 Vali Loss: 0.1759775 Test Loss: 0.1555195
Validation loss decreased (0.176402 --> 0.175978).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 38 cost time: 0.955085277557373
Epoch: 38, Steps: 64 | Train Loss: 0.1171495 Vali Loss: 0.1783012 Test Loss: 0.1554881
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 39 cost time: 0.9514832496643066
Epoch: 39, Steps: 64 | Train Loss: 0.1170299 Vali Loss: 0.1783443 Test Loss: 0.1551144
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 40 cost time: 0.937976598739624
Epoch: 40, Steps: 64 | Train Loss: 0.1167394 Vali Loss: 0.1779361 Test Loss: 0.1554111
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 41 cost time: 0.9185833930969238
Epoch: 41, Steps: 64 | Train Loss: 0.1165206 Vali Loss: 0.1766359 Test Loss: 0.1554604
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 42 cost time: 0.9203684329986572
Epoch: 42, Steps: 64 | Train Loss: 0.1169783 Vali Loss: 0.1761062 Test Loss: 0.1546335
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 43 cost time: 0.9338548183441162
Epoch: 43, Steps: 64 | Train Loss: 0.1166644 Vali Loss: 0.1757623 Test Loss: 0.1541625
Validation loss decreased (0.175978 --> 0.175762).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 44 cost time: 0.9340007305145264
Epoch: 44, Steps: 64 | Train Loss: 0.1160836 Vali Loss: 0.1776627 Test Loss: 0.1542414
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 45 cost time: 0.956883430480957
Epoch: 45, Steps: 64 | Train Loss: 0.1162642 Vali Loss: 0.1764468 Test Loss: 0.1543719
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 46 cost time: 0.9642512798309326
Epoch: 46, Steps: 64 | Train Loss: 0.1158147 Vali Loss: 0.1770925 Test Loss: 0.1539149
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 47 cost time: 0.9414474964141846
Epoch: 47, Steps: 64 | Train Loss: 0.1159866 Vali Loss: 0.1758109 Test Loss: 0.1544008
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 48 cost time: 0.949390172958374
Epoch: 48, Steps: 64 | Train Loss: 0.1158804 Vali Loss: 0.1759665 Test Loss: 0.1544601
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 49 cost time: 0.9210104942321777
Epoch: 49, Steps: 64 | Train Loss: 0.1164527 Vali Loss: 0.1770729 Test Loss: 0.1544663
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 50 cost time: 0.9191009998321533
Epoch: 50, Steps: 64 | Train Loss: 0.1164567 Vali Loss: 0.1744628 Test Loss: 0.1545591
Validation loss decreased (0.175762 --> 0.174463).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 51 cost time: 0.9473862648010254
Epoch: 51, Steps: 64 | Train Loss: 0.1164173 Vali Loss: 0.1751045 Test Loss: 0.1537093
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 52 cost time: 0.9488890171051025
Epoch: 52, Steps: 64 | Train Loss: 0.1158584 Vali Loss: 0.1767684 Test Loss: 0.1531907
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 53 cost time: 0.9033651351928711
Epoch: 53, Steps: 64 | Train Loss: 0.1160200 Vali Loss: 0.1781783 Test Loss: 0.1536965
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 54 cost time: 0.9546389579772949
Epoch: 54, Steps: 64 | Train Loss: 0.1159029 Vali Loss: 0.1767853 Test Loss: 0.1550661
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 55 cost time: 0.9514725208282471
Epoch: 55, Steps: 64 | Train Loss: 0.1161175 Vali Loss: 0.1775021 Test Loss: 0.1536264
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 56 cost time: 0.9524142742156982
Epoch: 56, Steps: 64 | Train Loss: 0.1159274 Vali Loss: 0.1764915 Test Loss: 0.1539500
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 57 cost time: 0.9358165264129639
Epoch: 57, Steps: 64 | Train Loss: 0.1158300 Vali Loss: 0.1766955 Test Loss: 0.1534537
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 58 cost time: 0.9284594058990479
Epoch: 58, Steps: 64 | Train Loss: 0.1157846 Vali Loss: 0.1773291 Test Loss: 0.1544316
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 59 cost time: 0.9274682998657227
Epoch: 59, Steps: 64 | Train Loss: 0.1155919 Vali Loss: 0.1769356 Test Loss: 0.1541413
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.03663301467895508 GB
Epoch: 60 cost time: 0.95516037940979
Epoch: 60, Steps: 64 | Train Loss: 0.1158533 Vali Loss: 0.1757621 Test Loss: 0.1536634
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15455904603004456, mae:0.29774513840675354, rse:0.2092513144016266
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.03689146041870117 GB
Epoch: 1 cost time: 2.3579907417297363
Epoch: 1, Steps: 64 | Train Loss: 0.8789872 Vali Loss: 1.9637330 Test Loss: 3.8068662
Validation loss decreased (inf --> 1.963733).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 2 cost time: 0.9765477180480957
Epoch: 2, Steps: 64 | Train Loss: 0.5864896 Vali Loss: 0.8535196 Test Loss: 1.4869683
Validation loss decreased (1.963733 --> 0.853520).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 3 cost time: 0.9688436985015869
Epoch: 3, Steps: 64 | Train Loss: 0.3146817 Vali Loss: 0.4897354 Test Loss: 0.7165052
Validation loss decreased (0.853520 --> 0.489735).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 4 cost time: 0.9684586524963379
Epoch: 4, Steps: 64 | Train Loss: 0.1896709 Vali Loss: 0.3182799 Test Loss: 0.3682661
Validation loss decreased (0.489735 --> 0.318280).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 5 cost time: 0.9576358795166016
Epoch: 5, Steps: 64 | Train Loss: 0.1408098 Vali Loss: 0.2471645 Test Loss: 0.2441029
Validation loss decreased (0.318280 --> 0.247164).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 6 cost time: 0.9500217437744141
Epoch: 6, Steps: 64 | Train Loss: 0.1251072 Vali Loss: 0.2163283 Test Loss: 0.1986205
Validation loss decreased (0.247164 --> 0.216328).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 7 cost time: 0.9473702907562256
Epoch: 7, Steps: 64 | Train Loss: 0.1190575 Vali Loss: 0.2061673 Test Loss: 0.1832859
Validation loss decreased (0.216328 --> 0.206167).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 8 cost time: 0.9552717208862305
Epoch: 8, Steps: 64 | Train Loss: 0.1149472 Vali Loss: 0.1987482 Test Loss: 0.1733897
Validation loss decreased (0.206167 --> 0.198748).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 9 cost time: 0.9773664474487305
Epoch: 9, Steps: 64 | Train Loss: 0.1124331 Vali Loss: 0.1945345 Test Loss: 0.1676073
Validation loss decreased (0.198748 --> 0.194535).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 10 cost time: 0.9813690185546875
Epoch: 10, Steps: 64 | Train Loss: 0.1104547 Vali Loss: 0.1881254 Test Loss: 0.1643473
Validation loss decreased (0.194535 --> 0.188125).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 11 cost time: 0.9895534515380859
Epoch: 11, Steps: 64 | Train Loss: 0.1087506 Vali Loss: 0.1860381 Test Loss: 0.1611636
Validation loss decreased (0.188125 --> 0.186038).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 12 cost time: 1.0012767314910889
Epoch: 12, Steps: 64 | Train Loss: 0.1073546 Vali Loss: 0.1834319 Test Loss: 0.1605215
Validation loss decreased (0.186038 --> 0.183432).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 13 cost time: 0.9657585620880127
Epoch: 13, Steps: 64 | Train Loss: 0.1062179 Vali Loss: 0.1828129 Test Loss: 0.1580095
Validation loss decreased (0.183432 --> 0.182813).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 14 cost time: 0.9667644500732422
Epoch: 14, Steps: 64 | Train Loss: 0.1055309 Vali Loss: 0.1847192 Test Loss: 0.1580620
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 15 cost time: 0.9641711711883545
Epoch: 15, Steps: 64 | Train Loss: 0.1039964 Vali Loss: 0.1813297 Test Loss: 0.1573557
Validation loss decreased (0.182813 --> 0.181330).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 16 cost time: 0.9610018730163574
Epoch: 16, Steps: 64 | Train Loss: 0.1030371 Vali Loss: 0.1807944 Test Loss: 0.1559813
Validation loss decreased (0.181330 --> 0.180794).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 17 cost time: 0.9846501350402832
Epoch: 17, Steps: 64 | Train Loss: 0.1030311 Vali Loss: 0.1782471 Test Loss: 0.1552560
Validation loss decreased (0.180794 --> 0.178247).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 18 cost time: 0.9946506023406982
Epoch: 18, Steps: 64 | Train Loss: 0.1024373 Vali Loss: 0.1796335 Test Loss: 0.1552488
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 19 cost time: 0.9861669540405273
Epoch: 19, Steps: 64 | Train Loss: 0.1014267 Vali Loss: 0.1802858 Test Loss: 0.1552691
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 20 cost time: 0.9634404182434082
Epoch: 20, Steps: 64 | Train Loss: 0.1012520 Vali Loss: 0.1800228 Test Loss: 0.1552658
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 21 cost time: 0.9574918746948242
Epoch: 21, Steps: 64 | Train Loss: 0.1005002 Vali Loss: 0.1793823 Test Loss: 0.1548823
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 22 cost time: 0.9493579864501953
Epoch: 22, Steps: 64 | Train Loss: 0.1003931 Vali Loss: 0.1791599 Test Loss: 0.1546554
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 23 cost time: 0.9558310508728027
Epoch: 23, Steps: 64 | Train Loss: 0.0999747 Vali Loss: 0.1775800 Test Loss: 0.1542328
Validation loss decreased (0.178247 --> 0.177580).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 24 cost time: 0.9531481266021729
Epoch: 24, Steps: 64 | Train Loss: 0.0998270 Vali Loss: 0.1760764 Test Loss: 0.1549166
Validation loss decreased (0.177580 --> 0.176076).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 25 cost time: 0.963742733001709
Epoch: 25, Steps: 64 | Train Loss: 0.0994804 Vali Loss: 0.1787897 Test Loss: 0.1546781
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 26 cost time: 0.9669997692108154
Epoch: 26, Steps: 64 | Train Loss: 0.0994451 Vali Loss: 0.1795888 Test Loss: 0.1543652
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 27 cost time: 0.9728388786315918
Epoch: 27, Steps: 64 | Train Loss: 0.0990119 Vali Loss: 0.1790661 Test Loss: 0.1543149
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 28 cost time: 0.9712972640991211
Epoch: 28, Steps: 64 | Train Loss: 0.0992513 Vali Loss: 0.1786801 Test Loss: 0.1537654
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 29 cost time: 0.946648359298706
Epoch: 29, Steps: 64 | Train Loss: 0.0990917 Vali Loss: 0.1789056 Test Loss: 0.1545574
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 30 cost time: 0.9814152717590332
Epoch: 30, Steps: 64 | Train Loss: 0.0989139 Vali Loss: 0.1782165 Test Loss: 0.1539507
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 31 cost time: 0.98453688621521
Epoch: 31, Steps: 64 | Train Loss: 0.0985298 Vali Loss: 0.1779677 Test Loss: 0.1543139
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 32 cost time: 0.9623684883117676
Epoch: 32, Steps: 64 | Train Loss: 0.0983339 Vali Loss: 0.1767263 Test Loss: 0.1539335
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 33 cost time: 0.9664244651794434
Epoch: 33, Steps: 64 | Train Loss: 0.0980781 Vali Loss: 0.1769093 Test Loss: 0.1539540
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 34 cost time: 0.9955685138702393
Epoch: 34, Steps: 64 | Train Loss: 0.0976406 Vali Loss: 0.1787435 Test Loss: 0.1542436
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 35 cost time: 0.9919934272766113
Epoch: 35, Steps: 64 | Train Loss: 0.0983396 Vali Loss: 0.1772812 Test Loss: 0.1538339
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 36 cost time: 0.9868009090423584
Epoch: 36, Steps: 64 | Train Loss: 0.0980662 Vali Loss: 0.1768177 Test Loss: 0.1537144
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 37 cost time: 0.9906175136566162
Epoch: 37, Steps: 64 | Train Loss: 0.0978096 Vali Loss: 0.1751207 Test Loss: 0.1540118
Validation loss decreased (0.176076 --> 0.175121).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 38 cost time: 0.9699997901916504
Epoch: 38, Steps: 64 | Train Loss: 0.0978675 Vali Loss: 0.1774072 Test Loss: 0.1533184
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 39 cost time: 0.9496517181396484
Epoch: 39, Steps: 64 | Train Loss: 0.0979142 Vali Loss: 0.1784954 Test Loss: 0.1533312
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 40 cost time: 0.944392204284668
Epoch: 40, Steps: 64 | Train Loss: 0.0976696 Vali Loss: 0.1754705 Test Loss: 0.1542009
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 41 cost time: 0.9504108428955078
Epoch: 41, Steps: 64 | Train Loss: 0.0976454 Vali Loss: 0.1774063 Test Loss: 0.1541460
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 42 cost time: 0.9634242057800293
Epoch: 42, Steps: 64 | Train Loss: 0.0975945 Vali Loss: 0.1749423 Test Loss: 0.1533771
Validation loss decreased (0.175121 --> 0.174942).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 43 cost time: 0.9733645915985107
Epoch: 43, Steps: 64 | Train Loss: 0.0973462 Vali Loss: 0.1787613 Test Loss: 0.1539472
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 44 cost time: 0.9643826484680176
Epoch: 44, Steps: 64 | Train Loss: 0.0972949 Vali Loss: 0.1766504 Test Loss: 0.1539361
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 45 cost time: 0.9742252826690674
Epoch: 45, Steps: 64 | Train Loss: 0.0974493 Vali Loss: 0.1761187 Test Loss: 0.1541820
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 46 cost time: 0.9547722339630127
Epoch: 46, Steps: 64 | Train Loss: 0.0973850 Vali Loss: 0.1752964 Test Loss: 0.1540471
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 47 cost time: 0.9573733806610107
Epoch: 47, Steps: 64 | Train Loss: 0.0976631 Vali Loss: 0.1737266 Test Loss: 0.1544540
Validation loss decreased (0.174942 --> 0.173727).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 48 cost time: 0.960615873336792
Epoch: 48, Steps: 64 | Train Loss: 0.0970376 Vali Loss: 0.1759543 Test Loss: 0.1537188
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 49 cost time: 0.9603595733642578
Epoch: 49, Steps: 64 | Train Loss: 0.0968691 Vali Loss: 0.1762974 Test Loss: 0.1531859
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 50 cost time: 0.9773790836334229
Epoch: 50, Steps: 64 | Train Loss: 0.0975731 Vali Loss: 0.1756156 Test Loss: 0.1539133
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 51 cost time: 0.9825105667114258
Epoch: 51, Steps: 64 | Train Loss: 0.0971713 Vali Loss: 0.1754949 Test Loss: 0.1545021
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 52 cost time: 0.9813647270202637
Epoch: 52, Steps: 64 | Train Loss: 0.0973764 Vali Loss: 0.1777627 Test Loss: 0.1540064
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 53 cost time: 0.9834010601043701
Epoch: 53, Steps: 64 | Train Loss: 0.0972482 Vali Loss: 0.1744477 Test Loss: 0.1540924
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 54 cost time: 0.9784183502197266
Epoch: 54, Steps: 64 | Train Loss: 0.0967542 Vali Loss: 0.1783697 Test Loss: 0.1542474
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 55 cost time: 0.9644455909729004
Epoch: 55, Steps: 64 | Train Loss: 0.0972038 Vali Loss: 0.1765876 Test Loss: 0.1538174
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 56 cost time: 0.9647626876831055
Epoch: 56, Steps: 64 | Train Loss: 0.0973174 Vali Loss: 0.1784048 Test Loss: 0.1541250
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 57 cost time: 0.960228681564331
Epoch: 57, Steps: 64 | Train Loss: 0.0972236 Vali Loss: 0.1765568 Test Loss: 0.1537085
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 58 cost time: 0.968998908996582
Epoch: 58, Steps: 64 | Train Loss: 0.0975995 Vali Loss: 0.1772728 Test Loss: 0.1536990
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 59 cost time: 0.9646391868591309
Epoch: 59, Steps: 64 | Train Loss: 0.0974171 Vali Loss: 0.1763390 Test Loss: 0.1532577
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017581939697265625 GB
GPU已分配内存的峰值：0.037394046783447266 GB
Epoch: 60 cost time: 0.9849984645843506
Epoch: 60, Steps: 64 | Train Loss: 0.0973289 Vali Loss: 0.1779657 Test Loss: 0.1536938
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15445397794246674, mae:0.2996642589569092, rse:0.20918016135692596
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03745555877685547 GB
Epoch: 1 cost time: 2.372493028640747
Epoch: 1, Steps: 64 | Train Loss: 0.8195739 Vali Loss: 1.9147010 Test Loss: 3.6793954
Validation loss decreased (inf --> 1.914701).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 2 cost time: 0.9936261177062988
Epoch: 2, Steps: 64 | Train Loss: 0.6865422 Vali Loss: 1.2909635 Test Loss: 2.3666613
Validation loss decreased (1.914701 --> 1.290964).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 3 cost time: 0.9965715408325195
Epoch: 3, Steps: 64 | Train Loss: 0.4424564 Vali Loss: 0.7331658 Test Loss: 1.1891657
Validation loss decreased (1.290964 --> 0.733166).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 4 cost time: 1.0016179084777832
Epoch: 4, Steps: 64 | Train Loss: 0.2381547 Vali Loss: 0.3796288 Test Loss: 0.4684886
Validation loss decreased (0.733166 --> 0.379629).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 5 cost time: 0.9758572578430176
Epoch: 5, Steps: 64 | Train Loss: 0.1424303 Vali Loss: 0.2498124 Test Loss: 0.2397730
Validation loss decreased (0.379629 --> 0.249812).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 6 cost time: 0.9682266712188721
Epoch: 6, Steps: 64 | Train Loss: 0.1184637 Vali Loss: 0.2088115 Test Loss: 0.1882687
Validation loss decreased (0.249812 --> 0.208811).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 7 cost time: 0.9754123687744141
Epoch: 7, Steps: 64 | Train Loss: 0.1110931 Vali Loss: 0.1960873 Test Loss: 0.1765517
Validation loss decreased (0.208811 --> 0.196087).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 8 cost time: 0.9694943428039551
Epoch: 8, Steps: 64 | Train Loss: 0.1065701 Vali Loss: 0.1864940 Test Loss: 0.1662778
Validation loss decreased (0.196087 --> 0.186494).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 9 cost time: 0.9924077987670898
Epoch: 9, Steps: 64 | Train Loss: 0.1040658 Vali Loss: 0.1822591 Test Loss: 0.1637972
Validation loss decreased (0.186494 --> 0.182259).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 10 cost time: 1.009916067123413
Epoch: 10, Steps: 64 | Train Loss: 0.1021471 Vali Loss: 0.1779853 Test Loss: 0.1603672
Validation loss decreased (0.182259 --> 0.177985).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 11 cost time: 1.0119657516479492
Epoch: 11, Steps: 64 | Train Loss: 0.1006743 Vali Loss: 0.1737307 Test Loss: 0.1568240
Validation loss decreased (0.177985 --> 0.173731).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 12 cost time: 1.0103180408477783
Epoch: 12, Steps: 64 | Train Loss: 0.0988795 Vali Loss: 0.1723041 Test Loss: 0.1593682
Validation loss decreased (0.173731 --> 0.172304).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 13 cost time: 0.9860379695892334
Epoch: 13, Steps: 64 | Train Loss: 0.0983609 Vali Loss: 0.1737142 Test Loss: 0.1570848
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 14 cost time: 0.9938232898712158
Epoch: 14, Steps: 64 | Train Loss: 0.0976898 Vali Loss: 0.1731028 Test Loss: 0.1567632
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 15 cost time: 0.9850003719329834
Epoch: 15, Steps: 64 | Train Loss: 0.0965835 Vali Loss: 0.1710372 Test Loss: 0.1568689
Validation loss decreased (0.172304 --> 0.171037).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 16 cost time: 0.9836266040802002
Epoch: 16, Steps: 64 | Train Loss: 0.0963405 Vali Loss: 0.1723326 Test Loss: 0.1568521
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 17 cost time: 1.0100271701812744
Epoch: 17, Steps: 64 | Train Loss: 0.0957014 Vali Loss: 0.1724113 Test Loss: 0.1566453
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 18 cost time: 1.0176942348480225
Epoch: 18, Steps: 64 | Train Loss: 0.0953521 Vali Loss: 0.1703829 Test Loss: 0.1561300
Validation loss decreased (0.171037 --> 0.170383).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 19 cost time: 1.0076851844787598
Epoch: 19, Steps: 64 | Train Loss: 0.0952701 Vali Loss: 0.1693557 Test Loss: 0.1554928
Validation loss decreased (0.170383 --> 0.169356).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 20 cost time: 0.9942467212677002
Epoch: 20, Steps: 64 | Train Loss: 0.0945185 Vali Loss: 0.1703263 Test Loss: 0.1562296
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 21 cost time: 0.9710695743560791
Epoch: 21, Steps: 64 | Train Loss: 0.0945037 Vali Loss: 0.1709895 Test Loss: 0.1563575
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 22 cost time: 0.97845458984375
Epoch: 22, Steps: 64 | Train Loss: 0.0942349 Vali Loss: 0.1692812 Test Loss: 0.1553369
Validation loss decreased (0.169356 --> 0.169281).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 23 cost time: 0.9779882431030273
Epoch: 23, Steps: 64 | Train Loss: 0.0941004 Vali Loss: 0.1715761 Test Loss: 0.1555332
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 24 cost time: 0.9831328392028809
Epoch: 24, Steps: 64 | Train Loss: 0.0936598 Vali Loss: 0.1712414 Test Loss: 0.1563583
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 25 cost time: 0.9877245426177979
Epoch: 25, Steps: 64 | Train Loss: 0.0936085 Vali Loss: 0.1700963 Test Loss: 0.1565975
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 26 cost time: 0.9926097393035889
Epoch: 26, Steps: 64 | Train Loss: 0.0937031 Vali Loss: 0.1687307 Test Loss: 0.1558655
Validation loss decreased (0.169281 --> 0.168731).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 27 cost time: 0.9933674335479736
Epoch: 27, Steps: 64 | Train Loss: 0.0934016 Vali Loss: 0.1692578 Test Loss: 0.1560347
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 28 cost time: 0.9919631481170654
Epoch: 28, Steps: 64 | Train Loss: 0.0935338 Vali Loss: 0.1686030 Test Loss: 0.1563020
Validation loss decreased (0.168731 --> 0.168603).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 29 cost time: 0.9997467994689941
Epoch: 29, Steps: 64 | Train Loss: 0.0930158 Vali Loss: 0.1687493 Test Loss: 0.1559061
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 30 cost time: 0.9876267910003662
Epoch: 30, Steps: 64 | Train Loss: 0.0930838 Vali Loss: 0.1698871 Test Loss: 0.1569772
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 31 cost time: 0.9836530685424805
Epoch: 31, Steps: 64 | Train Loss: 0.0930019 Vali Loss: 0.1710187 Test Loss: 0.1583537
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 32 cost time: 0.9853661060333252
Epoch: 32, Steps: 64 | Train Loss: 0.0926049 Vali Loss: 0.1706080 Test Loss: 0.1561400
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 33 cost time: 1.010101079940796
Epoch: 33, Steps: 64 | Train Loss: 0.0926008 Vali Loss: 0.1695471 Test Loss: 0.1562515
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 34 cost time: 1.0083839893341064
Epoch: 34, Steps: 64 | Train Loss: 0.0931495 Vali Loss: 0.1710625 Test Loss: 0.1565656
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 35 cost time: 1.0074594020843506
Epoch: 35, Steps: 64 | Train Loss: 0.0931395 Vali Loss: 0.1678210 Test Loss: 0.1560457
Validation loss decreased (0.168603 --> 0.167821).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 36 cost time: 1.0054645538330078
Epoch: 36, Steps: 64 | Train Loss: 0.0927800 Vali Loss: 0.1694957 Test Loss: 0.1564536
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 37 cost time: 0.9943904876708984
Epoch: 37, Steps: 64 | Train Loss: 0.0926805 Vali Loss: 0.1688712 Test Loss: 0.1561763
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 38 cost time: 0.9754867553710938
Epoch: 38, Steps: 64 | Train Loss: 0.0923919 Vali Loss: 0.1677121 Test Loss: 0.1564696
Validation loss decreased (0.167821 --> 0.167712).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 39 cost time: 0.9788081645965576
Epoch: 39, Steps: 64 | Train Loss: 0.0923344 Vali Loss: 0.1689169 Test Loss: 0.1557997
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 40 cost time: 0.9707839488983154
Epoch: 40, Steps: 64 | Train Loss: 0.0924470 Vali Loss: 0.1696705 Test Loss: 0.1568500
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 41 cost time: 0.9728074073791504
Epoch: 41, Steps: 64 | Train Loss: 0.0926823 Vali Loss: 0.1688291 Test Loss: 0.1560428
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 42 cost time: 0.9846310615539551
Epoch: 42, Steps: 64 | Train Loss: 0.0926949 Vali Loss: 0.1686160 Test Loss: 0.1557186
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 43 cost time: 0.9806287288665771
Epoch: 43, Steps: 64 | Train Loss: 0.0922380 Vali Loss: 0.1693290 Test Loss: 0.1561252
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 44 cost time: 0.9954040050506592
Epoch: 44, Steps: 64 | Train Loss: 0.0924749 Vali Loss: 0.1704473 Test Loss: 0.1565281
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 45 cost time: 0.9838402271270752
Epoch: 45, Steps: 64 | Train Loss: 0.0924456 Vali Loss: 0.1680903 Test Loss: 0.1566529
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 46 cost time: 0.9853410720825195
Epoch: 46, Steps: 64 | Train Loss: 0.0923965 Vali Loss: 0.1691412 Test Loss: 0.1566400
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 47 cost time: 0.9772617816925049
Epoch: 47, Steps: 64 | Train Loss: 0.0919629 Vali Loss: 0.1669070 Test Loss: 0.1562057
Validation loss decreased (0.167712 --> 0.166907).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 48 cost time: 0.9933595657348633
Epoch: 48, Steps: 64 | Train Loss: 0.0921450 Vali Loss: 0.1703960 Test Loss: 0.1569300
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 49 cost time: 0.9945683479309082
Epoch: 49, Steps: 64 | Train Loss: 0.0921952 Vali Loss: 0.1713575 Test Loss: 0.1570051
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 50 cost time: 1.011357069015503
Epoch: 50, Steps: 64 | Train Loss: 0.0923131 Vali Loss: 0.1696230 Test Loss: 0.1568328
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 51 cost time: 1.0048162937164307
Epoch: 51, Steps: 64 | Train Loss: 0.0921164 Vali Loss: 0.1681994 Test Loss: 0.1570041
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 52 cost time: 1.0087697505950928
Epoch: 52, Steps: 64 | Train Loss: 0.0924863 Vali Loss: 0.1685123 Test Loss: 0.1564867
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 53 cost time: 1.011746883392334
Epoch: 53, Steps: 64 | Train Loss: 0.0926554 Vali Loss: 0.1673075 Test Loss: 0.1560255
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 54 cost time: 0.9789993762969971
Epoch: 54, Steps: 64 | Train Loss: 0.0921449 Vali Loss: 0.1680033 Test Loss: 0.1568952
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 55 cost time: 0.9806280136108398
Epoch: 55, Steps: 64 | Train Loss: 0.0923003 Vali Loss: 0.1703932 Test Loss: 0.1562186
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 56 cost time: 0.9906411170959473
Epoch: 56, Steps: 64 | Train Loss: 0.0918642 Vali Loss: 0.1704646 Test Loss: 0.1573358
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 57 cost time: 0.9659116268157959
Epoch: 57, Steps: 64 | Train Loss: 0.0919525 Vali Loss: 0.1694205 Test Loss: 0.1575143
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 58 cost time: 1.0283935070037842
Epoch: 58, Steps: 64 | Train Loss: 0.0921938 Vali Loss: 0.1687044 Test Loss: 0.1560194
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 59 cost time: 1.0025262832641602
Epoch: 59, Steps: 64 | Train Loss: 0.0921476 Vali Loss: 0.1692424 Test Loss: 0.1570099
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017604827880859375 GB
GPU已分配内存的峰值：0.03814363479614258 GB
Epoch: 60 cost time: 0.9954464435577393
Epoch: 60, Steps: 64 | Train Loss: 0.0921327 Vali Loss: 0.1669706 Test Loss: 0.1559234
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1562056988477707, mae:0.3035655617713928, rse:0.2103630155324936
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03948259353637695 GB
Epoch: 1 cost time: 2.3088488578796387
Epoch: 1, Steps: 64 | Train Loss: 0.8705142 Vali Loss: 1.7871163 Test Loss: 3.3209279
Validation loss decreased (inf --> 1.787116).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 2 cost time: 0.9161734580993652
Epoch: 2, Steps: 64 | Train Loss: 0.7232406 Vali Loss: 1.1932873 Test Loss: 2.1349235
Validation loss decreased (1.787116 --> 1.193287).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 3 cost time: 0.9083499908447266
Epoch: 3, Steps: 64 | Train Loss: 0.5149314 Vali Loss: 0.8364142 Test Loss: 1.3866389
Validation loss decreased (1.193287 --> 0.836414).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 4 cost time: 0.9133703708648682
Epoch: 4, Steps: 64 | Train Loss: 0.3698198 Vali Loss: 0.6056195 Test Loss: 0.9145768
Validation loss decreased (0.836414 --> 0.605620).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 5 cost time: 0.9048428535461426
Epoch: 5, Steps: 64 | Train Loss: 0.2849370 Vali Loss: 0.4832785 Test Loss: 0.6652545
Validation loss decreased (0.605620 --> 0.483279).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 6 cost time: 0.903662919998169
Epoch: 6, Steps: 64 | Train Loss: 0.2361712 Vali Loss: 0.4055556 Test Loss: 0.5159420
Validation loss decreased (0.483279 --> 0.405556).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 7 cost time: 0.8942837715148926
Epoch: 7, Steps: 64 | Train Loss: 0.2054601 Vali Loss: 0.3574537 Test Loss: 0.4218341
Validation loss decreased (0.405556 --> 0.357454).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 8 cost time: 0.9003989696502686
Epoch: 8, Steps: 64 | Train Loss: 0.1847799 Vali Loss: 0.3156067 Test Loss: 0.3498822
Validation loss decreased (0.357454 --> 0.315607).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 9 cost time: 0.8981101512908936
Epoch: 9, Steps: 64 | Train Loss: 0.1714822 Vali Loss: 0.2909528 Test Loss: 0.3092346
Validation loss decreased (0.315607 --> 0.290953).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 10 cost time: 0.9164352416992188
Epoch: 10, Steps: 64 | Train Loss: 0.1612411 Vali Loss: 0.2687123 Test Loss: 0.2763363
Validation loss decreased (0.290953 --> 0.268712).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 11 cost time: 0.9313440322875977
Epoch: 11, Steps: 64 | Train Loss: 0.1551918 Vali Loss: 0.2592227 Test Loss: 0.2548435
Validation loss decreased (0.268712 --> 0.259223).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 12 cost time: 0.9257690906524658
Epoch: 12, Steps: 64 | Train Loss: 0.1494655 Vali Loss: 0.2495227 Test Loss: 0.2410889
Validation loss decreased (0.259223 --> 0.249523).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 13 cost time: 0.9389996528625488
Epoch: 13, Steps: 64 | Train Loss: 0.1456794 Vali Loss: 0.2369687 Test Loss: 0.2246433
Validation loss decreased (0.249523 --> 0.236969).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 14 cost time: 0.9156394004821777
Epoch: 14, Steps: 64 | Train Loss: 0.1411526 Vali Loss: 0.2323561 Test Loss: 0.2164801
Validation loss decreased (0.236969 --> 0.232356).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 15 cost time: 0.9136314392089844
Epoch: 15, Steps: 64 | Train Loss: 0.1401449 Vali Loss: 0.2265179 Test Loss: 0.2099200
Validation loss decreased (0.232356 --> 0.226518).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 16 cost time: 0.9283721446990967
Epoch: 16, Steps: 64 | Train Loss: 0.1375057 Vali Loss: 0.2223185 Test Loss: 0.2042464
Validation loss decreased (0.226518 --> 0.222319).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 17 cost time: 0.9144043922424316
Epoch: 17, Steps: 64 | Train Loss: 0.1357472 Vali Loss: 0.2190644 Test Loss: 0.1997840
Validation loss decreased (0.222319 --> 0.219064).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 18 cost time: 0.9183704853057861
Epoch: 18, Steps: 64 | Train Loss: 0.1337131 Vali Loss: 0.2157066 Test Loss: 0.1955557
Validation loss decreased (0.219064 --> 0.215707).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 19 cost time: 0.9276707172393799
Epoch: 19, Steps: 64 | Train Loss: 0.1319055 Vali Loss: 0.2116479 Test Loss: 0.1930501
Validation loss decreased (0.215707 --> 0.211648).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 20 cost time: 0.9299595355987549
Epoch: 20, Steps: 64 | Train Loss: 0.1312091 Vali Loss: 0.2109150 Test Loss: 0.1909892
Validation loss decreased (0.211648 --> 0.210915).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 21 cost time: 0.9086463451385498
Epoch: 21, Steps: 64 | Train Loss: 0.1303862 Vali Loss: 0.2087793 Test Loss: 0.1892652
Validation loss decreased (0.210915 --> 0.208779).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 22 cost time: 0.9113421440124512
Epoch: 22, Steps: 64 | Train Loss: 0.1301088 Vali Loss: 0.2090543 Test Loss: 0.1880803
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 23 cost time: 0.9120001792907715
Epoch: 23, Steps: 64 | Train Loss: 0.1291746 Vali Loss: 0.2085126 Test Loss: 0.1874095
Validation loss decreased (0.208779 --> 0.208513).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 24 cost time: 0.9003617763519287
Epoch: 24, Steps: 64 | Train Loss: 0.1285618 Vali Loss: 0.2052018 Test Loss: 0.1850180
Validation loss decreased (0.208513 --> 0.205202).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 25 cost time: 0.8995165824890137
Epoch: 25, Steps: 64 | Train Loss: 0.1279508 Vali Loss: 0.2070204 Test Loss: 0.1859224
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 26 cost time: 0.9010016918182373
Epoch: 26, Steps: 64 | Train Loss: 0.1264570 Vali Loss: 0.2052915 Test Loss: 0.1839344
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 27 cost time: 0.9110007286071777
Epoch: 27, Steps: 64 | Train Loss: 0.1268631 Vali Loss: 0.2051197 Test Loss: 0.1841766
Validation loss decreased (0.205202 --> 0.205120).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 28 cost time: 0.9126121997833252
Epoch: 28, Steps: 64 | Train Loss: 0.1262302 Vali Loss: 0.2045916 Test Loss: 0.1824574
Validation loss decreased (0.205120 --> 0.204592).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 29 cost time: 0.9044253826141357
Epoch: 29, Steps: 64 | Train Loss: 0.1253690 Vali Loss: 0.2044635 Test Loss: 0.1845554
Validation loss decreased (0.204592 --> 0.204464).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 30 cost time: 0.9123597145080566
Epoch: 30, Steps: 64 | Train Loss: 0.1259898 Vali Loss: 0.2045139 Test Loss: 0.1825281
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 31 cost time: 0.926490068435669
Epoch: 31, Steps: 64 | Train Loss: 0.1254446 Vali Loss: 0.2029618 Test Loss: 0.1823960
Validation loss decreased (0.204464 --> 0.202962).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 32 cost time: 0.9147679805755615
Epoch: 32, Steps: 64 | Train Loss: 0.1253360 Vali Loss: 0.2008211 Test Loss: 0.1808103
Validation loss decreased (0.202962 --> 0.200821).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 33 cost time: 0.9103960990905762
Epoch: 33, Steps: 64 | Train Loss: 0.1243737 Vali Loss: 0.2015216 Test Loss: 0.1824148
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 34 cost time: 0.9206469058990479
Epoch: 34, Steps: 64 | Train Loss: 0.1245538 Vali Loss: 0.2002673 Test Loss: 0.1807393
Validation loss decreased (0.200821 --> 0.200267).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 35 cost time: 0.9113526344299316
Epoch: 35, Steps: 64 | Train Loss: 0.1238133 Vali Loss: 0.2021356 Test Loss: 0.1808740
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 36 cost time: 0.9304876327514648
Epoch: 36, Steps: 64 | Train Loss: 0.1241968 Vali Loss: 0.1982187 Test Loss: 0.1805077
Validation loss decreased (0.200267 --> 0.198219).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 37 cost time: 0.9383964538574219
Epoch: 37, Steps: 64 | Train Loss: 0.1234335 Vali Loss: 0.2010298 Test Loss: 0.1811568
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 38 cost time: 0.9290070533752441
Epoch: 38, Steps: 64 | Train Loss: 0.1229754 Vali Loss: 0.1977705 Test Loss: 0.1804016
Validation loss decreased (0.198219 --> 0.197771).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 39 cost time: 0.9287612438201904
Epoch: 39, Steps: 64 | Train Loss: 0.1234535 Vali Loss: 0.1996245 Test Loss: 0.1794412
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 40 cost time: 0.931999683380127
Epoch: 40, Steps: 64 | Train Loss: 0.1229688 Vali Loss: 0.1991063 Test Loss: 0.1791778
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 41 cost time: 0.9076423645019531
Epoch: 41, Steps: 64 | Train Loss: 0.1230957 Vali Loss: 0.1980451 Test Loss: 0.1788551
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 42 cost time: 0.9003777503967285
Epoch: 42, Steps: 64 | Train Loss: 0.1231908 Vali Loss: 0.1978048 Test Loss: 0.1780763
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 43 cost time: 0.891383171081543
Epoch: 43, Steps: 64 | Train Loss: 0.1231644 Vali Loss: 0.1997409 Test Loss: 0.1790628
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 44 cost time: 0.8974721431732178
Epoch: 44, Steps: 64 | Train Loss: 0.1221378 Vali Loss: 0.1994798 Test Loss: 0.1799414
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 45 cost time: 0.9067280292510986
Epoch: 45, Steps: 64 | Train Loss: 0.1227222 Vali Loss: 0.1976722 Test Loss: 0.1797889
Validation loss decreased (0.197771 --> 0.197672).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 46 cost time: 0.9163739681243896
Epoch: 46, Steps: 64 | Train Loss: 0.1227095 Vali Loss: 0.1997980 Test Loss: 0.1788032
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 47 cost time: 0.9158437252044678
Epoch: 47, Steps: 64 | Train Loss: 0.1225920 Vali Loss: 0.1984138 Test Loss: 0.1791649
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 48 cost time: 0.9048426151275635
Epoch: 48, Steps: 64 | Train Loss: 0.1226774 Vali Loss: 0.1979222 Test Loss: 0.1794712
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 49 cost time: 0.9039595127105713
Epoch: 49, Steps: 64 | Train Loss: 0.1225546 Vali Loss: 0.1951604 Test Loss: 0.1785188
Validation loss decreased (0.197672 --> 0.195160).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 50 cost time: 0.8983395099639893
Epoch: 50, Steps: 64 | Train Loss: 0.1224201 Vali Loss: 0.1971485 Test Loss: 0.1787446
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 51 cost time: 0.9150063991546631
Epoch: 51, Steps: 64 | Train Loss: 0.1216607 Vali Loss: 0.1974349 Test Loss: 0.1788641
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 52 cost time: 0.9137439727783203
Epoch: 52, Steps: 64 | Train Loss: 0.1231814 Vali Loss: 0.1987627 Test Loss: 0.1800193
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 53 cost time: 0.9149999618530273
Epoch: 53, Steps: 64 | Train Loss: 0.1228899 Vali Loss: 0.1969248 Test Loss: 0.1773920
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 54 cost time: 0.9296388626098633
Epoch: 54, Steps: 64 | Train Loss: 0.1226425 Vali Loss: 0.1970113 Test Loss: 0.1772829
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 55 cost time: 0.9410393238067627
Epoch: 55, Steps: 64 | Train Loss: 0.1223061 Vali Loss: 0.1984839 Test Loss: 0.1790181
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 56 cost time: 0.9243690967559814
Epoch: 56, Steps: 64 | Train Loss: 0.1229684 Vali Loss: 0.1987753 Test Loss: 0.1787674
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 57 cost time: 0.9294180870056152
Epoch: 57, Steps: 64 | Train Loss: 0.1223937 Vali Loss: 0.1975388 Test Loss: 0.1773975
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 58 cost time: 0.9394099712371826
Epoch: 58, Steps: 64 | Train Loss: 0.1221604 Vali Loss: 0.1946961 Test Loss: 0.1783215
Validation loss decreased (0.195160 --> 0.194696).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 59 cost time: 0.9181087017059326
Epoch: 59, Steps: 64 | Train Loss: 0.1223649 Vali Loss: 0.1961171 Test Loss: 0.1780518
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017621994018554688 GB
GPU已分配内存的峰值：0.03996467590332031 GB
Epoch: 60 cost time: 0.9143538475036621
Epoch: 60, Steps: 64 | Train Loss: 0.1222537 Vali Loss: 0.1988931 Test Loss: 0.1799906
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.17832143604755402, mae:0.3320145010948181, rse:0.22476191818714142
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.04018402099609375 GB
Epoch: 1 cost time: 2.3160629272460938
Epoch: 1, Steps: 64 | Train Loss: 0.7720157 Vali Loss: 1.7460352 Test Loss: 3.2712839
Validation loss decreased (inf --> 1.746035).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 2 cost time: 0.9419980049133301
Epoch: 2, Steps: 64 | Train Loss: 0.6169171 Vali Loss: 1.0748514 Test Loss: 1.8917527
Validation loss decreased (1.746035 --> 1.074851).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 3 cost time: 0.9356341361999512
Epoch: 3, Steps: 64 | Train Loss: 0.3835213 Vali Loss: 0.6422364 Test Loss: 1.0110576
Validation loss decreased (1.074851 --> 0.642236).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 4 cost time: 0.936633825302124
Epoch: 4, Steps: 64 | Train Loss: 0.2417931 Vali Loss: 0.3962230 Test Loss: 0.5249690
Validation loss decreased (0.642236 --> 0.396223).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 5 cost time: 0.951714277267456
Epoch: 5, Steps: 64 | Train Loss: 0.1703678 Vali Loss: 0.2915781 Test Loss: 0.3219914
Validation loss decreased (0.396223 --> 0.291578).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 6 cost time: 0.9276394844055176
Epoch: 6, Steps: 64 | Train Loss: 0.1393260 Vali Loss: 0.2433318 Test Loss: 0.2371783
Validation loss decreased (0.291578 --> 0.243332).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 7 cost time: 0.9183933734893799
Epoch: 7, Steps: 64 | Train Loss: 0.1259384 Vali Loss: 0.2209042 Test Loss: 0.2032175
Validation loss decreased (0.243332 --> 0.220904).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 8 cost time: 0.922429084777832
Epoch: 8, Steps: 64 | Train Loss: 0.1200538 Vali Loss: 0.2154643 Test Loss: 0.1920878
Validation loss decreased (0.220904 --> 0.215464).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 9 cost time: 0.9278018474578857
Epoch: 9, Steps: 64 | Train Loss: 0.1154941 Vali Loss: 0.2091702 Test Loss: 0.1840891
Validation loss decreased (0.215464 --> 0.209170).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 10 cost time: 0.9474222660064697
Epoch: 10, Steps: 64 | Train Loss: 0.1125257 Vali Loss: 0.2018511 Test Loss: 0.1776835
Validation loss decreased (0.209170 --> 0.201851).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 11 cost time: 0.9602782726287842
Epoch: 11, Steps: 64 | Train Loss: 0.1108175 Vali Loss: 0.2014928 Test Loss: 0.1764039
Validation loss decreased (0.201851 --> 0.201493).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 12 cost time: 0.9666378498077393
Epoch: 12, Steps: 64 | Train Loss: 0.1089234 Vali Loss: 0.2000497 Test Loss: 0.1728869
Validation loss decreased (0.201493 --> 0.200050).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 13 cost time: 0.9565036296844482
Epoch: 13, Steps: 64 | Train Loss: 0.1079130 Vali Loss: 0.1954778 Test Loss: 0.1713171
Validation loss decreased (0.200050 --> 0.195478).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 14 cost time: 0.9483861923217773
Epoch: 14, Steps: 64 | Train Loss: 0.1061473 Vali Loss: 0.1941782 Test Loss: 0.1712771
Validation loss decreased (0.195478 --> 0.194178).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 15 cost time: 0.9717040061950684
Epoch: 15, Steps: 64 | Train Loss: 0.1057516 Vali Loss: 0.1933535 Test Loss: 0.1702060
Validation loss decreased (0.194178 --> 0.193353).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 16 cost time: 0.941716194152832
Epoch: 16, Steps: 64 | Train Loss: 0.1046006 Vali Loss: 0.1907535 Test Loss: 0.1684179
Validation loss decreased (0.193353 --> 0.190754).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 17 cost time: 0.9324102401733398
Epoch: 17, Steps: 64 | Train Loss: 0.1037242 Vali Loss: 0.1933369 Test Loss: 0.1688022
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 18 cost time: 0.95713210105896
Epoch: 18, Steps: 64 | Train Loss: 0.1028668 Vali Loss: 0.1907858 Test Loss: 0.1681421
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 19 cost time: 0.9552609920501709
Epoch: 19, Steps: 64 | Train Loss: 0.1033024 Vali Loss: 0.1920304 Test Loss: 0.1678847
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 20 cost time: 0.9376344680786133
Epoch: 20, Steps: 64 | Train Loss: 0.1023081 Vali Loss: 0.1900804 Test Loss: 0.1670609
Validation loss decreased (0.190754 --> 0.190080).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 21 cost time: 0.9414148330688477
Epoch: 21, Steps: 64 | Train Loss: 0.1015787 Vali Loss: 0.1884293 Test Loss: 0.1667124
Validation loss decreased (0.190080 --> 0.188429).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 22 cost time: 0.9377398490905762
Epoch: 22, Steps: 64 | Train Loss: 0.1015566 Vali Loss: 0.1901200 Test Loss: 0.1662433
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 23 cost time: 0.9264712333679199
Epoch: 23, Steps: 64 | Train Loss: 0.1011026 Vali Loss: 0.1889046 Test Loss: 0.1665328
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 24 cost time: 0.9287548065185547
Epoch: 24, Steps: 64 | Train Loss: 0.1009417 Vali Loss: 0.1862189 Test Loss: 0.1665804
Validation loss decreased (0.188429 --> 0.186219).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 25 cost time: 0.9238157272338867
Epoch: 25, Steps: 64 | Train Loss: 0.1002702 Vali Loss: 0.1899685 Test Loss: 0.1672094
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 26 cost time: 0.9270012378692627
Epoch: 26, Steps: 64 | Train Loss: 0.1001098 Vali Loss: 0.1886625 Test Loss: 0.1664687
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 27 cost time: 0.9336366653442383
Epoch: 27, Steps: 64 | Train Loss: 0.0999550 Vali Loss: 0.1881035 Test Loss: 0.1657833
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 28 cost time: 0.9363620281219482
Epoch: 28, Steps: 64 | Train Loss: 0.0997766 Vali Loss: 0.1883415 Test Loss: 0.1668564
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 29 cost time: 0.9483928680419922
Epoch: 29, Steps: 64 | Train Loss: 0.0999599 Vali Loss: 0.1873737 Test Loss: 0.1665283
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 30 cost time: 0.9634039402008057
Epoch: 30, Steps: 64 | Train Loss: 0.0994267 Vali Loss: 0.1873445 Test Loss: 0.1669620
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 31 cost time: 0.9417510032653809
Epoch: 31, Steps: 64 | Train Loss: 0.0988738 Vali Loss: 0.1846318 Test Loss: 0.1655291
Validation loss decreased (0.186219 --> 0.184632).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 32 cost time: 0.9363875389099121
Epoch: 32, Steps: 64 | Train Loss: 0.0994175 Vali Loss: 0.1868846 Test Loss: 0.1650167
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 33 cost time: 0.9327445030212402
Epoch: 33, Steps: 64 | Train Loss: 0.0987867 Vali Loss: 0.1860213 Test Loss: 0.1659882
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 34 cost time: 0.9400002956390381
Epoch: 34, Steps: 64 | Train Loss: 0.0990865 Vali Loss: 0.1850743 Test Loss: 0.1657162
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 35 cost time: 0.947068452835083
Epoch: 35, Steps: 64 | Train Loss: 0.0985712 Vali Loss: 0.1847965 Test Loss: 0.1656384
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 36 cost time: 0.9613299369812012
Epoch: 36, Steps: 64 | Train Loss: 0.0985668 Vali Loss: 0.1849504 Test Loss: 0.1661310
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 37 cost time: 0.9593617916107178
Epoch: 37, Steps: 64 | Train Loss: 0.0986239 Vali Loss: 0.1849715 Test Loss: 0.1648277
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 38 cost time: 0.9604513645172119
Epoch: 38, Steps: 64 | Train Loss: 0.0983969 Vali Loss: 0.1852479 Test Loss: 0.1643540
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 39 cost time: 0.9543373584747314
Epoch: 39, Steps: 64 | Train Loss: 0.0987424 Vali Loss: 0.1855620 Test Loss: 0.1645476
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 40 cost time: 0.9192330837249756
Epoch: 40, Steps: 64 | Train Loss: 0.0983145 Vali Loss: 0.1869097 Test Loss: 0.1656108
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 41 cost time: 0.9197254180908203
Epoch: 41, Steps: 64 | Train Loss: 0.0987074 Vali Loss: 0.1859588 Test Loss: 0.1646366
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 42 cost time: 0.9229986667633057
Epoch: 42, Steps: 64 | Train Loss: 0.0984208 Vali Loss: 0.1866102 Test Loss: 0.1661247
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 43 cost time: 0.9326364994049072
Epoch: 43, Steps: 64 | Train Loss: 0.0983968 Vali Loss: 0.1857286 Test Loss: 0.1653708
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 44 cost time: 0.9294629096984863
Epoch: 44, Steps: 64 | Train Loss: 0.0986156 Vali Loss: 0.1849902 Test Loss: 0.1654103
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 45 cost time: 0.9294164180755615
Epoch: 45, Steps: 64 | Train Loss: 0.0984766 Vali Loss: 0.1852549 Test Loss: 0.1660196
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 46 cost time: 0.9433598518371582
Epoch: 46, Steps: 64 | Train Loss: 0.0985009 Vali Loss: 0.1856474 Test Loss: 0.1648766
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 47 cost time: 0.9404544830322266
Epoch: 47, Steps: 64 | Train Loss: 0.0986002 Vali Loss: 0.1870242 Test Loss: 0.1662602
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 48 cost time: 0.9324436187744141
Epoch: 48, Steps: 64 | Train Loss: 0.0984023 Vali Loss: 0.1848866 Test Loss: 0.1654830
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 49 cost time: 0.931999921798706
Epoch: 49, Steps: 64 | Train Loss: 0.0980227 Vali Loss: 0.1854861 Test Loss: 0.1649500
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 50 cost time: 0.9566328525543213
Epoch: 50, Steps: 64 | Train Loss: 0.0983634 Vali Loss: 0.1838067 Test Loss: 0.1654437
Validation loss decreased (0.184632 --> 0.183807).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 51 cost time: 0.9433541297912598
Epoch: 51, Steps: 64 | Train Loss: 0.0980284 Vali Loss: 0.1844418 Test Loss: 0.1653878
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 52 cost time: 0.9376270771026611
Epoch: 52, Steps: 64 | Train Loss: 0.0977461 Vali Loss: 0.1840018 Test Loss: 0.1657426
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 53 cost time: 0.9540746212005615
Epoch: 53, Steps: 64 | Train Loss: 0.0980619 Vali Loss: 0.1841322 Test Loss: 0.1649279
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 54 cost time: 0.9554059505462646
Epoch: 54, Steps: 64 | Train Loss: 0.0983192 Vali Loss: 0.1853799 Test Loss: 0.1651737
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 55 cost time: 0.9533495903015137
Epoch: 55, Steps: 64 | Train Loss: 0.0983388 Vali Loss: 0.1871422 Test Loss: 0.1649009
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 56 cost time: 0.9597489833831787
Epoch: 56, Steps: 64 | Train Loss: 0.0982777 Vali Loss: 0.1839254 Test Loss: 0.1652439
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 57 cost time: 0.9243650436401367
Epoch: 57, Steps: 64 | Train Loss: 0.0981906 Vali Loss: 0.1852146 Test Loss: 0.1654356
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 58 cost time: 0.9546465873718262
Epoch: 58, Steps: 64 | Train Loss: 0.0980351 Vali Loss: 0.1870989 Test Loss: 0.1652538
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 59 cost time: 0.950502872467041
Epoch: 59, Steps: 64 | Train Loss: 0.0983800 Vali Loss: 0.1833596 Test Loss: 0.1652256
Validation loss decreased (0.183807 --> 0.183360).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017660140991210938 GB
GPU已分配内存的峰值：0.0407257080078125 GB
Epoch: 60 cost time: 0.9452111721038818
Epoch: 60, Steps: 64 | Train Loss: 0.0980223 Vali Loss: 0.1864305 Test Loss: 0.1664491
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.16522559523582458, mae:0.31307750940322876, rse:0.21635136008262634
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04074811935424805 GB
Epoch: 1 cost time: 2.3640804290771484
Epoch: 1, Steps: 64 | Train Loss: 0.7573729 Vali Loss: 1.7271769 Test Loss: 3.3160319
Validation loss decreased (inf --> 1.727177).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 2 cost time: 0.9746155738830566
Epoch: 2, Steps: 64 | Train Loss: 0.6233345 Vali Loss: 1.1256551 Test Loss: 2.0387914
Validation loss decreased (1.727177 --> 1.125655).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 3 cost time: 0.9584126472473145
Epoch: 3, Steps: 64 | Train Loss: 0.3926833 Vali Loss: 0.6284435 Test Loss: 1.0011864
Validation loss decreased (1.125655 --> 0.628443).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 4 cost time: 0.9524147510528564
Epoch: 4, Steps: 64 | Train Loss: 0.2255411 Vali Loss: 0.3336678 Test Loss: 0.4012784
Validation loss decreased (0.628443 --> 0.333668).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 5 cost time: 0.9300782680511475
Epoch: 5, Steps: 64 | Train Loss: 0.1499037 Vali Loss: 0.2393360 Test Loss: 0.2335286
Validation loss decreased (0.333668 --> 0.239336).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 6 cost time: 0.9427967071533203
Epoch: 6, Steps: 64 | Train Loss: 0.1293162 Vali Loss: 0.2131227 Test Loss: 0.1916169
Validation loss decreased (0.239336 --> 0.213123).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 7 cost time: 0.9269092082977295
Epoch: 7, Steps: 64 | Train Loss: 0.1220632 Vali Loss: 0.2030023 Test Loss: 0.1779491
Validation loss decreased (0.213123 --> 0.203002).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 8 cost time: 0.929999589920044
Epoch: 8, Steps: 64 | Train Loss: 0.1174630 Vali Loss: 0.1956476 Test Loss: 0.1700108
Validation loss decreased (0.203002 --> 0.195648).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 9 cost time: 0.942633867263794
Epoch: 9, Steps: 64 | Train Loss: 0.1135461 Vali Loss: 0.1905152 Test Loss: 0.1641772
Validation loss decreased (0.195648 --> 0.190515).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 10 cost time: 0.9736254215240479
Epoch: 10, Steps: 64 | Train Loss: 0.1114393 Vali Loss: 0.1889736 Test Loss: 0.1620069
Validation loss decreased (0.190515 --> 0.188974).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 11 cost time: 0.9875690937042236
Epoch: 11, Steps: 64 | Train Loss: 0.1095341 Vali Loss: 0.1888236 Test Loss: 0.1601957
Validation loss decreased (0.188974 --> 0.188824).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 12 cost time: 0.9893519878387451
Epoch: 12, Steps: 64 | Train Loss: 0.1077697 Vali Loss: 0.1853663 Test Loss: 0.1589478
Validation loss decreased (0.188824 --> 0.185366).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 13 cost time: 0.9823787212371826
Epoch: 13, Steps: 64 | Train Loss: 0.1062322 Vali Loss: 0.1848836 Test Loss: 0.1576702
Validation loss decreased (0.185366 --> 0.184884).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 14 cost time: 0.9618546962738037
Epoch: 14, Steps: 64 | Train Loss: 0.1050260 Vali Loss: 0.1852145 Test Loss: 0.1566945
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 15 cost time: 0.955359935760498
Epoch: 15, Steps: 64 | Train Loss: 0.1045986 Vali Loss: 0.1829806 Test Loss: 0.1558583
Validation loss decreased (0.184884 --> 0.182981).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 16 cost time: 0.9615957736968994
Epoch: 16, Steps: 64 | Train Loss: 0.1032195 Vali Loss: 0.1813929 Test Loss: 0.1562653
Validation loss decreased (0.182981 --> 0.181393).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 17 cost time: 0.9560000896453857
Epoch: 17, Steps: 64 | Train Loss: 0.1023211 Vali Loss: 0.1797738 Test Loss: 0.1553314
Validation loss decreased (0.181393 --> 0.179774).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 18 cost time: 0.9804317951202393
Epoch: 18, Steps: 64 | Train Loss: 0.1020740 Vali Loss: 0.1795326 Test Loss: 0.1561108
Validation loss decreased (0.179774 --> 0.179533).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 19 cost time: 0.9676332473754883
Epoch: 19, Steps: 64 | Train Loss: 0.1011852 Vali Loss: 0.1793843 Test Loss: 0.1553492
Validation loss decreased (0.179533 --> 0.179384).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 20 cost time: 0.9510092735290527
Epoch: 20, Steps: 64 | Train Loss: 0.1010712 Vali Loss: 0.1794803 Test Loss: 0.1548212
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 21 cost time: 0.9547748565673828
Epoch: 21, Steps: 64 | Train Loss: 0.1008043 Vali Loss: 0.1800247 Test Loss: 0.1547746
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 22 cost time: 0.9383633136749268
Epoch: 22, Steps: 64 | Train Loss: 0.1000112 Vali Loss: 0.1784066 Test Loss: 0.1552023
Validation loss decreased (0.179384 --> 0.178407).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 23 cost time: 0.9388666152954102
Epoch: 23, Steps: 64 | Train Loss: 0.0999527 Vali Loss: 0.1787459 Test Loss: 0.1547709
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 24 cost time: 0.927739143371582
Epoch: 24, Steps: 64 | Train Loss: 0.0997714 Vali Loss: 0.1779145 Test Loss: 0.1553398
Validation loss decreased (0.178407 --> 0.177915).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 25 cost time: 0.9323422908782959
Epoch: 25, Steps: 64 | Train Loss: 0.0994447 Vali Loss: 0.1788599 Test Loss: 0.1552210
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 26 cost time: 0.9414701461791992
Epoch: 26, Steps: 64 | Train Loss: 0.0993579 Vali Loss: 0.1796348 Test Loss: 0.1555791
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 27 cost time: 0.9486401081085205
Epoch: 27, Steps: 64 | Train Loss: 0.0988216 Vali Loss: 0.1769397 Test Loss: 0.1548451
Validation loss decreased (0.177915 --> 0.176940).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 28 cost time: 0.9553811550140381
Epoch: 28, Steps: 64 | Train Loss: 0.0984205 Vali Loss: 0.1771074 Test Loss: 0.1553104
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 29 cost time: 0.9774212837219238
Epoch: 29, Steps: 64 | Train Loss: 0.0983466 Vali Loss: 0.1768287 Test Loss: 0.1557928
Validation loss decreased (0.176940 --> 0.176829).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 30 cost time: 0.980088472366333
Epoch: 30, Steps: 64 | Train Loss: 0.0984023 Vali Loss: 0.1773981 Test Loss: 0.1553994
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 31 cost time: 0.9554381370544434
Epoch: 31, Steps: 64 | Train Loss: 0.0980442 Vali Loss: 0.1774567 Test Loss: 0.1552867
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 32 cost time: 0.9597301483154297
Epoch: 32, Steps: 64 | Train Loss: 0.0979179 Vali Loss: 0.1794285 Test Loss: 0.1552293
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 33 cost time: 0.9657840728759766
Epoch: 33, Steps: 64 | Train Loss: 0.0977649 Vali Loss: 0.1773321 Test Loss: 0.1552927
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 34 cost time: 0.9560017585754395
Epoch: 34, Steps: 64 | Train Loss: 0.0978563 Vali Loss: 0.1767551 Test Loss: 0.1551137
Validation loss decreased (0.176829 --> 0.176755).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 35 cost time: 0.9774484634399414
Epoch: 35, Steps: 64 | Train Loss: 0.0976948 Vali Loss: 0.1778989 Test Loss: 0.1558970
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 36 cost time: 0.9876418113708496
Epoch: 36, Steps: 64 | Train Loss: 0.0975317 Vali Loss: 0.1772605 Test Loss: 0.1551411
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 37 cost time: 0.9955489635467529
Epoch: 37, Steps: 64 | Train Loss: 0.0975844 Vali Loss: 0.1790059 Test Loss: 0.1556482
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 38 cost time: 0.9685249328613281
Epoch: 38, Steps: 64 | Train Loss: 0.0975907 Vali Loss: 0.1758966 Test Loss: 0.1555280
Validation loss decreased (0.176755 --> 0.175897).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 39 cost time: 0.9449660778045654
Epoch: 39, Steps: 64 | Train Loss: 0.0973529 Vali Loss: 0.1781881 Test Loss: 0.1558204
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 40 cost time: 0.9374313354492188
Epoch: 40, Steps: 64 | Train Loss: 0.0971820 Vali Loss: 0.1778294 Test Loss: 0.1560587
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 41 cost time: 0.9306323528289795
Epoch: 41, Steps: 64 | Train Loss: 0.0972117 Vali Loss: 0.1776576 Test Loss: 0.1554191
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 42 cost time: 0.9241816997528076
Epoch: 42, Steps: 64 | Train Loss: 0.0975604 Vali Loss: 0.1748931 Test Loss: 0.1550569
Validation loss decreased (0.175897 --> 0.174893).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 43 cost time: 0.9293911457061768
Epoch: 43, Steps: 64 | Train Loss: 0.0971706 Vali Loss: 0.1780914 Test Loss: 0.1551068
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 44 cost time: 0.9576444625854492
Epoch: 44, Steps: 64 | Train Loss: 0.0970355 Vali Loss: 0.1773903 Test Loss: 0.1557006
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 45 cost time: 0.949408769607544
Epoch: 45, Steps: 64 | Train Loss: 0.0972457 Vali Loss: 0.1781493 Test Loss: 0.1558757
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 46 cost time: 0.94936203956604
Epoch: 46, Steps: 64 | Train Loss: 0.0975392 Vali Loss: 0.1751623 Test Loss: 0.1554797
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 47 cost time: 0.9620051383972168
Epoch: 47, Steps: 64 | Train Loss: 0.0975173 Vali Loss: 0.1769444 Test Loss: 0.1552490
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 48 cost time: 0.961491584777832
Epoch: 48, Steps: 64 | Train Loss: 0.0972077 Vali Loss: 0.1750796 Test Loss: 0.1556598
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 49 cost time: 0.9747452735900879
Epoch: 49, Steps: 64 | Train Loss: 0.0969891 Vali Loss: 0.1762613 Test Loss: 0.1560313
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 50 cost time: 0.9783861637115479
Epoch: 50, Steps: 64 | Train Loss: 0.0972044 Vali Loss: 0.1769916 Test Loss: 0.1556690
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 51 cost time: 0.9652493000030518
Epoch: 51, Steps: 64 | Train Loss: 0.0972932 Vali Loss: 0.1766352 Test Loss: 0.1561098
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 52 cost time: 0.9769992828369141
Epoch: 52, Steps: 64 | Train Loss: 0.0967906 Vali Loss: 0.1790445 Test Loss: 0.1554767
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 53 cost time: 0.9816334247589111
Epoch: 53, Steps: 64 | Train Loss: 0.0969580 Vali Loss: 0.1747406 Test Loss: 0.1552934
Validation loss decreased (0.174893 --> 0.174741).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 54 cost time: 1.0047070980072021
Epoch: 54, Steps: 64 | Train Loss: 0.0971533 Vali Loss: 0.1762328 Test Loss: 0.1553358
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 55 cost time: 0.9808895587921143
Epoch: 55, Steps: 64 | Train Loss: 0.0973066 Vali Loss: 0.1785136 Test Loss: 0.1565924
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 56 cost time: 0.9723823070526123
Epoch: 56, Steps: 64 | Train Loss: 0.0970618 Vali Loss: 0.1756006 Test Loss: 0.1553470
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 57 cost time: 0.9554412364959717
Epoch: 57, Steps: 64 | Train Loss: 0.0972968 Vali Loss: 0.1774030 Test Loss: 0.1560161
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 58 cost time: 0.9311318397521973
Epoch: 58, Steps: 64 | Train Loss: 0.0969842 Vali Loss: 0.1776182 Test Loss: 0.1558566
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 59 cost time: 0.931732177734375
Epoch: 59, Steps: 64 | Train Loss: 0.0964190 Vali Loss: 0.1750105 Test Loss: 0.1548943
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017683029174804688 GB
GPU已分配内存的峰值：0.04147529602050781 GB
Epoch: 60 cost time: 0.9437313079833984
Epoch: 60, Steps: 64 | Train Loss: 0.0970470 Vali Loss: 0.1769961 Test Loss: 0.1557032
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15529336035251617, mae:0.30021536350250244, rse:0.2097478061914444
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.03964376449584961 GB
Epoch: 1 cost time: 2.36807918548584
Epoch: 1, Steps: 64 | Train Loss: 1.0948528 Vali Loss: 2.1864982 Test Loss: 4.3234191
Validation loss decreased (inf --> 2.186498).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 2 cost time: 0.9438703060150146
Epoch: 2, Steps: 64 | Train Loss: 0.8549636 Vali Loss: 1.2346884 Test Loss: 2.3044612
Validation loss decreased (2.186498 --> 1.234688).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 3 cost time: 0.9279987812042236
Epoch: 3, Steps: 64 | Train Loss: 0.5008412 Vali Loss: 0.6809784 Test Loss: 1.1302416
Validation loss decreased (1.234688 --> 0.680978).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 4 cost time: 0.9126455783843994
Epoch: 4, Steps: 64 | Train Loss: 0.3203750 Vali Loss: 0.4902475 Test Loss: 0.7307614
Validation loss decreased (0.680978 --> 0.490248).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 5 cost time: 0.9250495433807373
Epoch: 5, Steps: 64 | Train Loss: 0.2507689 Vali Loss: 0.4035486 Test Loss: 0.5543450
Validation loss decreased (0.490248 --> 0.403549).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 6 cost time: 0.9265942573547363
Epoch: 6, Steps: 64 | Train Loss: 0.2146592 Vali Loss: 0.3471673 Test Loss: 0.4398834
Validation loss decreased (0.403549 --> 0.347167).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 7 cost time: 0.9204871654510498
Epoch: 7, Steps: 64 | Train Loss: 0.1910145 Vali Loss: 0.3102844 Test Loss: 0.3730147
Validation loss decreased (0.347167 --> 0.310284).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 8 cost time: 0.8863787651062012
Epoch: 8, Steps: 64 | Train Loss: 0.1756833 Vali Loss: 0.2855156 Test Loss: 0.3260951
Validation loss decreased (0.310284 --> 0.285516).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 9 cost time: 0.903599739074707
Epoch: 9, Steps: 64 | Train Loss: 0.1650137 Vali Loss: 0.2642524 Test Loss: 0.2932316
Validation loss decreased (0.285516 --> 0.264252).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 10 cost time: 0.9261598587036133
Epoch: 10, Steps: 64 | Train Loss: 0.1560432 Vali Loss: 0.2536347 Test Loss: 0.2698385
Validation loss decreased (0.264252 --> 0.253635).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 11 cost time: 0.9406530857086182
Epoch: 11, Steps: 64 | Train Loss: 0.1490975 Vali Loss: 0.2395991 Test Loss: 0.2501151
Validation loss decreased (0.253635 --> 0.239599).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 12 cost time: 0.9386382102966309
Epoch: 12, Steps: 64 | Train Loss: 0.1446555 Vali Loss: 0.2320471 Test Loss: 0.2350540
Validation loss decreased (0.239599 --> 0.232047).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 13 cost time: 0.9323663711547852
Epoch: 13, Steps: 64 | Train Loss: 0.1402969 Vali Loss: 0.2256292 Test Loss: 0.2234127
Validation loss decreased (0.232047 --> 0.225629).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 14 cost time: 0.9210004806518555
Epoch: 14, Steps: 64 | Train Loss: 0.1378608 Vali Loss: 0.2204946 Test Loss: 0.2155636
Validation loss decreased (0.225629 --> 0.220495).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 15 cost time: 0.9346117973327637
Epoch: 15, Steps: 64 | Train Loss: 0.1354708 Vali Loss: 0.2124708 Test Loss: 0.2061894
Validation loss decreased (0.220495 --> 0.212471).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 16 cost time: 0.938443660736084
Epoch: 16, Steps: 64 | Train Loss: 0.1327556 Vali Loss: 0.2073331 Test Loss: 0.2018608
Validation loss decreased (0.212471 --> 0.207333).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 17 cost time: 0.9460644721984863
Epoch: 17, Steps: 64 | Train Loss: 0.1312514 Vali Loss: 0.2064091 Test Loss: 0.1977586
Validation loss decreased (0.207333 --> 0.206409).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 18 cost time: 0.9249997138977051
Epoch: 18, Steps: 64 | Train Loss: 0.1290163 Vali Loss: 0.2033465 Test Loss: 0.1930937
Validation loss decreased (0.206409 --> 0.203347).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 19 cost time: 0.9402737617492676
Epoch: 19, Steps: 64 | Train Loss: 0.1279544 Vali Loss: 0.2011947 Test Loss: 0.1902142
Validation loss decreased (0.203347 --> 0.201195).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 20 cost time: 0.9410004615783691
Epoch: 20, Steps: 64 | Train Loss: 0.1266253 Vali Loss: 0.1987433 Test Loss: 0.1879354
Validation loss decreased (0.201195 --> 0.198743).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 21 cost time: 0.9294312000274658
Epoch: 21, Steps: 64 | Train Loss: 0.1257201 Vali Loss: 0.1974958 Test Loss: 0.1853688
Validation loss decreased (0.198743 --> 0.197496).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 22 cost time: 0.9064593315124512
Epoch: 22, Steps: 64 | Train Loss: 0.1248834 Vali Loss: 0.1925136 Test Loss: 0.1831352
Validation loss decreased (0.197496 --> 0.192514).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 23 cost time: 0.8891012668609619
Epoch: 23, Steps: 64 | Train Loss: 0.1244219 Vali Loss: 0.1946735 Test Loss: 0.1815423
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 24 cost time: 0.8994643688201904
Epoch: 24, Steps: 64 | Train Loss: 0.1237930 Vali Loss: 0.1936262 Test Loss: 0.1809094
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 25 cost time: 0.9358386993408203
Epoch: 25, Steps: 64 | Train Loss: 0.1231028 Vali Loss: 0.1926576 Test Loss: 0.1805231
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 26 cost time: 0.9270014762878418
Epoch: 26, Steps: 64 | Train Loss: 0.1229877 Vali Loss: 0.1929201 Test Loss: 0.1775906
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 27 cost time: 0.9116246700286865
Epoch: 27, Steps: 64 | Train Loss: 0.1218636 Vali Loss: 0.1910196 Test Loss: 0.1766119
Validation loss decreased (0.192514 --> 0.191020).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 28 cost time: 0.8906903266906738
Epoch: 28, Steps: 64 | Train Loss: 0.1214347 Vali Loss: 0.1904421 Test Loss: 0.1756692
Validation loss decreased (0.191020 --> 0.190442).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 29 cost time: 0.9120399951934814
Epoch: 29, Steps: 64 | Train Loss: 0.1204267 Vali Loss: 0.1895237 Test Loss: 0.1756750
Validation loss decreased (0.190442 --> 0.189524).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 30 cost time: 0.9184129238128662
Epoch: 30, Steps: 64 | Train Loss: 0.1207285 Vali Loss: 0.1885826 Test Loss: 0.1752734
Validation loss decreased (0.189524 --> 0.188583).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 31 cost time: 0.9174816608428955
Epoch: 31, Steps: 64 | Train Loss: 0.1204425 Vali Loss: 0.1874328 Test Loss: 0.1730271
Validation loss decreased (0.188583 --> 0.187433).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 32 cost time: 0.9149410724639893
Epoch: 32, Steps: 64 | Train Loss: 0.1194846 Vali Loss: 0.1873200 Test Loss: 0.1742028
Validation loss decreased (0.187433 --> 0.187320).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 33 cost time: 0.9169998168945312
Epoch: 33, Steps: 64 | Train Loss: 0.1203956 Vali Loss: 0.1860445 Test Loss: 0.1731635
Validation loss decreased (0.187320 --> 0.186044).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 34 cost time: 0.919302225112915
Epoch: 34, Steps: 64 | Train Loss: 0.1200044 Vali Loss: 0.1842195 Test Loss: 0.1719272
Validation loss decreased (0.186044 --> 0.184219).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 35 cost time: 0.9315304756164551
Epoch: 35, Steps: 64 | Train Loss: 0.1185434 Vali Loss: 0.1851981 Test Loss: 0.1723651
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 36 cost time: 0.9413771629333496
Epoch: 36, Steps: 64 | Train Loss: 0.1194337 Vali Loss: 0.1889461 Test Loss: 0.1718464
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 37 cost time: 0.9313669204711914
Epoch: 37, Steps: 64 | Train Loss: 0.1189739 Vali Loss: 0.1853896 Test Loss: 0.1708102
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 38 cost time: 0.9447598457336426
Epoch: 38, Steps: 64 | Train Loss: 0.1186589 Vali Loss: 0.1846344 Test Loss: 0.1705118
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 39 cost time: 0.9557991027832031
Epoch: 39, Steps: 64 | Train Loss: 0.1187110 Vali Loss: 0.1865502 Test Loss: 0.1707723
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 40 cost time: 0.9306371212005615
Epoch: 40, Steps: 64 | Train Loss: 0.1188031 Vali Loss: 0.1876371 Test Loss: 0.1713678
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 41 cost time: 0.9286627769470215
Epoch: 41, Steps: 64 | Train Loss: 0.1191855 Vali Loss: 0.1858939 Test Loss: 0.1684636
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 42 cost time: 0.8886418342590332
Epoch: 42, Steps: 64 | Train Loss: 0.1183094 Vali Loss: 0.1844126 Test Loss: 0.1706344
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 43 cost time: 0.8889148235321045
Epoch: 43, Steps: 64 | Train Loss: 0.1181943 Vali Loss: 0.1873296 Test Loss: 0.1719017
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 44 cost time: 0.8975582122802734
Epoch: 44, Steps: 64 | Train Loss: 0.1181043 Vali Loss: 0.1843409 Test Loss: 0.1705394
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 45 cost time: 0.9230353832244873
Epoch: 45, Steps: 64 | Train Loss: 0.1189055 Vali Loss: 0.1846628 Test Loss: 0.1704517
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 46 cost time: 0.9117178916931152
Epoch: 46, Steps: 64 | Train Loss: 0.1180651 Vali Loss: 0.1847737 Test Loss: 0.1699435
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 47 cost time: 0.9110004901885986
Epoch: 47, Steps: 64 | Train Loss: 0.1181808 Vali Loss: 0.1867512 Test Loss: 0.1707282
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 48 cost time: 0.9286315441131592
Epoch: 48, Steps: 64 | Train Loss: 0.1184338 Vali Loss: 0.1850311 Test Loss: 0.1691384
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 49 cost time: 0.896312952041626
Epoch: 49, Steps: 64 | Train Loss: 0.1177028 Vali Loss: 0.1835485 Test Loss: 0.1696670
Validation loss decreased (0.184219 --> 0.183548).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 50 cost time: 0.8893704414367676
Epoch: 50, Steps: 64 | Train Loss: 0.1181945 Vali Loss: 0.1850490 Test Loss: 0.1686363
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 51 cost time: 0.9033586978912354
Epoch: 51, Steps: 64 | Train Loss: 0.1180595 Vali Loss: 0.1865312 Test Loss: 0.1709627
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 52 cost time: 0.9269647598266602
Epoch: 52, Steps: 64 | Train Loss: 0.1174090 Vali Loss: 0.1840763 Test Loss: 0.1695774
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 53 cost time: 0.9410014152526855
Epoch: 53, Steps: 64 | Train Loss: 0.1172908 Vali Loss: 0.1837716 Test Loss: 0.1690560
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 54 cost time: 0.9286110401153564
Epoch: 54, Steps: 64 | Train Loss: 0.1172336 Vali Loss: 0.1833334 Test Loss: 0.1695997
Validation loss decreased (0.183548 --> 0.183333).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 55 cost time: 0.9376239776611328
Epoch: 55, Steps: 64 | Train Loss: 0.1183616 Vali Loss: 0.1825341 Test Loss: 0.1694314
Validation loss decreased (0.183333 --> 0.182534).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 56 cost time: 0.9545993804931641
Epoch: 56, Steps: 64 | Train Loss: 0.1179266 Vali Loss: 0.1843079 Test Loss: 0.1697751
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 57 cost time: 0.9344582557678223
Epoch: 57, Steps: 64 | Train Loss: 0.1179653 Vali Loss: 0.1844453 Test Loss: 0.1691006
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 58 cost time: 0.9343531131744385
Epoch: 58, Steps: 64 | Train Loss: 0.1179008 Vali Loss: 0.1843341 Test Loss: 0.1688283
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 59 cost time: 0.9335401058197021
Epoch: 59, Steps: 64 | Train Loss: 0.1169190 Vali Loss: 0.1837426 Test Loss: 0.1687209
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017625808715820312 GB
GPU已分配内存的峰值：0.04012775421142578 GB
Epoch: 60 cost time: 0.9207420349121094
Epoch: 60, Steps: 64 | Train Loss: 0.1174023 Vali Loss: 0.1865687 Test Loss: 0.1697254
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1694314032793045, mae:0.3199056386947632, rse:0.2190876603126526
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.040345191955566406 GB
Epoch: 1 cost time: 2.355142593383789
Epoch: 1, Steps: 64 | Train Loss: 0.8905656 Vali Loss: 1.9865282 Test Loss: 3.8387883
Validation loss decreased (inf --> 1.986528).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 2 cost time: 0.9826257228851318
Epoch: 2, Steps: 64 | Train Loss: 0.7077995 Vali Loss: 1.1767355 Test Loss: 2.1278980
Validation loss decreased (1.986528 --> 1.176736).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 3 cost time: 0.9398007392883301
Epoch: 3, Steps: 64 | Train Loss: 0.4239447 Vali Loss: 0.6708952 Test Loss: 1.0612247
Validation loss decreased (1.176736 --> 0.670895).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 4 cost time: 0.9435758590698242
Epoch: 4, Steps: 64 | Train Loss: 0.2577217 Vali Loss: 0.4122968 Test Loss: 0.5380278
Validation loss decreased (0.670895 --> 0.412297).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 5 cost time: 0.914924144744873
Epoch: 5, Steps: 64 | Train Loss: 0.1763893 Vali Loss: 0.2998039 Test Loss: 0.3235826
Validation loss decreased (0.412297 --> 0.299804).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 6 cost time: 0.9266433715820312
Epoch: 6, Steps: 64 | Train Loss: 0.1419808 Vali Loss: 0.2466313 Test Loss: 0.2321031
Validation loss decreased (0.299804 --> 0.246631).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 7 cost time: 0.918999433517456
Epoch: 7, Steps: 64 | Train Loss: 0.1263368 Vali Loss: 0.2168406 Test Loss: 0.1918654
Validation loss decreased (0.246631 --> 0.216841).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 8 cost time: 0.9203453063964844
Epoch: 8, Steps: 64 | Train Loss: 0.1188371 Vali Loss: 0.2003146 Test Loss: 0.1734389
Validation loss decreased (0.216841 --> 0.200315).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 9 cost time: 0.9484634399414062
Epoch: 9, Steps: 64 | Train Loss: 0.1147497 Vali Loss: 0.1924608 Test Loss: 0.1642687
Validation loss decreased (0.200315 --> 0.192461).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 10 cost time: 0.9504530429840088
Epoch: 10, Steps: 64 | Train Loss: 0.1116235 Vali Loss: 0.1836362 Test Loss: 0.1583569
Validation loss decreased (0.192461 --> 0.183636).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 11 cost time: 0.9672071933746338
Epoch: 11, Steps: 64 | Train Loss: 0.1093028 Vali Loss: 0.1810186 Test Loss: 0.1554211
Validation loss decreased (0.183636 --> 0.181019).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 12 cost time: 0.974853515625
Epoch: 12, Steps: 64 | Train Loss: 0.1079739 Vali Loss: 0.1748790 Test Loss: 0.1540184
Validation loss decreased (0.181019 --> 0.174879).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 13 cost time: 0.9629983901977539
Epoch: 13, Steps: 64 | Train Loss: 0.1073107 Vali Loss: 0.1742134 Test Loss: 0.1529300
Validation loss decreased (0.174879 --> 0.174213).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 14 cost time: 0.9776453971862793
Epoch: 14, Steps: 64 | Train Loss: 0.1055798 Vali Loss: 0.1761849 Test Loss: 0.1532733
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 15 cost time: 0.9632687568664551
Epoch: 15, Steps: 64 | Train Loss: 0.1047048 Vali Loss: 0.1717978 Test Loss: 0.1518517
Validation loss decreased (0.174213 --> 0.171798).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 16 cost time: 0.9635684490203857
Epoch: 16, Steps: 64 | Train Loss: 0.1039174 Vali Loss: 0.1708719 Test Loss: 0.1505473
Validation loss decreased (0.171798 --> 0.170872).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 17 cost time: 0.9473485946655273
Epoch: 17, Steps: 64 | Train Loss: 0.1029818 Vali Loss: 0.1703870 Test Loss: 0.1512552
Validation loss decreased (0.170872 --> 0.170387).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 18 cost time: 0.9643814563751221
Epoch: 18, Steps: 64 | Train Loss: 0.1024824 Vali Loss: 0.1696432 Test Loss: 0.1500402
Validation loss decreased (0.170387 --> 0.169643).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 19 cost time: 0.9724164009094238
Epoch: 19, Steps: 64 | Train Loss: 0.1017561 Vali Loss: 0.1680095 Test Loss: 0.1506326
Validation loss decreased (0.169643 --> 0.168009).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 20 cost time: 0.9504127502441406
Epoch: 20, Steps: 64 | Train Loss: 0.1014589 Vali Loss: 0.1656645 Test Loss: 0.1506308
Validation loss decreased (0.168009 --> 0.165665).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 21 cost time: 0.9423868656158447
Epoch: 21, Steps: 64 | Train Loss: 0.1011783 Vali Loss: 0.1674808 Test Loss: 0.1502908
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 22 cost time: 0.9209980964660645
Epoch: 22, Steps: 64 | Train Loss: 0.1007156 Vali Loss: 0.1683310 Test Loss: 0.1505517
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 23 cost time: 0.9180169105529785
Epoch: 23, Steps: 64 | Train Loss: 0.1003932 Vali Loss: 0.1683893 Test Loss: 0.1499607
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 24 cost time: 0.9233622550964355
Epoch: 24, Steps: 64 | Train Loss: 0.1001738 Vali Loss: 0.1657946 Test Loss: 0.1497166
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 25 cost time: 0.9143846035003662
Epoch: 25, Steps: 64 | Train Loss: 0.0993690 Vali Loss: 0.1648247 Test Loss: 0.1499831
Validation loss decreased (0.165665 --> 0.164825).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 26 cost time: 0.9156851768493652
Epoch: 26, Steps: 64 | Train Loss: 0.0995393 Vali Loss: 0.1662313 Test Loss: 0.1497584
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 27 cost time: 0.9573287963867188
Epoch: 27, Steps: 64 | Train Loss: 0.0994340 Vali Loss: 0.1671661 Test Loss: 0.1501156
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 28 cost time: 0.9635000228881836
Epoch: 28, Steps: 64 | Train Loss: 0.0989787 Vali Loss: 0.1664791 Test Loss: 0.1490579
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 29 cost time: 0.9708545207977295
Epoch: 29, Steps: 64 | Train Loss: 0.0985141 Vali Loss: 0.1653056 Test Loss: 0.1495271
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 30 cost time: 0.9506399631500244
Epoch: 30, Steps: 64 | Train Loss: 0.0987505 Vali Loss: 0.1652939 Test Loss: 0.1498290
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 31 cost time: 0.9449865818023682
Epoch: 31, Steps: 64 | Train Loss: 0.0987174 Vali Loss: 0.1633695 Test Loss: 0.1487342
Validation loss decreased (0.164825 --> 0.163369).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 32 cost time: 0.9566128253936768
Epoch: 32, Steps: 64 | Train Loss: 0.0984624 Vali Loss: 0.1629783 Test Loss: 0.1492876
Validation loss decreased (0.163369 --> 0.162978).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 33 cost time: 0.9600958824157715
Epoch: 33, Steps: 64 | Train Loss: 0.0981967 Vali Loss: 0.1646208 Test Loss: 0.1499605
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 34 cost time: 0.9501392841339111
Epoch: 34, Steps: 64 | Train Loss: 0.0981279 Vali Loss: 0.1646311 Test Loss: 0.1487867
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 35 cost time: 0.968442440032959
Epoch: 35, Steps: 64 | Train Loss: 0.0982749 Vali Loss: 0.1642478 Test Loss: 0.1482922
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 36 cost time: 0.9812183380126953
Epoch: 36, Steps: 64 | Train Loss: 0.0980934 Vali Loss: 0.1648180 Test Loss: 0.1494812
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 37 cost time: 0.9662718772888184
Epoch: 37, Steps: 64 | Train Loss: 0.0978330 Vali Loss: 0.1642222 Test Loss: 0.1494699
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 38 cost time: 0.967764139175415
Epoch: 38, Steps: 64 | Train Loss: 0.0978736 Vali Loss: 0.1642299 Test Loss: 0.1489061
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 39 cost time: 0.9680016040802002
Epoch: 39, Steps: 64 | Train Loss: 0.0977670 Vali Loss: 0.1652158 Test Loss: 0.1493116
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 40 cost time: 0.914038896560669
Epoch: 40, Steps: 64 | Train Loss: 0.0979219 Vali Loss: 0.1642282 Test Loss: 0.1483720
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 41 cost time: 0.9143855571746826
Epoch: 41, Steps: 64 | Train Loss: 0.0971847 Vali Loss: 0.1646928 Test Loss: 0.1488202
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 42 cost time: 0.909400224685669
Epoch: 42, Steps: 64 | Train Loss: 0.0977414 Vali Loss: 0.1647954 Test Loss: 0.1488867
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 43 cost time: 0.926450252532959
Epoch: 43, Steps: 64 | Train Loss: 0.0972830 Vali Loss: 0.1644490 Test Loss: 0.1489312
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 44 cost time: 0.9358320236206055
Epoch: 44, Steps: 64 | Train Loss: 0.0976889 Vali Loss: 0.1633009 Test Loss: 0.1491951
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 45 cost time: 0.939847469329834
Epoch: 45, Steps: 64 | Train Loss: 0.0977970 Vali Loss: 0.1633017 Test Loss: 0.1486407
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 46 cost time: 0.9489989280700684
Epoch: 46, Steps: 64 | Train Loss: 0.0974384 Vali Loss: 0.1643068 Test Loss: 0.1496701
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 47 cost time: 0.942000150680542
Epoch: 47, Steps: 64 | Train Loss: 0.0969386 Vali Loss: 0.1633436 Test Loss: 0.1490123
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 48 cost time: 0.9269523620605469
Epoch: 48, Steps: 64 | Train Loss: 0.0977069 Vali Loss: 0.1612004 Test Loss: 0.1487958
Validation loss decreased (0.162978 --> 0.161200).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 49 cost time: 0.9322669506072998
Epoch: 49, Steps: 64 | Train Loss: 0.0975952 Vali Loss: 0.1659123 Test Loss: 0.1493131
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 50 cost time: 0.9559292793273926
Epoch: 50, Steps: 64 | Train Loss: 0.0969909 Vali Loss: 0.1635797 Test Loss: 0.1489808
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 51 cost time: 0.9553868770599365
Epoch: 51, Steps: 64 | Train Loss: 0.0971437 Vali Loss: 0.1643651 Test Loss: 0.1493200
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 52 cost time: 0.9654943943023682
Epoch: 52, Steps: 64 | Train Loss: 0.0975821 Vali Loss: 0.1642751 Test Loss: 0.1499414
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 53 cost time: 0.9792046546936035
Epoch: 53, Steps: 64 | Train Loss: 0.0971197 Vali Loss: 0.1646290 Test Loss: 0.1497104
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 54 cost time: 0.9687385559082031
Epoch: 54, Steps: 64 | Train Loss: 0.0979576 Vali Loss: 0.1634784 Test Loss: 0.1486889
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 55 cost time: 0.9690017700195312
Epoch: 55, Steps: 64 | Train Loss: 0.0972302 Vali Loss: 0.1626880 Test Loss: 0.1488471
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 56 cost time: 0.9586594104766846
Epoch: 56, Steps: 64 | Train Loss: 0.0969419 Vali Loss: 0.1647144 Test Loss: 0.1489619
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 57 cost time: 0.9484331607818604
Epoch: 57, Steps: 64 | Train Loss: 0.0969186 Vali Loss: 0.1631176 Test Loss: 0.1491067
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 58 cost time: 0.9492638111114502
Epoch: 58, Steps: 64 | Train Loss: 0.0973348 Vali Loss: 0.1649678 Test Loss: 0.1486665
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 59 cost time: 0.9144408702850342
Epoch: 59, Steps: 64 | Train Loss: 0.0970415 Vali Loss: 0.1639904 Test Loss: 0.1482275
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017663955688476562 GB
GPU已分配内存的峰值：0.04088878631591797 GB
Epoch: 60 cost time: 0.9264800548553467
Epoch: 60, Steps: 64 | Train Loss: 0.0975819 Vali Loss: 0.1649950 Test Loss: 0.1493699
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14879584312438965, mae:0.29157817363739014, rse:0.20531295239925385
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.0409092903137207 GB
Epoch: 1 cost time: 2.3715362548828125
Epoch: 1, Steps: 64 | Train Loss: 0.7440830 Vali Loss: 1.7184641 Test Loss: 3.2937047
Validation loss decreased (inf --> 1.718464).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 2 cost time: 0.9894769191741943
Epoch: 2, Steps: 64 | Train Loss: 0.6102295 Vali Loss: 1.0812387 Test Loss: 1.9497179
Validation loss decreased (1.718464 --> 1.081239).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 3 cost time: 0.9803812503814697
Epoch: 3, Steps: 64 | Train Loss: 0.3661147 Vali Loss: 0.5430127 Test Loss: 0.8219107
Validation loss decreased (1.081239 --> 0.543013).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 4 cost time: 0.9623556137084961
Epoch: 4, Steps: 64 | Train Loss: 0.1981282 Vali Loss: 0.2912494 Test Loss: 0.3244309
Validation loss decreased (0.543013 --> 0.291249).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 5 cost time: 0.9418787956237793
Epoch: 5, Steps: 64 | Train Loss: 0.1351437 Vali Loss: 0.2203906 Test Loss: 0.2030391
Validation loss decreased (0.291249 --> 0.220391).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 6 cost time: 0.9458115100860596
Epoch: 6, Steps: 64 | Train Loss: 0.1189295 Vali Loss: 0.1954979 Test Loss: 0.1774393
Validation loss decreased (0.220391 --> 0.195498).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 7 cost time: 0.9381875991821289
Epoch: 7, Steps: 64 | Train Loss: 0.1134631 Vali Loss: 0.1845588 Test Loss: 0.1673615
Validation loss decreased (0.195498 --> 0.184559).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 8 cost time: 0.9386370182037354
Epoch: 8, Steps: 64 | Train Loss: 0.1100821 Vali Loss: 0.1805917 Test Loss: 0.1620030
Validation loss decreased (0.184559 --> 0.180592).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 9 cost time: 0.9613854885101318
Epoch: 9, Steps: 64 | Train Loss: 0.1072678 Vali Loss: 0.1759289 Test Loss: 0.1581194
Validation loss decreased (0.180592 --> 0.175929).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 10 cost time: 0.9882910251617432
Epoch: 10, Steps: 64 | Train Loss: 0.1047154 Vali Loss: 0.1761464 Test Loss: 0.1568333
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 11 cost time: 0.9863896369934082
Epoch: 11, Steps: 64 | Train Loss: 0.1035673 Vali Loss: 0.1722372 Test Loss: 0.1552038
Validation loss decreased (0.175929 --> 0.172237).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 12 cost time: 0.989382266998291
Epoch: 12, Steps: 64 | Train Loss: 0.1017409 Vali Loss: 0.1692705 Test Loss: 0.1553501
Validation loss decreased (0.172237 --> 0.169271).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 13 cost time: 1.0088965892791748
Epoch: 13, Steps: 64 | Train Loss: 0.1010514 Vali Loss: 0.1689896 Test Loss: 0.1551827
Validation loss decreased (0.169271 --> 0.168990).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 14 cost time: 0.9741287231445312
Epoch: 14, Steps: 64 | Train Loss: 0.1001693 Vali Loss: 0.1687243 Test Loss: 0.1543301
Validation loss decreased (0.168990 --> 0.168724).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 15 cost time: 0.9783935546875
Epoch: 15, Steps: 64 | Train Loss: 0.0991415 Vali Loss: 0.1683713 Test Loss: 0.1539185
Validation loss decreased (0.168724 --> 0.168371).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 16 cost time: 0.9858005046844482
Epoch: 16, Steps: 64 | Train Loss: 0.0982316 Vali Loss: 0.1671591 Test Loss: 0.1537652
Validation loss decreased (0.168371 --> 0.167159).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 17 cost time: 0.9743225574493408
Epoch: 17, Steps: 64 | Train Loss: 0.0979391 Vali Loss: 0.1675141 Test Loss: 0.1540369
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 18 cost time: 0.9936285018920898
Epoch: 18, Steps: 64 | Train Loss: 0.0974221 Vali Loss: 0.1688472 Test Loss: 0.1539956
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 19 cost time: 0.9776418209075928
Epoch: 19, Steps: 64 | Train Loss: 0.0973024 Vali Loss: 0.1653439 Test Loss: 0.1538014
Validation loss decreased (0.167159 --> 0.165344).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 20 cost time: 0.9656455516815186
Epoch: 20, Steps: 64 | Train Loss: 0.0967140 Vali Loss: 0.1688663 Test Loss: 0.1541437
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 21 cost time: 0.9694139957427979
Epoch: 21, Steps: 64 | Train Loss: 0.0962706 Vali Loss: 0.1671215 Test Loss: 0.1542171
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 22 cost time: 0.9393868446350098
Epoch: 22, Steps: 64 | Train Loss: 0.0961492 Vali Loss: 0.1660531 Test Loss: 0.1528351
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 23 cost time: 0.9794878959655762
Epoch: 23, Steps: 64 | Train Loss: 0.0957564 Vali Loss: 0.1639978 Test Loss: 0.1533774
Validation loss decreased (0.165344 --> 0.163998).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 24 cost time: 0.9844043254852295
Epoch: 24, Steps: 64 | Train Loss: 0.0956072 Vali Loss: 0.1650387 Test Loss: 0.1540683
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 25 cost time: 0.9784355163574219
Epoch: 25, Steps: 64 | Train Loss: 0.0952984 Vali Loss: 0.1665877 Test Loss: 0.1530695
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 26 cost time: 0.9881093502044678
Epoch: 26, Steps: 64 | Train Loss: 0.0950809 Vali Loss: 0.1653661 Test Loss: 0.1531472
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 27 cost time: 0.9656116962432861
Epoch: 27, Steps: 64 | Train Loss: 0.0947731 Vali Loss: 0.1657265 Test Loss: 0.1530235
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 28 cost time: 0.9660019874572754
Epoch: 28, Steps: 64 | Train Loss: 0.0947149 Vali Loss: 0.1658737 Test Loss: 0.1531349
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 29 cost time: 0.9856457710266113
Epoch: 29, Steps: 64 | Train Loss: 0.0947261 Vali Loss: 0.1672473 Test Loss: 0.1531153
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 30 cost time: 0.9862689971923828
Epoch: 30, Steps: 64 | Train Loss: 0.0945858 Vali Loss: 0.1648754 Test Loss: 0.1540250
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 31 cost time: 0.9864130020141602
Epoch: 31, Steps: 64 | Train Loss: 0.0943114 Vali Loss: 0.1653737 Test Loss: 0.1534055
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 32 cost time: 0.9794101715087891
Epoch: 32, Steps: 64 | Train Loss: 0.0940873 Vali Loss: 0.1650798 Test Loss: 0.1532738
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 33 cost time: 0.9864141941070557
Epoch: 33, Steps: 64 | Train Loss: 0.0942866 Vali Loss: 0.1652171 Test Loss: 0.1530063
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 34 cost time: 0.9869637489318848
Epoch: 34, Steps: 64 | Train Loss: 0.0939343 Vali Loss: 0.1648581 Test Loss: 0.1531865
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 35 cost time: 0.9982492923736572
Epoch: 35, Steps: 64 | Train Loss: 0.0939346 Vali Loss: 0.1654990 Test Loss: 0.1537422
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 36 cost time: 1.0034091472625732
Epoch: 36, Steps: 64 | Train Loss: 0.0936931 Vali Loss: 0.1646188 Test Loss: 0.1532472
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 37 cost time: 0.9837360382080078
Epoch: 37, Steps: 64 | Train Loss: 0.0938646 Vali Loss: 0.1644501 Test Loss: 0.1533104
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 38 cost time: 0.9791562557220459
Epoch: 38, Steps: 64 | Train Loss: 0.0938288 Vali Loss: 0.1637480 Test Loss: 0.1527992
Validation loss decreased (0.163998 --> 0.163748).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 39 cost time: 0.9830000400543213
Epoch: 39, Steps: 64 | Train Loss: 0.0934931 Vali Loss: 0.1653525 Test Loss: 0.1534892
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 40 cost time: 0.9512603282928467
Epoch: 40, Steps: 64 | Train Loss: 0.0938466 Vali Loss: 0.1639660 Test Loss: 0.1529993
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 41 cost time: 0.9446563720703125
Epoch: 41, Steps: 64 | Train Loss: 0.0933741 Vali Loss: 0.1646447 Test Loss: 0.1533381
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 42 cost time: 0.9457082748413086
Epoch: 42, Steps: 64 | Train Loss: 0.0939050 Vali Loss: 0.1657672 Test Loss: 0.1530285
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 43 cost time: 0.9725847244262695
Epoch: 43, Steps: 64 | Train Loss: 0.0935612 Vali Loss: 0.1650412 Test Loss: 0.1531238
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 44 cost time: 0.9727964401245117
Epoch: 44, Steps: 64 | Train Loss: 0.0934421 Vali Loss: 0.1646302 Test Loss: 0.1532554
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 45 cost time: 0.9702460765838623
Epoch: 45, Steps: 64 | Train Loss: 0.0938225 Vali Loss: 0.1636515 Test Loss: 0.1535403
Validation loss decreased (0.163748 --> 0.163651).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 46 cost time: 0.9753587245941162
Epoch: 46, Steps: 64 | Train Loss: 0.0937279 Vali Loss: 0.1630500 Test Loss: 0.1527098
Validation loss decreased (0.163651 --> 0.163050).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 47 cost time: 0.9687104225158691
Epoch: 47, Steps: 64 | Train Loss: 0.0937334 Vali Loss: 0.1641631 Test Loss: 0.1538807
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 48 cost time: 0.9823851585388184
Epoch: 48, Steps: 64 | Train Loss: 0.0928492 Vali Loss: 0.1636275 Test Loss: 0.1537218
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 49 cost time: 0.9810001850128174
Epoch: 49, Steps: 64 | Train Loss: 0.0932378 Vali Loss: 0.1648003 Test Loss: 0.1537046
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 50 cost time: 0.9750781059265137
Epoch: 50, Steps: 64 | Train Loss: 0.0937051 Vali Loss: 0.1630848 Test Loss: 0.1537184
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 51 cost time: 0.9946291446685791
Epoch: 51, Steps: 64 | Train Loss: 0.0937433 Vali Loss: 0.1647434 Test Loss: 0.1529370
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 52 cost time: 0.932636022567749
Epoch: 52, Steps: 64 | Train Loss: 0.0931375 Vali Loss: 0.1643546 Test Loss: 0.1536702
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 53 cost time: 0.9954636096954346
Epoch: 53, Steps: 64 | Train Loss: 0.0929986 Vali Loss: 0.1644742 Test Loss: 0.1533378
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 54 cost time: 0.9861972332000732
Epoch: 54, Steps: 64 | Train Loss: 0.0934070 Vali Loss: 0.1636668 Test Loss: 0.1533388
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 55 cost time: 0.9786593914031982
Epoch: 55, Steps: 64 | Train Loss: 0.0933772 Vali Loss: 0.1660493 Test Loss: 0.1538691
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 56 cost time: 0.9833526611328125
Epoch: 56, Steps: 64 | Train Loss: 0.0930768 Vali Loss: 0.1645743 Test Loss: 0.1533860
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 57 cost time: 0.9549276828765869
Epoch: 57, Steps: 64 | Train Loss: 0.0934970 Vali Loss: 0.1624811 Test Loss: 0.1538297
Validation loss decreased (0.163050 --> 0.162481).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 58 cost time: 0.9557318687438965
Epoch: 58, Steps: 64 | Train Loss: 0.0936086 Vali Loss: 0.1641753 Test Loss: 0.1535601
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 59 cost time: 0.962430477142334
Epoch: 59, Steps: 64 | Train Loss: 0.0932425 Vali Loss: 0.1627766 Test Loss: 0.1526595
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017686843872070312 GB
GPU已分配内存的峰值：0.04163837432861328 GB
Epoch: 60 cost time: 0.979302167892456
Epoch: 60, Steps: 64 | Train Loss: 0.0935814 Vali Loss: 0.1642896 Test Loss: 0.1532571
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15382973849773407, mae:0.3014916181564331, rse:0.20875702798366547
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.039804935455322266 GB
Epoch: 1 cost time: 2.3039469718933105
Epoch: 1, Steps: 64 | Train Loss: 1.1014881 Vali Loss: 2.2851639 Test Loss: 4.4528103
Validation loss decreased (inf --> 2.285164).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 2 cost time: 0.9346175193786621
Epoch: 2, Steps: 64 | Train Loss: 0.8351363 Vali Loss: 1.2410719 Test Loss: 2.2448943
Validation loss decreased (2.285164 --> 1.241072).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 3 cost time: 0.9286212921142578
Epoch: 3, Steps: 64 | Train Loss: 0.5235417 Vali Loss: 0.8754771 Test Loss: 1.4691560
Validation loss decreased (1.241072 --> 0.875477).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 4 cost time: 0.9237642288208008
Epoch: 4, Steps: 64 | Train Loss: 0.3875267 Vali Loss: 0.6641651 Test Loss: 1.0405287
Validation loss decreased (0.875477 --> 0.664165).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 5 cost time: 0.9134042263031006
Epoch: 5, Steps: 64 | Train Loss: 0.3039019 Vali Loss: 0.5234336 Test Loss: 0.7578694
Validation loss decreased (0.664165 --> 0.523434).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 6 cost time: 0.9143714904785156
Epoch: 6, Steps: 64 | Train Loss: 0.2465259 Vali Loss: 0.4285278 Test Loss: 0.5744513
Validation loss decreased (0.523434 --> 0.428528).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 7 cost time: 0.9101810455322266
Epoch: 7, Steps: 64 | Train Loss: 0.2105061 Vali Loss: 0.3666926 Test Loss: 0.4676383
Validation loss decreased (0.428528 --> 0.366693).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 8 cost time: 0.9107191562652588
Epoch: 8, Steps: 64 | Train Loss: 0.1884846 Vali Loss: 0.3311399 Test Loss: 0.3938455
Validation loss decreased (0.366693 --> 0.331140).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 9 cost time: 0.9300017356872559
Epoch: 9, Steps: 64 | Train Loss: 0.1741363 Vali Loss: 0.3052758 Test Loss: 0.3501631
Validation loss decreased (0.331140 --> 0.305276).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 10 cost time: 0.9346208572387695
Epoch: 10, Steps: 64 | Train Loss: 0.1626396 Vali Loss: 0.2819591 Test Loss: 0.3143085
Validation loss decreased (0.305276 --> 0.281959).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 11 cost time: 0.9496073722839355
Epoch: 11, Steps: 64 | Train Loss: 0.1551993 Vali Loss: 0.2663462 Test Loss: 0.2881079
Validation loss decreased (0.281959 --> 0.266346).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 12 cost time: 0.9460644721984863
Epoch: 12, Steps: 64 | Train Loss: 0.1480121 Vali Loss: 0.2547106 Test Loss: 0.2662537
Validation loss decreased (0.266346 --> 0.254711).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 13 cost time: 0.9434554576873779
Epoch: 13, Steps: 64 | Train Loss: 0.1429857 Vali Loss: 0.2437002 Test Loss: 0.2510570
Validation loss decreased (0.254711 --> 0.243700).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 14 cost time: 0.9243896007537842
Epoch: 14, Steps: 64 | Train Loss: 0.1390942 Vali Loss: 0.2318758 Test Loss: 0.2362689
Validation loss decreased (0.243700 --> 0.231876).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 15 cost time: 0.9313530921936035
Epoch: 15, Steps: 64 | Train Loss: 0.1354397 Vali Loss: 0.2289292 Test Loss: 0.2289470
Validation loss decreased (0.231876 --> 0.228929).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 16 cost time: 0.9365286827087402
Epoch: 16, Steps: 64 | Train Loss: 0.1329098 Vali Loss: 0.2238907 Test Loss: 0.2231775
Validation loss decreased (0.228929 --> 0.223891).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 17 cost time: 0.9216084480285645
Epoch: 17, Steps: 64 | Train Loss: 0.1311933 Vali Loss: 0.2191614 Test Loss: 0.2175600
Validation loss decreased (0.223891 --> 0.219161).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 18 cost time: 0.9440007209777832
Epoch: 18, Steps: 64 | Train Loss: 0.1297612 Vali Loss: 0.2141592 Test Loss: 0.2097165
Validation loss decreased (0.219161 --> 0.214159).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 19 cost time: 0.9396333694458008
Epoch: 19, Steps: 64 | Train Loss: 0.1277816 Vali Loss: 0.2130647 Test Loss: 0.2049360
Validation loss decreased (0.214159 --> 0.213065).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 20 cost time: 0.9424939155578613
Epoch: 20, Steps: 64 | Train Loss: 0.1263035 Vali Loss: 0.2099467 Test Loss: 0.2018216
Validation loss decreased (0.213065 --> 0.209947).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 21 cost time: 0.9403293132781982
Epoch: 21, Steps: 64 | Train Loss: 0.1252484 Vali Loss: 0.2049897 Test Loss: 0.1980920
Validation loss decreased (0.209947 --> 0.204990).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 22 cost time: 0.9433720111846924
Epoch: 22, Steps: 64 | Train Loss: 0.1244847 Vali Loss: 0.2061317 Test Loss: 0.1951104
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 23 cost time: 0.9344255924224854
Epoch: 23, Steps: 64 | Train Loss: 0.1234038 Vali Loss: 0.2037383 Test Loss: 0.1931252
Validation loss decreased (0.204990 --> 0.203738).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 24 cost time: 0.907829761505127
Epoch: 24, Steps: 64 | Train Loss: 0.1235887 Vali Loss: 0.2024319 Test Loss: 0.1929456
Validation loss decreased (0.203738 --> 0.202432).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 25 cost time: 0.9134068489074707
Epoch: 25, Steps: 64 | Train Loss: 0.1222400 Vali Loss: 0.2018343 Test Loss: 0.1901707
Validation loss decreased (0.202432 --> 0.201834).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 26 cost time: 0.9209990501403809
Epoch: 26, Steps: 64 | Train Loss: 0.1211050 Vali Loss: 0.1991220 Test Loss: 0.1890871
Validation loss decreased (0.201834 --> 0.199122).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 27 cost time: 0.896918535232544
Epoch: 27, Steps: 64 | Train Loss: 0.1211772 Vali Loss: 0.1969337 Test Loss: 0.1870422
Validation loss decreased (0.199122 --> 0.196934).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 28 cost time: 0.930588960647583
Epoch: 28, Steps: 64 | Train Loss: 0.1200044 Vali Loss: 0.1966456 Test Loss: 0.1866433
Validation loss decreased (0.196934 --> 0.196646).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 29 cost time: 0.9152736663818359
Epoch: 29, Steps: 64 | Train Loss: 0.1197233 Vali Loss: 0.1944277 Test Loss: 0.1848925
Validation loss decreased (0.196646 --> 0.194428).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 30 cost time: 0.8963346481323242
Epoch: 30, Steps: 64 | Train Loss: 0.1196363 Vali Loss: 0.1946343 Test Loss: 0.1824141
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 31 cost time: 0.9397857189178467
Epoch: 31, Steps: 64 | Train Loss: 0.1198730 Vali Loss: 0.1933504 Test Loss: 0.1823218
Validation loss decreased (0.194428 --> 0.193350).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 32 cost time: 0.9451992511749268
Epoch: 32, Steps: 64 | Train Loss: 0.1185296 Vali Loss: 0.1958642 Test Loss: 0.1824918
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 33 cost time: 0.9249992370605469
Epoch: 33, Steps: 64 | Train Loss: 0.1191196 Vali Loss: 0.1938377 Test Loss: 0.1833335
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 34 cost time: 0.9186339378356934
Epoch: 34, Steps: 64 | Train Loss: 0.1182847 Vali Loss: 0.1931856 Test Loss: 0.1804910
Validation loss decreased (0.193350 --> 0.193186).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 35 cost time: 0.9420003890991211
Epoch: 35, Steps: 64 | Train Loss: 0.1178318 Vali Loss: 0.1934730 Test Loss: 0.1812346
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 36 cost time: 0.9499046802520752
Epoch: 36, Steps: 64 | Train Loss: 0.1182209 Vali Loss: 0.1914036 Test Loss: 0.1812805
Validation loss decreased (0.193186 --> 0.191404).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 37 cost time: 0.9504532814025879
Epoch: 37, Steps: 64 | Train Loss: 0.1180979 Vali Loss: 0.1907891 Test Loss: 0.1794718
Validation loss decreased (0.191404 --> 0.190789).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 38 cost time: 0.9505066871643066
Epoch: 38, Steps: 64 | Train Loss: 0.1170948 Vali Loss: 0.1906184 Test Loss: 0.1784927
Validation loss decreased (0.190789 --> 0.190618).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 39 cost time: 0.9400010108947754
Epoch: 39, Steps: 64 | Train Loss: 0.1171547 Vali Loss: 0.1913073 Test Loss: 0.1788305
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 40 cost time: 0.9336347579956055
Epoch: 40, Steps: 64 | Train Loss: 0.1177458 Vali Loss: 0.1934824 Test Loss: 0.1790931
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 41 cost time: 0.9070010185241699
Epoch: 41, Steps: 64 | Train Loss: 0.1174507 Vali Loss: 0.1891868 Test Loss: 0.1785825
Validation loss decreased (0.190618 --> 0.189187).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 42 cost time: 0.9154314994812012
Epoch: 42, Steps: 64 | Train Loss: 0.1172440 Vali Loss: 0.1911861 Test Loss: 0.1786565
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 43 cost time: 0.911888837814331
Epoch: 43, Steps: 64 | Train Loss: 0.1170368 Vali Loss: 0.1913469 Test Loss: 0.1782658
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 44 cost time: 0.9323897361755371
Epoch: 44, Steps: 64 | Train Loss: 0.1171780 Vali Loss: 0.1893269 Test Loss: 0.1782814
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 45 cost time: 0.9233994483947754
Epoch: 45, Steps: 64 | Train Loss: 0.1173450 Vali Loss: 0.1906476 Test Loss: 0.1782471
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 46 cost time: 0.9237635135650635
Epoch: 46, Steps: 64 | Train Loss: 0.1169413 Vali Loss: 0.1884304 Test Loss: 0.1775617
Validation loss decreased (0.189187 --> 0.188430).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 47 cost time: 0.9387075901031494
Epoch: 47, Steps: 64 | Train Loss: 0.1168907 Vali Loss: 0.1904309 Test Loss: 0.1777755
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 48 cost time: 0.9166185855865479
Epoch: 48, Steps: 64 | Train Loss: 0.1168711 Vali Loss: 0.1903681 Test Loss: 0.1773825
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 49 cost time: 0.8996436595916748
Epoch: 49, Steps: 64 | Train Loss: 0.1161751 Vali Loss: 0.1886410 Test Loss: 0.1769237
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 50 cost time: 0.9118826389312744
Epoch: 50, Steps: 64 | Train Loss: 0.1163491 Vali Loss: 0.1879192 Test Loss: 0.1772028
Validation loss decreased (0.188430 --> 0.187919).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 51 cost time: 0.9300072193145752
Epoch: 51, Steps: 64 | Train Loss: 0.1166876 Vali Loss: 0.1891187 Test Loss: 0.1765256
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 52 cost time: 0.9394159317016602
Epoch: 52, Steps: 64 | Train Loss: 0.1166810 Vali Loss: 0.1886242 Test Loss: 0.1763616
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 53 cost time: 0.937697172164917
Epoch: 53, Steps: 64 | Train Loss: 0.1164465 Vali Loss: 0.1866218 Test Loss: 0.1755461
Validation loss decreased (0.187919 --> 0.186622).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 54 cost time: 0.9527873992919922
Epoch: 54, Steps: 64 | Train Loss: 0.1165008 Vali Loss: 0.1899794 Test Loss: 0.1765391
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 55 cost time: 0.9470000267028809
Epoch: 55, Steps: 64 | Train Loss: 0.1175290 Vali Loss: 0.1891192 Test Loss: 0.1766186
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 56 cost time: 0.9419996738433838
Epoch: 56, Steps: 64 | Train Loss: 0.1163895 Vali Loss: 0.1893421 Test Loss: 0.1774774
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 57 cost time: 0.9250209331512451
Epoch: 57, Steps: 64 | Train Loss: 0.1166566 Vali Loss: 0.1902436 Test Loss: 0.1773522
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 58 cost time: 0.9273502826690674
Epoch: 58, Steps: 64 | Train Loss: 0.1172110 Vali Loss: 0.1886619 Test Loss: 0.1755796
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 59 cost time: 0.93294358253479
Epoch: 59, Steps: 64 | Train Loss: 0.1156071 Vali Loss: 0.1885414 Test Loss: 0.1752870
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017629623413085938 GB
GPU已分配内存的峰值：0.04029083251953125 GB
Epoch: 60 cost time: 0.923302412033081
Epoch: 60, Steps: 64 | Train Loss: 0.1166268 Vali Loss: 0.1902034 Test Loss: 0.1766637
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1755460649728775, mae:0.3236215114593506, rse:0.2230059951543808
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04050636291503906 GB
Epoch: 1 cost time: 2.3340964317321777
Epoch: 1, Steps: 64 | Train Loss: 0.9586569 Vali Loss: 2.1833467 Test Loss: 4.0839219
Validation loss decreased (inf --> 2.183347).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 2 cost time: 0.95904541015625
Epoch: 2, Steps: 64 | Train Loss: 0.7238561 Vali Loss: 1.1997026 Test Loss: 2.0521336
Validation loss decreased (2.183347 --> 1.199703).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 3 cost time: 0.9548754692077637
Epoch: 3, Steps: 64 | Train Loss: 0.3984515 Vali Loss: 0.6253789 Test Loss: 0.8837008
Validation loss decreased (1.199703 --> 0.625379).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 4 cost time: 0.9644167423248291
Epoch: 4, Steps: 64 | Train Loss: 0.2254261 Vali Loss: 0.3555529 Test Loss: 0.3962885
Validation loss decreased (0.625379 --> 0.355553).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 5 cost time: 0.9418883323669434
Epoch: 5, Steps: 64 | Train Loss: 0.1555918 Vali Loss: 0.2614966 Test Loss: 0.2465347
Validation loss decreased (0.355553 --> 0.261497).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 6 cost time: 0.9344594478607178
Epoch: 6, Steps: 64 | Train Loss: 0.1327306 Vali Loss: 0.2224338 Test Loss: 0.1926686
Validation loss decreased (0.261497 --> 0.222434).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 7 cost time: 0.9466383457183838
Epoch: 7, Steps: 64 | Train Loss: 0.1234673 Vali Loss: 0.2083260 Test Loss: 0.1750016
Validation loss decreased (0.222434 --> 0.208326).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 8 cost time: 0.9346327781677246
Epoch: 8, Steps: 64 | Train Loss: 0.1186458 Vali Loss: 0.1983563 Test Loss: 0.1661937
Validation loss decreased (0.208326 --> 0.198356).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 9 cost time: 0.9856274127960205
Epoch: 9, Steps: 64 | Train Loss: 0.1157551 Vali Loss: 0.1932116 Test Loss: 0.1621718
Validation loss decreased (0.198356 --> 0.193212).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 10 cost time: 1.0009534358978271
Epoch: 10, Steps: 64 | Train Loss: 0.1124109 Vali Loss: 0.1877596 Test Loss: 0.1585706
Validation loss decreased (0.193212 --> 0.187760).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 11 cost time: 0.9743671417236328
Epoch: 11, Steps: 64 | Train Loss: 0.1103056 Vali Loss: 0.1831291 Test Loss: 0.1569472
Validation loss decreased (0.187760 --> 0.183129).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 12 cost time: 0.9750683307647705
Epoch: 12, Steps: 64 | Train Loss: 0.1080956 Vali Loss: 0.1820520 Test Loss: 0.1559102
Validation loss decreased (0.183129 --> 0.182052).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 13 cost time: 0.9647457599639893
Epoch: 13, Steps: 64 | Train Loss: 0.1074294 Vali Loss: 0.1803982 Test Loss: 0.1550922
Validation loss decreased (0.182052 --> 0.180398).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 14 cost time: 0.9543900489807129
Epoch: 14, Steps: 64 | Train Loss: 0.1053494 Vali Loss: 0.1788224 Test Loss: 0.1553186
Validation loss decreased (0.180398 --> 0.178822).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 15 cost time: 0.949711799621582
Epoch: 15, Steps: 64 | Train Loss: 0.1047063 Vali Loss: 0.1790132 Test Loss: 0.1548018
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 16 cost time: 0.9509992599487305
Epoch: 16, Steps: 64 | Train Loss: 0.1041736 Vali Loss: 0.1760085 Test Loss: 0.1542074
Validation loss decreased (0.178822 --> 0.176008).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 17 cost time: 0.9666287899017334
Epoch: 17, Steps: 64 | Train Loss: 0.1032457 Vali Loss: 0.1754148 Test Loss: 0.1539308
Validation loss decreased (0.176008 --> 0.175415).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 18 cost time: 0.9826004505157471
Epoch: 18, Steps: 64 | Train Loss: 0.1026465 Vali Loss: 0.1745256 Test Loss: 0.1540935
Validation loss decreased (0.175415 --> 0.174526).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 19 cost time: 0.9745135307312012
Epoch: 19, Steps: 64 | Train Loss: 0.1026125 Vali Loss: 0.1750524 Test Loss: 0.1536784
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 20 cost time: 0.955474853515625
Epoch: 20, Steps: 64 | Train Loss: 0.1012616 Vali Loss: 0.1748602 Test Loss: 0.1539454
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 21 cost time: 0.9490392208099365
Epoch: 21, Steps: 64 | Train Loss: 0.1013609 Vali Loss: 0.1753105 Test Loss: 0.1541840
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 22 cost time: 0.9324252605438232
Epoch: 22, Steps: 64 | Train Loss: 0.1007230 Vali Loss: 0.1740771 Test Loss: 0.1539060
Validation loss decreased (0.174526 --> 0.174077).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 23 cost time: 0.9341540336608887
Epoch: 23, Steps: 64 | Train Loss: 0.1006913 Vali Loss: 0.1735335 Test Loss: 0.1543757
Validation loss decreased (0.174077 --> 0.173534).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 24 cost time: 0.9335143566131592
Epoch: 24, Steps: 64 | Train Loss: 0.0997146 Vali Loss: 0.1728041 Test Loss: 0.1537749
Validation loss decreased (0.173534 --> 0.172804).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 25 cost time: 0.9334530830383301
Epoch: 25, Steps: 64 | Train Loss: 0.0997123 Vali Loss: 0.1722628 Test Loss: 0.1549139
Validation loss decreased (0.172804 --> 0.172263).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 26 cost time: 0.9476268291473389
Epoch: 26, Steps: 64 | Train Loss: 0.0999621 Vali Loss: 0.1709090 Test Loss: 0.1540313
Validation loss decreased (0.172263 --> 0.170909).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 27 cost time: 0.9586350917816162
Epoch: 27, Steps: 64 | Train Loss: 0.0993855 Vali Loss: 0.1729927 Test Loss: 0.1542047
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 28 cost time: 0.9515595436096191
Epoch: 28, Steps: 64 | Train Loss: 0.0986242 Vali Loss: 0.1726152 Test Loss: 0.1541197
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 29 cost time: 0.9475178718566895
Epoch: 29, Steps: 64 | Train Loss: 0.0987323 Vali Loss: 0.1726943 Test Loss: 0.1546446
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 30 cost time: 0.9685080051422119
Epoch: 30, Steps: 64 | Train Loss: 0.0988648 Vali Loss: 0.1735175 Test Loss: 0.1549293
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 31 cost time: 0.9673662185668945
Epoch: 31, Steps: 64 | Train Loss: 0.0994474 Vali Loss: 0.1731367 Test Loss: 0.1542483
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 32 cost time: 0.9508092403411865
Epoch: 32, Steps: 64 | Train Loss: 0.0986802 Vali Loss: 0.1728259 Test Loss: 0.1542162
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 33 cost time: 0.9507737159729004
Epoch: 33, Steps: 64 | Train Loss: 0.0983249 Vali Loss: 0.1715692 Test Loss: 0.1541563
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 34 cost time: 0.9726459980010986
Epoch: 34, Steps: 64 | Train Loss: 0.0983823 Vali Loss: 0.1719663 Test Loss: 0.1536958
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 35 cost time: 0.9887359142303467
Epoch: 35, Steps: 64 | Train Loss: 0.0981962 Vali Loss: 0.1728062 Test Loss: 0.1540243
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 36 cost time: 0.9785013198852539
Epoch: 36, Steps: 64 | Train Loss: 0.0974034 Vali Loss: 0.1718226 Test Loss: 0.1541314
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 37 cost time: 0.9687225818634033
Epoch: 37, Steps: 64 | Train Loss: 0.0981854 Vali Loss: 0.1733536 Test Loss: 0.1544814
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 38 cost time: 0.9774982929229736
Epoch: 38, Steps: 64 | Train Loss: 0.0977580 Vali Loss: 0.1704966 Test Loss: 0.1533589
Validation loss decreased (0.170909 --> 0.170497).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 39 cost time: 0.9443902969360352
Epoch: 39, Steps: 64 | Train Loss: 0.0980562 Vali Loss: 0.1728969 Test Loss: 0.1538662
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 40 cost time: 0.9253547191619873
Epoch: 40, Steps: 64 | Train Loss: 0.0979748 Vali Loss: 0.1710587 Test Loss: 0.1547242
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 41 cost time: 0.9373564720153809
Epoch: 41, Steps: 64 | Train Loss: 0.0976618 Vali Loss: 0.1709569 Test Loss: 0.1544599
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 42 cost time: 0.9645869731903076
Epoch: 42, Steps: 64 | Train Loss: 0.0980598 Vali Loss: 0.1721404 Test Loss: 0.1539355
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 43 cost time: 0.9539971351623535
Epoch: 43, Steps: 64 | Train Loss: 0.0981697 Vali Loss: 0.1714051 Test Loss: 0.1539940
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 44 cost time: 0.9675586223602295
Epoch: 44, Steps: 64 | Train Loss: 0.0976850 Vali Loss: 0.1728804 Test Loss: 0.1550314
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 45 cost time: 0.9534327983856201
Epoch: 45, Steps: 64 | Train Loss: 0.0975724 Vali Loss: 0.1720430 Test Loss: 0.1551830
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 46 cost time: 0.9480459690093994
Epoch: 46, Steps: 64 | Train Loss: 0.0976211 Vali Loss: 0.1721719 Test Loss: 0.1548377
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 47 cost time: 0.9354159832000732
Epoch: 47, Steps: 64 | Train Loss: 0.0978666 Vali Loss: 0.1712230 Test Loss: 0.1555811
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 48 cost time: 0.9303452968597412
Epoch: 48, Steps: 64 | Train Loss: 0.0980252 Vali Loss: 0.1709749 Test Loss: 0.1542170
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 49 cost time: 0.9460775852203369
Epoch: 49, Steps: 64 | Train Loss: 0.0974180 Vali Loss: 0.1729313 Test Loss: 0.1547952
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 50 cost time: 0.9554102420806885
Epoch: 50, Steps: 64 | Train Loss: 0.0979844 Vali Loss: 0.1699539 Test Loss: 0.1541272
Validation loss decreased (0.170497 --> 0.169954).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 51 cost time: 0.9677300453186035
Epoch: 51, Steps: 64 | Train Loss: 0.0972314 Vali Loss: 0.1709665 Test Loss: 0.1546407
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 52 cost time: 0.9720003604888916
Epoch: 52, Steps: 64 | Train Loss: 0.0974649 Vali Loss: 0.1699197 Test Loss: 0.1552884
Validation loss decreased (0.169954 --> 0.169920).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 53 cost time: 0.9796297550201416
Epoch: 53, Steps: 64 | Train Loss: 0.0977914 Vali Loss: 0.1729055 Test Loss: 0.1545062
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 54 cost time: 0.982008695602417
Epoch: 54, Steps: 64 | Train Loss: 0.0976126 Vali Loss: 0.1708667 Test Loss: 0.1549643
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 55 cost time: 0.9705605506896973
Epoch: 55, Steps: 64 | Train Loss: 0.0980110 Vali Loss: 0.1728820 Test Loss: 0.1550455
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 56 cost time: 0.9553680419921875
Epoch: 56, Steps: 64 | Train Loss: 0.0978761 Vali Loss: 0.1731653 Test Loss: 0.1548828
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 57 cost time: 0.9534997940063477
Epoch: 57, Steps: 64 | Train Loss: 0.0977018 Vali Loss: 0.1733879 Test Loss: 0.1551437
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 58 cost time: 0.9582633972167969
Epoch: 58, Steps: 64 | Train Loss: 0.0976966 Vali Loss: 0.1714993 Test Loss: 0.1540804
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 59 cost time: 0.9253523349761963
Epoch: 59, Steps: 64 | Train Loss: 0.0976482 Vali Loss: 0.1718076 Test Loss: 0.1543729
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017667770385742188 GB
GPU已分配内存的峰值：0.04105186462402344 GB
Epoch: 60 cost time: 0.9537370204925537
Epoch: 60, Steps: 64 | Train Loss: 0.0977087 Vali Loss: 0.1729376 Test Loss: 0.1556005
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15528836846351624, mae:0.30169785022735596, rse:0.2097444236278534
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04107046127319336 GB
Epoch: 1 cost time: 2.368072271347046
Epoch: 1, Steps: 64 | Train Loss: 0.8622797 Vali Loss: 1.9850200 Test Loss: 3.8792470
Validation loss decreased (inf --> 1.985020).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 2 cost time: 0.974431037902832
Epoch: 2, Steps: 64 | Train Loss: 0.6819819 Vali Loss: 1.1860015 Test Loss: 2.1619895
Validation loss decreased (1.985020 --> 1.186002).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 3 cost time: 0.9807512760162354
Epoch: 3, Steps: 64 | Train Loss: 0.3917884 Vali Loss: 0.6105772 Test Loss: 0.9399097
Validation loss decreased (1.186002 --> 0.610577).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 4 cost time: 0.9860846996307373
Epoch: 4, Steps: 64 | Train Loss: 0.2018955 Vali Loss: 0.3049034 Test Loss: 0.3418289
Validation loss decreased (0.610577 --> 0.304903).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 5 cost time: 0.956000804901123
Epoch: 5, Steps: 64 | Train Loss: 0.1321000 Vali Loss: 0.2184352 Test Loss: 0.1970745
Validation loss decreased (0.304903 --> 0.218435).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 6 cost time: 0.9591765403747559
Epoch: 6, Steps: 64 | Train Loss: 0.1167824 Vali Loss: 0.1920363 Test Loss: 0.1688204
Validation loss decreased (0.218435 --> 0.192036).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 7 cost time: 0.9646549224853516
Epoch: 7, Steps: 64 | Train Loss: 0.1118851 Vali Loss: 0.1832533 Test Loss: 0.1623819
Validation loss decreased (0.192036 --> 0.183253).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 8 cost time: 0.9474194049835205
Epoch: 8, Steps: 64 | Train Loss: 0.1086378 Vali Loss: 0.1794057 Test Loss: 0.1586378
Validation loss decreased (0.183253 --> 0.179406).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 9 cost time: 0.9803879261016846
Epoch: 9, Steps: 64 | Train Loss: 0.1058931 Vali Loss: 0.1763935 Test Loss: 0.1563171
Validation loss decreased (0.179406 --> 0.176393).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 10 cost time: 0.9964148998260498
Epoch: 10, Steps: 64 | Train Loss: 0.1047461 Vali Loss: 0.1733166 Test Loss: 0.1534244
Validation loss decreased (0.176393 --> 0.173317).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 11 cost time: 1.0034661293029785
Epoch: 11, Steps: 64 | Train Loss: 0.1037281 Vali Loss: 0.1706842 Test Loss: 0.1531834
Validation loss decreased (0.173317 --> 0.170684).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 12 cost time: 1.0037167072296143
Epoch: 12, Steps: 64 | Train Loss: 0.1016039 Vali Loss: 0.1721005 Test Loss: 0.1535677
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 13 cost time: 0.9964096546173096
Epoch: 13, Steps: 64 | Train Loss: 0.1009611 Vali Loss: 0.1713879 Test Loss: 0.1523659
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 14 cost time: 0.9920175075531006
Epoch: 14, Steps: 64 | Train Loss: 0.0999504 Vali Loss: 0.1666357 Test Loss: 0.1513417
Validation loss decreased (0.170684 --> 0.166636).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 15 cost time: 0.9777505397796631
Epoch: 15, Steps: 64 | Train Loss: 0.0991183 Vali Loss: 0.1684195 Test Loss: 0.1519027
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 16 cost time: 0.9823093414306641
Epoch: 16, Steps: 64 | Train Loss: 0.0981340 Vali Loss: 0.1650171 Test Loss: 0.1510602
Validation loss decreased (0.166636 --> 0.165017).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 17 cost time: 0.9929986000061035
Epoch: 17, Steps: 64 | Train Loss: 0.0977596 Vali Loss: 0.1669174 Test Loss: 0.1509782
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 18 cost time: 0.9996025562286377
Epoch: 18, Steps: 64 | Train Loss: 0.0974160 Vali Loss: 0.1648147 Test Loss: 0.1506125
Validation loss decreased (0.165017 --> 0.164815).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 19 cost time: 0.9996328353881836
Epoch: 19, Steps: 64 | Train Loss: 0.0969803 Vali Loss: 0.1677959 Test Loss: 0.1510212
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 20 cost time: 1.0144274234771729
Epoch: 20, Steps: 64 | Train Loss: 0.0963404 Vali Loss: 0.1675926 Test Loss: 0.1510877
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 21 cost time: 0.9644176959991455
Epoch: 21, Steps: 64 | Train Loss: 0.0960574 Vali Loss: 0.1646754 Test Loss: 0.1512730
Validation loss decreased (0.164815 --> 0.164675).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 22 cost time: 0.9569005966186523
Epoch: 22, Steps: 64 | Train Loss: 0.0959741 Vali Loss: 0.1650669 Test Loss: 0.1505735
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 23 cost time: 0.9474177360534668
Epoch: 23, Steps: 64 | Train Loss: 0.0952508 Vali Loss: 0.1641391 Test Loss: 0.1502717
Validation loss decreased (0.164675 --> 0.164139).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 24 cost time: 0.9870016574859619
Epoch: 24, Steps: 64 | Train Loss: 0.0950932 Vali Loss: 0.1652125 Test Loss: 0.1511366
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 25 cost time: 0.9577586650848389
Epoch: 25, Steps: 64 | Train Loss: 0.0948764 Vali Loss: 0.1641306 Test Loss: 0.1510320
Validation loss decreased (0.164139 --> 0.164131).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 26 cost time: 0.9713287353515625
Epoch: 26, Steps: 64 | Train Loss: 0.0948225 Vali Loss: 0.1627710 Test Loss: 0.1512059
Validation loss decreased (0.164131 --> 0.162771).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 27 cost time: 0.9848027229309082
Epoch: 27, Steps: 64 | Train Loss: 0.0948497 Vali Loss: 0.1652747 Test Loss: 0.1508426
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 28 cost time: 1.0083870887756348
Epoch: 28, Steps: 64 | Train Loss: 0.0941889 Vali Loss: 0.1622662 Test Loss: 0.1517353
Validation loss decreased (0.162771 --> 0.162266).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 29 cost time: 0.9950017929077148
Epoch: 29, Steps: 64 | Train Loss: 0.0942147 Vali Loss: 0.1659068 Test Loss: 0.1513439
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 30 cost time: 1.0006368160247803
Epoch: 30, Steps: 64 | Train Loss: 0.0944427 Vali Loss: 0.1651279 Test Loss: 0.1513949
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 31 cost time: 1.0006029605865479
Epoch: 31, Steps: 64 | Train Loss: 0.0939365 Vali Loss: 0.1656250 Test Loss: 0.1509126
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 32 cost time: 0.9884512424468994
Epoch: 32, Steps: 64 | Train Loss: 0.0939873 Vali Loss: 0.1644259 Test Loss: 0.1509808
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 33 cost time: 0.9942140579223633
Epoch: 33, Steps: 64 | Train Loss: 0.0939006 Vali Loss: 0.1658588 Test Loss: 0.1508655
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 34 cost time: 0.9988336563110352
Epoch: 34, Steps: 64 | Train Loss: 0.0936285 Vali Loss: 0.1657593 Test Loss: 0.1512260
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 35 cost time: 0.9978358745574951
Epoch: 35, Steps: 64 | Train Loss: 0.0938472 Vali Loss: 0.1637269 Test Loss: 0.1505854
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 36 cost time: 1.0004346370697021
Epoch: 36, Steps: 64 | Train Loss: 0.0931672 Vali Loss: 0.1656213 Test Loss: 0.1514506
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 37 cost time: 1.0203816890716553
Epoch: 37, Steps: 64 | Train Loss: 0.0932100 Vali Loss: 0.1636249 Test Loss: 0.1507613
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 38 cost time: 0.9564006328582764
Epoch: 38, Steps: 64 | Train Loss: 0.0932085 Vali Loss: 0.1648881 Test Loss: 0.1514204
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 39 cost time: 0.9407436847686768
Epoch: 39, Steps: 64 | Train Loss: 0.0933506 Vali Loss: 0.1635934 Test Loss: 0.1509082
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 40 cost time: 0.9843885898590088
Epoch: 40, Steps: 64 | Train Loss: 0.0934933 Vali Loss: 0.1638703 Test Loss: 0.1508829
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 41 cost time: 0.9431369304656982
Epoch: 41, Steps: 64 | Train Loss: 0.0934674 Vali Loss: 0.1649455 Test Loss: 0.1516845
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 42 cost time: 0.954639196395874
Epoch: 42, Steps: 64 | Train Loss: 0.0937669 Vali Loss: 0.1631277 Test Loss: 0.1505208
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 43 cost time: 0.9704053401947021
Epoch: 43, Steps: 64 | Train Loss: 0.0936240 Vali Loss: 0.1643679 Test Loss: 0.1503831
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 44 cost time: 0.9703512191772461
Epoch: 44, Steps: 64 | Train Loss: 0.0930720 Vali Loss: 0.1644658 Test Loss: 0.1510767
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 45 cost time: 0.9651408195495605
Epoch: 45, Steps: 64 | Train Loss: 0.0932196 Vali Loss: 0.1641740 Test Loss: 0.1510806
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 46 cost time: 0.9584219455718994
Epoch: 46, Steps: 64 | Train Loss: 0.0938064 Vali Loss: 0.1644063 Test Loss: 0.1517036
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 47 cost time: 0.9544248580932617
Epoch: 47, Steps: 64 | Train Loss: 0.0931551 Vali Loss: 0.1640715 Test Loss: 0.1509846
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 48 cost time: 0.9808144569396973
Epoch: 48, Steps: 64 | Train Loss: 0.0931209 Vali Loss: 0.1621452 Test Loss: 0.1501083
Validation loss decreased (0.162266 --> 0.162145).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 49 cost time: 0.98439621925354
Epoch: 49, Steps: 64 | Train Loss: 0.0927891 Vali Loss: 0.1638760 Test Loss: 0.1504962
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 50 cost time: 0.9809999465942383
Epoch: 50, Steps: 64 | Train Loss: 0.0928922 Vali Loss: 0.1654559 Test Loss: 0.1510356
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 51 cost time: 0.9976112842559814
Epoch: 51, Steps: 64 | Train Loss: 0.0931912 Vali Loss: 0.1630949 Test Loss: 0.1510204
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 52 cost time: 0.9936447143554688
Epoch: 52, Steps: 64 | Train Loss: 0.0932109 Vali Loss: 0.1636525 Test Loss: 0.1514246
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 53 cost time: 1.0129077434539795
Epoch: 53, Steps: 64 | Train Loss: 0.0933080 Vali Loss: 0.1626535 Test Loss: 0.1509238
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 54 cost time: 0.9943568706512451
Epoch: 54, Steps: 64 | Train Loss: 0.0928753 Vali Loss: 0.1631590 Test Loss: 0.1511959
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 55 cost time: 0.9745068550109863
Epoch: 55, Steps: 64 | Train Loss: 0.0929931 Vali Loss: 0.1648291 Test Loss: 0.1506514
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 56 cost time: 0.976398229598999
Epoch: 56, Steps: 64 | Train Loss: 0.0931249 Vali Loss: 0.1645332 Test Loss: 0.1508961
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 57 cost time: 0.9424490928649902
Epoch: 57, Steps: 64 | Train Loss: 0.0928354 Vali Loss: 0.1632671 Test Loss: 0.1510265
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 58 cost time: 0.9433767795562744
Epoch: 58, Steps: 64 | Train Loss: 0.0930559 Vali Loss: 0.1635370 Test Loss: 0.1510785
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 59 cost time: 0.9688565731048584
Epoch: 59, Steps: 64 | Train Loss: 0.0931358 Vali Loss: 0.1643995 Test Loss: 0.1504246
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017690658569335938 GB
GPU已分配内存的峰值：0.04180145263671875 GB
Epoch: 60 cost time: 1.001783847808838
Epoch: 60, Steps: 64 | Train Loss: 0.0930509 Vali Loss: 0.1627492 Test Loss: 0.1509376
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15010827779769897, mae:0.2943953275680542, rse:0.2062164545059204
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.03996562957763672 GB
Epoch: 1 cost time: 2.3331210613250732
Epoch: 1, Steps: 64 | Train Loss: 0.8612474 Vali Loss: 1.7621151 Test Loss: 3.0436685
Validation loss decreased (inf --> 1.762115).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 2 cost time: 0.929163932800293
Epoch: 2, Steps: 64 | Train Loss: 0.6275146 Vali Loss: 0.8851230 Test Loss: 1.3311515
Validation loss decreased (1.762115 --> 0.885123).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 3 cost time: 0.937617301940918
Epoch: 3, Steps: 64 | Train Loss: 0.3903903 Vali Loss: 0.6094378 Test Loss: 0.8258128
Validation loss decreased (0.885123 --> 0.609438).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 4 cost time: 0.9259977340698242
Epoch: 4, Steps: 64 | Train Loss: 0.2873684 Vali Loss: 0.4650021 Test Loss: 0.5639595
Validation loss decreased (0.609438 --> 0.465002).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 5 cost time: 0.903648853302002
Epoch: 5, Steps: 64 | Train Loss: 0.2283964 Vali Loss: 0.3779063 Test Loss: 0.4198945
Validation loss decreased (0.465002 --> 0.377906).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 6 cost time: 0.8932878971099854
Epoch: 6, Steps: 64 | Train Loss: 0.1950746 Vali Loss: 0.3274140 Test Loss: 0.3378179
Validation loss decreased (0.377906 --> 0.327414).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 7 cost time: 0.9024753570556641
Epoch: 7, Steps: 64 | Train Loss: 0.1736563 Vali Loss: 0.2912813 Test Loss: 0.2847610
Validation loss decreased (0.327414 --> 0.291281).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 8 cost time: 0.8983750343322754
Epoch: 8, Steps: 64 | Train Loss: 0.1600114 Vali Loss: 0.2636916 Test Loss: 0.2485835
Validation loss decreased (0.291281 --> 0.263692).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 9 cost time: 0.9250233173370361
Epoch: 9, Steps: 64 | Train Loss: 0.1516577 Vali Loss: 0.2420093 Test Loss: 0.2230747
Validation loss decreased (0.263692 --> 0.242009).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 10 cost time: 0.9434249401092529
Epoch: 10, Steps: 64 | Train Loss: 0.1446458 Vali Loss: 0.2298017 Test Loss: 0.2065106
Validation loss decreased (0.242009 --> 0.229802).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 11 cost time: 0.9470007419586182
Epoch: 11, Steps: 64 | Train Loss: 0.1399850 Vali Loss: 0.2205418 Test Loss: 0.1950076
Validation loss decreased (0.229802 --> 0.220542).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 12 cost time: 0.9586308002471924
Epoch: 12, Steps: 64 | Train Loss: 0.1364305 Vali Loss: 0.2124737 Test Loss: 0.1881573
Validation loss decreased (0.220542 --> 0.212474).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 13 cost time: 0.9586343765258789
Epoch: 13, Steps: 64 | Train Loss: 0.1329239 Vali Loss: 0.2040872 Test Loss: 0.1796198
Validation loss decreased (0.212474 --> 0.204087).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 14 cost time: 0.9354579448699951
Epoch: 14, Steps: 64 | Train Loss: 0.1312041 Vali Loss: 0.2007664 Test Loss: 0.1748986
Validation loss decreased (0.204087 --> 0.200766).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 15 cost time: 0.9287629127502441
Epoch: 15, Steps: 64 | Train Loss: 0.1291311 Vali Loss: 0.1966296 Test Loss: 0.1699994
Validation loss decreased (0.200766 --> 0.196630).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 16 cost time: 0.9273765087127686
Epoch: 16, Steps: 64 | Train Loss: 0.1265109 Vali Loss: 0.1924363 Test Loss: 0.1670680
Validation loss decreased (0.196630 --> 0.192436).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 17 cost time: 0.9418420791625977
Epoch: 17, Steps: 64 | Train Loss: 0.1257121 Vali Loss: 0.1931303 Test Loss: 0.1659767
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 18 cost time: 0.9487905502319336
Epoch: 18, Steps: 64 | Train Loss: 0.1244646 Vali Loss: 0.1874639 Test Loss: 0.1631206
Validation loss decreased (0.192436 --> 0.187464).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 19 cost time: 0.9520013332366943
Epoch: 19, Steps: 64 | Train Loss: 0.1239741 Vali Loss: 0.1862034 Test Loss: 0.1610029
Validation loss decreased (0.187464 --> 0.186203).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 20 cost time: 0.9676539897918701
Epoch: 20, Steps: 64 | Train Loss: 0.1226664 Vali Loss: 0.1852759 Test Loss: 0.1611559
Validation loss decreased (0.186203 --> 0.185276).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 21 cost time: 0.9486274719238281
Epoch: 21, Steps: 64 | Train Loss: 0.1219933 Vali Loss: 0.1842788 Test Loss: 0.1592971
Validation loss decreased (0.185276 --> 0.184279).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 22 cost time: 0.945415735244751
Epoch: 22, Steps: 64 | Train Loss: 0.1214407 Vali Loss: 0.1813659 Test Loss: 0.1571845
Validation loss decreased (0.184279 --> 0.181366).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 23 cost time: 0.9584600925445557
Epoch: 23, Steps: 64 | Train Loss: 0.1207850 Vali Loss: 0.1827731 Test Loss: 0.1580501
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 24 cost time: 0.9030749797821045
Epoch: 24, Steps: 64 | Train Loss: 0.1206789 Vali Loss: 0.1809943 Test Loss: 0.1572551
Validation loss decreased (0.181366 --> 0.180994).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 25 cost time: 0.9013888835906982
Epoch: 25, Steps: 64 | Train Loss: 0.1196044 Vali Loss: 0.1795944 Test Loss: 0.1560221
Validation loss decreased (0.180994 --> 0.179594).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 26 cost time: 0.9127397537231445
Epoch: 26, Steps: 64 | Train Loss: 0.1186974 Vali Loss: 0.1804109 Test Loss: 0.1553804
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 27 cost time: 0.930999755859375
Epoch: 27, Steps: 64 | Train Loss: 0.1189272 Vali Loss: 0.1790678 Test Loss: 0.1539266
Validation loss decreased (0.179594 --> 0.179068).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 28 cost time: 0.9219422340393066
Epoch: 28, Steps: 64 | Train Loss: 0.1185043 Vali Loss: 0.1809523 Test Loss: 0.1546909
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 29 cost time: 0.9296343326568604
Epoch: 29, Steps: 64 | Train Loss: 0.1184843 Vali Loss: 0.1805834 Test Loss: 0.1549158
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 30 cost time: 0.9293715953826904
Epoch: 30, Steps: 64 | Train Loss: 0.1176170 Vali Loss: 0.1803644 Test Loss: 0.1541402
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 31 cost time: 0.9243614673614502
Epoch: 31, Steps: 64 | Train Loss: 0.1176257 Vali Loss: 0.1765482 Test Loss: 0.1530958
Validation loss decreased (0.179068 --> 0.176548).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 32 cost time: 0.9334084987640381
Epoch: 32, Steps: 64 | Train Loss: 0.1172844 Vali Loss: 0.1785221 Test Loss: 0.1537648
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 33 cost time: 0.929473876953125
Epoch: 33, Steps: 64 | Train Loss: 0.1168009 Vali Loss: 0.1777003 Test Loss: 0.1525759
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 34 cost time: 0.9327511787414551
Epoch: 34, Steps: 64 | Train Loss: 0.1172595 Vali Loss: 0.1772735 Test Loss: 0.1525485
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 35 cost time: 0.956000804901123
Epoch: 35, Steps: 64 | Train Loss: 0.1168067 Vali Loss: 0.1776679 Test Loss: 0.1523280
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 36 cost time: 0.9526419639587402
Epoch: 36, Steps: 64 | Train Loss: 0.1164472 Vali Loss: 0.1771418 Test Loss: 0.1523325
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 37 cost time: 0.9656224250793457
Epoch: 37, Steps: 64 | Train Loss: 0.1160395 Vali Loss: 0.1764421 Test Loss: 0.1511790
Validation loss decreased (0.176548 --> 0.176442).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 38 cost time: 0.9564969539642334
Epoch: 38, Steps: 64 | Train Loss: 0.1164237 Vali Loss: 0.1779845 Test Loss: 0.1525261
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 39 cost time: 0.9514610767364502
Epoch: 39, Steps: 64 | Train Loss: 0.1164432 Vali Loss: 0.1744208 Test Loss: 0.1511296
Validation loss decreased (0.176442 --> 0.174421).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 40 cost time: 0.9491615295410156
Epoch: 40, Steps: 64 | Train Loss: 0.1162465 Vali Loss: 0.1772954 Test Loss: 0.1531584
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 41 cost time: 0.9120140075683594
Epoch: 41, Steps: 64 | Train Loss: 0.1161316 Vali Loss: 0.1763198 Test Loss: 0.1508259
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 42 cost time: 0.895761251449585
Epoch: 42, Steps: 64 | Train Loss: 0.1161542 Vali Loss: 0.1730972 Test Loss: 0.1511230
Validation loss decreased (0.174421 --> 0.173097).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 43 cost time: 0.8989992141723633
Epoch: 43, Steps: 64 | Train Loss: 0.1158527 Vali Loss: 0.1755888 Test Loss: 0.1516568
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 44 cost time: 0.9309995174407959
Epoch: 44, Steps: 64 | Train Loss: 0.1160376 Vali Loss: 0.1753626 Test Loss: 0.1520037
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 45 cost time: 0.9292697906494141
Epoch: 45, Steps: 64 | Train Loss: 0.1161567 Vali Loss: 0.1750411 Test Loss: 0.1514870
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 46 cost time: 0.9555623531341553
Epoch: 46, Steps: 64 | Train Loss: 0.1158588 Vali Loss: 0.1758085 Test Loss: 0.1511599
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 47 cost time: 0.9244794845581055
Epoch: 47, Steps: 64 | Train Loss: 0.1160762 Vali Loss: 0.1784530 Test Loss: 0.1523615
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 48 cost time: 0.9024274349212646
Epoch: 48, Steps: 64 | Train Loss: 0.1152256 Vali Loss: 0.1765639 Test Loss: 0.1511899
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 49 cost time: 0.9003913402557373
Epoch: 49, Steps: 64 | Train Loss: 0.1156181 Vali Loss: 0.1752917 Test Loss: 0.1503911
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 50 cost time: 0.9127614498138428
Epoch: 50, Steps: 64 | Train Loss: 0.1153583 Vali Loss: 0.1755439 Test Loss: 0.1516608
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 51 cost time: 0.931002140045166
Epoch: 51, Steps: 64 | Train Loss: 0.1158079 Vali Loss: 0.1756549 Test Loss: 0.1515634
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 52 cost time: 0.9507205486297607
Epoch: 52, Steps: 64 | Train Loss: 0.1155644 Vali Loss: 0.1753546 Test Loss: 0.1518699
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 53 cost time: 0.9521331787109375
Epoch: 53, Steps: 64 | Train Loss: 0.1148792 Vali Loss: 0.1731558 Test Loss: 0.1506106
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 54 cost time: 0.9604306221008301
Epoch: 54, Steps: 64 | Train Loss: 0.1154796 Vali Loss: 0.1757902 Test Loss: 0.1510507
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 55 cost time: 0.9574525356292725
Epoch: 55, Steps: 64 | Train Loss: 0.1157604 Vali Loss: 0.1740030 Test Loss: 0.1509542
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 56 cost time: 0.9464261531829834
Epoch: 56, Steps: 64 | Train Loss: 0.1152663 Vali Loss: 0.1748863 Test Loss: 0.1507904
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 57 cost time: 0.9545047283172607
Epoch: 57, Steps: 64 | Train Loss: 0.1152118 Vali Loss: 0.1725747 Test Loss: 0.1506044
Validation loss decreased (0.173097 --> 0.172575).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 58 cost time: 0.932750940322876
Epoch: 58, Steps: 64 | Train Loss: 0.1148603 Vali Loss: 0.1756110 Test Loss: 0.1506055
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 59 cost time: 0.934999942779541
Epoch: 59, Steps: 64 | Train Loss: 0.1150859 Vali Loss: 0.1728401 Test Loss: 0.1503049
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763153076171875 GB
GPU已分配内存的峰值：0.04045248031616211 GB
Epoch: 60 cost time: 0.9306435585021973
Epoch: 60, Steps: 64 | Train Loss: 0.1156359 Vali Loss: 0.1761184 Test Loss: 0.1512244
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15060439705848694, mae:0.2885226011276245, rse:0.20655694603919983
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.040667057037353516 GB
Epoch: 1 cost time: 2.345710039138794
Epoch: 1, Steps: 64 | Train Loss: 0.8292054 Vali Loss: 1.8414514 Test Loss: 3.4424710
Validation loss decreased (inf --> 1.841451).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 2 cost time: 0.9756100177764893
Epoch: 2, Steps: 64 | Train Loss: 0.6212190 Vali Loss: 1.0059103 Test Loss: 1.6699826
Validation loss decreased (1.841451 --> 1.005910).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 3 cost time: 0.963637113571167
Epoch: 3, Steps: 64 | Train Loss: 0.3578259 Vali Loss: 0.5805594 Test Loss: 0.8424926
Validation loss decreased (1.005910 --> 0.580559).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 4 cost time: 0.9666359424591064
Epoch: 4, Steps: 64 | Train Loss: 0.2132524 Vali Loss: 0.3442536 Test Loss: 0.3995801
Validation loss decreased (0.580559 --> 0.344254).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 5 cost time: 0.9483857154846191
Epoch: 5, Steps: 64 | Train Loss: 0.1502171 Vali Loss: 0.2511611 Test Loss: 0.2525392
Validation loss decreased (0.344254 --> 0.251161).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 6 cost time: 0.9463021755218506
Epoch: 6, Steps: 64 | Train Loss: 0.1275653 Vali Loss: 0.2093987 Test Loss: 0.1941338
Validation loss decreased (0.251161 --> 0.209399).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 7 cost time: 0.9530436992645264
Epoch: 7, Steps: 64 | Train Loss: 0.1179457 Vali Loss: 0.1949913 Test Loss: 0.1739081
Validation loss decreased (0.209399 --> 0.194991).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 8 cost time: 0.980438232421875
Epoch: 8, Steps: 64 | Train Loss: 0.1126845 Vali Loss: 0.1830700 Test Loss: 0.1633787
Validation loss decreased (0.194991 --> 0.183070).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 9 cost time: 0.9863617420196533
Epoch: 9, Steps: 64 | Train Loss: 0.1084324 Vali Loss: 0.1780844 Test Loss: 0.1597614
Validation loss decreased (0.183070 --> 0.178084).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 10 cost time: 0.977496862411499
Epoch: 10, Steps: 64 | Train Loss: 0.1070585 Vali Loss: 0.1789882 Test Loss: 0.1579846
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 11 cost time: 0.9893467426300049
Epoch: 11, Steps: 64 | Train Loss: 0.1049934 Vali Loss: 0.1715262 Test Loss: 0.1552947
Validation loss decreased (0.178084 --> 0.171526).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 12 cost time: 0.9828217029571533
Epoch: 12, Steps: 64 | Train Loss: 0.1034008 Vali Loss: 0.1713708 Test Loss: 0.1533852
Validation loss decreased (0.171526 --> 0.171371).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 13 cost time: 0.982001781463623
Epoch: 13, Steps: 64 | Train Loss: 0.1029227 Vali Loss: 0.1700763 Test Loss: 0.1530026
Validation loss decreased (0.171371 --> 0.170076).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 14 cost time: 0.9776821136474609
Epoch: 14, Steps: 64 | Train Loss: 0.1011275 Vali Loss: 0.1694133 Test Loss: 0.1544018
Validation loss decreased (0.170076 --> 0.169413).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 15 cost time: 0.9610006809234619
Epoch: 15, Steps: 64 | Train Loss: 0.1007295 Vali Loss: 0.1692764 Test Loss: 0.1520272
Validation loss decreased (0.169413 --> 0.169276).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 16 cost time: 0.9633655548095703
Epoch: 16, Steps: 64 | Train Loss: 0.0998286 Vali Loss: 0.1669659 Test Loss: 0.1528534
Validation loss decreased (0.169276 --> 0.166966).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 17 cost time: 0.9674053192138672
Epoch: 17, Steps: 64 | Train Loss: 0.0991498 Vali Loss: 0.1690238 Test Loss: 0.1526368
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 18 cost time: 0.9793620109558105
Epoch: 18, Steps: 64 | Train Loss: 0.0984996 Vali Loss: 0.1666194 Test Loss: 0.1521693
Validation loss decreased (0.166966 --> 0.166619).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 19 cost time: 0.9863605499267578
Epoch: 19, Steps: 64 | Train Loss: 0.0983145 Vali Loss: 0.1663721 Test Loss: 0.1517723
Validation loss decreased (0.166619 --> 0.166372).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 20 cost time: 0.9664132595062256
Epoch: 20, Steps: 64 | Train Loss: 0.0978520 Vali Loss: 0.1677183 Test Loss: 0.1526449
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 21 cost time: 0.954444408416748
Epoch: 21, Steps: 64 | Train Loss: 0.0979455 Vali Loss: 0.1647810 Test Loss: 0.1525701
Validation loss decreased (0.166372 --> 0.164781).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 22 cost time: 0.9387812614440918
Epoch: 22, Steps: 64 | Train Loss: 0.0968467 Vali Loss: 0.1641670 Test Loss: 0.1519747
Validation loss decreased (0.164781 --> 0.164167).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 23 cost time: 0.9407057762145996
Epoch: 23, Steps: 64 | Train Loss: 0.0969330 Vali Loss: 0.1661099 Test Loss: 0.1522066
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 24 cost time: 0.96384596824646
Epoch: 24, Steps: 64 | Train Loss: 0.0963270 Vali Loss: 0.1647888 Test Loss: 0.1515986
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 25 cost time: 0.9496591091156006
Epoch: 25, Steps: 64 | Train Loss: 0.0962701 Vali Loss: 0.1653144 Test Loss: 0.1518586
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 26 cost time: 0.9623081684112549
Epoch: 26, Steps: 64 | Train Loss: 0.0959628 Vali Loss: 0.1652534 Test Loss: 0.1518283
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 27 cost time: 0.9765470027923584
Epoch: 27, Steps: 64 | Train Loss: 0.0955627 Vali Loss: 0.1634148 Test Loss: 0.1514398
Validation loss decreased (0.164167 --> 0.163415).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 28 cost time: 0.9610781669616699
Epoch: 28, Steps: 64 | Train Loss: 0.0956354 Vali Loss: 0.1664794 Test Loss: 0.1524256
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 29 cost time: 0.9723849296569824
Epoch: 29, Steps: 64 | Train Loss: 0.0952587 Vali Loss: 0.1663563 Test Loss: 0.1517977
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 30 cost time: 0.969449520111084
Epoch: 30, Steps: 64 | Train Loss: 0.0952835 Vali Loss: 0.1630737 Test Loss: 0.1513947
Validation loss decreased (0.163415 --> 0.163074).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 31 cost time: 0.9597234725952148
Epoch: 31, Steps: 64 | Train Loss: 0.0949796 Vali Loss: 0.1647414 Test Loss: 0.1518180
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 32 cost time: 0.9654829502105713
Epoch: 32, Steps: 64 | Train Loss: 0.0946340 Vali Loss: 0.1627470 Test Loss: 0.1513464
Validation loss decreased (0.163074 --> 0.162747).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 33 cost time: 0.9640007019042969
Epoch: 33, Steps: 64 | Train Loss: 0.0947946 Vali Loss: 0.1633916 Test Loss: 0.1515907
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 34 cost time: 0.9929220676422119
Epoch: 34, Steps: 64 | Train Loss: 0.0952200 Vali Loss: 0.1639710 Test Loss: 0.1504608
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 35 cost time: 0.9896376132965088
Epoch: 35, Steps: 64 | Train Loss: 0.0947083 Vali Loss: 0.1639893 Test Loss: 0.1520579
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 36 cost time: 0.9899699687957764
Epoch: 36, Steps: 64 | Train Loss: 0.0944310 Vali Loss: 0.1634797 Test Loss: 0.1518392
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 37 cost time: 0.9904918670654297
Epoch: 37, Steps: 64 | Train Loss: 0.0947276 Vali Loss: 0.1625767 Test Loss: 0.1508649
Validation loss decreased (0.162747 --> 0.162577).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 38 cost time: 0.9717402458190918
Epoch: 38, Steps: 64 | Train Loss: 0.0944509 Vali Loss: 0.1642444 Test Loss: 0.1512529
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 39 cost time: 0.9512715339660645
Epoch: 39, Steps: 64 | Train Loss: 0.0940644 Vali Loss: 0.1636502 Test Loss: 0.1515689
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 40 cost time: 0.9410722255706787
Epoch: 40, Steps: 64 | Train Loss: 0.0946011 Vali Loss: 0.1632530 Test Loss: 0.1515521
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 41 cost time: 0.9427602291107178
Epoch: 41, Steps: 64 | Train Loss: 0.0947014 Vali Loss: 0.1626185 Test Loss: 0.1506262
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 42 cost time: 0.954683780670166
Epoch: 42, Steps: 64 | Train Loss: 0.0943005 Vali Loss: 0.1637383 Test Loss: 0.1511078
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 43 cost time: 0.9600002765655518
Epoch: 43, Steps: 64 | Train Loss: 0.0944298 Vali Loss: 0.1636617 Test Loss: 0.1510310
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 44 cost time: 0.9662835597991943
Epoch: 44, Steps: 64 | Train Loss: 0.0943201 Vali Loss: 0.1630578 Test Loss: 0.1513918
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 45 cost time: 0.9632914066314697
Epoch: 45, Steps: 64 | Train Loss: 0.0940720 Vali Loss: 0.1635706 Test Loss: 0.1508805
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 46 cost time: 0.9599184989929199
Epoch: 46, Steps: 64 | Train Loss: 0.0942321 Vali Loss: 0.1627465 Test Loss: 0.1506985
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 47 cost time: 0.958263635635376
Epoch: 47, Steps: 64 | Train Loss: 0.0938430 Vali Loss: 0.1634036 Test Loss: 0.1512880
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 48 cost time: 0.9474391937255859
Epoch: 48, Steps: 64 | Train Loss: 0.0940269 Vali Loss: 0.1626181 Test Loss: 0.1508074
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 49 cost time: 0.9584252834320068
Epoch: 49, Steps: 64 | Train Loss: 0.0938632 Vali Loss: 0.1626977 Test Loss: 0.1514319
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 50 cost time: 0.9650611877441406
Epoch: 50, Steps: 64 | Train Loss: 0.0939048 Vali Loss: 0.1655258 Test Loss: 0.1515213
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 51 cost time: 0.9257612228393555
Epoch: 51, Steps: 64 | Train Loss: 0.0938960 Vali Loss: 0.1643552 Test Loss: 0.1516270
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 52 cost time: 0.9833729267120361
Epoch: 52, Steps: 64 | Train Loss: 0.0940174 Vali Loss: 0.1643114 Test Loss: 0.1516735
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 53 cost time: 0.977642297744751
Epoch: 53, Steps: 64 | Train Loss: 0.0937955 Vali Loss: 0.1643728 Test Loss: 0.1509445
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 54 cost time: 0.9858603477478027
Epoch: 54, Steps: 64 | Train Loss: 0.0942196 Vali Loss: 0.1620896 Test Loss: 0.1509624
Validation loss decreased (0.162577 --> 0.162090).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 55 cost time: 0.9673840999603271
Epoch: 55, Steps: 64 | Train Loss: 0.0940686 Vali Loss: 0.1622853 Test Loss: 0.1503747
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 56 cost time: 0.9540696144104004
Epoch: 56, Steps: 64 | Train Loss: 0.0938356 Vali Loss: 0.1630162 Test Loss: 0.1509849
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 57 cost time: 0.9744815826416016
Epoch: 57, Steps: 64 | Train Loss: 0.0936573 Vali Loss: 0.1637417 Test Loss: 0.1512896
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 58 cost time: 0.9583477973937988
Epoch: 58, Steps: 64 | Train Loss: 0.0944225 Vali Loss: 0.1632716 Test Loss: 0.1505733
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 59 cost time: 0.9604098796844482
Epoch: 59, Steps: 64 | Train Loss: 0.0940127 Vali Loss: 0.1639611 Test Loss: 0.1503793
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017669677734375 GB
GPU已分配内存的峰值：0.0412135124206543 GB
Epoch: 60 cost time: 0.9663660526275635
Epoch: 60, Steps: 64 | Train Loss: 0.0938429 Vali Loss: 0.1641071 Test Loss: 0.1512654
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15096233785152435, mae:0.29497861862182617, rse:0.20680226385593414
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04123115539550781 GB
Epoch: 1 cost time: 2.3738508224487305
Epoch: 1, Steps: 64 | Train Loss: 0.7915234 Vali Loss: 1.8584460 Test Loss: 3.5741770
Validation loss decreased (inf --> 1.858446).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 2 cost time: 0.9933886528015137
Epoch: 2, Steps: 64 | Train Loss: 0.6591997 Vali Loss: 1.2101798 Test Loss: 2.2163441
Validation loss decreased (1.858446 --> 1.210180).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 3 cost time: 1.0033869743347168
Epoch: 3, Steps: 64 | Train Loss: 0.4232254 Vali Loss: 0.7253028 Test Loss: 1.1997124
Validation loss decreased (1.210180 --> 0.725303).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 4 cost time: 1.0135200023651123
Epoch: 4, Steps: 64 | Train Loss: 0.2589825 Vali Loss: 0.4395188 Test Loss: 0.6295730
Validation loss decreased (0.725303 --> 0.439519).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 5 cost time: 1.011357069015503
Epoch: 5, Steps: 64 | Train Loss: 0.1707429 Vali Loss: 0.2921108 Test Loss: 0.3471480
Validation loss decreased (0.439519 --> 0.292111).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 6 cost time: 1.010864019393921
Epoch: 6, Steps: 64 | Train Loss: 0.1307477 Vali Loss: 0.2261720 Test Loss: 0.2266122
Validation loss decreased (0.292111 --> 0.226172).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 7 cost time: 0.9720973968505859
Epoch: 7, Steps: 64 | Train Loss: 0.1134661 Vali Loss: 0.1967782 Test Loss: 0.1786410
Validation loss decreased (0.226172 --> 0.196778).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 8 cost time: 0.9690001010894775
Epoch: 8, Steps: 64 | Train Loss: 0.1068521 Vali Loss: 0.1802959 Test Loss: 0.1615889
Validation loss decreased (0.196778 --> 0.180296).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 9 cost time: 0.993433952331543
Epoch: 9, Steps: 64 | Train Loss: 0.1035899 Vali Loss: 0.1768663 Test Loss: 0.1562438
Validation loss decreased (0.180296 --> 0.176866).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 10 cost time: 1.0016424655914307
Epoch: 10, Steps: 64 | Train Loss: 0.1016458 Vali Loss: 0.1729845 Test Loss: 0.1538506
Validation loss decreased (0.176866 --> 0.172985).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 11 cost time: 1.0086398124694824
Epoch: 11, Steps: 64 | Train Loss: 0.1004642 Vali Loss: 0.1683406 Test Loss: 0.1524066
Validation loss decreased (0.172985 --> 0.168341).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 12 cost time: 1.0164859294891357
Epoch: 12, Steps: 64 | Train Loss: 0.0989466 Vali Loss: 0.1704567 Test Loss: 0.1515492
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 13 cost time: 0.9904208183288574
Epoch: 13, Steps: 64 | Train Loss: 0.0979362 Vali Loss: 0.1687705 Test Loss: 0.1502685
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 14 cost time: 0.9943630695343018
Epoch: 14, Steps: 64 | Train Loss: 0.0975347 Vali Loss: 0.1655200 Test Loss: 0.1495653
Validation loss decreased (0.168341 --> 0.165520).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 15 cost time: 0.9900782108306885
Epoch: 15, Steps: 64 | Train Loss: 0.0968717 Vali Loss: 0.1647722 Test Loss: 0.1497483
Validation loss decreased (0.165520 --> 0.164772).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 16 cost time: 0.9994409084320068
Epoch: 16, Steps: 64 | Train Loss: 0.0958376 Vali Loss: 0.1657755 Test Loss: 0.1498661
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 17 cost time: 1.0156729221343994
Epoch: 17, Steps: 64 | Train Loss: 0.0957018 Vali Loss: 0.1646299 Test Loss: 0.1502283
Validation loss decreased (0.164772 --> 0.164630).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 18 cost time: 1.01588773727417
Epoch: 18, Steps: 64 | Train Loss: 0.0951852 Vali Loss: 0.1656760 Test Loss: 0.1497267
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 19 cost time: 0.9910249710083008
Epoch: 19, Steps: 64 | Train Loss: 0.0947301 Vali Loss: 0.1622368 Test Loss: 0.1480940
Validation loss decreased (0.164630 --> 0.162237).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 20 cost time: 0.980316162109375
Epoch: 20, Steps: 64 | Train Loss: 0.0943515 Vali Loss: 0.1613950 Test Loss: 0.1489409
Validation loss decreased (0.162237 --> 0.161395).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 21 cost time: 0.9637506008148193
Epoch: 21, Steps: 64 | Train Loss: 0.0941728 Vali Loss: 0.1642606 Test Loss: 0.1493813
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 22 cost time: 0.9583511352539062
Epoch: 22, Steps: 64 | Train Loss: 0.0938417 Vali Loss: 0.1632162 Test Loss: 0.1498085
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 23 cost time: 0.9746582508087158
Epoch: 23, Steps: 64 | Train Loss: 0.0937701 Vali Loss: 0.1619509 Test Loss: 0.1492963
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 24 cost time: 0.9624233245849609
Epoch: 24, Steps: 64 | Train Loss: 0.0934290 Vali Loss: 0.1618499 Test Loss: 0.1485244
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 25 cost time: 0.9695537090301514
Epoch: 25, Steps: 64 | Train Loss: 0.0933032 Vali Loss: 0.1620948 Test Loss: 0.1489780
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 26 cost time: 0.9934096336364746
Epoch: 26, Steps: 64 | Train Loss: 0.0928200 Vali Loss: 0.1598934 Test Loss: 0.1491970
Validation loss decreased (0.161395 --> 0.159893).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 27 cost time: 0.9793787002563477
Epoch: 27, Steps: 64 | Train Loss: 0.0930463 Vali Loss: 0.1619353 Test Loss: 0.1492586
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 28 cost time: 0.992823600769043
Epoch: 28, Steps: 64 | Train Loss: 0.0928460 Vali Loss: 0.1608278 Test Loss: 0.1497482
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 29 cost time: 1.0110690593719482
Epoch: 29, Steps: 64 | Train Loss: 0.0925788 Vali Loss: 0.1634292 Test Loss: 0.1499285
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 30 cost time: 1.0012435913085938
Epoch: 30, Steps: 64 | Train Loss: 0.0921207 Vali Loss: 0.1622130 Test Loss: 0.1497524
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 31 cost time: 1.0143890380859375
Epoch: 31, Steps: 64 | Train Loss: 0.0921904 Vali Loss: 0.1606630 Test Loss: 0.1493774
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 32 cost time: 1.0127604007720947
Epoch: 32, Steps: 64 | Train Loss: 0.0923025 Vali Loss: 0.1609609 Test Loss: 0.1487190
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 33 cost time: 1.00783109664917
Epoch: 33, Steps: 64 | Train Loss: 0.0920273 Vali Loss: 0.1605898 Test Loss: 0.1490302
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 34 cost time: 1.0093812942504883
Epoch: 34, Steps: 64 | Train Loss: 0.0919671 Vali Loss: 0.1592741 Test Loss: 0.1484133
Validation loss decreased (0.159893 --> 0.159274).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 35 cost time: 1.0240001678466797
Epoch: 35, Steps: 64 | Train Loss: 0.0921742 Vali Loss: 0.1615007 Test Loss: 0.1498249
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 36 cost time: 1.0196447372436523
Epoch: 36, Steps: 64 | Train Loss: 0.0917203 Vali Loss: 0.1601188 Test Loss: 0.1492081
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 37 cost time: 1.0016486644744873
Epoch: 37, Steps: 64 | Train Loss: 0.0918720 Vali Loss: 0.1602016 Test Loss: 0.1488544
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 38 cost time: 0.9595861434936523
Epoch: 38, Steps: 64 | Train Loss: 0.0920903 Vali Loss: 0.1604228 Test Loss: 0.1483752
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 39 cost time: 0.9673843383789062
Epoch: 39, Steps: 64 | Train Loss: 0.0921402 Vali Loss: 0.1606258 Test Loss: 0.1496702
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 40 cost time: 0.9643747806549072
Epoch: 40, Steps: 64 | Train Loss: 0.0915868 Vali Loss: 0.1599644 Test Loss: 0.1487852
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 41 cost time: 0.9613969326019287
Epoch: 41, Steps: 64 | Train Loss: 0.0918223 Vali Loss: 0.1599218 Test Loss: 0.1482199
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 42 cost time: 0.9899733066558838
Epoch: 42, Steps: 64 | Train Loss: 0.0917612 Vali Loss: 0.1615669 Test Loss: 0.1496108
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 43 cost time: 0.982414722442627
Epoch: 43, Steps: 64 | Train Loss: 0.0918168 Vali Loss: 0.1605135 Test Loss: 0.1500869
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 44 cost time: 0.9887409210205078
Epoch: 44, Steps: 64 | Train Loss: 0.0918859 Vali Loss: 0.1605775 Test Loss: 0.1485780
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 45 cost time: 0.9817759990692139
Epoch: 45, Steps: 64 | Train Loss: 0.0917024 Vali Loss: 0.1616021 Test Loss: 0.1500117
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 46 cost time: 0.9653933048248291
Epoch: 46, Steps: 64 | Train Loss: 0.0921599 Vali Loss: 0.1595518 Test Loss: 0.1489979
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 47 cost time: 0.9789998531341553
Epoch: 47, Steps: 64 | Train Loss: 0.0919248 Vali Loss: 0.1600447 Test Loss: 0.1497525
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 48 cost time: 0.9976344108581543
Epoch: 48, Steps: 64 | Train Loss: 0.0918557 Vali Loss: 0.1601672 Test Loss: 0.1482186
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 49 cost time: 1.004476547241211
Epoch: 49, Steps: 64 | Train Loss: 0.0913324 Vali Loss: 0.1600974 Test Loss: 0.1494146
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 50 cost time: 1.011085033416748
Epoch: 50, Steps: 64 | Train Loss: 0.0918628 Vali Loss: 0.1601630 Test Loss: 0.1497760
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 51 cost time: 1.0140206813812256
Epoch: 51, Steps: 64 | Train Loss: 0.0919057 Vali Loss: 0.1604390 Test Loss: 0.1494534
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 52 cost time: 1.0119695663452148
Epoch: 52, Steps: 64 | Train Loss: 0.0913791 Vali Loss: 0.1593435 Test Loss: 0.1498998
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 53 cost time: 1.0206108093261719
Epoch: 53, Steps: 64 | Train Loss: 0.0910952 Vali Loss: 0.1604891 Test Loss: 0.1495020
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 54 cost time: 1.0173473358154297
Epoch: 54, Steps: 64 | Train Loss: 0.0915145 Vali Loss: 0.1604906 Test Loss: 0.1483267
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 55 cost time: 1.0174853801727295
Epoch: 55, Steps: 64 | Train Loss: 0.0917197 Vali Loss: 0.1599671 Test Loss: 0.1493111
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 56 cost time: 0.9663686752319336
Epoch: 56, Steps: 64 | Train Loss: 0.0912209 Vali Loss: 0.1618026 Test Loss: 0.1489231
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 57 cost time: 0.9578015804290771
Epoch: 57, Steps: 64 | Train Loss: 0.0913077 Vali Loss: 0.1606110 Test Loss: 0.1491721
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 58 cost time: 0.9842061996459961
Epoch: 58, Steps: 64 | Train Loss: 0.0917256 Vali Loss: 0.1593227 Test Loss: 0.1486468
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 59 cost time: 0.9839999675750732
Epoch: 59, Steps: 64 | Train Loss: 0.0916194 Vali Loss: 0.1590792 Test Loss: 0.1493119
Validation loss decreased (0.159274 --> 0.159079).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01769256591796875 GB
GPU已分配内存的峰值：0.04196310043334961 GB
Epoch: 60 cost time: 0.9900002479553223
Epoch: 60, Steps: 64 | Train Loss: 0.0915491 Vali Loss: 0.1611083 Test Loss: 0.1500392
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1493118852376938, mae:0.2948087155818939, rse:0.20566868782043457
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.040126800537109375 GB
Epoch: 1 cost time: 2.3093254566192627
Epoch: 1, Steps: 64 | Train Loss: 0.6630671 Vali Loss: 1.2588294 Test Loss: 2.2647047
Validation loss decreased (inf --> 1.258829).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 2 cost time: 0.939755916595459
Epoch: 2, Steps: 64 | Train Loss: 0.4548683 Vali Loss: 0.6037802 Test Loss: 0.9158202
Validation loss decreased (1.258829 --> 0.603780).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 3 cost time: 0.9433872699737549
Epoch: 3, Steps: 64 | Train Loss: 0.2967284 Vali Loss: 0.4504394 Test Loss: 0.6125081
Validation loss decreased (0.603780 --> 0.450439).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 4 cost time: 0.941641092300415
Epoch: 4, Steps: 64 | Train Loss: 0.2267347 Vali Loss: 0.3543659 Test Loss: 0.4298403
Validation loss decreased (0.450439 --> 0.354366).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 5 cost time: 0.9220483303070068
Epoch: 5, Steps: 64 | Train Loss: 0.1870530 Vali Loss: 0.2985983 Test Loss: 0.3253898
Validation loss decreased (0.354366 --> 0.298598).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 6 cost time: 0.9124081134796143
Epoch: 6, Steps: 64 | Train Loss: 0.1627454 Vali Loss: 0.2579592 Test Loss: 0.2626603
Validation loss decreased (0.298598 --> 0.257959).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 7 cost time: 0.9033901691436768
Epoch: 7, Steps: 64 | Train Loss: 0.1483159 Vali Loss: 0.2347806 Test Loss: 0.2266253
Validation loss decreased (0.257959 --> 0.234781).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 8 cost time: 0.9123868942260742
Epoch: 8, Steps: 64 | Train Loss: 0.1389505 Vali Loss: 0.2199693 Test Loss: 0.2014391
Validation loss decreased (0.234781 --> 0.219969).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 9 cost time: 0.9317724704742432
Epoch: 9, Steps: 64 | Train Loss: 0.1333560 Vali Loss: 0.2104825 Test Loss: 0.1879433
Validation loss decreased (0.219969 --> 0.210483).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 10 cost time: 0.9430007934570312
Epoch: 10, Steps: 64 | Train Loss: 0.1295722 Vali Loss: 0.2026377 Test Loss: 0.1789126
Validation loss decreased (0.210483 --> 0.202638).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 11 cost time: 0.9702506065368652
Epoch: 11, Steps: 64 | Train Loss: 0.1259731 Vali Loss: 0.1937850 Test Loss: 0.1711839
Validation loss decreased (0.202638 --> 0.193785).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 12 cost time: 0.9686076641082764
Epoch: 12, Steps: 64 | Train Loss: 0.1232036 Vali Loss: 0.1881775 Test Loss: 0.1653968
Validation loss decreased (0.193785 --> 0.188178).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 13 cost time: 0.9636480808258057
Epoch: 13, Steps: 64 | Train Loss: 0.1222703 Vali Loss: 0.1872860 Test Loss: 0.1628169
Validation loss decreased (0.188178 --> 0.187286).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 14 cost time: 0.9328329563140869
Epoch: 14, Steps: 64 | Train Loss: 0.1197962 Vali Loss: 0.1861804 Test Loss: 0.1619127
Validation loss decreased (0.187286 --> 0.186180).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 15 cost time: 0.9413752555847168
Epoch: 15, Steps: 64 | Train Loss: 0.1184994 Vali Loss: 0.1832394 Test Loss: 0.1586737
Validation loss decreased (0.186180 --> 0.183239).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 16 cost time: 0.9423584938049316
Epoch: 16, Steps: 64 | Train Loss: 0.1176390 Vali Loss: 0.1799394 Test Loss: 0.1582678
Validation loss decreased (0.183239 --> 0.179939).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 17 cost time: 0.9364008903503418
Epoch: 17, Steps: 64 | Train Loss: 0.1167539 Vali Loss: 0.1791400 Test Loss: 0.1571555
Validation loss decreased (0.179939 --> 0.179140).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 18 cost time: 0.9677555561065674
Epoch: 18, Steps: 64 | Train Loss: 0.1158606 Vali Loss: 0.1808063 Test Loss: 0.1565188
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 19 cost time: 0.9601552486419678
Epoch: 19, Steps: 64 | Train Loss: 0.1154313 Vali Loss: 0.1762958 Test Loss: 0.1546872
Validation loss decreased (0.179140 --> 0.176296).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 20 cost time: 0.9699997901916504
Epoch: 20, Steps: 64 | Train Loss: 0.1143620 Vali Loss: 0.1779300 Test Loss: 0.1551941
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 21 cost time: 0.9421260356903076
Epoch: 21, Steps: 64 | Train Loss: 0.1137659 Vali Loss: 0.1779126 Test Loss: 0.1549636
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 22 cost time: 0.9286212921142578
Epoch: 22, Steps: 64 | Train Loss: 0.1137233 Vali Loss: 0.1766659 Test Loss: 0.1537176
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 23 cost time: 0.9157946109771729
Epoch: 23, Steps: 64 | Train Loss: 0.1120244 Vali Loss: 0.1760200 Test Loss: 0.1535463
Validation loss decreased (0.176296 --> 0.176020).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 24 cost time: 0.9174277782440186
Epoch: 24, Steps: 64 | Train Loss: 0.1126753 Vali Loss: 0.1750486 Test Loss: 0.1528934
Validation loss decreased (0.176020 --> 0.175049).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 25 cost time: 0.9185006618499756
Epoch: 25, Steps: 64 | Train Loss: 0.1123308 Vali Loss: 0.1766055 Test Loss: 0.1529486
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 26 cost time: 0.9323282241821289
Epoch: 26, Steps: 64 | Train Loss: 0.1112541 Vali Loss: 0.1733335 Test Loss: 0.1524974
Validation loss decreased (0.175049 --> 0.173333).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 27 cost time: 0.9417715072631836
Epoch: 27, Steps: 64 | Train Loss: 0.1116955 Vali Loss: 0.1734140 Test Loss: 0.1522988
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 28 cost time: 0.9420828819274902
Epoch: 28, Steps: 64 | Train Loss: 0.1107910 Vali Loss: 0.1745591 Test Loss: 0.1516977
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 29 cost time: 0.9096400737762451
Epoch: 29, Steps: 64 | Train Loss: 0.1106129 Vali Loss: 0.1735763 Test Loss: 0.1515464
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 30 cost time: 0.9183328151702881
Epoch: 30, Steps: 64 | Train Loss: 0.1106014 Vali Loss: 0.1731321 Test Loss: 0.1515430
Validation loss decreased (0.173333 --> 0.173132).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 31 cost time: 0.9423828125
Epoch: 31, Steps: 64 | Train Loss: 0.1102679 Vali Loss: 0.1721480 Test Loss: 0.1509397
Validation loss decreased (0.173132 --> 0.172148).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 32 cost time: 0.952113151550293
Epoch: 32, Steps: 64 | Train Loss: 0.1101340 Vali Loss: 0.1703019 Test Loss: 0.1501806
Validation loss decreased (0.172148 --> 0.170302).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 33 cost time: 0.9471242427825928
Epoch: 33, Steps: 64 | Train Loss: 0.1105109 Vali Loss: 0.1712469 Test Loss: 0.1505339
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 34 cost time: 0.9454314708709717
Epoch: 34, Steps: 64 | Train Loss: 0.1099907 Vali Loss: 0.1738275 Test Loss: 0.1515160
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 35 cost time: 0.9647271633148193
Epoch: 35, Steps: 64 | Train Loss: 0.1094963 Vali Loss: 0.1732052 Test Loss: 0.1516563
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 36 cost time: 0.9707696437835693
Epoch: 36, Steps: 64 | Train Loss: 0.1095167 Vali Loss: 0.1705718 Test Loss: 0.1505725
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 37 cost time: 0.9636273384094238
Epoch: 37, Steps: 64 | Train Loss: 0.1094410 Vali Loss: 0.1713392 Test Loss: 0.1514020
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 38 cost time: 0.970632791519165
Epoch: 38, Steps: 64 | Train Loss: 0.1099285 Vali Loss: 0.1725640 Test Loss: 0.1506933
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 39 cost time: 0.9556317329406738
Epoch: 39, Steps: 64 | Train Loss: 0.1087892 Vali Loss: 0.1712583 Test Loss: 0.1507831
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 40 cost time: 0.9323596954345703
Epoch: 40, Steps: 64 | Train Loss: 0.1093914 Vali Loss: 0.1718536 Test Loss: 0.1508786
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 41 cost time: 0.9060893058776855
Epoch: 41, Steps: 64 | Train Loss: 0.1093662 Vali Loss: 0.1704209 Test Loss: 0.1497596
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 42 cost time: 0.9164175987243652
Epoch: 42, Steps: 64 | Train Loss: 0.1088435 Vali Loss: 0.1705722 Test Loss: 0.1505212
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 43 cost time: 0.9417474269866943
Epoch: 43, Steps: 64 | Train Loss: 0.1094502 Vali Loss: 0.1720437 Test Loss: 0.1507859
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 44 cost time: 0.9388115406036377
Epoch: 44, Steps: 64 | Train Loss: 0.1089524 Vali Loss: 0.1706315 Test Loss: 0.1503674
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 45 cost time: 0.9353747367858887
Epoch: 45, Steps: 64 | Train Loss: 0.1088142 Vali Loss: 0.1704426 Test Loss: 0.1505555
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 46 cost time: 0.9486443996429443
Epoch: 46, Steps: 64 | Train Loss: 0.1089621 Vali Loss: 0.1721647 Test Loss: 0.1500380
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 47 cost time: 0.9213805198669434
Epoch: 47, Steps: 64 | Train Loss: 0.1083372 Vali Loss: 0.1705033 Test Loss: 0.1511149
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 48 cost time: 0.9178094863891602
Epoch: 48, Steps: 64 | Train Loss: 0.1086510 Vali Loss: 0.1704209 Test Loss: 0.1503231
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 49 cost time: 0.9133601188659668
Epoch: 49, Steps: 64 | Train Loss: 0.1088652 Vali Loss: 0.1721125 Test Loss: 0.1511986
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 50 cost time: 0.9163928031921387
Epoch: 50, Steps: 64 | Train Loss: 0.1087865 Vali Loss: 0.1701295 Test Loss: 0.1504371
Validation loss decreased (0.170302 --> 0.170130).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 51 cost time: 0.9567394256591797
Epoch: 51, Steps: 64 | Train Loss: 0.1084738 Vali Loss: 0.1718223 Test Loss: 0.1504150
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 52 cost time: 0.9657750129699707
Epoch: 52, Steps: 64 | Train Loss: 0.1087628 Vali Loss: 0.1708530 Test Loss: 0.1509345
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 53 cost time: 0.972944974899292
Epoch: 53, Steps: 64 | Train Loss: 0.1083869 Vali Loss: 0.1698272 Test Loss: 0.1497662
Validation loss decreased (0.170130 --> 0.169827).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 54 cost time: 0.9666416645050049
Epoch: 54, Steps: 64 | Train Loss: 0.1086619 Vali Loss: 0.1699018 Test Loss: 0.1497922
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 55 cost time: 0.9706463813781738
Epoch: 55, Steps: 64 | Train Loss: 0.1076827 Vali Loss: 0.1706653 Test Loss: 0.1509720
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 56 cost time: 0.9558095932006836
Epoch: 56, Steps: 64 | Train Loss: 0.1087781 Vali Loss: 0.1719315 Test Loss: 0.1517157
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 57 cost time: 0.9530074596405029
Epoch: 57, Steps: 64 | Train Loss: 0.1087085 Vali Loss: 0.1714235 Test Loss: 0.1507275
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 58 cost time: 0.9424114227294922
Epoch: 58, Steps: 64 | Train Loss: 0.1088133 Vali Loss: 0.1719042 Test Loss: 0.1499819
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 59 cost time: 0.9434201717376709
Epoch: 59, Steps: 64 | Train Loss: 0.1092791 Vali Loss: 0.1688678 Test Loss: 0.1492683
Validation loss decreased (0.169827 --> 0.168868).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04061555862426758 GB
Epoch: 60 cost time: 0.9623901844024658
Epoch: 60, Steps: 64 | Train Loss: 0.1088723 Vali Loss: 0.1716261 Test Loss: 0.1510567
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14926832914352417, mae:0.2886841595172882, rse:0.20563867688179016
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.04082822799682617 GB
Epoch: 1 cost time: 2.372661590576172
Epoch: 1, Steps: 64 | Train Loss: 0.8418344 Vali Loss: 1.8836187 Test Loss: 3.5279744
Validation loss decreased (inf --> 1.883619).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 2 cost time: 0.9921770095825195
Epoch: 2, Steps: 64 | Train Loss: 0.5957496 Vali Loss: 0.9016065 Test Loss: 1.4913347
Validation loss decreased (1.883619 --> 0.901607).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 3 cost time: 0.9605152606964111
Epoch: 3, Steps: 64 | Train Loss: 0.3077963 Vali Loss: 0.4286793 Test Loss: 0.5434036
Validation loss decreased (0.901607 --> 0.428679).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 4 cost time: 0.9617350101470947
Epoch: 4, Steps: 64 | Train Loss: 0.1690135 Vali Loss: 0.2654505 Test Loss: 0.2529447
Validation loss decreased (0.428679 --> 0.265451).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 5 cost time: 0.9332304000854492
Epoch: 5, Steps: 64 | Train Loss: 0.1283142 Vali Loss: 0.2197506 Test Loss: 0.1913813
Validation loss decreased (0.265451 --> 0.219751).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 6 cost time: 0.9489998817443848
Epoch: 6, Steps: 64 | Train Loss: 0.1176938 Vali Loss: 0.2034904 Test Loss: 0.1760175
Validation loss decreased (0.219751 --> 0.203490).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 7 cost time: 0.9485564231872559
Epoch: 7, Steps: 64 | Train Loss: 0.1130014 Vali Loss: 0.1952618 Test Loss: 0.1701826
Validation loss decreased (0.203490 --> 0.195262).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 8 cost time: 0.935638427734375
Epoch: 8, Steps: 64 | Train Loss: 0.1097310 Vali Loss: 0.1895741 Test Loss: 0.1664609
Validation loss decreased (0.195262 --> 0.189574).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 9 cost time: 0.9735102653503418
Epoch: 9, Steps: 64 | Train Loss: 0.1072936 Vali Loss: 0.1843576 Test Loss: 0.1658917
Validation loss decreased (0.189574 --> 0.184358).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 10 cost time: 0.9735431671142578
Epoch: 10, Steps: 64 | Train Loss: 0.1056467 Vali Loss: 0.1859806 Test Loss: 0.1666731
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 11 cost time: 0.9875199794769287
Epoch: 11, Steps: 64 | Train Loss: 0.1033215 Vali Loss: 0.1820187 Test Loss: 0.1665108
Validation loss decreased (0.184358 --> 0.182019).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 12 cost time: 1.014352560043335
Epoch: 12, Steps: 64 | Train Loss: 0.1023843 Vali Loss: 0.1797056 Test Loss: 0.1651761
Validation loss decreased (0.182019 --> 0.179706).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 13 cost time: 0.974484920501709
Epoch: 13, Steps: 64 | Train Loss: 0.1011873 Vali Loss: 0.1774800 Test Loss: 0.1656235
Validation loss decreased (0.179706 --> 0.177480).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 14 cost time: 0.9704060554504395
Epoch: 14, Steps: 64 | Train Loss: 0.1004163 Vali Loss: 0.1772274 Test Loss: 0.1660632
Validation loss decreased (0.177480 --> 0.177227).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 15 cost time: 0.9821603298187256
Epoch: 15, Steps: 64 | Train Loss: 0.1002321 Vali Loss: 0.1764489 Test Loss: 0.1661953
Validation loss decreased (0.177227 --> 0.176449).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 16 cost time: 0.9627468585968018
Epoch: 16, Steps: 64 | Train Loss: 0.0993233 Vali Loss: 0.1763496 Test Loss: 0.1645851
Validation loss decreased (0.176449 --> 0.176350).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 17 cost time: 0.9830005168914795
Epoch: 17, Steps: 64 | Train Loss: 0.0987158 Vali Loss: 0.1762499 Test Loss: 0.1663945
Validation loss decreased (0.176350 --> 0.176250).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 18 cost time: 0.9839973449707031
Epoch: 18, Steps: 64 | Train Loss: 0.0979458 Vali Loss: 0.1754823 Test Loss: 0.1650390
Validation loss decreased (0.176250 --> 0.175482).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 19 cost time: 1.0086429119110107
Epoch: 19, Steps: 64 | Train Loss: 0.0978963 Vali Loss: 0.1751208 Test Loss: 0.1647627
Validation loss decreased (0.175482 --> 0.175121).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 20 cost time: 0.9696164131164551
Epoch: 20, Steps: 64 | Train Loss: 0.0972033 Vali Loss: 0.1745813 Test Loss: 0.1651953
Validation loss decreased (0.175121 --> 0.174581).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 21 cost time: 0.9610590934753418
Epoch: 21, Steps: 64 | Train Loss: 0.0971000 Vali Loss: 0.1746846 Test Loss: 0.1666024
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 22 cost time: 0.9444212913513184
Epoch: 22, Steps: 64 | Train Loss: 0.0963981 Vali Loss: 0.1742653 Test Loss: 0.1647570
Validation loss decreased (0.174581 --> 0.174265).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 23 cost time: 0.9403951168060303
Epoch: 23, Steps: 64 | Train Loss: 0.0964943 Vali Loss: 0.1745834 Test Loss: 0.1665646
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 24 cost time: 0.9370574951171875
Epoch: 24, Steps: 64 | Train Loss: 0.0960998 Vali Loss: 0.1739553 Test Loss: 0.1664115
Validation loss decreased (0.174265 --> 0.173955).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 25 cost time: 0.9543962478637695
Epoch: 25, Steps: 64 | Train Loss: 0.0957321 Vali Loss: 0.1750821 Test Loss: 0.1657847
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 26 cost time: 0.961822509765625
Epoch: 26, Steps: 64 | Train Loss: 0.0957205 Vali Loss: 0.1731326 Test Loss: 0.1648187
Validation loss decreased (0.173955 --> 0.173133).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 27 cost time: 0.958000898361206
Epoch: 27, Steps: 64 | Train Loss: 0.0960464 Vali Loss: 0.1740765 Test Loss: 0.1657607
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 28 cost time: 0.9553840160369873
Epoch: 28, Steps: 64 | Train Loss: 0.0956525 Vali Loss: 0.1737992 Test Loss: 0.1666497
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 29 cost time: 0.9576354026794434
Epoch: 29, Steps: 64 | Train Loss: 0.0953397 Vali Loss: 0.1735737 Test Loss: 0.1667273
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 30 cost time: 0.9543783664703369
Epoch: 30, Steps: 64 | Train Loss: 0.0954848 Vali Loss: 0.1754093 Test Loss: 0.1665414
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 31 cost time: 0.9673972129821777
Epoch: 31, Steps: 64 | Train Loss: 0.0949793 Vali Loss: 0.1748769 Test Loss: 0.1664208
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 32 cost time: 0.9747819900512695
Epoch: 32, Steps: 64 | Train Loss: 0.0952976 Vali Loss: 0.1742039 Test Loss: 0.1665120
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 33 cost time: 0.9713811874389648
Epoch: 33, Steps: 64 | Train Loss: 0.0949342 Vali Loss: 0.1733240 Test Loss: 0.1673680
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 34 cost time: 0.9974863529205322
Epoch: 34, Steps: 64 | Train Loss: 0.0950183 Vali Loss: 0.1710119 Test Loss: 0.1644308
Validation loss decreased (0.173133 --> 0.171012).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 35 cost time: 0.9949545860290527
Epoch: 35, Steps: 64 | Train Loss: 0.0946617 Vali Loss: 0.1731916 Test Loss: 0.1674157
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 36 cost time: 0.9853987693786621
Epoch: 36, Steps: 64 | Train Loss: 0.0947958 Vali Loss: 0.1758010 Test Loss: 0.1677837
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 37 cost time: 0.990816593170166
Epoch: 37, Steps: 64 | Train Loss: 0.0948326 Vali Loss: 0.1731465 Test Loss: 0.1678014
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 38 cost time: 0.9883711338043213
Epoch: 38, Steps: 64 | Train Loss: 0.0948476 Vali Loss: 0.1711064 Test Loss: 0.1660578
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 39 cost time: 0.9779989719390869
Epoch: 39, Steps: 64 | Train Loss: 0.0942982 Vali Loss: 0.1745047 Test Loss: 0.1669467
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 40 cost time: 0.9830420017242432
Epoch: 40, Steps: 64 | Train Loss: 0.0946324 Vali Loss: 0.1763323 Test Loss: 0.1683836
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 41 cost time: 0.9816348552703857
Epoch: 41, Steps: 64 | Train Loss: 0.0945879 Vali Loss: 0.1729414 Test Loss: 0.1670823
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 42 cost time: 0.964428186416626
Epoch: 42, Steps: 64 | Train Loss: 0.0941701 Vali Loss: 0.1736610 Test Loss: 0.1675576
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 43 cost time: 0.9624185562133789
Epoch: 43, Steps: 64 | Train Loss: 0.0941999 Vali Loss: 0.1733408 Test Loss: 0.1665323
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 44 cost time: 0.9698019027709961
Epoch: 44, Steps: 64 | Train Loss: 0.0939171 Vali Loss: 0.1733463 Test Loss: 0.1664470
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 45 cost time: 0.9844489097595215
Epoch: 45, Steps: 64 | Train Loss: 0.0943622 Vali Loss: 0.1738411 Test Loss: 0.1667902
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 46 cost time: 0.9415478706359863
Epoch: 46, Steps: 64 | Train Loss: 0.0945842 Vali Loss: 0.1748554 Test Loss: 0.1661532
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 47 cost time: 0.9377543926239014
Epoch: 47, Steps: 64 | Train Loss: 0.0939240 Vali Loss: 0.1720706 Test Loss: 0.1667303
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 48 cost time: 0.934769868850708
Epoch: 48, Steps: 64 | Train Loss: 0.0948655 Vali Loss: 0.1734677 Test Loss: 0.1666355
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 49 cost time: 0.9439985752105713
Epoch: 49, Steps: 64 | Train Loss: 0.0946308 Vali Loss: 0.1737045 Test Loss: 0.1666994
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 50 cost time: 0.9836347103118896
Epoch: 50, Steps: 64 | Train Loss: 0.0944124 Vali Loss: 0.1735408 Test Loss: 0.1656734
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 51 cost time: 1.0026230812072754
Epoch: 51, Steps: 64 | Train Loss: 0.0940436 Vali Loss: 0.1742382 Test Loss: 0.1664117
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 52 cost time: 1.0042009353637695
Epoch: 52, Steps: 64 | Train Loss: 0.0943738 Vali Loss: 0.1751603 Test Loss: 0.1680880
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 53 cost time: 0.9854707717895508
Epoch: 53, Steps: 64 | Train Loss: 0.0936918 Vali Loss: 0.1738179 Test Loss: 0.1660480
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 54 cost time: 0.9815149307250977
Epoch: 54, Steps: 64 | Train Loss: 0.0942900 Vali Loss: 0.1734242 Test Loss: 0.1658880
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 55 cost time: 0.9745137691497803
Epoch: 55, Steps: 64 | Train Loss: 0.0940330 Vali Loss: 0.1734307 Test Loss: 0.1678596
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 56 cost time: 0.9683842658996582
Epoch: 56, Steps: 64 | Train Loss: 0.0945521 Vali Loss: 0.1734926 Test Loss: 0.1669300
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 57 cost time: 0.9690496921539307
Epoch: 57, Steps: 64 | Train Loss: 0.0942836 Vali Loss: 0.1752343 Test Loss: 0.1673242
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 58 cost time: 0.9687654972076416
Epoch: 58, Steps: 64 | Train Loss: 0.0945739 Vali Loss: 0.1728583 Test Loss: 0.1663252
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 59 cost time: 0.9909069538116455
Epoch: 59, Steps: 64 | Train Loss: 0.0937476 Vali Loss: 0.1720590 Test Loss: 0.1664281
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017673492431640625 GB
GPU已分配内存的峰值：0.041376590728759766 GB
Epoch: 60 cost time: 0.9899997711181641
Epoch: 60, Steps: 64 | Train Loss: 0.0942238 Vali Loss: 0.1738756 Test Loss: 0.1677421
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.16443082690238953, mae:0.3158901333808899, rse:0.21583038568496704
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04139232635498047 GB
Epoch: 1 cost time: 2.3860087394714355
Epoch: 1, Steps: 64 | Train Loss: 0.8329121 Vali Loss: 1.9329287 Test Loss: 3.6679506
Validation loss decreased (inf --> 1.932929).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 2 cost time: 1.0043540000915527
Epoch: 2, Steps: 64 | Train Loss: 0.6241047 Vali Loss: 1.0360191 Test Loss: 1.8136610
Validation loss decreased (1.932929 --> 1.036019).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 3 cost time: 0.9967477321624756
Epoch: 3, Steps: 64 | Train Loss: 0.3402537 Vali Loss: 0.5259964 Test Loss: 0.7463222
Validation loss decreased (1.036019 --> 0.525996).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 4 cost time: 1.000791072845459
Epoch: 4, Steps: 64 | Train Loss: 0.1834354 Vali Loss: 0.2878670 Test Loss: 0.2952190
Validation loss decreased (0.525996 --> 0.287867).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 5 cost time: 0.966433048248291
Epoch: 5, Steps: 64 | Train Loss: 0.1316580 Vali Loss: 0.2240709 Test Loss: 0.1994558
Validation loss decreased (0.287867 --> 0.224071).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 6 cost time: 0.9669992923736572
Epoch: 6, Steps: 64 | Train Loss: 0.1188672 Vali Loss: 0.2008117 Test Loss: 0.1772969
Validation loss decreased (0.224071 --> 0.200812).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 7 cost time: 0.9606420993804932
Epoch: 7, Steps: 64 | Train Loss: 0.1138005 Vali Loss: 0.1921470 Test Loss: 0.1705742
Validation loss decreased (0.200812 --> 0.192147).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 8 cost time: 0.9759044647216797
Epoch: 8, Steps: 64 | Train Loss: 0.1095968 Vali Loss: 0.1848470 Test Loss: 0.1643386
Validation loss decreased (0.192147 --> 0.184847).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 9 cost time: 1.003051996231079
Epoch: 9, Steps: 64 | Train Loss: 0.1069319 Vali Loss: 0.1801605 Test Loss: 0.1632383
Validation loss decreased (0.184847 --> 0.180160).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 10 cost time: 1.0184447765350342
Epoch: 10, Steps: 64 | Train Loss: 0.1054154 Vali Loss: 0.1769950 Test Loss: 0.1595839
Validation loss decreased (0.180160 --> 0.176995).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 11 cost time: 1.034543514251709
Epoch: 11, Steps: 64 | Train Loss: 0.1033057 Vali Loss: 0.1760700 Test Loss: 0.1597880
Validation loss decreased (0.176995 --> 0.176070).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 12 cost time: 1.0204894542694092
Epoch: 12, Steps: 64 | Train Loss: 0.1020301 Vali Loss: 0.1755436 Test Loss: 0.1593944
Validation loss decreased (0.176070 --> 0.175544).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 13 cost time: 1.0137746334075928
Epoch: 13, Steps: 64 | Train Loss: 0.1009535 Vali Loss: 0.1729279 Test Loss: 0.1582993
Validation loss decreased (0.175544 --> 0.172928).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 14 cost time: 1.0126354694366455
Epoch: 14, Steps: 64 | Train Loss: 0.1002959 Vali Loss: 0.1722025 Test Loss: 0.1572098
Validation loss decreased (0.172928 --> 0.172203).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 15 cost time: 0.9993817806243896
Epoch: 15, Steps: 64 | Train Loss: 0.0996920 Vali Loss: 0.1706181 Test Loss: 0.1566010
Validation loss decreased (0.172203 --> 0.170618).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 16 cost time: 1.00718092918396
Epoch: 16, Steps: 64 | Train Loss: 0.0989020 Vali Loss: 0.1707846 Test Loss: 0.1577363
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 17 cost time: 1.024007797241211
Epoch: 17, Steps: 64 | Train Loss: 0.0985006 Vali Loss: 0.1713695 Test Loss: 0.1573875
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 18 cost time: 1.0238354206085205
Epoch: 18, Steps: 64 | Train Loss: 0.0978292 Vali Loss: 0.1693199 Test Loss: 0.1569441
Validation loss decreased (0.170618 --> 0.169320).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 19 cost time: 1.0007660388946533
Epoch: 19, Steps: 64 | Train Loss: 0.0970833 Vali Loss: 0.1685064 Test Loss: 0.1565608
Validation loss decreased (0.169320 --> 0.168506).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 20 cost time: 0.9998683929443359
Epoch: 20, Steps: 64 | Train Loss: 0.0973291 Vali Loss: 0.1695442 Test Loss: 0.1567632
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 21 cost time: 0.9653134346008301
Epoch: 21, Steps: 64 | Train Loss: 0.0963888 Vali Loss: 0.1692259 Test Loss: 0.1558458
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 22 cost time: 0.9698596000671387
Epoch: 22, Steps: 64 | Train Loss: 0.0962479 Vali Loss: 0.1683329 Test Loss: 0.1560370
Validation loss decreased (0.168506 --> 0.168333).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 23 cost time: 0.9696364402770996
Epoch: 23, Steps: 64 | Train Loss: 0.0962188 Vali Loss: 0.1695117 Test Loss: 0.1574038
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 24 cost time: 0.9814298152923584
Epoch: 24, Steps: 64 | Train Loss: 0.0956416 Vali Loss: 0.1694934 Test Loss: 0.1575468
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 25 cost time: 0.9917795658111572
Epoch: 25, Steps: 64 | Train Loss: 0.0955272 Vali Loss: 0.1686022 Test Loss: 0.1571862
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 26 cost time: 1.0071911811828613
Epoch: 26, Steps: 64 | Train Loss: 0.0954358 Vali Loss: 0.1665741 Test Loss: 0.1568415
Validation loss decreased (0.168333 --> 0.166574).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 27 cost time: 0.9874265193939209
Epoch: 27, Steps: 64 | Train Loss: 0.0950867 Vali Loss: 0.1659113 Test Loss: 0.1568757
Validation loss decreased (0.166574 --> 0.165911).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 28 cost time: 1.012404441833496
Epoch: 28, Steps: 64 | Train Loss: 0.0951656 Vali Loss: 0.1672367 Test Loss: 0.1567940
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 29 cost time: 1.0224246978759766
Epoch: 29, Steps: 64 | Train Loss: 0.0952138 Vali Loss: 0.1668735 Test Loss: 0.1570804
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 30 cost time: 1.0245845317840576
Epoch: 30, Steps: 64 | Train Loss: 0.0946353 Vali Loss: 0.1681344 Test Loss: 0.1570234
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 31 cost time: 1.0113179683685303
Epoch: 31, Steps: 64 | Train Loss: 0.0947163 Vali Loss: 0.1683281 Test Loss: 0.1566891
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 32 cost time: 1.0140647888183594
Epoch: 32, Steps: 64 | Train Loss: 0.0946525 Vali Loss: 0.1690804 Test Loss: 0.1570750
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 33 cost time: 1.0367553234100342
Epoch: 33, Steps: 64 | Train Loss: 0.0943216 Vali Loss: 0.1675076 Test Loss: 0.1572579
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 34 cost time: 1.021874189376831
Epoch: 34, Steps: 64 | Train Loss: 0.0941223 Vali Loss: 0.1644167 Test Loss: 0.1564838
Validation loss decreased (0.165911 --> 0.164417).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 35 cost time: 1.0265507698059082
Epoch: 35, Steps: 64 | Train Loss: 0.0945371 Vali Loss: 0.1682201 Test Loss: 0.1570147
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 36 cost time: 1.0460007190704346
Epoch: 36, Steps: 64 | Train Loss: 0.0945402 Vali Loss: 0.1683145 Test Loss: 0.1578610
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 37 cost time: 1.0213873386383057
Epoch: 37, Steps: 64 | Train Loss: 0.0948937 Vali Loss: 0.1667370 Test Loss: 0.1565663
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 38 cost time: 1.0121257305145264
Epoch: 38, Steps: 64 | Train Loss: 0.0945229 Vali Loss: 0.1683177 Test Loss: 0.1560383
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 39 cost time: 1.0146448612213135
Epoch: 39, Steps: 64 | Train Loss: 0.0944660 Vali Loss: 0.1661841 Test Loss: 0.1566741
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 40 cost time: 0.9673891067504883
Epoch: 40, Steps: 64 | Train Loss: 0.0940162 Vali Loss: 0.1674871 Test Loss: 0.1569363
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 41 cost time: 0.9831454753875732
Epoch: 41, Steps: 64 | Train Loss: 0.0945352 Vali Loss: 0.1682375 Test Loss: 0.1565470
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 42 cost time: 0.9983839988708496
Epoch: 42, Steps: 64 | Train Loss: 0.0939970 Vali Loss: 0.1660838 Test Loss: 0.1567593
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 43 cost time: 0.9843742847442627
Epoch: 43, Steps: 64 | Train Loss: 0.0943087 Vali Loss: 0.1691727 Test Loss: 0.1573324
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 44 cost time: 1.0234885215759277
Epoch: 44, Steps: 64 | Train Loss: 0.0940754 Vali Loss: 0.1657576 Test Loss: 0.1563109
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 45 cost time: 1.0178194046020508
Epoch: 45, Steps: 64 | Train Loss: 0.0939023 Vali Loss: 0.1688667 Test Loss: 0.1573500
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 46 cost time: 1.016380786895752
Epoch: 46, Steps: 64 | Train Loss: 0.0944010 Vali Loss: 0.1654634 Test Loss: 0.1559917
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 47 cost time: 1.0043830871582031
Epoch: 47, Steps: 64 | Train Loss: 0.0938327 Vali Loss: 0.1665603 Test Loss: 0.1565386
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 48 cost time: 1.003464698791504
Epoch: 48, Steps: 64 | Train Loss: 0.0938241 Vali Loss: 0.1683287 Test Loss: 0.1568017
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 49 cost time: 1.0122997760772705
Epoch: 49, Steps: 64 | Train Loss: 0.0940464 Vali Loss: 0.1665825 Test Loss: 0.1566129
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 50 cost time: 1.0259780883789062
Epoch: 50, Steps: 64 | Train Loss: 0.0939488 Vali Loss: 0.1667860 Test Loss: 0.1573687
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 51 cost time: 1.0280020236968994
Epoch: 51, Steps: 64 | Train Loss: 0.0938003 Vali Loss: 0.1676294 Test Loss: 0.1567014
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 52 cost time: 1.039001703262329
Epoch: 52, Steps: 64 | Train Loss: 0.0937231 Vali Loss: 0.1676612 Test Loss: 0.1566796
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 53 cost time: 1.0296156406402588
Epoch: 53, Steps: 64 | Train Loss: 0.0939122 Vali Loss: 0.1679054 Test Loss: 0.1555672
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 54 cost time: 1.0096251964569092
Epoch: 54, Steps: 64 | Train Loss: 0.0938820 Vali Loss: 0.1683341 Test Loss: 0.1569883
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 55 cost time: 0.9904239177703857
Epoch: 55, Steps: 64 | Train Loss: 0.0940850 Vali Loss: 0.1678937 Test Loss: 0.1565477
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 56 cost time: 0.9569671154022217
Epoch: 56, Steps: 64 | Train Loss: 0.0942820 Vali Loss: 0.1665229 Test Loss: 0.1571852
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 57 cost time: 0.9624242782592773
Epoch: 57, Steps: 64 | Train Loss: 0.0933723 Vali Loss: 0.1661072 Test Loss: 0.1565804
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 58 cost time: 1.0073914527893066
Epoch: 58, Steps: 64 | Train Loss: 0.0935801 Vali Loss: 0.1647569 Test Loss: 0.1560722
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 59 cost time: 1.017465591430664
Epoch: 59, Steps: 64 | Train Loss: 0.0937833 Vali Loss: 0.1682376 Test Loss: 0.1567789
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017696380615234375 GB
GPU已分配内存的峰值：0.04212617874145508 GB
Epoch: 60 cost time: 0.9974122047424316
Epoch: 60, Steps: 64 | Train Loss: 0.0938489 Vali Loss: 0.1659205 Test Loss: 0.1568178
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1564837545156479, mae:0.30397045612335205, rse:0.21055017411708832
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04735612869262695 GB
Epoch: 1 cost time: 2.3040809631347656
Epoch: 1, Steps: 64 | Train Loss: 0.8202357 Vali Loss: 1.6623358 Test Loss: 3.0696673
Validation loss decreased (inf --> 1.662336).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 2 cost time: 0.9234499931335449
Epoch: 2, Steps: 64 | Train Loss: 0.5879655 Vali Loss: 0.8054884 Test Loss: 1.3430778
Validation loss decreased (1.662336 --> 0.805488).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 3 cost time: 0.9013960361480713
Epoch: 3, Steps: 64 | Train Loss: 0.3514777 Vali Loss: 0.4981868 Test Loss: 0.7393017
Validation loss decreased (0.805488 --> 0.498187).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 4 cost time: 0.905937910079956
Epoch: 4, Steps: 64 | Train Loss: 0.2455652 Vali Loss: 0.3638807 Test Loss: 0.4758910
Validation loss decreased (0.498187 --> 0.363881).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 5 cost time: 0.8919999599456787
Epoch: 5, Steps: 64 | Train Loss: 0.2002839 Vali Loss: 0.2964144 Test Loss: 0.3571375
Validation loss decreased (0.363881 --> 0.296414).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 6 cost time: 0.9068074226379395
Epoch: 6, Steps: 64 | Train Loss: 0.1761657 Vali Loss: 0.2628556 Test Loss: 0.2951919
Validation loss decreased (0.296414 --> 0.262856).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 7 cost time: 0.887376070022583
Epoch: 7, Steps: 64 | Train Loss: 0.1619183 Vali Loss: 0.2387548 Test Loss: 0.2562997
Validation loss decreased (0.262856 --> 0.238755).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 8 cost time: 0.8834595680236816
Epoch: 8, Steps: 64 | Train Loss: 0.1530185 Vali Loss: 0.2261430 Test Loss: 0.2295676
Validation loss decreased (0.238755 --> 0.226143).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 9 cost time: 0.8894007205963135
Epoch: 9, Steps: 64 | Train Loss: 0.1457335 Vali Loss: 0.2126775 Test Loss: 0.2100584
Validation loss decreased (0.226143 --> 0.212678).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 10 cost time: 0.9204502105712891
Epoch: 10, Steps: 64 | Train Loss: 0.1410113 Vali Loss: 0.2087546 Test Loss: 0.2004270
Validation loss decreased (0.212678 --> 0.208755).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 11 cost time: 0.9338090419769287
Epoch: 11, Steps: 64 | Train Loss: 0.1376141 Vali Loss: 0.1995993 Test Loss: 0.1890261
Validation loss decreased (0.208755 --> 0.199599).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 12 cost time: 0.9406321048736572
Epoch: 12, Steps: 64 | Train Loss: 0.1348837 Vali Loss: 0.1968210 Test Loss: 0.1840362
Validation loss decreased (0.199599 --> 0.196821).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 13 cost time: 0.9316387176513672
Epoch: 13, Steps: 64 | Train Loss: 0.1318458 Vali Loss: 0.1931172 Test Loss: 0.1794489
Validation loss decreased (0.196821 --> 0.193117).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 14 cost time: 0.9294049739837646
Epoch: 14, Steps: 64 | Train Loss: 0.1300569 Vali Loss: 0.1912307 Test Loss: 0.1754626
Validation loss decreased (0.193117 --> 0.191231).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 15 cost time: 0.9240837097167969
Epoch: 15, Steps: 64 | Train Loss: 0.1285237 Vali Loss: 0.1908414 Test Loss: 0.1736108
Validation loss decreased (0.191231 --> 0.190841).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 16 cost time: 0.9284281730651855
Epoch: 16, Steps: 64 | Train Loss: 0.1267400 Vali Loss: 0.1864198 Test Loss: 0.1704688
Validation loss decreased (0.190841 --> 0.186420).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 17 cost time: 0.9178671836853027
Epoch: 17, Steps: 64 | Train Loss: 0.1260987 Vali Loss: 0.1856214 Test Loss: 0.1672920
Validation loss decreased (0.186420 --> 0.185621).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 18 cost time: 0.9257330894470215
Epoch: 18, Steps: 64 | Train Loss: 0.1250135 Vali Loss: 0.1858814 Test Loss: 0.1678172
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 19 cost time: 0.9489994049072266
Epoch: 19, Steps: 64 | Train Loss: 0.1241453 Vali Loss: 0.1851663 Test Loss: 0.1672036
Validation loss decreased (0.185621 --> 0.185166).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 20 cost time: 0.932380199432373
Epoch: 20, Steps: 64 | Train Loss: 0.1231031 Vali Loss: 0.1837449 Test Loss: 0.1659310
Validation loss decreased (0.185166 --> 0.183745).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 21 cost time: 0.9296205043792725
Epoch: 21, Steps: 64 | Train Loss: 0.1215137 Vali Loss: 0.1826136 Test Loss: 0.1644968
Validation loss decreased (0.183745 --> 0.182614).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 22 cost time: 0.927403450012207
Epoch: 22, Steps: 64 | Train Loss: 0.1217147 Vali Loss: 0.1811995 Test Loss: 0.1645904
Validation loss decreased (0.182614 --> 0.181199).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 23 cost time: 0.9023737907409668
Epoch: 23, Steps: 64 | Train Loss: 0.1209142 Vali Loss: 0.1815682 Test Loss: 0.1644436
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 24 cost time: 0.8961052894592285
Epoch: 24, Steps: 64 | Train Loss: 0.1204463 Vali Loss: 0.1801994 Test Loss: 0.1617231
Validation loss decreased (0.181199 --> 0.180199).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 25 cost time: 0.887739896774292
Epoch: 25, Steps: 64 | Train Loss: 0.1201521 Vali Loss: 0.1792848 Test Loss: 0.1604336
Validation loss decreased (0.180199 --> 0.179285).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 26 cost time: 0.8982746601104736
Epoch: 26, Steps: 64 | Train Loss: 0.1195871 Vali Loss: 0.1795715 Test Loss: 0.1608223
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 27 cost time: 0.9076204299926758
Epoch: 27, Steps: 64 | Train Loss: 0.1192218 Vali Loss: 0.1801757 Test Loss: 0.1602795
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 28 cost time: 0.9293687343597412
Epoch: 28, Steps: 64 | Train Loss: 0.1189925 Vali Loss: 0.1805812 Test Loss: 0.1606126
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 29 cost time: 0.9314172267913818
Epoch: 29, Steps: 64 | Train Loss: 0.1188516 Vali Loss: 0.1776976 Test Loss: 0.1606003
Validation loss decreased (0.179285 --> 0.177698).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 30 cost time: 0.9114229679107666
Epoch: 30, Steps: 64 | Train Loss: 0.1185751 Vali Loss: 0.1773704 Test Loss: 0.1604652
Validation loss decreased (0.177698 --> 0.177370).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 31 cost time: 0.9344758987426758
Epoch: 31, Steps: 64 | Train Loss: 0.1175517 Vali Loss: 0.1775197 Test Loss: 0.1599613
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 32 cost time: 0.917802095413208
Epoch: 32, Steps: 64 | Train Loss: 0.1172695 Vali Loss: 0.1790749 Test Loss: 0.1597555
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 33 cost time: 0.9213569164276123
Epoch: 33, Steps: 64 | Train Loss: 0.1173281 Vali Loss: 0.1787928 Test Loss: 0.1593882
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 34 cost time: 0.9236485958099365
Epoch: 34, Steps: 64 | Train Loss: 0.1175480 Vali Loss: 0.1793350 Test Loss: 0.1606224
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 35 cost time: 0.9166665077209473
Epoch: 35, Steps: 64 | Train Loss: 0.1168980 Vali Loss: 0.1788617 Test Loss: 0.1597828
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 36 cost time: 0.9275016784667969
Epoch: 36, Steps: 64 | Train Loss: 0.1169084 Vali Loss: 0.1760322 Test Loss: 0.1588385
Validation loss decreased (0.177370 --> 0.176032).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 37 cost time: 0.9414453506469727
Epoch: 37, Steps: 64 | Train Loss: 0.1169443 Vali Loss: 0.1736633 Test Loss: 0.1596365
Validation loss decreased (0.176032 --> 0.173663).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 38 cost time: 0.935366153717041
Epoch: 38, Steps: 64 | Train Loss: 0.1159474 Vali Loss: 0.1764935 Test Loss: 0.1603426
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 39 cost time: 0.9377820491790771
Epoch: 39, Steps: 64 | Train Loss: 0.1166346 Vali Loss: 0.1774414 Test Loss: 0.1589842
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 40 cost time: 0.9369995594024658
Epoch: 40, Steps: 64 | Train Loss: 0.1163972 Vali Loss: 0.1784859 Test Loss: 0.1600877
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 41 cost time: 0.8866250514984131
Epoch: 41, Steps: 64 | Train Loss: 0.1164488 Vali Loss: 0.1777074 Test Loss: 0.1597481
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 42 cost time: 0.8999917507171631
Epoch: 42, Steps: 64 | Train Loss: 0.1166923 Vali Loss: 0.1766046 Test Loss: 0.1580396
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 43 cost time: 0.8864462375640869
Epoch: 43, Steps: 64 | Train Loss: 0.1164846 Vali Loss: 0.1764795 Test Loss: 0.1590256
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 44 cost time: 0.8923721313476562
Epoch: 44, Steps: 64 | Train Loss: 0.1162011 Vali Loss: 0.1790585 Test Loss: 0.1586557
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 45 cost time: 0.9017367362976074
Epoch: 45, Steps: 64 | Train Loss: 0.1160134 Vali Loss: 0.1762322 Test Loss: 0.1597110
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 46 cost time: 0.9149999618530273
Epoch: 46, Steps: 64 | Train Loss: 0.1161408 Vali Loss: 0.1762701 Test Loss: 0.1579019
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 47 cost time: 0.9106242656707764
Epoch: 47, Steps: 64 | Train Loss: 0.1156945 Vali Loss: 0.1778214 Test Loss: 0.1582959
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 48 cost time: 0.9106416702270508
Epoch: 48, Steps: 64 | Train Loss: 0.1158534 Vali Loss: 0.1785229 Test Loss: 0.1586306
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 49 cost time: 0.9060089588165283
Epoch: 49, Steps: 64 | Train Loss: 0.1159344 Vali Loss: 0.1755011 Test Loss: 0.1580227
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 50 cost time: 0.896406888961792
Epoch: 50, Steps: 64 | Train Loss: 0.1156732 Vali Loss: 0.1771090 Test Loss: 0.1587224
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 51 cost time: 0.9287500381469727
Epoch: 51, Steps: 64 | Train Loss: 0.1160510 Vali Loss: 0.1760851 Test Loss: 0.1586066
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 52 cost time: 0.9217381477355957
Epoch: 52, Steps: 64 | Train Loss: 0.1161377 Vali Loss: 0.1795747 Test Loss: 0.1585810
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 53 cost time: 0.9200010299682617
Epoch: 53, Steps: 64 | Train Loss: 0.1157533 Vali Loss: 0.1773478 Test Loss: 0.1595625
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 54 cost time: 0.9296324253082275
Epoch: 54, Steps: 64 | Train Loss: 0.1156850 Vali Loss: 0.1779543 Test Loss: 0.1581879
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 55 cost time: 0.9317834377288818
Epoch: 55, Steps: 64 | Train Loss: 0.1154137 Vali Loss: 0.1771935 Test Loss: 0.1582774
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 56 cost time: 0.9184677600860596
Epoch: 56, Steps: 64 | Train Loss: 0.1159344 Vali Loss: 0.1741906 Test Loss: 0.1578493
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 57 cost time: 0.935401201248169
Epoch: 57, Steps: 64 | Train Loss: 0.1159038 Vali Loss: 0.1758876 Test Loss: 0.1577610
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 58 cost time: 0.9279959201812744
Epoch: 58, Steps: 64 | Train Loss: 0.1159296 Vali Loss: 0.1774222 Test Loss: 0.1587660
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 59 cost time: 0.9137883186340332
Epoch: 59, Steps: 64 | Train Loss: 0.1156467 Vali Loss: 0.1751872 Test Loss: 0.1579715
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017805099487304688 GB
GPU已分配内存的峰值：0.04866218566894531 GB
Epoch: 60 cost time: 0.9126319885253906
Epoch: 60, Steps: 64 | Train Loss: 0.1154290 Vali Loss: 0.1773932 Test Loss: 0.1580986
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1596364825963974, mae:0.30232423543930054, rse:0.21266059577465057
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.04805755615234375 GB
Epoch: 1 cost time: 2.3388490676879883
Epoch: 1, Steps: 64 | Train Loss: 0.8750663 Vali Loss: 1.9951887 Test Loss: 3.7797909
Validation loss decreased (inf --> 1.995189).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 2 cost time: 0.9430017471313477
Epoch: 2, Steps: 64 | Train Loss: 0.6830140 Vali Loss: 1.1776788 Test Loss: 2.0939066
Validation loss decreased (1.995189 --> 1.177679).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 3 cost time: 0.9386208057403564
Epoch: 3, Steps: 64 | Train Loss: 0.4136204 Vali Loss: 0.7125532 Test Loss: 1.1324748
Validation loss decreased (1.177679 --> 0.712553).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 4 cost time: 0.9480767250061035
Epoch: 4, Steps: 64 | Train Loss: 0.2589479 Vali Loss: 0.4498649 Test Loss: 0.6195393
Validation loss decreased (0.712553 --> 0.449865).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 5 cost time: 0.9233767986297607
Epoch: 5, Steps: 64 | Train Loss: 0.1801699 Vali Loss: 0.3191664 Test Loss: 0.3731003
Validation loss decreased (0.449865 --> 0.319166).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 6 cost time: 0.9200451374053955
Epoch: 6, Steps: 64 | Train Loss: 0.1455455 Vali Loss: 0.2558532 Test Loss: 0.2552179
Validation loss decreased (0.319166 --> 0.255853).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 7 cost time: 0.9254765510559082
Epoch: 7, Steps: 64 | Train Loss: 0.1290221 Vali Loss: 0.2252843 Test Loss: 0.2072105
Validation loss decreased (0.255853 --> 0.225284).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 8 cost time: 0.932797908782959
Epoch: 8, Steps: 64 | Train Loss: 0.1216606 Vali Loss: 0.2101558 Test Loss: 0.1882269
Validation loss decreased (0.225284 --> 0.210156).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 9 cost time: 0.9347777366638184
Epoch: 9, Steps: 64 | Train Loss: 0.1182564 Vali Loss: 0.2019880 Test Loss: 0.1767787
Validation loss decreased (0.210156 --> 0.201988).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 10 cost time: 0.9519999027252197
Epoch: 10, Steps: 64 | Train Loss: 0.1156486 Vali Loss: 0.1997621 Test Loss: 0.1737632
Validation loss decreased (0.201988 --> 0.199762).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 11 cost time: 0.9846622943878174
Epoch: 11, Steps: 64 | Train Loss: 0.1127411 Vali Loss: 0.1951530 Test Loss: 0.1691954
Validation loss decreased (0.199762 --> 0.195153).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 12 cost time: 0.9636287689208984
Epoch: 12, Steps: 64 | Train Loss: 0.1117169 Vali Loss: 0.1914908 Test Loss: 0.1661659
Validation loss decreased (0.195153 --> 0.191491).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 13 cost time: 0.9702649116516113
Epoch: 13, Steps: 64 | Train Loss: 0.1102115 Vali Loss: 0.1895166 Test Loss: 0.1655787
Validation loss decreased (0.191491 --> 0.189517).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 14 cost time: 0.9463760852813721
Epoch: 14, Steps: 64 | Train Loss: 0.1094448 Vali Loss: 0.1898126 Test Loss: 0.1640492
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 15 cost time: 0.9523739814758301
Epoch: 15, Steps: 64 | Train Loss: 0.1077542 Vali Loss: 0.1908151 Test Loss: 0.1640844
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 16 cost time: 0.9494500160217285
Epoch: 16, Steps: 64 | Train Loss: 0.1071952 Vali Loss: 0.1885503 Test Loss: 0.1651975
Validation loss decreased (0.189517 --> 0.188550).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 17 cost time: 0.9488623142242432
Epoch: 17, Steps: 64 | Train Loss: 0.1062213 Vali Loss: 0.1878771 Test Loss: 0.1622537
Validation loss decreased (0.188550 --> 0.187877).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 18 cost time: 0.9643523693084717
Epoch: 18, Steps: 64 | Train Loss: 0.1058338 Vali Loss: 0.1867660 Test Loss: 0.1629156
Validation loss decreased (0.187877 --> 0.186766).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 19 cost time: 0.9629976749420166
Epoch: 19, Steps: 64 | Train Loss: 0.1053241 Vali Loss: 0.1854764 Test Loss: 0.1636390
Validation loss decreased (0.186766 --> 0.185476).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 20 cost time: 0.9446310997009277
Epoch: 20, Steps: 64 | Train Loss: 0.1047829 Vali Loss: 0.1856735 Test Loss: 0.1622835
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 21 cost time: 0.9436435699462891
Epoch: 21, Steps: 64 | Train Loss: 0.1043153 Vali Loss: 0.1841522 Test Loss: 0.1619266
Validation loss decreased (0.185476 --> 0.184152).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 22 cost time: 0.9263904094696045
Epoch: 22, Steps: 64 | Train Loss: 0.1039018 Vali Loss: 0.1835603 Test Loss: 0.1616929
Validation loss decreased (0.184152 --> 0.183560).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 23 cost time: 0.9296145439147949
Epoch: 23, Steps: 64 | Train Loss: 0.1033339 Vali Loss: 0.1802745 Test Loss: 0.1616374
Validation loss decreased (0.183560 --> 0.180274).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 24 cost time: 0.9204421043395996
Epoch: 24, Steps: 64 | Train Loss: 0.1029781 Vali Loss: 0.1834446 Test Loss: 0.1615208
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 25 cost time: 0.9349808692932129
Epoch: 25, Steps: 64 | Train Loss: 0.1027947 Vali Loss: 0.1821801 Test Loss: 0.1602051
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 26 cost time: 0.9328086376190186
Epoch: 26, Steps: 64 | Train Loss: 0.1029118 Vali Loss: 0.1810298 Test Loss: 0.1614731
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 27 cost time: 0.929002046585083
Epoch: 27, Steps: 64 | Train Loss: 0.1024253 Vali Loss: 0.1810459 Test Loss: 0.1603151
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 28 cost time: 0.9406366348266602
Epoch: 28, Steps: 64 | Train Loss: 0.1023167 Vali Loss: 0.1823879 Test Loss: 0.1624515
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 29 cost time: 0.9440929889678955
Epoch: 29, Steps: 64 | Train Loss: 0.1018643 Vali Loss: 0.1805017 Test Loss: 0.1616305
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 30 cost time: 0.9623997211456299
Epoch: 30, Steps: 64 | Train Loss: 0.1017171 Vali Loss: 0.1833049 Test Loss: 0.1614962
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 31 cost time: 0.9583494663238525
Epoch: 31, Steps: 64 | Train Loss: 0.1017849 Vali Loss: 0.1810496 Test Loss: 0.1606816
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 32 cost time: 0.945368766784668
Epoch: 32, Steps: 64 | Train Loss: 0.1017485 Vali Loss: 0.1833613 Test Loss: 0.1608403
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 33 cost time: 0.9482214450836182
Epoch: 33, Steps: 64 | Train Loss: 0.1012582 Vali Loss: 0.1829751 Test Loss: 0.1611538
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 34 cost time: 0.9448292255401611
Epoch: 34, Steps: 64 | Train Loss: 0.1012768 Vali Loss: 0.1827490 Test Loss: 0.1620612
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 35 cost time: 0.9720003604888916
Epoch: 35, Steps: 64 | Train Loss: 0.1010820 Vali Loss: 0.1821766 Test Loss: 0.1622209
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 36 cost time: 0.9656169414520264
Epoch: 36, Steps: 64 | Train Loss: 0.1012599 Vali Loss: 0.1820532 Test Loss: 0.1624427
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 37 cost time: 0.9676468372344971
Epoch: 37, Steps: 64 | Train Loss: 0.1011425 Vali Loss: 0.1793362 Test Loss: 0.1615207
Validation loss decreased (0.180274 --> 0.179336).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 38 cost time: 0.9662778377532959
Epoch: 38, Steps: 64 | Train Loss: 0.1007444 Vali Loss: 0.1805855 Test Loss: 0.1612104
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 39 cost time: 0.9723925590515137
Epoch: 39, Steps: 64 | Train Loss: 0.1005522 Vali Loss: 0.1827235 Test Loss: 0.1613333
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 40 cost time: 0.9593584537506104
Epoch: 40, Steps: 64 | Train Loss: 0.1003262 Vali Loss: 0.1800659 Test Loss: 0.1613112
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 41 cost time: 0.9574024677276611
Epoch: 41, Steps: 64 | Train Loss: 0.1007303 Vali Loss: 0.1811212 Test Loss: 0.1611261
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 42 cost time: 0.965754508972168
Epoch: 42, Steps: 64 | Train Loss: 0.1005676 Vali Loss: 0.1813599 Test Loss: 0.1617911
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 43 cost time: 0.9287357330322266
Epoch: 43, Steps: 64 | Train Loss: 0.1004886 Vali Loss: 0.1808593 Test Loss: 0.1621116
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 44 cost time: 0.9482288360595703
Epoch: 44, Steps: 64 | Train Loss: 0.1006223 Vali Loss: 0.1800612 Test Loss: 0.1607202
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 45 cost time: 0.9396400451660156
Epoch: 45, Steps: 64 | Train Loss: 0.1007023 Vali Loss: 0.1807113 Test Loss: 0.1615135
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 46 cost time: 0.9390773773193359
Epoch: 46, Steps: 64 | Train Loss: 0.1000245 Vali Loss: 0.1795110 Test Loss: 0.1611972
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 47 cost time: 0.9464232921600342
Epoch: 47, Steps: 64 | Train Loss: 0.1004228 Vali Loss: 0.1795018 Test Loss: 0.1604450
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 48 cost time: 0.9352915287017822
Epoch: 48, Steps: 64 | Train Loss: 0.1002382 Vali Loss: 0.1814746 Test Loss: 0.1610412
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 49 cost time: 0.9378116130828857
Epoch: 49, Steps: 64 | Train Loss: 0.1003893 Vali Loss: 0.1788799 Test Loss: 0.1620260
Validation loss decreased (0.179336 --> 0.178880).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 50 cost time: 0.95139479637146
Epoch: 50, Steps: 64 | Train Loss: 0.1006143 Vali Loss: 0.1797445 Test Loss: 0.1608774
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 51 cost time: 0.9537947177886963
Epoch: 51, Steps: 64 | Train Loss: 0.1001372 Vali Loss: 0.1775006 Test Loss: 0.1610351
Validation loss decreased (0.178880 --> 0.177501).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 52 cost time: 0.9616608619689941
Epoch: 52, Steps: 64 | Train Loss: 0.1006563 Vali Loss: 0.1804478 Test Loss: 0.1603267
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 53 cost time: 0.9626381397247314
Epoch: 53, Steps: 64 | Train Loss: 0.1003874 Vali Loss: 0.1821138 Test Loss: 0.1612926
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 54 cost time: 0.9591217041015625
Epoch: 54, Steps: 64 | Train Loss: 0.1002865 Vali Loss: 0.1817535 Test Loss: 0.1619237
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 55 cost time: 0.9664578437805176
Epoch: 55, Steps: 64 | Train Loss: 0.1002896 Vali Loss: 0.1794037 Test Loss: 0.1611021
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 56 cost time: 0.9613804817199707
Epoch: 56, Steps: 64 | Train Loss: 0.1003792 Vali Loss: 0.1811440 Test Loss: 0.1609035
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 57 cost time: 0.946375846862793
Epoch: 57, Steps: 64 | Train Loss: 0.1004209 Vali Loss: 0.1806655 Test Loss: 0.1610830
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 58 cost time: 0.9384117126464844
Epoch: 58, Steps: 64 | Train Loss: 0.1000932 Vali Loss: 0.1788782 Test Loss: 0.1614959
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 59 cost time: 0.938753604888916
Epoch: 59, Steps: 64 | Train Loss: 0.0999557 Vali Loss: 0.1801967 Test Loss: 0.1608036
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017843246459960938 GB
GPU已分配内存的峰值：0.0494232177734375 GB
Epoch: 60 cost time: 0.9309983253479004
Epoch: 60, Steps: 64 | Train Loss: 0.1001242 Vali Loss: 0.1793718 Test Loss: 0.1615172
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.16103510558605194, mae:0.30931001901626587, rse:0.21359017491340637
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.04862165451049805 GB
Epoch: 1 cost time: 2.359327554702759
Epoch: 1, Steps: 64 | Train Loss: 0.8398168 Vali Loss: 1.9386940 Test Loss: 3.7637808
Validation loss decreased (inf --> 1.938694).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 2 cost time: 0.9857614040374756
Epoch: 2, Steps: 64 | Train Loss: 0.6732206 Vali Loss: 1.1646574 Test Loss: 2.1161966
Validation loss decreased (1.938694 --> 1.164657).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 3 cost time: 0.9614074230194092
Epoch: 3, Steps: 64 | Train Loss: 0.3891073 Vali Loss: 0.6026158 Test Loss: 0.9448612
Validation loss decreased (1.164657 --> 0.602616).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 4 cost time: 0.9600002765655518
Epoch: 4, Steps: 64 | Train Loss: 0.2100192 Vali Loss: 0.3181526 Test Loss: 0.3771047
Validation loss decreased (0.602616 --> 0.318153).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 5 cost time: 0.9376392364501953
Epoch: 5, Steps: 64 | Train Loss: 0.1391248 Vali Loss: 0.2245631 Test Loss: 0.2071943
Validation loss decreased (0.318153 --> 0.224563).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 6 cost time: 0.934410572052002
Epoch: 6, Steps: 64 | Train Loss: 0.1209472 Vali Loss: 0.2027430 Test Loss: 0.1749834
Validation loss decreased (0.224563 --> 0.202743).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 7 cost time: 0.9379265308380127
Epoch: 7, Steps: 64 | Train Loss: 0.1151129 Vali Loss: 0.1953497 Test Loss: 0.1662132
Validation loss decreased (0.202743 --> 0.195350).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 8 cost time: 0.9303736686706543
Epoch: 8, Steps: 64 | Train Loss: 0.1121450 Vali Loss: 0.1919883 Test Loss: 0.1620652
Validation loss decreased (0.195350 --> 0.191988).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 9 cost time: 0.979560375213623
Epoch: 9, Steps: 64 | Train Loss: 0.1095164 Vali Loss: 0.1903027 Test Loss: 0.1612357
Validation loss decreased (0.191988 --> 0.190303).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 10 cost time: 0.9903528690338135
Epoch: 10, Steps: 64 | Train Loss: 0.1080673 Vali Loss: 0.1881833 Test Loss: 0.1587014
Validation loss decreased (0.190303 --> 0.188183).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 11 cost time: 0.9887979030609131
Epoch: 11, Steps: 64 | Train Loss: 0.1067516 Vali Loss: 0.1863799 Test Loss: 0.1599042
Validation loss decreased (0.188183 --> 0.186380).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 12 cost time: 1.0058717727661133
Epoch: 12, Steps: 64 | Train Loss: 0.1054270 Vali Loss: 0.1854863 Test Loss: 0.1596284
Validation loss decreased (0.186380 --> 0.185486).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 13 cost time: 0.9859981536865234
Epoch: 13, Steps: 64 | Train Loss: 0.1035682 Vali Loss: 0.1839058 Test Loss: 0.1581750
Validation loss decreased (0.185486 --> 0.183906).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 14 cost time: 0.9839997291564941
Epoch: 14, Steps: 64 | Train Loss: 0.1036195 Vali Loss: 0.1823987 Test Loss: 0.1577577
Validation loss decreased (0.183906 --> 0.182399).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 15 cost time: 0.9810261726379395
Epoch: 15, Steps: 64 | Train Loss: 0.1022846 Vali Loss: 0.1803610 Test Loss: 0.1577994
Validation loss decreased (0.182399 --> 0.180361).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 16 cost time: 0.9694702625274658
Epoch: 16, Steps: 64 | Train Loss: 0.1017107 Vali Loss: 0.1809455 Test Loss: 0.1576710
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 17 cost time: 0.9673755168914795
Epoch: 17, Steps: 64 | Train Loss: 0.1010260 Vali Loss: 0.1796446 Test Loss: 0.1574149
Validation loss decreased (0.180361 --> 0.179645).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 18 cost time: 0.9843769073486328
Epoch: 18, Steps: 64 | Train Loss: 0.1006478 Vali Loss: 0.1805325 Test Loss: 0.1578281
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 19 cost time: 0.9861304759979248
Epoch: 19, Steps: 64 | Train Loss: 0.0998160 Vali Loss: 0.1784339 Test Loss: 0.1578272
Validation loss decreased (0.179645 --> 0.178434).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 20 cost time: 0.9623599052429199
Epoch: 20, Steps: 64 | Train Loss: 0.1000090 Vali Loss: 0.1775894 Test Loss: 0.1577351
Validation loss decreased (0.178434 --> 0.177589).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 21 cost time: 0.9854614734649658
Epoch: 21, Steps: 64 | Train Loss: 0.0993463 Vali Loss: 0.1785868 Test Loss: 0.1574036
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 22 cost time: 0.9754295349121094
Epoch: 22, Steps: 64 | Train Loss: 0.0992131 Vali Loss: 0.1809032 Test Loss: 0.1586100
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 23 cost time: 0.950753927230835
Epoch: 23, Steps: 64 | Train Loss: 0.0990841 Vali Loss: 0.1774831 Test Loss: 0.1584380
Validation loss decreased (0.177589 --> 0.177483).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 24 cost time: 0.9611072540283203
Epoch: 24, Steps: 64 | Train Loss: 0.0989737 Vali Loss: 0.1769761 Test Loss: 0.1580170
Validation loss decreased (0.177483 --> 0.176976).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 25 cost time: 1.0806376934051514
Epoch: 25, Steps: 64 | Train Loss: 0.0982532 Vali Loss: 0.1783183 Test Loss: 0.1579392
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 26 cost time: 1.0181117057800293
Epoch: 26, Steps: 64 | Train Loss: 0.0984909 Vali Loss: 0.1784124 Test Loss: 0.1585405
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 27 cost time: 1.0175719261169434
Epoch: 27, Steps: 64 | Train Loss: 0.0982960 Vali Loss: 0.1787827 Test Loss: 0.1575818
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 28 cost time: 1.0344769954681396
Epoch: 28, Steps: 64 | Train Loss: 0.0976704 Vali Loss: 0.1777557 Test Loss: 0.1583922
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 29 cost time: 1.033073902130127
Epoch: 29, Steps: 64 | Train Loss: 0.0979377 Vali Loss: 0.1767911 Test Loss: 0.1585552
Validation loss decreased (0.176976 --> 0.176791).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 30 cost time: 0.9745500087738037
Epoch: 30, Steps: 64 | Train Loss: 0.0975297 Vali Loss: 0.1756495 Test Loss: 0.1587153
Validation loss decreased (0.176791 --> 0.175650).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 31 cost time: 0.9762771129608154
Epoch: 31, Steps: 64 | Train Loss: 0.0978280 Vali Loss: 0.1751801 Test Loss: 0.1587310
Validation loss decreased (0.175650 --> 0.175180).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 32 cost time: 0.986555814743042
Epoch: 32, Steps: 64 | Train Loss: 0.0976205 Vali Loss: 0.1777844 Test Loss: 0.1591109
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 33 cost time: 0.9684653282165527
Epoch: 33, Steps: 64 | Train Loss: 0.0975134 Vali Loss: 0.1774759 Test Loss: 0.1582424
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 34 cost time: 0.9793877601623535
Epoch: 34, Steps: 64 | Train Loss: 0.0974246 Vali Loss: 0.1757997 Test Loss: 0.1587460
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 35 cost time: 0.9938504695892334
Epoch: 35, Steps: 64 | Train Loss: 0.0969609 Vali Loss: 0.1784806 Test Loss: 0.1593529
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 36 cost time: 0.9829998016357422
Epoch: 36, Steps: 64 | Train Loss: 0.0969943 Vali Loss: 0.1785243 Test Loss: 0.1586073
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 37 cost time: 0.9830000400543213
Epoch: 37, Steps: 64 | Train Loss: 0.0967676 Vali Loss: 0.1778379 Test Loss: 0.1591573
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 38 cost time: 0.985640287399292
Epoch: 38, Steps: 64 | Train Loss: 0.0969787 Vali Loss: 0.1773544 Test Loss: 0.1588311
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 39 cost time: 0.9703395366668701
Epoch: 39, Steps: 64 | Train Loss: 0.0969888 Vali Loss: 0.1767282 Test Loss: 0.1588046
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 40 cost time: 0.9784624576568604
Epoch: 40, Steps: 64 | Train Loss: 0.0970070 Vali Loss: 0.1740652 Test Loss: 0.1591647
Validation loss decreased (0.175180 --> 0.174065).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 41 cost time: 0.9895005226135254
Epoch: 41, Steps: 64 | Train Loss: 0.0964823 Vali Loss: 0.1763646 Test Loss: 0.1587475
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 42 cost time: 0.9503738880157471
Epoch: 42, Steps: 64 | Train Loss: 0.0967017 Vali Loss: 0.1756897 Test Loss: 0.1590216
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 43 cost time: 0.9663650989532471
Epoch: 43, Steps: 64 | Train Loss: 0.0962898 Vali Loss: 0.1755266 Test Loss: 0.1592227
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 44 cost time: 0.9591007232666016
Epoch: 44, Steps: 64 | Train Loss: 0.0965203 Vali Loss: 0.1758530 Test Loss: 0.1579445
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 45 cost time: 0.9668166637420654
Epoch: 45, Steps: 64 | Train Loss: 0.0966513 Vali Loss: 0.1749865 Test Loss: 0.1591591
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 46 cost time: 0.9610013961791992
Epoch: 46, Steps: 64 | Train Loss: 0.0964485 Vali Loss: 0.1764978 Test Loss: 0.1592774
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 47 cost time: 0.975649356842041
Epoch: 47, Steps: 64 | Train Loss: 0.0966751 Vali Loss: 0.1778212 Test Loss: 0.1588974
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 48 cost time: 0.9726567268371582
Epoch: 48, Steps: 64 | Train Loss: 0.0961004 Vali Loss: 0.1760790 Test Loss: 0.1581362
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 49 cost time: 0.9714093208312988
Epoch: 49, Steps: 64 | Train Loss: 0.0964040 Vali Loss: 0.1773533 Test Loss: 0.1590469
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 50 cost time: 0.9804306030273438
Epoch: 50, Steps: 64 | Train Loss: 0.0962156 Vali Loss: 0.1772576 Test Loss: 0.1594871
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 51 cost time: 0.9972426891326904
Epoch: 51, Steps: 64 | Train Loss: 0.0961998 Vali Loss: 0.1737744 Test Loss: 0.1588047
Validation loss decreased (0.174065 --> 0.173774).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 52 cost time: 1.013627290725708
Epoch: 52, Steps: 64 | Train Loss: 0.0962291 Vali Loss: 0.1763896 Test Loss: 0.1585887
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 53 cost time: 1.0074975490570068
Epoch: 53, Steps: 64 | Train Loss: 0.0963006 Vali Loss: 0.1766964 Test Loss: 0.1588212
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 54 cost time: 0.959902286529541
Epoch: 54, Steps: 64 | Train Loss: 0.0963004 Vali Loss: 0.1760442 Test Loss: 0.1588533
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 55 cost time: 1.0039873123168945
Epoch: 55, Steps: 64 | Train Loss: 0.0959505 Vali Loss: 0.1748764 Test Loss: 0.1591251
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 56 cost time: 1.0040063858032227
Epoch: 56, Steps: 64 | Train Loss: 0.0964987 Vali Loss: 0.1756825 Test Loss: 0.1589801
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 57 cost time: 0.94392991065979
Epoch: 57, Steps: 64 | Train Loss: 0.0965607 Vali Loss: 0.1756217 Test Loss: 0.1588231
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 58 cost time: 0.9526643753051758
Epoch: 58, Steps: 64 | Train Loss: 0.0961777 Vali Loss: 0.1762614 Test Loss: 0.1588913
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 59 cost time: 0.9454638957977295
Epoch: 59, Steps: 64 | Train Loss: 0.0959669 Vali Loss: 0.1755806 Test Loss: 0.1591936
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017866134643554688 GB
GPU已分配内存的峰值：0.05017280578613281 GB
Epoch: 60 cost time: 0.9704709053039551
Epoch: 60, Steps: 64 | Train Loss: 0.0962078 Vali Loss: 0.1774177 Test Loss: 0.1584191
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15880471467971802, mae:0.3044050931930542, rse:0.212105855345726
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04751729965209961 GB
Epoch: 1 cost time: 2.322432518005371
Epoch: 1, Steps: 64 | Train Loss: 0.8443303 Vali Loss: 1.6532714 Test Loss: 3.0763106
Validation loss decreased (inf --> 1.653271).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 2 cost time: 0.9136447906494141
Epoch: 2, Steps: 64 | Train Loss: 0.5877611 Vali Loss: 0.8030153 Test Loss: 1.3178327
Validation loss decreased (1.653271 --> 0.803015).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 3 cost time: 0.914353609085083
Epoch: 3, Steps: 64 | Train Loss: 0.3833215 Vali Loss: 0.6291825 Test Loss: 0.9679635
Validation loss decreased (0.803015 --> 0.629182).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 4 cost time: 0.9083662033081055
Epoch: 4, Steps: 64 | Train Loss: 0.2988270 Vali Loss: 0.5138688 Test Loss: 0.7453418
Validation loss decreased (0.629182 --> 0.513869).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 5 cost time: 0.9145011901855469
Epoch: 5, Steps: 64 | Train Loss: 0.2446494 Vali Loss: 0.4312666 Test Loss: 0.5794728
Validation loss decreased (0.513869 --> 0.431267).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 6 cost time: 0.878122091293335
Epoch: 6, Steps: 64 | Train Loss: 0.2089989 Vali Loss: 0.3731277 Test Loss: 0.4750707
Validation loss decreased (0.431267 --> 0.373128).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 7 cost time: 0.891998291015625
Epoch: 7, Steps: 64 | Train Loss: 0.1848988 Vali Loss: 0.3263719 Test Loss: 0.3923940
Validation loss decreased (0.373128 --> 0.326372).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 8 cost time: 0.8856592178344727
Epoch: 8, Steps: 64 | Train Loss: 0.1685165 Vali Loss: 0.2972220 Test Loss: 0.3442260
Validation loss decreased (0.326372 --> 0.297222).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 9 cost time: 0.8944098949432373
Epoch: 9, Steps: 64 | Train Loss: 0.1564056 Vali Loss: 0.2712957 Test Loss: 0.3014295
Validation loss decreased (0.297222 --> 0.271296).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 10 cost time: 0.9325129985809326
Epoch: 10, Steps: 64 | Train Loss: 0.1478106 Vali Loss: 0.2532063 Test Loss: 0.2717682
Validation loss decreased (0.271296 --> 0.253206).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 11 cost time: 0.9313936233520508
Epoch: 11, Steps: 64 | Train Loss: 0.1408911 Vali Loss: 0.2409817 Test Loss: 0.2531544
Validation loss decreased (0.253206 --> 0.240982).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 12 cost time: 0.9464852809906006
Epoch: 12, Steps: 64 | Train Loss: 0.1350413 Vali Loss: 0.2285912 Test Loss: 0.2353476
Validation loss decreased (0.240982 --> 0.228591).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 13 cost time: 0.9367396831512451
Epoch: 13, Steps: 64 | Train Loss: 0.1320720 Vali Loss: 0.2190497 Test Loss: 0.2192080
Validation loss decreased (0.228591 --> 0.219050).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 14 cost time: 0.919874906539917
Epoch: 14, Steps: 64 | Train Loss: 0.1276132 Vali Loss: 0.2137396 Test Loss: 0.2120448
Validation loss decreased (0.219050 --> 0.213740).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 15 cost time: 0.9284286499023438
Epoch: 15, Steps: 64 | Train Loss: 0.1252515 Vali Loss: 0.2080301 Test Loss: 0.2037041
Validation loss decreased (0.213740 --> 0.208030).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 16 cost time: 0.9165713787078857
Epoch: 16, Steps: 64 | Train Loss: 0.1229997 Vali Loss: 0.2015160 Test Loss: 0.1974879
Validation loss decreased (0.208030 --> 0.201516).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 17 cost time: 0.9223771095275879
Epoch: 17, Steps: 64 | Train Loss: 0.1204243 Vali Loss: 0.1977590 Test Loss: 0.1920373
Validation loss decreased (0.201516 --> 0.197759).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 18 cost time: 0.9278535842895508
Epoch: 18, Steps: 64 | Train Loss: 0.1198022 Vali Loss: 0.1933754 Test Loss: 0.1869247
Validation loss decreased (0.197759 --> 0.193375).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 19 cost time: 0.9133985042572021
Epoch: 19, Steps: 64 | Train Loss: 0.1174199 Vali Loss: 0.1904755 Test Loss: 0.1831275
Validation loss decreased (0.193375 --> 0.190476).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 20 cost time: 0.9348242282867432
Epoch: 20, Steps: 64 | Train Loss: 0.1165426 Vali Loss: 0.1898515 Test Loss: 0.1813595
Validation loss decreased (0.190476 --> 0.189851).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 21 cost time: 0.9320001602172852
Epoch: 21, Steps: 64 | Train Loss: 0.1157632 Vali Loss: 0.1859596 Test Loss: 0.1766408
Validation loss decreased (0.189851 --> 0.185960).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 22 cost time: 0.9416277408599854
Epoch: 22, Steps: 64 | Train Loss: 0.1151378 Vali Loss: 0.1852997 Test Loss: 0.1760830
Validation loss decreased (0.185960 --> 0.185300).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 23 cost time: 0.8872756958007812
Epoch: 23, Steps: 64 | Train Loss: 0.1143913 Vali Loss: 0.1825605 Test Loss: 0.1739096
Validation loss decreased (0.185300 --> 0.182561).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 24 cost time: 0.910233736038208
Epoch: 24, Steps: 64 | Train Loss: 0.1141367 Vali Loss: 0.1809057 Test Loss: 0.1724245
Validation loss decreased (0.182561 --> 0.180906).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 25 cost time: 0.8930132389068604
Epoch: 25, Steps: 64 | Train Loss: 0.1131742 Vali Loss: 0.1809865 Test Loss: 0.1705524
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 26 cost time: 0.9135177135467529
Epoch: 26, Steps: 64 | Train Loss: 0.1125964 Vali Loss: 0.1812306 Test Loss: 0.1707641
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 27 cost time: 0.9305009841918945
Epoch: 27, Steps: 64 | Train Loss: 0.1123442 Vali Loss: 0.1775592 Test Loss: 0.1676576
Validation loss decreased (0.180906 --> 0.177559).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 28 cost time: 0.9316236972808838
Epoch: 28, Steps: 64 | Train Loss: 0.1116494 Vali Loss: 0.1795775 Test Loss: 0.1700977
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 29 cost time: 0.9386649131774902
Epoch: 29, Steps: 64 | Train Loss: 0.1117053 Vali Loss: 0.1767876 Test Loss: 0.1665148
Validation loss decreased (0.177559 --> 0.176788).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 30 cost time: 0.9096360206604004
Epoch: 30, Steps: 64 | Train Loss: 0.1116833 Vali Loss: 0.1785727 Test Loss: 0.1677655
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 31 cost time: 0.9323787689208984
Epoch: 31, Steps: 64 | Train Loss: 0.1110979 Vali Loss: 0.1747671 Test Loss: 0.1654051
Validation loss decreased (0.176788 --> 0.174767).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 32 cost time: 0.9294581413269043
Epoch: 32, Steps: 64 | Train Loss: 0.1101364 Vali Loss: 0.1745752 Test Loss: 0.1646537
Validation loss decreased (0.174767 --> 0.174575).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 33 cost time: 0.9294683933258057
Epoch: 33, Steps: 64 | Train Loss: 0.1109986 Vali Loss: 0.1751426 Test Loss: 0.1648994
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 34 cost time: 0.9177556037902832
Epoch: 34, Steps: 64 | Train Loss: 0.1104765 Vali Loss: 0.1766712 Test Loss: 0.1664165
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 35 cost time: 0.9169995784759521
Epoch: 35, Steps: 64 | Train Loss: 0.1100870 Vali Loss: 0.1750001 Test Loss: 0.1657663
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 36 cost time: 0.9412896633148193
Epoch: 36, Steps: 64 | Train Loss: 0.1095581 Vali Loss: 0.1751085 Test Loss: 0.1646932
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 37 cost time: 0.937640905380249
Epoch: 37, Steps: 64 | Train Loss: 0.1097950 Vali Loss: 0.1748237 Test Loss: 0.1642383
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 38 cost time: 0.9436187744140625
Epoch: 38, Steps: 64 | Train Loss: 0.1095444 Vali Loss: 0.1745699 Test Loss: 0.1641239
Validation loss decreased (0.174575 --> 0.174570).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 39 cost time: 0.9394094944000244
Epoch: 39, Steps: 64 | Train Loss: 0.1091808 Vali Loss: 0.1740717 Test Loss: 0.1635048
Validation loss decreased (0.174570 --> 0.174072).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 40 cost time: 0.9342048168182373
Epoch: 40, Steps: 64 | Train Loss: 0.1094792 Vali Loss: 0.1733963 Test Loss: 0.1631831
Validation loss decreased (0.174072 --> 0.173396).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 41 cost time: 0.8890693187713623
Epoch: 41, Steps: 64 | Train Loss: 0.1097435 Vali Loss: 0.1725879 Test Loss: 0.1620162
Validation loss decreased (0.173396 --> 0.172588).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 42 cost time: 0.8849992752075195
Epoch: 42, Steps: 64 | Train Loss: 0.1089295 Vali Loss: 0.1725821 Test Loss: 0.1625317
Validation loss decreased (0.172588 --> 0.172582).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 43 cost time: 0.8989527225494385
Epoch: 43, Steps: 64 | Train Loss: 0.1094568 Vali Loss: 0.1721112 Test Loss: 0.1638472
Validation loss decreased (0.172582 --> 0.172111).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 44 cost time: 0.8855934143066406
Epoch: 44, Steps: 64 | Train Loss: 0.1087875 Vali Loss: 0.1739637 Test Loss: 0.1620847
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 45 cost time: 0.9094395637512207
Epoch: 45, Steps: 64 | Train Loss: 0.1092224 Vali Loss: 0.1720352 Test Loss: 0.1615774
Validation loss decreased (0.172111 --> 0.172035).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 46 cost time: 0.9114975929260254
Epoch: 46, Steps: 64 | Train Loss: 0.1092698 Vali Loss: 0.1725510 Test Loss: 0.1632645
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 47 cost time: 0.9224002361297607
Epoch: 47, Steps: 64 | Train Loss: 0.1085464 Vali Loss: 0.1734049 Test Loss: 0.1605070
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 48 cost time: 0.911761999130249
Epoch: 48, Steps: 64 | Train Loss: 0.1086561 Vali Loss: 0.1719896 Test Loss: 0.1599391
Validation loss decreased (0.172035 --> 0.171990).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 49 cost time: 0.88653564453125
Epoch: 49, Steps: 64 | Train Loss: 0.1086785 Vali Loss: 0.1712560 Test Loss: 0.1606885
Validation loss decreased (0.171990 --> 0.171256).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 50 cost time: 0.9016425609588623
Epoch: 50, Steps: 64 | Train Loss: 0.1081393 Vali Loss: 0.1707627 Test Loss: 0.1606502
Validation loss decreased (0.171256 --> 0.170763).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 51 cost time: 0.9114153385162354
Epoch: 51, Steps: 64 | Train Loss: 0.1080352 Vali Loss: 0.1716603 Test Loss: 0.1628219
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 52 cost time: 0.9204154014587402
Epoch: 52, Steps: 64 | Train Loss: 0.1088951 Vali Loss: 0.1717791 Test Loss: 0.1604540
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 53 cost time: 0.9243412017822266
Epoch: 53, Steps: 64 | Train Loss: 0.1093540 Vali Loss: 0.1714169 Test Loss: 0.1604549
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 54 cost time: 0.9313838481903076
Epoch: 54, Steps: 64 | Train Loss: 0.1088308 Vali Loss: 0.1724122 Test Loss: 0.1611677
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 55 cost time: 0.9398007392883301
Epoch: 55, Steps: 64 | Train Loss: 0.1085381 Vali Loss: 0.1715854 Test Loss: 0.1620252
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 56 cost time: 0.9390006065368652
Epoch: 56, Steps: 64 | Train Loss: 0.1084065 Vali Loss: 0.1693002 Test Loss: 0.1599689
Validation loss decreased (0.170763 --> 0.169300).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 57 cost time: 0.9436402320861816
Epoch: 57, Steps: 64 | Train Loss: 0.1081877 Vali Loss: 0.1718155 Test Loss: 0.1614454
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 58 cost time: 0.9345123767852783
Epoch: 58, Steps: 64 | Train Loss: 0.1084803 Vali Loss: 0.1715651 Test Loss: 0.1600856
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 59 cost time: 0.9304332733154297
Epoch: 59, Steps: 64 | Train Loss: 0.1080721 Vali Loss: 0.1710927 Test Loss: 0.1608886
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017808914184570312 GB
GPU已分配内存的峰值：0.04882526397705078 GB
Epoch: 60 cost time: 0.9351038932800293
Epoch: 60, Steps: 64 | Train Loss: 0.1092626 Vali Loss: 0.1724855 Test Loss: 0.1623775
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15996888279914856, mae:0.3021392524242401, rse:0.2128818929195404
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.048218727111816406 GB
Epoch: 1 cost time: 2.3502655029296875
Epoch: 1, Steps: 64 | Train Loss: 0.9214669 Vali Loss: 2.0618908 Test Loss: 3.9525685
Validation loss decreased (inf --> 2.061891).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 2 cost time: 0.9654302597045898
Epoch: 2, Steps: 64 | Train Loss: 0.7321842 Vali Loss: 1.3001016 Test Loss: 2.3864360
Validation loss decreased (2.061891 --> 1.300102).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 3 cost time: 0.9711315631866455
Epoch: 3, Steps: 64 | Train Loss: 0.4737141 Vali Loss: 0.7911516 Test Loss: 1.3338149
Validation loss decreased (1.300102 --> 0.791152).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 4 cost time: 0.9695212841033936
Epoch: 4, Steps: 64 | Train Loss: 0.2947630 Vali Loss: 0.4765676 Test Loss: 0.6994926
Validation loss decreased (0.791152 --> 0.476568).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 5 cost time: 0.9294538497924805
Epoch: 5, Steps: 64 | Train Loss: 0.1948132 Vali Loss: 0.3221263 Test Loss: 0.4017126
Validation loss decreased (0.476568 --> 0.322126).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 6 cost time: 0.9268755912780762
Epoch: 6, Steps: 64 | Train Loss: 0.1489313 Vali Loss: 0.2463745 Test Loss: 0.2704210
Validation loss decreased (0.322126 --> 0.246374).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 7 cost time: 0.9345433712005615
Epoch: 7, Steps: 64 | Train Loss: 0.1294464 Vali Loss: 0.2140855 Test Loss: 0.2149399
Validation loss decreased (0.246374 --> 0.214085).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 8 cost time: 0.9226419925689697
Epoch: 8, Steps: 64 | Train Loss: 0.1206124 Vali Loss: 0.1970461 Test Loss: 0.1863640
Validation loss decreased (0.214085 --> 0.197046).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 9 cost time: 0.9356358051300049
Epoch: 9, Steps: 64 | Train Loss: 0.1152827 Vali Loss: 0.1855325 Test Loss: 0.1731593
Validation loss decreased (0.197046 --> 0.185532).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 10 cost time: 0.9595470428466797
Epoch: 10, Steps: 64 | Train Loss: 0.1126461 Vali Loss: 0.1817830 Test Loss: 0.1657716
Validation loss decreased (0.185532 --> 0.181783).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 11 cost time: 0.9721870422363281
Epoch: 11, Steps: 64 | Train Loss: 0.1095235 Vali Loss: 0.1789517 Test Loss: 0.1603463
Validation loss decreased (0.181783 --> 0.178952).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 12 cost time: 0.9740853309631348
Epoch: 12, Steps: 64 | Train Loss: 0.1078393 Vali Loss: 0.1734574 Test Loss: 0.1566993
Validation loss decreased (0.178952 --> 0.173457).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 13 cost time: 0.9714658260345459
Epoch: 13, Steps: 64 | Train Loss: 0.1062730 Vali Loss: 0.1719350 Test Loss: 0.1550100
Validation loss decreased (0.173457 --> 0.171935).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 14 cost time: 0.9524292945861816
Epoch: 14, Steps: 64 | Train Loss: 0.1049066 Vali Loss: 0.1708615 Test Loss: 0.1534849
Validation loss decreased (0.171935 --> 0.170862).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 15 cost time: 0.9525566101074219
Epoch: 15, Steps: 64 | Train Loss: 0.1040213 Vali Loss: 0.1675143 Test Loss: 0.1516556
Validation loss decreased (0.170862 --> 0.167514).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 16 cost time: 0.94700026512146
Epoch: 16, Steps: 64 | Train Loss: 0.1032285 Vali Loss: 0.1675686 Test Loss: 0.1509522
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 17 cost time: 0.9546389579772949
Epoch: 17, Steps: 64 | Train Loss: 0.1024937 Vali Loss: 0.1669835 Test Loss: 0.1495350
Validation loss decreased (0.167514 --> 0.166983).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 18 cost time: 0.9666099548339844
Epoch: 18, Steps: 64 | Train Loss: 0.1019089 Vali Loss: 0.1665865 Test Loss: 0.1503488
Validation loss decreased (0.166983 --> 0.166587).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 19 cost time: 0.9761734008789062
Epoch: 19, Steps: 64 | Train Loss: 0.1011261 Vali Loss: 0.1659745 Test Loss: 0.1489372
Validation loss decreased (0.166587 --> 0.165974).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 20 cost time: 0.9455792903900146
Epoch: 20, Steps: 64 | Train Loss: 0.1007682 Vali Loss: 0.1658645 Test Loss: 0.1492388
Validation loss decreased (0.165974 --> 0.165864).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 21 cost time: 0.9559919834136963
Epoch: 21, Steps: 64 | Train Loss: 0.1005485 Vali Loss: 0.1633426 Test Loss: 0.1475401
Validation loss decreased (0.165864 --> 0.163343).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 22 cost time: 0.962390661239624
Epoch: 22, Steps: 64 | Train Loss: 0.0995090 Vali Loss: 0.1643534 Test Loss: 0.1482923
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 23 cost time: 0.936610221862793
Epoch: 23, Steps: 64 | Train Loss: 0.0995894 Vali Loss: 0.1643479 Test Loss: 0.1475204
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 24 cost time: 0.9298069477081299
Epoch: 24, Steps: 64 | Train Loss: 0.0994655 Vali Loss: 0.1616381 Test Loss: 0.1468883
Validation loss decreased (0.163343 --> 0.161638).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 25 cost time: 0.9281206130981445
Epoch: 25, Steps: 64 | Train Loss: 0.0987658 Vali Loss: 0.1621739 Test Loss: 0.1466701
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 26 cost time: 0.9346346855163574
Epoch: 26, Steps: 64 | Train Loss: 0.0985160 Vali Loss: 0.1627742 Test Loss: 0.1468101
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 27 cost time: 0.9366455078125
Epoch: 27, Steps: 64 | Train Loss: 0.0980916 Vali Loss: 0.1628570 Test Loss: 0.1462427
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 28 cost time: 0.9396340847015381
Epoch: 28, Steps: 64 | Train Loss: 0.0986359 Vali Loss: 0.1638736 Test Loss: 0.1462458
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 29 cost time: 0.9644017219543457
Epoch: 29, Steps: 64 | Train Loss: 0.0981936 Vali Loss: 0.1632991 Test Loss: 0.1462661
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 30 cost time: 0.9634170532226562
Epoch: 30, Steps: 64 | Train Loss: 0.0979334 Vali Loss: 0.1646095 Test Loss: 0.1467099
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 31 cost time: 0.9684102535247803
Epoch: 31, Steps: 64 | Train Loss: 0.0975121 Vali Loss: 0.1626432 Test Loss: 0.1455486
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 32 cost time: 0.9523501396179199
Epoch: 32, Steps: 64 | Train Loss: 0.0977963 Vali Loss: 0.1611949 Test Loss: 0.1457198
Validation loss decreased (0.161638 --> 0.161195).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 33 cost time: 0.9498071670532227
Epoch: 33, Steps: 64 | Train Loss: 0.0971215 Vali Loss: 0.1635086 Test Loss: 0.1458441
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 34 cost time: 0.9569981098175049
Epoch: 34, Steps: 64 | Train Loss: 0.0969032 Vali Loss: 0.1610199 Test Loss: 0.1458544
Validation loss decreased (0.161195 --> 0.161020).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 35 cost time: 0.9656345844268799
Epoch: 35, Steps: 64 | Train Loss: 0.0972170 Vali Loss: 0.1631471 Test Loss: 0.1460256
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 36 cost time: 0.9640672206878662
Epoch: 36, Steps: 64 | Train Loss: 0.0977644 Vali Loss: 0.1628735 Test Loss: 0.1450996
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 37 cost time: 0.9724612236022949
Epoch: 37, Steps: 64 | Train Loss: 0.0970282 Vali Loss: 0.1633755 Test Loss: 0.1460970
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 38 cost time: 0.974677562713623
Epoch: 38, Steps: 64 | Train Loss: 0.0970213 Vali Loss: 0.1609805 Test Loss: 0.1457474
Validation loss decreased (0.161020 --> 0.160981).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 39 cost time: 0.935438871383667
Epoch: 39, Steps: 64 | Train Loss: 0.0969636 Vali Loss: 0.1616695 Test Loss: 0.1451325
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 40 cost time: 0.9144704341888428
Epoch: 40, Steps: 64 | Train Loss: 0.0970302 Vali Loss: 0.1612062 Test Loss: 0.1449276
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 41 cost time: 0.9345014095306396
Epoch: 41, Steps: 64 | Train Loss: 0.0969113 Vali Loss: 0.1619838 Test Loss: 0.1453724
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 42 cost time: 0.9170010089874268
Epoch: 42, Steps: 64 | Train Loss: 0.0970184 Vali Loss: 0.1609886 Test Loss: 0.1453629
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 43 cost time: 0.9614181518554688
Epoch: 43, Steps: 64 | Train Loss: 0.0964682 Vali Loss: 0.1608795 Test Loss: 0.1450198
Validation loss decreased (0.160981 --> 0.160880).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 44 cost time: 0.9574401378631592
Epoch: 44, Steps: 64 | Train Loss: 0.0967039 Vali Loss: 0.1629634 Test Loss: 0.1459078
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 45 cost time: 0.9389998912811279
Epoch: 45, Steps: 64 | Train Loss: 0.0972252 Vali Loss: 0.1614746 Test Loss: 0.1453011
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 46 cost time: 0.9346354007720947
Epoch: 46, Steps: 64 | Train Loss: 0.0968925 Vali Loss: 0.1597621 Test Loss: 0.1445310
Validation loss decreased (0.160880 --> 0.159762).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 47 cost time: 0.9386467933654785
Epoch: 47, Steps: 64 | Train Loss: 0.0959895 Vali Loss: 0.1599189 Test Loss: 0.1451069
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 48 cost time: 0.9370014667510986
Epoch: 48, Steps: 64 | Train Loss: 0.0965202 Vali Loss: 0.1617084 Test Loss: 0.1450674
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 49 cost time: 0.9448668956756592
Epoch: 49, Steps: 64 | Train Loss: 0.0963185 Vali Loss: 0.1623096 Test Loss: 0.1456444
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 50 cost time: 0.9510002136230469
Epoch: 50, Steps: 64 | Train Loss: 0.0964688 Vali Loss: 0.1622950 Test Loss: 0.1455083
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 51 cost time: 0.9566488265991211
Epoch: 51, Steps: 64 | Train Loss: 0.0965756 Vali Loss: 0.1630690 Test Loss: 0.1451122
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 52 cost time: 0.9701237678527832
Epoch: 52, Steps: 64 | Train Loss: 0.0964939 Vali Loss: 0.1623778 Test Loss: 0.1451025
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 53 cost time: 0.9676251411437988
Epoch: 53, Steps: 64 | Train Loss: 0.0965022 Vali Loss: 0.1616976 Test Loss: 0.1449283
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 54 cost time: 0.964533805847168
Epoch: 54, Steps: 64 | Train Loss: 0.0964363 Vali Loss: 0.1610229 Test Loss: 0.1451236
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 55 cost time: 0.9685945510864258
Epoch: 55, Steps: 64 | Train Loss: 0.0961898 Vali Loss: 0.1618136 Test Loss: 0.1451758
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 56 cost time: 0.9568612575531006
Epoch: 56, Steps: 64 | Train Loss: 0.0967204 Vali Loss: 0.1606626 Test Loss: 0.1451304
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 57 cost time: 0.9428098201751709
Epoch: 57, Steps: 64 | Train Loss: 0.0963833 Vali Loss: 0.1634693 Test Loss: 0.1456817
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 58 cost time: 0.9363460540771484
Epoch: 58, Steps: 64 | Train Loss: 0.0963835 Vali Loss: 0.1606824 Test Loss: 0.1445582
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 59 cost time: 0.9140002727508545
Epoch: 59, Steps: 64 | Train Loss: 0.0959219 Vali Loss: 0.1612318 Test Loss: 0.1452606
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017847061157226562 GB
GPU已分配内存的峰值：0.04958629608154297 GB
Epoch: 60 cost time: 0.9206387996673584
Epoch: 60, Steps: 64 | Train Loss: 0.0968026 Vali Loss: 0.1619446 Test Loss: 0.1457236
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14453105628490448, mae:0.2835339903831482, rse:0.2023492306470871
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.0487828254699707 GB
Epoch: 1 cost time: 2.348728895187378
Epoch: 1, Steps: 64 | Train Loss: 0.7692542 Vali Loss: 1.8074522 Test Loss: 3.4429953
Validation loss decreased (inf --> 1.807452).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 2 cost time: 0.9746274948120117
Epoch: 2, Steps: 64 | Train Loss: 0.6406757 Vali Loss: 1.1975875 Test Loss: 2.1699710
Validation loss decreased (1.807452 --> 1.197587).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 3 cost time: 0.9646477699279785
Epoch: 3, Steps: 64 | Train Loss: 0.4101446 Vali Loss: 0.6604651 Test Loss: 1.0733777
Validation loss decreased (1.197587 --> 0.660465).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 4 cost time: 0.9758543968200684
Epoch: 4, Steps: 64 | Train Loss: 0.2234567 Vali Loss: 0.3392595 Test Loss: 0.4360054
Validation loss decreased (0.660465 --> 0.339259).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 5 cost time: 0.9441874027252197
Epoch: 5, Steps: 64 | Train Loss: 0.1378494 Vali Loss: 0.2224126 Test Loss: 0.2174243
Validation loss decreased (0.339259 --> 0.222413).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 6 cost time: 0.9404213428497314
Epoch: 6, Steps: 64 | Train Loss: 0.1145675 Vali Loss: 0.1886022 Test Loss: 0.1668969
Validation loss decreased (0.222413 --> 0.188602).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 7 cost time: 0.9423747062683105
Epoch: 7, Steps: 64 | Train Loss: 0.1079417 Vali Loss: 0.1775128 Test Loss: 0.1572575
Validation loss decreased (0.188602 --> 0.177513).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 8 cost time: 0.949383020401001
Epoch: 8, Steps: 64 | Train Loss: 0.1046821 Vali Loss: 0.1707626 Test Loss: 0.1505734
Validation loss decreased (0.177513 --> 0.170763).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 9 cost time: 0.9608280658721924
Epoch: 9, Steps: 64 | Train Loss: 0.1022168 Vali Loss: 0.1686891 Test Loss: 0.1504038
Validation loss decreased (0.170763 --> 0.168689).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 10 cost time: 0.9854445457458496
Epoch: 10, Steps: 64 | Train Loss: 0.1003798 Vali Loss: 0.1628942 Test Loss: 0.1476555
Validation loss decreased (0.168689 --> 0.162894).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 11 cost time: 1.0029997825622559
Epoch: 11, Steps: 64 | Train Loss: 0.0984314 Vali Loss: 0.1663655 Test Loss: 0.1486484
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 12 cost time: 0.9960014820098877
Epoch: 12, Steps: 64 | Train Loss: 0.0977195 Vali Loss: 0.1670850 Test Loss: 0.1470257
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 13 cost time: 0.988640546798706
Epoch: 13, Steps: 64 | Train Loss: 0.0963881 Vali Loss: 0.1642899 Test Loss: 0.1467627
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 14 cost time: 0.995654821395874
Epoch: 14, Steps: 64 | Train Loss: 0.0951558 Vali Loss: 0.1638049 Test Loss: 0.1465042
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 15 cost time: 0.9764609336853027
Epoch: 15, Steps: 64 | Train Loss: 0.0946914 Vali Loss: 0.1602854 Test Loss: 0.1453988
Validation loss decreased (0.162894 --> 0.160285).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 16 cost time: 0.9732558727264404
Epoch: 16, Steps: 64 | Train Loss: 0.0944659 Vali Loss: 0.1623029 Test Loss: 0.1465853
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 17 cost time: 0.9751355648040771
Epoch: 17, Steps: 64 | Train Loss: 0.0941666 Vali Loss: 0.1618269 Test Loss: 0.1458003
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 18 cost time: 0.9978010654449463
Epoch: 18, Steps: 64 | Train Loss: 0.0933152 Vali Loss: 0.1623257 Test Loss: 0.1458654
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 19 cost time: 0.9954848289489746
Epoch: 19, Steps: 64 | Train Loss: 0.0931102 Vali Loss: 0.1598426 Test Loss: 0.1466522
Validation loss decreased (0.160285 --> 0.159843).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 20 cost time: 0.9995379447937012
Epoch: 20, Steps: 64 | Train Loss: 0.0928941 Vali Loss: 0.1601686 Test Loss: 0.1472176
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 21 cost time: 0.977745771408081
Epoch: 21, Steps: 64 | Train Loss: 0.0922323 Vali Loss: 0.1614860 Test Loss: 0.1462845
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 22 cost time: 0.9446239471435547
Epoch: 22, Steps: 64 | Train Loss: 0.0918138 Vali Loss: 0.1606321 Test Loss: 0.1460326
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 23 cost time: 0.9420008659362793
Epoch: 23, Steps: 64 | Train Loss: 0.0918178 Vali Loss: 0.1603809 Test Loss: 0.1457362
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 24 cost time: 0.9526505470275879
Epoch: 24, Steps: 64 | Train Loss: 0.0918830 Vali Loss: 0.1600828 Test Loss: 0.1459125
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 25 cost time: 0.9423496723175049
Epoch: 25, Steps: 64 | Train Loss: 0.0917297 Vali Loss: 0.1613793 Test Loss: 0.1466184
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 26 cost time: 0.9584639072418213
Epoch: 26, Steps: 64 | Train Loss: 0.0913890 Vali Loss: 0.1601563 Test Loss: 0.1458339
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 27 cost time: 0.9726531505584717
Epoch: 27, Steps: 64 | Train Loss: 0.0914879 Vali Loss: 0.1605381 Test Loss: 0.1462247
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 28 cost time: 0.96620774269104
Epoch: 28, Steps: 64 | Train Loss: 0.0911031 Vali Loss: 0.1603611 Test Loss: 0.1461957
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 29 cost time: 0.9903807640075684
Epoch: 29, Steps: 64 | Train Loss: 0.0911768 Vali Loss: 0.1597689 Test Loss: 0.1463857
Validation loss decreased (0.159843 --> 0.159769).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 30 cost time: 0.9828402996063232
Epoch: 30, Steps: 64 | Train Loss: 0.0910662 Vali Loss: 0.1595490 Test Loss: 0.1463690
Validation loss decreased (0.159769 --> 0.159549).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 31 cost time: 0.9772629737854004
Epoch: 31, Steps: 64 | Train Loss: 0.0907108 Vali Loss: 0.1595115 Test Loss: 0.1458114
Validation loss decreased (0.159549 --> 0.159511).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 32 cost time: 0.9719998836517334
Epoch: 32, Steps: 64 | Train Loss: 0.0905008 Vali Loss: 0.1607175 Test Loss: 0.1459578
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 33 cost time: 0.9816436767578125
Epoch: 33, Steps: 64 | Train Loss: 0.0909424 Vali Loss: 0.1595576 Test Loss: 0.1454833
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 34 cost time: 0.9946334362030029
Epoch: 34, Steps: 64 | Train Loss: 0.0903372 Vali Loss: 0.1602768 Test Loss: 0.1460927
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 35 cost time: 0.9967613220214844
Epoch: 35, Steps: 64 | Train Loss: 0.0906323 Vali Loss: 0.1582400 Test Loss: 0.1471545
Validation loss decreased (0.159511 --> 0.158240).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 36 cost time: 0.9873764514923096
Epoch: 36, Steps: 64 | Train Loss: 0.0905630 Vali Loss: 0.1612352 Test Loss: 0.1465871
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 37 cost time: 0.9954800605773926
Epoch: 37, Steps: 64 | Train Loss: 0.0904876 Vali Loss: 0.1589822 Test Loss: 0.1468003
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 38 cost time: 0.9971680641174316
Epoch: 38, Steps: 64 | Train Loss: 0.0897338 Vali Loss: 0.1607122 Test Loss: 0.1464118
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 39 cost time: 0.9835622310638428
Epoch: 39, Steps: 64 | Train Loss: 0.0903747 Vali Loss: 0.1588879 Test Loss: 0.1457067
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 40 cost time: 0.9909470081329346
Epoch: 40, Steps: 64 | Train Loss: 0.0903111 Vali Loss: 0.1588804 Test Loss: 0.1461646
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 41 cost time: 0.9553980827331543
Epoch: 41, Steps: 64 | Train Loss: 0.0907696 Vali Loss: 0.1594333 Test Loss: 0.1461907
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 42 cost time: 0.9408533573150635
Epoch: 42, Steps: 64 | Train Loss: 0.0905658 Vali Loss: 0.1589097 Test Loss: 0.1459624
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 43 cost time: 0.9600002765655518
Epoch: 43, Steps: 64 | Train Loss: 0.0898884 Vali Loss: 0.1610031 Test Loss: 0.1471505
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 44 cost time: 0.963071346282959
Epoch: 44, Steps: 64 | Train Loss: 0.0902208 Vali Loss: 0.1619775 Test Loss: 0.1478473
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 45 cost time: 0.9556233882904053
Epoch: 45, Steps: 64 | Train Loss: 0.0902991 Vali Loss: 0.1601972 Test Loss: 0.1455822
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 46 cost time: 0.9583501815795898
Epoch: 46, Steps: 64 | Train Loss: 0.0899984 Vali Loss: 0.1589000 Test Loss: 0.1458895
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 47 cost time: 0.958376407623291
Epoch: 47, Steps: 64 | Train Loss: 0.0901863 Vali Loss: 0.1589452 Test Loss: 0.1466176
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 48 cost time: 0.9743211269378662
Epoch: 48, Steps: 64 | Train Loss: 0.0901177 Vali Loss: 0.1589563 Test Loss: 0.1462504
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 49 cost time: 0.9693872928619385
Epoch: 49, Steps: 64 | Train Loss: 0.0899616 Vali Loss: 0.1600702 Test Loss: 0.1472605
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 50 cost time: 0.977424144744873
Epoch: 50, Steps: 64 | Train Loss: 0.0896590 Vali Loss: 0.1596926 Test Loss: 0.1465685
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 51 cost time: 0.9946193695068359
Epoch: 51, Steps: 64 | Train Loss: 0.0904838 Vali Loss: 0.1591465 Test Loss: 0.1461661
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 52 cost time: 0.9901714324951172
Epoch: 52, Steps: 64 | Train Loss: 0.0900575 Vali Loss: 0.1598276 Test Loss: 0.1467320
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 53 cost time: 0.9920001029968262
Epoch: 53, Steps: 64 | Train Loss: 0.0899411 Vali Loss: 0.1602710 Test Loss: 0.1463854
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 54 cost time: 1.026214838027954
Epoch: 54, Steps: 64 | Train Loss: 0.0901563 Vali Loss: 0.1590731 Test Loss: 0.1468633
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 55 cost time: 0.9842581748962402
Epoch: 55, Steps: 64 | Train Loss: 0.0902420 Vali Loss: 0.1603462 Test Loss: 0.1464528
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 56 cost time: 0.9657812118530273
Epoch: 56, Steps: 64 | Train Loss: 0.0901598 Vali Loss: 0.1577395 Test Loss: 0.1467057
Validation loss decreased (0.158240 --> 0.157740).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 57 cost time: 0.9444506168365479
Epoch: 57, Steps: 64 | Train Loss: 0.0896415 Vali Loss: 0.1596704 Test Loss: 0.1470788
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 58 cost time: 0.9494161605834961
Epoch: 58, Steps: 64 | Train Loss: 0.0901775 Vali Loss: 0.1617134 Test Loss: 0.1481015
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 59 cost time: 0.9443750381469727
Epoch: 59, Steps: 64 | Train Loss: 0.0903109 Vali Loss: 0.1602712 Test Loss: 0.1464708
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017869949340820312 GB
GPU已分配内存的峰值：0.05033588409423828 GB
Epoch: 60 cost time: 0.9634284973144531
Epoch: 60, Steps: 64 | Train Loss: 0.0899447 Vali Loss: 0.1595424 Test Loss: 0.1462266
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14670568704605103, mae:0.2814372777938843, rse:0.20386582612991333
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.047678470611572266 GB
Epoch: 1 cost time: 2.2916676998138428
Epoch: 1, Steps: 64 | Train Loss: 0.8289085 Vali Loss: 1.6628126 Test Loss: 2.9629626
Validation loss decreased (inf --> 1.662813).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 2 cost time: 0.9115486145019531
Epoch: 2, Steps: 64 | Train Loss: 0.5587863 Vali Loss: 0.6721963 Test Loss: 0.9710097
Validation loss decreased (1.662813 --> 0.672196).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 3 cost time: 0.9163610935211182
Epoch: 3, Steps: 64 | Train Loss: 0.3001348 Vali Loss: 0.3963514 Test Loss: 0.4608288
Validation loss decreased (0.672196 --> 0.396351).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 4 cost time: 0.9159998893737793
Epoch: 4, Steps: 64 | Train Loss: 0.2091491 Vali Loss: 0.3011845 Test Loss: 0.3304954
Validation loss decreased (0.396351 --> 0.301184).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 5 cost time: 0.8963868618011475
Epoch: 5, Steps: 64 | Train Loss: 0.1791169 Vali Loss: 0.2546548 Test Loss: 0.2670112
Validation loss decreased (0.301184 --> 0.254655).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 6 cost time: 0.8896467685699463
Epoch: 6, Steps: 64 | Train Loss: 0.1625246 Vali Loss: 0.2311815 Test Loss: 0.2306055
Validation loss decreased (0.254655 --> 0.231182).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 7 cost time: 0.8825564384460449
Epoch: 7, Steps: 64 | Train Loss: 0.1514642 Vali Loss: 0.2134656 Test Loss: 0.2065389
Validation loss decreased (0.231182 --> 0.213466).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 8 cost time: 0.8873627185821533
Epoch: 8, Steps: 64 | Train Loss: 0.1431290 Vali Loss: 0.2030482 Test Loss: 0.1928668
Validation loss decreased (0.213466 --> 0.203048).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 9 cost time: 0.8864169120788574
Epoch: 9, Steps: 64 | Train Loss: 0.1373886 Vali Loss: 0.1981787 Test Loss: 0.1839431
Validation loss decreased (0.203048 --> 0.198179).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 10 cost time: 0.9121413230895996
Epoch: 10, Steps: 64 | Train Loss: 0.1337397 Vali Loss: 0.1926642 Test Loss: 0.1738956
Validation loss decreased (0.198179 --> 0.192664).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 11 cost time: 0.9369997978210449
Epoch: 11, Steps: 64 | Train Loss: 0.1305664 Vali Loss: 0.1875012 Test Loss: 0.1711059
Validation loss decreased (0.192664 --> 0.187501).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 12 cost time: 0.9396347999572754
Epoch: 12, Steps: 64 | Train Loss: 0.1274623 Vali Loss: 0.1854882 Test Loss: 0.1659372
Validation loss decreased (0.187501 --> 0.185488).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 13 cost time: 0.9394242763519287
Epoch: 13, Steps: 64 | Train Loss: 0.1242450 Vali Loss: 0.1798557 Test Loss: 0.1629533
Validation loss decreased (0.185488 --> 0.179856).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 14 cost time: 0.9277524948120117
Epoch: 14, Steps: 64 | Train Loss: 0.1230558 Vali Loss: 0.1809334 Test Loss: 0.1617653
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 15 cost time: 0.915363073348999
Epoch: 15, Steps: 64 | Train Loss: 0.1212677 Vali Loss: 0.1749536 Test Loss: 0.1596029
Validation loss decreased (0.179856 --> 0.174954).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 16 cost time: 0.9210002422332764
Epoch: 16, Steps: 64 | Train Loss: 0.1193293 Vali Loss: 0.1767924 Test Loss: 0.1605686
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 17 cost time: 0.9137284755706787
Epoch: 17, Steps: 64 | Train Loss: 0.1184250 Vali Loss: 0.1752317 Test Loss: 0.1594239
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 18 cost time: 0.9469985961914062
Epoch: 18, Steps: 64 | Train Loss: 0.1167525 Vali Loss: 0.1751871 Test Loss: 0.1601125
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 19 cost time: 0.9376122951507568
Epoch: 19, Steps: 64 | Train Loss: 0.1164392 Vali Loss: 0.1758271 Test Loss: 0.1581727
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 20 cost time: 0.9386327266693115
Epoch: 20, Steps: 64 | Train Loss: 0.1152058 Vali Loss: 0.1741453 Test Loss: 0.1581194
Validation loss decreased (0.174954 --> 0.174145).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 21 cost time: 0.9433994293212891
Epoch: 21, Steps: 64 | Train Loss: 0.1149620 Vali Loss: 0.1731766 Test Loss: 0.1565607
Validation loss decreased (0.174145 --> 0.173177).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 22 cost time: 0.909388542175293
Epoch: 22, Steps: 64 | Train Loss: 0.1140348 Vali Loss: 0.1722972 Test Loss: 0.1569981
Validation loss decreased (0.173177 --> 0.172297).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 23 cost time: 0.8878593444824219
Epoch: 23, Steps: 64 | Train Loss: 0.1135060 Vali Loss: 0.1733131 Test Loss: 0.1562234
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 24 cost time: 0.8989303112030029
Epoch: 24, Steps: 64 | Train Loss: 0.1130350 Vali Loss: 0.1730085 Test Loss: 0.1561217
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 25 cost time: 0.9039993286132812
Epoch: 25, Steps: 64 | Train Loss: 0.1125637 Vali Loss: 0.1712350 Test Loss: 0.1562176
Validation loss decreased (0.172297 --> 0.171235).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 26 cost time: 0.8940000534057617
Epoch: 26, Steps: 64 | Train Loss: 0.1120526 Vali Loss: 0.1730000 Test Loss: 0.1556194
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 27 cost time: 0.9128389358520508
Epoch: 27, Steps: 64 | Train Loss: 0.1121259 Vali Loss: 0.1697747 Test Loss: 0.1552110
Validation loss decreased (0.171235 --> 0.169775).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 28 cost time: 0.9139976501464844
Epoch: 28, Steps: 64 | Train Loss: 0.1113142 Vali Loss: 0.1714790 Test Loss: 0.1554771
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 29 cost time: 0.9013757705688477
Epoch: 29, Steps: 64 | Train Loss: 0.1113999 Vali Loss: 0.1653976 Test Loss: 0.1552651
Validation loss decreased (0.169775 --> 0.165398).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 30 cost time: 0.9163851737976074
Epoch: 30, Steps: 64 | Train Loss: 0.1107831 Vali Loss: 0.1707436 Test Loss: 0.1557034
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 31 cost time: 0.9158141613006592
Epoch: 31, Steps: 64 | Train Loss: 0.1109290 Vali Loss: 0.1693251 Test Loss: 0.1545685
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 32 cost time: 0.9225003719329834
Epoch: 32, Steps: 64 | Train Loss: 0.1102148 Vali Loss: 0.1695396 Test Loss: 0.1556167
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 33 cost time: 0.9196863174438477
Epoch: 33, Steps: 64 | Train Loss: 0.1106746 Vali Loss: 0.1710145 Test Loss: 0.1555919
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 34 cost time: 0.9203791618347168
Epoch: 34, Steps: 64 | Train Loss: 0.1098548 Vali Loss: 0.1703053 Test Loss: 0.1554535
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 35 cost time: 0.9158625602722168
Epoch: 35, Steps: 64 | Train Loss: 0.1100502 Vali Loss: 0.1718673 Test Loss: 0.1556623
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 36 cost time: 0.9410812854766846
Epoch: 36, Steps: 64 | Train Loss: 0.1093570 Vali Loss: 0.1699799 Test Loss: 0.1559941
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 37 cost time: 0.9333853721618652
Epoch: 37, Steps: 64 | Train Loss: 0.1096754 Vali Loss: 0.1698873 Test Loss: 0.1555084
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 38 cost time: 0.9487869739532471
Epoch: 38, Steps: 64 | Train Loss: 0.1094465 Vali Loss: 0.1686921 Test Loss: 0.1560014
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 39 cost time: 0.9460012912750244
Epoch: 39, Steps: 64 | Train Loss: 0.1094077 Vali Loss: 0.1686147 Test Loss: 0.1553870
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 40 cost time: 0.9229996204376221
Epoch: 40, Steps: 64 | Train Loss: 0.1089161 Vali Loss: 0.1701498 Test Loss: 0.1548211
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 41 cost time: 0.8943467140197754
Epoch: 41, Steps: 64 | Train Loss: 0.1092794 Vali Loss: 0.1704046 Test Loss: 0.1550999
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 42 cost time: 0.9034085273742676
Epoch: 42, Steps: 64 | Train Loss: 0.1090134 Vali Loss: 0.1686051 Test Loss: 0.1550882
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 43 cost time: 0.8893852233886719
Epoch: 43, Steps: 64 | Train Loss: 0.1089390 Vali Loss: 0.1693130 Test Loss: 0.1548796
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 44 cost time: 0.9053852558135986
Epoch: 44, Steps: 64 | Train Loss: 0.1081039 Vali Loss: 0.1701240 Test Loss: 0.1544425
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 45 cost time: 0.9169692993164062
Epoch: 45, Steps: 64 | Train Loss: 0.1088712 Vali Loss: 0.1687737 Test Loss: 0.1554096
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 46 cost time: 0.9367902278900146
Epoch: 46, Steps: 64 | Train Loss: 0.1092778 Vali Loss: 0.1694353 Test Loss: 0.1551940
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 47 cost time: 0.9146337509155273
Epoch: 47, Steps: 64 | Train Loss: 0.1089423 Vali Loss: 0.1666719 Test Loss: 0.1544987
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 48 cost time: 0.9143722057342529
Epoch: 48, Steps: 64 | Train Loss: 0.1085005 Vali Loss: 0.1691917 Test Loss: 0.1549809
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 49 cost time: 0.8983845710754395
Epoch: 49, Steps: 64 | Train Loss: 0.1075397 Vali Loss: 0.1654896 Test Loss: 0.1544155
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 50 cost time: 0.9354579448699951
Epoch: 50, Steps: 64 | Train Loss: 0.1085678 Vali Loss: 0.1700824 Test Loss: 0.1547233
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 51 cost time: 0.935150146484375
Epoch: 51, Steps: 64 | Train Loss: 0.1087535 Vali Loss: 0.1686068 Test Loss: 0.1551751
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 52 cost time: 0.9377808570861816
Epoch: 52, Steps: 64 | Train Loss: 0.1087731 Vali Loss: 0.1684823 Test Loss: 0.1545255
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 53 cost time: 0.9459998607635498
Epoch: 53, Steps: 64 | Train Loss: 0.1087587 Vali Loss: 0.1709595 Test Loss: 0.1552355
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 54 cost time: 0.934622049331665
Epoch: 54, Steps: 64 | Train Loss: 0.1083502 Vali Loss: 0.1677831 Test Loss: 0.1558800
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 55 cost time: 0.9379847049713135
Epoch: 55, Steps: 64 | Train Loss: 0.1084548 Vali Loss: 0.1691435 Test Loss: 0.1553905
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 56 cost time: 0.9504537582397461
Epoch: 56, Steps: 64 | Train Loss: 0.1085168 Vali Loss: 0.1708106 Test Loss: 0.1558094
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 57 cost time: 0.9413690567016602
Epoch: 57, Steps: 64 | Train Loss: 0.1088393 Vali Loss: 0.1697297 Test Loss: 0.1547475
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 58 cost time: 0.9106273651123047
Epoch: 58, Steps: 64 | Train Loss: 0.1082690 Vali Loss: 0.1706105 Test Loss: 0.1548923
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 59 cost time: 0.9194738864898682
Epoch: 59, Steps: 64 | Train Loss: 0.1084779 Vali Loss: 0.1689084 Test Loss: 0.1544177
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017812728881835938 GB
GPU已分配内存的峰值：0.04898834228515625 GB
Epoch: 60 cost time: 0.9196467399597168
Epoch: 60, Steps: 64 | Train Loss: 0.1083821 Vali Loss: 0.1704258 Test Loss: 0.1547312
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15526512265205383, mae:0.29820942878723145, rse:0.20972873270511627
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04837989807128906 GB
Epoch: 1 cost time: 2.3487589359283447
Epoch: 1, Steps: 64 | Train Loss: 0.8768841 Vali Loss: 1.9655432 Test Loss: 3.7232869
Validation loss decreased (inf --> 1.965543).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 2 cost time: 0.9824190139770508
Epoch: 2, Steps: 64 | Train Loss: 0.6576920 Vali Loss: 1.1122103 Test Loss: 1.9038610
Validation loss decreased (1.965543 --> 1.112210).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 3 cost time: 0.9630000591278076
Epoch: 3, Steps: 64 | Train Loss: 0.3868788 Vali Loss: 0.6601110 Test Loss: 0.9976497
Validation loss decreased (1.112210 --> 0.660111).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 4 cost time: 0.9470000267028809
Epoch: 4, Steps: 64 | Train Loss: 0.2453612 Vali Loss: 0.4240380 Test Loss: 0.5703629
Validation loss decreased (0.660111 --> 0.424038).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 5 cost time: 0.929633617401123
Epoch: 5, Steps: 64 | Train Loss: 0.1748448 Vali Loss: 0.3019992 Test Loss: 0.3491858
Validation loss decreased (0.424038 --> 0.301999).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 6 cost time: 0.9654386043548584
Epoch: 6, Steps: 64 | Train Loss: 0.1405286 Vali Loss: 0.2408940 Test Loss: 0.2484357
Validation loss decreased (0.301999 --> 0.240894).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 7 cost time: 0.9213728904724121
Epoch: 7, Steps: 64 | Train Loss: 0.1249792 Vali Loss: 0.2099875 Test Loss: 0.1970692
Validation loss decreased (0.240894 --> 0.209988).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 8 cost time: 0.9504051208496094
Epoch: 8, Steps: 64 | Train Loss: 0.1163877 Vali Loss: 0.1936934 Test Loss: 0.1766963
Validation loss decreased (0.209988 --> 0.193693).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 9 cost time: 0.9753954410552979
Epoch: 9, Steps: 64 | Train Loss: 0.1108024 Vali Loss: 0.1851483 Test Loss: 0.1675186
Validation loss decreased (0.193693 --> 0.185148).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 10 cost time: 0.9494192600250244
Epoch: 10, Steps: 64 | Train Loss: 0.1081587 Vali Loss: 0.1759988 Test Loss: 0.1605453
Validation loss decreased (0.185148 --> 0.175999).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 11 cost time: 0.978956937789917
Epoch: 11, Steps: 64 | Train Loss: 0.1062491 Vali Loss: 0.1754392 Test Loss: 0.1570922
Validation loss decreased (0.175999 --> 0.175439).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 12 cost time: 0.9687559604644775
Epoch: 12, Steps: 64 | Train Loss: 0.1046388 Vali Loss: 0.1710859 Test Loss: 0.1539186
Validation loss decreased (0.175439 --> 0.171086).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 13 cost time: 0.9724242687225342
Epoch: 13, Steps: 64 | Train Loss: 0.1025849 Vali Loss: 0.1691712 Test Loss: 0.1540149
Validation loss decreased (0.171086 --> 0.169171).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 14 cost time: 0.951643705368042
Epoch: 14, Steps: 64 | Train Loss: 0.1019804 Vali Loss: 0.1696083 Test Loss: 0.1527866
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 15 cost time: 0.9516322612762451
Epoch: 15, Steps: 64 | Train Loss: 0.1008532 Vali Loss: 0.1697494 Test Loss: 0.1525704
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 16 cost time: 0.9543852806091309
Epoch: 16, Steps: 64 | Train Loss: 0.1002005 Vali Loss: 0.1675935 Test Loss: 0.1529077
Validation loss decreased (0.169171 --> 0.167593).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 17 cost time: 0.9501185417175293
Epoch: 17, Steps: 64 | Train Loss: 0.0996105 Vali Loss: 0.1659206 Test Loss: 0.1523440
Validation loss decreased (0.167593 --> 0.165921).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 18 cost time: 0.9644296169281006
Epoch: 18, Steps: 64 | Train Loss: 0.0986810 Vali Loss: 0.1635191 Test Loss: 0.1519299
Validation loss decreased (0.165921 --> 0.163519).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 19 cost time: 0.9683651924133301
Epoch: 19, Steps: 64 | Train Loss: 0.0985348 Vali Loss: 0.1658838 Test Loss: 0.1524262
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 20 cost time: 0.9505250453948975
Epoch: 20, Steps: 64 | Train Loss: 0.0985231 Vali Loss: 0.1661517 Test Loss: 0.1524143
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 21 cost time: 0.943781852722168
Epoch: 21, Steps: 64 | Train Loss: 0.0971615 Vali Loss: 0.1656412 Test Loss: 0.1512697
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 22 cost time: 0.9256377220153809
Epoch: 22, Steps: 64 | Train Loss: 0.0971519 Vali Loss: 0.1666199 Test Loss: 0.1520566
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 23 cost time: 0.9316353797912598
Epoch: 23, Steps: 64 | Train Loss: 0.0969885 Vali Loss: 0.1659411 Test Loss: 0.1522385
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 24 cost time: 0.9383585453033447
Epoch: 24, Steps: 64 | Train Loss: 0.0970227 Vali Loss: 0.1662602 Test Loss: 0.1514042
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 25 cost time: 0.97334885597229
Epoch: 25, Steps: 64 | Train Loss: 0.0965527 Vali Loss: 0.1651147 Test Loss: 0.1520599
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 26 cost time: 0.9759602546691895
Epoch: 26, Steps: 64 | Train Loss: 0.0959929 Vali Loss: 0.1646562 Test Loss: 0.1523758
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 27 cost time: 0.9443843364715576
Epoch: 27, Steps: 64 | Train Loss: 0.0960551 Vali Loss: 0.1658188 Test Loss: 0.1519365
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 28 cost time: 0.9483685493469238
Epoch: 28, Steps: 64 | Train Loss: 0.0961407 Vali Loss: 0.1663846 Test Loss: 0.1518907
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 29 cost time: 0.9417481422424316
Epoch: 29, Steps: 64 | Train Loss: 0.0960766 Vali Loss: 0.1649535 Test Loss: 0.1521702
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 30 cost time: 0.9743924140930176
Epoch: 30, Steps: 64 | Train Loss: 0.0954830 Vali Loss: 0.1652890 Test Loss: 0.1527381
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 31 cost time: 0.9520461559295654
Epoch: 31, Steps: 64 | Train Loss: 0.0952832 Vali Loss: 0.1639260 Test Loss: 0.1519531
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 32 cost time: 0.9536678791046143
Epoch: 32, Steps: 64 | Train Loss: 0.0954350 Vali Loss: 0.1659172 Test Loss: 0.1526547
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 33 cost time: 0.9543671607971191
Epoch: 33, Steps: 64 | Train Loss: 0.0948116 Vali Loss: 0.1623493 Test Loss: 0.1525510
Validation loss decreased (0.163519 --> 0.162349).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 34 cost time: 0.9510042667388916
Epoch: 34, Steps: 64 | Train Loss: 0.0952192 Vali Loss: 0.1659068 Test Loss: 0.1530466
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 35 cost time: 0.9733638763427734
Epoch: 35, Steps: 64 | Train Loss: 0.0949826 Vali Loss: 0.1643682 Test Loss: 0.1531061
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 36 cost time: 0.9744241237640381
Epoch: 36, Steps: 64 | Train Loss: 0.0948651 Vali Loss: 0.1649243 Test Loss: 0.1525699
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 37 cost time: 0.9790475368499756
Epoch: 37, Steps: 64 | Train Loss: 0.0946219 Vali Loss: 0.1651552 Test Loss: 0.1528405
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 38 cost time: 0.9724307060241699
Epoch: 38, Steps: 64 | Train Loss: 0.0943907 Vali Loss: 0.1649620 Test Loss: 0.1521584
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 39 cost time: 0.9337503910064697
Epoch: 39, Steps: 64 | Train Loss: 0.0945509 Vali Loss: 0.1645440 Test Loss: 0.1523540
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 40 cost time: 0.9219980239868164
Epoch: 40, Steps: 64 | Train Loss: 0.0943280 Vali Loss: 0.1656000 Test Loss: 0.1525397
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 41 cost time: 0.9216370582580566
Epoch: 41, Steps: 64 | Train Loss: 0.0942203 Vali Loss: 0.1658685 Test Loss: 0.1524402
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 42 cost time: 0.9190859794616699
Epoch: 42, Steps: 64 | Train Loss: 0.0944265 Vali Loss: 0.1641769 Test Loss: 0.1526410
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 43 cost time: 0.9393699169158936
Epoch: 43, Steps: 64 | Train Loss: 0.0940766 Vali Loss: 0.1644842 Test Loss: 0.1524205
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 44 cost time: 0.9353792667388916
Epoch: 44, Steps: 64 | Train Loss: 0.0942276 Vali Loss: 0.1628290 Test Loss: 0.1518698
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 45 cost time: 0.953620195388794
Epoch: 45, Steps: 64 | Train Loss: 0.0938274 Vali Loss: 0.1646253 Test Loss: 0.1532290
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 46 cost time: 0.939460277557373
Epoch: 46, Steps: 64 | Train Loss: 0.0947738 Vali Loss: 0.1646482 Test Loss: 0.1528348
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 47 cost time: 0.9463198184967041
Epoch: 47, Steps: 64 | Train Loss: 0.0938372 Vali Loss: 0.1653506 Test Loss: 0.1525761
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 48 cost time: 0.9306416511535645
Epoch: 48, Steps: 64 | Train Loss: 0.0942095 Vali Loss: 0.1627986 Test Loss: 0.1524550
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 49 cost time: 0.9433262348175049
Epoch: 49, Steps: 64 | Train Loss: 0.0937624 Vali Loss: 0.1622471 Test Loss: 0.1526111
Validation loss decreased (0.162349 --> 0.162247).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 50 cost time: 0.9636125564575195
Epoch: 50, Steps: 64 | Train Loss: 0.0943833 Vali Loss: 0.1652080 Test Loss: 0.1519148
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 51 cost time: 0.9541325569152832
Epoch: 51, Steps: 64 | Train Loss: 0.0942683 Vali Loss: 0.1642471 Test Loss: 0.1527863
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 52 cost time: 0.9654192924499512
Epoch: 52, Steps: 64 | Train Loss: 0.0942427 Vali Loss: 0.1631996 Test Loss: 0.1520524
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 53 cost time: 0.9764268398284912
Epoch: 53, Steps: 64 | Train Loss: 0.0943401 Vali Loss: 0.1632692 Test Loss: 0.1522560
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 54 cost time: 0.9664075374603271
Epoch: 54, Steps: 64 | Train Loss: 0.0942100 Vali Loss: 0.1651379 Test Loss: 0.1530530
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 55 cost time: 0.9738538265228271
Epoch: 55, Steps: 64 | Train Loss: 0.0941069 Vali Loss: 0.1628050 Test Loss: 0.1524663
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 56 cost time: 0.9684474468231201
Epoch: 56, Steps: 64 | Train Loss: 0.0935888 Vali Loss: 0.1632073 Test Loss: 0.1529230
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 57 cost time: 0.9770016670227051
Epoch: 57, Steps: 64 | Train Loss: 0.0941366 Vali Loss: 0.1640255 Test Loss: 0.1525824
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 58 cost time: 0.9416191577911377
Epoch: 58, Steps: 64 | Train Loss: 0.0938604 Vali Loss: 0.1639751 Test Loss: 0.1530643
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 59 cost time: 0.923377275466919
Epoch: 59, Steps: 64 | Train Loss: 0.0943319 Vali Loss: 0.1651111 Test Loss: 0.1522386
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017850875854492188 GB
GPU已分配内存的峰值：0.04974937438964844 GB
Epoch: 60 cost time: 0.9389917850494385
Epoch: 60, Steps: 64 | Train Loss: 0.0942802 Vali Loss: 0.1639183 Test Loss: 0.1525763
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1526111364364624, mae:0.29762452840805054, rse:0.20792853832244873
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.04894399642944336 GB
Epoch: 1 cost time: 2.3773462772369385
Epoch: 1, Steps: 64 | Train Loss: 0.8502940 Vali Loss: 1.9664923 Test Loss: 3.8332977
Validation loss decreased (inf --> 1.966492).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 2 cost time: 0.9674615859985352
Epoch: 2, Steps: 64 | Train Loss: 0.7071709 Vali Loss: 1.3032827 Test Loss: 2.4130580
Validation loss decreased (1.966492 --> 1.303283).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 3 cost time: 0.9785070419311523
Epoch: 3, Steps: 64 | Train Loss: 0.4397373 Vali Loss: 0.6717750 Test Loss: 1.0851290
Validation loss decreased (1.303283 --> 0.671775).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 4 cost time: 0.9794132709503174
Epoch: 4, Steps: 64 | Train Loss: 0.2343617 Vali Loss: 0.3426891 Test Loss: 0.4222233
Validation loss decreased (0.671775 --> 0.342689).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 5 cost time: 0.9442965984344482
Epoch: 5, Steps: 64 | Train Loss: 0.1381521 Vali Loss: 0.2218634 Test Loss: 0.2059262
Validation loss decreased (0.342689 --> 0.221863).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 6 cost time: 0.9434075355529785
Epoch: 6, Steps: 64 | Train Loss: 0.1152744 Vali Loss: 0.1927982 Test Loss: 0.1659203
Validation loss decreased (0.221863 --> 0.192798).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 7 cost time: 0.9453582763671875
Epoch: 7, Steps: 64 | Train Loss: 0.1093144 Vali Loss: 0.1841647 Test Loss: 0.1572879
Validation loss decreased (0.192798 --> 0.184165).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 8 cost time: 0.9390006065368652
Epoch: 8, Steps: 64 | Train Loss: 0.1060487 Vali Loss: 0.1798446 Test Loss: 0.1538252
Validation loss decreased (0.184165 --> 0.179845).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 9 cost time: 0.9673447608947754
Epoch: 9, Steps: 64 | Train Loss: 0.1033615 Vali Loss: 0.1771727 Test Loss: 0.1515050
Validation loss decreased (0.179845 --> 0.177173).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 10 cost time: 1.006627082824707
Epoch: 10, Steps: 64 | Train Loss: 0.1015150 Vali Loss: 0.1714800 Test Loss: 0.1498308
Validation loss decreased (0.177173 --> 0.171480).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 11 cost time: 0.9956419467926025
Epoch: 11, Steps: 64 | Train Loss: 0.0999989 Vali Loss: 0.1704796 Test Loss: 0.1481910
Validation loss decreased (0.171480 --> 0.170480).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 12 cost time: 1.00065279006958
Epoch: 12, Steps: 64 | Train Loss: 0.0984623 Vali Loss: 0.1687033 Test Loss: 0.1478711
Validation loss decreased (0.170480 --> 0.168703).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 13 cost time: 1.0010557174682617
Epoch: 13, Steps: 64 | Train Loss: 0.0973699 Vali Loss: 0.1661165 Test Loss: 0.1474755
Validation loss decreased (0.168703 --> 0.166116).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 14 cost time: 0.9764344692230225
Epoch: 14, Steps: 64 | Train Loss: 0.0970435 Vali Loss: 0.1653448 Test Loss: 0.1470592
Validation loss decreased (0.166116 --> 0.165345).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 15 cost time: 0.9793524742126465
Epoch: 15, Steps: 64 | Train Loss: 0.0960833 Vali Loss: 0.1655983 Test Loss: 0.1462931
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 16 cost time: 0.9793858528137207
Epoch: 16, Steps: 64 | Train Loss: 0.0954190 Vali Loss: 0.1641353 Test Loss: 0.1464905
Validation loss decreased (0.165345 --> 0.164135).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 17 cost time: 0.9857869148254395
Epoch: 17, Steps: 64 | Train Loss: 0.0944529 Vali Loss: 0.1631723 Test Loss: 0.1460728
Validation loss decreased (0.164135 --> 0.163172).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 18 cost time: 0.9963550567626953
Epoch: 18, Steps: 64 | Train Loss: 0.0946625 Vali Loss: 0.1630712 Test Loss: 0.1451513
Validation loss decreased (0.163172 --> 0.163071).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 19 cost time: 1.0027759075164795
Epoch: 19, Steps: 64 | Train Loss: 0.0938958 Vali Loss: 0.1645938 Test Loss: 0.1461348
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 20 cost time: 0.9937715530395508
Epoch: 20, Steps: 64 | Train Loss: 0.0935219 Vali Loss: 0.1629046 Test Loss: 0.1461000
Validation loss decreased (0.163071 --> 0.162905).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 21 cost time: 0.959399938583374
Epoch: 21, Steps: 64 | Train Loss: 0.0931054 Vali Loss: 0.1626410 Test Loss: 0.1455840
Validation loss decreased (0.162905 --> 0.162641).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 22 cost time: 0.9496433734893799
Epoch: 22, Steps: 64 | Train Loss: 0.0927742 Vali Loss: 0.1650118 Test Loss: 0.1473358
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 23 cost time: 0.9563777446746826
Epoch: 23, Steps: 64 | Train Loss: 0.0924425 Vali Loss: 0.1614337 Test Loss: 0.1461485
Validation loss decreased (0.162641 --> 0.161434).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 24 cost time: 0.9414255619049072
Epoch: 24, Steps: 64 | Train Loss: 0.0925302 Vali Loss: 0.1606978 Test Loss: 0.1455934
Validation loss decreased (0.161434 --> 0.160698).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 25 cost time: 0.9472918510437012
Epoch: 25, Steps: 64 | Train Loss: 0.0927154 Vali Loss: 0.1622733 Test Loss: 0.1456519
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 26 cost time: 0.976417064666748
Epoch: 26, Steps: 64 | Train Loss: 0.0920750 Vali Loss: 0.1623505 Test Loss: 0.1457638
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 27 cost time: 0.9724578857421875
Epoch: 27, Steps: 64 | Train Loss: 0.0921581 Vali Loss: 0.1625750 Test Loss: 0.1461151
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 28 cost time: 0.9724113941192627
Epoch: 28, Steps: 64 | Train Loss: 0.0918379 Vali Loss: 0.1620431 Test Loss: 0.1470482
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 29 cost time: 1.0418097972869873
Epoch: 29, Steps: 64 | Train Loss: 0.0914261 Vali Loss: 0.1630470 Test Loss: 0.1466596
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 30 cost time: 0.9898459911346436
Epoch: 30, Steps: 64 | Train Loss: 0.0917621 Vali Loss: 0.1623098 Test Loss: 0.1457568
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 31 cost time: 0.9880008697509766
Epoch: 31, Steps: 64 | Train Loss: 0.0915248 Vali Loss: 0.1616767 Test Loss: 0.1457725
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 32 cost time: 0.9769983291625977
Epoch: 32, Steps: 64 | Train Loss: 0.0914795 Vali Loss: 0.1621163 Test Loss: 0.1465195
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 33 cost time: 0.9945054054260254
Epoch: 33, Steps: 64 | Train Loss: 0.0909535 Vali Loss: 0.1626094 Test Loss: 0.1464115
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 34 cost time: 0.9986121654510498
Epoch: 34, Steps: 64 | Train Loss: 0.0912550 Vali Loss: 0.1625688 Test Loss: 0.1473582
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 35 cost time: 1.0889358520507812
Epoch: 35, Steps: 64 | Train Loss: 0.0913666 Vali Loss: 0.1613680 Test Loss: 0.1468881
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 36 cost time: 1.01576566696167
Epoch: 36, Steps: 64 | Train Loss: 0.0914757 Vali Loss: 0.1624267 Test Loss: 0.1470107
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 37 cost time: 1.0074632167816162
Epoch: 37, Steps: 64 | Train Loss: 0.0911231 Vali Loss: 0.1601487 Test Loss: 0.1459588
Validation loss decreased (0.160698 --> 0.160149).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 38 cost time: 0.952380895614624
Epoch: 38, Steps: 64 | Train Loss: 0.0907424 Vali Loss: 0.1609654 Test Loss: 0.1470236
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 39 cost time: 0.9619061946868896
Epoch: 39, Steps: 64 | Train Loss: 0.0913400 Vali Loss: 0.1600035 Test Loss: 0.1469839
Validation loss decreased (0.160149 --> 0.160003).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 40 cost time: 0.9433858394622803
Epoch: 40, Steps: 64 | Train Loss: 0.0909415 Vali Loss: 0.1607902 Test Loss: 0.1467958
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 41 cost time: 0.9452846050262451
Epoch: 41, Steps: 64 | Train Loss: 0.0913369 Vali Loss: 0.1599486 Test Loss: 0.1460430
Validation loss decreased (0.160003 --> 0.159949).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 42 cost time: 0.9637405872344971
Epoch: 42, Steps: 64 | Train Loss: 0.0912503 Vali Loss: 0.1624922 Test Loss: 0.1467876
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 43 cost time: 0.9790000915527344
Epoch: 43, Steps: 64 | Train Loss: 0.0907427 Vali Loss: 0.1619073 Test Loss: 0.1469725
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 44 cost time: 0.9716403484344482
Epoch: 44, Steps: 64 | Train Loss: 0.0906578 Vali Loss: 0.1612228 Test Loss: 0.1463327
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 45 cost time: 0.9835622310638428
Epoch: 45, Steps: 64 | Train Loss: 0.0909526 Vali Loss: 0.1608056 Test Loss: 0.1470805
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 46 cost time: 0.9644241333007812
Epoch: 46, Steps: 64 | Train Loss: 0.0907221 Vali Loss: 0.1629254 Test Loss: 0.1466750
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 47 cost time: 0.960505485534668
Epoch: 47, Steps: 64 | Train Loss: 0.0904443 Vali Loss: 0.1610117 Test Loss: 0.1468098
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 48 cost time: 0.9863622188568115
Epoch: 48, Steps: 64 | Train Loss: 0.0907050 Vali Loss: 0.1627260 Test Loss: 0.1473231
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 49 cost time: 0.9893748760223389
Epoch: 49, Steps: 64 | Train Loss: 0.0906817 Vali Loss: 0.1611522 Test Loss: 0.1464237
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 50 cost time: 0.986325740814209
Epoch: 50, Steps: 64 | Train Loss: 0.0907104 Vali Loss: 0.1616574 Test Loss: 0.1469436
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 51 cost time: 1.000521183013916
Epoch: 51, Steps: 64 | Train Loss: 0.0905025 Vali Loss: 0.1616246 Test Loss: 0.1464147
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 52 cost time: 1.0017943382263184
Epoch: 52, Steps: 64 | Train Loss: 0.0908793 Vali Loss: 0.1612715 Test Loss: 0.1464570
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 53 cost time: 0.9973208904266357
Epoch: 53, Steps: 64 | Train Loss: 0.0908719 Vali Loss: 0.1605493 Test Loss: 0.1475299
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 54 cost time: 0.9959995746612549
Epoch: 54, Steps: 64 | Train Loss: 0.0904411 Vali Loss: 0.1613707 Test Loss: 0.1462360
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 55 cost time: 0.991633415222168
Epoch: 55, Steps: 64 | Train Loss: 0.0908107 Vali Loss: 0.1588047 Test Loss: 0.1464284
Validation loss decreased (0.159949 --> 0.158805).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 56 cost time: 0.9936425685882568
Epoch: 56, Steps: 64 | Train Loss: 0.0907124 Vali Loss: 0.1615410 Test Loss: 0.1467087
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 57 cost time: 0.9378235340118408
Epoch: 57, Steps: 64 | Train Loss: 0.0909363 Vali Loss: 0.1612010 Test Loss: 0.1467439
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 58 cost time: 0.9464483261108398
Epoch: 58, Steps: 64 | Train Loss: 0.0903197 Vali Loss: 0.1598154 Test Loss: 0.1469045
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 59 cost time: 1.018653154373169
Epoch: 59, Steps: 64 | Train Loss: 0.0904542 Vali Loss: 0.1577378 Test Loss: 0.1471487
Validation loss decreased (0.158805 --> 0.157738).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017873764038085938 GB
GPU已分配内存的峰值：0.05049896240234375 GB
Epoch: 60 cost time: 1.0004117488861084
Epoch: 60, Steps: 64 | Train Loss: 0.0907805 Vali Loss: 0.1609264 Test Loss: 0.1468877
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1471487134695053, mae:0.28963524103164673, rse:0.20417341589927673
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04783916473388672 GB
Epoch: 1 cost time: 2.302184820175171
Epoch: 1, Steps: 64 | Train Loss: 1.1916000 Vali Loss: 2.4493740 Test Loss: 4.7491355
Validation loss decreased (inf --> 2.449374).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 2 cost time: 0.9420504570007324
Epoch: 2, Steps: 64 | Train Loss: 0.7175348 Vali Loss: 0.7246830 Test Loss: 1.0814936
Validation loss decreased (2.449374 --> 0.724683).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 3 cost time: 0.9400501251220703
Epoch: 3, Steps: 64 | Train Loss: 0.3244978 Vali Loss: 0.4579652 Test Loss: 0.5914231
Validation loss decreased (0.724683 --> 0.457965).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 4 cost time: 0.9345228672027588
Epoch: 4, Steps: 64 | Train Loss: 0.2322107 Vali Loss: 0.3526118 Test Loss: 0.4102775
Validation loss decreased (0.457965 --> 0.352612).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 5 cost time: 0.9128665924072266
Epoch: 5, Steps: 64 | Train Loss: 0.1921163 Vali Loss: 0.2933936 Test Loss: 0.3172293
Validation loss decreased (0.352612 --> 0.293394).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 6 cost time: 0.9104218482971191
Epoch: 6, Steps: 64 | Train Loss: 0.1704933 Vali Loss: 0.2604903 Test Loss: 0.2662170
Validation loss decreased (0.293394 --> 0.260490).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 7 cost time: 0.9229984283447266
Epoch: 7, Steps: 64 | Train Loss: 0.1567004 Vali Loss: 0.2361185 Test Loss: 0.2278590
Validation loss decreased (0.260490 --> 0.236118).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 8 cost time: 0.9136350154876709
Epoch: 8, Steps: 64 | Train Loss: 0.1477074 Vali Loss: 0.2159615 Test Loss: 0.2050041
Validation loss decreased (0.236118 --> 0.215961).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 9 cost time: 0.9374065399169922
Epoch: 9, Steps: 64 | Train Loss: 0.1411326 Vali Loss: 0.2026742 Test Loss: 0.1880201
Validation loss decreased (0.215961 --> 0.202674).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 10 cost time: 0.9473485946655273
Epoch: 10, Steps: 64 | Train Loss: 0.1364693 Vali Loss: 0.1921632 Test Loss: 0.1767976
Validation loss decreased (0.202674 --> 0.192163).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 11 cost time: 0.9594390392303467
Epoch: 11, Steps: 64 | Train Loss: 0.1320949 Vali Loss: 0.1901678 Test Loss: 0.1706398
Validation loss decreased (0.192163 --> 0.190168).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 12 cost time: 0.9654479026794434
Epoch: 12, Steps: 64 | Train Loss: 0.1303970 Vali Loss: 0.1862507 Test Loss: 0.1639601
Validation loss decreased (0.190168 --> 0.186251).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 13 cost time: 0.9513988494873047
Epoch: 13, Steps: 64 | Train Loss: 0.1267432 Vali Loss: 0.1829925 Test Loss: 0.1606334
Validation loss decreased (0.186251 --> 0.182993).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 14 cost time: 0.9382126331329346
Epoch: 14, Steps: 64 | Train Loss: 0.1260433 Vali Loss: 0.1794993 Test Loss: 0.1582302
Validation loss decreased (0.182993 --> 0.179499).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 15 cost time: 0.9340000152587891
Epoch: 15, Steps: 64 | Train Loss: 0.1242302 Vali Loss: 0.1777835 Test Loss: 0.1554311
Validation loss decreased (0.179499 --> 0.177784).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 16 cost time: 0.9446272850036621
Epoch: 16, Steps: 64 | Train Loss: 0.1232860 Vali Loss: 0.1753980 Test Loss: 0.1550207
Validation loss decreased (0.177784 --> 0.175398).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 17 cost time: 0.9406373500823975
Epoch: 17, Steps: 64 | Train Loss: 0.1220474 Vali Loss: 0.1772765 Test Loss: 0.1534292
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 18 cost time: 0.9588141441345215
Epoch: 18, Steps: 64 | Train Loss: 0.1211840 Vali Loss: 0.1720647 Test Loss: 0.1520532
Validation loss decreased (0.175398 --> 0.172065).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 19 cost time: 0.968379020690918
Epoch: 19, Steps: 64 | Train Loss: 0.1200619 Vali Loss: 0.1742216 Test Loss: 0.1519789
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 20 cost time: 0.9564111232757568
Epoch: 20, Steps: 64 | Train Loss: 0.1195607 Vali Loss: 0.1717102 Test Loss: 0.1509119
Validation loss decreased (0.172065 --> 0.171710).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 21 cost time: 0.9399740695953369
Epoch: 21, Steps: 64 | Train Loss: 0.1188467 Vali Loss: 0.1708973 Test Loss: 0.1494747
Validation loss decreased (0.171710 --> 0.170897).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 22 cost time: 0.9277503490447998
Epoch: 22, Steps: 64 | Train Loss: 0.1180732 Vali Loss: 0.1716460 Test Loss: 0.1500101
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 23 cost time: 0.9327917098999023
Epoch: 23, Steps: 64 | Train Loss: 0.1173292 Vali Loss: 0.1721227 Test Loss: 0.1490921
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 24 cost time: 0.9310259819030762
Epoch: 24, Steps: 64 | Train Loss: 0.1175344 Vali Loss: 0.1705463 Test Loss: 0.1486811
Validation loss decreased (0.170897 --> 0.170546).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 25 cost time: 0.926642894744873
Epoch: 25, Steps: 64 | Train Loss: 0.1169509 Vali Loss: 0.1705423 Test Loss: 0.1486484
Validation loss decreased (0.170546 --> 0.170542).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 26 cost time: 0.9405136108398438
Epoch: 26, Steps: 64 | Train Loss: 0.1166841 Vali Loss: 0.1714129 Test Loss: 0.1483674
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 27 cost time: 0.9462714195251465
Epoch: 27, Steps: 64 | Train Loss: 0.1162949 Vali Loss: 0.1689507 Test Loss: 0.1475665
Validation loss decreased (0.170542 --> 0.168951).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 28 cost time: 0.945397138595581
Epoch: 28, Steps: 64 | Train Loss: 0.1158739 Vali Loss: 0.1678300 Test Loss: 0.1474067
Validation loss decreased (0.168951 --> 0.167830).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 29 cost time: 0.9514415264129639
Epoch: 29, Steps: 64 | Train Loss: 0.1153393 Vali Loss: 0.1685282 Test Loss: 0.1472163
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 30 cost time: 0.9320120811462402
Epoch: 30, Steps: 64 | Train Loss: 0.1152543 Vali Loss: 0.1691783 Test Loss: 0.1481170
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 31 cost time: 0.9430341720581055
Epoch: 31, Steps: 64 | Train Loss: 0.1145784 Vali Loss: 0.1678286 Test Loss: 0.1478397
Validation loss decreased (0.167830 --> 0.167829).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 32 cost time: 0.9418652057647705
Epoch: 32, Steps: 64 | Train Loss: 0.1144465 Vali Loss: 0.1668689 Test Loss: 0.1473709
Validation loss decreased (0.167829 --> 0.166869).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 33 cost time: 0.9510006904602051
Epoch: 33, Steps: 64 | Train Loss: 0.1147476 Vali Loss: 0.1692990 Test Loss: 0.1470222
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 34 cost time: 0.9446437358856201
Epoch: 34, Steps: 64 | Train Loss: 0.1147611 Vali Loss: 0.1689043 Test Loss: 0.1474835
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 35 cost time: 0.9619677066802979
Epoch: 35, Steps: 64 | Train Loss: 0.1151539 Vali Loss: 0.1681982 Test Loss: 0.1472877
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 36 cost time: 0.969376802444458
Epoch: 36, Steps: 64 | Train Loss: 0.1141290 Vali Loss: 0.1695192 Test Loss: 0.1471396
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 37 cost time: 0.9584338665008545
Epoch: 37, Steps: 64 | Train Loss: 0.1139127 Vali Loss: 0.1660336 Test Loss: 0.1463093
Validation loss decreased (0.166869 --> 0.166034).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 38 cost time: 0.955430269241333
Epoch: 38, Steps: 64 | Train Loss: 0.1140319 Vali Loss: 0.1677824 Test Loss: 0.1464644
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 39 cost time: 0.9481854438781738
Epoch: 39, Steps: 64 | Train Loss: 0.1137275 Vali Loss: 0.1667315 Test Loss: 0.1465909
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 40 cost time: 0.9368469715118408
Epoch: 40, Steps: 64 | Train Loss: 0.1138566 Vali Loss: 0.1674946 Test Loss: 0.1456786
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 41 cost time: 0.9289999008178711
Epoch: 41, Steps: 64 | Train Loss: 0.1133517 Vali Loss: 0.1672231 Test Loss: 0.1464159
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 42 cost time: 0.9250023365020752
Epoch: 42, Steps: 64 | Train Loss: 0.1125615 Vali Loss: 0.1685016 Test Loss: 0.1462789
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 43 cost time: 0.9426267147064209
Epoch: 43, Steps: 64 | Train Loss: 0.1137183 Vali Loss: 0.1663905 Test Loss: 0.1466391
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 44 cost time: 0.9346094131469727
Epoch: 44, Steps: 64 | Train Loss: 0.1130686 Vali Loss: 0.1685588 Test Loss: 0.1458971
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 45 cost time: 0.9343376159667969
Epoch: 45, Steps: 64 | Train Loss: 0.1136469 Vali Loss: 0.1669911 Test Loss: 0.1464280
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 46 cost time: 0.95237135887146
Epoch: 46, Steps: 64 | Train Loss: 0.1133104 Vali Loss: 0.1679288 Test Loss: 0.1468027
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 47 cost time: 0.936363935470581
Epoch: 47, Steps: 64 | Train Loss: 0.1135230 Vali Loss: 0.1659901 Test Loss: 0.1460347
Validation loss decreased (0.166034 --> 0.165990).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 48 cost time: 0.9301416873931885
Epoch: 48, Steps: 64 | Train Loss: 0.1133884 Vali Loss: 0.1654675 Test Loss: 0.1460785
Validation loss decreased (0.165990 --> 0.165467).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 49 cost time: 0.9189996719360352
Epoch: 49, Steps: 64 | Train Loss: 0.1133855 Vali Loss: 0.1670492 Test Loss: 0.1462739
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 50 cost time: 0.9379982948303223
Epoch: 50, Steps: 64 | Train Loss: 0.1131065 Vali Loss: 0.1691723 Test Loss: 0.1461623
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 51 cost time: 0.9506316184997559
Epoch: 51, Steps: 64 | Train Loss: 0.1131345 Vali Loss: 0.1664274 Test Loss: 0.1459226
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 52 cost time: 0.963019609451294
Epoch: 52, Steps: 64 | Train Loss: 0.1127275 Vali Loss: 0.1660235 Test Loss: 0.1457835
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 53 cost time: 0.9354043006896973
Epoch: 53, Steps: 64 | Train Loss: 0.1131943 Vali Loss: 0.1667536 Test Loss: 0.1461513
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 54 cost time: 0.958409309387207
Epoch: 54, Steps: 64 | Train Loss: 0.1132194 Vali Loss: 0.1655120 Test Loss: 0.1458849
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 55 cost time: 0.9584996700286865
Epoch: 55, Steps: 64 | Train Loss: 0.1127881 Vali Loss: 0.1655476 Test Loss: 0.1459433
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 56 cost time: 0.9444057941436768
Epoch: 56, Steps: 64 | Train Loss: 0.1127521 Vali Loss: 0.1652026 Test Loss: 0.1463407
Validation loss decreased (0.165467 --> 0.165203).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 57 cost time: 0.944063663482666
Epoch: 57, Steps: 64 | Train Loss: 0.1132580 Vali Loss: 0.1676597 Test Loss: 0.1459618
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 58 cost time: 0.9674551486968994
Epoch: 58, Steps: 64 | Train Loss: 0.1129710 Vali Loss: 0.1677510 Test Loss: 0.1462804
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 59 cost time: 0.9606146812438965
Epoch: 59, Steps: 64 | Train Loss: 0.1131868 Vali Loss: 0.1682600 Test Loss: 0.1462435
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01781463623046875 GB
GPU已分配内存的峰值：0.04914999008178711 GB
Epoch: 60 cost time: 0.9633951187133789
Epoch: 60, Steps: 64 | Train Loss: 0.1130259 Vali Loss: 0.1637605 Test Loss: 0.1462948
Validation loss decreased (0.165203 --> 0.163760).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14629481732845306, mae:0.28282734751701355, rse:0.20358015596866608
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.048540592193603516 GB
Epoch: 1 cost time: 2.3595478534698486
Epoch: 1, Steps: 64 | Train Loss: 0.8400983 Vali Loss: 1.8952519 Test Loss: 3.6316311
Validation loss decreased (inf --> 1.895252).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 2 cost time: 0.9636282920837402
Epoch: 2, Steps: 64 | Train Loss: 0.6234394 Vali Loss: 0.9528846 Test Loss: 1.6479294
Validation loss decreased (1.895252 --> 0.952885).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 3 cost time: 0.9726405143737793
Epoch: 3, Steps: 64 | Train Loss: 0.3381728 Vali Loss: 0.5485435 Test Loss: 0.8244261
Validation loss decreased (0.952885 --> 0.548543).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 4 cost time: 0.9655818939208984
Epoch: 4, Steps: 64 | Train Loss: 0.2051820 Vali Loss: 0.3567646 Test Loss: 0.4398496
Validation loss decreased (0.548543 --> 0.356765).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 5 cost time: 0.9433414936065674
Epoch: 5, Steps: 64 | Train Loss: 0.1464026 Vali Loss: 0.2643652 Test Loss: 0.2754402
Validation loss decreased (0.356765 --> 0.264365).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 6 cost time: 0.9473989009857178
Epoch: 6, Steps: 64 | Train Loss: 0.1244809 Vali Loss: 0.2216430 Test Loss: 0.2096791
Validation loss decreased (0.264365 --> 0.221643).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 7 cost time: 0.9439537525177002
Epoch: 7, Steps: 64 | Train Loss: 0.1157325 Vali Loss: 0.1963511 Test Loss: 0.1818547
Validation loss decreased (0.221643 --> 0.196351).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 8 cost time: 0.9373698234558105
Epoch: 8, Steps: 64 | Train Loss: 0.1111327 Vali Loss: 0.1877244 Test Loss: 0.1710975
Validation loss decreased (0.196351 --> 0.187724).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 9 cost time: 0.9635512828826904
Epoch: 9, Steps: 64 | Train Loss: 0.1087714 Vali Loss: 0.1846194 Test Loss: 0.1660953
Validation loss decreased (0.187724 --> 0.184619).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 10 cost time: 0.9758298397064209
Epoch: 10, Steps: 64 | Train Loss: 0.1065220 Vali Loss: 0.1814438 Test Loss: 0.1617218
Validation loss decreased (0.184619 --> 0.181444).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 11 cost time: 0.9800009727478027
Epoch: 11, Steps: 64 | Train Loss: 0.1046591 Vali Loss: 0.1775744 Test Loss: 0.1584414
Validation loss decreased (0.181444 --> 0.177574).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 12 cost time: 0.985999584197998
Epoch: 12, Steps: 64 | Train Loss: 0.1034625 Vali Loss: 0.1726479 Test Loss: 0.1556804
Validation loss decreased (0.177574 --> 0.172648).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 13 cost time: 0.9700310230255127
Epoch: 13, Steps: 64 | Train Loss: 0.1018643 Vali Loss: 0.1713175 Test Loss: 0.1545464
Validation loss decreased (0.172648 --> 0.171318).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 14 cost time: 0.9656281471252441
Epoch: 14, Steps: 64 | Train Loss: 0.1013207 Vali Loss: 0.1711284 Test Loss: 0.1525975
Validation loss decreased (0.171318 --> 0.171128).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 15 cost time: 0.967050313949585
Epoch: 15, Steps: 64 | Train Loss: 0.0998714 Vali Loss: 0.1685012 Test Loss: 0.1515301
Validation loss decreased (0.171128 --> 0.168501).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 16 cost time: 0.9674277305603027
Epoch: 16, Steps: 64 | Train Loss: 0.0998449 Vali Loss: 0.1680583 Test Loss: 0.1518083
Validation loss decreased (0.168501 --> 0.168058).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 17 cost time: 0.9739937782287598
Epoch: 17, Steps: 64 | Train Loss: 0.0990830 Vali Loss: 0.1684834 Test Loss: 0.1507436
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 18 cost time: 0.9864249229431152
Epoch: 18, Steps: 64 | Train Loss: 0.0977479 Vali Loss: 0.1639713 Test Loss: 0.1499522
Validation loss decreased (0.168058 --> 0.163971).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 19 cost time: 0.980116605758667
Epoch: 19, Steps: 64 | Train Loss: 0.0977745 Vali Loss: 0.1663814 Test Loss: 0.1495686
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 20 cost time: 0.9824728965759277
Epoch: 20, Steps: 64 | Train Loss: 0.0973940 Vali Loss: 0.1654799 Test Loss: 0.1503883
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 21 cost time: 0.9807586669921875
Epoch: 21, Steps: 64 | Train Loss: 0.0968186 Vali Loss: 0.1659906 Test Loss: 0.1495335
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 22 cost time: 0.9837601184844971
Epoch: 22, Steps: 64 | Train Loss: 0.0963566 Vali Loss: 0.1655382 Test Loss: 0.1498088
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 23 cost time: 0.9480006694793701
Epoch: 23, Steps: 64 | Train Loss: 0.0965329 Vali Loss: 0.1652250 Test Loss: 0.1492893
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 24 cost time: 0.9486351013183594
Epoch: 24, Steps: 64 | Train Loss: 0.0964524 Vali Loss: 0.1640157 Test Loss: 0.1485364
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 25 cost time: 0.9503827095031738
Epoch: 25, Steps: 64 | Train Loss: 0.0955133 Vali Loss: 0.1649083 Test Loss: 0.1489179
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 26 cost time: 0.947331428527832
Epoch: 26, Steps: 64 | Train Loss: 0.0954400 Vali Loss: 0.1633909 Test Loss: 0.1494439
Validation loss decreased (0.163971 --> 0.163391).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 27 cost time: 0.9304237365722656
Epoch: 27, Steps: 64 | Train Loss: 0.0957805 Vali Loss: 0.1638956 Test Loss: 0.1479387
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 28 cost time: 0.9633891582489014
Epoch: 28, Steps: 64 | Train Loss: 0.0950881 Vali Loss: 0.1623883 Test Loss: 0.1490082
Validation loss decreased (0.163391 --> 0.162388).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 29 cost time: 0.9693746566772461
Epoch: 29, Steps: 64 | Train Loss: 0.0950771 Vali Loss: 0.1622682 Test Loss: 0.1484133
Validation loss decreased (0.162388 --> 0.162268).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 30 cost time: 0.9611690044403076
Epoch: 30, Steps: 64 | Train Loss: 0.0951017 Vali Loss: 0.1627408 Test Loss: 0.1485674
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 31 cost time: 0.9627432823181152
Epoch: 31, Steps: 64 | Train Loss: 0.0945433 Vali Loss: 0.1612815 Test Loss: 0.1477324
Validation loss decreased (0.162268 --> 0.161281).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 32 cost time: 0.9600009918212891
Epoch: 32, Steps: 64 | Train Loss: 0.0944444 Vali Loss: 0.1619404 Test Loss: 0.1477085
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 33 cost time: 0.9696393013000488
Epoch: 33, Steps: 64 | Train Loss: 0.0948342 Vali Loss: 0.1611487 Test Loss: 0.1475943
Validation loss decreased (0.161281 --> 0.161149).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 34 cost time: 0.9782350063323975
Epoch: 34, Steps: 64 | Train Loss: 0.0947112 Vali Loss: 0.1615459 Test Loss: 0.1482130
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 35 cost time: 0.9884774684906006
Epoch: 35, Steps: 64 | Train Loss: 0.0943954 Vali Loss: 0.1634536 Test Loss: 0.1494292
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 36 cost time: 0.9993634223937988
Epoch: 36, Steps: 64 | Train Loss: 0.0945659 Vali Loss: 0.1601223 Test Loss: 0.1481819
Validation loss decreased (0.161149 --> 0.160122).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 37 cost time: 0.9833803176879883
Epoch: 37, Steps: 64 | Train Loss: 0.0939164 Vali Loss: 0.1616427 Test Loss: 0.1485719
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 38 cost time: 0.9759821891784668
Epoch: 38, Steps: 64 | Train Loss: 0.0940215 Vali Loss: 0.1605794 Test Loss: 0.1482370
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 39 cost time: 0.9538626670837402
Epoch: 39, Steps: 64 | Train Loss: 0.0945216 Vali Loss: 0.1609972 Test Loss: 0.1480885
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 40 cost time: 0.9254579544067383
Epoch: 40, Steps: 64 | Train Loss: 0.0938774 Vali Loss: 0.1608859 Test Loss: 0.1475973
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 41 cost time: 0.9337384700775146
Epoch: 41, Steps: 64 | Train Loss: 0.0940404 Vali Loss: 0.1624391 Test Loss: 0.1479274
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 42 cost time: 0.9383692741394043
Epoch: 42, Steps: 64 | Train Loss: 0.0938956 Vali Loss: 0.1612479 Test Loss: 0.1475984
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 43 cost time: 0.9686429500579834
Epoch: 43, Steps: 64 | Train Loss: 0.0941591 Vali Loss: 0.1612764 Test Loss: 0.1471160
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 44 cost time: 0.9714515209197998
Epoch: 44, Steps: 64 | Train Loss: 0.0937756 Vali Loss: 0.1608239 Test Loss: 0.1477915
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 45 cost time: 0.9722037315368652
Epoch: 45, Steps: 64 | Train Loss: 0.0942341 Vali Loss: 0.1606597 Test Loss: 0.1481790
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 46 cost time: 0.9750676155090332
Epoch: 46, Steps: 64 | Train Loss: 0.0937574 Vali Loss: 0.1606975 Test Loss: 0.1482794
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 47 cost time: 0.9404335021972656
Epoch: 47, Steps: 64 | Train Loss: 0.0939539 Vali Loss: 0.1621135 Test Loss: 0.1481073
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 48 cost time: 0.9313530921936035
Epoch: 48, Steps: 64 | Train Loss: 0.0936211 Vali Loss: 0.1612521 Test Loss: 0.1477055
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 49 cost time: 0.9693734645843506
Epoch: 49, Steps: 64 | Train Loss: 0.0938345 Vali Loss: 0.1607561 Test Loss: 0.1477840
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 50 cost time: 0.9617776870727539
Epoch: 50, Steps: 64 | Train Loss: 0.0936070 Vali Loss: 0.1587756 Test Loss: 0.1475187
Validation loss decreased (0.160122 --> 0.158776).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 51 cost time: 0.9894418716430664
Epoch: 51, Steps: 64 | Train Loss: 0.0933950 Vali Loss: 0.1615672 Test Loss: 0.1475104
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 52 cost time: 0.9829990863800049
Epoch: 52, Steps: 64 | Train Loss: 0.0941358 Vali Loss: 0.1598824 Test Loss: 0.1476071
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 53 cost time: 0.9896223545074463
Epoch: 53, Steps: 64 | Train Loss: 0.0935001 Vali Loss: 0.1596772 Test Loss: 0.1475396
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 54 cost time: 0.9869964122772217
Epoch: 54, Steps: 64 | Train Loss: 0.0933209 Vali Loss: 0.1613564 Test Loss: 0.1479748
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 55 cost time: 0.9784965515136719
Epoch: 55, Steps: 64 | Train Loss: 0.0937190 Vali Loss: 0.1607685 Test Loss: 0.1475235
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 56 cost time: 0.9797608852386475
Epoch: 56, Steps: 64 | Train Loss: 0.0935750 Vali Loss: 0.1602786 Test Loss: 0.1480343
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 57 cost time: 0.9603660106658936
Epoch: 57, Steps: 64 | Train Loss: 0.0937004 Vali Loss: 0.1603438 Test Loss: 0.1470446
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 58 cost time: 0.9453732967376709
Epoch: 58, Steps: 64 | Train Loss: 0.0934938 Vali Loss: 0.1594022 Test Loss: 0.1475200
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 59 cost time: 0.9554424285888672
Epoch: 59, Steps: 64 | Train Loss: 0.0933658 Vali Loss: 0.1605913 Test Loss: 0.1480675
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017852783203125 GB
GPU已分配内存的峰值：0.0499110221862793 GB
Epoch: 60 cost time: 0.9737873077392578
Epoch: 60, Steps: 64 | Train Loss: 0.0934889 Vali Loss: 0.1602453 Test Loss: 0.1472337
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14751870930194855, mae:0.2888827621936798, rse:0.20442993938922882
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.04910469055175781 GB
Epoch: 1 cost time: 2.3691203594207764
Epoch: 1, Steps: 64 | Train Loss: 0.8137606 Vali Loss: 1.9088370 Test Loss: 3.6338189
Validation loss decreased (inf --> 1.908837).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 2 cost time: 1.018035888671875
Epoch: 2, Steps: 64 | Train Loss: 0.6773372 Vali Loss: 1.2808650 Test Loss: 2.3030813
Validation loss decreased (1.908837 --> 1.280865).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 3 cost time: 0.990788459777832
Epoch: 3, Steps: 64 | Train Loss: 0.4407584 Vali Loss: 0.7268395 Test Loss: 1.1886714
Validation loss decreased (1.280865 --> 0.726840).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 4 cost time: 1.0034666061401367
Epoch: 4, Steps: 64 | Train Loss: 0.2479759 Vali Loss: 0.3871935 Test Loss: 0.5211122
Validation loss decreased (0.726840 --> 0.387194).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 5 cost time: 1.0128135681152344
Epoch: 5, Steps: 64 | Train Loss: 0.1475129 Vali Loss: 0.2347007 Test Loss: 0.2481535
Validation loss decreased (0.387194 --> 0.234701).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 6 cost time: 0.9478390216827393
Epoch: 6, Steps: 64 | Train Loss: 0.1159881 Vali Loss: 0.1919172 Test Loss: 0.1764855
Validation loss decreased (0.234701 --> 0.191917).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 7 cost time: 0.9644360542297363
Epoch: 7, Steps: 64 | Train Loss: 0.1082335 Vali Loss: 0.1811507 Test Loss: 0.1627779
Validation loss decreased (0.191917 --> 0.181151).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 8 cost time: 0.9486134052276611
Epoch: 8, Steps: 64 | Train Loss: 0.1044409 Vali Loss: 0.1771748 Test Loss: 0.1605536
Validation loss decreased (0.181151 --> 0.177175).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 9 cost time: 0.9916508197784424
Epoch: 9, Steps: 64 | Train Loss: 0.1017218 Vali Loss: 0.1749910 Test Loss: 0.1598783
Validation loss decreased (0.177175 --> 0.174991).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 10 cost time: 1.0047636032104492
Epoch: 10, Steps: 64 | Train Loss: 0.1001881 Vali Loss: 0.1728407 Test Loss: 0.1576412
Validation loss decreased (0.174991 --> 0.172841).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 11 cost time: 1.0154104232788086
Epoch: 11, Steps: 64 | Train Loss: 0.0985581 Vali Loss: 0.1714711 Test Loss: 0.1592789
Validation loss decreased (0.172841 --> 0.171471).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 12 cost time: 1.0194694995880127
Epoch: 12, Steps: 64 | Train Loss: 0.0981682 Vali Loss: 0.1704796 Test Loss: 0.1568043
Validation loss decreased (0.171471 --> 0.170480).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 13 cost time: 1.0013997554779053
Epoch: 13, Steps: 64 | Train Loss: 0.0963169 Vali Loss: 0.1690957 Test Loss: 0.1567342
Validation loss decreased (0.170480 --> 0.169096).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 14 cost time: 0.9966425895690918
Epoch: 14, Steps: 64 | Train Loss: 0.0956980 Vali Loss: 0.1677618 Test Loss: 0.1582939
Validation loss decreased (0.169096 --> 0.167762).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 15 cost time: 1.0102319717407227
Epoch: 15, Steps: 64 | Train Loss: 0.0951206 Vali Loss: 0.1704440 Test Loss: 0.1577677
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 16 cost time: 0.9924166202545166
Epoch: 16, Steps: 64 | Train Loss: 0.0944142 Vali Loss: 0.1683792 Test Loss: 0.1585720
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 17 cost time: 1.002387285232544
Epoch: 17, Steps: 64 | Train Loss: 0.0940644 Vali Loss: 0.1695578 Test Loss: 0.1593209
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 18 cost time: 1.023392677307129
Epoch: 18, Steps: 64 | Train Loss: 0.0939352 Vali Loss: 0.1696251 Test Loss: 0.1585588
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 19 cost time: 0.9994280338287354
Epoch: 19, Steps: 64 | Train Loss: 0.0931412 Vali Loss: 0.1678644 Test Loss: 0.1592514
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 20 cost time: 0.9828050136566162
Epoch: 20, Steps: 64 | Train Loss: 0.0929021 Vali Loss: 0.1671986 Test Loss: 0.1609134
Validation loss decreased (0.167762 --> 0.167199).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 21 cost time: 0.9655153751373291
Epoch: 21, Steps: 64 | Train Loss: 0.0922641 Vali Loss: 0.1683964 Test Loss: 0.1604044
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 22 cost time: 0.9626507759094238
Epoch: 22, Steps: 64 | Train Loss: 0.0920238 Vali Loss: 0.1659396 Test Loss: 0.1607981
Validation loss decreased (0.167199 --> 0.165940).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 23 cost time: 0.9636409282684326
Epoch: 23, Steps: 64 | Train Loss: 0.0921064 Vali Loss: 0.1655169 Test Loss: 0.1602170
Validation loss decreased (0.165940 --> 0.165517).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 24 cost time: 0.9543802738189697
Epoch: 24, Steps: 64 | Train Loss: 0.0918315 Vali Loss: 0.1664489 Test Loss: 0.1601438
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 25 cost time: 0.9814784526824951
Epoch: 25, Steps: 64 | Train Loss: 0.0916116 Vali Loss: 0.1669608 Test Loss: 0.1605049
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 26 cost time: 0.9843735694885254
Epoch: 26, Steps: 64 | Train Loss: 0.0913838 Vali Loss: 0.1677255 Test Loss: 0.1604082
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 27 cost time: 1.0056216716766357
Epoch: 27, Steps: 64 | Train Loss: 0.0918106 Vali Loss: 0.1665180 Test Loss: 0.1608233
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 28 cost time: 1.0074429512023926
Epoch: 28, Steps: 64 | Train Loss: 0.0913721 Vali Loss: 0.1677238 Test Loss: 0.1619851
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 29 cost time: 1.0044937133789062
Epoch: 29, Steps: 64 | Train Loss: 0.0913763 Vali Loss: 0.1678055 Test Loss: 0.1611958
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 30 cost time: 0.9965252876281738
Epoch: 30, Steps: 64 | Train Loss: 0.0912348 Vali Loss: 0.1684834 Test Loss: 0.1624592
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 31 cost time: 1.005859375
Epoch: 31, Steps: 64 | Train Loss: 0.0911371 Vali Loss: 0.1667462 Test Loss: 0.1626666
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 32 cost time: 0.9884562492370605
Epoch: 32, Steps: 64 | Train Loss: 0.0908467 Vali Loss: 0.1663753 Test Loss: 0.1621136
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 33 cost time: 0.9960002899169922
Epoch: 33, Steps: 64 | Train Loss: 0.0910704 Vali Loss: 0.1676701 Test Loss: 0.1611895
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 34 cost time: 1.0080077648162842
Epoch: 34, Steps: 64 | Train Loss: 0.0905234 Vali Loss: 0.1675171 Test Loss: 0.1624473
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 35 cost time: 1.0196309089660645
Epoch: 35, Steps: 64 | Train Loss: 0.0903600 Vali Loss: 0.1658983 Test Loss: 0.1619692
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 36 cost time: 1.001072645187378
Epoch: 36, Steps: 64 | Train Loss: 0.0906055 Vali Loss: 0.1686526 Test Loss: 0.1617265
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 37 cost time: 1.0123369693756104
Epoch: 37, Steps: 64 | Train Loss: 0.0901903 Vali Loss: 0.1664890 Test Loss: 0.1616144
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 38 cost time: 0.9833712577819824
Epoch: 38, Steps: 64 | Train Loss: 0.0903753 Vali Loss: 0.1671880 Test Loss: 0.1611649
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 39 cost time: 0.9532907009124756
Epoch: 39, Steps: 64 | Train Loss: 0.0905550 Vali Loss: 0.1673143 Test Loss: 0.1622900
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 40 cost time: 0.9579672813415527
Epoch: 40, Steps: 64 | Train Loss: 0.0904460 Vali Loss: 0.1665555 Test Loss: 0.1614094
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 41 cost time: 0.9504544734954834
Epoch: 41, Steps: 64 | Train Loss: 0.0902073 Vali Loss: 0.1669255 Test Loss: 0.1615689
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 42 cost time: 0.983403205871582
Epoch: 42, Steps: 64 | Train Loss: 0.0901621 Vali Loss: 0.1660203 Test Loss: 0.1629285
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 43 cost time: 0.9847550392150879
Epoch: 43, Steps: 64 | Train Loss: 0.0906383 Vali Loss: 0.1680459 Test Loss: 0.1625822
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 44 cost time: 1.017754077911377
Epoch: 44, Steps: 64 | Train Loss: 0.0904319 Vali Loss: 0.1667313 Test Loss: 0.1622002
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 45 cost time: 0.9896032810211182
Epoch: 45, Steps: 64 | Train Loss: 0.0902538 Vali Loss: 0.1670119 Test Loss: 0.1614598
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 46 cost time: 0.9684154987335205
Epoch: 46, Steps: 64 | Train Loss: 0.0896063 Vali Loss: 0.1659450 Test Loss: 0.1629318
EarlyStopping counter: 23 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 47 cost time: 1.0066263675689697
Epoch: 47, Steps: 64 | Train Loss: 0.0900674 Vali Loss: 0.1672904 Test Loss: 0.1631680
EarlyStopping counter: 24 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 48 cost time: 0.9926409721374512
Epoch: 48, Steps: 64 | Train Loss: 0.0903492 Vali Loss: 0.1672590 Test Loss: 0.1626178
EarlyStopping counter: 25 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 49 cost time: 0.9896175861358643
Epoch: 49, Steps: 64 | Train Loss: 0.0897996 Vali Loss: 0.1670135 Test Loss: 0.1617369
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 50 cost time: 1.009357213973999
Epoch: 50, Steps: 64 | Train Loss: 0.0903480 Vali Loss: 0.1666969 Test Loss: 0.1624718
EarlyStopping counter: 27 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 51 cost time: 1.0186855792999268
Epoch: 51, Steps: 64 | Train Loss: 0.0900222 Vali Loss: 0.1664524 Test Loss: 0.1619820
EarlyStopping counter: 28 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 52 cost time: 1.0023784637451172
Epoch: 52, Steps: 64 | Train Loss: 0.0899932 Vali Loss: 0.1668021 Test Loss: 0.1620756
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 53 cost time: 1.0150070190429688
Epoch: 53, Steps: 64 | Train Loss: 0.0904361 Vali Loss: 0.1663543 Test Loss: 0.1620867
EarlyStopping counter: 30 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 54 cost time: 1.0196521282196045
Epoch: 54, Steps: 64 | Train Loss: 0.0894554 Vali Loss: 0.1669813 Test Loss: 0.1629078
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 55 cost time: 0.9894561767578125
Epoch: 55, Steps: 64 | Train Loss: 0.0901354 Vali Loss: 0.1675547 Test Loss: 0.1632532
EarlyStopping counter: 32 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 56 cost time: 0.995455265045166
Epoch: 56, Steps: 64 | Train Loss: 0.0895911 Vali Loss: 0.1663130 Test Loss: 0.1615612
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 57 cost time: 0.9624571800231934
Epoch: 57, Steps: 64 | Train Loss: 0.0902581 Vali Loss: 0.1673033 Test Loss: 0.1625647
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 58 cost time: 0.9830014705657959
Epoch: 58, Steps: 64 | Train Loss: 0.0900257 Vali Loss: 0.1680319 Test Loss: 0.1627035
EarlyStopping counter: 35 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 59 cost time: 0.9955258369445801
Epoch: 59, Steps: 64 | Train Loss: 0.0897618 Vali Loss: 0.1669075 Test Loss: 0.1624108
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01787567138671875 GB
GPU已分配内存的峰值：0.05066061019897461 GB
Epoch: 60 cost time: 0.9866471290588379
Epoch: 60, Steps: 64 | Train Loss: 0.0901410 Vali Loss: 0.1679154 Test Loss: 0.1630451
EarlyStopping counter: 37 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.16021697223186493, mae:0.31092509627342224, rse:0.21304689347743988
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.048000335693359375 GB
Epoch: 1 cost time: 2.3498618602752686
Epoch: 1, Steps: 64 | Train Loss: 0.9589707 Vali Loss: 1.8705690 Test Loss: 3.5789461
Validation loss decreased (inf --> 1.870569).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 2 cost time: 0.9534327983856201
Epoch: 2, Steps: 64 | Train Loss: 0.5427525 Vali Loss: 0.5955775 Test Loss: 0.8863376
Validation loss decreased (1.870569 --> 0.595578).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 3 cost time: 0.9470000267028809
Epoch: 3, Steps: 64 | Train Loss: 0.2976590 Vali Loss: 0.4767460 Test Loss: 0.6444134
Validation loss decreased (0.595578 --> 0.476746).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 4 cost time: 0.9436259269714355
Epoch: 4, Steps: 64 | Train Loss: 0.2297643 Vali Loss: 0.3939569 Test Loss: 0.4828481
Validation loss decreased (0.476746 --> 0.393957).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 5 cost time: 0.9187617301940918
Epoch: 5, Steps: 64 | Train Loss: 0.1927073 Vali Loss: 0.3329895 Test Loss: 0.3736714
Validation loss decreased (0.393957 --> 0.332989).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 6 cost time: 0.914374828338623
Epoch: 6, Steps: 64 | Train Loss: 0.1707150 Vali Loss: 0.2936822 Test Loss: 0.3123852
Validation loss decreased (0.332989 --> 0.293682).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 7 cost time: 0.9291229248046875
Epoch: 7, Steps: 64 | Train Loss: 0.1562654 Vali Loss: 0.2649024 Test Loss: 0.2667832
Validation loss decreased (0.293682 --> 0.264902).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 8 cost time: 0.915412425994873
Epoch: 8, Steps: 64 | Train Loss: 0.1459538 Vali Loss: 0.2435581 Test Loss: 0.2361215
Validation loss decreased (0.264902 --> 0.243558).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 9 cost time: 0.9474377632141113
Epoch: 9, Steps: 64 | Train Loss: 0.1382635 Vali Loss: 0.2309317 Test Loss: 0.2162902
Validation loss decreased (0.243558 --> 0.230932).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 10 cost time: 0.9528446197509766
Epoch: 10, Steps: 64 | Train Loss: 0.1336350 Vali Loss: 0.2141614 Test Loss: 0.1989336
Validation loss decreased (0.230932 --> 0.214161).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 11 cost time: 0.9669983386993408
Epoch: 11, Steps: 64 | Train Loss: 0.1298676 Vali Loss: 0.2048890 Test Loss: 0.1885647
Validation loss decreased (0.214161 --> 0.204889).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 12 cost time: 0.9710006713867188
Epoch: 12, Steps: 64 | Train Loss: 0.1267268 Vali Loss: 0.1991572 Test Loss: 0.1804187
Validation loss decreased (0.204889 --> 0.199157).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 13 cost time: 0.9640498161315918
Epoch: 13, Steps: 64 | Train Loss: 0.1245626 Vali Loss: 0.1968738 Test Loss: 0.1760799
Validation loss decreased (0.199157 --> 0.196874).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 14 cost time: 0.9294314384460449
Epoch: 14, Steps: 64 | Train Loss: 0.1227336 Vali Loss: 0.1894506 Test Loss: 0.1702281
Validation loss decreased (0.196874 --> 0.189451).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 15 cost time: 0.9503612518310547
Epoch: 15, Steps: 64 | Train Loss: 0.1207902 Vali Loss: 0.1896733 Test Loss: 0.1671976
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 16 cost time: 0.9473719596862793
Epoch: 16, Steps: 64 | Train Loss: 0.1190691 Vali Loss: 0.1834766 Test Loss: 0.1645780
Validation loss decreased (0.189451 --> 0.183477).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 17 cost time: 0.9361259937286377
Epoch: 17, Steps: 64 | Train Loss: 0.1184832 Vali Loss: 0.1830001 Test Loss: 0.1606988
Validation loss decreased (0.183477 --> 0.183000).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 18 cost time: 0.9693667888641357
Epoch: 18, Steps: 64 | Train Loss: 0.1174163 Vali Loss: 0.1834000 Test Loss: 0.1622369
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 19 cost time: 0.9748096466064453
Epoch: 19, Steps: 64 | Train Loss: 0.1162980 Vali Loss: 0.1785030 Test Loss: 0.1585485
Validation loss decreased (0.183000 --> 0.178503).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 20 cost time: 0.9857676029205322
Epoch: 20, Steps: 64 | Train Loss: 0.1152207 Vali Loss: 0.1800822 Test Loss: 0.1582100
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 21 cost time: 0.9687414169311523
Epoch: 21, Steps: 64 | Train Loss: 0.1151238 Vali Loss: 0.1753556 Test Loss: 0.1555886
Validation loss decreased (0.178503 --> 0.175356).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 22 cost time: 0.9630000591278076
Epoch: 22, Steps: 64 | Train Loss: 0.1140305 Vali Loss: 0.1770668 Test Loss: 0.1558066
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 23 cost time: 0.9566230773925781
Epoch: 23, Steps: 64 | Train Loss: 0.1134614 Vali Loss: 0.1764139 Test Loss: 0.1554229
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 24 cost time: 0.9232842922210693
Epoch: 24, Steps: 64 | Train Loss: 0.1132305 Vali Loss: 0.1743042 Test Loss: 0.1535367
Validation loss decreased (0.175356 --> 0.174304).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 25 cost time: 0.929018497467041
Epoch: 25, Steps: 64 | Train Loss: 0.1121918 Vali Loss: 0.1733094 Test Loss: 0.1541376
Validation loss decreased (0.174304 --> 0.173309).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 26 cost time: 0.93406081199646
Epoch: 26, Steps: 64 | Train Loss: 0.1121239 Vali Loss: 0.1727066 Test Loss: 0.1531622
Validation loss decreased (0.173309 --> 0.172707).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 27 cost time: 0.9544453620910645
Epoch: 27, Steps: 64 | Train Loss: 0.1115124 Vali Loss: 0.1732389 Test Loss: 0.1527552
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 28 cost time: 0.9424741268157959
Epoch: 28, Steps: 64 | Train Loss: 0.1115546 Vali Loss: 0.1738557 Test Loss: 0.1534055
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 29 cost time: 0.9417645931243896
Epoch: 29, Steps: 64 | Train Loss: 0.1111237 Vali Loss: 0.1725433 Test Loss: 0.1518661
Validation loss decreased (0.172707 --> 0.172543).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 30 cost time: 0.9664211273193359
Epoch: 30, Steps: 64 | Train Loss: 0.1111902 Vali Loss: 0.1728003 Test Loss: 0.1521451
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 31 cost time: 0.9679994583129883
Epoch: 31, Steps: 64 | Train Loss: 0.1108696 Vali Loss: 0.1731304 Test Loss: 0.1518544
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 32 cost time: 0.9586446285247803
Epoch: 32, Steps: 64 | Train Loss: 0.1102959 Vali Loss: 0.1703251 Test Loss: 0.1503354
Validation loss decreased (0.172543 --> 0.170325).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 33 cost time: 0.9503867626190186
Epoch: 33, Steps: 64 | Train Loss: 0.1102695 Vali Loss: 0.1720053 Test Loss: 0.1512839
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 34 cost time: 0.9614078998565674
Epoch: 34, Steps: 64 | Train Loss: 0.1105756 Vali Loss: 0.1707265 Test Loss: 0.1520304
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 35 cost time: 0.9750335216522217
Epoch: 35, Steps: 64 | Train Loss: 0.1100721 Vali Loss: 0.1710461 Test Loss: 0.1516108
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 36 cost time: 0.9834105968475342
Epoch: 36, Steps: 64 | Train Loss: 0.1093703 Vali Loss: 0.1708960 Test Loss: 0.1508091
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 37 cost time: 0.9794042110443115
Epoch: 37, Steps: 64 | Train Loss: 0.1097477 Vali Loss: 0.1697144 Test Loss: 0.1506897
Validation loss decreased (0.170325 --> 0.169714).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 38 cost time: 0.9708101749420166
Epoch: 38, Steps: 64 | Train Loss: 0.1098998 Vali Loss: 0.1693838 Test Loss: 0.1506828
Validation loss decreased (0.169714 --> 0.169384).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 39 cost time: 0.9494457244873047
Epoch: 39, Steps: 64 | Train Loss: 0.1091628 Vali Loss: 0.1679044 Test Loss: 0.1506730
Validation loss decreased (0.169384 --> 0.167904).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 40 cost time: 0.9290006160736084
Epoch: 40, Steps: 64 | Train Loss: 0.1099380 Vali Loss: 0.1695615 Test Loss: 0.1506517
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 41 cost time: 0.9136044979095459
Epoch: 41, Steps: 64 | Train Loss: 0.1095657 Vali Loss: 0.1676108 Test Loss: 0.1500660
Validation loss decreased (0.167904 --> 0.167611).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 42 cost time: 0.9126665592193604
Epoch: 42, Steps: 64 | Train Loss: 0.1092941 Vali Loss: 0.1657259 Test Loss: 0.1504225
Validation loss decreased (0.167611 --> 0.165726).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 43 cost time: 0.9512794017791748
Epoch: 43, Steps: 64 | Train Loss: 0.1090629 Vali Loss: 0.1690188 Test Loss: 0.1505856
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 44 cost time: 0.9453446865081787
Epoch: 44, Steps: 64 | Train Loss: 0.1087533 Vali Loss: 0.1683992 Test Loss: 0.1499328
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 45 cost time: 0.9420385360717773
Epoch: 45, Steps: 64 | Train Loss: 0.1090004 Vali Loss: 0.1683474 Test Loss: 0.1503464
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 46 cost time: 0.9503378868103027
Epoch: 46, Steps: 64 | Train Loss: 0.1087598 Vali Loss: 0.1687066 Test Loss: 0.1499952
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 47 cost time: 0.9331815242767334
Epoch: 47, Steps: 64 | Train Loss: 0.1085508 Vali Loss: 0.1688147 Test Loss: 0.1501705
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 48 cost time: 0.9190006256103516
Epoch: 48, Steps: 64 | Train Loss: 0.1089955 Vali Loss: 0.1664852 Test Loss: 0.1495114
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 49 cost time: 0.9149982929229736
Epoch: 49, Steps: 64 | Train Loss: 0.1090743 Vali Loss: 0.1683297 Test Loss: 0.1494740
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 50 cost time: 0.9396224021911621
Epoch: 50, Steps: 64 | Train Loss: 0.1087509 Vali Loss: 0.1664242 Test Loss: 0.1492502
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 51 cost time: 0.9654173851013184
Epoch: 51, Steps: 64 | Train Loss: 0.1095704 Vali Loss: 0.1699665 Test Loss: 0.1496626
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 52 cost time: 0.9644033908843994
Epoch: 52, Steps: 64 | Train Loss: 0.1086201 Vali Loss: 0.1681885 Test Loss: 0.1491681
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 53 cost time: 0.9713599681854248
Epoch: 53, Steps: 64 | Train Loss: 0.1089034 Vali Loss: 0.1680513 Test Loss: 0.1498185
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 54 cost time: 0.9844095706939697
Epoch: 54, Steps: 64 | Train Loss: 0.1091924 Vali Loss: 0.1679345 Test Loss: 0.1497102
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 55 cost time: 0.966008186340332
Epoch: 55, Steps: 64 | Train Loss: 0.1086542 Vali Loss: 0.1674692 Test Loss: 0.1494159
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 56 cost time: 0.9480330944061279
Epoch: 56, Steps: 64 | Train Loss: 0.1086029 Vali Loss: 0.1702458 Test Loss: 0.1497900
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 57 cost time: 0.956998348236084
Epoch: 57, Steps: 64 | Train Loss: 0.1089981 Vali Loss: 0.1676208 Test Loss: 0.1496761
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 58 cost time: 0.9519989490509033
Epoch: 58, Steps: 64 | Train Loss: 0.1086456 Vali Loss: 0.1689714 Test Loss: 0.1496092
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 59 cost time: 0.941049337387085
Epoch: 59, Steps: 64 | Train Loss: 0.1080520 Vali Loss: 0.1701791 Test Loss: 0.1494875
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017818450927734375 GB
GPU已分配内存的峰值：0.04931306838989258 GB
Epoch: 60 cost time: 0.9534492492675781
Epoch: 60, Steps: 64 | Train Loss: 0.1081713 Vali Loss: 0.1682937 Test Loss: 0.1501718
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15042249858379364, mae:0.28643301129341125, rse:0.20643217861652374
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.04870176315307617 GB
Epoch: 1 cost time: 2.365370512008667
Epoch: 1, Steps: 64 | Train Loss: 0.7958091 Vali Loss: 1.8130348 Test Loss: 3.3857465
Validation loss decreased (inf --> 1.813035).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 2 cost time: 0.991868257522583
Epoch: 2, Steps: 64 | Train Loss: 0.5500579 Vali Loss: 0.7776857 Test Loss: 1.2785517
Validation loss decreased (1.813035 --> 0.777686).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 3 cost time: 0.9814114570617676
Epoch: 3, Steps: 64 | Train Loss: 0.2821759 Vali Loss: 0.4408629 Test Loss: 0.6074311
Validation loss decreased (0.777686 --> 0.440863).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 4 cost time: 0.9742743968963623
Epoch: 4, Steps: 64 | Train Loss: 0.1722167 Vali Loss: 0.2859236 Test Loss: 0.3263827
Validation loss decreased (0.440863 --> 0.285924).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 5 cost time: 0.9424591064453125
Epoch: 5, Steps: 64 | Train Loss: 0.1316532 Vali Loss: 0.2260615 Test Loss: 0.2225265
Validation loss decreased (0.285924 --> 0.226061).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 6 cost time: 0.9423646926879883
Epoch: 6, Steps: 64 | Train Loss: 0.1178923 Vali Loss: 0.2000831 Test Loss: 0.1897132
Validation loss decreased (0.226061 --> 0.200083).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 7 cost time: 0.9683873653411865
Epoch: 7, Steps: 64 | Train Loss: 0.1128810 Vali Loss: 0.1910751 Test Loss: 0.1785657
Validation loss decreased (0.200083 --> 0.191075).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 8 cost time: 0.990084171295166
Epoch: 8, Steps: 64 | Train Loss: 0.1086527 Vali Loss: 0.1861178 Test Loss: 0.1707112
Validation loss decreased (0.191075 --> 0.186118).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 9 cost time: 0.9884321689605713
Epoch: 9, Steps: 64 | Train Loss: 0.1060500 Vali Loss: 0.1827271 Test Loss: 0.1665648
Validation loss decreased (0.186118 --> 0.182727).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 10 cost time: 1.0044505596160889
Epoch: 10, Steps: 64 | Train Loss: 0.1042437 Vali Loss: 0.1781365 Test Loss: 0.1641507
Validation loss decreased (0.182727 --> 0.178136).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 11 cost time: 0.9949502944946289
Epoch: 11, Steps: 64 | Train Loss: 0.1027744 Vali Loss: 0.1765728 Test Loss: 0.1628957
Validation loss decreased (0.178136 --> 0.176573).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 12 cost time: 0.9906046390533447
Epoch: 12, Steps: 64 | Train Loss: 0.1006394 Vali Loss: 0.1762995 Test Loss: 0.1606405
Validation loss decreased (0.176573 --> 0.176300).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 13 cost time: 0.992999792098999
Epoch: 13, Steps: 64 | Train Loss: 0.0999543 Vali Loss: 0.1729650 Test Loss: 0.1595639
Validation loss decreased (0.176300 --> 0.172965).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 14 cost time: 0.9791717529296875
Epoch: 14, Steps: 64 | Train Loss: 0.0989577 Vali Loss: 0.1749849 Test Loss: 0.1592363
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 15 cost time: 0.9746332168579102
Epoch: 15, Steps: 64 | Train Loss: 0.0983057 Vali Loss: 0.1702497 Test Loss: 0.1576523
Validation loss decreased (0.172965 --> 0.170250).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 16 cost time: 0.9706568717956543
Epoch: 16, Steps: 64 | Train Loss: 0.0972852 Vali Loss: 0.1704093 Test Loss: 0.1576502
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 17 cost time: 0.9803755283355713
Epoch: 17, Steps: 64 | Train Loss: 0.0967638 Vali Loss: 0.1720687 Test Loss: 0.1570837
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 18 cost time: 0.9994244575500488
Epoch: 18, Steps: 64 | Train Loss: 0.0966437 Vali Loss: 0.1707959 Test Loss: 0.1574457
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 19 cost time: 0.9953746795654297
Epoch: 19, Steps: 64 | Train Loss: 0.0956752 Vali Loss: 0.1692535 Test Loss: 0.1570334
Validation loss decreased (0.170250 --> 0.169254).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 20 cost time: 0.991673469543457
Epoch: 20, Steps: 64 | Train Loss: 0.0955094 Vali Loss: 0.1710951 Test Loss: 0.1563483
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 21 cost time: 0.9474120140075684
Epoch: 21, Steps: 64 | Train Loss: 0.0952366 Vali Loss: 0.1676645 Test Loss: 0.1561230
Validation loss decreased (0.169254 --> 0.167664).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 22 cost time: 0.9447746276855469
Epoch: 22, Steps: 64 | Train Loss: 0.0948580 Vali Loss: 0.1679676 Test Loss: 0.1555676
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 23 cost time: 0.9518249034881592
Epoch: 23, Steps: 64 | Train Loss: 0.0949418 Vali Loss: 0.1678927 Test Loss: 0.1555585
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 24 cost time: 0.9456186294555664
Epoch: 24, Steps: 64 | Train Loss: 0.0946169 Vali Loss: 0.1685333 Test Loss: 0.1557050
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 25 cost time: 0.9526395797729492
Epoch: 25, Steps: 64 | Train Loss: 0.0941661 Vali Loss: 0.1670729 Test Loss: 0.1556841
Validation loss decreased (0.167664 --> 0.167073).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 26 cost time: 0.9906415939331055
Epoch: 26, Steps: 64 | Train Loss: 0.0940068 Vali Loss: 0.1673311 Test Loss: 0.1552839
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 27 cost time: 0.9673843383789062
Epoch: 27, Steps: 64 | Train Loss: 0.0935058 Vali Loss: 0.1676111 Test Loss: 0.1553166
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 28 cost time: 0.9913928508758545
Epoch: 28, Steps: 64 | Train Loss: 0.0930648 Vali Loss: 0.1656169 Test Loss: 0.1566874
Validation loss decreased (0.167073 --> 0.165617).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 29 cost time: 0.9964408874511719
Epoch: 29, Steps: 64 | Train Loss: 0.0937805 Vali Loss: 0.1667078 Test Loss: 0.1550510
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 30 cost time: 0.991504430770874
Epoch: 30, Steps: 64 | Train Loss: 0.0936038 Vali Loss: 0.1661007 Test Loss: 0.1550089
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 31 cost time: 0.9794228076934814
Epoch: 31, Steps: 64 | Train Loss: 0.0931547 Vali Loss: 0.1657500 Test Loss: 0.1559256
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 32 cost time: 0.9757626056671143
Epoch: 32, Steps: 64 | Train Loss: 0.0930808 Vali Loss: 0.1653562 Test Loss: 0.1551386
Validation loss decreased (0.165617 --> 0.165356).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 33 cost time: 0.9777307510375977
Epoch: 33, Steps: 64 | Train Loss: 0.0930335 Vali Loss: 0.1669906 Test Loss: 0.1546299
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 34 cost time: 0.9998025894165039
Epoch: 34, Steps: 64 | Train Loss: 0.0930208 Vali Loss: 0.1658859 Test Loss: 0.1550480
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 35 cost time: 0.9994330406188965
Epoch: 35, Steps: 64 | Train Loss: 0.0929997 Vali Loss: 0.1679057 Test Loss: 0.1556635
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 36 cost time: 1.0043723583221436
Epoch: 36, Steps: 64 | Train Loss: 0.0927884 Vali Loss: 0.1674924 Test Loss: 0.1551956
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 37 cost time: 0.9946365356445312
Epoch: 37, Steps: 64 | Train Loss: 0.0926613 Vali Loss: 0.1677075 Test Loss: 0.1555113
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 38 cost time: 0.9866461753845215
Epoch: 38, Steps: 64 | Train Loss: 0.0927215 Vali Loss: 0.1661526 Test Loss: 0.1550390
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 39 cost time: 0.9584600925445557
Epoch: 39, Steps: 64 | Train Loss: 0.0923228 Vali Loss: 0.1654344 Test Loss: 0.1556955
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 40 cost time: 0.9501969814300537
Epoch: 40, Steps: 64 | Train Loss: 0.0929147 Vali Loss: 0.1649569 Test Loss: 0.1562054
Validation loss decreased (0.165356 --> 0.164957).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 41 cost time: 0.9429306983947754
Epoch: 41, Steps: 64 | Train Loss: 0.0926902 Vali Loss: 0.1649875 Test Loss: 0.1555939
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 42 cost time: 0.9655487537384033
Epoch: 42, Steps: 64 | Train Loss: 0.0927863 Vali Loss: 0.1658732 Test Loss: 0.1552742
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 43 cost time: 0.9703905582427979
Epoch: 43, Steps: 64 | Train Loss: 0.0924409 Vali Loss: 0.1653013 Test Loss: 0.1556966
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 44 cost time: 0.9678783416748047
Epoch: 44, Steps: 64 | Train Loss: 0.0924514 Vali Loss: 0.1663800 Test Loss: 0.1559063
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 45 cost time: 0.9767754077911377
Epoch: 45, Steps: 64 | Train Loss: 0.0925343 Vali Loss: 0.1668833 Test Loss: 0.1553256
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 46 cost time: 0.9620013236999512
Epoch: 46, Steps: 64 | Train Loss: 0.0926057 Vali Loss: 0.1667149 Test Loss: 0.1545391
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 47 cost time: 0.9419987201690674
Epoch: 47, Steps: 64 | Train Loss: 0.0925574 Vali Loss: 0.1659016 Test Loss: 0.1556806
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 48 cost time: 0.9526932239532471
Epoch: 48, Steps: 64 | Train Loss: 0.0925921 Vali Loss: 0.1669573 Test Loss: 0.1555790
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 49 cost time: 0.9806134700775146
Epoch: 49, Steps: 64 | Train Loss: 0.0919237 Vali Loss: 0.1659105 Test Loss: 0.1553405
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 50 cost time: 0.9834072589874268
Epoch: 50, Steps: 64 | Train Loss: 0.0921284 Vali Loss: 0.1675396 Test Loss: 0.1559998
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 51 cost time: 0.9964637756347656
Epoch: 51, Steps: 64 | Train Loss: 0.0920216 Vali Loss: 0.1667320 Test Loss: 0.1548223
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 52 cost time: 1.0004494190216064
Epoch: 52, Steps: 64 | Train Loss: 0.0923231 Vali Loss: 0.1652365 Test Loss: 0.1549889
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 53 cost time: 1.0108528137207031
Epoch: 53, Steps: 64 | Train Loss: 0.0922949 Vali Loss: 0.1647664 Test Loss: 0.1548139
Validation loss decreased (0.164957 --> 0.164766).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 54 cost time: 0.9914000034332275
Epoch: 54, Steps: 64 | Train Loss: 0.0920635 Vali Loss: 0.1650025 Test Loss: 0.1554522
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 55 cost time: 0.9854600429534912
Epoch: 55, Steps: 64 | Train Loss: 0.0917886 Vali Loss: 0.1668428 Test Loss: 0.1553891
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 56 cost time: 0.9937615394592285
Epoch: 56, Steps: 64 | Train Loss: 0.0924415 Vali Loss: 0.1650278 Test Loss: 0.1543496
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 57 cost time: 0.9771215915679932
Epoch: 57, Steps: 64 | Train Loss: 0.0922300 Vali Loss: 0.1669647 Test Loss: 0.1560694
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 58 cost time: 0.9446346759796143
Epoch: 58, Steps: 64 | Train Loss: 0.0923965 Vali Loss: 0.1666046 Test Loss: 0.1556574
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 59 cost time: 1.0046660900115967
Epoch: 59, Steps: 64 | Train Loss: 0.0923159 Vali Loss: 0.1648859 Test Loss: 0.1552694
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017856597900390625 GB
GPU已分配内存的峰值：0.050074100494384766 GB
Epoch: 60 cost time: 0.970252513885498
Epoch: 60, Steps: 64 | Train Loss: 0.0921936 Vali Loss: 0.1661171 Test Loss: 0.1549364
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15481390058994293, mae:0.3014121651649475, rse:0.20942376554012299
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.04926586151123047 GB
Epoch: 1 cost time: 2.373802661895752
Epoch: 1, Steps: 64 | Train Loss: 0.7925812 Vali Loss: 1.8019964 Test Loss: 3.4107611
Validation loss decreased (inf --> 1.801996).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 2 cost time: 1.0144739151000977
Epoch: 2, Steps: 64 | Train Loss: 0.5435801 Vali Loss: 0.7874430 Test Loss: 1.2873847
Validation loss decreased (1.801996 --> 0.787443).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 3 cost time: 1.0190000534057617
Epoch: 3, Steps: 64 | Train Loss: 0.2761810 Vali Loss: 0.4160270 Test Loss: 0.5703092
Validation loss decreased (0.787443 --> 0.416027).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 4 cost time: 1.0270817279815674
Epoch: 4, Steps: 64 | Train Loss: 0.1638052 Vali Loss: 0.2489087 Test Loss: 0.2720939
Validation loss decreased (0.416027 --> 0.248909).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 5 cost time: 1.0220131874084473
Epoch: 5, Steps: 64 | Train Loss: 0.1256641 Vali Loss: 0.1936507 Test Loss: 0.1829406
Validation loss decreased (0.248909 --> 0.193651).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 6 cost time: 0.9721932411193848
Epoch: 6, Steps: 64 | Train Loss: 0.1143893 Vali Loss: 0.1842460 Test Loss: 0.1675458
Validation loss decreased (0.193651 --> 0.184246).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 7 cost time: 0.9745080471038818
Epoch: 7, Steps: 64 | Train Loss: 0.1095889 Vali Loss: 0.1778278 Test Loss: 0.1618447
Validation loss decreased (0.184246 --> 0.177828).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 8 cost time: 0.9793882369995117
Epoch: 8, Steps: 64 | Train Loss: 0.1067060 Vali Loss: 0.1766485 Test Loss: 0.1595911
Validation loss decreased (0.177828 --> 0.176648).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 9 cost time: 1.0073416233062744
Epoch: 9, Steps: 64 | Train Loss: 0.1043722 Vali Loss: 0.1710645 Test Loss: 0.1545377
Validation loss decreased (0.176648 --> 0.171065).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 10 cost time: 1.0188407897949219
Epoch: 10, Steps: 64 | Train Loss: 0.1029216 Vali Loss: 0.1721374 Test Loss: 0.1557994
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 11 cost time: 1.0178961753845215
Epoch: 11, Steps: 64 | Train Loss: 0.1004412 Vali Loss: 0.1722259 Test Loss: 0.1545159
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 12 cost time: 1.0329153537750244
Epoch: 12, Steps: 64 | Train Loss: 0.0993247 Vali Loss: 0.1690105 Test Loss: 0.1542828
Validation loss decreased (0.171065 --> 0.169010).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 13 cost time: 0.9939460754394531
Epoch: 13, Steps: 64 | Train Loss: 0.0989374 Vali Loss: 0.1709555 Test Loss: 0.1563026
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 14 cost time: 1.0010550022125244
Epoch: 14, Steps: 64 | Train Loss: 0.0980878 Vali Loss: 0.1673982 Test Loss: 0.1556571
Validation loss decreased (0.169010 --> 0.167398).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 15 cost time: 1.0103869438171387
Epoch: 15, Steps: 64 | Train Loss: 0.0976108 Vali Loss: 0.1660814 Test Loss: 0.1550918
Validation loss decreased (0.167398 --> 0.166081).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 16 cost time: 1.000749111175537
Epoch: 16, Steps: 64 | Train Loss: 0.0964047 Vali Loss: 0.1678285 Test Loss: 0.1553219
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 17 cost time: 1.0207369327545166
Epoch: 17, Steps: 64 | Train Loss: 0.0962091 Vali Loss: 0.1688183 Test Loss: 0.1561299
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 18 cost time: 1.023515224456787
Epoch: 18, Steps: 64 | Train Loss: 0.0952674 Vali Loss: 0.1675527 Test Loss: 0.1571566
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 19 cost time: 1.0030004978179932
Epoch: 19, Steps: 64 | Train Loss: 0.0951455 Vali Loss: 0.1676302 Test Loss: 0.1565818
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 20 cost time: 0.9969980716705322
Epoch: 20, Steps: 64 | Train Loss: 0.0949940 Vali Loss: 0.1675534 Test Loss: 0.1563406
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 21 cost time: 0.9886400699615479
Epoch: 21, Steps: 64 | Train Loss: 0.0943236 Vali Loss: 0.1684664 Test Loss: 0.1567507
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 22 cost time: 1.0480921268463135
Epoch: 22, Steps: 64 | Train Loss: 0.0937026 Vali Loss: 0.1666535 Test Loss: 0.1575696
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 23 cost time: 0.9704656600952148
Epoch: 23, Steps: 64 | Train Loss: 0.0939203 Vali Loss: 0.1684524 Test Loss: 0.1564021
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 24 cost time: 0.9743907451629639
Epoch: 24, Steps: 64 | Train Loss: 0.0938948 Vali Loss: 0.1657663 Test Loss: 0.1572990
Validation loss decreased (0.166081 --> 0.165766).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 25 cost time: 0.9972624778747559
Epoch: 25, Steps: 64 | Train Loss: 0.0934120 Vali Loss: 0.1669089 Test Loss: 0.1566995
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 26 cost time: 1.0011088848114014
Epoch: 26, Steps: 64 | Train Loss: 0.0934833 Vali Loss: 0.1671159 Test Loss: 0.1571696
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 27 cost time: 1.003222942352295
Epoch: 27, Steps: 64 | Train Loss: 0.0929243 Vali Loss: 0.1674626 Test Loss: 0.1567280
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 28 cost time: 1.0043790340423584
Epoch: 28, Steps: 64 | Train Loss: 0.0932485 Vali Loss: 0.1659424 Test Loss: 0.1565389
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 29 cost time: 0.9914131164550781
Epoch: 29, Steps: 64 | Train Loss: 0.0928642 Vali Loss: 0.1680772 Test Loss: 0.1580726
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 30 cost time: 0.9982650279998779
Epoch: 30, Steps: 64 | Train Loss: 0.0927397 Vali Loss: 0.1662796 Test Loss: 0.1574005
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 31 cost time: 1.0077908039093018
Epoch: 31, Steps: 64 | Train Loss: 0.0925128 Vali Loss: 0.1679738 Test Loss: 0.1566124
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 32 cost time: 0.9957706928253174
Epoch: 32, Steps: 64 | Train Loss: 0.0925681 Vali Loss: 0.1674311 Test Loss: 0.1578378
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 33 cost time: 1.02000093460083
Epoch: 33, Steps: 64 | Train Loss: 0.0925696 Vali Loss: 0.1660890 Test Loss: 0.1572003
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 34 cost time: 1.0337457656860352
Epoch: 34, Steps: 64 | Train Loss: 0.0923064 Vali Loss: 0.1671699 Test Loss: 0.1577113
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 35 cost time: 1.022641658782959
Epoch: 35, Steps: 64 | Train Loss: 0.0923193 Vali Loss: 0.1680170 Test Loss: 0.1587258
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 36 cost time: 1.0216319561004639
Epoch: 36, Steps: 64 | Train Loss: 0.0920078 Vali Loss: 0.1665080 Test Loss: 0.1571987
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 37 cost time: 1.0067226886749268
Epoch: 37, Steps: 64 | Train Loss: 0.0918080 Vali Loss: 0.1670907 Test Loss: 0.1575765
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 38 cost time: 0.9646291732788086
Epoch: 38, Steps: 64 | Train Loss: 0.0919540 Vali Loss: 0.1678454 Test Loss: 0.1582404
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 39 cost time: 0.9740164279937744
Epoch: 39, Steps: 64 | Train Loss: 0.0920942 Vali Loss: 0.1667539 Test Loss: 0.1572051
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 40 cost time: 0.9713544845581055
Epoch: 40, Steps: 64 | Train Loss: 0.0918058 Vali Loss: 0.1682746 Test Loss: 0.1585239
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 41 cost time: 0.9860427379608154
Epoch: 41, Steps: 64 | Train Loss: 0.0921769 Vali Loss: 0.1665497 Test Loss: 0.1572349
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 42 cost time: 0.9908204078674316
Epoch: 42, Steps: 64 | Train Loss: 0.0918369 Vali Loss: 0.1666735 Test Loss: 0.1574338
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 43 cost time: 0.9803683757781982
Epoch: 43, Steps: 64 | Train Loss: 0.0920079 Vali Loss: 0.1670013 Test Loss: 0.1573333
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 44 cost time: 1.007394790649414
Epoch: 44, Steps: 64 | Train Loss: 0.0918483 Vali Loss: 0.1675424 Test Loss: 0.1573343
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 45 cost time: 0.9727282524108887
Epoch: 45, Steps: 64 | Train Loss: 0.0919359 Vali Loss: 0.1677270 Test Loss: 0.1586674
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 46 cost time: 0.9631576538085938
Epoch: 46, Steps: 64 | Train Loss: 0.0917784 Vali Loss: 0.1666124 Test Loss: 0.1580836
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 47 cost time: 0.9910001754760742
Epoch: 47, Steps: 64 | Train Loss: 0.0919464 Vali Loss: 0.1667297 Test Loss: 0.1577122
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 48 cost time: 0.9976375102996826
Epoch: 48, Steps: 64 | Train Loss: 0.0918741 Vali Loss: 0.1670881 Test Loss: 0.1579244
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 49 cost time: 1.0066516399383545
Epoch: 49, Steps: 64 | Train Loss: 0.0919811 Vali Loss: 0.1653192 Test Loss: 0.1572864
Validation loss decreased (0.165766 --> 0.165319).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 50 cost time: 1.0213391780853271
Epoch: 50, Steps: 64 | Train Loss: 0.0913527 Vali Loss: 0.1663123 Test Loss: 0.1574310
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 51 cost time: 1.0163652896881104
Epoch: 51, Steps: 64 | Train Loss: 0.0917821 Vali Loss: 0.1672304 Test Loss: 0.1579724
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 52 cost time: 1.02308988571167
Epoch: 52, Steps: 64 | Train Loss: 0.0915022 Vali Loss: 0.1667639 Test Loss: 0.1574640
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 53 cost time: 1.015385389328003
Epoch: 53, Steps: 64 | Train Loss: 0.0918411 Vali Loss: 0.1681783 Test Loss: 0.1583088
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 54 cost time: 0.9950506687164307
Epoch: 54, Steps: 64 | Train Loss: 0.0917035 Vali Loss: 0.1670642 Test Loss: 0.1570543
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 55 cost time: 0.9993698596954346
Epoch: 55, Steps: 64 | Train Loss: 0.0917504 Vali Loss: 0.1679475 Test Loss: 0.1588953
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 56 cost time: 0.9844653606414795
Epoch: 56, Steps: 64 | Train Loss: 0.0920744 Vali Loss: 0.1671282 Test Loss: 0.1586829
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 57 cost time: 0.9804210662841797
Epoch: 57, Steps: 64 | Train Loss: 0.0913713 Vali Loss: 0.1642800 Test Loss: 0.1572549
Validation loss decreased (0.165319 --> 0.164280).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 58 cost time: 1.0191078186035156
Epoch: 58, Steps: 64 | Train Loss: 0.0914457 Vali Loss: 0.1659089 Test Loss: 0.1577092
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 59 cost time: 1.0153896808624268
Epoch: 59, Steps: 64 | Train Loss: 0.0916267 Vali Loss: 0.1664675 Test Loss: 0.1581184
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017879486083984375 GB
GPU已分配内存的峰值：0.05082368850708008 GB
Epoch: 60 cost time: 1.01774263381958
Epoch: 60, Steps: 64 | Train Loss: 0.0915202 Vali Loss: 0.1662344 Test Loss: 0.1577943
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1572549045085907, mae:0.3061967194080353, rse:0.2110683172941208
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045186519622802734 GB
Epoch: 1 cost time: 2.2981526851654053
Epoch: 1, Steps: 64 | Train Loss: 1.0102631 Vali Loss: 2.0314488 Test Loss: 3.9247105
Validation loss decreased (inf --> 2.031449).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 2 cost time: 0.9207017421722412
Epoch: 2, Steps: 64 | Train Loss: 0.7390457 Vali Loss: 0.9266566 Test Loss: 1.5892171
Validation loss decreased (2.031449 --> 0.926657).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 3 cost time: 0.9178104400634766
Epoch: 3, Steps: 64 | Train Loss: 0.3741647 Vali Loss: 0.3949928 Test Loss: 0.4888501
Validation loss decreased (0.926657 --> 0.394993).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 4 cost time: 0.9149999618530273
Epoch: 4, Steps: 64 | Train Loss: 0.2214050 Vali Loss: 0.2838174 Test Loss: 0.2816485
Validation loss decreased (0.394993 --> 0.283817).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 5 cost time: 0.8893170356750488
Epoch: 5, Steps: 64 | Train Loss: 0.1779773 Vali Loss: 0.2365788 Test Loss: 0.2216596
Validation loss decreased (0.283817 --> 0.236579).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 6 cost time: 0.8833184242248535
Epoch: 6, Steps: 64 | Train Loss: 0.1584843 Vali Loss: 0.2160257 Test Loss: 0.1967077
Validation loss decreased (0.236579 --> 0.216026).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 7 cost time: 0.8733956813812256
Epoch: 7, Steps: 64 | Train Loss: 0.1460450 Vali Loss: 0.2023553 Test Loss: 0.1840425
Validation loss decreased (0.216026 --> 0.202355).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 8 cost time: 0.8764052391052246
Epoch: 8, Steps: 64 | Train Loss: 0.1388414 Vali Loss: 0.1899126 Test Loss: 0.1760341
Validation loss decreased (0.202355 --> 0.189913).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 9 cost time: 0.8814599514007568
Epoch: 9, Steps: 64 | Train Loss: 0.1326077 Vali Loss: 0.1878328 Test Loss: 0.1725249
Validation loss decreased (0.189913 --> 0.187833).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 10 cost time: 0.9124410152435303
Epoch: 10, Steps: 64 | Train Loss: 0.1282506 Vali Loss: 0.1806995 Test Loss: 0.1689056
Validation loss decreased (0.187833 --> 0.180700).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 11 cost time: 0.9146599769592285
Epoch: 11, Steps: 64 | Train Loss: 0.1252486 Vali Loss: 0.1782891 Test Loss: 0.1664404
Validation loss decreased (0.180700 --> 0.178289).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 12 cost time: 0.9254052639007568
Epoch: 12, Steps: 64 | Train Loss: 0.1220322 Vali Loss: 0.1783834 Test Loss: 0.1648740
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 13 cost time: 0.9304075241088867
Epoch: 13, Steps: 64 | Train Loss: 0.1203371 Vali Loss: 0.1778226 Test Loss: 0.1626857
Validation loss decreased (0.178289 --> 0.177823).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 14 cost time: 0.9120056629180908
Epoch: 14, Steps: 64 | Train Loss: 0.1182982 Vali Loss: 0.1734561 Test Loss: 0.1621649
Validation loss decreased (0.177823 --> 0.173456).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 15 cost time: 0.9108095169067383
Epoch: 15, Steps: 64 | Train Loss: 0.1164579 Vali Loss: 0.1725064 Test Loss: 0.1607855
Validation loss decreased (0.173456 --> 0.172506).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 16 cost time: 0.9067478179931641
Epoch: 16, Steps: 64 | Train Loss: 0.1146362 Vali Loss: 0.1727896 Test Loss: 0.1614230
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 17 cost time: 0.9188063144683838
Epoch: 17, Steps: 64 | Train Loss: 0.1142564 Vali Loss: 0.1715821 Test Loss: 0.1596250
Validation loss decreased (0.172506 --> 0.171582).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 18 cost time: 0.9125332832336426
Epoch: 18, Steps: 64 | Train Loss: 0.1127874 Vali Loss: 0.1688477 Test Loss: 0.1596090
Validation loss decreased (0.171582 --> 0.168848).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 19 cost time: 0.9271965026855469
Epoch: 19, Steps: 64 | Train Loss: 0.1121681 Vali Loss: 0.1695974 Test Loss: 0.1587273
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 20 cost time: 0.9234292507171631
Epoch: 20, Steps: 64 | Train Loss: 0.1113928 Vali Loss: 0.1677637 Test Loss: 0.1571755
Validation loss decreased (0.168848 --> 0.167764).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 21 cost time: 0.8873844146728516
Epoch: 21, Steps: 64 | Train Loss: 0.1101846 Vali Loss: 0.1691613 Test Loss: 0.1579778
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 22 cost time: 0.897808313369751
Epoch: 22, Steps: 64 | Train Loss: 0.1098676 Vali Loss: 0.1679954 Test Loss: 0.1582427
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 23 cost time: 0.8760025501251221
Epoch: 23, Steps: 64 | Train Loss: 0.1094723 Vali Loss: 0.1681851 Test Loss: 0.1579219
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 24 cost time: 0.882056713104248
Epoch: 24, Steps: 64 | Train Loss: 0.1089141 Vali Loss: 0.1664079 Test Loss: 0.1570071
Validation loss decreased (0.167764 --> 0.166408).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 25 cost time: 0.8763701915740967
Epoch: 25, Steps: 64 | Train Loss: 0.1077261 Vali Loss: 0.1669374 Test Loss: 0.1566855
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 26 cost time: 0.8763835430145264
Epoch: 26, Steps: 64 | Train Loss: 0.1073645 Vali Loss: 0.1678449 Test Loss: 0.1566017
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 27 cost time: 0.8863961696624756
Epoch: 27, Steps: 64 | Train Loss: 0.1070682 Vali Loss: 0.1657522 Test Loss: 0.1564222
Validation loss decreased (0.166408 --> 0.165752).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 28 cost time: 0.9027330875396729
Epoch: 28, Steps: 64 | Train Loss: 0.1068969 Vali Loss: 0.1665317 Test Loss: 0.1564595
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 29 cost time: 0.8989999294281006
Epoch: 29, Steps: 64 | Train Loss: 0.1070303 Vali Loss: 0.1665979 Test Loss: 0.1558114
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 30 cost time: 0.8956458568572998
Epoch: 30, Steps: 64 | Train Loss: 0.1059915 Vali Loss: 0.1654320 Test Loss: 0.1563054
Validation loss decreased (0.165752 --> 0.165432).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 31 cost time: 0.904369592666626
Epoch: 31, Steps: 64 | Train Loss: 0.1058212 Vali Loss: 0.1664234 Test Loss: 0.1566222
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 32 cost time: 0.9124472141265869
Epoch: 32, Steps: 64 | Train Loss: 0.1061412 Vali Loss: 0.1650415 Test Loss: 0.1563881
Validation loss decreased (0.165432 --> 0.165041).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 33 cost time: 0.9138545989990234
Epoch: 33, Steps: 64 | Train Loss: 0.1054733 Vali Loss: 0.1644013 Test Loss: 0.1562705
Validation loss decreased (0.165041 --> 0.164401).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 34 cost time: 0.906745433807373
Epoch: 34, Steps: 64 | Train Loss: 0.1055212 Vali Loss: 0.1661662 Test Loss: 0.1567601
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 35 cost time: 0.9169976711273193
Epoch: 35, Steps: 64 | Train Loss: 0.1049226 Vali Loss: 0.1639126 Test Loss: 0.1554464
Validation loss decreased (0.164401 --> 0.163913).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 36 cost time: 0.9134924411773682
Epoch: 36, Steps: 64 | Train Loss: 0.1050221 Vali Loss: 0.1646510 Test Loss: 0.1551665
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 37 cost time: 0.92547607421875
Epoch: 37, Steps: 64 | Train Loss: 0.1052882 Vali Loss: 0.1642199 Test Loss: 0.1555107
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 38 cost time: 0.9324219226837158
Epoch: 38, Steps: 64 | Train Loss: 0.1050628 Vali Loss: 0.1648762 Test Loss: 0.1556198
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 39 cost time: 0.9337756633758545
Epoch: 39, Steps: 64 | Train Loss: 0.1050781 Vali Loss: 0.1637923 Test Loss: 0.1555258
Validation loss decreased (0.163913 --> 0.163792).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 40 cost time: 0.9233920574188232
Epoch: 40, Steps: 64 | Train Loss: 0.1046602 Vali Loss: 0.1648290 Test Loss: 0.1552548
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 41 cost time: 0.9177796840667725
Epoch: 41, Steps: 64 | Train Loss: 0.1045933 Vali Loss: 0.1654889 Test Loss: 0.1558354
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 42 cost time: 0.9094057083129883
Epoch: 42, Steps: 64 | Train Loss: 0.1041738 Vali Loss: 0.1639893 Test Loss: 0.1553662
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 43 cost time: 0.870638370513916
Epoch: 43, Steps: 64 | Train Loss: 0.1043446 Vali Loss: 0.1660973 Test Loss: 0.1560297
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 44 cost time: 0.8684275150299072
Epoch: 44, Steps: 64 | Train Loss: 0.1041458 Vali Loss: 0.1648537 Test Loss: 0.1554433
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 45 cost time: 0.889418363571167
Epoch: 45, Steps: 64 | Train Loss: 0.1041996 Vali Loss: 0.1622953 Test Loss: 0.1556102
Validation loss decreased (0.163792 --> 0.162295).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 46 cost time: 0.9064064025878906
Epoch: 46, Steps: 64 | Train Loss: 0.1040494 Vali Loss: 0.1659912 Test Loss: 0.1562108
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 47 cost time: 0.9027369022369385
Epoch: 47, Steps: 64 | Train Loss: 0.1044930 Vali Loss: 0.1637957 Test Loss: 0.1556248
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 48 cost time: 0.8959989547729492
Epoch: 48, Steps: 64 | Train Loss: 0.1039396 Vali Loss: 0.1646781 Test Loss: 0.1558445
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 49 cost time: 0.9061992168426514
Epoch: 49, Steps: 64 | Train Loss: 0.1040066 Vali Loss: 0.1649500 Test Loss: 0.1552121
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 50 cost time: 0.8734495639801025
Epoch: 50, Steps: 64 | Train Loss: 0.1041640 Vali Loss: 0.1637263 Test Loss: 0.1554995
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 51 cost time: 0.8794183731079102
Epoch: 51, Steps: 64 | Train Loss: 0.1040931 Vali Loss: 0.1634244 Test Loss: 0.1549634
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 52 cost time: 0.9129972457885742
Epoch: 52, Steps: 64 | Train Loss: 0.1041077 Vali Loss: 0.1629046 Test Loss: 0.1552622
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 53 cost time: 0.920731782913208
Epoch: 53, Steps: 64 | Train Loss: 0.1041880 Vali Loss: 0.1645412 Test Loss: 0.1558460
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 54 cost time: 0.9269247055053711
Epoch: 54, Steps: 64 | Train Loss: 0.1040727 Vali Loss: 0.1641764 Test Loss: 0.1548767
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 55 cost time: 0.9213569164276123
Epoch: 55, Steps: 64 | Train Loss: 0.1036947 Vali Loss: 0.1626547 Test Loss: 0.1554278
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 56 cost time: 0.9423215389251709
Epoch: 56, Steps: 64 | Train Loss: 0.1034776 Vali Loss: 0.1649220 Test Loss: 0.1549745
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 57 cost time: 0.930413007736206
Epoch: 57, Steps: 64 | Train Loss: 0.1040022 Vali Loss: 0.1640441 Test Loss: 0.1552377
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 58 cost time: 0.921515703201294
Epoch: 58, Steps: 64 | Train Loss: 0.1030539 Vali Loss: 0.1626618 Test Loss: 0.1561489
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 59 cost time: 0.9244539737701416
Epoch: 59, Steps: 64 | Train Loss: 0.1037764 Vali Loss: 0.1631810 Test Loss: 0.1554723
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017915725708007812 GB
GPU已分配内存的峰值：0.045891761779785156 GB
Epoch: 60 cost time: 0.9323956966400146
Epoch: 60, Steps: 64 | Train Loss: 0.1044192 Vali Loss: 0.1630163 Test Loss: 0.1552267
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15561020374298096, mae:0.293905645608902, rse:0.2099616676568985
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.04661846160888672 GB
Epoch: 1 cost time: 2.3478448390960693
Epoch: 1, Steps: 64 | Train Loss: 0.7704770 Vali Loss: 1.7247422 Test Loss: 3.2041030
Validation loss decreased (inf --> 1.724742).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 2 cost time: 0.9574477672576904
Epoch: 2, Steps: 64 | Train Loss: 0.4862655 Vali Loss: 0.5797896 Test Loss: 0.8236241
Validation loss decreased (1.724742 --> 0.579790).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 3 cost time: 0.951805830001831
Epoch: 3, Steps: 64 | Train Loss: 0.1831147 Vali Loss: 0.2240832 Test Loss: 0.1955355
Validation loss decreased (0.579790 --> 0.224083).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 4 cost time: 0.9619996547698975
Epoch: 4, Steps: 64 | Train Loss: 0.1166876 Vali Loss: 0.1808992 Test Loss: 0.1562019
Validation loss decreased (0.224083 --> 0.180899).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 5 cost time: 0.9506351947784424
Epoch: 5, Steps: 64 | Train Loss: 0.1067195 Vali Loss: 0.1707815 Test Loss: 0.1527472
Validation loss decreased (0.180899 --> 0.170781).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 6 cost time: 0.950615406036377
Epoch: 6, Steps: 64 | Train Loss: 0.1012300 Vali Loss: 0.1701623 Test Loss: 0.1505733
Validation loss decreased (0.170781 --> 0.170162).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 7 cost time: 0.9274578094482422
Epoch: 7, Steps: 64 | Train Loss: 0.0977553 Vali Loss: 0.1648042 Test Loss: 0.1497054
Validation loss decreased (0.170162 --> 0.164804).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 8 cost time: 0.9069998264312744
Epoch: 8, Steps: 64 | Train Loss: 0.0951480 Vali Loss: 0.1670378 Test Loss: 0.1498969
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 9 cost time: 0.9142532348632812
Epoch: 9, Steps: 64 | Train Loss: 0.0932387 Vali Loss: 0.1628980 Test Loss: 0.1490829
Validation loss decreased (0.164804 --> 0.162898).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 10 cost time: 0.9570016860961914
Epoch: 10, Steps: 64 | Train Loss: 0.0913210 Vali Loss: 0.1618241 Test Loss: 0.1494624
Validation loss decreased (0.162898 --> 0.161824).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 11 cost time: 0.9556422233581543
Epoch: 11, Steps: 64 | Train Loss: 0.0903252 Vali Loss: 0.1601436 Test Loss: 0.1487845
Validation loss decreased (0.161824 --> 0.160144).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 12 cost time: 0.9580004215240479
Epoch: 12, Steps: 64 | Train Loss: 0.0894643 Vali Loss: 0.1607367 Test Loss: 0.1489798
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 13 cost time: 0.9651997089385986
Epoch: 13, Steps: 64 | Train Loss: 0.0883051 Vali Loss: 0.1601945 Test Loss: 0.1483035
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 14 cost time: 0.9416224956512451
Epoch: 14, Steps: 64 | Train Loss: 0.0881915 Vali Loss: 0.1581770 Test Loss: 0.1478855
Validation loss decreased (0.160144 --> 0.158177).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 15 cost time: 0.9374179840087891
Epoch: 15, Steps: 64 | Train Loss: 0.0873767 Vali Loss: 0.1598308 Test Loss: 0.1483270
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 16 cost time: 0.9398314952850342
Epoch: 16, Steps: 64 | Train Loss: 0.0866000 Vali Loss: 0.1570447 Test Loss: 0.1479295
Validation loss decreased (0.158177 --> 0.157045).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 17 cost time: 0.937359094619751
Epoch: 17, Steps: 64 | Train Loss: 0.0860941 Vali Loss: 0.1592993 Test Loss: 0.1481013
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 18 cost time: 0.9547715187072754
Epoch: 18, Steps: 64 | Train Loss: 0.0854456 Vali Loss: 0.1561941 Test Loss: 0.1471348
Validation loss decreased (0.157045 --> 0.156194).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 19 cost time: 0.9457392692565918
Epoch: 19, Steps: 64 | Train Loss: 0.0852723 Vali Loss: 0.1580656 Test Loss: 0.1480451
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 20 cost time: 0.9380006790161133
Epoch: 20, Steps: 64 | Train Loss: 0.0848727 Vali Loss: 0.1571636 Test Loss: 0.1473569
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 21 cost time: 0.9269981384277344
Epoch: 21, Steps: 64 | Train Loss: 0.0847248 Vali Loss: 0.1567292 Test Loss: 0.1477347
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 22 cost time: 0.9506354331970215
Epoch: 22, Steps: 64 | Train Loss: 0.0844373 Vali Loss: 0.1561196 Test Loss: 0.1480417
Validation loss decreased (0.156194 --> 0.156120).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 23 cost time: 0.9652698040008545
Epoch: 23, Steps: 64 | Train Loss: 0.0842046 Vali Loss: 0.1569796 Test Loss: 0.1479330
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 24 cost time: 0.9033699035644531
Epoch: 24, Steps: 64 | Train Loss: 0.0839362 Vali Loss: 0.1543186 Test Loss: 0.1474281
Validation loss decreased (0.156120 --> 0.154319).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 25 cost time: 0.9144928455352783
Epoch: 25, Steps: 64 | Train Loss: 0.0834680 Vali Loss: 0.1561020 Test Loss: 0.1472372
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 26 cost time: 0.9088685512542725
Epoch: 26, Steps: 64 | Train Loss: 0.0831251 Vali Loss: 0.1537484 Test Loss: 0.1475882
Validation loss decreased (0.154319 --> 0.153748).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 27 cost time: 0.9311442375183105
Epoch: 27, Steps: 64 | Train Loss: 0.0834394 Vali Loss: 0.1557780 Test Loss: 0.1478320
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 28 cost time: 0.9449999332427979
Epoch: 28, Steps: 64 | Train Loss: 0.0827667 Vali Loss: 0.1536323 Test Loss: 0.1475194
Validation loss decreased (0.153748 --> 0.153632).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 29 cost time: 0.95943284034729
Epoch: 29, Steps: 64 | Train Loss: 0.0828314 Vali Loss: 0.1534567 Test Loss: 0.1470592
Validation loss decreased (0.153632 --> 0.153457).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 30 cost time: 0.9710202217102051
Epoch: 30, Steps: 64 | Train Loss: 0.0832552 Vali Loss: 0.1553977 Test Loss: 0.1473437
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 31 cost time: 0.9456791877746582
Epoch: 31, Steps: 64 | Train Loss: 0.0827147 Vali Loss: 0.1540082 Test Loss: 0.1473647
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 32 cost time: 0.9349749088287354
Epoch: 32, Steps: 64 | Train Loss: 0.0826722 Vali Loss: 0.1549080 Test Loss: 0.1469095
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 33 cost time: 0.9470877647399902
Epoch: 33, Steps: 64 | Train Loss: 0.0822413 Vali Loss: 0.1543434 Test Loss: 0.1474748
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 34 cost time: 0.9504961967468262
Epoch: 34, Steps: 64 | Train Loss: 0.0822523 Vali Loss: 0.1535420 Test Loss: 0.1476955
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 35 cost time: 0.9493563175201416
Epoch: 35, Steps: 64 | Train Loss: 0.0825495 Vali Loss: 0.1531860 Test Loss: 0.1478301
Validation loss decreased (0.153457 --> 0.153186).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 36 cost time: 0.9539999961853027
Epoch: 36, Steps: 64 | Train Loss: 0.0822199 Vali Loss: 0.1530708 Test Loss: 0.1471658
Validation loss decreased (0.153186 --> 0.153071).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 37 cost time: 0.9696364402770996
Epoch: 37, Steps: 64 | Train Loss: 0.0824834 Vali Loss: 0.1550879 Test Loss: 0.1473290
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 38 cost time: 0.9576561450958252
Epoch: 38, Steps: 64 | Train Loss: 0.0825423 Vali Loss: 0.1529260 Test Loss: 0.1476273
Validation loss decreased (0.153071 --> 0.152926).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 39 cost time: 0.9524726867675781
Epoch: 39, Steps: 64 | Train Loss: 0.0823266 Vali Loss: 0.1533416 Test Loss: 0.1477383
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 40 cost time: 0.9464106559753418
Epoch: 40, Steps: 64 | Train Loss: 0.0823079 Vali Loss: 0.1547904 Test Loss: 0.1470327
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 41 cost time: 0.9043755531311035
Epoch: 41, Steps: 64 | Train Loss: 0.0823010 Vali Loss: 0.1532872 Test Loss: 0.1468437
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 42 cost time: 0.9044616222381592
Epoch: 42, Steps: 64 | Train Loss: 0.0819259 Vali Loss: 0.1540419 Test Loss: 0.1470810
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 43 cost time: 0.908790111541748
Epoch: 43, Steps: 64 | Train Loss: 0.0818645 Vali Loss: 0.1513727 Test Loss: 0.1467772
Validation loss decreased (0.152926 --> 0.151373).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 44 cost time: 0.9107465744018555
Epoch: 44, Steps: 64 | Train Loss: 0.0820614 Vali Loss: 0.1528528 Test Loss: 0.1464039
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 45 cost time: 0.9306316375732422
Epoch: 45, Steps: 64 | Train Loss: 0.0821239 Vali Loss: 0.1528169 Test Loss: 0.1467046
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 46 cost time: 0.9274024963378906
Epoch: 46, Steps: 64 | Train Loss: 0.0816748 Vali Loss: 0.1538531 Test Loss: 0.1470511
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 47 cost time: 0.9534761905670166
Epoch: 47, Steps: 64 | Train Loss: 0.0819770 Vali Loss: 0.1519476 Test Loss: 0.1474874
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 48 cost time: 0.9254190921783447
Epoch: 48, Steps: 64 | Train Loss: 0.0815394 Vali Loss: 0.1529519 Test Loss: 0.1476250
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 49 cost time: 0.9159643650054932
Epoch: 49, Steps: 64 | Train Loss: 0.0819569 Vali Loss: 0.1545212 Test Loss: 0.1461880
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 50 cost time: 0.9498400688171387
Epoch: 50, Steps: 64 | Train Loss: 0.0817775 Vali Loss: 0.1528723 Test Loss: 0.1464696
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 51 cost time: 0.955998420715332
Epoch: 51, Steps: 64 | Train Loss: 0.0819853 Vali Loss: 0.1541121 Test Loss: 0.1464660
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 52 cost time: 0.9449996948242188
Epoch: 52, Steps: 64 | Train Loss: 0.0819898 Vali Loss: 0.1545313 Test Loss: 0.1472551
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 53 cost time: 0.9540286064147949
Epoch: 53, Steps: 64 | Train Loss: 0.0817516 Vali Loss: 0.1543595 Test Loss: 0.1473172
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 54 cost time: 0.9644272327423096
Epoch: 54, Steps: 64 | Train Loss: 0.0816663 Vali Loss: 0.1547571 Test Loss: 0.1470706
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 55 cost time: 0.9604227542877197
Epoch: 55, Steps: 64 | Train Loss: 0.0819988 Vali Loss: 0.1537026 Test Loss: 0.1466915
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 56 cost time: 0.9514584541320801
Epoch: 56, Steps: 64 | Train Loss: 0.0820405 Vali Loss: 0.1540446 Test Loss: 0.1475939
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 57 cost time: 0.9469916820526123
Epoch: 57, Steps: 64 | Train Loss: 0.0816307 Vali Loss: 0.1534028 Test Loss: 0.1483026
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 58 cost time: 0.9467732906341553
Epoch: 58, Steps: 64 | Train Loss: 0.0819027 Vali Loss: 0.1534472 Test Loss: 0.1472429
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 59 cost time: 0.915001392364502
Epoch: 59, Steps: 64 | Train Loss: 0.0817704 Vali Loss: 0.1534003 Test Loss: 0.1467897
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018045425415039062 GB
GPU已分配内存的峰值：0.047453880310058594 GB
Epoch: 60 cost time: 0.91064453125
Epoch: 60, Steps: 64 | Train Loss: 0.0819638 Vali Loss: 0.1533271 Test Loss: 0.1469295
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1467771828174591, mae:0.2824324071407318, rse:0.20391550660133362
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04773855209350586 GB
Epoch: 1 cost time: 2.350684404373169
Epoch: 1, Steps: 64 | Train Loss: 0.9199314 Vali Loss: 2.1272893 Test Loss: 4.1364083
Validation loss decreased (inf --> 2.127289).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 2 cost time: 0.9561765193939209
Epoch: 2, Steps: 64 | Train Loss: 0.6588559 Vali Loss: 0.9810524 Test Loss: 1.6884555
Validation loss decreased (2.127289 --> 0.981052).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 3 cost time: 0.963280200958252
Epoch: 3, Steps: 64 | Train Loss: 0.2414267 Vali Loss: 0.2433350 Test Loss: 0.2050418
Validation loss decreased (0.981052 --> 0.243335).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 4 cost time: 0.9723923206329346
Epoch: 4, Steps: 64 | Train Loss: 0.1095194 Vali Loss: 0.1853066 Test Loss: 0.1595353
Validation loss decreased (0.243335 --> 0.185307).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 5 cost time: 0.9794259071350098
Epoch: 5, Steps: 64 | Train Loss: 0.0998597 Vali Loss: 0.1770738 Test Loss: 0.1549088
Validation loss decreased (0.185307 --> 0.177074).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 6 cost time: 0.9784767627716064
Epoch: 6, Steps: 64 | Train Loss: 0.0952644 Vali Loss: 0.1714828 Test Loss: 0.1522480
Validation loss decreased (0.177074 --> 0.171483).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 7 cost time: 0.9753806591033936
Epoch: 7, Steps: 64 | Train Loss: 0.0930514 Vali Loss: 0.1708215 Test Loss: 0.1515009
Validation loss decreased (0.171483 --> 0.170822).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 8 cost time: 0.9544100761413574
Epoch: 8, Steps: 64 | Train Loss: 0.0915513 Vali Loss: 0.1674439 Test Loss: 0.1508681
Validation loss decreased (0.170822 --> 0.167444).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 9 cost time: 0.9585835933685303
Epoch: 9, Steps: 64 | Train Loss: 0.0899217 Vali Loss: 0.1671395 Test Loss: 0.1510588
Validation loss decreased (0.167444 --> 0.167140).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 10 cost time: 0.9693551063537598
Epoch: 10, Steps: 64 | Train Loss: 0.0889063 Vali Loss: 0.1634649 Test Loss: 0.1509846
Validation loss decreased (0.167140 --> 0.163465).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 11 cost time: 0.9728543758392334
Epoch: 11, Steps: 64 | Train Loss: 0.0874028 Vali Loss: 0.1638571 Test Loss: 0.1505582
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 12 cost time: 0.9891650676727295
Epoch: 12, Steps: 64 | Train Loss: 0.0869451 Vali Loss: 0.1637471 Test Loss: 0.1498756
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 13 cost time: 0.980623722076416
Epoch: 13, Steps: 64 | Train Loss: 0.0860493 Vali Loss: 0.1600355 Test Loss: 0.1503617
Validation loss decreased (0.163465 --> 0.160036).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 14 cost time: 0.975255012512207
Epoch: 14, Steps: 64 | Train Loss: 0.0853979 Vali Loss: 0.1616110 Test Loss: 0.1501303
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 15 cost time: 0.9703836441040039
Epoch: 15, Steps: 64 | Train Loss: 0.0846923 Vali Loss: 0.1606277 Test Loss: 0.1494525
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 16 cost time: 0.9664733409881592
Epoch: 16, Steps: 64 | Train Loss: 0.0845045 Vali Loss: 0.1602859 Test Loss: 0.1501213
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 17 cost time: 0.962416410446167
Epoch: 17, Steps: 64 | Train Loss: 0.0841085 Vali Loss: 0.1582152 Test Loss: 0.1490035
Validation loss decreased (0.160036 --> 0.158215).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 18 cost time: 0.9854555130004883
Epoch: 18, Steps: 64 | Train Loss: 0.0836990 Vali Loss: 0.1598748 Test Loss: 0.1495761
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 19 cost time: 0.9748668670654297
Epoch: 19, Steps: 64 | Train Loss: 0.0832489 Vali Loss: 0.1588839 Test Loss: 0.1495816
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 20 cost time: 0.9627366065979004
Epoch: 20, Steps: 64 | Train Loss: 0.0833021 Vali Loss: 0.1596783 Test Loss: 0.1495084
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 21 cost time: 0.9697566032409668
Epoch: 21, Steps: 64 | Train Loss: 0.0829498 Vali Loss: 0.1601904 Test Loss: 0.1495640
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 22 cost time: 0.9444093704223633
Epoch: 22, Steps: 64 | Train Loss: 0.0830061 Vali Loss: 0.1592000 Test Loss: 0.1491536
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 23 cost time: 0.9496221542358398
Epoch: 23, Steps: 64 | Train Loss: 0.0826842 Vali Loss: 0.1586442 Test Loss: 0.1495013
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 24 cost time: 0.9554576873779297
Epoch: 24, Steps: 64 | Train Loss: 0.0823080 Vali Loss: 0.1599073 Test Loss: 0.1498672
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 25 cost time: 0.9484133720397949
Epoch: 25, Steps: 64 | Train Loss: 0.0823030 Vali Loss: 0.1575754 Test Loss: 0.1492418
Validation loss decreased (0.158215 --> 0.157575).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 26 cost time: 0.9568295478820801
Epoch: 26, Steps: 64 | Train Loss: 0.0821083 Vali Loss: 0.1563243 Test Loss: 0.1493120
Validation loss decreased (0.157575 --> 0.156324).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 27 cost time: 0.9664676189422607
Epoch: 27, Steps: 64 | Train Loss: 0.0816142 Vali Loss: 0.1572069 Test Loss: 0.1488429
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 28 cost time: 0.9674620628356934
Epoch: 28, Steps: 64 | Train Loss: 0.0820175 Vali Loss: 0.1555058 Test Loss: 0.1488327
Validation loss decreased (0.156324 --> 0.155506).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 29 cost time: 0.9848291873931885
Epoch: 29, Steps: 64 | Train Loss: 0.0820295 Vali Loss: 0.1569453 Test Loss: 0.1493891
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 30 cost time: 0.9867615699768066
Epoch: 30, Steps: 64 | Train Loss: 0.0819061 Vali Loss: 0.1571824 Test Loss: 0.1493804
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 31 cost time: 0.9693317413330078
Epoch: 31, Steps: 64 | Train Loss: 0.0818067 Vali Loss: 0.1577668 Test Loss: 0.1489433
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 32 cost time: 0.9616472721099854
Epoch: 32, Steps: 64 | Train Loss: 0.0816008 Vali Loss: 0.1573358 Test Loss: 0.1488518
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 33 cost time: 0.9553840160369873
Epoch: 33, Steps: 64 | Train Loss: 0.0816064 Vali Loss: 0.1559603 Test Loss: 0.1488016
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 34 cost time: 0.9634552001953125
Epoch: 34, Steps: 64 | Train Loss: 0.0816941 Vali Loss: 0.1564526 Test Loss: 0.1492248
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 35 cost time: 0.9834222793579102
Epoch: 35, Steps: 64 | Train Loss: 0.0810393 Vali Loss: 0.1556255 Test Loss: 0.1487145
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 36 cost time: 0.9853990077972412
Epoch: 36, Steps: 64 | Train Loss: 0.0816900 Vali Loss: 0.1536423 Test Loss: 0.1492317
Validation loss decreased (0.155506 --> 0.153642).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 37 cost time: 0.9884378910064697
Epoch: 37, Steps: 64 | Train Loss: 0.0814122 Vali Loss: 0.1540557 Test Loss: 0.1483463
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 38 cost time: 0.9844081401824951
Epoch: 38, Steps: 64 | Train Loss: 0.0813299 Vali Loss: 0.1581846 Test Loss: 0.1491794
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 39 cost time: 0.9834456443786621
Epoch: 39, Steps: 64 | Train Loss: 0.0815088 Vali Loss: 0.1578997 Test Loss: 0.1493807
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 40 cost time: 0.9788608551025391
Epoch: 40, Steps: 64 | Train Loss: 0.0812944 Vali Loss: 0.1572919 Test Loss: 0.1490181
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 41 cost time: 0.9713282585144043
Epoch: 41, Steps: 64 | Train Loss: 0.0813937 Vali Loss: 0.1571276 Test Loss: 0.1487677
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 42 cost time: 0.948652982711792
Epoch: 42, Steps: 64 | Train Loss: 0.0811196 Vali Loss: 0.1557118 Test Loss: 0.1486384
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 43 cost time: 0.9576640129089355
Epoch: 43, Steps: 64 | Train Loss: 0.0811206 Vali Loss: 0.1574094 Test Loss: 0.1490267
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 44 cost time: 0.9724199771881104
Epoch: 44, Steps: 64 | Train Loss: 0.0811649 Vali Loss: 0.1579832 Test Loss: 0.1487812
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 45 cost time: 0.9644548892974854
Epoch: 45, Steps: 64 | Train Loss: 0.0812737 Vali Loss: 0.1561828 Test Loss: 0.1486314
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 46 cost time: 0.9644114971160889
Epoch: 46, Steps: 64 | Train Loss: 0.0812163 Vali Loss: 0.1564723 Test Loss: 0.1490423
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 47 cost time: 0.9638168811798096
Epoch: 47, Steps: 64 | Train Loss: 0.0811394 Vali Loss: 0.1568389 Test Loss: 0.1490576
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 48 cost time: 0.9697599411010742
Epoch: 48, Steps: 64 | Train Loss: 0.0812849 Vali Loss: 0.1564029 Test Loss: 0.1488155
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 49 cost time: 0.9618611335754395
Epoch: 49, Steps: 64 | Train Loss: 0.0812076 Vali Loss: 0.1548118 Test Loss: 0.1491633
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 50 cost time: 0.9579999446868896
Epoch: 50, Steps: 64 | Train Loss: 0.0809838 Vali Loss: 0.1572687 Test Loss: 0.1489482
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 51 cost time: 0.9680323600769043
Epoch: 51, Steps: 64 | Train Loss: 0.0806899 Vali Loss: 0.1562929 Test Loss: 0.1488288
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 52 cost time: 0.9891016483306885
Epoch: 52, Steps: 64 | Train Loss: 0.0810961 Vali Loss: 0.1562209 Test Loss: 0.1485444
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 53 cost time: 0.9823882579803467
Epoch: 53, Steps: 64 | Train Loss: 0.0811350 Vali Loss: 0.1583373 Test Loss: 0.1492058
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 54 cost time: 0.9734148979187012
Epoch: 54, Steps: 64 | Train Loss: 0.0808334 Vali Loss: 0.1577162 Test Loss: 0.1495901
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 55 cost time: 0.9263825416564941
Epoch: 55, Steps: 64 | Train Loss: 0.0809452 Vali Loss: 0.1565747 Test Loss: 0.1484857
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 56 cost time: 0.9606168270111084
Epoch: 56, Steps: 64 | Train Loss: 0.0812544 Vali Loss: 0.1561754 Test Loss: 0.1487093
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 57 cost time: 0.9537758827209473
Epoch: 57, Steps: 64 | Train Loss: 0.0811104 Vali Loss: 0.1567868 Test Loss: 0.1490795
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 58 cost time: 0.9538350105285645
Epoch: 58, Steps: 64 | Train Loss: 0.0807129 Vali Loss: 0.1576979 Test Loss: 0.1491895
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 59 cost time: 0.9493999481201172
Epoch: 59, Steps: 64 | Train Loss: 0.0806991 Vali Loss: 0.1561157 Test Loss: 0.1487790
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018114089965820312 GB
GPU已分配内存的峰值：0.04897022247314453 GB
Epoch: 60 cost time: 0.9536151885986328
Epoch: 60, Steps: 64 | Train Loss: 0.0811355 Vali Loss: 0.1565404 Test Loss: 0.1487655
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1492317020893097, mae:0.29038819670677185, rse:0.20561344921588898
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.045348167419433594 GB
Epoch: 1 cost time: 2.2964227199554443
Epoch: 1, Steps: 64 | Train Loss: 0.9581287 Vali Loss: 1.9119513 Test Loss: 3.5785358
Validation loss decreased (inf --> 1.911951).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 2 cost time: 0.9136488437652588
Epoch: 2, Steps: 64 | Train Loss: 0.6417619 Vali Loss: 0.6340737 Test Loss: 0.9093732
Validation loss decreased (1.911951 --> 0.634074).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 3 cost time: 0.897615909576416
Epoch: 3, Steps: 64 | Train Loss: 0.2879609 Vali Loss: 0.3184544 Test Loss: 0.2742684
Validation loss decreased (0.634074 --> 0.318454).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 4 cost time: 0.9244351387023926
Epoch: 4, Steps: 64 | Train Loss: 0.1929345 Vali Loss: 0.2603426 Test Loss: 0.1994998
Validation loss decreased (0.318454 --> 0.260343).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 5 cost time: 0.887962818145752
Epoch: 5, Steps: 64 | Train Loss: 0.1645539 Vali Loss: 0.2262740 Test Loss: 0.1711353
Validation loss decreased (0.260343 --> 0.226274).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 6 cost time: 0.8712117671966553
Epoch: 6, Steps: 64 | Train Loss: 0.1504424 Vali Loss: 0.2025072 Test Loss: 0.1622174
Validation loss decreased (0.226274 --> 0.202507).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 7 cost time: 0.8798084259033203
Epoch: 7, Steps: 64 | Train Loss: 0.1408470 Vali Loss: 0.1934876 Test Loss: 0.1571635
Validation loss decreased (0.202507 --> 0.193488).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 8 cost time: 0.8854622840881348
Epoch: 8, Steps: 64 | Train Loss: 0.1331680 Vali Loss: 0.1864492 Test Loss: 0.1537558
Validation loss decreased (0.193488 --> 0.186449).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 9 cost time: 0.8776419162750244
Epoch: 9, Steps: 64 | Train Loss: 0.1291096 Vali Loss: 0.1806442 Test Loss: 0.1507638
Validation loss decreased (0.186449 --> 0.180644).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 10 cost time: 0.9083681106567383
Epoch: 10, Steps: 64 | Train Loss: 0.1251661 Vali Loss: 0.1777877 Test Loss: 0.1490473
Validation loss decreased (0.180644 --> 0.177788).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 11 cost time: 0.9234180450439453
Epoch: 11, Steps: 64 | Train Loss: 0.1216759 Vali Loss: 0.1752456 Test Loss: 0.1475196
Validation loss decreased (0.177788 --> 0.175246).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 12 cost time: 0.9344460964202881
Epoch: 12, Steps: 64 | Train Loss: 0.1187216 Vali Loss: 0.1691798 Test Loss: 0.1457230
Validation loss decreased (0.175246 --> 0.169180).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 13 cost time: 0.9312143325805664
Epoch: 13, Steps: 64 | Train Loss: 0.1162449 Vali Loss: 0.1666131 Test Loss: 0.1452997
Validation loss decreased (0.169180 --> 0.166613).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 14 cost time: 0.9237527847290039
Epoch: 14, Steps: 64 | Train Loss: 0.1148788 Vali Loss: 0.1661610 Test Loss: 0.1445265
Validation loss decreased (0.166613 --> 0.166161).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 15 cost time: 0.9310007095336914
Epoch: 15, Steps: 64 | Train Loss: 0.1124589 Vali Loss: 0.1654272 Test Loss: 0.1442951
Validation loss decreased (0.166161 --> 0.165427).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 16 cost time: 0.9146192073822021
Epoch: 16, Steps: 64 | Train Loss: 0.1117137 Vali Loss: 0.1618319 Test Loss: 0.1438165
Validation loss decreased (0.165427 --> 0.161832).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 17 cost time: 0.9108984470367432
Epoch: 17, Steps: 64 | Train Loss: 0.1102142 Vali Loss: 0.1636897 Test Loss: 0.1432047
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 18 cost time: 0.9265134334564209
Epoch: 18, Steps: 64 | Train Loss: 0.1098996 Vali Loss: 0.1613971 Test Loss: 0.1429101
Validation loss decreased (0.161832 --> 0.161397).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 19 cost time: 0.9282517433166504
Epoch: 19, Steps: 64 | Train Loss: 0.1074618 Vali Loss: 0.1609388 Test Loss: 0.1431167
Validation loss decreased (0.161397 --> 0.160939).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 20 cost time: 0.9354832172393799
Epoch: 20, Steps: 64 | Train Loss: 0.1073228 Vali Loss: 0.1588351 Test Loss: 0.1425598
Validation loss decreased (0.160939 --> 0.158835).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 21 cost time: 0.9347677230834961
Epoch: 21, Steps: 64 | Train Loss: 0.1073976 Vali Loss: 0.1579347 Test Loss: 0.1424738
Validation loss decreased (0.158835 --> 0.157935).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 22 cost time: 0.9112184047698975
Epoch: 22, Steps: 64 | Train Loss: 0.1063940 Vali Loss: 0.1570104 Test Loss: 0.1423059
Validation loss decreased (0.157935 --> 0.157010).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 23 cost time: 0.8946332931518555
Epoch: 23, Steps: 64 | Train Loss: 0.1053668 Vali Loss: 0.1580364 Test Loss: 0.1424220
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 24 cost time: 0.8945233821868896
Epoch: 24, Steps: 64 | Train Loss: 0.1051800 Vali Loss: 0.1595220 Test Loss: 0.1427073
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 25 cost time: 0.8866927623748779
Epoch: 25, Steps: 64 | Train Loss: 0.1053770 Vali Loss: 0.1569169 Test Loss: 0.1427218
Validation loss decreased (0.157010 --> 0.156917).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 26 cost time: 0.8894097805023193
Epoch: 26, Steps: 64 | Train Loss: 0.1046282 Vali Loss: 0.1566642 Test Loss: 0.1421946
Validation loss decreased (0.156917 --> 0.156664).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 27 cost time: 0.9083759784698486
Epoch: 27, Steps: 64 | Train Loss: 0.1045112 Vali Loss: 0.1542001 Test Loss: 0.1417522
Validation loss decreased (0.156664 --> 0.154200).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 28 cost time: 0.9090011119842529
Epoch: 28, Steps: 64 | Train Loss: 0.1033168 Vali Loss: 0.1568542 Test Loss: 0.1418778
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 29 cost time: 0.9146409034729004
Epoch: 29, Steps: 64 | Train Loss: 0.1038558 Vali Loss: 0.1553822 Test Loss: 0.1419099
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 30 cost time: 0.9033942222595215
Epoch: 30, Steps: 64 | Train Loss: 0.1033188 Vali Loss: 0.1566442 Test Loss: 0.1421441
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 31 cost time: 0.9160313606262207
Epoch: 31, Steps: 64 | Train Loss: 0.1030921 Vali Loss: 0.1555621 Test Loss: 0.1418148
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 32 cost time: 0.9170730113983154
Epoch: 32, Steps: 64 | Train Loss: 0.1027567 Vali Loss: 0.1561165 Test Loss: 0.1420970
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 33 cost time: 0.912909746170044
Epoch: 33, Steps: 64 | Train Loss: 0.1022725 Vali Loss: 0.1564450 Test Loss: 0.1419410
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 34 cost time: 0.9174139499664307
Epoch: 34, Steps: 64 | Train Loss: 0.1024806 Vali Loss: 0.1551784 Test Loss: 0.1415204
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 35 cost time: 0.9229998588562012
Epoch: 35, Steps: 64 | Train Loss: 0.1024848 Vali Loss: 0.1544966 Test Loss: 0.1414553
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 36 cost time: 0.9483785629272461
Epoch: 36, Steps: 64 | Train Loss: 0.1011768 Vali Loss: 0.1550472 Test Loss: 0.1419790
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 37 cost time: 0.9360661506652832
Epoch: 37, Steps: 64 | Train Loss: 0.1022663 Vali Loss: 0.1555174 Test Loss: 0.1415757
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 38 cost time: 0.9444539546966553
Epoch: 38, Steps: 64 | Train Loss: 0.1017383 Vali Loss: 0.1542636 Test Loss: 0.1411775
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 39 cost time: 0.9433689117431641
Epoch: 39, Steps: 64 | Train Loss: 0.1020080 Vali Loss: 0.1544254 Test Loss: 0.1415306
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 40 cost time: 0.9254047870635986
Epoch: 40, Steps: 64 | Train Loss: 0.1015890 Vali Loss: 0.1548461 Test Loss: 0.1416100
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 41 cost time: 0.8971953392028809
Epoch: 41, Steps: 64 | Train Loss: 0.1016920 Vali Loss: 0.1549238 Test Loss: 0.1417752
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 42 cost time: 0.8880002498626709
Epoch: 42, Steps: 64 | Train Loss: 0.1011348 Vali Loss: 0.1528161 Test Loss: 0.1410666
Validation loss decreased (0.154200 --> 0.152816).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 43 cost time: 0.8946459293365479
Epoch: 43, Steps: 64 | Train Loss: 0.1017659 Vali Loss: 0.1542831 Test Loss: 0.1415759
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 44 cost time: 0.8864073753356934
Epoch: 44, Steps: 64 | Train Loss: 0.1011512 Vali Loss: 0.1547407 Test Loss: 0.1414488
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 45 cost time: 0.9111504554748535
Epoch: 45, Steps: 64 | Train Loss: 0.1015664 Vali Loss: 0.1534233 Test Loss: 0.1416649
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 46 cost time: 0.908496618270874
Epoch: 46, Steps: 64 | Train Loss: 0.1012696 Vali Loss: 0.1533372 Test Loss: 0.1411305
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 47 cost time: 0.9087738990783691
Epoch: 47, Steps: 64 | Train Loss: 0.1013191 Vali Loss: 0.1550488 Test Loss: 0.1415844
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 48 cost time: 0.9070000648498535
Epoch: 48, Steps: 64 | Train Loss: 0.1007472 Vali Loss: 0.1543927 Test Loss: 0.1408014
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 49 cost time: 0.8950023651123047
Epoch: 49, Steps: 64 | Train Loss: 0.1009533 Vali Loss: 0.1532869 Test Loss: 0.1411512
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 50 cost time: 0.8956735134124756
Epoch: 50, Steps: 64 | Train Loss: 0.1010608 Vali Loss: 0.1533911 Test Loss: 0.1417070
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 51 cost time: 0.8864479064941406
Epoch: 51, Steps: 64 | Train Loss: 0.1007783 Vali Loss: 0.1542807 Test Loss: 0.1412142
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 52 cost time: 0.9224309921264648
Epoch: 52, Steps: 64 | Train Loss: 0.1013396 Vali Loss: 0.1533220 Test Loss: 0.1410310
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 53 cost time: 0.9185240268707275
Epoch: 53, Steps: 64 | Train Loss: 0.1009319 Vali Loss: 0.1556697 Test Loss: 0.1415265
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 54 cost time: 0.9367527961730957
Epoch: 54, Steps: 64 | Train Loss: 0.1009129 Vali Loss: 0.1529066 Test Loss: 0.1410671
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 55 cost time: 0.9369993209838867
Epoch: 55, Steps: 64 | Train Loss: 0.1015479 Vali Loss: 0.1553756 Test Loss: 0.1412314
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 56 cost time: 0.9316301345825195
Epoch: 56, Steps: 64 | Train Loss: 0.1005983 Vali Loss: 0.1532750 Test Loss: 0.1406064
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 57 cost time: 0.9354033470153809
Epoch: 57, Steps: 64 | Train Loss: 0.1004460 Vali Loss: 0.1546324 Test Loss: 0.1413791
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 58 cost time: 0.9154088497161865
Epoch: 58, Steps: 64 | Train Loss: 0.1005059 Vali Loss: 0.1535393 Test Loss: 0.1410841
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 59 cost time: 0.9158756732940674
Epoch: 59, Steps: 64 | Train Loss: 0.1007551 Vali Loss: 0.1522234 Test Loss: 0.1411920
Validation loss decreased (0.152816 --> 0.152223).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01792144775390625 GB
GPU已分配内存的峰值：0.046056270599365234 GB
Epoch: 60 cost time: 0.9173464775085449
Epoch: 60, Steps: 64 | Train Loss: 0.1009221 Vali Loss: 0.1531656 Test Loss: 0.1411420
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1411919891834259, mae:0.2752015292644501, rse:0.1999981552362442
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04678010940551758 GB
Epoch: 1 cost time: 2.3352949619293213
Epoch: 1, Steps: 64 | Train Loss: 0.8381849 Vali Loss: 1.8488617 Test Loss: 3.5770249
Validation loss decreased (inf --> 1.848862).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 2 cost time: 0.9610459804534912
Epoch: 2, Steps: 64 | Train Loss: 0.5140985 Vali Loss: 0.5821481 Test Loss: 0.8301023
Validation loss decreased (1.848862 --> 0.582148).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 3 cost time: 0.9597837924957275
Epoch: 3, Steps: 64 | Train Loss: 0.1882773 Vali Loss: 0.2651179 Test Loss: 0.2123427
Validation loss decreased (0.582148 --> 0.265118).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 4 cost time: 0.9457869529724121
Epoch: 4, Steps: 64 | Train Loss: 0.1181788 Vali Loss: 0.2007787 Test Loss: 0.1570257
Validation loss decreased (0.265118 --> 0.200779).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 5 cost time: 0.9149985313415527
Epoch: 5, Steps: 64 | Train Loss: 0.1065933 Vali Loss: 0.1832637 Test Loss: 0.1483991
Validation loss decreased (0.200779 --> 0.183264).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 6 cost time: 0.910642147064209
Epoch: 6, Steps: 64 | Train Loss: 0.1007612 Vali Loss: 0.1735708 Test Loss: 0.1440615
Validation loss decreased (0.183264 --> 0.173571).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 7 cost time: 0.9216294288635254
Epoch: 7, Steps: 64 | Train Loss: 0.0974384 Vali Loss: 0.1674518 Test Loss: 0.1426113
Validation loss decreased (0.173571 --> 0.167452).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 8 cost time: 0.9080939292907715
Epoch: 8, Steps: 64 | Train Loss: 0.0947522 Vali Loss: 0.1637457 Test Loss: 0.1409780
Validation loss decreased (0.167452 --> 0.163746).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 9 cost time: 0.9263772964477539
Epoch: 9, Steps: 64 | Train Loss: 0.0923885 Vali Loss: 0.1603902 Test Loss: 0.1407481
Validation loss decreased (0.163746 --> 0.160390).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 10 cost time: 0.9463722705841064
Epoch: 10, Steps: 64 | Train Loss: 0.0912651 Vali Loss: 0.1583585 Test Loss: 0.1401236
Validation loss decreased (0.160390 --> 0.158358).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 11 cost time: 0.9675087928771973
Epoch: 11, Steps: 64 | Train Loss: 0.0895456 Vali Loss: 0.1580969 Test Loss: 0.1405135
Validation loss decreased (0.158358 --> 0.158097).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 12 cost time: 0.9681930541992188
Epoch: 12, Steps: 64 | Train Loss: 0.0884193 Vali Loss: 0.1553437 Test Loss: 0.1391790
Validation loss decreased (0.158097 --> 0.155344).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 13 cost time: 0.9660003185272217
Epoch: 13, Steps: 64 | Train Loss: 0.0877031 Vali Loss: 0.1516617 Test Loss: 0.1394274
Validation loss decreased (0.155344 --> 0.151662).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 14 cost time: 0.956998348236084
Epoch: 14, Steps: 64 | Train Loss: 0.0866071 Vali Loss: 0.1548164 Test Loss: 0.1392805
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 15 cost time: 0.9576430320739746
Epoch: 15, Steps: 64 | Train Loss: 0.0858172 Vali Loss: 0.1527001 Test Loss: 0.1391173
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 16 cost time: 0.9523806571960449
Epoch: 16, Steps: 64 | Train Loss: 0.0852871 Vali Loss: 0.1497627 Test Loss: 0.1382258
Validation loss decreased (0.151662 --> 0.149763).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 17 cost time: 0.9634339809417725
Epoch: 17, Steps: 64 | Train Loss: 0.0847904 Vali Loss: 0.1516064 Test Loss: 0.1391185
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 18 cost time: 0.964242696762085
Epoch: 18, Steps: 64 | Train Loss: 0.0841446 Vali Loss: 0.1479113 Test Loss: 0.1384662
Validation loss decreased (0.149763 --> 0.147911).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 19 cost time: 0.9634144306182861
Epoch: 19, Steps: 64 | Train Loss: 0.0841576 Vali Loss: 0.1502205 Test Loss: 0.1392030
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 20 cost time: 0.9654631614685059
Epoch: 20, Steps: 64 | Train Loss: 0.0836728 Vali Loss: 0.1506837 Test Loss: 0.1384158
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 21 cost time: 0.9397659301757812
Epoch: 21, Steps: 64 | Train Loss: 0.0831833 Vali Loss: 0.1487286 Test Loss: 0.1386654
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 22 cost time: 0.9130003452301025
Epoch: 22, Steps: 64 | Train Loss: 0.0830617 Vali Loss: 0.1486172 Test Loss: 0.1391930
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 23 cost time: 0.9216539859771729
Epoch: 23, Steps: 64 | Train Loss: 0.0826264 Vali Loss: 0.1472777 Test Loss: 0.1379132
Validation loss decreased (0.147911 --> 0.147278).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 24 cost time: 0.9206466674804688
Epoch: 24, Steps: 64 | Train Loss: 0.0825071 Vali Loss: 0.1474039 Test Loss: 0.1382297
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 25 cost time: 0.915428876876831
Epoch: 25, Steps: 64 | Train Loss: 0.0821117 Vali Loss: 0.1461119 Test Loss: 0.1379235
Validation loss decreased (0.147278 --> 0.146112).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 26 cost time: 0.9239275455474854
Epoch: 26, Steps: 64 | Train Loss: 0.0821402 Vali Loss: 0.1473671 Test Loss: 0.1381698
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 27 cost time: 0.9643735885620117
Epoch: 27, Steps: 64 | Train Loss: 0.0823276 Vali Loss: 0.1461097 Test Loss: 0.1380249
Validation loss decreased (0.146112 --> 0.146110).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 28 cost time: 0.9403750896453857
Epoch: 28, Steps: 64 | Train Loss: 0.0818049 Vali Loss: 0.1470348 Test Loss: 0.1387620
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 29 cost time: 0.9397680759429932
Epoch: 29, Steps: 64 | Train Loss: 0.0810481 Vali Loss: 0.1441687 Test Loss: 0.1378842
Validation loss decreased (0.146110 --> 0.144169).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 30 cost time: 0.9448156356811523
Epoch: 30, Steps: 64 | Train Loss: 0.0813252 Vali Loss: 0.1465747 Test Loss: 0.1380178
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 31 cost time: 0.9526393413543701
Epoch: 31, Steps: 64 | Train Loss: 0.0814641 Vali Loss: 0.1458247 Test Loss: 0.1380007
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 32 cost time: 0.9463927745819092
Epoch: 32, Steps: 64 | Train Loss: 0.0811217 Vali Loss: 0.1456170 Test Loss: 0.1380582
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 33 cost time: 0.9523203372955322
Epoch: 33, Steps: 64 | Train Loss: 0.0814196 Vali Loss: 0.1461333 Test Loss: 0.1387766
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 34 cost time: 0.9535961151123047
Epoch: 34, Steps: 64 | Train Loss: 0.0808833 Vali Loss: 0.1434702 Test Loss: 0.1371941
Validation loss decreased (0.144169 --> 0.143470).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 35 cost time: 0.9710302352905273
Epoch: 35, Steps: 64 | Train Loss: 0.0808480 Vali Loss: 0.1451970 Test Loss: 0.1377635
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 36 cost time: 0.995307207107544
Epoch: 36, Steps: 64 | Train Loss: 0.0806869 Vali Loss: 0.1447683 Test Loss: 0.1379673
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 37 cost time: 0.9668772220611572
Epoch: 37, Steps: 64 | Train Loss: 0.0806500 Vali Loss: 0.1429145 Test Loss: 0.1380654
Validation loss decreased (0.143470 --> 0.142915).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 38 cost time: 0.9632301330566406
Epoch: 38, Steps: 64 | Train Loss: 0.0806494 Vali Loss: 0.1467318 Test Loss: 0.1391787
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 39 cost time: 0.9616162776947021
Epoch: 39, Steps: 64 | Train Loss: 0.0804564 Vali Loss: 0.1449920 Test Loss: 0.1385696
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 40 cost time: 0.9524753093719482
Epoch: 40, Steps: 64 | Train Loss: 0.0801845 Vali Loss: 0.1443415 Test Loss: 0.1382039
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 41 cost time: 0.9366536140441895
Epoch: 41, Steps: 64 | Train Loss: 0.0805482 Vali Loss: 0.1457288 Test Loss: 0.1384671
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 42 cost time: 0.9074304103851318
Epoch: 42, Steps: 64 | Train Loss: 0.0804997 Vali Loss: 0.1469202 Test Loss: 0.1385573
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 43 cost time: 0.9154109954833984
Epoch: 43, Steps: 64 | Train Loss: 0.0804618 Vali Loss: 0.1442576 Test Loss: 0.1371891
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 44 cost time: 0.938518762588501
Epoch: 44, Steps: 64 | Train Loss: 0.0803391 Vali Loss: 0.1460628 Test Loss: 0.1388008
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 45 cost time: 0.9313738346099854
Epoch: 45, Steps: 64 | Train Loss: 0.0802112 Vali Loss: 0.1445528 Test Loss: 0.1375269
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 46 cost time: 0.9338741302490234
Epoch: 46, Steps: 64 | Train Loss: 0.0802829 Vali Loss: 0.1445396 Test Loss: 0.1384931
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 47 cost time: 0.9094443321228027
Epoch: 47, Steps: 64 | Train Loss: 0.0804951 Vali Loss: 0.1437038 Test Loss: 0.1377580
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 48 cost time: 0.9136390686035156
Epoch: 48, Steps: 64 | Train Loss: 0.0804392 Vali Loss: 0.1426159 Test Loss: 0.1377167
Validation loss decreased (0.142915 --> 0.142616).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 49 cost time: 0.9134645462036133
Epoch: 49, Steps: 64 | Train Loss: 0.0799092 Vali Loss: 0.1448235 Test Loss: 0.1382951
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 50 cost time: 0.9461066722869873
Epoch: 50, Steps: 64 | Train Loss: 0.0799487 Vali Loss: 0.1441334 Test Loss: 0.1388711
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 51 cost time: 0.9513766765594482
Epoch: 51, Steps: 64 | Train Loss: 0.0808333 Vali Loss: 0.1453489 Test Loss: 0.1381379
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 52 cost time: 0.9542732238769531
Epoch: 52, Steps: 64 | Train Loss: 0.0800215 Vali Loss: 0.1437289 Test Loss: 0.1378200
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 53 cost time: 0.9648334980010986
Epoch: 53, Steps: 64 | Train Loss: 0.0799796 Vali Loss: 0.1443165 Test Loss: 0.1379510
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 54 cost time: 0.962749719619751
Epoch: 54, Steps: 64 | Train Loss: 0.0803759 Vali Loss: 0.1440822 Test Loss: 0.1376446
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 55 cost time: 0.9717912673950195
Epoch: 55, Steps: 64 | Train Loss: 0.0802748 Vali Loss: 0.1435738 Test Loss: 0.1380123
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 56 cost time: 0.9616539478302002
Epoch: 56, Steps: 64 | Train Loss: 0.0802319 Vali Loss: 0.1451857 Test Loss: 0.1384262
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 57 cost time: 0.9684255123138428
Epoch: 57, Steps: 64 | Train Loss: 0.0804266 Vali Loss: 0.1444751 Test Loss: 0.1377995
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 58 cost time: 0.9603569507598877
Epoch: 58, Steps: 64 | Train Loss: 0.0799626 Vali Loss: 0.1438569 Test Loss: 0.1375827
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 59 cost time: 0.9343481063842773
Epoch: 59, Steps: 64 | Train Loss: 0.0800580 Vali Loss: 0.1435589 Test Loss: 0.1387500
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0180511474609375 GB
GPU已分配内存的峰值：0.04761838912963867 GB
Epoch: 60 cost time: 0.9060044288635254
Epoch: 60, Steps: 64 | Train Loss: 0.0799568 Vali Loss: 0.1450561 Test Loss: 0.1386856
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1377166360616684, mae:0.2688995599746704, rse:0.1975214034318924
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04790019989013672 GB
Epoch: 1 cost time: 2.3758678436279297
Epoch: 1, Steps: 64 | Train Loss: 0.7724522 Vali Loss: 1.7884316 Test Loss: 3.3985858
Validation loss decreased (inf --> 1.788432).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 2 cost time: 0.9825005531311035
Epoch: 2, Steps: 64 | Train Loss: 0.5140557 Vali Loss: 0.5980608 Test Loss: 0.8779214
Validation loss decreased (1.788432 --> 0.598061).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 3 cost time: 0.9617640972137451
Epoch: 3, Steps: 64 | Train Loss: 0.1705697 Vali Loss: 0.2244850 Test Loss: 0.1677455
Validation loss decreased (0.598061 --> 0.224485).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 4 cost time: 0.9730045795440674
Epoch: 4, Steps: 64 | Train Loss: 0.1043851 Vali Loss: 0.1923438 Test Loss: 0.1527985
Validation loss decreased (0.224485 --> 0.192344).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 5 cost time: 0.9618062973022461
Epoch: 5, Steps: 64 | Train Loss: 0.0967045 Vali Loss: 0.1747342 Test Loss: 0.1447183
Validation loss decreased (0.192344 --> 0.174734).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 6 cost time: 0.974759578704834
Epoch: 6, Steps: 64 | Train Loss: 0.0922100 Vali Loss: 0.1682551 Test Loss: 0.1426451
Validation loss decreased (0.174734 --> 0.168255).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 7 cost time: 0.9830014705657959
Epoch: 7, Steps: 64 | Train Loss: 0.0897968 Vali Loss: 0.1631767 Test Loss: 0.1416661
Validation loss decreased (0.168255 --> 0.163177).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 8 cost time: 0.9590001106262207
Epoch: 8, Steps: 64 | Train Loss: 0.0878180 Vali Loss: 0.1581960 Test Loss: 0.1406587
Validation loss decreased (0.163177 --> 0.158196).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 9 cost time: 0.9586379528045654
Epoch: 9, Steps: 64 | Train Loss: 0.0863243 Vali Loss: 0.1576788 Test Loss: 0.1400137
Validation loss decreased (0.158196 --> 0.157679).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 10 cost time: 0.980224609375
Epoch: 10, Steps: 64 | Train Loss: 0.0848106 Vali Loss: 0.1541005 Test Loss: 0.1392254
Validation loss decreased (0.157679 --> 0.154100).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 11 cost time: 0.9923810958862305
Epoch: 11, Steps: 64 | Train Loss: 0.0836493 Vali Loss: 0.1536915 Test Loss: 0.1381979
Validation loss decreased (0.154100 --> 0.153692).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 12 cost time: 0.9954593181610107
Epoch: 12, Steps: 64 | Train Loss: 0.0826648 Vali Loss: 0.1513538 Test Loss: 0.1378476
Validation loss decreased (0.153692 --> 0.151354).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 13 cost time: 0.9834823608398438
Epoch: 13, Steps: 64 | Train Loss: 0.0821371 Vali Loss: 0.1514435 Test Loss: 0.1378964
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 14 cost time: 0.978388786315918
Epoch: 14, Steps: 64 | Train Loss: 0.0816753 Vali Loss: 0.1482812 Test Loss: 0.1368435
Validation loss decreased (0.151354 --> 0.148281).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 15 cost time: 0.9885687828063965
Epoch: 15, Steps: 64 | Train Loss: 0.0811029 Vali Loss: 0.1478819 Test Loss: 0.1363457
Validation loss decreased (0.148281 --> 0.147882).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 16 cost time: 0.98150634765625
Epoch: 16, Steps: 64 | Train Loss: 0.0803293 Vali Loss: 0.1469095 Test Loss: 0.1366352
Validation loss decreased (0.147882 --> 0.146910).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 17 cost time: 0.9877498149871826
Epoch: 17, Steps: 64 | Train Loss: 0.0799782 Vali Loss: 0.1453322 Test Loss: 0.1366700
Validation loss decreased (0.146910 --> 0.145332).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 18 cost time: 1.0092616081237793
Epoch: 18, Steps: 64 | Train Loss: 0.0791220 Vali Loss: 0.1456527 Test Loss: 0.1362757
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 19 cost time: 0.9670004844665527
Epoch: 19, Steps: 64 | Train Loss: 0.0793350 Vali Loss: 0.1439937 Test Loss: 0.1361016
Validation loss decreased (0.145332 --> 0.143994).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 20 cost time: 0.961127758026123
Epoch: 20, Steps: 64 | Train Loss: 0.0788880 Vali Loss: 0.1425530 Test Loss: 0.1358625
Validation loss decreased (0.143994 --> 0.142553).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 21 cost time: 0.9676437377929688
Epoch: 21, Steps: 64 | Train Loss: 0.0787163 Vali Loss: 0.1411568 Test Loss: 0.1358048
Validation loss decreased (0.142553 --> 0.141157).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 22 cost time: 0.9476642608642578
Epoch: 22, Steps: 64 | Train Loss: 0.0782804 Vali Loss: 0.1407105 Test Loss: 0.1357847
Validation loss decreased (0.141157 --> 0.140711).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 23 cost time: 0.9474635124206543
Epoch: 23, Steps: 64 | Train Loss: 0.0777380 Vali Loss: 0.1418371 Test Loss: 0.1355746
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 24 cost time: 0.9554586410522461
Epoch: 24, Steps: 64 | Train Loss: 0.0784605 Vali Loss: 0.1415336 Test Loss: 0.1354189
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 25 cost time: 0.9414458274841309
Epoch: 25, Steps: 64 | Train Loss: 0.0776856 Vali Loss: 0.1420929 Test Loss: 0.1355430
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 26 cost time: 0.9604687690734863
Epoch: 26, Steps: 64 | Train Loss: 0.0773540 Vali Loss: 0.1383769 Test Loss: 0.1350190
Validation loss decreased (0.140711 --> 0.138377).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 27 cost time: 0.965761661529541
Epoch: 27, Steps: 64 | Train Loss: 0.0774628 Vali Loss: 0.1410722 Test Loss: 0.1353080
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 28 cost time: 0.965001106262207
Epoch: 28, Steps: 64 | Train Loss: 0.0771219 Vali Loss: 0.1413626 Test Loss: 0.1355114
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 29 cost time: 0.9849982261657715
Epoch: 29, Steps: 64 | Train Loss: 0.0772018 Vali Loss: 0.1403408 Test Loss: 0.1346364
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 30 cost time: 0.9792602062225342
Epoch: 30, Steps: 64 | Train Loss: 0.0769646 Vali Loss: 0.1404744 Test Loss: 0.1355025
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 31 cost time: 0.9830830097198486
Epoch: 31, Steps: 64 | Train Loss: 0.0768302 Vali Loss: 0.1387740 Test Loss: 0.1346921
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 32 cost time: 0.9763562679290771
Epoch: 32, Steps: 64 | Train Loss: 0.0767745 Vali Loss: 0.1396465 Test Loss: 0.1350536
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 33 cost time: 0.973684549331665
Epoch: 33, Steps: 64 | Train Loss: 0.0772765 Vali Loss: 0.1389794 Test Loss: 0.1347167
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 34 cost time: 0.999356746673584
Epoch: 34, Steps: 64 | Train Loss: 0.0767488 Vali Loss: 0.1400944 Test Loss: 0.1354354
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 35 cost time: 0.993415355682373
Epoch: 35, Steps: 64 | Train Loss: 0.0767612 Vali Loss: 0.1388979 Test Loss: 0.1348856
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 36 cost time: 0.9904394149780273
Epoch: 36, Steps: 64 | Train Loss: 0.0770425 Vali Loss: 0.1400102 Test Loss: 0.1350625
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 37 cost time: 0.9978716373443604
Epoch: 37, Steps: 64 | Train Loss: 0.0765762 Vali Loss: 0.1389898 Test Loss: 0.1356093
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 38 cost time: 0.9897289276123047
Epoch: 38, Steps: 64 | Train Loss: 0.0767541 Vali Loss: 0.1401405 Test Loss: 0.1354285
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 39 cost time: 0.988999605178833
Epoch: 39, Steps: 64 | Train Loss: 0.0770048 Vali Loss: 0.1377521 Test Loss: 0.1345408
Validation loss decreased (0.138377 --> 0.137752).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 40 cost time: 0.9886109828948975
Epoch: 40, Steps: 64 | Train Loss: 0.0762731 Vali Loss: 0.1378688 Test Loss: 0.1349571
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 41 cost time: 0.9536328315734863
Epoch: 41, Steps: 64 | Train Loss: 0.0768407 Vali Loss: 0.1396565 Test Loss: 0.1354108
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 42 cost time: 0.9494750499725342
Epoch: 42, Steps: 64 | Train Loss: 0.0765126 Vali Loss: 0.1382358 Test Loss: 0.1343262
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 43 cost time: 0.985480785369873
Epoch: 43, Steps: 64 | Train Loss: 0.0765623 Vali Loss: 0.1389244 Test Loss: 0.1353059
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 44 cost time: 0.989436149597168
Epoch: 44, Steps: 64 | Train Loss: 0.0764184 Vali Loss: 0.1380343 Test Loss: 0.1344858
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 45 cost time: 0.961378812789917
Epoch: 45, Steps: 64 | Train Loss: 0.0759469 Vali Loss: 0.1375753 Test Loss: 0.1350828
Validation loss decreased (0.137752 --> 0.137575).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 46 cost time: 0.9603989124298096
Epoch: 46, Steps: 64 | Train Loss: 0.0765627 Vali Loss: 0.1386552 Test Loss: 0.1352133
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 47 cost time: 0.9474270343780518
Epoch: 47, Steps: 64 | Train Loss: 0.0764325 Vali Loss: 0.1380609 Test Loss: 0.1351472
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 48 cost time: 0.9701182842254639
Epoch: 48, Steps: 64 | Train Loss: 0.0763965 Vali Loss: 0.1395272 Test Loss: 0.1349976
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 49 cost time: 0.9880020618438721
Epoch: 49, Steps: 64 | Train Loss: 0.0763737 Vali Loss: 0.1396844 Test Loss: 0.1349349
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 50 cost time: 0.9790012836456299
Epoch: 50, Steps: 64 | Train Loss: 0.0764767 Vali Loss: 0.1384359 Test Loss: 0.1344942
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 51 cost time: 1.0006392002105713
Epoch: 51, Steps: 64 | Train Loss: 0.0765312 Vali Loss: 0.1383563 Test Loss: 0.1344099
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 52 cost time: 0.9997391700744629
Epoch: 52, Steps: 64 | Train Loss: 0.0760133 Vali Loss: 0.1389409 Test Loss: 0.1347902
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 53 cost time: 1.0007469654083252
Epoch: 53, Steps: 64 | Train Loss: 0.0766313 Vali Loss: 0.1382231 Test Loss: 0.1346936
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 54 cost time: 0.9765968322753906
Epoch: 54, Steps: 64 | Train Loss: 0.0765858 Vali Loss: 0.1383484 Test Loss: 0.1354267
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 55 cost time: 0.9733829498291016
Epoch: 55, Steps: 64 | Train Loss: 0.0765738 Vali Loss: 0.1358185 Test Loss: 0.1342276
Validation loss decreased (0.137575 --> 0.135819).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 56 cost time: 0.9774248600006104
Epoch: 56, Steps: 64 | Train Loss: 0.0761977 Vali Loss: 0.1383236 Test Loss: 0.1349053
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 57 cost time: 0.9593942165374756
Epoch: 57, Steps: 64 | Train Loss: 0.0762820 Vali Loss: 0.1362067 Test Loss: 0.1349413
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 58 cost time: 0.9557452201843262
Epoch: 58, Steps: 64 | Train Loss: 0.0764301 Vali Loss: 0.1378873 Test Loss: 0.1348493
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 59 cost time: 0.9657766819000244
Epoch: 59, Steps: 64 | Train Loss: 0.0759890 Vali Loss: 0.1385497 Test Loss: 0.1347362
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01811981201171875 GB
GPU已分配内存的峰值：0.04913473129272461 GB
Epoch: 60 cost time: 0.9683172702789307
Epoch: 60, Steps: 64 | Train Loss: 0.0763725 Vali Loss: 0.1383788 Test Loss: 0.1352164
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13422755897045135, mae:0.265139102935791, rse:0.19500324130058289
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.045510292053222656 GB
Epoch: 1 cost time: 2.309807538986206
Epoch: 1, Steps: 64 | Train Loss: 1.0568958 Vali Loss: 2.1618576 Test Loss: 4.1273112
Validation loss decreased (inf --> 2.161858).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 2 cost time: 0.929999828338623
Epoch: 2, Steps: 64 | Train Loss: 0.6920951 Vali Loss: 0.7728375 Test Loss: 1.2052621
Validation loss decreased (2.161858 --> 0.772838).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 3 cost time: 0.9189999103546143
Epoch: 3, Steps: 64 | Train Loss: 0.3311644 Vali Loss: 0.4106233 Test Loss: 0.4777426
Validation loss decreased (0.772838 --> 0.410623).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 4 cost time: 0.9176106452941895
Epoch: 4, Steps: 64 | Train Loss: 0.2087356 Vali Loss: 0.2709865 Test Loss: 0.2496123
Validation loss decreased (0.410623 --> 0.270986).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 5 cost time: 0.8953802585601807
Epoch: 5, Steps: 64 | Train Loss: 0.1627609 Vali Loss: 0.2239728 Test Loss: 0.1837716
Validation loss decreased (0.270986 --> 0.223973).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 6 cost time: 0.8880321979522705
Epoch: 6, Steps: 64 | Train Loss: 0.1445672 Vali Loss: 0.2027339 Test Loss: 0.1619766
Validation loss decreased (0.223973 --> 0.202734).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 7 cost time: 0.9120604991912842
Epoch: 7, Steps: 64 | Train Loss: 0.1351247 Vali Loss: 0.1908388 Test Loss: 0.1532325
Validation loss decreased (0.202734 --> 0.190839).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 8 cost time: 0.88844895362854
Epoch: 8, Steps: 64 | Train Loss: 0.1288891 Vali Loss: 0.1844696 Test Loss: 0.1476800
Validation loss decreased (0.190839 --> 0.184470).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 9 cost time: 0.9023642539978027
Epoch: 9, Steps: 64 | Train Loss: 0.1248241 Vali Loss: 0.1829461 Test Loss: 0.1456666
Validation loss decreased (0.184470 --> 0.182946).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 10 cost time: 0.920647382736206
Epoch: 10, Steps: 64 | Train Loss: 0.1213842 Vali Loss: 0.1788328 Test Loss: 0.1439477
Validation loss decreased (0.182946 --> 0.178833).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 11 cost time: 0.942002534866333
Epoch: 11, Steps: 64 | Train Loss: 0.1190070 Vali Loss: 0.1733623 Test Loss: 0.1429328
Validation loss decreased (0.178833 --> 0.173362).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 12 cost time: 0.933417797088623
Epoch: 12, Steps: 64 | Train Loss: 0.1163086 Vali Loss: 0.1744397 Test Loss: 0.1421281
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 13 cost time: 0.9401969909667969
Epoch: 13, Steps: 64 | Train Loss: 0.1151250 Vali Loss: 0.1732371 Test Loss: 0.1418786
Validation loss decreased (0.173362 --> 0.173237).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 14 cost time: 0.9495642185211182
Epoch: 14, Steps: 64 | Train Loss: 0.1136272 Vali Loss: 0.1723006 Test Loss: 0.1414854
Validation loss decreased (0.173237 --> 0.172301).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 15 cost time: 0.9153802394866943
Epoch: 15, Steps: 64 | Train Loss: 0.1122186 Vali Loss: 0.1713036 Test Loss: 0.1412250
Validation loss decreased (0.172301 --> 0.171304).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 16 cost time: 0.9157266616821289
Epoch: 16, Steps: 64 | Train Loss: 0.1111131 Vali Loss: 0.1681678 Test Loss: 0.1405013
Validation loss decreased (0.171304 --> 0.168168).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 17 cost time: 0.929999589920044
Epoch: 17, Steps: 64 | Train Loss: 0.1106693 Vali Loss: 0.1673418 Test Loss: 0.1405131
Validation loss decreased (0.168168 --> 0.167342).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 18 cost time: 0.8966195583343506
Epoch: 18, Steps: 64 | Train Loss: 0.1091033 Vali Loss: 0.1683015 Test Loss: 0.1404399
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 19 cost time: 0.9334604740142822
Epoch: 19, Steps: 64 | Train Loss: 0.1085760 Vali Loss: 0.1659411 Test Loss: 0.1406555
Validation loss decreased (0.167342 --> 0.165941).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 20 cost time: 0.9374468326568604
Epoch: 20, Steps: 64 | Train Loss: 0.1077011 Vali Loss: 0.1658402 Test Loss: 0.1399381
Validation loss decreased (0.165941 --> 0.165840).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 21 cost time: 0.9214367866516113
Epoch: 21, Steps: 64 | Train Loss: 0.1066616 Vali Loss: 0.1643823 Test Loss: 0.1395031
Validation loss decreased (0.165840 --> 0.164382).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 22 cost time: 0.910886287689209
Epoch: 22, Steps: 64 | Train Loss: 0.1066279 Vali Loss: 0.1657567 Test Loss: 0.1395146
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 23 cost time: 0.8894085884094238
Epoch: 23, Steps: 64 | Train Loss: 0.1055626 Vali Loss: 0.1661665 Test Loss: 0.1402053
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 24 cost time: 0.9069998264312744
Epoch: 24, Steps: 64 | Train Loss: 0.1058921 Vali Loss: 0.1638011 Test Loss: 0.1395163
Validation loss decreased (0.164382 --> 0.163801).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 25 cost time: 0.900648832321167
Epoch: 25, Steps: 64 | Train Loss: 0.1046647 Vali Loss: 0.1645250 Test Loss: 0.1397112
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 26 cost time: 0.8924481868743896
Epoch: 26, Steps: 64 | Train Loss: 0.1054155 Vali Loss: 0.1630801 Test Loss: 0.1392089
Validation loss decreased (0.163801 --> 0.163080).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 27 cost time: 0.9103622436523438
Epoch: 27, Steps: 64 | Train Loss: 0.1049098 Vali Loss: 0.1637590 Test Loss: 0.1390869
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 28 cost time: 0.9134345054626465
Epoch: 28, Steps: 64 | Train Loss: 0.1037098 Vali Loss: 0.1621186 Test Loss: 0.1391009
Validation loss decreased (0.163080 --> 0.162119).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 29 cost time: 0.9087340831756592
Epoch: 29, Steps: 64 | Train Loss: 0.1033369 Vali Loss: 0.1629479 Test Loss: 0.1391110
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 30 cost time: 0.9168429374694824
Epoch: 30, Steps: 64 | Train Loss: 0.1040507 Vali Loss: 0.1618973 Test Loss: 0.1389524
Validation loss decreased (0.162119 --> 0.161897).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 31 cost time: 0.9354283809661865
Epoch: 31, Steps: 64 | Train Loss: 0.1037318 Vali Loss: 0.1637175 Test Loss: 0.1390308
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 32 cost time: 0.9286091327667236
Epoch: 32, Steps: 64 | Train Loss: 0.1032054 Vali Loss: 0.1648068 Test Loss: 0.1391191
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 33 cost time: 0.9184079170227051
Epoch: 33, Steps: 64 | Train Loss: 0.1029829 Vali Loss: 0.1627868 Test Loss: 0.1393877
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 34 cost time: 0.930631160736084
Epoch: 34, Steps: 64 | Train Loss: 0.1028694 Vali Loss: 0.1612132 Test Loss: 0.1387458
Validation loss decreased (0.161897 --> 0.161213).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 35 cost time: 0.9338796138763428
Epoch: 35, Steps: 64 | Train Loss: 0.1027043 Vali Loss: 0.1618503 Test Loss: 0.1389583
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 36 cost time: 0.9494051933288574
Epoch: 36, Steps: 64 | Train Loss: 0.1022488 Vali Loss: 0.1635180 Test Loss: 0.1390291
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 37 cost time: 0.9453024864196777
Epoch: 37, Steps: 64 | Train Loss: 0.1021533 Vali Loss: 0.1630421 Test Loss: 0.1388187
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 38 cost time: 0.934211254119873
Epoch: 38, Steps: 64 | Train Loss: 0.1023055 Vali Loss: 0.1610946 Test Loss: 0.1387707
Validation loss decreased (0.161213 --> 0.161095).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 39 cost time: 0.935999870300293
Epoch: 39, Steps: 64 | Train Loss: 0.1025304 Vali Loss: 0.1622377 Test Loss: 0.1386585
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 40 cost time: 0.9320366382598877
Epoch: 40, Steps: 64 | Train Loss: 0.1025599 Vali Loss: 0.1615500 Test Loss: 0.1386200
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 41 cost time: 0.9334230422973633
Epoch: 41, Steps: 64 | Train Loss: 0.1022916 Vali Loss: 0.1621086 Test Loss: 0.1389291
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 42 cost time: 0.9174299240112305
Epoch: 42, Steps: 64 | Train Loss: 0.1017742 Vali Loss: 0.1612180 Test Loss: 0.1389574
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 43 cost time: 0.8933627605438232
Epoch: 43, Steps: 64 | Train Loss: 0.1018480 Vali Loss: 0.1637439 Test Loss: 0.1392070
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 44 cost time: 0.9057800769805908
Epoch: 44, Steps: 64 | Train Loss: 0.1019460 Vali Loss: 0.1609239 Test Loss: 0.1390366
Validation loss decreased (0.161095 --> 0.160924).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 45 cost time: 0.9116358757019043
Epoch: 45, Steps: 64 | Train Loss: 0.1017285 Vali Loss: 0.1600374 Test Loss: 0.1387541
Validation loss decreased (0.160924 --> 0.160037).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 46 cost time: 0.9280011653900146
Epoch: 46, Steps: 64 | Train Loss: 0.1024856 Vali Loss: 0.1606606 Test Loss: 0.1389270
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 47 cost time: 0.9306440353393555
Epoch: 47, Steps: 64 | Train Loss: 0.1017869 Vali Loss: 0.1600898 Test Loss: 0.1387630
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 48 cost time: 0.9394774436950684
Epoch: 48, Steps: 64 | Train Loss: 0.1015693 Vali Loss: 0.1614429 Test Loss: 0.1386257
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 49 cost time: 0.9190921783447266
Epoch: 49, Steps: 64 | Train Loss: 0.1016389 Vali Loss: 0.1613814 Test Loss: 0.1387166
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 50 cost time: 0.8879702091217041
Epoch: 50, Steps: 64 | Train Loss: 0.1015311 Vali Loss: 0.1618222 Test Loss: 0.1388285
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 51 cost time: 0.8877496719360352
Epoch: 51, Steps: 64 | Train Loss: 0.1020616 Vali Loss: 0.1597807 Test Loss: 0.1385369
Validation loss decreased (0.160037 --> 0.159781).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 52 cost time: 0.9199995994567871
Epoch: 52, Steps: 64 | Train Loss: 0.1015940 Vali Loss: 0.1624482 Test Loss: 0.1387402
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 53 cost time: 0.9344220161437988
Epoch: 53, Steps: 64 | Train Loss: 0.1016923 Vali Loss: 0.1595349 Test Loss: 0.1387835
Validation loss decreased (0.159781 --> 0.159535).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 54 cost time: 0.9406399726867676
Epoch: 54, Steps: 64 | Train Loss: 0.1015967 Vali Loss: 0.1616058 Test Loss: 0.1387730
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 55 cost time: 0.9296884536743164
Epoch: 55, Steps: 64 | Train Loss: 0.1017329 Vali Loss: 0.1612506 Test Loss: 0.1387402
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 56 cost time: 0.9333713054656982
Epoch: 56, Steps: 64 | Train Loss: 0.1013565 Vali Loss: 0.1619923 Test Loss: 0.1388362
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 57 cost time: 0.9334049224853516
Epoch: 57, Steps: 64 | Train Loss: 0.1014817 Vali Loss: 0.1597107 Test Loss: 0.1384325
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 58 cost time: 0.9350378513336182
Epoch: 58, Steps: 64 | Train Loss: 0.1013642 Vali Loss: 0.1614740 Test Loss: 0.1388875
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 59 cost time: 0.9294164180755615
Epoch: 59, Steps: 64 | Train Loss: 0.1009248 Vali Loss: 0.1620345 Test Loss: 0.1387696
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179290771484375 GB
GPU已分配内存的峰值：0.04622220993041992 GB
Epoch: 60 cost time: 0.9209980964660645
Epoch: 60, Steps: 64 | Train Loss: 0.1013196 Vali Loss: 0.1619805 Test Loss: 0.1385385
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1387834995985031, mae:0.2686484754085541, rse:0.19828501343727112
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04694223403930664 GB
Epoch: 1 cost time: 2.3331491947174072
Epoch: 1, Steps: 64 | Train Loss: 0.8687985 Vali Loss: 1.9356593 Test Loss: 3.7078669
Validation loss decreased (inf --> 1.935659).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 2 cost time: 0.9642274379730225
Epoch: 2, Steps: 64 | Train Loss: 0.5103705 Vali Loss: 0.5018956 Test Loss: 0.6943007
Validation loss decreased (1.935659 --> 0.501896).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 3 cost time: 0.9486269950866699
Epoch: 3, Steps: 64 | Train Loss: 0.1637536 Vali Loss: 0.2111242 Test Loss: 0.1687073
Validation loss decreased (0.501896 --> 0.211124).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 4 cost time: 0.9526355266571045
Epoch: 4, Steps: 64 | Train Loss: 0.1130459 Vali Loss: 0.1830681 Test Loss: 0.1544622
Validation loss decreased (0.211124 --> 0.183068).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 5 cost time: 0.9116344451904297
Epoch: 5, Steps: 64 | Train Loss: 0.1033826 Vali Loss: 0.1700565 Test Loss: 0.1490602
Validation loss decreased (0.183068 --> 0.170056).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 6 cost time: 0.9191446304321289
Epoch: 6, Steps: 64 | Train Loss: 0.0990107 Vali Loss: 0.1690912 Test Loss: 0.1475713
Validation loss decreased (0.170056 --> 0.169091).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 7 cost time: 0.9163928031921387
Epoch: 7, Steps: 64 | Train Loss: 0.0957086 Vali Loss: 0.1663406 Test Loss: 0.1463161
Validation loss decreased (0.169091 --> 0.166341).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 8 cost time: 0.9163506031036377
Epoch: 8, Steps: 64 | Train Loss: 0.0928204 Vali Loss: 0.1627406 Test Loss: 0.1453173
Validation loss decreased (0.166341 --> 0.162741).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 9 cost time: 0.9515795707702637
Epoch: 9, Steps: 64 | Train Loss: 0.0916553 Vali Loss: 0.1594417 Test Loss: 0.1435458
Validation loss decreased (0.162741 --> 0.159442).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 10 cost time: 0.9623913764953613
Epoch: 10, Steps: 64 | Train Loss: 0.0900526 Vali Loss: 0.1575595 Test Loss: 0.1424614
Validation loss decreased (0.159442 --> 0.157560).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 11 cost time: 0.9779207706451416
Epoch: 11, Steps: 64 | Train Loss: 0.0885594 Vali Loss: 0.1557595 Test Loss: 0.1426191
Validation loss decreased (0.157560 --> 0.155760).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 12 cost time: 0.9710004329681396
Epoch: 12, Steps: 64 | Train Loss: 0.0874992 Vali Loss: 0.1557024 Test Loss: 0.1425002
Validation loss decreased (0.155760 --> 0.155702).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 13 cost time: 0.9656326770782471
Epoch: 13, Steps: 64 | Train Loss: 0.0869668 Vali Loss: 0.1560205 Test Loss: 0.1418916
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 14 cost time: 0.9710173606872559
Epoch: 14, Steps: 64 | Train Loss: 0.0862240 Vali Loss: 0.1527786 Test Loss: 0.1420079
Validation loss decreased (0.155702 --> 0.152779).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 15 cost time: 0.9604802131652832
Epoch: 15, Steps: 64 | Train Loss: 0.0854329 Vali Loss: 0.1513173 Test Loss: 0.1411749
Validation loss decreased (0.152779 --> 0.151317).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 16 cost time: 0.9714710712432861
Epoch: 16, Steps: 64 | Train Loss: 0.0851375 Vali Loss: 0.1511342 Test Loss: 0.1420413
Validation loss decreased (0.151317 --> 0.151134).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 17 cost time: 0.9534091949462891
Epoch: 17, Steps: 64 | Train Loss: 0.0845684 Vali Loss: 0.1533639 Test Loss: 0.1414808
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 18 cost time: 0.9741899967193604
Epoch: 18, Steps: 64 | Train Loss: 0.0837599 Vali Loss: 0.1499282 Test Loss: 0.1412206
Validation loss decreased (0.151134 --> 0.149928).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 19 cost time: 0.9914069175720215
Epoch: 19, Steps: 64 | Train Loss: 0.0834669 Vali Loss: 0.1504200 Test Loss: 0.1411084
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 20 cost time: 0.9617197513580322
Epoch: 20, Steps: 64 | Train Loss: 0.0833545 Vali Loss: 0.1500724 Test Loss: 0.1406226
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 21 cost time: 0.9458489418029785
Epoch: 21, Steps: 64 | Train Loss: 0.0829603 Vali Loss: 0.1494888 Test Loss: 0.1403098
Validation loss decreased (0.149928 --> 0.149489).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 22 cost time: 0.9220006465911865
Epoch: 22, Steps: 64 | Train Loss: 0.0827051 Vali Loss: 0.1490082 Test Loss: 0.1405697
Validation loss decreased (0.149489 --> 0.149008).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 23 cost time: 0.9526267051696777
Epoch: 23, Steps: 64 | Train Loss: 0.0825510 Vali Loss: 0.1501843 Test Loss: 0.1404448
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 24 cost time: 0.9624912738800049
Epoch: 24, Steps: 64 | Train Loss: 0.0823393 Vali Loss: 0.1466206 Test Loss: 0.1399419
Validation loss decreased (0.149008 --> 0.146621).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 25 cost time: 0.9604237079620361
Epoch: 25, Steps: 64 | Train Loss: 0.0822369 Vali Loss: 0.1501054 Test Loss: 0.1409634
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 26 cost time: 0.9745595455169678
Epoch: 26, Steps: 64 | Train Loss: 0.0815232 Vali Loss: 0.1472903 Test Loss: 0.1401569
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 27 cost time: 0.9460635185241699
Epoch: 27, Steps: 64 | Train Loss: 0.0816020 Vali Loss: 0.1487641 Test Loss: 0.1411715
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 28 cost time: 0.9404253959655762
Epoch: 28, Steps: 64 | Train Loss: 0.0815335 Vali Loss: 0.1486872 Test Loss: 0.1407288
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 29 cost time: 0.9587078094482422
Epoch: 29, Steps: 64 | Train Loss: 0.0815219 Vali Loss: 0.1470889 Test Loss: 0.1394821
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 30 cost time: 0.9497580528259277
Epoch: 30, Steps: 64 | Train Loss: 0.0814119 Vali Loss: 0.1482008 Test Loss: 0.1405633
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 31 cost time: 0.9573934078216553
Epoch: 31, Steps: 64 | Train Loss: 0.0815182 Vali Loss: 0.1471220 Test Loss: 0.1401349
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 32 cost time: 0.949927568435669
Epoch: 32, Steps: 64 | Train Loss: 0.0806664 Vali Loss: 0.1480383 Test Loss: 0.1398650
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 33 cost time: 0.9563982486724854
Epoch: 33, Steps: 64 | Train Loss: 0.0813151 Vali Loss: 0.1486050 Test Loss: 0.1403186
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 34 cost time: 0.959155797958374
Epoch: 34, Steps: 64 | Train Loss: 0.0810584 Vali Loss: 0.1474715 Test Loss: 0.1401918
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 35 cost time: 0.9833757877349854
Epoch: 35, Steps: 64 | Train Loss: 0.0813209 Vali Loss: 0.1466200 Test Loss: 0.1398041
Validation loss decreased (0.146621 --> 0.146620).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 36 cost time: 0.9805202484130859
Epoch: 36, Steps: 64 | Train Loss: 0.0809372 Vali Loss: 0.1460365 Test Loss: 0.1399324
Validation loss decreased (0.146620 --> 0.146036).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 37 cost time: 0.9844577312469482
Epoch: 37, Steps: 64 | Train Loss: 0.0810156 Vali Loss: 0.1466142 Test Loss: 0.1401073
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 38 cost time: 0.9644906520843506
Epoch: 38, Steps: 64 | Train Loss: 0.0808173 Vali Loss: 0.1478647 Test Loss: 0.1405767
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 39 cost time: 0.9692013263702393
Epoch: 39, Steps: 64 | Train Loss: 0.0808926 Vali Loss: 0.1476662 Test Loss: 0.1397244
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 40 cost time: 0.917001485824585
Epoch: 40, Steps: 64 | Train Loss: 0.0805721 Vali Loss: 0.1472311 Test Loss: 0.1395874
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 41 cost time: 0.915642261505127
Epoch: 41, Steps: 64 | Train Loss: 0.0808881 Vali Loss: 0.1486915 Test Loss: 0.1413784
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 42 cost time: 0.9163777828216553
Epoch: 42, Steps: 64 | Train Loss: 0.0809099 Vali Loss: 0.1479898 Test Loss: 0.1397969
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 43 cost time: 0.9418389797210693
Epoch: 43, Steps: 64 | Train Loss: 0.0808097 Vali Loss: 0.1471138 Test Loss: 0.1405954
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 44 cost time: 0.9472270011901855
Epoch: 44, Steps: 64 | Train Loss: 0.0805484 Vali Loss: 0.1477887 Test Loss: 0.1391906
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 45 cost time: 0.9673798084259033
Epoch: 45, Steps: 64 | Train Loss: 0.0805169 Vali Loss: 0.1457308 Test Loss: 0.1394769
Validation loss decreased (0.146036 --> 0.145731).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 46 cost time: 0.9764919281005859
Epoch: 46, Steps: 64 | Train Loss: 0.0808388 Vali Loss: 0.1474197 Test Loss: 0.1399235
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 47 cost time: 0.9227650165557861
Epoch: 47, Steps: 64 | Train Loss: 0.0806078 Vali Loss: 0.1458094 Test Loss: 0.1391325
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 48 cost time: 0.9220004081726074
Epoch: 48, Steps: 64 | Train Loss: 0.0807794 Vali Loss: 0.1464944 Test Loss: 0.1391914
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 49 cost time: 0.9176452159881592
Epoch: 49, Steps: 64 | Train Loss: 0.0803133 Vali Loss: 0.1463471 Test Loss: 0.1397505
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 50 cost time: 0.9613885879516602
Epoch: 50, Steps: 64 | Train Loss: 0.0808510 Vali Loss: 0.1460251 Test Loss: 0.1396132
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 51 cost time: 0.9624619483947754
Epoch: 51, Steps: 64 | Train Loss: 0.0803065 Vali Loss: 0.1471963 Test Loss: 0.1399690
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 52 cost time: 0.969153642654419
Epoch: 52, Steps: 64 | Train Loss: 0.0809913 Vali Loss: 0.1462579 Test Loss: 0.1397632
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 53 cost time: 0.9715404510498047
Epoch: 53, Steps: 64 | Train Loss: 0.0805268 Vali Loss: 0.1471215 Test Loss: 0.1400336
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 54 cost time: 0.9753899574279785
Epoch: 54, Steps: 64 | Train Loss: 0.0804883 Vali Loss: 0.1483125 Test Loss: 0.1408759
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 55 cost time: 0.9729650020599365
Epoch: 55, Steps: 64 | Train Loss: 0.0806444 Vali Loss: 0.1477165 Test Loss: 0.1401256
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 56 cost time: 0.9794206619262695
Epoch: 56, Steps: 64 | Train Loss: 0.0806337 Vali Loss: 0.1457783 Test Loss: 0.1394091
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 57 cost time: 0.9550004005432129
Epoch: 57, Steps: 64 | Train Loss: 0.0806864 Vali Loss: 0.1476425 Test Loss: 0.1400345
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 58 cost time: 0.9506371021270752
Epoch: 58, Steps: 64 | Train Loss: 0.0801943 Vali Loss: 0.1462162 Test Loss: 0.1397887
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 59 cost time: 0.9416308403015137
Epoch: 59, Steps: 64 | Train Loss: 0.0805490 Vali Loss: 0.1457154 Test Loss: 0.1391086
Validation loss decreased (0.145731 --> 0.145715).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01805877685546875 GB
GPU已分配内存的峰值：0.04778432846069336 GB
Epoch: 60 cost time: 0.9533514976501465
Epoch: 60, Steps: 64 | Train Loss: 0.0805130 Vali Loss: 0.1461802 Test Loss: 0.1405313
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1391085982322693, mae:0.2730392515659332, rse:0.1985171139240265
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.04806232452392578 GB
Epoch: 1 cost time: 2.3615989685058594
Epoch: 1, Steps: 64 | Train Loss: 0.8146784 Vali Loss: 1.8736320 Test Loss: 3.6122112
Validation loss decreased (inf --> 1.873632).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 2 cost time: 0.9736080169677734
Epoch: 2, Steps: 64 | Train Loss: 0.5702466 Vali Loss: 0.7320696 Test Loss: 1.1956313
Validation loss decreased (1.873632 --> 0.732070).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 3 cost time: 0.9762938022613525
Epoch: 3, Steps: 64 | Train Loss: 0.1883510 Vali Loss: 0.2064563 Test Loss: 0.1678687
Validation loss decreased (0.732070 --> 0.206456).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 4 cost time: 0.9832711219787598
Epoch: 4, Steps: 64 | Train Loss: 0.1034135 Vali Loss: 0.1702821 Test Loss: 0.1507514
Validation loss decreased (0.206456 --> 0.170282).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 5 cost time: 0.9924452304840088
Epoch: 5, Steps: 64 | Train Loss: 0.0958470 Vali Loss: 0.1626915 Test Loss: 0.1413302
Validation loss decreased (0.170282 --> 0.162692).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 6 cost time: 0.975501298904419
Epoch: 6, Steps: 64 | Train Loss: 0.0919099 Vali Loss: 0.1610208 Test Loss: 0.1394979
Validation loss decreased (0.162692 --> 0.161021).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 7 cost time: 0.9424865245819092
Epoch: 7, Steps: 64 | Train Loss: 0.0899076 Vali Loss: 0.1587064 Test Loss: 0.1393986
Validation loss decreased (0.161021 --> 0.158706).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 8 cost time: 0.9433996677398682
Epoch: 8, Steps: 64 | Train Loss: 0.0879950 Vali Loss: 0.1550962 Test Loss: 0.1376528
Validation loss decreased (0.158706 --> 0.155096).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 9 cost time: 0.983783483505249
Epoch: 9, Steps: 64 | Train Loss: 0.0868224 Vali Loss: 0.1540513 Test Loss: 0.1367062
Validation loss decreased (0.155096 --> 0.154051).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 10 cost time: 0.995741605758667
Epoch: 10, Steps: 64 | Train Loss: 0.0854665 Vali Loss: 0.1534580 Test Loss: 0.1362344
Validation loss decreased (0.154051 --> 0.153458).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 11 cost time: 0.9940004348754883
Epoch: 11, Steps: 64 | Train Loss: 0.0845611 Vali Loss: 0.1542703 Test Loss: 0.1378474
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 12 cost time: 0.9899985790252686
Epoch: 12, Steps: 64 | Train Loss: 0.0839101 Vali Loss: 0.1491499 Test Loss: 0.1367054
Validation loss decreased (0.153458 --> 0.149150).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 13 cost time: 0.9752857685089111
Epoch: 13, Steps: 64 | Train Loss: 0.0832985 Vali Loss: 0.1512704 Test Loss: 0.1370243
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 14 cost time: 0.9656257629394531
Epoch: 14, Steps: 64 | Train Loss: 0.0825060 Vali Loss: 0.1478403 Test Loss: 0.1368615
Validation loss decreased (0.149150 --> 0.147840).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 15 cost time: 0.9776186943054199
Epoch: 15, Steps: 64 | Train Loss: 0.0821687 Vali Loss: 0.1473535 Test Loss: 0.1367271
Validation loss decreased (0.147840 --> 0.147354).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 16 cost time: 0.9877843856811523
Epoch: 16, Steps: 64 | Train Loss: 0.0818469 Vali Loss: 0.1493814 Test Loss: 0.1373781
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 17 cost time: 0.9843547344207764
Epoch: 17, Steps: 64 | Train Loss: 0.0813817 Vali Loss: 0.1490178 Test Loss: 0.1369794
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 18 cost time: 0.99043869972229
Epoch: 18, Steps: 64 | Train Loss: 0.0808696 Vali Loss: 0.1473018 Test Loss: 0.1367129
Validation loss decreased (0.147354 --> 0.147302).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 19 cost time: 1.005469560623169
Epoch: 19, Steps: 64 | Train Loss: 0.0803942 Vali Loss: 0.1468746 Test Loss: 0.1369239
Validation loss decreased (0.147302 --> 0.146875).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 20 cost time: 0.9663918018341064
Epoch: 20, Steps: 64 | Train Loss: 0.0803235 Vali Loss: 0.1477606 Test Loss: 0.1367478
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 21 cost time: 0.9914429187774658
Epoch: 21, Steps: 64 | Train Loss: 0.0800331 Vali Loss: 0.1465312 Test Loss: 0.1367175
Validation loss decreased (0.146875 --> 0.146531).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 22 cost time: 0.9990024566650391
Epoch: 22, Steps: 64 | Train Loss: 0.0798049 Vali Loss: 0.1448315 Test Loss: 0.1365269
Validation loss decreased (0.146531 --> 0.144832).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 23 cost time: 0.9530012607574463
Epoch: 23, Steps: 64 | Train Loss: 0.0796748 Vali Loss: 0.1449052 Test Loss: 0.1368260
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 24 cost time: 0.9436333179473877
Epoch: 24, Steps: 64 | Train Loss: 0.0795859 Vali Loss: 0.1454409 Test Loss: 0.1371283
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 25 cost time: 0.9460587501525879
Epoch: 25, Steps: 64 | Train Loss: 0.0791494 Vali Loss: 0.1459154 Test Loss: 0.1366843
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 26 cost time: 0.9828193187713623
Epoch: 26, Steps: 64 | Train Loss: 0.0793585 Vali Loss: 0.1450044 Test Loss: 0.1370018
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 27 cost time: 0.9713573455810547
Epoch: 27, Steps: 64 | Train Loss: 0.0793388 Vali Loss: 0.1447751 Test Loss: 0.1368060
Validation loss decreased (0.144832 --> 0.144775).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 28 cost time: 0.9674472808837891
Epoch: 28, Steps: 64 | Train Loss: 0.0789748 Vali Loss: 0.1460889 Test Loss: 0.1372626
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 29 cost time: 1.0108351707458496
Epoch: 29, Steps: 64 | Train Loss: 0.0786839 Vali Loss: 0.1452786 Test Loss: 0.1371004
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 30 cost time: 0.9843859672546387
Epoch: 30, Steps: 64 | Train Loss: 0.0791013 Vali Loss: 0.1452424 Test Loss: 0.1366245
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 31 cost time: 0.980388879776001
Epoch: 31, Steps: 64 | Train Loss: 0.0784768 Vali Loss: 0.1442414 Test Loss: 0.1366916
Validation loss decreased (0.144775 --> 0.144241).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 32 cost time: 0.9857792854309082
Epoch: 32, Steps: 64 | Train Loss: 0.0786832 Vali Loss: 0.1419765 Test Loss: 0.1366406
Validation loss decreased (0.144241 --> 0.141977).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 33 cost time: 0.976639986038208
Epoch: 33, Steps: 64 | Train Loss: 0.0789461 Vali Loss: 0.1447402 Test Loss: 0.1368005
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 34 cost time: 0.9930019378662109
Epoch: 34, Steps: 64 | Train Loss: 0.0783077 Vali Loss: 0.1430113 Test Loss: 0.1364542
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 35 cost time: 0.9946365356445312
Epoch: 35, Steps: 64 | Train Loss: 0.0786600 Vali Loss: 0.1448544 Test Loss: 0.1363452
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 36 cost time: 1.0036401748657227
Epoch: 36, Steps: 64 | Train Loss: 0.0784639 Vali Loss: 0.1438907 Test Loss: 0.1363576
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 37 cost time: 1.0022940635681152
Epoch: 37, Steps: 64 | Train Loss: 0.0787068 Vali Loss: 0.1425012 Test Loss: 0.1363389
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 38 cost time: 0.9704177379608154
Epoch: 38, Steps: 64 | Train Loss: 0.0783802 Vali Loss: 0.1447632 Test Loss: 0.1367467
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 39 cost time: 0.9531002044677734
Epoch: 39, Steps: 64 | Train Loss: 0.0783323 Vali Loss: 0.1440269 Test Loss: 0.1366922
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 40 cost time: 0.9474315643310547
Epoch: 40, Steps: 64 | Train Loss: 0.0781074 Vali Loss: 0.1425392 Test Loss: 0.1367283
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 41 cost time: 0.9372694492340088
Epoch: 41, Steps: 64 | Train Loss: 0.0781397 Vali Loss: 0.1438350 Test Loss: 0.1363439
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 42 cost time: 0.953392744064331
Epoch: 42, Steps: 64 | Train Loss: 0.0781921 Vali Loss: 0.1430801 Test Loss: 0.1364149
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 43 cost time: 0.9699013233184814
Epoch: 43, Steps: 64 | Train Loss: 0.0782968 Vali Loss: 0.1429052 Test Loss: 0.1365463
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 44 cost time: 0.9779999256134033
Epoch: 44, Steps: 64 | Train Loss: 0.0782530 Vali Loss: 0.1459428 Test Loss: 0.1375614
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 45 cost time: 0.9706456661224365
Epoch: 45, Steps: 64 | Train Loss: 0.0781595 Vali Loss: 0.1440216 Test Loss: 0.1361651
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 46 cost time: 0.9656352996826172
Epoch: 46, Steps: 64 | Train Loss: 0.0784433 Vali Loss: 0.1450674 Test Loss: 0.1368800
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 47 cost time: 0.9454076290130615
Epoch: 47, Steps: 64 | Train Loss: 0.0779448 Vali Loss: 0.1440277 Test Loss: 0.1359569
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 48 cost time: 0.9794025421142578
Epoch: 48, Steps: 64 | Train Loss: 0.0776688 Vali Loss: 0.1439810 Test Loss: 0.1373278
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 49 cost time: 0.9854366779327393
Epoch: 49, Steps: 64 | Train Loss: 0.0777769 Vali Loss: 0.1424956 Test Loss: 0.1363932
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 50 cost time: 0.9838132858276367
Epoch: 50, Steps: 64 | Train Loss: 0.0781562 Vali Loss: 0.1446371 Test Loss: 0.1365686
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 51 cost time: 0.9615731239318848
Epoch: 51, Steps: 64 | Train Loss: 0.0780935 Vali Loss: 0.1437988 Test Loss: 0.1365734
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 52 cost time: 0.9410943984985352
Epoch: 52, Steps: 64 | Train Loss: 0.0779642 Vali Loss: 0.1424521 Test Loss: 0.1362389
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 53 cost time: 0.93399977684021
Epoch: 53, Steps: 64 | Train Loss: 0.0781171 Vali Loss: 0.1431440 Test Loss: 0.1361263
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 54 cost time: 0.9599902629852295
Epoch: 54, Steps: 64 | Train Loss: 0.0777559 Vali Loss: 0.1437093 Test Loss: 0.1363376
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 55 cost time: 0.9826374053955078
Epoch: 55, Steps: 64 | Train Loss: 0.0780167 Vali Loss: 0.1440474 Test Loss: 0.1362807
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 56 cost time: 0.9805567264556885
Epoch: 56, Steps: 64 | Train Loss: 0.0780845 Vali Loss: 0.1428290 Test Loss: 0.1362611
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 57 cost time: 0.9633774757385254
Epoch: 57, Steps: 64 | Train Loss: 0.0782258 Vali Loss: 0.1435689 Test Loss: 0.1359390
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 58 cost time: 0.9463775157928467
Epoch: 58, Steps: 64 | Train Loss: 0.0780578 Vali Loss: 0.1429786 Test Loss: 0.1365732
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 59 cost time: 0.9580578804016113
Epoch: 59, Steps: 64 | Train Loss: 0.0778235 Vali Loss: 0.1431307 Test Loss: 0.1359972
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01812744140625 GB
GPU已分配内存的峰值：0.0493006706237793 GB
Epoch: 60 cost time: 0.9779183864593506
Epoch: 60, Steps: 64 | Train Loss: 0.0775751 Vali Loss: 0.1435452 Test Loss: 0.1365010
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13664062321186066, mae:0.26891669631004333, rse:0.1967482566833496
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.045671939849853516 GB
Epoch: 1 cost time: 2.3080382347106934
Epoch: 1, Steps: 64 | Train Loss: 0.6316007 Vali Loss: 1.2047007 Test Loss: 2.0490489
Validation loss decreased (inf --> 1.204701).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 2 cost time: 0.9414072036743164
Epoch: 2, Steps: 64 | Train Loss: 0.4296921 Vali Loss: 0.4579461 Test Loss: 0.5786494
Validation loss decreased (1.204701 --> 0.457946).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 3 cost time: 0.9250972270965576
Epoch: 3, Steps: 64 | Train Loss: 0.2353239 Vali Loss: 0.2708134 Test Loss: 0.2543136
Validation loss decreased (0.457946 --> 0.270813).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 4 cost time: 0.9408528804779053
Epoch: 4, Steps: 64 | Train Loss: 0.1684640 Vali Loss: 0.2075082 Test Loss: 0.1765143
Validation loss decreased (0.270813 --> 0.207508).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 5 cost time: 0.9345295429229736
Epoch: 5, Steps: 64 | Train Loss: 0.1450817 Vali Loss: 0.1823833 Test Loss: 0.1537617
Validation loss decreased (0.207508 --> 0.182383).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 6 cost time: 0.9005115032196045
Epoch: 6, Steps: 64 | Train Loss: 0.1339280 Vali Loss: 0.1734419 Test Loss: 0.1492626
Validation loss decreased (0.182383 --> 0.173442).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 7 cost time: 0.8969886302947998
Epoch: 7, Steps: 64 | Train Loss: 0.1269188 Vali Loss: 0.1685084 Test Loss: 0.1473467
Validation loss decreased (0.173442 --> 0.168508).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 8 cost time: 0.897463321685791
Epoch: 8, Steps: 64 | Train Loss: 0.1220852 Vali Loss: 0.1624557 Test Loss: 0.1464553
Validation loss decreased (0.168508 --> 0.162456).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 9 cost time: 0.9233615398406982
Epoch: 9, Steps: 64 | Train Loss: 0.1169631 Vali Loss: 0.1666838 Test Loss: 0.1474924
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 10 cost time: 0.9303991794586182
Epoch: 10, Steps: 64 | Train Loss: 0.1141139 Vali Loss: 0.1639324 Test Loss: 0.1458440
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 11 cost time: 0.9468536376953125
Epoch: 11, Steps: 64 | Train Loss: 0.1120913 Vali Loss: 0.1621225 Test Loss: 0.1458390
Validation loss decreased (0.162456 --> 0.162123).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 12 cost time: 0.9527266025543213
Epoch: 12, Steps: 64 | Train Loss: 0.1098618 Vali Loss: 0.1624909 Test Loss: 0.1452191
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 13 cost time: 0.9559979438781738
Epoch: 13, Steps: 64 | Train Loss: 0.1087946 Vali Loss: 0.1602983 Test Loss: 0.1449865
Validation loss decreased (0.162123 --> 0.160298).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 14 cost time: 0.9386439323425293
Epoch: 14, Steps: 64 | Train Loss: 0.1070066 Vali Loss: 0.1607737 Test Loss: 0.1445063
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 15 cost time: 0.9407074451446533
Epoch: 15, Steps: 64 | Train Loss: 0.1057081 Vali Loss: 0.1607997 Test Loss: 0.1436742
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 16 cost time: 0.938861608505249
Epoch: 16, Steps: 64 | Train Loss: 0.1040923 Vali Loss: 0.1583416 Test Loss: 0.1447257
Validation loss decreased (0.160298 --> 0.158342).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 17 cost time: 0.9283854961395264
Epoch: 17, Steps: 64 | Train Loss: 0.1039114 Vali Loss: 0.1589995 Test Loss: 0.1435327
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 18 cost time: 0.9453957080841064
Epoch: 18, Steps: 64 | Train Loss: 0.1029481 Vali Loss: 0.1587458 Test Loss: 0.1437093
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 19 cost time: 0.9544286727905273
Epoch: 19, Steps: 64 | Train Loss: 0.1015258 Vali Loss: 0.1572890 Test Loss: 0.1433545
Validation loss decreased (0.158342 --> 0.157289).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 20 cost time: 0.9467530250549316
Epoch: 20, Steps: 64 | Train Loss: 0.1010039 Vali Loss: 0.1582720 Test Loss: 0.1433067
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 21 cost time: 0.9293420314788818
Epoch: 21, Steps: 64 | Train Loss: 0.1012125 Vali Loss: 0.1598055 Test Loss: 0.1431144
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 22 cost time: 0.9246339797973633
Epoch: 22, Steps: 64 | Train Loss: 0.1000354 Vali Loss: 0.1587898 Test Loss: 0.1434449
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 23 cost time: 0.8924522399902344
Epoch: 23, Steps: 64 | Train Loss: 0.1007145 Vali Loss: 0.1588732 Test Loss: 0.1433228
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 24 cost time: 0.9124348163604736
Epoch: 24, Steps: 64 | Train Loss: 0.0997553 Vali Loss: 0.1578943 Test Loss: 0.1432201
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 25 cost time: 0.9164917469024658
Epoch: 25, Steps: 64 | Train Loss: 0.0992600 Vali Loss: 0.1583824 Test Loss: 0.1430047
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 26 cost time: 0.9264512062072754
Epoch: 26, Steps: 64 | Train Loss: 0.0989371 Vali Loss: 0.1578868 Test Loss: 0.1430503
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 27 cost time: 0.9268667697906494
Epoch: 27, Steps: 64 | Train Loss: 0.0987274 Vali Loss: 0.1539711 Test Loss: 0.1422608
Validation loss decreased (0.157289 --> 0.153971).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 28 cost time: 0.9339995384216309
Epoch: 28, Steps: 64 | Train Loss: 0.0984207 Vali Loss: 0.1569366 Test Loss: 0.1426011
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 29 cost time: 0.9267458915710449
Epoch: 29, Steps: 64 | Train Loss: 0.0977992 Vali Loss: 0.1588356 Test Loss: 0.1431810
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 30 cost time: 0.9277830123901367
Epoch: 30, Steps: 64 | Train Loss: 0.0984873 Vali Loss: 0.1562732 Test Loss: 0.1424144
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 31 cost time: 0.9194185733795166
Epoch: 31, Steps: 64 | Train Loss: 0.0983132 Vali Loss: 0.1555290 Test Loss: 0.1423712
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 32 cost time: 0.9274458885192871
Epoch: 32, Steps: 64 | Train Loss: 0.0978050 Vali Loss: 0.1554058 Test Loss: 0.1426856
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 33 cost time: 0.9333913326263428
Epoch: 33, Steps: 64 | Train Loss: 0.0977134 Vali Loss: 0.1585890 Test Loss: 0.1423640
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 34 cost time: 0.9390480518341064
Epoch: 34, Steps: 64 | Train Loss: 0.0970945 Vali Loss: 0.1563224 Test Loss: 0.1425529
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 35 cost time: 0.948833703994751
Epoch: 35, Steps: 64 | Train Loss: 0.0968325 Vali Loss: 0.1569466 Test Loss: 0.1421767
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 36 cost time: 0.9480011463165283
Epoch: 36, Steps: 64 | Train Loss: 0.0971935 Vali Loss: 0.1566775 Test Loss: 0.1423665
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 37 cost time: 0.948615312576294
Epoch: 37, Steps: 64 | Train Loss: 0.0968850 Vali Loss: 0.1562478 Test Loss: 0.1422191
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 38 cost time: 0.9469869136810303
Epoch: 38, Steps: 64 | Train Loss: 0.0968389 Vali Loss: 0.1557294 Test Loss: 0.1424287
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 39 cost time: 0.9503843784332275
Epoch: 39, Steps: 64 | Train Loss: 0.0970953 Vali Loss: 0.1542107 Test Loss: 0.1420523
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 40 cost time: 0.9414353370666504
Epoch: 40, Steps: 64 | Train Loss: 0.0966349 Vali Loss: 0.1558226 Test Loss: 0.1424197
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 41 cost time: 0.9137628078460693
Epoch: 41, Steps: 64 | Train Loss: 0.0972003 Vali Loss: 0.1551127 Test Loss: 0.1420869
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 42 cost time: 0.9013738632202148
Epoch: 42, Steps: 64 | Train Loss: 0.0968979 Vali Loss: 0.1549543 Test Loss: 0.1425155
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 43 cost time: 0.9087703227996826
Epoch: 43, Steps: 64 | Train Loss: 0.0962598 Vali Loss: 0.1562552 Test Loss: 0.1424535
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 44 cost time: 0.9180009365081787
Epoch: 44, Steps: 64 | Train Loss: 0.0966105 Vali Loss: 0.1551136 Test Loss: 0.1420691
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 45 cost time: 0.9256453514099121
Epoch: 45, Steps: 64 | Train Loss: 0.0971069 Vali Loss: 0.1570421 Test Loss: 0.1425317
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 46 cost time: 0.9223980903625488
Epoch: 46, Steps: 64 | Train Loss: 0.0966073 Vali Loss: 0.1562879 Test Loss: 0.1421440
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 47 cost time: 0.9113578796386719
Epoch: 47, Steps: 64 | Train Loss: 0.0960105 Vali Loss: 0.1562543 Test Loss: 0.1420224
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 48 cost time: 0.9034161567687988
Epoch: 48, Steps: 64 | Train Loss: 0.0967312 Vali Loss: 0.1571049 Test Loss: 0.1418631
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 49 cost time: 0.8993477821350098
Epoch: 49, Steps: 64 | Train Loss: 0.0964849 Vali Loss: 0.1554326 Test Loss: 0.1420522
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 50 cost time: 0.9087657928466797
Epoch: 50, Steps: 64 | Train Loss: 0.0961870 Vali Loss: 0.1565184 Test Loss: 0.1422291
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 51 cost time: 0.9043786525726318
Epoch: 51, Steps: 64 | Train Loss: 0.0961860 Vali Loss: 0.1550730 Test Loss: 0.1422000
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 52 cost time: 0.9326119422912598
Epoch: 52, Steps: 64 | Train Loss: 0.0963400 Vali Loss: 0.1563424 Test Loss: 0.1423730
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 53 cost time: 0.9444408416748047
Epoch: 53, Steps: 64 | Train Loss: 0.0965814 Vali Loss: 0.1572907 Test Loss: 0.1422808
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 54 cost time: 0.9613993167877197
Epoch: 54, Steps: 64 | Train Loss: 0.0956783 Vali Loss: 0.1552244 Test Loss: 0.1420265
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 55 cost time: 0.9574301242828369
Epoch: 55, Steps: 64 | Train Loss: 0.0965570 Vali Loss: 0.1571148 Test Loss: 0.1421207
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 56 cost time: 0.9483892917633057
Epoch: 56, Steps: 64 | Train Loss: 0.0962713 Vali Loss: 0.1558388 Test Loss: 0.1422323
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 57 cost time: 0.9247598648071289
Epoch: 57, Steps: 64 | Train Loss: 0.0966298 Vali Loss: 0.1545245 Test Loss: 0.1422701
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 58 cost time: 0.9369990825653076
Epoch: 58, Steps: 64 | Train Loss: 0.0964215 Vali Loss: 0.1561498 Test Loss: 0.1420501
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 59 cost time: 0.9340012073516846
Epoch: 59, Steps: 64 | Train Loss: 0.0961913 Vali Loss: 0.1541442 Test Loss: 0.1420332
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017934799194335938 GB
GPU已分配内存的峰值：0.04638671875 GB
Epoch: 60 cost time: 0.9366474151611328
Epoch: 60, Steps: 64 | Train Loss: 0.0961822 Vali Loss: 0.1564742 Test Loss: 0.1422487
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14226074516773224, mae:0.27852267026901245, rse:0.20075367391109467
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.0471038818359375 GB
Epoch: 1 cost time: 2.3494980335235596
Epoch: 1, Steps: 64 | Train Loss: 0.8794928 Vali Loss: 1.9233555 Test Loss: 3.7336636
Validation loss decreased (inf --> 1.923355).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 2 cost time: 0.9616224765777588
Epoch: 2, Steps: 64 | Train Loss: 0.5098788 Vali Loss: 0.5278481 Test Loss: 0.7318154
Validation loss decreased (1.923355 --> 0.527848).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 3 cost time: 0.9516384601593018
Epoch: 3, Steps: 64 | Train Loss: 0.1770790 Vali Loss: 0.2410965 Test Loss: 0.1947108
Validation loss decreased (0.527848 --> 0.241096).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 4 cost time: 0.9600260257720947
Epoch: 4, Steps: 64 | Train Loss: 0.1183482 Vali Loss: 0.2019275 Test Loss: 0.1645229
Validation loss decreased (0.241096 --> 0.201927).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 5 cost time: 0.9213862419128418
Epoch: 5, Steps: 64 | Train Loss: 0.1079482 Vali Loss: 0.1812087 Test Loss: 0.1572168
Validation loss decreased (0.201927 --> 0.181209).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 6 cost time: 0.9304149150848389
Epoch: 6, Steps: 64 | Train Loss: 0.1025696 Vali Loss: 0.1740301 Test Loss: 0.1516741
Validation loss decreased (0.181209 --> 0.174030).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 7 cost time: 0.9330558776855469
Epoch: 7, Steps: 64 | Train Loss: 0.0984903 Vali Loss: 0.1718140 Test Loss: 0.1486043
Validation loss decreased (0.174030 --> 0.171814).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 8 cost time: 0.9314367771148682
Epoch: 8, Steps: 64 | Train Loss: 0.0958534 Vali Loss: 0.1655133 Test Loss: 0.1469632
Validation loss decreased (0.171814 --> 0.165513).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 9 cost time: 0.9528276920318604
Epoch: 9, Steps: 64 | Train Loss: 0.0943343 Vali Loss: 0.1624697 Test Loss: 0.1453400
Validation loss decreased (0.165513 --> 0.162470).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 10 cost time: 0.970635175704956
Epoch: 10, Steps: 64 | Train Loss: 0.0923861 Vali Loss: 0.1619601 Test Loss: 0.1450938
Validation loss decreased (0.162470 --> 0.161960).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 11 cost time: 0.981001615524292
Epoch: 11, Steps: 64 | Train Loss: 0.0914289 Vali Loss: 0.1580399 Test Loss: 0.1431533
Validation loss decreased (0.161960 --> 0.158040).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 12 cost time: 0.9769866466522217
Epoch: 12, Steps: 64 | Train Loss: 0.0899984 Vali Loss: 0.1584738 Test Loss: 0.1430163
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 13 cost time: 0.9776453971862793
Epoch: 13, Steps: 64 | Train Loss: 0.0893750 Vali Loss: 0.1567977 Test Loss: 0.1428765
Validation loss decreased (0.158040 --> 0.156798).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 14 cost time: 0.9224050045013428
Epoch: 14, Steps: 64 | Train Loss: 0.0887244 Vali Loss: 0.1545697 Test Loss: 0.1417094
Validation loss decreased (0.156798 --> 0.154570).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 15 cost time: 0.9726812839508057
Epoch: 15, Steps: 64 | Train Loss: 0.0878741 Vali Loss: 0.1556861 Test Loss: 0.1418863
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 16 cost time: 0.9828200340270996
Epoch: 16, Steps: 64 | Train Loss: 0.0872493 Vali Loss: 0.1550976 Test Loss: 0.1417572
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 17 cost time: 0.9723899364471436
Epoch: 17, Steps: 64 | Train Loss: 0.0869680 Vali Loss: 0.1532443 Test Loss: 0.1409219
Validation loss decreased (0.154570 --> 0.153244).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 18 cost time: 0.9753909111022949
Epoch: 18, Steps: 64 | Train Loss: 0.0866469 Vali Loss: 0.1509599 Test Loss: 0.1408080
Validation loss decreased (0.153244 --> 0.150960).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 19 cost time: 0.9756345748901367
Epoch: 19, Steps: 64 | Train Loss: 0.0865519 Vali Loss: 0.1532155 Test Loss: 0.1413342
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 20 cost time: 0.9797968864440918
Epoch: 20, Steps: 64 | Train Loss: 0.0857026 Vali Loss: 0.1525114 Test Loss: 0.1412423
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 21 cost time: 0.9509987831115723
Epoch: 21, Steps: 64 | Train Loss: 0.0852278 Vali Loss: 0.1528255 Test Loss: 0.1413116
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 22 cost time: 0.9270000457763672
Epoch: 22, Steps: 64 | Train Loss: 0.0854649 Vali Loss: 0.1501930 Test Loss: 0.1407515
Validation loss decreased (0.150960 --> 0.150193).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 23 cost time: 0.9276437759399414
Epoch: 23, Steps: 64 | Train Loss: 0.0850818 Vali Loss: 0.1511526 Test Loss: 0.1400581
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 24 cost time: 0.9243955612182617
Epoch: 24, Steps: 64 | Train Loss: 0.0852920 Vali Loss: 0.1508645 Test Loss: 0.1400333
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 25 cost time: 0.9751265048980713
Epoch: 25, Steps: 64 | Train Loss: 0.0844800 Vali Loss: 0.1486180 Test Loss: 0.1398846
Validation loss decreased (0.150193 --> 0.148618).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 26 cost time: 0.9685618877410889
Epoch: 26, Steps: 64 | Train Loss: 0.0844574 Vali Loss: 0.1508299 Test Loss: 0.1402787
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 27 cost time: 0.9763963222503662
Epoch: 27, Steps: 64 | Train Loss: 0.0847660 Vali Loss: 0.1495525 Test Loss: 0.1391974
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 28 cost time: 0.9606170654296875
Epoch: 28, Steps: 64 | Train Loss: 0.0840988 Vali Loss: 0.1497942 Test Loss: 0.1391781
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 29 cost time: 0.947364091873169
Epoch: 29, Steps: 64 | Train Loss: 0.0842200 Vali Loss: 0.1502380 Test Loss: 0.1394065
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 30 cost time: 0.9490001201629639
Epoch: 30, Steps: 64 | Train Loss: 0.0842672 Vali Loss: 0.1495805 Test Loss: 0.1397112
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 31 cost time: 0.9589982032775879
Epoch: 31, Steps: 64 | Train Loss: 0.0835685 Vali Loss: 0.1495584 Test Loss: 0.1396561
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 32 cost time: 0.9606482982635498
Epoch: 32, Steps: 64 | Train Loss: 0.0835024 Vali Loss: 0.1484793 Test Loss: 0.1394857
Validation loss decreased (0.148618 --> 0.148479).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 33 cost time: 0.9594054222106934
Epoch: 33, Steps: 64 | Train Loss: 0.0839182 Vali Loss: 0.1508954 Test Loss: 0.1396658
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 34 cost time: 0.9645447731018066
Epoch: 34, Steps: 64 | Train Loss: 0.0833714 Vali Loss: 0.1490630 Test Loss: 0.1393486
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 35 cost time: 0.9804496765136719
Epoch: 35, Steps: 64 | Train Loss: 0.0835493 Vali Loss: 0.1481574 Test Loss: 0.1392100
Validation loss decreased (0.148479 --> 0.148157).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 36 cost time: 0.9764206409454346
Epoch: 36, Steps: 64 | Train Loss: 0.0839215 Vali Loss: 0.1485475 Test Loss: 0.1387447
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 37 cost time: 0.9877486228942871
Epoch: 37, Steps: 64 | Train Loss: 0.0835905 Vali Loss: 0.1491277 Test Loss: 0.1393546
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 38 cost time: 0.9853987693786621
Epoch: 38, Steps: 64 | Train Loss: 0.0834271 Vali Loss: 0.1492110 Test Loss: 0.1394511
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 39 cost time: 0.9588861465454102
Epoch: 39, Steps: 64 | Train Loss: 0.0831992 Vali Loss: 0.1486381 Test Loss: 0.1396192
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 40 cost time: 0.9309999942779541
Epoch: 40, Steps: 64 | Train Loss: 0.0830447 Vali Loss: 0.1490597 Test Loss: 0.1396819
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 41 cost time: 0.9280862808227539
Epoch: 41, Steps: 64 | Train Loss: 0.0831131 Vali Loss: 0.1484189 Test Loss: 0.1397739
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 42 cost time: 0.9366445541381836
Epoch: 42, Steps: 64 | Train Loss: 0.0829397 Vali Loss: 0.1486841 Test Loss: 0.1394216
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 43 cost time: 0.9524366855621338
Epoch: 43, Steps: 64 | Train Loss: 0.0835770 Vali Loss: 0.1484412 Test Loss: 0.1396267
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 44 cost time: 0.9594516754150391
Epoch: 44, Steps: 64 | Train Loss: 0.0835062 Vali Loss: 0.1474008 Test Loss: 0.1394859
Validation loss decreased (0.148157 --> 0.147401).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 45 cost time: 0.9818906784057617
Epoch: 45, Steps: 64 | Train Loss: 0.0833836 Vali Loss: 0.1480315 Test Loss: 0.1396065
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 46 cost time: 0.989976167678833
Epoch: 46, Steps: 64 | Train Loss: 0.0833609 Vali Loss: 0.1498791 Test Loss: 0.1393412
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 47 cost time: 0.9513928890228271
Epoch: 47, Steps: 64 | Train Loss: 0.0831892 Vali Loss: 0.1462552 Test Loss: 0.1391133
Validation loss decreased (0.147401 --> 0.146255).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 48 cost time: 0.9404258728027344
Epoch: 48, Steps: 64 | Train Loss: 0.0830957 Vali Loss: 0.1489752 Test Loss: 0.1391259
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 49 cost time: 0.9464445114135742
Epoch: 49, Steps: 64 | Train Loss: 0.0830742 Vali Loss: 0.1493575 Test Loss: 0.1394091
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 50 cost time: 0.9724328517913818
Epoch: 50, Steps: 64 | Train Loss: 0.0831443 Vali Loss: 0.1482864 Test Loss: 0.1393960
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 51 cost time: 0.9756565093994141
Epoch: 51, Steps: 64 | Train Loss: 0.0830795 Vali Loss: 0.1484314 Test Loss: 0.1393201
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 52 cost time: 0.9854249954223633
Epoch: 52, Steps: 64 | Train Loss: 0.0832340 Vali Loss: 0.1500241 Test Loss: 0.1393503
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 53 cost time: 0.9778351783752441
Epoch: 53, Steps: 64 | Train Loss: 0.0832058 Vali Loss: 0.1491205 Test Loss: 0.1391594
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 54 cost time: 0.9754951000213623
Epoch: 54, Steps: 64 | Train Loss: 0.0829860 Vali Loss: 0.1473874 Test Loss: 0.1400481
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 55 cost time: 0.9641232490539551
Epoch: 55, Steps: 64 | Train Loss: 0.0828921 Vali Loss: 0.1484928 Test Loss: 0.1394956
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 56 cost time: 0.9594357013702393
Epoch: 56, Steps: 64 | Train Loss: 0.0829278 Vali Loss: 0.1477540 Test Loss: 0.1392021
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 57 cost time: 0.9504718780517578
Epoch: 57, Steps: 64 | Train Loss: 0.0829743 Vali Loss: 0.1491338 Test Loss: 0.1398448
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 58 cost time: 0.9617598056793213
Epoch: 58, Steps: 64 | Train Loss: 0.0829079 Vali Loss: 0.1480543 Test Loss: 0.1393280
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 59 cost time: 0.9630000591278076
Epoch: 59, Steps: 64 | Train Loss: 0.0830487 Vali Loss: 0.1468186 Test Loss: 0.1392837
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018064498901367188 GB
GPU已分配内存的峰值：0.04794883728027344 GB
Epoch: 60 cost time: 0.9690017700195312
Epoch: 60, Steps: 64 | Train Loss: 0.0830252 Vali Loss: 0.1491474 Test Loss: 0.1391600
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13911329209804535, mae:0.27084872126579285, rse:0.1985204666852951
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.04822397232055664 GB
Epoch: 1 cost time: 2.3821516036987305
Epoch: 1, Steps: 64 | Train Loss: 0.8715103 Vali Loss: 2.0243983 Test Loss: 3.8609853
Validation loss decreased (inf --> 2.024398).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 2 cost time: 1.0051984786987305
Epoch: 2, Steps: 64 | Train Loss: 0.5899573 Vali Loss: 0.7707412 Test Loss: 1.1994176
Validation loss decreased (2.024398 --> 0.770741).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 3 cost time: 1.0053889751434326
Epoch: 3, Steps: 64 | Train Loss: 0.2029301 Vali Loss: 0.2464489 Test Loss: 0.1917639
Validation loss decreased (0.770741 --> 0.246449).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 4 cost time: 0.9850001335144043
Epoch: 4, Steps: 64 | Train Loss: 0.1044293 Vali Loss: 0.1880279 Test Loss: 0.1543017
Validation loss decreased (0.246449 --> 0.188028).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 5 cost time: 0.9590015411376953
Epoch: 5, Steps: 64 | Train Loss: 0.0963702 Vali Loss: 0.1755452 Test Loss: 0.1440000
Validation loss decreased (0.188028 --> 0.175545).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 6 cost time: 0.9676403999328613
Epoch: 6, Steps: 64 | Train Loss: 0.0919439 Vali Loss: 0.1672425 Test Loss: 0.1421833
Validation loss decreased (0.175545 --> 0.167242).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 7 cost time: 0.9605138301849365
Epoch: 7, Steps: 64 | Train Loss: 0.0893067 Vali Loss: 0.1642584 Test Loss: 0.1413816
Validation loss decreased (0.167242 --> 0.164258).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 8 cost time: 1.0064239501953125
Epoch: 8, Steps: 64 | Train Loss: 0.0879710 Vali Loss: 0.1613779 Test Loss: 0.1403170
Validation loss decreased (0.164258 --> 0.161378).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 9 cost time: 1.0033893585205078
Epoch: 9, Steps: 64 | Train Loss: 0.0863787 Vali Loss: 0.1624050 Test Loss: 0.1398360
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 10 cost time: 0.9960305690765381
Epoch: 10, Steps: 64 | Train Loss: 0.0854918 Vali Loss: 0.1592098 Test Loss: 0.1397832
Validation loss decreased (0.161378 --> 0.159210).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 11 cost time: 1.0073962211608887
Epoch: 11, Steps: 64 | Train Loss: 0.0846686 Vali Loss: 0.1583499 Test Loss: 0.1396514
Validation loss decreased (0.159210 --> 0.158350).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 12 cost time: 1.0093939304351807
Epoch: 12, Steps: 64 | Train Loss: 0.0838061 Vali Loss: 0.1582662 Test Loss: 0.1393439
Validation loss decreased (0.158350 --> 0.158266).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 13 cost time: 0.9955415725708008
Epoch: 13, Steps: 64 | Train Loss: 0.0836277 Vali Loss: 0.1578872 Test Loss: 0.1385956
Validation loss decreased (0.158266 --> 0.157887).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 14 cost time: 1.0108442306518555
Epoch: 14, Steps: 64 | Train Loss: 0.0830777 Vali Loss: 0.1576020 Test Loss: 0.1390197
Validation loss decreased (0.157887 --> 0.157602).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 15 cost time: 1.0054492950439453
Epoch: 15, Steps: 64 | Train Loss: 0.0825842 Vali Loss: 0.1558819 Test Loss: 0.1383543
Validation loss decreased (0.157602 --> 0.155882).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 16 cost time: 1.0047383308410645
Epoch: 16, Steps: 64 | Train Loss: 0.0821811 Vali Loss: 0.1557503 Test Loss: 0.1387707
Validation loss decreased (0.155882 --> 0.155750).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 17 cost time: 1.0008370876312256
Epoch: 17, Steps: 64 | Train Loss: 0.0820549 Vali Loss: 0.1548823 Test Loss: 0.1381880
Validation loss decreased (0.155750 --> 0.154882).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 18 cost time: 1.0109999179840088
Epoch: 18, Steps: 64 | Train Loss: 0.0818523 Vali Loss: 0.1540678 Test Loss: 0.1384165
Validation loss decreased (0.154882 --> 0.154068).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 19 cost time: 1.0079982280731201
Epoch: 19, Steps: 64 | Train Loss: 0.0817823 Vali Loss: 0.1557735 Test Loss: 0.1387256
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 20 cost time: 0.9856457710266113
Epoch: 20, Steps: 64 | Train Loss: 0.0810932 Vali Loss: 0.1545500 Test Loss: 0.1386655
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 21 cost time: 0.9724218845367432
Epoch: 21, Steps: 64 | Train Loss: 0.0813721 Vali Loss: 0.1533893 Test Loss: 0.1381658
Validation loss decreased (0.154068 --> 0.153389).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 22 cost time: 0.9775667190551758
Epoch: 22, Steps: 64 | Train Loss: 0.0812341 Vali Loss: 0.1538121 Test Loss: 0.1378116
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 23 cost time: 0.9773979187011719
Epoch: 23, Steps: 64 | Train Loss: 0.0808495 Vali Loss: 0.1560400 Test Loss: 0.1384113
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 24 cost time: 0.972428560256958
Epoch: 24, Steps: 64 | Train Loss: 0.0809808 Vali Loss: 0.1536107 Test Loss: 0.1382400
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 25 cost time: 0.9744694232940674
Epoch: 25, Steps: 64 | Train Loss: 0.0808579 Vali Loss: 0.1548417 Test Loss: 0.1380860
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 26 cost time: 0.991412878036499
Epoch: 26, Steps: 64 | Train Loss: 0.0803273 Vali Loss: 0.1525462 Test Loss: 0.1384415
Validation loss decreased (0.153389 --> 0.152546).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 27 cost time: 0.9933733940124512
Epoch: 27, Steps: 64 | Train Loss: 0.0802011 Vali Loss: 0.1527230 Test Loss: 0.1379031
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 28 cost time: 0.9797458648681641
Epoch: 28, Steps: 64 | Train Loss: 0.0805352 Vali Loss: 0.1528500 Test Loss: 0.1381074
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 29 cost time: 0.9977669715881348
Epoch: 29, Steps: 64 | Train Loss: 0.0804619 Vali Loss: 0.1525522 Test Loss: 0.1378928
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 30 cost time: 0.9850001335144043
Epoch: 30, Steps: 64 | Train Loss: 0.0802148 Vali Loss: 0.1524981 Test Loss: 0.1380144
Validation loss decreased (0.152546 --> 0.152498).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 31 cost time: 0.9759976863861084
Epoch: 31, Steps: 64 | Train Loss: 0.0804443 Vali Loss: 0.1518800 Test Loss: 0.1377548
Validation loss decreased (0.152498 --> 0.151880).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 32 cost time: 0.9896330833435059
Epoch: 32, Steps: 64 | Train Loss: 0.0800581 Vali Loss: 0.1542996 Test Loss: 0.1378449
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 33 cost time: 0.9873735904693604
Epoch: 33, Steps: 64 | Train Loss: 0.0802437 Vali Loss: 0.1527570 Test Loss: 0.1376034
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 34 cost time: 1.0022716522216797
Epoch: 34, Steps: 64 | Train Loss: 0.0801585 Vali Loss: 0.1522018 Test Loss: 0.1378286
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 35 cost time: 1.0138218402862549
Epoch: 35, Steps: 64 | Train Loss: 0.0800728 Vali Loss: 0.1503128 Test Loss: 0.1376609
Validation loss decreased (0.151880 --> 0.150313).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 36 cost time: 1.0054707527160645
Epoch: 36, Steps: 64 | Train Loss: 0.0799909 Vali Loss: 0.1525476 Test Loss: 0.1377395
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 37 cost time: 1.0043354034423828
Epoch: 37, Steps: 64 | Train Loss: 0.0802831 Vali Loss: 0.1518658 Test Loss: 0.1377342
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 38 cost time: 0.9703731536865234
Epoch: 38, Steps: 64 | Train Loss: 0.0799759 Vali Loss: 0.1520375 Test Loss: 0.1378501
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 39 cost time: 0.9734604358673096
Epoch: 39, Steps: 64 | Train Loss: 0.0796223 Vali Loss: 0.1502181 Test Loss: 0.1376813
Validation loss decreased (0.150313 --> 0.150218).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 40 cost time: 0.9633889198303223
Epoch: 40, Steps: 64 | Train Loss: 0.0800151 Vali Loss: 0.1530548 Test Loss: 0.1374763
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 41 cost time: 0.9688553810119629
Epoch: 41, Steps: 64 | Train Loss: 0.0799032 Vali Loss: 0.1524270 Test Loss: 0.1376450
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 42 cost time: 0.993626594543457
Epoch: 42, Steps: 64 | Train Loss: 0.0798806 Vali Loss: 0.1525693 Test Loss: 0.1375845
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 43 cost time: 0.9905939102172852
Epoch: 43, Steps: 64 | Train Loss: 0.0797179 Vali Loss: 0.1536873 Test Loss: 0.1377848
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 44 cost time: 0.9916372299194336
Epoch: 44, Steps: 64 | Train Loss: 0.0797492 Vali Loss: 0.1518691 Test Loss: 0.1379956
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 45 cost time: 0.986670732498169
Epoch: 45, Steps: 64 | Train Loss: 0.0797168 Vali Loss: 0.1521901 Test Loss: 0.1376241
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 46 cost time: 0.9902660846710205
Epoch: 46, Steps: 64 | Train Loss: 0.0800407 Vali Loss: 0.1505383 Test Loss: 0.1375062
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 47 cost time: 0.9934234619140625
Epoch: 47, Steps: 64 | Train Loss: 0.0796829 Vali Loss: 0.1519631 Test Loss: 0.1376319
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 48 cost time: 1.0004355907440186
Epoch: 48, Steps: 64 | Train Loss: 0.0799153 Vali Loss: 0.1492981 Test Loss: 0.1377275
Validation loss decreased (0.150218 --> 0.149298).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 49 cost time: 0.9823899269104004
Epoch: 49, Steps: 64 | Train Loss: 0.0796976 Vali Loss: 0.1523108 Test Loss: 0.1375307
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 50 cost time: 1.0053882598876953
Epoch: 50, Steps: 64 | Train Loss: 0.0798710 Vali Loss: 0.1517368 Test Loss: 0.1376324
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 51 cost time: 0.9964954853057861
Epoch: 51, Steps: 64 | Train Loss: 0.0797192 Vali Loss: 0.1510344 Test Loss: 0.1373075
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 52 cost time: 1.0124011039733887
Epoch: 52, Steps: 64 | Train Loss: 0.0796737 Vali Loss: 0.1527767 Test Loss: 0.1376520
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 53 cost time: 1.0005009174346924
Epoch: 53, Steps: 64 | Train Loss: 0.0795886 Vali Loss: 0.1516573 Test Loss: 0.1378158
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 54 cost time: 0.9919600486755371
Epoch: 54, Steps: 64 | Train Loss: 0.0796092 Vali Loss: 0.1517965 Test Loss: 0.1374038
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 55 cost time: 0.9967999458312988
Epoch: 55, Steps: 64 | Train Loss: 0.0796541 Vali Loss: 0.1495956 Test Loss: 0.1376310
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 56 cost time: 0.9809987545013428
Epoch: 56, Steps: 64 | Train Loss: 0.0795232 Vali Loss: 0.1518563 Test Loss: 0.1373722
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 57 cost time: 0.9446349143981934
Epoch: 57, Steps: 64 | Train Loss: 0.0798276 Vali Loss: 0.1526835 Test Loss: 0.1374834
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 58 cost time: 0.9762561321258545
Epoch: 58, Steps: 64 | Train Loss: 0.0796014 Vali Loss: 0.1517598 Test Loss: 0.1376352
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 59 cost time: 0.976428747177124
Epoch: 59, Steps: 64 | Train Loss: 0.0798524 Vali Loss: 0.1509016 Test Loss: 0.1374414
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018133163452148438 GB
GPU已分配内存的峰值：0.049465179443359375 GB
Epoch: 60 cost time: 1.0034856796264648
Epoch: 60, Steps: 64 | Train Loss: 0.0797185 Vali Loss: 0.1528748 Test Loss: 0.1377102
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1377275139093399, mae:0.27071183919906616, rse:0.19752921164035797
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04583406448364258 GB
Epoch: 1 cost time: 2.35613751411438
Epoch: 1, Steps: 64 | Train Loss: 1.1249718 Vali Loss: 2.4273994 Test Loss: 4.3192191
Validation loss decreased (inf --> 2.427399).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 2 cost time: 0.9576385021209717
Epoch: 2, Steps: 64 | Train Loss: 0.6245902 Vali Loss: 0.6611373 Test Loss: 0.8765061
Validation loss decreased (2.427399 --> 0.661137).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 3 cost time: 0.9504373073577881
Epoch: 3, Steps: 64 | Train Loss: 0.2790280 Vali Loss: 0.3840228 Test Loss: 0.3946165
Validation loss decreased (0.661137 --> 0.384023).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 4 cost time: 0.9571795463562012
Epoch: 4, Steps: 64 | Train Loss: 0.1915277 Vali Loss: 0.2852810 Test Loss: 0.2446512
Validation loss decreased (0.384023 --> 0.285281).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 5 cost time: 0.9053196907043457
Epoch: 5, Steps: 64 | Train Loss: 0.1590692 Vali Loss: 0.2381836 Test Loss: 0.1935055
Validation loss decreased (0.285281 --> 0.238184).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 6 cost time: 0.9000208377838135
Epoch: 6, Steps: 64 | Train Loss: 0.1426734 Vali Loss: 0.2149435 Test Loss: 0.1695944
Validation loss decreased (0.238184 --> 0.214943).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 7 cost time: 0.8984432220458984
Epoch: 7, Steps: 64 | Train Loss: 0.1323120 Vali Loss: 0.1994312 Test Loss: 0.1574621
Validation loss decreased (0.214943 --> 0.199431).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 8 cost time: 0.9100000858306885
Epoch: 8, Steps: 64 | Train Loss: 0.1266387 Vali Loss: 0.1884287 Test Loss: 0.1522386
Validation loss decreased (0.199431 --> 0.188429).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 9 cost time: 0.9131679534912109
Epoch: 9, Steps: 64 | Train Loss: 0.1223375 Vali Loss: 0.1854086 Test Loss: 0.1496488
Validation loss decreased (0.188429 --> 0.185409).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 10 cost time: 0.9253849983215332
Epoch: 10, Steps: 64 | Train Loss: 0.1190118 Vali Loss: 0.1807481 Test Loss: 0.1470536
Validation loss decreased (0.185409 --> 0.180748).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 11 cost time: 0.9542727470397949
Epoch: 11, Steps: 64 | Train Loss: 0.1163548 Vali Loss: 0.1770974 Test Loss: 0.1458938
Validation loss decreased (0.180748 --> 0.177097).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 12 cost time: 0.9588432312011719
Epoch: 12, Steps: 64 | Train Loss: 0.1143030 Vali Loss: 0.1720775 Test Loss: 0.1446655
Validation loss decreased (0.177097 --> 0.172077).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 13 cost time: 0.9494419097900391
Epoch: 13, Steps: 64 | Train Loss: 0.1115018 Vali Loss: 0.1699961 Test Loss: 0.1434784
Validation loss decreased (0.172077 --> 0.169996).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 14 cost time: 0.9454159736633301
Epoch: 14, Steps: 64 | Train Loss: 0.1096993 Vali Loss: 0.1703381 Test Loss: 0.1430643
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 15 cost time: 0.927736759185791
Epoch: 15, Steps: 64 | Train Loss: 0.1091742 Vali Loss: 0.1669528 Test Loss: 0.1423932
Validation loss decreased (0.169996 --> 0.166953).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 16 cost time: 0.9333553314208984
Epoch: 16, Steps: 64 | Train Loss: 0.1072083 Vali Loss: 0.1656938 Test Loss: 0.1423469
Validation loss decreased (0.166953 --> 0.165694).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 17 cost time: 0.9346191883087158
Epoch: 17, Steps: 64 | Train Loss: 0.1065111 Vali Loss: 0.1646168 Test Loss: 0.1422509
Validation loss decreased (0.165694 --> 0.164617).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 18 cost time: 0.9606456756591797
Epoch: 18, Steps: 64 | Train Loss: 0.1050961 Vali Loss: 0.1633274 Test Loss: 0.1410323
Validation loss decreased (0.164617 --> 0.163327).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 19 cost time: 0.9594252109527588
Epoch: 19, Steps: 64 | Train Loss: 0.1047133 Vali Loss: 0.1634939 Test Loss: 0.1412031
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 20 cost time: 0.9522829055786133
Epoch: 20, Steps: 64 | Train Loss: 0.1044381 Vali Loss: 0.1626418 Test Loss: 0.1408408
Validation loss decreased (0.163327 --> 0.162642).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 21 cost time: 0.9564661979675293
Epoch: 21, Steps: 64 | Train Loss: 0.1036321 Vali Loss: 0.1630494 Test Loss: 0.1409379
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 22 cost time: 0.9264523983001709
Epoch: 22, Steps: 64 | Train Loss: 0.1027135 Vali Loss: 0.1638326 Test Loss: 0.1406688
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 23 cost time: 0.9008710384368896
Epoch: 23, Steps: 64 | Train Loss: 0.1022963 Vali Loss: 0.1614776 Test Loss: 0.1398946
Validation loss decreased (0.162642 --> 0.161478).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 24 cost time: 0.9049999713897705
Epoch: 24, Steps: 64 | Train Loss: 0.1024943 Vali Loss: 0.1622465 Test Loss: 0.1406902
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 25 cost time: 0.9176340103149414
Epoch: 25, Steps: 64 | Train Loss: 0.1015353 Vali Loss: 0.1603627 Test Loss: 0.1395384
Validation loss decreased (0.161478 --> 0.160363).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 26 cost time: 0.912628173828125
Epoch: 26, Steps: 64 | Train Loss: 0.1014021 Vali Loss: 0.1596323 Test Loss: 0.1399658
Validation loss decreased (0.160363 --> 0.159632).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 27 cost time: 0.9345278739929199
Epoch: 27, Steps: 64 | Train Loss: 0.1014857 Vali Loss: 0.1595518 Test Loss: 0.1399504
Validation loss decreased (0.159632 --> 0.159552).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 28 cost time: 0.9253928661346436
Epoch: 28, Steps: 64 | Train Loss: 0.1010841 Vali Loss: 0.1604397 Test Loss: 0.1401647
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 29 cost time: 0.8937652111053467
Epoch: 29, Steps: 64 | Train Loss: 0.1005782 Vali Loss: 0.1601839 Test Loss: 0.1395774
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 30 cost time: 0.9329938888549805
Epoch: 30, Steps: 64 | Train Loss: 0.0999898 Vali Loss: 0.1603323 Test Loss: 0.1394974
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 31 cost time: 0.9177379608154297
Epoch: 31, Steps: 64 | Train Loss: 0.0997746 Vali Loss: 0.1595816 Test Loss: 0.1395864
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 32 cost time: 0.9399993419647217
Epoch: 32, Steps: 64 | Train Loss: 0.0998370 Vali Loss: 0.1597013 Test Loss: 0.1393245
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 33 cost time: 0.9450840950012207
Epoch: 33, Steps: 64 | Train Loss: 0.0991455 Vali Loss: 0.1582678 Test Loss: 0.1392487
Validation loss decreased (0.159552 --> 0.158268).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 34 cost time: 0.934516429901123
Epoch: 34, Steps: 64 | Train Loss: 0.0991910 Vali Loss: 0.1591907 Test Loss: 0.1394843
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 35 cost time: 0.9604263305664062
Epoch: 35, Steps: 64 | Train Loss: 0.0993247 Vali Loss: 0.1590600 Test Loss: 0.1396383
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 36 cost time: 0.9644038677215576
Epoch: 36, Steps: 64 | Train Loss: 0.0989502 Vali Loss: 0.1584992 Test Loss: 0.1391191
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 37 cost time: 0.9580094814300537
Epoch: 37, Steps: 64 | Train Loss: 0.0988565 Vali Loss: 0.1589537 Test Loss: 0.1392844
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 38 cost time: 0.959465742111206
Epoch: 38, Steps: 64 | Train Loss: 0.0983587 Vali Loss: 0.1589398 Test Loss: 0.1391360
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 39 cost time: 0.952747106552124
Epoch: 39, Steps: 64 | Train Loss: 0.0987674 Vali Loss: 0.1587436 Test Loss: 0.1390731
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 40 cost time: 0.942828893661499
Epoch: 40, Steps: 64 | Train Loss: 0.0985019 Vali Loss: 0.1601528 Test Loss: 0.1393331
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 41 cost time: 0.9047348499298096
Epoch: 41, Steps: 64 | Train Loss: 0.0981803 Vali Loss: 0.1578534 Test Loss: 0.1389194
Validation loss decreased (0.158268 --> 0.157853).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 42 cost time: 0.9016304016113281
Epoch: 42, Steps: 64 | Train Loss: 0.0986341 Vali Loss: 0.1597765 Test Loss: 0.1397063
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 43 cost time: 0.9074108600616455
Epoch: 43, Steps: 64 | Train Loss: 0.0983353 Vali Loss: 0.1557914 Test Loss: 0.1383013
Validation loss decreased (0.157853 --> 0.155791).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 44 cost time: 0.9425795078277588
Epoch: 44, Steps: 64 | Train Loss: 0.0987657 Vali Loss: 0.1576086 Test Loss: 0.1385980
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 45 cost time: 0.9304225444793701
Epoch: 45, Steps: 64 | Train Loss: 0.0980867 Vali Loss: 0.1591034 Test Loss: 0.1393905
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 46 cost time: 0.9370467662811279
Epoch: 46, Steps: 64 | Train Loss: 0.0985938 Vali Loss: 0.1570307 Test Loss: 0.1387895
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 47 cost time: 0.9247512817382812
Epoch: 47, Steps: 64 | Train Loss: 0.0983785 Vali Loss: 0.1577896 Test Loss: 0.1386641
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 48 cost time: 0.9079995155334473
Epoch: 48, Steps: 64 | Train Loss: 0.0983132 Vali Loss: 0.1589723 Test Loss: 0.1395303
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 49 cost time: 0.9126427173614502
Epoch: 49, Steps: 64 | Train Loss: 0.0982363 Vali Loss: 0.1559385 Test Loss: 0.1387163
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 50 cost time: 0.9133741855621338
Epoch: 50, Steps: 64 | Train Loss: 0.0981477 Vali Loss: 0.1573144 Test Loss: 0.1388995
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 51 cost time: 0.9103946685791016
Epoch: 51, Steps: 64 | Train Loss: 0.0981171 Vali Loss: 0.1571334 Test Loss: 0.1391814
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 52 cost time: 0.955441951751709
Epoch: 52, Steps: 64 | Train Loss: 0.0978400 Vali Loss: 0.1563372 Test Loss: 0.1389762
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 53 cost time: 0.9754347801208496
Epoch: 53, Steps: 64 | Train Loss: 0.0979310 Vali Loss: 0.1582585 Test Loss: 0.1384534
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 54 cost time: 0.9584295749664307
Epoch: 54, Steps: 64 | Train Loss: 0.0985219 Vali Loss: 0.1566458 Test Loss: 0.1382742
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 55 cost time: 0.9531078338623047
Epoch: 55, Steps: 64 | Train Loss: 0.0980641 Vali Loss: 0.1575172 Test Loss: 0.1387907
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 56 cost time: 0.9540011882781982
Epoch: 56, Steps: 64 | Train Loss: 0.0974608 Vali Loss: 0.1571727 Test Loss: 0.1382566
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 57 cost time: 0.9396488666534424
Epoch: 57, Steps: 64 | Train Loss: 0.0977035 Vali Loss: 0.1573763 Test Loss: 0.1380855
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 58 cost time: 0.933722972869873
Epoch: 58, Steps: 64 | Train Loss: 0.0983364 Vali Loss: 0.1582112 Test Loss: 0.1385295
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 59 cost time: 0.9354648590087891
Epoch: 59, Steps: 64 | Train Loss: 0.0977195 Vali Loss: 0.1587570 Test Loss: 0.1390083
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017942428588867188 GB
GPU已分配内存的峰值：0.04655265808105469 GB
Epoch: 60 cost time: 0.9424335956573486
Epoch: 60, Steps: 64 | Train Loss: 0.0981827 Vali Loss: 0.1595503 Test Loss: 0.1389205
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1383012980222702, mae:0.2646023631095886, rse:0.19794024527072906
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.04726600646972656 GB
Epoch: 1 cost time: 2.3632376194000244
Epoch: 1, Steps: 64 | Train Loss: 0.8295069 Vali Loss: 1.8459276 Test Loss: 3.5116537
Validation loss decreased (inf --> 1.845928).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 2 cost time: 0.987358570098877
Epoch: 2, Steps: 64 | Train Loss: 0.4750093 Vali Loss: 0.4703488 Test Loss: 0.6440002
Validation loss decreased (1.845928 --> 0.470349).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 3 cost time: 0.9640045166015625
Epoch: 3, Steps: 64 | Train Loss: 0.1533951 Vali Loss: 0.2068629 Test Loss: 0.1635616
Validation loss decreased (0.470349 --> 0.206863).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 4 cost time: 0.9673638343811035
Epoch: 4, Steps: 64 | Train Loss: 0.1081635 Vali Loss: 0.1803229 Test Loss: 0.1497000
Validation loss decreased (0.206863 --> 0.180323).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 5 cost time: 0.9307613372802734
Epoch: 5, Steps: 64 | Train Loss: 0.1000882 Vali Loss: 0.1700252 Test Loss: 0.1457718
Validation loss decreased (0.180323 --> 0.170025).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 6 cost time: 0.9378499984741211
Epoch: 6, Steps: 64 | Train Loss: 0.0955926 Vali Loss: 0.1664865 Test Loss: 0.1431279
Validation loss decreased (0.170025 --> 0.166487).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 7 cost time: 0.9291422367095947
Epoch: 7, Steps: 64 | Train Loss: 0.0925059 Vali Loss: 0.1625968 Test Loss: 0.1424643
Validation loss decreased (0.166487 --> 0.162597).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 8 cost time: 0.939000129699707
Epoch: 8, Steps: 64 | Train Loss: 0.0904657 Vali Loss: 0.1613664 Test Loss: 0.1414111
Validation loss decreased (0.162597 --> 0.161366).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 9 cost time: 0.96964430809021
Epoch: 9, Steps: 64 | Train Loss: 0.0884410 Vali Loss: 0.1580884 Test Loss: 0.1418787
Validation loss decreased (0.161366 --> 0.158088).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 10 cost time: 0.965618371963501
Epoch: 10, Steps: 64 | Train Loss: 0.0869873 Vali Loss: 0.1563973 Test Loss: 0.1407078
Validation loss decreased (0.158088 --> 0.156397).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 11 cost time: 0.9929378032684326
Epoch: 11, Steps: 64 | Train Loss: 0.0857476 Vali Loss: 0.1553304 Test Loss: 0.1402161
Validation loss decreased (0.156397 --> 0.155330).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 12 cost time: 0.9954221248626709
Epoch: 12, Steps: 64 | Train Loss: 0.0853932 Vali Loss: 0.1538217 Test Loss: 0.1404593
Validation loss decreased (0.155330 --> 0.153822).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 13 cost time: 0.9703691005706787
Epoch: 13, Steps: 64 | Train Loss: 0.0841995 Vali Loss: 0.1543659 Test Loss: 0.1400844
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 14 cost time: 0.9652433395385742
Epoch: 14, Steps: 64 | Train Loss: 0.0836473 Vali Loss: 0.1509180 Test Loss: 0.1396220
Validation loss decreased (0.153822 --> 0.150918).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 15 cost time: 0.9700093269348145
Epoch: 15, Steps: 64 | Train Loss: 0.0828784 Vali Loss: 0.1508168 Test Loss: 0.1389036
Validation loss decreased (0.150918 --> 0.150817).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 16 cost time: 0.9684953689575195
Epoch: 16, Steps: 64 | Train Loss: 0.0824441 Vali Loss: 0.1502421 Test Loss: 0.1391664
Validation loss decreased (0.150817 --> 0.150242).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 17 cost time: 0.9768257141113281
Epoch: 17, Steps: 64 | Train Loss: 0.0822978 Vali Loss: 0.1483671 Test Loss: 0.1387686
Validation loss decreased (0.150242 --> 0.148367).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 18 cost time: 0.9798283576965332
Epoch: 18, Steps: 64 | Train Loss: 0.0820938 Vali Loss: 0.1492862 Test Loss: 0.1383876
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 19 cost time: 0.9623715877532959
Epoch: 19, Steps: 64 | Train Loss: 0.0816303 Vali Loss: 0.1486806 Test Loss: 0.1386837
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 20 cost time: 0.9306349754333496
Epoch: 20, Steps: 64 | Train Loss: 0.0811303 Vali Loss: 0.1460809 Test Loss: 0.1383054
Validation loss decreased (0.148367 --> 0.146081).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 21 cost time: 0.9492359161376953
Epoch: 21, Steps: 64 | Train Loss: 0.0809327 Vali Loss: 0.1469295 Test Loss: 0.1388498
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 22 cost time: 0.9434266090393066
Epoch: 22, Steps: 64 | Train Loss: 0.0806141 Vali Loss: 0.1478039 Test Loss: 0.1388217
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 23 cost time: 0.9421136379241943
Epoch: 23, Steps: 64 | Train Loss: 0.0805577 Vali Loss: 0.1475523 Test Loss: 0.1382367
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 24 cost time: 0.9382405281066895
Epoch: 24, Steps: 64 | Train Loss: 0.0800672 Vali Loss: 0.1472379 Test Loss: 0.1378247
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 25 cost time: 0.9373769760131836
Epoch: 25, Steps: 64 | Train Loss: 0.0799519 Vali Loss: 0.1464816 Test Loss: 0.1382433
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 26 cost time: 0.9426732063293457
Epoch: 26, Steps: 64 | Train Loss: 0.0798152 Vali Loss: 0.1449773 Test Loss: 0.1378849
Validation loss decreased (0.146081 --> 0.144977).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 27 cost time: 0.967761754989624
Epoch: 27, Steps: 64 | Train Loss: 0.0798425 Vali Loss: 0.1448666 Test Loss: 0.1380324
Validation loss decreased (0.144977 --> 0.144867).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 28 cost time: 0.9600000381469727
Epoch: 28, Steps: 64 | Train Loss: 0.0795329 Vali Loss: 0.1433613 Test Loss: 0.1375404
Validation loss decreased (0.144867 --> 0.143361).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 29 cost time: 0.9566411972045898
Epoch: 29, Steps: 64 | Train Loss: 0.0796048 Vali Loss: 0.1445494 Test Loss: 0.1382270
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 30 cost time: 0.9726333618164062
Epoch: 30, Steps: 64 | Train Loss: 0.0794602 Vali Loss: 0.1439865 Test Loss: 0.1383084
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 31 cost time: 0.9761695861816406
Epoch: 31, Steps: 64 | Train Loss: 0.0794640 Vali Loss: 0.1450233 Test Loss: 0.1374521
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 32 cost time: 0.9975459575653076
Epoch: 32, Steps: 64 | Train Loss: 0.0791493 Vali Loss: 0.1462631 Test Loss: 0.1380670
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 33 cost time: 0.9684197902679443
Epoch: 33, Steps: 64 | Train Loss: 0.0789397 Vali Loss: 0.1448565 Test Loss: 0.1373251
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 34 cost time: 0.9903793334960938
Epoch: 34, Steps: 64 | Train Loss: 0.0785404 Vali Loss: 0.1449493 Test Loss: 0.1378316
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 35 cost time: 0.9974150657653809
Epoch: 35, Steps: 64 | Train Loss: 0.0789656 Vali Loss: 0.1446512 Test Loss: 0.1376635
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 36 cost time: 1.0014698505401611
Epoch: 36, Steps: 64 | Train Loss: 0.0787612 Vali Loss: 0.1444446 Test Loss: 0.1371322
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 37 cost time: 0.9938373565673828
Epoch: 37, Steps: 64 | Train Loss: 0.0791829 Vali Loss: 0.1443241 Test Loss: 0.1381567
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 38 cost time: 0.9577381610870361
Epoch: 38, Steps: 64 | Train Loss: 0.0790235 Vali Loss: 0.1437789 Test Loss: 0.1381655
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 39 cost time: 0.9650008678436279
Epoch: 39, Steps: 64 | Train Loss: 0.0788204 Vali Loss: 0.1451976 Test Loss: 0.1375837
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 40 cost time: 0.9290361404418945
Epoch: 40, Steps: 64 | Train Loss: 0.0788205 Vali Loss: 0.1448354 Test Loss: 0.1373782
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 41 cost time: 0.9266462326049805
Epoch: 41, Steps: 64 | Train Loss: 0.0784594 Vali Loss: 0.1463944 Test Loss: 0.1385891
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 42 cost time: 0.963364839553833
Epoch: 42, Steps: 64 | Train Loss: 0.0786771 Vali Loss: 0.1439840 Test Loss: 0.1375408
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 43 cost time: 0.9574525356292725
Epoch: 43, Steps: 64 | Train Loss: 0.0781895 Vali Loss: 0.1442206 Test Loss: 0.1370334
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 44 cost time: 0.9713921546936035
Epoch: 44, Steps: 64 | Train Loss: 0.0783298 Vali Loss: 0.1450266 Test Loss: 0.1382519
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 45 cost time: 0.9595367908477783
Epoch: 45, Steps: 64 | Train Loss: 0.0787560 Vali Loss: 0.1457491 Test Loss: 0.1384477
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 46 cost time: 0.9444258213043213
Epoch: 46, Steps: 64 | Train Loss: 0.0783634 Vali Loss: 0.1432435 Test Loss: 0.1370219
Validation loss decreased (0.143361 --> 0.143244).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 47 cost time: 0.9387540817260742
Epoch: 47, Steps: 64 | Train Loss: 0.0786503 Vali Loss: 0.1443512 Test Loss: 0.1377955
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 48 cost time: 0.9553487300872803
Epoch: 48, Steps: 64 | Train Loss: 0.0784200 Vali Loss: 0.1449472 Test Loss: 0.1373594
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 49 cost time: 0.9776411056518555
Epoch: 49, Steps: 64 | Train Loss: 0.0785426 Vali Loss: 0.1432392 Test Loss: 0.1368846
Validation loss decreased (0.143244 --> 0.143239).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 50 cost time: 0.9709992408752441
Epoch: 50, Steps: 64 | Train Loss: 0.0782284 Vali Loss: 0.1426623 Test Loss: 0.1373361
Validation loss decreased (0.143239 --> 0.142662).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 51 cost time: 0.9844174385070801
Epoch: 51, Steps: 64 | Train Loss: 0.0785837 Vali Loss: 0.1422279 Test Loss: 0.1373122
Validation loss decreased (0.142662 --> 0.142228).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 52 cost time: 0.9877526760101318
Epoch: 52, Steps: 64 | Train Loss: 0.0783949 Vali Loss: 0.1441054 Test Loss: 0.1378927
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 53 cost time: 0.9883725643157959
Epoch: 53, Steps: 64 | Train Loss: 0.0785654 Vali Loss: 0.1444768 Test Loss: 0.1377391
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 54 cost time: 0.9813985824584961
Epoch: 54, Steps: 64 | Train Loss: 0.0783100 Vali Loss: 0.1440745 Test Loss: 0.1373088
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 55 cost time: 0.9714269638061523
Epoch: 55, Steps: 64 | Train Loss: 0.0786547 Vali Loss: 0.1439508 Test Loss: 0.1374733
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 56 cost time: 0.9653728008270264
Epoch: 56, Steps: 64 | Train Loss: 0.0784333 Vali Loss: 0.1448976 Test Loss: 0.1371595
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 57 cost time: 0.9657485485076904
Epoch: 57, Steps: 64 | Train Loss: 0.0787504 Vali Loss: 0.1442395 Test Loss: 0.1377586
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 58 cost time: 0.9617671966552734
Epoch: 58, Steps: 64 | Train Loss: 0.0783910 Vali Loss: 0.1431332 Test Loss: 0.1374217
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 59 cost time: 0.9790022373199463
Epoch: 59, Steps: 64 | Train Loss: 0.0781628 Vali Loss: 0.1423105 Test Loss: 0.1373699
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018072128295898438 GB
GPU已分配内存的峰值：0.048114776611328125 GB
Epoch: 60 cost time: 0.9633626937866211
Epoch: 60, Steps: 64 | Train Loss: 0.0785819 Vali Loss: 0.1442467 Test Loss: 0.1372137
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1373121440410614, mae:0.26988857984542847, rse:0.19723112881183624
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.0483860969543457 GB
Epoch: 1 cost time: 2.3371376991271973
Epoch: 1, Steps: 64 | Train Loss: 0.7063703 Vali Loss: 1.6414530 Test Loss: 3.0514402
Validation loss decreased (inf --> 1.641453).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 2 cost time: 0.9849977493286133
Epoch: 2, Steps: 64 | Train Loss: 0.4123873 Vali Loss: 0.3968270 Test Loss: 0.4485756
Validation loss decreased (1.641453 --> 0.396827).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 3 cost time: 0.9789998531341553
Epoch: 3, Steps: 64 | Train Loss: 0.1294025 Vali Loss: 0.2092211 Test Loss: 0.1518428
Validation loss decreased (0.396827 --> 0.209221).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 4 cost time: 0.9746439456939697
Epoch: 4, Steps: 64 | Train Loss: 0.1007616 Vali Loss: 0.1820684 Test Loss: 0.1460323
Validation loss decreased (0.209221 --> 0.182068).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 5 cost time: 0.966620922088623
Epoch: 5, Steps: 64 | Train Loss: 0.0945525 Vali Loss: 0.1737089 Test Loss: 0.1404373
Validation loss decreased (0.182068 --> 0.173709).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 6 cost time: 1.010404109954834
Epoch: 6, Steps: 64 | Train Loss: 0.0912363 Vali Loss: 0.1677336 Test Loss: 0.1391272
Validation loss decreased (0.173709 --> 0.167734).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 7 cost time: 1.0024938583374023
Epoch: 7, Steps: 64 | Train Loss: 0.0889255 Vali Loss: 0.1621715 Test Loss: 0.1373776
Validation loss decreased (0.167734 --> 0.162171).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 8 cost time: 1.0044305324554443
Epoch: 8, Steps: 64 | Train Loss: 0.0870693 Vali Loss: 0.1611886 Test Loss: 0.1369714
Validation loss decreased (0.162171 --> 0.161189).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 9 cost time: 0.9820449352264404
Epoch: 9, Steps: 64 | Train Loss: 0.0861877 Vali Loss: 0.1554174 Test Loss: 0.1355405
Validation loss decreased (0.161189 --> 0.155417).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 10 cost time: 0.9914219379425049
Epoch: 10, Steps: 64 | Train Loss: 0.0848848 Vali Loss: 0.1554704 Test Loss: 0.1354018
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 11 cost time: 1.0074098110198975
Epoch: 11, Steps: 64 | Train Loss: 0.0838076 Vali Loss: 0.1516210 Test Loss: 0.1344110
Validation loss decreased (0.155417 --> 0.151621).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 12 cost time: 1.0134143829345703
Epoch: 12, Steps: 64 | Train Loss: 0.0835491 Vali Loss: 0.1513465 Test Loss: 0.1343091
Validation loss decreased (0.151621 --> 0.151347).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 13 cost time: 1.0040228366851807
Epoch: 13, Steps: 64 | Train Loss: 0.0825135 Vali Loss: 0.1493076 Test Loss: 0.1339692
Validation loss decreased (0.151347 --> 0.149308).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 14 cost time: 1.005401372909546
Epoch: 14, Steps: 64 | Train Loss: 0.0825745 Vali Loss: 0.1476457 Test Loss: 0.1330273
Validation loss decreased (0.149308 --> 0.147646).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 15 cost time: 0.9947896003723145
Epoch: 15, Steps: 64 | Train Loss: 0.0817383 Vali Loss: 0.1478439 Test Loss: 0.1322062
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 16 cost time: 0.9817557334899902
Epoch: 16, Steps: 64 | Train Loss: 0.0812802 Vali Loss: 0.1482881 Test Loss: 0.1332741
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 17 cost time: 1.0106024742126465
Epoch: 17, Steps: 64 | Train Loss: 0.0809581 Vali Loss: 0.1455352 Test Loss: 0.1321609
Validation loss decreased (0.147646 --> 0.145535).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 18 cost time: 0.9809999465942383
Epoch: 18, Steps: 64 | Train Loss: 0.0804726 Vali Loss: 0.1443016 Test Loss: 0.1321845
Validation loss decreased (0.145535 --> 0.144302).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 19 cost time: 1.0056331157684326
Epoch: 19, Steps: 64 | Train Loss: 0.0804844 Vali Loss: 0.1438487 Test Loss: 0.1317168
Validation loss decreased (0.144302 --> 0.143849).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 20 cost time: 1.0107650756835938
Epoch: 20, Steps: 64 | Train Loss: 0.0796825 Vali Loss: 0.1439486 Test Loss: 0.1318126
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 21 cost time: 1.0006418228149414
Epoch: 21, Steps: 64 | Train Loss: 0.0797509 Vali Loss: 0.1453345 Test Loss: 0.1325364
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 22 cost time: 0.9534192085266113
Epoch: 22, Steps: 64 | Train Loss: 0.0792547 Vali Loss: 0.1433575 Test Loss: 0.1318212
Validation loss decreased (0.143849 --> 0.143357).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 23 cost time: 0.9554286003112793
Epoch: 23, Steps: 64 | Train Loss: 0.0796259 Vali Loss: 0.1449972 Test Loss: 0.1316529
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 24 cost time: 0.9563922882080078
Epoch: 24, Steps: 64 | Train Loss: 0.0788741 Vali Loss: 0.1439152 Test Loss: 0.1314621
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 25 cost time: 0.9763984680175781
Epoch: 25, Steps: 64 | Train Loss: 0.0790504 Vali Loss: 0.1423493 Test Loss: 0.1302247
Validation loss decreased (0.143357 --> 0.142349).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 26 cost time: 0.9683859348297119
Epoch: 26, Steps: 64 | Train Loss: 0.0788452 Vali Loss: 0.1413053 Test Loss: 0.1312310
Validation loss decreased (0.142349 --> 0.141305).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 27 cost time: 0.969738245010376
Epoch: 27, Steps: 64 | Train Loss: 0.0789337 Vali Loss: 0.1384732 Test Loss: 0.1310288
Validation loss decreased (0.141305 --> 0.138473).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 28 cost time: 0.9857919216156006
Epoch: 28, Steps: 64 | Train Loss: 0.0783076 Vali Loss: 0.1401045 Test Loss: 0.1311168
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 29 cost time: 0.9743902683258057
Epoch: 29, Steps: 64 | Train Loss: 0.0786341 Vali Loss: 0.1411706 Test Loss: 0.1306240
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 30 cost time: 0.9826126098632812
Epoch: 30, Steps: 64 | Train Loss: 0.0784239 Vali Loss: 0.1417848 Test Loss: 0.1309969
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 31 cost time: 0.9846322536468506
Epoch: 31, Steps: 64 | Train Loss: 0.0787860 Vali Loss: 0.1392749 Test Loss: 0.1304180
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 32 cost time: 0.9755690097808838
Epoch: 32, Steps: 64 | Train Loss: 0.0779084 Vali Loss: 0.1415480 Test Loss: 0.1315307
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 33 cost time: 0.990415096282959
Epoch: 33, Steps: 64 | Train Loss: 0.0775654 Vali Loss: 0.1412313 Test Loss: 0.1303039
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 34 cost time: 1.0115265846252441
Epoch: 34, Steps: 64 | Train Loss: 0.0779108 Vali Loss: 0.1403544 Test Loss: 0.1298516
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 35 cost time: 1.0085651874542236
Epoch: 35, Steps: 64 | Train Loss: 0.0780409 Vali Loss: 0.1409559 Test Loss: 0.1296886
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 36 cost time: 1.0214402675628662
Epoch: 36, Steps: 64 | Train Loss: 0.0780885 Vali Loss: 0.1417411 Test Loss: 0.1304716
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 37 cost time: 1.0130364894866943
Epoch: 37, Steps: 64 | Train Loss: 0.0781754 Vali Loss: 0.1409092 Test Loss: 0.1317959
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 38 cost time: 0.968034029006958
Epoch: 38, Steps: 64 | Train Loss: 0.0779652 Vali Loss: 0.1409000 Test Loss: 0.1300402
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 39 cost time: 0.9598391056060791
Epoch: 39, Steps: 64 | Train Loss: 0.0780521 Vali Loss: 0.1406482 Test Loss: 0.1303899
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 40 cost time: 0.9497873783111572
Epoch: 40, Steps: 64 | Train Loss: 0.0780524 Vali Loss: 0.1392339 Test Loss: 0.1299299
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 41 cost time: 0.9674184322357178
Epoch: 41, Steps: 64 | Train Loss: 0.0781902 Vali Loss: 0.1404004 Test Loss: 0.1304797
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 42 cost time: 0.9736456871032715
Epoch: 42, Steps: 64 | Train Loss: 0.0782162 Vali Loss: 0.1403976 Test Loss: 0.1299981
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 43 cost time: 0.9806349277496338
Epoch: 43, Steps: 64 | Train Loss: 0.0778289 Vali Loss: 0.1403016 Test Loss: 0.1307450
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 44 cost time: 0.9824228286743164
Epoch: 44, Steps: 64 | Train Loss: 0.0775274 Vali Loss: 0.1400830 Test Loss: 0.1295879
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 45 cost time: 0.9717710018157959
Epoch: 45, Steps: 64 | Train Loss: 0.0777066 Vali Loss: 0.1398610 Test Loss: 0.1305684
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 46 cost time: 0.9504432678222656
Epoch: 46, Steps: 64 | Train Loss: 0.0783205 Vali Loss: 0.1403046 Test Loss: 0.1303451
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 47 cost time: 0.9634644985198975
Epoch: 47, Steps: 64 | Train Loss: 0.0775875 Vali Loss: 0.1415211 Test Loss: 0.1301926
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 48 cost time: 0.980384349822998
Epoch: 48, Steps: 64 | Train Loss: 0.0778141 Vali Loss: 0.1388563 Test Loss: 0.1300074
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 49 cost time: 0.995398759841919
Epoch: 49, Steps: 64 | Train Loss: 0.0777163 Vali Loss: 0.1404599 Test Loss: 0.1297151
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 50 cost time: 1.003648042678833
Epoch: 50, Steps: 64 | Train Loss: 0.0778017 Vali Loss: 0.1417781 Test Loss: 0.1301591
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 51 cost time: 1.0117223262786865
Epoch: 51, Steps: 64 | Train Loss: 0.0778030 Vali Loss: 0.1414857 Test Loss: 0.1307965
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 52 cost time: 0.9987456798553467
Epoch: 52, Steps: 64 | Train Loss: 0.0776958 Vali Loss: 0.1388740 Test Loss: 0.1297274
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 53 cost time: 1.0017881393432617
Epoch: 53, Steps: 64 | Train Loss: 0.0777964 Vali Loss: 0.1391679 Test Loss: 0.1303432
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 54 cost time: 1.0036191940307617
Epoch: 54, Steps: 64 | Train Loss: 0.0778681 Vali Loss: 0.1395599 Test Loss: 0.1302831
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 55 cost time: 0.9848024845123291
Epoch: 55, Steps: 64 | Train Loss: 0.0779089 Vali Loss: 0.1395240 Test Loss: 0.1292869
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 56 cost time: 0.9845635890960693
Epoch: 56, Steps: 64 | Train Loss: 0.0777525 Vali Loss: 0.1384849 Test Loss: 0.1300576
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 57 cost time: 0.9898703098297119
Epoch: 57, Steps: 64 | Train Loss: 0.0776756 Vali Loss: 0.1400618 Test Loss: 0.1299568
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 58 cost time: 0.9848785400390625
Epoch: 58, Steps: 64 | Train Loss: 0.0778467 Vali Loss: 0.1396829 Test Loss: 0.1301904
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 59 cost time: 0.9834270477294922
Epoch: 59, Steps: 64 | Train Loss: 0.0779254 Vali Loss: 0.1401912 Test Loss: 0.1306242
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018140792846679688 GB
GPU已分配内存的峰值：0.04963111877441406 GB
Epoch: 60 cost time: 0.9973993301391602
Epoch: 60, Steps: 64 | Train Loss: 0.0777197 Vali Loss: 0.1395529 Test Loss: 0.1295614
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13102881610393524, mae:0.25631529092788696, rse:0.1926656812429428
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049146175384521484 GB
Epoch: 1 cost time: 2.3035728931427
Epoch: 1, Steps: 64 | Train Loss: 1.3798757 Vali Loss: 2.8305995 Test Loss: 5.7188292
Validation loss decreased (inf --> 2.830600).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 2 cost time: 0.9244363307952881
Epoch: 2, Steps: 64 | Train Loss: 0.9289059 Vali Loss: 1.0402365 Test Loss: 1.8538332
Validation loss decreased (2.830600 --> 1.040236).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 3 cost time: 0.8974626064300537
Epoch: 3, Steps: 64 | Train Loss: 0.3968668 Vali Loss: 0.4529533 Test Loss: 0.5948662
Validation loss decreased (1.040236 --> 0.452953).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 4 cost time: 0.8957438468933105
Epoch: 4, Steps: 64 | Train Loss: 0.2326923 Vali Loss: 0.3077758 Test Loss: 0.3379246
Validation loss decreased (0.452953 --> 0.307776).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 5 cost time: 0.8869998455047607
Epoch: 5, Steps: 64 | Train Loss: 0.1817984 Vali Loss: 0.2529820 Test Loss: 0.2557515
Validation loss decreased (0.307776 --> 0.252982).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 6 cost time: 0.8666059970855713
Epoch: 6, Steps: 64 | Train Loss: 0.1607094 Vali Loss: 0.2219461 Test Loss: 0.2137527
Validation loss decreased (0.252982 --> 0.221946).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 7 cost time: 0.8732457160949707
Epoch: 7, Steps: 64 | Train Loss: 0.1494516 Vali Loss: 0.2044294 Test Loss: 0.1895951
Validation loss decreased (0.221946 --> 0.204429).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 8 cost time: 0.8683390617370605
Epoch: 8, Steps: 64 | Train Loss: 0.1413260 Vali Loss: 0.1956387 Test Loss: 0.1794038
Validation loss decreased (0.204429 --> 0.195639).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 9 cost time: 0.8674302101135254
Epoch: 9, Steps: 64 | Train Loss: 0.1360476 Vali Loss: 0.1851343 Test Loss: 0.1704180
Validation loss decreased (0.195639 --> 0.185134).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 10 cost time: 0.9198484420776367
Epoch: 10, Steps: 64 | Train Loss: 0.1320511 Vali Loss: 0.1825010 Test Loss: 0.1671714
Validation loss decreased (0.185134 --> 0.182501).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 11 cost time: 0.9350008964538574
Epoch: 11, Steps: 64 | Train Loss: 0.1290621 Vali Loss: 0.1783400 Test Loss: 0.1634680
Validation loss decreased (0.182501 --> 0.178340).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 12 cost time: 0.926055908203125
Epoch: 12, Steps: 64 | Train Loss: 0.1267508 Vali Loss: 0.1775810 Test Loss: 0.1619889
Validation loss decreased (0.178340 --> 0.177581).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 13 cost time: 0.9256353378295898
Epoch: 13, Steps: 64 | Train Loss: 0.1246074 Vali Loss: 0.1726909 Test Loss: 0.1596569
Validation loss decreased (0.177581 --> 0.172691).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 14 cost time: 0.9284045696258545
Epoch: 14, Steps: 64 | Train Loss: 0.1229833 Vali Loss: 0.1717978 Test Loss: 0.1583153
Validation loss decreased (0.172691 --> 0.171798).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 15 cost time: 0.9003617763519287
Epoch: 15, Steps: 64 | Train Loss: 0.1208762 Vali Loss: 0.1701058 Test Loss: 0.1577952
Validation loss decreased (0.171798 --> 0.170106).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 16 cost time: 0.9055113792419434
Epoch: 16, Steps: 64 | Train Loss: 0.1207126 Vali Loss: 0.1706997 Test Loss: 0.1577982
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 17 cost time: 0.9016447067260742
Epoch: 17, Steps: 64 | Train Loss: 0.1190947 Vali Loss: 0.1670379 Test Loss: 0.1563266
Validation loss decreased (0.170106 --> 0.167038).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 18 cost time: 0.9100019931793213
Epoch: 18, Steps: 64 | Train Loss: 0.1179018 Vali Loss: 0.1675454 Test Loss: 0.1563193
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 19 cost time: 0.9246377944946289
Epoch: 19, Steps: 64 | Train Loss: 0.1168756 Vali Loss: 0.1667256 Test Loss: 0.1550592
Validation loss decreased (0.167038 --> 0.166726).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 20 cost time: 0.9229562282562256
Epoch: 20, Steps: 64 | Train Loss: 0.1161623 Vali Loss: 0.1668468 Test Loss: 0.1555565
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 21 cost time: 0.9104354381561279
Epoch: 21, Steps: 64 | Train Loss: 0.1153583 Vali Loss: 0.1646303 Test Loss: 0.1544172
Validation loss decreased (0.166726 --> 0.164630).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 22 cost time: 0.8983626365661621
Epoch: 22, Steps: 64 | Train Loss: 0.1146108 Vali Loss: 0.1639352 Test Loss: 0.1543963
Validation loss decreased (0.164630 --> 0.163935).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 23 cost time: 0.8777689933776855
Epoch: 23, Steps: 64 | Train Loss: 0.1139632 Vali Loss: 0.1658759 Test Loss: 0.1544712
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 24 cost time: 0.8789997100830078
Epoch: 24, Steps: 64 | Train Loss: 0.1138085 Vali Loss: 0.1656080 Test Loss: 0.1542125
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 25 cost time: 0.8850843906402588
Epoch: 25, Steps: 64 | Train Loss: 0.1136584 Vali Loss: 0.1628330 Test Loss: 0.1541723
Validation loss decreased (0.163935 --> 0.162833).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 26 cost time: 0.8815891742706299
Epoch: 26, Steps: 64 | Train Loss: 0.1125872 Vali Loss: 0.1631210 Test Loss: 0.1532877
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 27 cost time: 0.8773818016052246
Epoch: 27, Steps: 64 | Train Loss: 0.1120290 Vali Loss: 0.1624869 Test Loss: 0.1538522
Validation loss decreased (0.162833 --> 0.162487).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 28 cost time: 0.9013898372650146
Epoch: 28, Steps: 64 | Train Loss: 0.1122516 Vali Loss: 0.1638326 Test Loss: 0.1537703
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 29 cost time: 0.9018614292144775
Epoch: 29, Steps: 64 | Train Loss: 0.1129402 Vali Loss: 0.1633810 Test Loss: 0.1536620
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 30 cost time: 0.8977625370025635
Epoch: 30, Steps: 64 | Train Loss: 0.1106363 Vali Loss: 0.1614708 Test Loss: 0.1528668
Validation loss decreased (0.162487 --> 0.161471).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 31 cost time: 0.90763258934021
Epoch: 31, Steps: 64 | Train Loss: 0.1113433 Vali Loss: 0.1634179 Test Loss: 0.1530974
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 32 cost time: 0.9174025058746338
Epoch: 32, Steps: 64 | Train Loss: 0.1112950 Vali Loss: 0.1625843 Test Loss: 0.1525605
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 33 cost time: 0.9053847789764404
Epoch: 33, Steps: 64 | Train Loss: 0.1101522 Vali Loss: 0.1638974 Test Loss: 0.1539866
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 34 cost time: 0.9013760089874268
Epoch: 34, Steps: 64 | Train Loss: 0.1106987 Vali Loss: 0.1625594 Test Loss: 0.1526204
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 35 cost time: 0.904773473739624
Epoch: 35, Steps: 64 | Train Loss: 0.1106409 Vali Loss: 0.1617820 Test Loss: 0.1526743
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 36 cost time: 0.9079999923706055
Epoch: 36, Steps: 64 | Train Loss: 0.1102173 Vali Loss: 0.1602507 Test Loss: 0.1523230
Validation loss decreased (0.161471 --> 0.160251).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 37 cost time: 0.9206264019012451
Epoch: 37, Steps: 64 | Train Loss: 0.1108157 Vali Loss: 0.1622684 Test Loss: 0.1519881
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 38 cost time: 0.9253873825073242
Epoch: 38, Steps: 64 | Train Loss: 0.1101858 Vali Loss: 0.1621738 Test Loss: 0.1529281
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 39 cost time: 0.9310824871063232
Epoch: 39, Steps: 64 | Train Loss: 0.1102878 Vali Loss: 0.1611419 Test Loss: 0.1519843
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 40 cost time: 0.9203622341156006
Epoch: 40, Steps: 64 | Train Loss: 0.1103345 Vali Loss: 0.1606210 Test Loss: 0.1524814
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 41 cost time: 0.8945033550262451
Epoch: 41, Steps: 64 | Train Loss: 0.1095696 Vali Loss: 0.1625035 Test Loss: 0.1529523
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 42 cost time: 0.9118614196777344
Epoch: 42, Steps: 64 | Train Loss: 0.1099585 Vali Loss: 0.1609495 Test Loss: 0.1526497
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 43 cost time: 0.8839995861053467
Epoch: 43, Steps: 64 | Train Loss: 0.1096661 Vali Loss: 0.1610302 Test Loss: 0.1518203
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 44 cost time: 0.8756382465362549
Epoch: 44, Steps: 64 | Train Loss: 0.1096471 Vali Loss: 0.1604696 Test Loss: 0.1525480
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 45 cost time: 0.8793857097625732
Epoch: 45, Steps: 64 | Train Loss: 0.1094113 Vali Loss: 0.1614860 Test Loss: 0.1521209
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 46 cost time: 0.9054112434387207
Epoch: 46, Steps: 64 | Train Loss: 0.1100053 Vali Loss: 0.1601354 Test Loss: 0.1525490
Validation loss decreased (0.160251 --> 0.160135).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 47 cost time: 0.8918101787567139
Epoch: 47, Steps: 64 | Train Loss: 0.1095912 Vali Loss: 0.1622370 Test Loss: 0.1520862
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 48 cost time: 0.8936004638671875
Epoch: 48, Steps: 64 | Train Loss: 0.1088681 Vali Loss: 0.1610759 Test Loss: 0.1524821
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 49 cost time: 0.88100266456604
Epoch: 49, Steps: 64 | Train Loss: 0.1095915 Vali Loss: 0.1612783 Test Loss: 0.1527634
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 50 cost time: 0.8943803310394287
Epoch: 50, Steps: 64 | Train Loss: 0.1088329 Vali Loss: 0.1615344 Test Loss: 0.1515680
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 51 cost time: 0.8833825588226318
Epoch: 51, Steps: 64 | Train Loss: 0.1100036 Vali Loss: 0.1618364 Test Loss: 0.1519199
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 52 cost time: 0.913409948348999
Epoch: 52, Steps: 64 | Train Loss: 0.1093638 Vali Loss: 0.1603638 Test Loss: 0.1521972
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 53 cost time: 0.9063725471496582
Epoch: 53, Steps: 64 | Train Loss: 0.1091890 Vali Loss: 0.1621384 Test Loss: 0.1522556
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 54 cost time: 0.9218175411224365
Epoch: 54, Steps: 64 | Train Loss: 0.1095742 Vali Loss: 0.1614766 Test Loss: 0.1519251
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 55 cost time: 0.9240002632141113
Epoch: 55, Steps: 64 | Train Loss: 0.1091427 Vali Loss: 0.1621279 Test Loss: 0.1526351
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 56 cost time: 0.9216287136077881
Epoch: 56, Steps: 64 | Train Loss: 0.1088410 Vali Loss: 0.1614980 Test Loss: 0.1525507
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 57 cost time: 0.9006931781768799
Epoch: 57, Steps: 64 | Train Loss: 0.1088364 Vali Loss: 0.1615731 Test Loss: 0.1520120
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 58 cost time: 0.9236111640930176
Epoch: 58, Steps: 64 | Train Loss: 0.1095474 Vali Loss: 0.1610564 Test Loss: 0.1521364
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 59 cost time: 0.9214966297149658
Epoch: 59, Steps: 64 | Train Loss: 0.1089729 Vali Loss: 0.1613052 Test Loss: 0.1526343
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018098831176757812 GB
GPU已分配内存的峰值：0.049942970275878906 GB
Epoch: 60 cost time: 0.915795087814331
Epoch: 60, Steps: 64 | Train Loss: 0.1092032 Vali Loss: 0.1606471 Test Loss: 0.1525316
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15254895389080048, mae:0.29538336396217346, rse:0.20788617432117462
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.05057811737060547 GB
Epoch: 1 cost time: 2.3010172843933105
Epoch: 1, Steps: 64 | Train Loss: 0.7719375 Vali Loss: 1.7454113 Test Loss: 3.2640164
Validation loss decreased (inf --> 1.745411).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 2 cost time: 0.926398515701294
Epoch: 2, Steps: 64 | Train Loss: 0.4832293 Vali Loss: 0.5567344 Test Loss: 0.7695924
Validation loss decreased (1.745411 --> 0.556734).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 3 cost time: 0.9299981594085693
Epoch: 3, Steps: 64 | Train Loss: 0.1699119 Vali Loss: 0.2210980 Test Loss: 0.1844389
Validation loss decreased (0.556734 --> 0.221098).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 4 cost time: 0.9316418170928955
Epoch: 4, Steps: 64 | Train Loss: 0.1120192 Vali Loss: 0.1884509 Test Loss: 0.1606759
Validation loss decreased (0.221098 --> 0.188451).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 5 cost time: 0.9126365184783936
Epoch: 5, Steps: 64 | Train Loss: 0.1039000 Vali Loss: 0.1811953 Test Loss: 0.1573114
Validation loss decreased (0.188451 --> 0.181195).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 6 cost time: 0.9029428958892822
Epoch: 6, Steps: 64 | Train Loss: 0.0995173 Vali Loss: 0.1729118 Test Loss: 0.1534065
Validation loss decreased (0.181195 --> 0.172912).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 7 cost time: 0.9164166450500488
Epoch: 7, Steps: 64 | Train Loss: 0.0964640 Vali Loss: 0.1682763 Test Loss: 0.1517258
Validation loss decreased (0.172912 --> 0.168276).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 8 cost time: 0.9194071292877197
Epoch: 8, Steps: 64 | Train Loss: 0.0948872 Vali Loss: 0.1667785 Test Loss: 0.1507962
Validation loss decreased (0.168276 --> 0.166778).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 9 cost time: 0.9147348403930664
Epoch: 9, Steps: 64 | Train Loss: 0.0928487 Vali Loss: 0.1638586 Test Loss: 0.1488491
Validation loss decreased (0.166778 --> 0.163859).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 10 cost time: 0.9320013523101807
Epoch: 10, Steps: 64 | Train Loss: 0.0917516 Vali Loss: 0.1643327 Test Loss: 0.1487025
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 11 cost time: 0.9539992809295654
Epoch: 11, Steps: 64 | Train Loss: 0.0907407 Vali Loss: 0.1631390 Test Loss: 0.1484476
Validation loss decreased (0.163859 --> 0.163139).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 12 cost time: 0.9520936012268066
Epoch: 12, Steps: 64 | Train Loss: 0.0896775 Vali Loss: 0.1601374 Test Loss: 0.1480908
Validation loss decreased (0.163139 --> 0.160137).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 13 cost time: 0.9543204307556152
Epoch: 13, Steps: 64 | Train Loss: 0.0889552 Vali Loss: 0.1611967 Test Loss: 0.1480525
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 14 cost time: 0.9444451332092285
Epoch: 14, Steps: 64 | Train Loss: 0.0885786 Vali Loss: 0.1591017 Test Loss: 0.1475578
Validation loss decreased (0.160137 --> 0.159102).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 15 cost time: 0.9364092350006104
Epoch: 15, Steps: 64 | Train Loss: 0.0877507 Vali Loss: 0.1594328 Test Loss: 0.1475586
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 16 cost time: 0.9393918514251709
Epoch: 16, Steps: 64 | Train Loss: 0.0870927 Vali Loss: 0.1590573 Test Loss: 0.1469779
Validation loss decreased (0.159102 --> 0.159057).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 17 cost time: 0.9368243217468262
Epoch: 17, Steps: 64 | Train Loss: 0.0869847 Vali Loss: 0.1562545 Test Loss: 0.1462900
Validation loss decreased (0.159057 --> 0.156255).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 18 cost time: 0.9430012702941895
Epoch: 18, Steps: 64 | Train Loss: 0.0862896 Vali Loss: 0.1582060 Test Loss: 0.1472925
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 19 cost time: 0.9529986381530762
Epoch: 19, Steps: 64 | Train Loss: 0.0857064 Vali Loss: 0.1575983 Test Loss: 0.1462175
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 20 cost time: 0.956385612487793
Epoch: 20, Steps: 64 | Train Loss: 0.0859792 Vali Loss: 0.1565766 Test Loss: 0.1458961
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 21 cost time: 0.93851637840271
Epoch: 21, Steps: 64 | Train Loss: 0.0854055 Vali Loss: 0.1564688 Test Loss: 0.1457372
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 22 cost time: 0.9198763370513916
Epoch: 22, Steps: 64 | Train Loss: 0.0852791 Vali Loss: 0.1557189 Test Loss: 0.1455481
Validation loss decreased (0.156255 --> 0.155719).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 23 cost time: 0.9014804363250732
Epoch: 23, Steps: 64 | Train Loss: 0.0851584 Vali Loss: 0.1562026 Test Loss: 0.1457600
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 24 cost time: 0.9072563648223877
Epoch: 24, Steps: 64 | Train Loss: 0.0846486 Vali Loss: 0.1547048 Test Loss: 0.1455775
Validation loss decreased (0.155719 --> 0.154705).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 25 cost time: 0.9025888442993164
Epoch: 25, Steps: 64 | Train Loss: 0.0844434 Vali Loss: 0.1566010 Test Loss: 0.1466802
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 26 cost time: 0.9060001373291016
Epoch: 26, Steps: 64 | Train Loss: 0.0843842 Vali Loss: 0.1558581 Test Loss: 0.1457655
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 27 cost time: 0.9206430912017822
Epoch: 27, Steps: 64 | Train Loss: 0.0840014 Vali Loss: 0.1546754 Test Loss: 0.1458846
Validation loss decreased (0.154705 --> 0.154675).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 28 cost time: 0.932426929473877
Epoch: 28, Steps: 64 | Train Loss: 0.0841427 Vali Loss: 0.1540199 Test Loss: 0.1453122
Validation loss decreased (0.154675 --> 0.154020).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 29 cost time: 0.9173598289489746
Epoch: 29, Steps: 64 | Train Loss: 0.0843372 Vali Loss: 0.1530349 Test Loss: 0.1454670
Validation loss decreased (0.154020 --> 0.153035).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 30 cost time: 0.9434530735015869
Epoch: 30, Steps: 64 | Train Loss: 0.0840151 Vali Loss: 0.1554191 Test Loss: 0.1454822
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 31 cost time: 0.9543936252593994
Epoch: 31, Steps: 64 | Train Loss: 0.0838322 Vali Loss: 0.1544941 Test Loss: 0.1458665
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 32 cost time: 0.9337623119354248
Epoch: 32, Steps: 64 | Train Loss: 0.0838066 Vali Loss: 0.1535327 Test Loss: 0.1455509
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 33 cost time: 0.9344425201416016
Epoch: 33, Steps: 64 | Train Loss: 0.0840079 Vali Loss: 0.1544918 Test Loss: 0.1455848
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 34 cost time: 0.9416460990905762
Epoch: 34, Steps: 64 | Train Loss: 0.0834813 Vali Loss: 0.1534970 Test Loss: 0.1449365
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 35 cost time: 0.9444000720977783
Epoch: 35, Steps: 64 | Train Loss: 0.0836497 Vali Loss: 0.1539606 Test Loss: 0.1454590
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 36 cost time: 0.950308084487915
Epoch: 36, Steps: 64 | Train Loss: 0.0836850 Vali Loss: 0.1546537 Test Loss: 0.1450179
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 37 cost time: 0.9442296028137207
Epoch: 37, Steps: 64 | Train Loss: 0.0831523 Vali Loss: 0.1524533 Test Loss: 0.1454085
Validation loss decreased (0.153035 --> 0.152453).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 38 cost time: 0.9604418277740479
Epoch: 38, Steps: 64 | Train Loss: 0.0833117 Vali Loss: 0.1550467 Test Loss: 0.1454207
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 39 cost time: 0.960496187210083
Epoch: 39, Steps: 64 | Train Loss: 0.0836133 Vali Loss: 0.1526059 Test Loss: 0.1449520
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 40 cost time: 0.9427633285522461
Epoch: 40, Steps: 64 | Train Loss: 0.0837401 Vali Loss: 0.1520794 Test Loss: 0.1454745
Validation loss decreased (0.152453 --> 0.152079).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 41 cost time: 0.9449989795684814
Epoch: 41, Steps: 64 | Train Loss: 0.0834787 Vali Loss: 0.1544278 Test Loss: 0.1454571
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 42 cost time: 0.9056458473205566
Epoch: 42, Steps: 64 | Train Loss: 0.0833627 Vali Loss: 0.1544445 Test Loss: 0.1451068
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 43 cost time: 0.9014809131622314
Epoch: 43, Steps: 64 | Train Loss: 0.0827823 Vali Loss: 0.1547523 Test Loss: 0.1450580
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 44 cost time: 0.907374382019043
Epoch: 44, Steps: 64 | Train Loss: 0.0829296 Vali Loss: 0.1536105 Test Loss: 0.1452337
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 45 cost time: 0.9274780750274658
Epoch: 45, Steps: 64 | Train Loss: 0.0830897 Vali Loss: 0.1514978 Test Loss: 0.1451396
Validation loss decreased (0.152079 --> 0.151498).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 46 cost time: 0.9273567199707031
Epoch: 46, Steps: 64 | Train Loss: 0.0832493 Vali Loss: 0.1539890 Test Loss: 0.1455084
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 47 cost time: 0.9473698139190674
Epoch: 47, Steps: 64 | Train Loss: 0.0827133 Vali Loss: 0.1542829 Test Loss: 0.1454174
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 48 cost time: 0.9540002346038818
Epoch: 48, Steps: 64 | Train Loss: 0.0830650 Vali Loss: 0.1536668 Test Loss: 0.1447028
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 49 cost time: 0.9206364154815674
Epoch: 49, Steps: 64 | Train Loss: 0.0834747 Vali Loss: 0.1523791 Test Loss: 0.1450872
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 50 cost time: 0.9412777423858643
Epoch: 50, Steps: 64 | Train Loss: 0.0833124 Vali Loss: 0.1529556 Test Loss: 0.1454539
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 51 cost time: 0.9503288269042969
Epoch: 51, Steps: 64 | Train Loss: 0.0832829 Vali Loss: 0.1528256 Test Loss: 0.1448405
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 52 cost time: 0.9480762481689453
Epoch: 52, Steps: 64 | Train Loss: 0.0829424 Vali Loss: 0.1544968 Test Loss: 0.1450161
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 53 cost time: 0.9502439498901367
Epoch: 53, Steps: 64 | Train Loss: 0.0829479 Vali Loss: 0.1531458 Test Loss: 0.1453039
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 54 cost time: 0.9507780075073242
Epoch: 54, Steps: 64 | Train Loss: 0.0833676 Vali Loss: 0.1532045 Test Loss: 0.1448713
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 55 cost time: 0.9584522247314453
Epoch: 55, Steps: 64 | Train Loss: 0.0832016 Vali Loss: 0.1538254 Test Loss: 0.1456571
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 56 cost time: 0.8899996280670166
Epoch: 56, Steps: 64 | Train Loss: 0.0828069 Vali Loss: 0.1528959 Test Loss: 0.1459527
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 57 cost time: 0.9526219367980957
Epoch: 57, Steps: 64 | Train Loss: 0.0831423 Vali Loss: 0.1522030 Test Loss: 0.1447872
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 58 cost time: 0.943385124206543
Epoch: 58, Steps: 64 | Train Loss: 0.0830096 Vali Loss: 0.1522718 Test Loss: 0.1449669
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 59 cost time: 0.9394044876098633
Epoch: 59, Steps: 64 | Train Loss: 0.0828814 Vali Loss: 0.1524552 Test Loss: 0.1450095
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018228530883789062 GB
GPU已分配内存的峰值：0.051505088806152344 GB
Epoch: 60 cost time: 0.9051225185394287
Epoch: 60, Steps: 64 | Train Loss: 0.0832064 Vali Loss: 0.1536618 Test Loss: 0.1456969
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14513954520225525, mae:0.2819634675979614, rse:0.20277473330497742
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05169820785522461 GB
Epoch: 1 cost time: 2.3561792373657227
Epoch: 1, Steps: 64 | Train Loss: 0.8005910 Vali Loss: 1.8506151 Test Loss: 3.5675197
Validation loss decreased (inf --> 1.850615).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 2 cost time: 0.9801363945007324
Epoch: 2, Steps: 64 | Train Loss: 0.5447138 Vali Loss: 0.7097155 Test Loss: 1.1437830
Validation loss decreased (1.850615 --> 0.709716).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 3 cost time: 0.9515550136566162
Epoch: 3, Steps: 64 | Train Loss: 0.1910256 Vali Loss: 0.2289743 Test Loss: 0.1992674
Validation loss decreased (0.709716 --> 0.228974).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 4 cost time: 0.9643874168395996
Epoch: 4, Steps: 64 | Train Loss: 0.1107258 Vali Loss: 0.1967150 Test Loss: 0.1716823
Validation loss decreased (0.228974 --> 0.196715).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 5 cost time: 0.9407272338867188
Epoch: 5, Steps: 64 | Train Loss: 0.1002823 Vali Loss: 0.1801514 Test Loss: 0.1582131
Validation loss decreased (0.196715 --> 0.180151).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 6 cost time: 0.9389991760253906
Epoch: 6, Steps: 64 | Train Loss: 0.0960036 Vali Loss: 0.1742685 Test Loss: 0.1557107
Validation loss decreased (0.180151 --> 0.174269).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 7 cost time: 0.9285168647766113
Epoch: 7, Steps: 64 | Train Loss: 0.0930220 Vali Loss: 0.1681107 Test Loss: 0.1529018
Validation loss decreased (0.174269 --> 0.168111).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 8 cost time: 0.9386141300201416
Epoch: 8, Steps: 64 | Train Loss: 0.0909530 Vali Loss: 0.1647222 Test Loss: 0.1499639
Validation loss decreased (0.168111 --> 0.164722).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 9 cost time: 0.946359395980835
Epoch: 9, Steps: 64 | Train Loss: 0.0891801 Vali Loss: 0.1608573 Test Loss: 0.1487022
Validation loss decreased (0.164722 --> 0.160857).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 10 cost time: 0.9675159454345703
Epoch: 10, Steps: 64 | Train Loss: 0.0884235 Vali Loss: 0.1595436 Test Loss: 0.1477727
Validation loss decreased (0.160857 --> 0.159544).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 11 cost time: 0.9808285236358643
Epoch: 11, Steps: 64 | Train Loss: 0.0872421 Vali Loss: 0.1598843 Test Loss: 0.1470357
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 12 cost time: 0.9845144748687744
Epoch: 12, Steps: 64 | Train Loss: 0.0862500 Vali Loss: 0.1576195 Test Loss: 0.1458967
Validation loss decreased (0.159544 --> 0.157620).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 13 cost time: 0.9764947891235352
Epoch: 13, Steps: 64 | Train Loss: 0.0857954 Vali Loss: 0.1568617 Test Loss: 0.1461055
Validation loss decreased (0.157620 --> 0.156862).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 14 cost time: 0.9643912315368652
Epoch: 14, Steps: 64 | Train Loss: 0.0847953 Vali Loss: 0.1543193 Test Loss: 0.1449990
Validation loss decreased (0.156862 --> 0.154319).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 15 cost time: 0.9640002250671387
Epoch: 15, Steps: 64 | Train Loss: 0.0852863 Vali Loss: 0.1559534 Test Loss: 0.1457615
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 16 cost time: 0.9669983386993408
Epoch: 16, Steps: 64 | Train Loss: 0.0844278 Vali Loss: 0.1546130 Test Loss: 0.1459817
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 17 cost time: 0.9646468162536621
Epoch: 17, Steps: 64 | Train Loss: 0.0837517 Vali Loss: 0.1542086 Test Loss: 0.1448568
Validation loss decreased (0.154319 --> 0.154209).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 18 cost time: 0.9904744625091553
Epoch: 18, Steps: 64 | Train Loss: 0.0839937 Vali Loss: 0.1535520 Test Loss: 0.1443917
Validation loss decreased (0.154209 --> 0.153552).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 19 cost time: 0.9814627170562744
Epoch: 19, Steps: 64 | Train Loss: 0.0834896 Vali Loss: 0.1534210 Test Loss: 0.1445174
Validation loss decreased (0.153552 --> 0.153421).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 20 cost time: 0.9724233150482178
Epoch: 20, Steps: 64 | Train Loss: 0.0831149 Vali Loss: 0.1522594 Test Loss: 0.1441844
Validation loss decreased (0.153421 --> 0.152259).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 21 cost time: 0.9804525375366211
Epoch: 21, Steps: 64 | Train Loss: 0.0825271 Vali Loss: 0.1523033 Test Loss: 0.1440646
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 22 cost time: 0.9737832546234131
Epoch: 22, Steps: 64 | Train Loss: 0.0824513 Vali Loss: 0.1496850 Test Loss: 0.1436505
Validation loss decreased (0.152259 --> 0.149685).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 23 cost time: 0.9369113445281982
Epoch: 23, Steps: 64 | Train Loss: 0.0823627 Vali Loss: 0.1504042 Test Loss: 0.1440210
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 24 cost time: 0.934852123260498
Epoch: 24, Steps: 64 | Train Loss: 0.0821217 Vali Loss: 0.1501443 Test Loss: 0.1437614
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 25 cost time: 0.9400002956390381
Epoch: 25, Steps: 64 | Train Loss: 0.0822090 Vali Loss: 0.1511283 Test Loss: 0.1436307
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 26 cost time: 0.9470202922821045
Epoch: 26, Steps: 64 | Train Loss: 0.0818526 Vali Loss: 0.1495104 Test Loss: 0.1432332
Validation loss decreased (0.149685 --> 0.149510).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 27 cost time: 0.9633889198303223
Epoch: 27, Steps: 64 | Train Loss: 0.0820907 Vali Loss: 0.1516512 Test Loss: 0.1437608
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 28 cost time: 0.9543819427490234
Epoch: 28, Steps: 64 | Train Loss: 0.0818192 Vali Loss: 0.1513068 Test Loss: 0.1437984
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 29 cost time: 0.9814026355743408
Epoch: 29, Steps: 64 | Train Loss: 0.0815537 Vali Loss: 0.1497631 Test Loss: 0.1435961
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 30 cost time: 0.9844551086425781
Epoch: 30, Steps: 64 | Train Loss: 0.0814179 Vali Loss: 0.1512318 Test Loss: 0.1429052
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 31 cost time: 0.9724986553192139
Epoch: 31, Steps: 64 | Train Loss: 0.0817498 Vali Loss: 0.1500164 Test Loss: 0.1436855
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 32 cost time: 0.9955284595489502
Epoch: 32, Steps: 64 | Train Loss: 0.0815569 Vali Loss: 0.1510739 Test Loss: 0.1447749
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 33 cost time: 0.965764045715332
Epoch: 33, Steps: 64 | Train Loss: 0.0809110 Vali Loss: 0.1493652 Test Loss: 0.1432687
Validation loss decreased (0.149510 --> 0.149365).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 34 cost time: 0.9604053497314453
Epoch: 34, Steps: 64 | Train Loss: 0.0808838 Vali Loss: 0.1489328 Test Loss: 0.1434405
Validation loss decreased (0.149365 --> 0.148933).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 35 cost time: 0.9860000610351562
Epoch: 35, Steps: 64 | Train Loss: 0.0810698 Vali Loss: 0.1498419 Test Loss: 0.1434575
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 36 cost time: 0.9806451797485352
Epoch: 36, Steps: 64 | Train Loss: 0.0811967 Vali Loss: 0.1476921 Test Loss: 0.1433178
Validation loss decreased (0.148933 --> 0.147692).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 37 cost time: 0.9814035892486572
Epoch: 37, Steps: 64 | Train Loss: 0.0811991 Vali Loss: 0.1485800 Test Loss: 0.1428731
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 38 cost time: 0.9817757606506348
Epoch: 38, Steps: 64 | Train Loss: 0.0809316 Vali Loss: 0.1478456 Test Loss: 0.1434365
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 39 cost time: 0.9645111560821533
Epoch: 39, Steps: 64 | Train Loss: 0.0807206 Vali Loss: 0.1482783 Test Loss: 0.1437005
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 40 cost time: 0.9284367561340332
Epoch: 40, Steps: 64 | Train Loss: 0.0810292 Vali Loss: 0.1487301 Test Loss: 0.1433906
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 41 cost time: 0.937427282333374
Epoch: 41, Steps: 64 | Train Loss: 0.0809458 Vali Loss: 0.1479876 Test Loss: 0.1434806
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 42 cost time: 0.9397425651550293
Epoch: 42, Steps: 64 | Train Loss: 0.0810012 Vali Loss: 0.1478779 Test Loss: 0.1431891
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 43 cost time: 0.931999921798706
Epoch: 43, Steps: 64 | Train Loss: 0.0804619 Vali Loss: 0.1477750 Test Loss: 0.1434707
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 44 cost time: 0.95863938331604
Epoch: 44, Steps: 64 | Train Loss: 0.0809592 Vali Loss: 0.1501800 Test Loss: 0.1431071
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 45 cost time: 0.9566292762756348
Epoch: 45, Steps: 64 | Train Loss: 0.0806052 Vali Loss: 0.1479445 Test Loss: 0.1430829
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 46 cost time: 0.9614195823669434
Epoch: 46, Steps: 64 | Train Loss: 0.0805234 Vali Loss: 0.1484873 Test Loss: 0.1426388
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 47 cost time: 0.9620144367218018
Epoch: 47, Steps: 64 | Train Loss: 0.0809944 Vali Loss: 0.1489044 Test Loss: 0.1430005
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 48 cost time: 0.9643950462341309
Epoch: 48, Steps: 64 | Train Loss: 0.0808451 Vali Loss: 0.1484709 Test Loss: 0.1427145
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 49 cost time: 0.9764692783355713
Epoch: 49, Steps: 64 | Train Loss: 0.0803385 Vali Loss: 0.1492189 Test Loss: 0.1431858
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 50 cost time: 0.970728874206543
Epoch: 50, Steps: 64 | Train Loss: 0.0806979 Vali Loss: 0.1489916 Test Loss: 0.1429030
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 51 cost time: 0.9711587429046631
Epoch: 51, Steps: 64 | Train Loss: 0.0808376 Vali Loss: 0.1477597 Test Loss: 0.1431540
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 52 cost time: 0.9809999465942383
Epoch: 52, Steps: 64 | Train Loss: 0.0806977 Vali Loss: 0.1474865 Test Loss: 0.1425481
Validation loss decreased (0.147692 --> 0.147486).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 53 cost time: 0.9536380767822266
Epoch: 53, Steps: 64 | Train Loss: 0.0803749 Vali Loss: 0.1482275 Test Loss: 0.1431873
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 54 cost time: 0.992668867111206
Epoch: 54, Steps: 64 | Train Loss: 0.0805413 Vali Loss: 0.1483349 Test Loss: 0.1426683
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 55 cost time: 0.9794266223907471
Epoch: 55, Steps: 64 | Train Loss: 0.0804914 Vali Loss: 0.1480960 Test Loss: 0.1432489
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 56 cost time: 0.9687356948852539
Epoch: 56, Steps: 64 | Train Loss: 0.0804674 Vali Loss: 0.1480031 Test Loss: 0.1421068
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 57 cost time: 0.9354016780853271
Epoch: 57, Steps: 64 | Train Loss: 0.0806030 Vali Loss: 0.1489064 Test Loss: 0.1426571
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 58 cost time: 0.9334328174591064
Epoch: 58, Steps: 64 | Train Loss: 0.0803314 Vali Loss: 0.1486736 Test Loss: 0.1433182
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 59 cost time: 0.9364068508148193
Epoch: 59, Steps: 64 | Train Loss: 0.0806091 Vali Loss: 0.1473340 Test Loss: 0.1425738
Validation loss decreased (0.147486 --> 0.147334).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018297195434570312 GB
GPU已分配内存的峰值：0.05302143096923828 GB
Epoch: 60 cost time: 0.9259994029998779
Epoch: 60, Steps: 64 | Train Loss: 0.0803721 Vali Loss: 0.1486224 Test Loss: 0.1428898
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14257381856441498, mae:0.2794426381587982, rse:0.2009744495153427
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.049307823181152344 GB
Epoch: 1 cost time: 2.2970054149627686
Epoch: 1, Steps: 64 | Train Loss: 0.9632791 Vali Loss: 1.9369776 Test Loss: 3.6728961
Validation loss decreased (inf --> 1.936978).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 2 cost time: 0.9370357990264893
Epoch: 2, Steps: 64 | Train Loss: 0.6504644 Vali Loss: 0.7714244 Test Loss: 1.2259524
Validation loss decreased (1.936978 --> 0.771424).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 3 cost time: 0.9060006141662598
Epoch: 3, Steps: 64 | Train Loss: 0.3367682 Vali Loss: 0.3996512 Test Loss: 0.4508009
Validation loss decreased (0.771424 --> 0.399651).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 4 cost time: 0.9215292930603027
Epoch: 4, Steps: 64 | Train Loss: 0.2051498 Vali Loss: 0.2785151 Test Loss: 0.2351335
Validation loss decreased (0.399651 --> 0.278515).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 5 cost time: 0.9263911247253418
Epoch: 5, Steps: 64 | Train Loss: 0.1631362 Vali Loss: 0.2420084 Test Loss: 0.1884751
Validation loss decreased (0.278515 --> 0.242008).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 6 cost time: 0.9314529895782471
Epoch: 6, Steps: 64 | Train Loss: 0.1457859 Vali Loss: 0.2227894 Test Loss: 0.1717166
Validation loss decreased (0.242008 --> 0.222789).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 7 cost time: 0.9333992004394531
Epoch: 7, Steps: 64 | Train Loss: 0.1372090 Vali Loss: 0.2074053 Test Loss: 0.1631662
Validation loss decreased (0.222789 --> 0.207405).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 8 cost time: 0.9228026866912842
Epoch: 8, Steps: 64 | Train Loss: 0.1294538 Vali Loss: 0.1974659 Test Loss: 0.1558701
Validation loss decreased (0.207405 --> 0.197466).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 9 cost time: 0.9328699111938477
Epoch: 9, Steps: 64 | Train Loss: 0.1251097 Vali Loss: 0.1893231 Test Loss: 0.1527480
Validation loss decreased (0.197466 --> 0.189323).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 10 cost time: 0.9100017547607422
Epoch: 10, Steps: 64 | Train Loss: 0.1220183 Vali Loss: 0.1863977 Test Loss: 0.1506146
Validation loss decreased (0.189323 --> 0.186398).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 11 cost time: 0.93387770652771
Epoch: 11, Steps: 64 | Train Loss: 0.1188682 Vali Loss: 0.1786503 Test Loss: 0.1492019
Validation loss decreased (0.186398 --> 0.178650).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 12 cost time: 0.9320454597473145
Epoch: 12, Steps: 64 | Train Loss: 0.1162751 Vali Loss: 0.1761934 Test Loss: 0.1479784
Validation loss decreased (0.178650 --> 0.176193).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 13 cost time: 0.9446523189544678
Epoch: 13, Steps: 64 | Train Loss: 0.1141152 Vali Loss: 0.1736136 Test Loss: 0.1466603
Validation loss decreased (0.176193 --> 0.173614).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 14 cost time: 0.8953733444213867
Epoch: 14, Steps: 64 | Train Loss: 0.1116386 Vali Loss: 0.1724505 Test Loss: 0.1456874
Validation loss decreased (0.173614 --> 0.172450).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 15 cost time: 0.9224443435668945
Epoch: 15, Steps: 64 | Train Loss: 0.1107799 Vali Loss: 0.1708537 Test Loss: 0.1457676
Validation loss decreased (0.172450 --> 0.170854).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 16 cost time: 0.9168450832366943
Epoch: 16, Steps: 64 | Train Loss: 0.1090924 Vali Loss: 0.1670649 Test Loss: 0.1451957
Validation loss decreased (0.170854 --> 0.167065).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 17 cost time: 0.9237456321716309
Epoch: 17, Steps: 64 | Train Loss: 0.1083203 Vali Loss: 0.1663207 Test Loss: 0.1446097
Validation loss decreased (0.167065 --> 0.166321).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 18 cost time: 0.9199988842010498
Epoch: 18, Steps: 64 | Train Loss: 0.1075688 Vali Loss: 0.1657393 Test Loss: 0.1441303
Validation loss decreased (0.166321 --> 0.165739).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 19 cost time: 0.9266600608825684
Epoch: 19, Steps: 64 | Train Loss: 0.1067364 Vali Loss: 0.1650313 Test Loss: 0.1442706
Validation loss decreased (0.165739 --> 0.165031).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 20 cost time: 0.9424517154693604
Epoch: 20, Steps: 64 | Train Loss: 0.1058232 Vali Loss: 0.1623106 Test Loss: 0.1436404
Validation loss decreased (0.165031 --> 0.162311).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 21 cost time: 0.9330487251281738
Epoch: 21, Steps: 64 | Train Loss: 0.1054487 Vali Loss: 0.1622950 Test Loss: 0.1436857
Validation loss decreased (0.162311 --> 0.162295).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 22 cost time: 0.9294507503509521
Epoch: 22, Steps: 64 | Train Loss: 0.1048204 Vali Loss: 0.1651062 Test Loss: 0.1438095
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 23 cost time: 0.9254255294799805
Epoch: 23, Steps: 64 | Train Loss: 0.1038630 Vali Loss: 0.1636219 Test Loss: 0.1433073
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 24 cost time: 0.8887856006622314
Epoch: 24, Steps: 64 | Train Loss: 0.1035640 Vali Loss: 0.1616187 Test Loss: 0.1429141
Validation loss decreased (0.162295 --> 0.161619).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 25 cost time: 0.884357213973999
Epoch: 25, Steps: 64 | Train Loss: 0.1032297 Vali Loss: 0.1618089 Test Loss: 0.1427488
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 26 cost time: 0.8896298408508301
Epoch: 26, Steps: 64 | Train Loss: 0.1029159 Vali Loss: 0.1607700 Test Loss: 0.1431371
Validation loss decreased (0.161619 --> 0.160770).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 27 cost time: 0.895514726638794
Epoch: 27, Steps: 64 | Train Loss: 0.1021731 Vali Loss: 0.1617275 Test Loss: 0.1428443
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 28 cost time: 0.9324257373809814
Epoch: 28, Steps: 64 | Train Loss: 0.1021303 Vali Loss: 0.1604105 Test Loss: 0.1424059
Validation loss decreased (0.160770 --> 0.160410).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 29 cost time: 0.9253427982330322
Epoch: 29, Steps: 64 | Train Loss: 0.1018618 Vali Loss: 0.1601417 Test Loss: 0.1423397
Validation loss decreased (0.160410 --> 0.160142).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 30 cost time: 0.9353604316711426
Epoch: 30, Steps: 64 | Train Loss: 0.1020739 Vali Loss: 0.1595854 Test Loss: 0.1430399
Validation loss decreased (0.160142 --> 0.159585).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 31 cost time: 0.9278140068054199
Epoch: 31, Steps: 64 | Train Loss: 0.1014729 Vali Loss: 0.1587532 Test Loss: 0.1424740
Validation loss decreased (0.159585 --> 0.158753).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 32 cost time: 0.9140017032623291
Epoch: 32, Steps: 64 | Train Loss: 0.1012640 Vali Loss: 0.1597042 Test Loss: 0.1421345
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 33 cost time: 0.9206328392028809
Epoch: 33, Steps: 64 | Train Loss: 0.1010641 Vali Loss: 0.1601917 Test Loss: 0.1427822
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 34 cost time: 0.927253007888794
Epoch: 34, Steps: 64 | Train Loss: 0.1013824 Vali Loss: 0.1605291 Test Loss: 0.1427489
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 35 cost time: 0.9225633144378662
Epoch: 35, Steps: 64 | Train Loss: 0.1007278 Vali Loss: 0.1572885 Test Loss: 0.1418372
Validation loss decreased (0.158753 --> 0.157288).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 36 cost time: 0.9283955097198486
Epoch: 36, Steps: 64 | Train Loss: 0.1006688 Vali Loss: 0.1587646 Test Loss: 0.1422690
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 37 cost time: 0.9397680759429932
Epoch: 37, Steps: 64 | Train Loss: 0.1002639 Vali Loss: 0.1590621 Test Loss: 0.1423367
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 38 cost time: 0.9341349601745605
Epoch: 38, Steps: 64 | Train Loss: 0.0999545 Vali Loss: 0.1604430 Test Loss: 0.1424094
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 39 cost time: 0.9280002117156982
Epoch: 39, Steps: 64 | Train Loss: 0.1004729 Vali Loss: 0.1579215 Test Loss: 0.1422133
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 40 cost time: 0.9216413497924805
Epoch: 40, Steps: 64 | Train Loss: 0.1001036 Vali Loss: 0.1587052 Test Loss: 0.1421290
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 41 cost time: 0.8926489353179932
Epoch: 41, Steps: 64 | Train Loss: 0.1004768 Vali Loss: 0.1598590 Test Loss: 0.1423772
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 42 cost time: 0.8884296417236328
Epoch: 42, Steps: 64 | Train Loss: 0.1001272 Vali Loss: 0.1576448 Test Loss: 0.1417953
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 43 cost time: 0.8844730854034424
Epoch: 43, Steps: 64 | Train Loss: 0.0997115 Vali Loss: 0.1583819 Test Loss: 0.1420700
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 44 cost time: 0.8977553844451904
Epoch: 44, Steps: 64 | Train Loss: 0.0999820 Vali Loss: 0.1578964 Test Loss: 0.1418953
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 45 cost time: 0.9050002098083496
Epoch: 45, Steps: 64 | Train Loss: 0.0998208 Vali Loss: 0.1582926 Test Loss: 0.1424533
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 46 cost time: 0.9046363830566406
Epoch: 46, Steps: 64 | Train Loss: 0.0999719 Vali Loss: 0.1582135 Test Loss: 0.1419604
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 47 cost time: 0.9092519283294678
Epoch: 47, Steps: 64 | Train Loss: 0.0990989 Vali Loss: 0.1569139 Test Loss: 0.1417366
Validation loss decreased (0.157288 --> 0.156914).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 48 cost time: 0.9223875999450684
Epoch: 48, Steps: 64 | Train Loss: 0.0999134 Vali Loss: 0.1578658 Test Loss: 0.1416270
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 49 cost time: 0.8958883285522461
Epoch: 49, Steps: 64 | Train Loss: 0.0998097 Vali Loss: 0.1573009 Test Loss: 0.1427813
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 50 cost time: 0.9104537963867188
Epoch: 50, Steps: 64 | Train Loss: 0.0996908 Vali Loss: 0.1572119 Test Loss: 0.1414558
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 51 cost time: 0.9382357597351074
Epoch: 51, Steps: 64 | Train Loss: 0.0994282 Vali Loss: 0.1584426 Test Loss: 0.1423645
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 52 cost time: 0.9160001277923584
Epoch: 52, Steps: 64 | Train Loss: 0.0995378 Vali Loss: 0.1567313 Test Loss: 0.1417383
Validation loss decreased (0.156914 --> 0.156731).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 53 cost time: 0.922630786895752
Epoch: 53, Steps: 64 | Train Loss: 0.0994888 Vali Loss: 0.1575169 Test Loss: 0.1419154
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 54 cost time: 0.9263758659362793
Epoch: 54, Steps: 64 | Train Loss: 0.0997799 Vali Loss: 0.1580741 Test Loss: 0.1421361
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 55 cost time: 0.9050195217132568
Epoch: 55, Steps: 64 | Train Loss: 0.0998407 Vali Loss: 0.1590768 Test Loss: 0.1421912
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 56 cost time: 0.9224460124969482
Epoch: 56, Steps: 64 | Train Loss: 0.0993928 Vali Loss: 0.1573741 Test Loss: 0.1414618
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 57 cost time: 0.9323549270629883
Epoch: 57, Steps: 64 | Train Loss: 0.0996847 Vali Loss: 0.1590253 Test Loss: 0.1425863
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 58 cost time: 0.9367773532867432
Epoch: 58, Steps: 64 | Train Loss: 0.0989106 Vali Loss: 0.1563618 Test Loss: 0.1415633
Validation loss decreased (0.156731 --> 0.156362).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 59 cost time: 0.9137394428253174
Epoch: 59, Steps: 64 | Train Loss: 0.0990885 Vali Loss: 0.1565552 Test Loss: 0.1415611
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01810455322265625 GB
GPU已分配内存的峰值：0.050107479095458984 GB
Epoch: 60 cost time: 0.9176385402679443
Epoch: 60, Steps: 64 | Train Loss: 0.0993400 Vali Loss: 0.1564460 Test Loss: 0.1416602
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1415633112192154, mae:0.2731311619281769, rse:0.2002609819173813
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05073976516723633 GB
Epoch: 1 cost time: 2.331404685974121
Epoch: 1, Steps: 64 | Train Loss: 0.8426625 Vali Loss: 1.8752580 Test Loss: 3.5488470
Validation loss decreased (inf --> 1.875258).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 2 cost time: 0.9556384086608887
Epoch: 2, Steps: 64 | Train Loss: 0.4862458 Vali Loss: 0.4724053 Test Loss: 0.6110384
Validation loss decreased (1.875258 --> 0.472405).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 3 cost time: 0.9534201622009277
Epoch: 3, Steps: 64 | Train Loss: 0.1631313 Vali Loss: 0.2327419 Test Loss: 0.1715352
Validation loss decreased (0.472405 --> 0.232742).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 4 cost time: 0.9370660781860352
Epoch: 4, Steps: 64 | Train Loss: 0.1151566 Vali Loss: 0.1983466 Test Loss: 0.1527066
Validation loss decreased (0.232742 --> 0.198347).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 5 cost time: 0.9313793182373047
Epoch: 5, Steps: 64 | Train Loss: 0.1057328 Vali Loss: 0.1807934 Test Loss: 0.1462220
Validation loss decreased (0.198347 --> 0.180793).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 6 cost time: 0.9123532772064209
Epoch: 6, Steps: 64 | Train Loss: 0.1004867 Vali Loss: 0.1718903 Test Loss: 0.1431115
Validation loss decreased (0.180793 --> 0.171890).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 7 cost time: 0.9184184074401855
Epoch: 7, Steps: 64 | Train Loss: 0.0962856 Vali Loss: 0.1634821 Test Loss: 0.1409717
Validation loss decreased (0.171890 --> 0.163482).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 8 cost time: 0.9477543830871582
Epoch: 8, Steps: 64 | Train Loss: 0.0936938 Vali Loss: 0.1614676 Test Loss: 0.1391313
Validation loss decreased (0.163482 --> 0.161468).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 9 cost time: 0.9310019016265869
Epoch: 9, Steps: 64 | Train Loss: 0.0918544 Vali Loss: 0.1581655 Test Loss: 0.1395897
Validation loss decreased (0.161468 --> 0.158165).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 10 cost time: 0.95163893699646
Epoch: 10, Steps: 64 | Train Loss: 0.0900819 Vali Loss: 0.1562968 Test Loss: 0.1383739
Validation loss decreased (0.158165 --> 0.156297).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 11 cost time: 0.9676439762115479
Epoch: 11, Steps: 64 | Train Loss: 0.0890028 Vali Loss: 0.1526233 Test Loss: 0.1379066
Validation loss decreased (0.156297 --> 0.152623).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 12 cost time: 0.962134599685669
Epoch: 12, Steps: 64 | Train Loss: 0.0878196 Vali Loss: 0.1526614 Test Loss: 0.1372573
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 13 cost time: 0.9706435203552246
Epoch: 13, Steps: 64 | Train Loss: 0.0867433 Vali Loss: 0.1495166 Test Loss: 0.1374032
Validation loss decreased (0.152623 --> 0.149517).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 14 cost time: 0.9594016075134277
Epoch: 14, Steps: 64 | Train Loss: 0.0855568 Vali Loss: 0.1489436 Test Loss: 0.1368528
Validation loss decreased (0.149517 --> 0.148944).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 15 cost time: 0.970374584197998
Epoch: 15, Steps: 64 | Train Loss: 0.0852249 Vali Loss: 0.1480397 Test Loss: 0.1374286
Validation loss decreased (0.148944 --> 0.148040).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 16 cost time: 0.9484610557556152
Epoch: 16, Steps: 64 | Train Loss: 0.0848104 Vali Loss: 0.1483998 Test Loss: 0.1365045
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 17 cost time: 0.9517381191253662
Epoch: 17, Steps: 64 | Train Loss: 0.0842923 Vali Loss: 0.1469306 Test Loss: 0.1363094
Validation loss decreased (0.148040 --> 0.146931).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 18 cost time: 0.9620001316070557
Epoch: 18, Steps: 64 | Train Loss: 0.0832251 Vali Loss: 0.1464119 Test Loss: 0.1362057
Validation loss decreased (0.146931 --> 0.146412).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 19 cost time: 0.9640014171600342
Epoch: 19, Steps: 64 | Train Loss: 0.0830694 Vali Loss: 0.1432704 Test Loss: 0.1354984
Validation loss decreased (0.146412 --> 0.143270).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 20 cost time: 0.9496471881866455
Epoch: 20, Steps: 64 | Train Loss: 0.0830410 Vali Loss: 0.1433147 Test Loss: 0.1345675
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 21 cost time: 0.9439036846160889
Epoch: 21, Steps: 64 | Train Loss: 0.0827016 Vali Loss: 0.1429251 Test Loss: 0.1360585
Validation loss decreased (0.143270 --> 0.142925).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 22 cost time: 0.9286708831787109
Epoch: 22, Steps: 64 | Train Loss: 0.0823858 Vali Loss: 0.1422929 Test Loss: 0.1349300
Validation loss decreased (0.142925 --> 0.142293).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 23 cost time: 0.9163732528686523
Epoch: 23, Steps: 64 | Train Loss: 0.0821090 Vali Loss: 0.1426360 Test Loss: 0.1352621
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 24 cost time: 0.9237399101257324
Epoch: 24, Steps: 64 | Train Loss: 0.0818644 Vali Loss: 0.1430160 Test Loss: 0.1351625
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 25 cost time: 0.9502334594726562
Epoch: 25, Steps: 64 | Train Loss: 0.0813579 Vali Loss: 0.1422853 Test Loss: 0.1351470
Validation loss decreased (0.142293 --> 0.142285).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 26 cost time: 0.9347307682037354
Epoch: 26, Steps: 64 | Train Loss: 0.0815008 Vali Loss: 0.1415724 Test Loss: 0.1344720
Validation loss decreased (0.142285 --> 0.141572).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 27 cost time: 0.9380002021789551
Epoch: 27, Steps: 64 | Train Loss: 0.0811011 Vali Loss: 0.1421297 Test Loss: 0.1351285
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 28 cost time: 0.9486217498779297
Epoch: 28, Steps: 64 | Train Loss: 0.0810108 Vali Loss: 0.1421599 Test Loss: 0.1349677
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 29 cost time: 0.9408769607543945
Epoch: 29, Steps: 64 | Train Loss: 0.0809355 Vali Loss: 0.1414496 Test Loss: 0.1349496
Validation loss decreased (0.141572 --> 0.141450).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 30 cost time: 0.9614753723144531
Epoch: 30, Steps: 64 | Train Loss: 0.0807640 Vali Loss: 0.1415099 Test Loss: 0.1348302
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 31 cost time: 0.9513771533966064
Epoch: 31, Steps: 64 | Train Loss: 0.0804096 Vali Loss: 0.1413279 Test Loss: 0.1352724
Validation loss decreased (0.141450 --> 0.141328).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 32 cost time: 0.9504704475402832
Epoch: 32, Steps: 64 | Train Loss: 0.0804649 Vali Loss: 0.1420168 Test Loss: 0.1345817
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 33 cost time: 0.9467208385467529
Epoch: 33, Steps: 64 | Train Loss: 0.0806751 Vali Loss: 0.1392583 Test Loss: 0.1348719
Validation loss decreased (0.141328 --> 0.139258).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 34 cost time: 0.9547278881072998
Epoch: 34, Steps: 64 | Train Loss: 0.0806012 Vali Loss: 0.1410270 Test Loss: 0.1340601
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 35 cost time: 0.9769988059997559
Epoch: 35, Steps: 64 | Train Loss: 0.0799322 Vali Loss: 0.1413449 Test Loss: 0.1353938
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 36 cost time: 0.9666450023651123
Epoch: 36, Steps: 64 | Train Loss: 0.0800490 Vali Loss: 0.1406055 Test Loss: 0.1350147
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 37 cost time: 0.9683725833892822
Epoch: 37, Steps: 64 | Train Loss: 0.0802355 Vali Loss: 0.1384738 Test Loss: 0.1350184
Validation loss decreased (0.139258 --> 0.138474).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 38 cost time: 0.964374303817749
Epoch: 38, Steps: 64 | Train Loss: 0.0804554 Vali Loss: 0.1391948 Test Loss: 0.1342506
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 39 cost time: 0.9564151763916016
Epoch: 39, Steps: 64 | Train Loss: 0.0804775 Vali Loss: 0.1402724 Test Loss: 0.1343748
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 40 cost time: 0.9244871139526367
Epoch: 40, Steps: 64 | Train Loss: 0.0799256 Vali Loss: 0.1400460 Test Loss: 0.1344441
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 41 cost time: 0.9346649646759033
Epoch: 41, Steps: 64 | Train Loss: 0.0802193 Vali Loss: 0.1412183 Test Loss: 0.1348271
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 42 cost time: 0.9299020767211914
Epoch: 42, Steps: 64 | Train Loss: 0.0800883 Vali Loss: 0.1406263 Test Loss: 0.1345603
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 43 cost time: 0.9270002841949463
Epoch: 43, Steps: 64 | Train Loss: 0.0801057 Vali Loss: 0.1398451 Test Loss: 0.1347333
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 44 cost time: 0.939617395401001
Epoch: 44, Steps: 64 | Train Loss: 0.0800001 Vali Loss: 0.1402689 Test Loss: 0.1341279
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 45 cost time: 0.9466571807861328
Epoch: 45, Steps: 64 | Train Loss: 0.0801499 Vali Loss: 0.1404307 Test Loss: 0.1342999
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 46 cost time: 0.9293620586395264
Epoch: 46, Steps: 64 | Train Loss: 0.0801318 Vali Loss: 0.1401183 Test Loss: 0.1356334
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 47 cost time: 0.96639084815979
Epoch: 47, Steps: 64 | Train Loss: 0.0799077 Vali Loss: 0.1406278 Test Loss: 0.1348164
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 48 cost time: 0.9653825759887695
Epoch: 48, Steps: 64 | Train Loss: 0.0799923 Vali Loss: 0.1395007 Test Loss: 0.1340333
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 49 cost time: 0.9653928279876709
Epoch: 49, Steps: 64 | Train Loss: 0.0800941 Vali Loss: 0.1388362 Test Loss: 0.1343875
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 50 cost time: 0.9441368579864502
Epoch: 50, Steps: 64 | Train Loss: 0.0798863 Vali Loss: 0.1415987 Test Loss: 0.1347642
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 51 cost time: 0.9542391300201416
Epoch: 51, Steps: 64 | Train Loss: 0.0795421 Vali Loss: 0.1403122 Test Loss: 0.1349076
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 52 cost time: 0.9649982452392578
Epoch: 52, Steps: 64 | Train Loss: 0.0794493 Vali Loss: 0.1402223 Test Loss: 0.1343458
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 53 cost time: 0.968998908996582
Epoch: 53, Steps: 64 | Train Loss: 0.0799477 Vali Loss: 0.1397199 Test Loss: 0.1344445
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 54 cost time: 0.9720809459686279
Epoch: 54, Steps: 64 | Train Loss: 0.0798553 Vali Loss: 0.1406828 Test Loss: 0.1350002
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 55 cost time: 0.9664103984832764
Epoch: 55, Steps: 64 | Train Loss: 0.0798112 Vali Loss: 0.1399161 Test Loss: 0.1354567
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 56 cost time: 0.9633626937866211
Epoch: 56, Steps: 64 | Train Loss: 0.0794604 Vali Loss: 0.1399522 Test Loss: 0.1342706
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 57 cost time: 0.9644248485565186
Epoch: 57, Steps: 64 | Train Loss: 0.0799129 Vali Loss: 0.1405853 Test Loss: 0.1343792
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 58 cost time: 0.9574182033538818
Epoch: 58, Steps: 64 | Train Loss: 0.0798007 Vali Loss: 0.1396858 Test Loss: 0.1341768
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 59 cost time: 0.9450063705444336
Epoch: 59, Steps: 64 | Train Loss: 0.0799800 Vali Loss: 0.1417565 Test Loss: 0.1351805
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0182342529296875 GB
GPU已分配内存的峰值：0.05166959762573242 GB
Epoch: 60 cost time: 0.9117975234985352
Epoch: 60, Steps: 64 | Train Loss: 0.0795358 Vali Loss: 0.1398877 Test Loss: 0.1343723
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13501833379268646, mae:0.2663062810897827, rse:0.19557680189609528
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05185985565185547 GB
Epoch: 1 cost time: 2.352156400680542
Epoch: 1, Steps: 64 | Train Loss: 0.7562736 Vali Loss: 1.7252849 Test Loss: 3.2909131
Validation loss decreased (inf --> 1.725285).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 2 cost time: 0.9811148643493652
Epoch: 2, Steps: 64 | Train Loss: 0.4507133 Vali Loss: 0.4402873 Test Loss: 0.5703161
Validation loss decreased (1.725285 --> 0.440287).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 3 cost time: 0.9644474983215332
Epoch: 3, Steps: 64 | Train Loss: 0.1408126 Vali Loss: 0.2103682 Test Loss: 0.1586249
Validation loss decreased (0.440287 --> 0.210368).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 4 cost time: 0.9640002250671387
Epoch: 4, Steps: 64 | Train Loss: 0.1050801 Vali Loss: 0.1869439 Test Loss: 0.1556013
Validation loss decreased (0.210368 --> 0.186944).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 5 cost time: 0.9409997463226318
Epoch: 5, Steps: 64 | Train Loss: 0.0976617 Vali Loss: 0.1715482 Test Loss: 0.1453498
Validation loss decreased (0.186944 --> 0.171548).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 6 cost time: 0.9806356430053711
Epoch: 6, Steps: 64 | Train Loss: 0.0935346 Vali Loss: 0.1677298 Test Loss: 0.1429298
Validation loss decreased (0.171548 --> 0.167730).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 7 cost time: 0.9780583381652832
Epoch: 7, Steps: 64 | Train Loss: 0.0911529 Vali Loss: 0.1636829 Test Loss: 0.1412555
Validation loss decreased (0.167730 --> 0.163683).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 8 cost time: 0.963355302810669
Epoch: 8, Steps: 64 | Train Loss: 0.0892772 Vali Loss: 0.1618458 Test Loss: 0.1391373
Validation loss decreased (0.163683 --> 0.161846).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 9 cost time: 0.9594626426696777
Epoch: 9, Steps: 64 | Train Loss: 0.0879510 Vali Loss: 0.1577917 Test Loss: 0.1378893
Validation loss decreased (0.161846 --> 0.157792).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 10 cost time: 0.9970855712890625
Epoch: 10, Steps: 64 | Train Loss: 0.0868655 Vali Loss: 0.1570059 Test Loss: 0.1380905
Validation loss decreased (0.157792 --> 0.157006).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 11 cost time: 0.9860267639160156
Epoch: 11, Steps: 64 | Train Loss: 0.0857597 Vali Loss: 0.1534881 Test Loss: 0.1364281
Validation loss decreased (0.157006 --> 0.153488).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 12 cost time: 0.9974145889282227
Epoch: 12, Steps: 64 | Train Loss: 0.0848386 Vali Loss: 0.1512210 Test Loss: 0.1360008
Validation loss decreased (0.153488 --> 0.151221).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 13 cost time: 0.9764213562011719
Epoch: 13, Steps: 64 | Train Loss: 0.0842125 Vali Loss: 0.1517713 Test Loss: 0.1353461
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 14 cost time: 0.9765472412109375
Epoch: 14, Steps: 64 | Train Loss: 0.0834320 Vali Loss: 0.1500573 Test Loss: 0.1346894
Validation loss decreased (0.151221 --> 0.150057).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 15 cost time: 0.9908013343811035
Epoch: 15, Steps: 64 | Train Loss: 0.0828367 Vali Loss: 0.1473906 Test Loss: 0.1346923
Validation loss decreased (0.150057 --> 0.147391).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 16 cost time: 0.9710021018981934
Epoch: 16, Steps: 64 | Train Loss: 0.0823748 Vali Loss: 0.1467059 Test Loss: 0.1340281
Validation loss decreased (0.147391 --> 0.146706).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 17 cost time: 0.9736380577087402
Epoch: 17, Steps: 64 | Train Loss: 0.0822368 Vali Loss: 0.1462564 Test Loss: 0.1334300
Validation loss decreased (0.146706 --> 0.146256).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 18 cost time: 0.9806404113769531
Epoch: 18, Steps: 64 | Train Loss: 0.0819033 Vali Loss: 0.1441921 Test Loss: 0.1335439
Validation loss decreased (0.146256 --> 0.144192).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 19 cost time: 0.9790964126586914
Epoch: 19, Steps: 64 | Train Loss: 0.0814516 Vali Loss: 0.1449607 Test Loss: 0.1337568
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 20 cost time: 0.9656009674072266
Epoch: 20, Steps: 64 | Train Loss: 0.0811806 Vali Loss: 0.1432403 Test Loss: 0.1330853
Validation loss decreased (0.144192 --> 0.143240).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 21 cost time: 0.9635167121887207
Epoch: 21, Steps: 64 | Train Loss: 0.0812361 Vali Loss: 0.1446014 Test Loss: 0.1332204
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 22 cost time: 0.9384727478027344
Epoch: 22, Steps: 64 | Train Loss: 0.0807024 Vali Loss: 0.1447165 Test Loss: 0.1337990
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 23 cost time: 0.9344778060913086
Epoch: 23, Steps: 64 | Train Loss: 0.0804542 Vali Loss: 0.1426763 Test Loss: 0.1334781
Validation loss decreased (0.143240 --> 0.142676).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 24 cost time: 0.9417405128479004
Epoch: 24, Steps: 64 | Train Loss: 0.0805147 Vali Loss: 0.1434545 Test Loss: 0.1338561
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 25 cost time: 0.9390010833740234
Epoch: 25, Steps: 64 | Train Loss: 0.0801447 Vali Loss: 0.1442188 Test Loss: 0.1336424
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 26 cost time: 0.9636092185974121
Epoch: 26, Steps: 64 | Train Loss: 0.0801000 Vali Loss: 0.1432962 Test Loss: 0.1325584
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 27 cost time: 0.9716365337371826
Epoch: 27, Steps: 64 | Train Loss: 0.0798824 Vali Loss: 0.1416766 Test Loss: 0.1329260
Validation loss decreased (0.142676 --> 0.141677).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 28 cost time: 0.9776372909545898
Epoch: 28, Steps: 64 | Train Loss: 0.0800356 Vali Loss: 0.1433046 Test Loss: 0.1329588
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 29 cost time: 0.9710438251495361
Epoch: 29, Steps: 64 | Train Loss: 0.0796571 Vali Loss: 0.1416881 Test Loss: 0.1323892
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 30 cost time: 0.9764728546142578
Epoch: 30, Steps: 64 | Train Loss: 0.0797154 Vali Loss: 0.1415853 Test Loss: 0.1317734
Validation loss decreased (0.141677 --> 0.141585).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 31 cost time: 0.9744753837585449
Epoch: 31, Steps: 64 | Train Loss: 0.0795007 Vali Loss: 0.1414777 Test Loss: 0.1320921
Validation loss decreased (0.141585 --> 0.141478).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 32 cost time: 0.9789426326751709
Epoch: 32, Steps: 64 | Train Loss: 0.0797198 Vali Loss: 0.1407979 Test Loss: 0.1325929
Validation loss decreased (0.141478 --> 0.140798).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 33 cost time: 0.9694223403930664
Epoch: 33, Steps: 64 | Train Loss: 0.0798160 Vali Loss: 0.1422922 Test Loss: 0.1320018
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 34 cost time: 0.9747734069824219
Epoch: 34, Steps: 64 | Train Loss: 0.0793019 Vali Loss: 0.1407851 Test Loss: 0.1322483
Validation loss decreased (0.140798 --> 0.140785).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 35 cost time: 1.0009982585906982
Epoch: 35, Steps: 64 | Train Loss: 0.0792984 Vali Loss: 0.1396694 Test Loss: 0.1317276
Validation loss decreased (0.140785 --> 0.139669).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 36 cost time: 0.984642744064331
Epoch: 36, Steps: 64 | Train Loss: 0.0792474 Vali Loss: 0.1397897 Test Loss: 0.1320424
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 37 cost time: 0.9826850891113281
Epoch: 37, Steps: 64 | Train Loss: 0.0793648 Vali Loss: 0.1407264 Test Loss: 0.1328504
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 38 cost time: 0.978630781173706
Epoch: 38, Steps: 64 | Train Loss: 0.0794568 Vali Loss: 0.1407781 Test Loss: 0.1319042
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 39 cost time: 0.924393892288208
Epoch: 39, Steps: 64 | Train Loss: 0.0790235 Vali Loss: 0.1392442 Test Loss: 0.1316843
Validation loss decreased (0.139669 --> 0.139244).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 40 cost time: 0.9323728084564209
Epoch: 40, Steps: 64 | Train Loss: 0.0791878 Vali Loss: 0.1386113 Test Loss: 0.1322033
Validation loss decreased (0.139244 --> 0.138611).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 41 cost time: 0.9284243583679199
Epoch: 41, Steps: 64 | Train Loss: 0.0789482 Vali Loss: 0.1402083 Test Loss: 0.1325845
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 42 cost time: 0.9455068111419678
Epoch: 42, Steps: 64 | Train Loss: 0.0792777 Vali Loss: 0.1401026 Test Loss: 0.1314220
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 43 cost time: 0.9597518444061279
Epoch: 43, Steps: 64 | Train Loss: 0.0791567 Vali Loss: 0.1403387 Test Loss: 0.1315141
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 44 cost time: 0.9694263935089111
Epoch: 44, Steps: 64 | Train Loss: 0.0791177 Vali Loss: 0.1399494 Test Loss: 0.1323500
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 45 cost time: 0.9729981422424316
Epoch: 45, Steps: 64 | Train Loss: 0.0791166 Vali Loss: 0.1394102 Test Loss: 0.1317800
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 46 cost time: 0.9576399326324463
Epoch: 46, Steps: 64 | Train Loss: 0.0786128 Vali Loss: 0.1403511 Test Loss: 0.1319685
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 47 cost time: 0.9433779716491699
Epoch: 47, Steps: 64 | Train Loss: 0.0788590 Vali Loss: 0.1415075 Test Loss: 0.1320202
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 48 cost time: 0.9657802581787109
Epoch: 48, Steps: 64 | Train Loss: 0.0788628 Vali Loss: 0.1399220 Test Loss: 0.1308787
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 49 cost time: 0.9744360446929932
Epoch: 49, Steps: 64 | Train Loss: 0.0787228 Vali Loss: 0.1417739 Test Loss: 0.1320558
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 50 cost time: 0.9710824489593506
Epoch: 50, Steps: 64 | Train Loss: 0.0787993 Vali Loss: 0.1406733 Test Loss: 0.1322278
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 51 cost time: 0.9793791770935059
Epoch: 51, Steps: 64 | Train Loss: 0.0789963 Vali Loss: 0.1392388 Test Loss: 0.1316919
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 52 cost time: 0.9917478561401367
Epoch: 52, Steps: 64 | Train Loss: 0.0789171 Vali Loss: 0.1385698 Test Loss: 0.1317668
Validation loss decreased (0.138611 --> 0.138570).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 53 cost time: 0.9788472652435303
Epoch: 53, Steps: 64 | Train Loss: 0.0788959 Vali Loss: 0.1407353 Test Loss: 0.1311755
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 54 cost time: 0.9799995422363281
Epoch: 54, Steps: 64 | Train Loss: 0.0789276 Vali Loss: 0.1386766 Test Loss: 0.1314541
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 55 cost time: 0.9980008602142334
Epoch: 55, Steps: 64 | Train Loss: 0.0787025 Vali Loss: 0.1394922 Test Loss: 0.1319055
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 56 cost time: 0.9720664024353027
Epoch: 56, Steps: 64 | Train Loss: 0.0787543 Vali Loss: 0.1392647 Test Loss: 0.1330525
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 57 cost time: 0.9494247436523438
Epoch: 57, Steps: 64 | Train Loss: 0.0790940 Vali Loss: 0.1400669 Test Loss: 0.1318526
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 58 cost time: 0.9283630847930908
Epoch: 58, Steps: 64 | Train Loss: 0.0790768 Vali Loss: 0.1402609 Test Loss: 0.1327571
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 59 cost time: 0.9460253715515137
Epoch: 59, Steps: 64 | Train Loss: 0.0788859 Vali Loss: 0.1391041 Test Loss: 0.1315264
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01830291748046875 GB
GPU已分配内存的峰值：0.05318593978881836 GB
Epoch: 60 cost time: 0.963371753692627
Epoch: 60, Steps: 64 | Train Loss: 0.0789187 Vali Loss: 0.1400886 Test Loss: 0.1317678
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13176678121089935, mae:0.2609064280986786, rse:0.1932074874639511
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.049469947814941406 GB
Epoch: 1 cost time: 2.323155403137207
Epoch: 1, Steps: 64 | Train Loss: 1.1753748 Vali Loss: 2.4178483 Test Loss: 4.6626163
Validation loss decreased (inf --> 2.417848).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 2 cost time: 0.9223554134368896
Epoch: 2, Steps: 64 | Train Loss: 0.7243314 Vali Loss: 0.7308061 Test Loss: 1.1326543
Validation loss decreased (2.417848 --> 0.730806).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 3 cost time: 0.9133644104003906
Epoch: 3, Steps: 64 | Train Loss: 0.3132914 Vali Loss: 0.4217951 Test Loss: 0.4879384
Validation loss decreased (0.730806 --> 0.421795).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 4 cost time: 0.9366929531097412
Epoch: 4, Steps: 64 | Train Loss: 0.2069073 Vali Loss: 0.3141490 Test Loss: 0.3111464
Validation loss decreased (0.421795 --> 0.314149).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 5 cost time: 0.93133544921875
Epoch: 5, Steps: 64 | Train Loss: 0.1618807 Vali Loss: 0.2501085 Test Loss: 0.2232598
Validation loss decreased (0.314149 --> 0.250109).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 6 cost time: 0.8906443119049072
Epoch: 6, Steps: 64 | Train Loss: 0.1420377 Vali Loss: 0.2171677 Test Loss: 0.1786295
Validation loss decreased (0.250109 --> 0.217168).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 7 cost time: 0.884617805480957
Epoch: 7, Steps: 64 | Train Loss: 0.1308532 Vali Loss: 0.2013652 Test Loss: 0.1624994
Validation loss decreased (0.217168 --> 0.201365).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 8 cost time: 0.8864057064056396
Epoch: 8, Steps: 64 | Train Loss: 0.1245344 Vali Loss: 0.1921490 Test Loss: 0.1541707
Validation loss decreased (0.201365 --> 0.192149).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 9 cost time: 0.9031791687011719
Epoch: 9, Steps: 64 | Train Loss: 0.1206843 Vali Loss: 0.1837276 Test Loss: 0.1495676
Validation loss decreased (0.192149 --> 0.183728).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 10 cost time: 0.9374051094055176
Epoch: 10, Steps: 64 | Train Loss: 0.1170232 Vali Loss: 0.1796706 Test Loss: 0.1469958
Validation loss decreased (0.183728 --> 0.179671).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 11 cost time: 0.9427759647369385
Epoch: 11, Steps: 64 | Train Loss: 0.1139861 Vali Loss: 0.1795608 Test Loss: 0.1466920
Validation loss decreased (0.179671 --> 0.179561).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 12 cost time: 0.9490015506744385
Epoch: 12, Steps: 64 | Train Loss: 0.1122999 Vali Loss: 0.1773244 Test Loss: 0.1449641
Validation loss decreased (0.179561 --> 0.177324).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 13 cost time: 0.9320013523101807
Epoch: 13, Steps: 64 | Train Loss: 0.1105815 Vali Loss: 0.1741579 Test Loss: 0.1443811
Validation loss decreased (0.177324 --> 0.174158).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 14 cost time: 0.9406373500823975
Epoch: 14, Steps: 64 | Train Loss: 0.1087056 Vali Loss: 0.1733024 Test Loss: 0.1438358
Validation loss decreased (0.174158 --> 0.173302).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 15 cost time: 0.9294109344482422
Epoch: 15, Steps: 64 | Train Loss: 0.1072357 Vali Loss: 0.1707904 Test Loss: 0.1433491
Validation loss decreased (0.173302 --> 0.170790).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 16 cost time: 0.909470796585083
Epoch: 16, Steps: 64 | Train Loss: 0.1068747 Vali Loss: 0.1689253 Test Loss: 0.1426755
Validation loss decreased (0.170790 --> 0.168925).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 17 cost time: 0.9204108715057373
Epoch: 17, Steps: 64 | Train Loss: 0.1049604 Vali Loss: 0.1669252 Test Loss: 0.1428880
Validation loss decreased (0.168925 --> 0.166925).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 18 cost time: 0.9287686347961426
Epoch: 18, Steps: 64 | Train Loss: 0.1049114 Vali Loss: 0.1688225 Test Loss: 0.1428875
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 19 cost time: 0.9477405548095703
Epoch: 19, Steps: 64 | Train Loss: 0.1035491 Vali Loss: 0.1661945 Test Loss: 0.1429071
Validation loss decreased (0.166925 --> 0.166194).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 20 cost time: 0.9439966678619385
Epoch: 20, Steps: 64 | Train Loss: 0.1026237 Vali Loss: 0.1653653 Test Loss: 0.1424132
Validation loss decreased (0.166194 --> 0.165365).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 21 cost time: 0.9420030117034912
Epoch: 21, Steps: 64 | Train Loss: 0.1030010 Vali Loss: 0.1660527 Test Loss: 0.1426927
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 22 cost time: 0.9481570720672607
Epoch: 22, Steps: 64 | Train Loss: 0.1019473 Vali Loss: 0.1668189 Test Loss: 0.1426396
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 23 cost time: 0.9065098762512207
Epoch: 23, Steps: 64 | Train Loss: 0.1018381 Vali Loss: 0.1685131 Test Loss: 0.1427868
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 24 cost time: 0.9123921394348145
Epoch: 24, Steps: 64 | Train Loss: 0.1012079 Vali Loss: 0.1641066 Test Loss: 0.1421631
Validation loss decreased (0.165365 --> 0.164107).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 25 cost time: 0.90838623046875
Epoch: 25, Steps: 64 | Train Loss: 0.1005676 Vali Loss: 0.1643999 Test Loss: 0.1418665
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 26 cost time: 0.9127840995788574
Epoch: 26, Steps: 64 | Train Loss: 0.1005776 Vali Loss: 0.1624467 Test Loss: 0.1423470
Validation loss decreased (0.164107 --> 0.162447).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 27 cost time: 0.9187536239624023
Epoch: 27, Steps: 64 | Train Loss: 0.1002298 Vali Loss: 0.1642555 Test Loss: 0.1417322
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 28 cost time: 0.9190013408660889
Epoch: 28, Steps: 64 | Train Loss: 0.0996377 Vali Loss: 0.1655954 Test Loss: 0.1428854
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 29 cost time: 0.9230000972747803
Epoch: 29, Steps: 64 | Train Loss: 0.0997090 Vali Loss: 0.1626029 Test Loss: 0.1419787
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 30 cost time: 0.9153878688812256
Epoch: 30, Steps: 64 | Train Loss: 0.0992905 Vali Loss: 0.1608771 Test Loss: 0.1415541
Validation loss decreased (0.162447 --> 0.160877).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 31 cost time: 0.9260365962982178
Epoch: 31, Steps: 64 | Train Loss: 0.0993118 Vali Loss: 0.1639266 Test Loss: 0.1413987
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 32 cost time: 0.9193928241729736
Epoch: 32, Steps: 64 | Train Loss: 0.0990439 Vali Loss: 0.1619774 Test Loss: 0.1418268
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 33 cost time: 0.9284181594848633
Epoch: 33, Steps: 64 | Train Loss: 0.0991114 Vali Loss: 0.1599254 Test Loss: 0.1410764
Validation loss decreased (0.160877 --> 0.159925).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 34 cost time: 0.9242451190948486
Epoch: 34, Steps: 64 | Train Loss: 0.0984152 Vali Loss: 0.1620550 Test Loss: 0.1418770
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 35 cost time: 0.92242431640625
Epoch: 35, Steps: 64 | Train Loss: 0.0983116 Vali Loss: 0.1630917 Test Loss: 0.1416815
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 36 cost time: 0.9536564350128174
Epoch: 36, Steps: 64 | Train Loss: 0.0984782 Vali Loss: 0.1614054 Test Loss: 0.1412035
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 37 cost time: 0.9403729438781738
Epoch: 37, Steps: 64 | Train Loss: 0.0982661 Vali Loss: 0.1612411 Test Loss: 0.1417698
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 38 cost time: 0.945366382598877
Epoch: 38, Steps: 64 | Train Loss: 0.0980393 Vali Loss: 0.1634141 Test Loss: 0.1418725
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 39 cost time: 0.9383890628814697
Epoch: 39, Steps: 64 | Train Loss: 0.0982355 Vali Loss: 0.1609567 Test Loss: 0.1415086
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 40 cost time: 0.9324336051940918
Epoch: 40, Steps: 64 | Train Loss: 0.0980933 Vali Loss: 0.1596176 Test Loss: 0.1418958
Validation loss decreased (0.159925 --> 0.159618).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 41 cost time: 0.9097545146942139
Epoch: 41, Steps: 64 | Train Loss: 0.0983399 Vali Loss: 0.1620048 Test Loss: 0.1413715
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 42 cost time: 0.9050004482269287
Epoch: 42, Steps: 64 | Train Loss: 0.0976453 Vali Loss: 0.1602300 Test Loss: 0.1411328
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 43 cost time: 0.9053933620452881
Epoch: 43, Steps: 64 | Train Loss: 0.0980410 Vali Loss: 0.1612108 Test Loss: 0.1413107
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 44 cost time: 0.9085533618927002
Epoch: 44, Steps: 64 | Train Loss: 0.0974368 Vali Loss: 0.1627825 Test Loss: 0.1422111
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 45 cost time: 0.9187445640563965
Epoch: 45, Steps: 64 | Train Loss: 0.0970171 Vali Loss: 0.1605730 Test Loss: 0.1416994
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 46 cost time: 0.9192526340484619
Epoch: 46, Steps: 64 | Train Loss: 0.0973389 Vali Loss: 0.1615842 Test Loss: 0.1413371
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 47 cost time: 0.9263877868652344
Epoch: 47, Steps: 64 | Train Loss: 0.0972462 Vali Loss: 0.1621969 Test Loss: 0.1415516
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 48 cost time: 0.9193000793457031
Epoch: 48, Steps: 64 | Train Loss: 0.0972099 Vali Loss: 0.1595895 Test Loss: 0.1415343
Validation loss decreased (0.159618 --> 0.159590).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 49 cost time: 0.9110000133514404
Epoch: 49, Steps: 64 | Train Loss: 0.0975792 Vali Loss: 0.1602425 Test Loss: 0.1414731
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 50 cost time: 0.9186432361602783
Epoch: 50, Steps: 64 | Train Loss: 0.0974185 Vali Loss: 0.1616659 Test Loss: 0.1408803
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 51 cost time: 0.9134378433227539
Epoch: 51, Steps: 64 | Train Loss: 0.0972887 Vali Loss: 0.1607454 Test Loss: 0.1409269
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 52 cost time: 0.9310131072998047
Epoch: 52, Steps: 64 | Train Loss: 0.0975599 Vali Loss: 0.1612672 Test Loss: 0.1413666
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 53 cost time: 0.9453952312469482
Epoch: 53, Steps: 64 | Train Loss: 0.0974382 Vali Loss: 0.1588281 Test Loss: 0.1405560
Validation loss decreased (0.159590 --> 0.158828).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 54 cost time: 0.938347339630127
Epoch: 54, Steps: 64 | Train Loss: 0.0972682 Vali Loss: 0.1605012 Test Loss: 0.1413520
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 55 cost time: 0.9407353401184082
Epoch: 55, Steps: 64 | Train Loss: 0.0971746 Vali Loss: 0.1594108 Test Loss: 0.1411028
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 56 cost time: 0.9403622150421143
Epoch: 56, Steps: 64 | Train Loss: 0.0970840 Vali Loss: 0.1608891 Test Loss: 0.1409739
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 57 cost time: 0.9360001087188721
Epoch: 57, Steps: 64 | Train Loss: 0.0967780 Vali Loss: 0.1608784 Test Loss: 0.1410538
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 58 cost time: 0.921011209487915
Epoch: 58, Steps: 64 | Train Loss: 0.0974024 Vali Loss: 0.1606343 Test Loss: 0.1410519
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 59 cost time: 0.9188663959503174
Epoch: 59, Steps: 64 | Train Loss: 0.0972372 Vali Loss: 0.1616379 Test Loss: 0.1411945
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181121826171875 GB
GPU已分配内存的峰值：0.05027341842651367 GB
Epoch: 60 cost time: 0.9183604717254639
Epoch: 60, Steps: 64 | Train Loss: 0.0970976 Vali Loss: 0.1615942 Test Loss: 0.1413589
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14055600762367249, mae:0.2688123285770416, rse:0.19954721629619598
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05090188980102539 GB
Epoch: 1 cost time: 2.3529248237609863
Epoch: 1, Steps: 64 | Train Loss: 0.7751832 Vali Loss: 1.7365505 Test Loss: 3.2284927
Validation loss decreased (inf --> 1.736550).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 2 cost time: 0.9654607772827148
Epoch: 2, Steps: 64 | Train Loss: 0.4595209 Vali Loss: 0.4812409 Test Loss: 0.6549368
Validation loss decreased (1.736550 --> 0.481241).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 3 cost time: 0.9594054222106934
Epoch: 3, Steps: 64 | Train Loss: 0.1589081 Vali Loss: 0.2046449 Test Loss: 0.1737120
Validation loss decreased (0.481241 --> 0.204645).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 4 cost time: 0.9533679485321045
Epoch: 4, Steps: 64 | Train Loss: 0.1081684 Vali Loss: 0.1721484 Test Loss: 0.1450319
Validation loss decreased (0.204645 --> 0.172148).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 5 cost time: 0.9410526752471924
Epoch: 5, Steps: 64 | Train Loss: 0.1002735 Vali Loss: 0.1681803 Test Loss: 0.1416249
Validation loss decreased (0.172148 --> 0.168180).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 6 cost time: 0.9408183097839355
Epoch: 6, Steps: 64 | Train Loss: 0.0966176 Vali Loss: 0.1661850 Test Loss: 0.1400537
Validation loss decreased (0.168180 --> 0.166185).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 7 cost time: 0.9573256969451904
Epoch: 7, Steps: 64 | Train Loss: 0.0937672 Vali Loss: 0.1608189 Test Loss: 0.1393939
Validation loss decreased (0.166185 --> 0.160819).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 8 cost time: 0.9410014152526855
Epoch: 8, Steps: 64 | Train Loss: 0.0916779 Vali Loss: 0.1612196 Test Loss: 0.1378291
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 9 cost time: 0.9539763927459717
Epoch: 9, Steps: 64 | Train Loss: 0.0902460 Vali Loss: 0.1552814 Test Loss: 0.1370410
Validation loss decreased (0.160819 --> 0.155281).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 10 cost time: 0.976513147354126
Epoch: 10, Steps: 64 | Train Loss: 0.0889768 Vali Loss: 0.1581831 Test Loss: 0.1365693
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 11 cost time: 0.9804172515869141
Epoch: 11, Steps: 64 | Train Loss: 0.0877474 Vali Loss: 0.1534419 Test Loss: 0.1363060
Validation loss decreased (0.155281 --> 0.153442).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 12 cost time: 0.9785199165344238
Epoch: 12, Steps: 64 | Train Loss: 0.0866825 Vali Loss: 0.1514872 Test Loss: 0.1357686
Validation loss decreased (0.153442 --> 0.151487).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 13 cost time: 0.9707534313201904
Epoch: 13, Steps: 64 | Train Loss: 0.0859929 Vali Loss: 0.1539914 Test Loss: 0.1344674
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 14 cost time: 0.9536845684051514
Epoch: 14, Steps: 64 | Train Loss: 0.0848928 Vali Loss: 0.1535679 Test Loss: 0.1348044
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 15 cost time: 0.963433027267456
Epoch: 15, Steps: 64 | Train Loss: 0.0846062 Vali Loss: 0.1485440 Test Loss: 0.1348326
Validation loss decreased (0.151487 --> 0.148544).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 16 cost time: 0.9537436962127686
Epoch: 16, Steps: 64 | Train Loss: 0.0836387 Vali Loss: 0.1503431 Test Loss: 0.1342479
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 17 cost time: 0.9609999656677246
Epoch: 17, Steps: 64 | Train Loss: 0.0836542 Vali Loss: 0.1510546 Test Loss: 0.1351790
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 18 cost time: 0.9710648059844971
Epoch: 18, Steps: 64 | Train Loss: 0.0829652 Vali Loss: 0.1501132 Test Loss: 0.1346815
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 19 cost time: 0.9726605415344238
Epoch: 19, Steps: 64 | Train Loss: 0.0827430 Vali Loss: 0.1480602 Test Loss: 0.1336231
Validation loss decreased (0.148544 --> 0.148060).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 20 cost time: 0.9633886814117432
Epoch: 20, Steps: 64 | Train Loss: 0.0823603 Vali Loss: 0.1480747 Test Loss: 0.1336111
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 21 cost time: 0.9627573490142822
Epoch: 21, Steps: 64 | Train Loss: 0.0819806 Vali Loss: 0.1457994 Test Loss: 0.1336979
Validation loss decreased (0.148060 --> 0.145799).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 22 cost time: 0.9472653865814209
Epoch: 22, Steps: 64 | Train Loss: 0.0816778 Vali Loss: 0.1487216 Test Loss: 0.1343365
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 23 cost time: 0.953444242477417
Epoch: 23, Steps: 64 | Train Loss: 0.0813885 Vali Loss: 0.1490015 Test Loss: 0.1340115
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 24 cost time: 0.954395055770874
Epoch: 24, Steps: 64 | Train Loss: 0.0811831 Vali Loss: 0.1464379 Test Loss: 0.1332678
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 25 cost time: 0.9437770843505859
Epoch: 25, Steps: 64 | Train Loss: 0.0811663 Vali Loss: 0.1469122 Test Loss: 0.1332988
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 26 cost time: 0.9507462978363037
Epoch: 26, Steps: 64 | Train Loss: 0.0808931 Vali Loss: 0.1461581 Test Loss: 0.1341701
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 27 cost time: 0.9606640338897705
Epoch: 27, Steps: 64 | Train Loss: 0.0810140 Vali Loss: 0.1439056 Test Loss: 0.1329152
Validation loss decreased (0.145799 --> 0.143906).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 28 cost time: 0.9832446575164795
Epoch: 28, Steps: 64 | Train Loss: 0.0804852 Vali Loss: 0.1460146 Test Loss: 0.1337116
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 29 cost time: 0.9623599052429199
Epoch: 29, Steps: 64 | Train Loss: 0.0807578 Vali Loss: 0.1448159 Test Loss: 0.1335308
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 30 cost time: 0.977393627166748
Epoch: 30, Steps: 64 | Train Loss: 0.0799900 Vali Loss: 0.1449145 Test Loss: 0.1332204
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 31 cost time: 0.956336498260498
Epoch: 31, Steps: 64 | Train Loss: 0.0802413 Vali Loss: 0.1453170 Test Loss: 0.1330007
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 32 cost time: 0.9584090709686279
Epoch: 32, Steps: 64 | Train Loss: 0.0802484 Vali Loss: 0.1448045 Test Loss: 0.1335706
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 33 cost time: 0.9545021057128906
Epoch: 33, Steps: 64 | Train Loss: 0.0798902 Vali Loss: 0.1432400 Test Loss: 0.1334862
Validation loss decreased (0.143906 --> 0.143240).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 34 cost time: 0.9748518466949463
Epoch: 34, Steps: 64 | Train Loss: 0.0798405 Vali Loss: 0.1446703 Test Loss: 0.1332886
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 35 cost time: 0.9734184741973877
Epoch: 35, Steps: 64 | Train Loss: 0.0795381 Vali Loss: 0.1448621 Test Loss: 0.1338452
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 36 cost time: 0.9840006828308105
Epoch: 36, Steps: 64 | Train Loss: 0.0795628 Vali Loss: 0.1432656 Test Loss: 0.1329872
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 37 cost time: 0.9956426620483398
Epoch: 37, Steps: 64 | Train Loss: 0.0796010 Vali Loss: 0.1442004 Test Loss: 0.1334813
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 38 cost time: 0.9756321907043457
Epoch: 38, Steps: 64 | Train Loss: 0.0792905 Vali Loss: 0.1446734 Test Loss: 0.1341735
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 39 cost time: 0.9747729301452637
Epoch: 39, Steps: 64 | Train Loss: 0.0798356 Vali Loss: 0.1445292 Test Loss: 0.1338365
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 40 cost time: 0.974395751953125
Epoch: 40, Steps: 64 | Train Loss: 0.0796131 Vali Loss: 0.1440190 Test Loss: 0.1330354
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 41 cost time: 0.9490857124328613
Epoch: 41, Steps: 64 | Train Loss: 0.0796072 Vali Loss: 0.1445944 Test Loss: 0.1341622
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 42 cost time: 0.9784989356994629
Epoch: 42, Steps: 64 | Train Loss: 0.0793381 Vali Loss: 0.1432384 Test Loss: 0.1336892
Validation loss decreased (0.143240 --> 0.143238).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 43 cost time: 0.9748427867889404
Epoch: 43, Steps: 64 | Train Loss: 0.0794720 Vali Loss: 0.1438996 Test Loss: 0.1329173
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 44 cost time: 0.9758260250091553
Epoch: 44, Steps: 64 | Train Loss: 0.0793808 Vali Loss: 0.1443253 Test Loss: 0.1337104
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 45 cost time: 0.9577569961547852
Epoch: 45, Steps: 64 | Train Loss: 0.0793416 Vali Loss: 0.1432561 Test Loss: 0.1336615
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 46 cost time: 0.9469995498657227
Epoch: 46, Steps: 64 | Train Loss: 0.0790922 Vali Loss: 0.1441773 Test Loss: 0.1334921
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 47 cost time: 0.9526443481445312
Epoch: 47, Steps: 64 | Train Loss: 0.0790899 Vali Loss: 0.1442700 Test Loss: 0.1337735
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 48 cost time: 0.9480884075164795
Epoch: 48, Steps: 64 | Train Loss: 0.0793472 Vali Loss: 0.1420901 Test Loss: 0.1332680
Validation loss decreased (0.143238 --> 0.142090).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 49 cost time: 0.9634671211242676
Epoch: 49, Steps: 64 | Train Loss: 0.0789849 Vali Loss: 0.1406540 Test Loss: 0.1340999
Validation loss decreased (0.142090 --> 0.140654).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 50 cost time: 0.9663598537445068
Epoch: 50, Steps: 64 | Train Loss: 0.0791823 Vali Loss: 0.1451039 Test Loss: 0.1334286
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 51 cost time: 0.9700188636779785
Epoch: 51, Steps: 64 | Train Loss: 0.0793149 Vali Loss: 0.1440732 Test Loss: 0.1342465
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 52 cost time: 0.9734275341033936
Epoch: 52, Steps: 64 | Train Loss: 0.0789997 Vali Loss: 0.1438736 Test Loss: 0.1340898
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 53 cost time: 0.9763820171356201
Epoch: 53, Steps: 64 | Train Loss: 0.0794255 Vali Loss: 0.1425220 Test Loss: 0.1334226
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 54 cost time: 0.9927444458007812
Epoch: 54, Steps: 64 | Train Loss: 0.0791630 Vali Loss: 0.1426068 Test Loss: 0.1338309
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 55 cost time: 0.9781074523925781
Epoch: 55, Steps: 64 | Train Loss: 0.0792595 Vali Loss: 0.1434904 Test Loss: 0.1327556
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 56 cost time: 0.9574177265167236
Epoch: 56, Steps: 64 | Train Loss: 0.0792946 Vali Loss: 0.1407756 Test Loss: 0.1325817
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 57 cost time: 0.9616396427154541
Epoch: 57, Steps: 64 | Train Loss: 0.0791909 Vali Loss: 0.1435783 Test Loss: 0.1329961
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 58 cost time: 0.9164412021636963
Epoch: 58, Steps: 64 | Train Loss: 0.0791207 Vali Loss: 0.1436912 Test Loss: 0.1331699
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 59 cost time: 0.9159934520721436
Epoch: 59, Steps: 64 | Train Loss: 0.0790591 Vali Loss: 0.1440234 Test Loss: 0.1332338
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824188232421875 GB
GPU已分配内存的峰值：0.05183553695678711 GB
Epoch: 60 cost time: 0.9341580867767334
Epoch: 60, Steps: 64 | Train Loss: 0.0794763 Vali Loss: 0.1444841 Test Loss: 0.1339153
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13409994542598724, mae:0.2655293643474579, rse:0.19491052627563477
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05202198028564453 GB
Epoch: 1 cost time: 2.3747053146362305
Epoch: 1, Steps: 64 | Train Loss: 0.8163684 Vali Loss: 1.8902012 Test Loss: 3.6147370
Validation loss decreased (inf --> 1.890201).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 2 cost time: 0.9924824237823486
Epoch: 2, Steps: 64 | Train Loss: 0.5291467 Vali Loss: 0.5781287 Test Loss: 0.8340054
Validation loss decreased (1.890201 --> 0.578129).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 3 cost time: 0.9915671348571777
Epoch: 3, Steps: 64 | Train Loss: 0.1646087 Vali Loss: 0.2039153 Test Loss: 0.1565861
Validation loss decreased (0.578129 --> 0.203915).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 4 cost time: 0.9633758068084717
Epoch: 4, Steps: 64 | Train Loss: 0.1036656 Vali Loss: 0.1769254 Test Loss: 0.1504453
Validation loss decreased (0.203915 --> 0.176925).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 5 cost time: 0.9437532424926758
Epoch: 5, Steps: 64 | Train Loss: 0.0961186 Vali Loss: 0.1676076 Test Loss: 0.1435562
Validation loss decreased (0.176925 --> 0.167608).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 6 cost time: 0.9397876262664795
Epoch: 6, Steps: 64 | Train Loss: 0.0928313 Vali Loss: 0.1643802 Test Loss: 0.1420574
Validation loss decreased (0.167608 --> 0.164380).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 7 cost time: 0.9430017471313477
Epoch: 7, Steps: 64 | Train Loss: 0.0901647 Vali Loss: 0.1616765 Test Loss: 0.1410742
Validation loss decreased (0.164380 --> 0.161677).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 8 cost time: 0.940000057220459
Epoch: 8, Steps: 64 | Train Loss: 0.0885969 Vali Loss: 0.1595759 Test Loss: 0.1403511
Validation loss decreased (0.161677 --> 0.159576).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 9 cost time: 0.9660351276397705
Epoch: 9, Steps: 64 | Train Loss: 0.0871804 Vali Loss: 0.1581570 Test Loss: 0.1395258
Validation loss decreased (0.159576 --> 0.158157).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 10 cost time: 0.9862856864929199
Epoch: 10, Steps: 64 | Train Loss: 0.0862590 Vali Loss: 0.1564732 Test Loss: 0.1388851
Validation loss decreased (0.158157 --> 0.156473).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 11 cost time: 0.9873933792114258
Epoch: 11, Steps: 64 | Train Loss: 0.0849094 Vali Loss: 0.1546330 Test Loss: 0.1379586
Validation loss decreased (0.156473 --> 0.154633).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 12 cost time: 0.9930567741394043
Epoch: 12, Steps: 64 | Train Loss: 0.0844186 Vali Loss: 0.1519155 Test Loss: 0.1381868
Validation loss decreased (0.154633 --> 0.151915).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 13 cost time: 0.9953956604003906
Epoch: 13, Steps: 64 | Train Loss: 0.0834834 Vali Loss: 0.1549510 Test Loss: 0.1381800
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 14 cost time: 0.9753677845001221
Epoch: 14, Steps: 64 | Train Loss: 0.0832637 Vali Loss: 0.1504925 Test Loss: 0.1376431
Validation loss decreased (0.151915 --> 0.150493).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 15 cost time: 0.9714045524597168
Epoch: 15, Steps: 64 | Train Loss: 0.0826966 Vali Loss: 0.1534498 Test Loss: 0.1376605
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 16 cost time: 0.9713983535766602
Epoch: 16, Steps: 64 | Train Loss: 0.0822276 Vali Loss: 0.1526498 Test Loss: 0.1374333
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 17 cost time: 0.9911346435546875
Epoch: 17, Steps: 64 | Train Loss: 0.0818423 Vali Loss: 0.1521550 Test Loss: 0.1370189
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 18 cost time: 0.9954030513763428
Epoch: 18, Steps: 64 | Train Loss: 0.0813932 Vali Loss: 0.1500893 Test Loss: 0.1373488
Validation loss decreased (0.150493 --> 0.150089).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 19 cost time: 0.996999979019165
Epoch: 19, Steps: 64 | Train Loss: 0.0809527 Vali Loss: 0.1499647 Test Loss: 0.1372006
Validation loss decreased (0.150089 --> 0.149965).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 20 cost time: 0.9746463298797607
Epoch: 20, Steps: 64 | Train Loss: 0.0811426 Vali Loss: 0.1499605 Test Loss: 0.1368998
Validation loss decreased (0.149965 --> 0.149961).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 21 cost time: 0.9850034713745117
Epoch: 21, Steps: 64 | Train Loss: 0.0807242 Vali Loss: 0.1496720 Test Loss: 0.1362704
Validation loss decreased (0.149961 --> 0.149672).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 22 cost time: 0.9914200305938721
Epoch: 22, Steps: 64 | Train Loss: 0.0804526 Vali Loss: 0.1504302 Test Loss: 0.1362211
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 23 cost time: 0.9863669872283936
Epoch: 23, Steps: 64 | Train Loss: 0.0805483 Vali Loss: 0.1496948 Test Loss: 0.1361672
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 24 cost time: 0.9353733062744141
Epoch: 24, Steps: 64 | Train Loss: 0.0804839 Vali Loss: 0.1494009 Test Loss: 0.1359114
Validation loss decreased (0.149672 --> 0.149401).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 25 cost time: 0.9404008388519287
Epoch: 25, Steps: 64 | Train Loss: 0.0799083 Vali Loss: 0.1494745 Test Loss: 0.1356716
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 26 cost time: 0.9654393196105957
Epoch: 26, Steps: 64 | Train Loss: 0.0802577 Vali Loss: 0.1482588 Test Loss: 0.1356356
Validation loss decreased (0.149401 --> 0.148259).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 27 cost time: 0.985353946685791
Epoch: 27, Steps: 64 | Train Loss: 0.0795279 Vali Loss: 0.1495439 Test Loss: 0.1362306
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 28 cost time: 0.9627594947814941
Epoch: 28, Steps: 64 | Train Loss: 0.0795093 Vali Loss: 0.1496186 Test Loss: 0.1360827
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 29 cost time: 0.9793975353240967
Epoch: 29, Steps: 64 | Train Loss: 0.0798222 Vali Loss: 0.1492328 Test Loss: 0.1360513
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 30 cost time: 0.9980010986328125
Epoch: 30, Steps: 64 | Train Loss: 0.0792007 Vali Loss: 0.1484454 Test Loss: 0.1357650
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 31 cost time: 0.9766333103179932
Epoch: 31, Steps: 64 | Train Loss: 0.0794186 Vali Loss: 0.1489702 Test Loss: 0.1360413
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 32 cost time: 0.971419095993042
Epoch: 32, Steps: 64 | Train Loss: 0.0794492 Vali Loss: 0.1471944 Test Loss: 0.1353462
Validation loss decreased (0.148259 --> 0.147194).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 33 cost time: 0.9817264080047607
Epoch: 33, Steps: 64 | Train Loss: 0.0793494 Vali Loss: 0.1483672 Test Loss: 0.1354955
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 34 cost time: 0.9921915531158447
Epoch: 34, Steps: 64 | Train Loss: 0.0791982 Vali Loss: 0.1477793 Test Loss: 0.1358388
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 35 cost time: 0.9914040565490723
Epoch: 35, Steps: 64 | Train Loss: 0.0791725 Vali Loss: 0.1460809 Test Loss: 0.1356776
Validation loss decreased (0.147194 --> 0.146081).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 36 cost time: 0.9974725246429443
Epoch: 36, Steps: 64 | Train Loss: 0.0792331 Vali Loss: 0.1478481 Test Loss: 0.1352954
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 37 cost time: 0.9944088459014893
Epoch: 37, Steps: 64 | Train Loss: 0.0790430 Vali Loss: 0.1484537 Test Loss: 0.1354157
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 38 cost time: 0.9875853061676025
Epoch: 38, Steps: 64 | Train Loss: 0.0789777 Vali Loss: 0.1458806 Test Loss: 0.1350293
Validation loss decreased (0.146081 --> 0.145881).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 39 cost time: 0.9847776889801025
Epoch: 39, Steps: 64 | Train Loss: 0.0787444 Vali Loss: 0.1483307 Test Loss: 0.1349737
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 40 cost time: 0.9547479152679443
Epoch: 40, Steps: 64 | Train Loss: 0.0790143 Vali Loss: 0.1469376 Test Loss: 0.1350149
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 41 cost time: 0.9374349117279053
Epoch: 41, Steps: 64 | Train Loss: 0.0788843 Vali Loss: 0.1486682 Test Loss: 0.1352115
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 42 cost time: 0.9436438083648682
Epoch: 42, Steps: 64 | Train Loss: 0.0789009 Vali Loss: 0.1468039 Test Loss: 0.1352282
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 43 cost time: 0.9685149192810059
Epoch: 43, Steps: 64 | Train Loss: 0.0788517 Vali Loss: 0.1477673 Test Loss: 0.1354816
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 44 cost time: 0.9644889831542969
Epoch: 44, Steps: 64 | Train Loss: 0.0788803 Vali Loss: 0.1475470 Test Loss: 0.1351267
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 45 cost time: 0.9582242965698242
Epoch: 45, Steps: 64 | Train Loss: 0.0787549 Vali Loss: 0.1446327 Test Loss: 0.1351256
Validation loss decreased (0.145881 --> 0.144633).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 46 cost time: 0.9645195007324219
Epoch: 46, Steps: 64 | Train Loss: 0.0788492 Vali Loss: 0.1452707 Test Loss: 0.1349494
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 47 cost time: 0.9414162635803223
Epoch: 47, Steps: 64 | Train Loss: 0.0785333 Vali Loss: 0.1484189 Test Loss: 0.1353640
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 48 cost time: 0.9707891941070557
Epoch: 48, Steps: 64 | Train Loss: 0.0786932 Vali Loss: 0.1445660 Test Loss: 0.1349655
Validation loss decreased (0.144633 --> 0.144566).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 49 cost time: 0.9884586334228516
Epoch: 49, Steps: 64 | Train Loss: 0.0789980 Vali Loss: 0.1462531 Test Loss: 0.1354274
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 50 cost time: 0.9793691635131836
Epoch: 50, Steps: 64 | Train Loss: 0.0787683 Vali Loss: 0.1469172 Test Loss: 0.1348050
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 51 cost time: 0.9956433773040771
Epoch: 51, Steps: 64 | Train Loss: 0.0785866 Vali Loss: 0.1463073 Test Loss: 0.1349751
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 52 cost time: 1.0022733211517334
Epoch: 52, Steps: 64 | Train Loss: 0.0786301 Vali Loss: 0.1472484 Test Loss: 0.1349842
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 53 cost time: 0.9994747638702393
Epoch: 53, Steps: 64 | Train Loss: 0.0787436 Vali Loss: 0.1458541 Test Loss: 0.1351528
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 54 cost time: 0.9868206977844238
Epoch: 54, Steps: 64 | Train Loss: 0.0786115 Vali Loss: 0.1478742 Test Loss: 0.1349425
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 55 cost time: 0.9944398403167725
Epoch: 55, Steps: 64 | Train Loss: 0.0789695 Vali Loss: 0.1468741 Test Loss: 0.1350545
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 56 cost time: 0.9832549095153809
Epoch: 56, Steps: 64 | Train Loss: 0.0785852 Vali Loss: 0.1452953 Test Loss: 0.1349532
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 57 cost time: 0.9463925361633301
Epoch: 57, Steps: 64 | Train Loss: 0.0786520 Vali Loss: 0.1475210 Test Loss: 0.1354322
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 58 cost time: 0.9343874454498291
Epoch: 58, Steps: 64 | Train Loss: 0.0785165 Vali Loss: 0.1452217 Test Loss: 0.1346190
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 59 cost time: 0.9527974128723145
Epoch: 59, Steps: 64 | Train Loss: 0.0788479 Vali Loss: 0.1473542 Test Loss: 0.1351028
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018310546875 GB
GPU已分配内存的峰值：0.05335187911987305 GB
Epoch: 60 cost time: 0.9730000495910645
Epoch: 60, Steps: 64 | Train Loss: 0.0783857 Vali Loss: 0.1471321 Test Loss: 0.1353798
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13496547937393188, mae:0.2642655670642853, rse:0.1955385059118271
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.049631595611572266 GB
Epoch: 1 cost time: 2.329482078552246
Epoch: 1, Steps: 64 | Train Loss: 0.7369729 Vali Loss: 1.4250003 Test Loss: 2.6001527
Validation loss decreased (inf --> 1.425000).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 2 cost time: 0.9224331378936768
Epoch: 2, Steps: 64 | Train Loss: 0.4178028 Vali Loss: 0.3650554 Test Loss: 0.4359687
Validation loss decreased (1.425000 --> 0.365055).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 3 cost time: 0.9332394599914551
Epoch: 3, Steps: 64 | Train Loss: 0.2028180 Vali Loss: 0.2358937 Test Loss: 0.2132432
Validation loss decreased (0.365055 --> 0.235894).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 4 cost time: 0.9493188858032227
Epoch: 4, Steps: 64 | Train Loss: 0.1500223 Vali Loss: 0.1954485 Test Loss: 0.1663744
Validation loss decreased (0.235894 --> 0.195448).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 5 cost time: 0.9426178932189941
Epoch: 5, Steps: 64 | Train Loss: 0.1322442 Vali Loss: 0.1836440 Test Loss: 0.1568243
Validation loss decreased (0.195448 --> 0.183644).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 6 cost time: 0.9354293346405029
Epoch: 6, Steps: 64 | Train Loss: 0.1243486 Vali Loss: 0.1737388 Test Loss: 0.1522819
Validation loss decreased (0.183644 --> 0.173739).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 7 cost time: 0.8924334049224854
Epoch: 7, Steps: 64 | Train Loss: 0.1187016 Vali Loss: 0.1720049 Test Loss: 0.1508759
Validation loss decreased (0.173739 --> 0.172005).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 8 cost time: 0.8928325176239014
Epoch: 8, Steps: 64 | Train Loss: 0.1136974 Vali Loss: 0.1659135 Test Loss: 0.1488385
Validation loss decreased (0.172005 --> 0.165913).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 9 cost time: 0.9074206352233887
Epoch: 9, Steps: 64 | Train Loss: 0.1099881 Vali Loss: 0.1654172 Test Loss: 0.1486929
Validation loss decreased (0.165913 --> 0.165417).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 10 cost time: 0.9277510643005371
Epoch: 10, Steps: 64 | Train Loss: 0.1084676 Vali Loss: 0.1643592 Test Loss: 0.1465770
Validation loss decreased (0.165417 --> 0.164359).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 11 cost time: 0.942781925201416
Epoch: 11, Steps: 64 | Train Loss: 0.1063523 Vali Loss: 0.1606406 Test Loss: 0.1458599
Validation loss decreased (0.164359 --> 0.160641).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 12 cost time: 0.9501988887786865
Epoch: 12, Steps: 64 | Train Loss: 0.1048340 Vali Loss: 0.1591724 Test Loss: 0.1446001
Validation loss decreased (0.160641 --> 0.159172).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 13 cost time: 0.9466466903686523
Epoch: 13, Steps: 64 | Train Loss: 0.1025672 Vali Loss: 0.1601868 Test Loss: 0.1445703
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 14 cost time: 0.9284954071044922
Epoch: 14, Steps: 64 | Train Loss: 0.1016956 Vali Loss: 0.1588505 Test Loss: 0.1437600
Validation loss decreased (0.159172 --> 0.158850).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 15 cost time: 0.9265139102935791
Epoch: 15, Steps: 64 | Train Loss: 0.0997382 Vali Loss: 0.1579010 Test Loss: 0.1440053
Validation loss decreased (0.158850 --> 0.157901).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 16 cost time: 0.923410177230835
Epoch: 16, Steps: 64 | Train Loss: 0.0993553 Vali Loss: 0.1550179 Test Loss: 0.1433040
Validation loss decreased (0.157901 --> 0.155018).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 17 cost time: 0.931396484375
Epoch: 17, Steps: 64 | Train Loss: 0.0988003 Vali Loss: 0.1578912 Test Loss: 0.1441875
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 18 cost time: 0.9447393417358398
Epoch: 18, Steps: 64 | Train Loss: 0.0980100 Vali Loss: 0.1572307 Test Loss: 0.1430808
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 19 cost time: 0.9489996433258057
Epoch: 19, Steps: 64 | Train Loss: 0.0973665 Vali Loss: 0.1571572 Test Loss: 0.1435407
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 20 cost time: 0.9504537582397461
Epoch: 20, Steps: 64 | Train Loss: 0.0970990 Vali Loss: 0.1534842 Test Loss: 0.1423769
Validation loss decreased (0.155018 --> 0.153484).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 21 cost time: 0.9216539859771729
Epoch: 21, Steps: 64 | Train Loss: 0.0959947 Vali Loss: 0.1548738 Test Loss: 0.1414713
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 22 cost time: 0.8974192142486572
Epoch: 22, Steps: 64 | Train Loss: 0.0958326 Vali Loss: 0.1524056 Test Loss: 0.1418475
Validation loss decreased (0.153484 --> 0.152406).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 23 cost time: 0.9053788185119629
Epoch: 23, Steps: 64 | Train Loss: 0.0962119 Vali Loss: 0.1534627 Test Loss: 0.1418610
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 24 cost time: 0.8934304714202881
Epoch: 24, Steps: 64 | Train Loss: 0.0952340 Vali Loss: 0.1538243 Test Loss: 0.1420565
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 25 cost time: 0.8981738090515137
Epoch: 25, Steps: 64 | Train Loss: 0.0948702 Vali Loss: 0.1533134 Test Loss: 0.1417705
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 26 cost time: 0.9000000953674316
Epoch: 26, Steps: 64 | Train Loss: 0.0939764 Vali Loss: 0.1538133 Test Loss: 0.1417474
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 27 cost time: 0.9356358051300049
Epoch: 27, Steps: 64 | Train Loss: 0.0940454 Vali Loss: 0.1520659 Test Loss: 0.1418701
Validation loss decreased (0.152406 --> 0.152066).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 28 cost time: 0.9238748550415039
Epoch: 28, Steps: 64 | Train Loss: 0.0939128 Vali Loss: 0.1515962 Test Loss: 0.1418340
Validation loss decreased (0.152066 --> 0.151596).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 29 cost time: 0.9163596630096436
Epoch: 29, Steps: 64 | Train Loss: 0.0938370 Vali Loss: 0.1504966 Test Loss: 0.1415885
Validation loss decreased (0.151596 --> 0.150497).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 30 cost time: 0.9303638935089111
Epoch: 30, Steps: 64 | Train Loss: 0.0933443 Vali Loss: 0.1499712 Test Loss: 0.1410160
Validation loss decreased (0.150497 --> 0.149971).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 31 cost time: 0.940479040145874
Epoch: 31, Steps: 64 | Train Loss: 0.0930792 Vali Loss: 0.1506695 Test Loss: 0.1405234
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 32 cost time: 0.9404213428497314
Epoch: 32, Steps: 64 | Train Loss: 0.0928465 Vali Loss: 0.1522307 Test Loss: 0.1411532
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 33 cost time: 0.9514510631561279
Epoch: 33, Steps: 64 | Train Loss: 0.0929605 Vali Loss: 0.1532081 Test Loss: 0.1413607
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 34 cost time: 0.9360005855560303
Epoch: 34, Steps: 64 | Train Loss: 0.0927516 Vali Loss: 0.1517550 Test Loss: 0.1415573
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 35 cost time: 0.9476373195648193
Epoch: 35, Steps: 64 | Train Loss: 0.0925804 Vali Loss: 0.1500067 Test Loss: 0.1405839
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 36 cost time: 0.9494898319244385
Epoch: 36, Steps: 64 | Train Loss: 0.0926874 Vali Loss: 0.1509826 Test Loss: 0.1408779
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 37 cost time: 0.9502251148223877
Epoch: 37, Steps: 64 | Train Loss: 0.0926119 Vali Loss: 0.1513244 Test Loss: 0.1412146
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 38 cost time: 0.9473683834075928
Epoch: 38, Steps: 64 | Train Loss: 0.0922234 Vali Loss: 0.1490052 Test Loss: 0.1406146
Validation loss decreased (0.149971 --> 0.149005).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 39 cost time: 0.9405646324157715
Epoch: 39, Steps: 64 | Train Loss: 0.0923078 Vali Loss: 0.1504385 Test Loss: 0.1413062
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 40 cost time: 0.9243969917297363
Epoch: 40, Steps: 64 | Train Loss: 0.0923475 Vali Loss: 0.1503608 Test Loss: 0.1409007
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 41 cost time: 0.9047703742980957
Epoch: 41, Steps: 64 | Train Loss: 0.0919940 Vali Loss: 0.1498010 Test Loss: 0.1404056
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 42 cost time: 0.8956291675567627
Epoch: 42, Steps: 64 | Train Loss: 0.0920211 Vali Loss: 0.1493272 Test Loss: 0.1409517
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 43 cost time: 0.8976349830627441
Epoch: 43, Steps: 64 | Train Loss: 0.0923204 Vali Loss: 0.1513087 Test Loss: 0.1411104
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 44 cost time: 0.9254746437072754
Epoch: 44, Steps: 64 | Train Loss: 0.0920343 Vali Loss: 0.1489441 Test Loss: 0.1405669
Validation loss decreased (0.149005 --> 0.148944).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 45 cost time: 0.9225156307220459
Epoch: 45, Steps: 64 | Train Loss: 0.0922537 Vali Loss: 0.1490811 Test Loss: 0.1402686
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 46 cost time: 0.9170057773590088
Epoch: 46, Steps: 64 | Train Loss: 0.0919214 Vali Loss: 0.1506731 Test Loss: 0.1409623
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 47 cost time: 0.9135065078735352
Epoch: 47, Steps: 64 | Train Loss: 0.0917512 Vali Loss: 0.1497179 Test Loss: 0.1407209
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 48 cost time: 0.91452956199646
Epoch: 48, Steps: 64 | Train Loss: 0.0919486 Vali Loss: 0.1496549 Test Loss: 0.1412543
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 49 cost time: 0.9025545120239258
Epoch: 49, Steps: 64 | Train Loss: 0.0919192 Vali Loss: 0.1487302 Test Loss: 0.1407435
Validation loss decreased (0.148944 --> 0.148730).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 50 cost time: 0.8990445137023926
Epoch: 50, Steps: 64 | Train Loss: 0.0916014 Vali Loss: 0.1501562 Test Loss: 0.1411381
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 51 cost time: 0.9223902225494385
Epoch: 51, Steps: 64 | Train Loss: 0.0915882 Vali Loss: 0.1501256 Test Loss: 0.1407181
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 52 cost time: 0.9374492168426514
Epoch: 52, Steps: 64 | Train Loss: 0.0912344 Vali Loss: 0.1499437 Test Loss: 0.1404677
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 53 cost time: 0.9518637657165527
Epoch: 53, Steps: 64 | Train Loss: 0.0915145 Vali Loss: 0.1485248 Test Loss: 0.1406160
Validation loss decreased (0.148730 --> 0.148525).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 54 cost time: 0.945725679397583
Epoch: 54, Steps: 64 | Train Loss: 0.0918918 Vali Loss: 0.1485482 Test Loss: 0.1405575
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 55 cost time: 0.9484150409698486
Epoch: 55, Steps: 64 | Train Loss: 0.0922417 Vali Loss: 0.1492415 Test Loss: 0.1406326
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 56 cost time: 0.943000078201294
Epoch: 56, Steps: 64 | Train Loss: 0.0915533 Vali Loss: 0.1499759 Test Loss: 0.1408615
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 57 cost time: 0.9260005950927734
Epoch: 57, Steps: 64 | Train Loss: 0.0909685 Vali Loss: 0.1493032 Test Loss: 0.1407750
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 58 cost time: 0.9366483688354492
Epoch: 58, Steps: 64 | Train Loss: 0.0919930 Vali Loss: 0.1502322 Test Loss: 0.1405797
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 59 cost time: 0.9282486438751221
Epoch: 59, Steps: 64 | Train Loss: 0.0913343 Vali Loss: 0.1498210 Test Loss: 0.1405068
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018117904663085938 GB
GPU已分配内存的峰值：0.05043792724609375 GB
Epoch: 60 cost time: 0.9273903369903564
Epoch: 60, Steps: 64 | Train Loss: 0.0911979 Vali Loss: 0.1495140 Test Loss: 0.1405372
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1406160295009613, mae:0.27409207820892334, rse:0.1995898187160492
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05106353759765625 GB
Epoch: 1 cost time: 2.369959831237793
Epoch: 1, Steps: 64 | Train Loss: 0.8325331 Vali Loss: 1.8451555 Test Loss: 3.4981976
Validation loss decreased (inf --> 1.845155).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 2 cost time: 0.9490363597869873
Epoch: 2, Steps: 64 | Train Loss: 0.4813428 Vali Loss: 0.4889993 Test Loss: 0.6849762
Validation loss decreased (1.845155 --> 0.488999).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 3 cost time: 0.9482784271240234
Epoch: 3, Steps: 64 | Train Loss: 0.1684385 Vali Loss: 0.2252588 Test Loss: 0.2068923
Validation loss decreased (0.488999 --> 0.225259).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 4 cost time: 0.9494204521179199
Epoch: 4, Steps: 64 | Train Loss: 0.1108513 Vali Loss: 0.1786834 Test Loss: 0.1481554
Validation loss decreased (0.225259 --> 0.178683).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 5 cost time: 0.919452428817749
Epoch: 5, Steps: 64 | Train Loss: 0.0993172 Vali Loss: 0.1664084 Test Loss: 0.1409186
Validation loss decreased (0.178683 --> 0.166408).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 6 cost time: 0.9257612228393555
Epoch: 6, Steps: 64 | Train Loss: 0.0955048 Vali Loss: 0.1640143 Test Loss: 0.1409632
Validation loss decreased (0.166408 --> 0.164014).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 7 cost time: 0.9287495613098145
Epoch: 7, Steps: 64 | Train Loss: 0.0928846 Vali Loss: 0.1606829 Test Loss: 0.1394965
Validation loss decreased (0.164014 --> 0.160683).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 8 cost time: 0.9369997978210449
Epoch: 8, Steps: 64 | Train Loss: 0.0910320 Vali Loss: 0.1585308 Test Loss: 0.1392916
Validation loss decreased (0.160683 --> 0.158531).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 9 cost time: 0.9456474781036377
Epoch: 9, Steps: 64 | Train Loss: 0.0892293 Vali Loss: 0.1552038 Test Loss: 0.1385624
Validation loss decreased (0.158531 --> 0.155204).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 10 cost time: 0.9483747482299805
Epoch: 10, Steps: 64 | Train Loss: 0.0881493 Vali Loss: 0.1533983 Test Loss: 0.1377197
Validation loss decreased (0.155204 --> 0.153398).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 11 cost time: 0.9792139530181885
Epoch: 11, Steps: 64 | Train Loss: 0.0871100 Vali Loss: 0.1520047 Test Loss: 0.1377470
Validation loss decreased (0.153398 --> 0.152005).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 12 cost time: 0.9754467010498047
Epoch: 12, Steps: 64 | Train Loss: 0.0861940 Vali Loss: 0.1534851 Test Loss: 0.1382249
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 13 cost time: 0.9613728523254395
Epoch: 13, Steps: 64 | Train Loss: 0.0857199 Vali Loss: 0.1521873 Test Loss: 0.1375184
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 14 cost time: 0.9543745517730713
Epoch: 14, Steps: 64 | Train Loss: 0.0851529 Vali Loss: 0.1506995 Test Loss: 0.1368016
Validation loss decreased (0.152005 --> 0.150700).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 15 cost time: 0.955439567565918
Epoch: 15, Steps: 64 | Train Loss: 0.0848848 Vali Loss: 0.1508613 Test Loss: 0.1371863
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 16 cost time: 0.9575424194335938
Epoch: 16, Steps: 64 | Train Loss: 0.0844304 Vali Loss: 0.1474258 Test Loss: 0.1361372
Validation loss decreased (0.150700 --> 0.147426).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 17 cost time: 0.9589979648590088
Epoch: 17, Steps: 64 | Train Loss: 0.0836607 Vali Loss: 0.1483149 Test Loss: 0.1364617
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 18 cost time: 0.9796364307403564
Epoch: 18, Steps: 64 | Train Loss: 0.0835691 Vali Loss: 0.1481285 Test Loss: 0.1364397
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 19 cost time: 0.9666235446929932
Epoch: 19, Steps: 64 | Train Loss: 0.0830286 Vali Loss: 0.1466634 Test Loss: 0.1357625
Validation loss decreased (0.147426 --> 0.146663).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 20 cost time: 0.9616377353668213
Epoch: 20, Steps: 64 | Train Loss: 0.0828387 Vali Loss: 0.1476661 Test Loss: 0.1359697
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 21 cost time: 0.950385570526123
Epoch: 21, Steps: 64 | Train Loss: 0.0823865 Vali Loss: 0.1470873 Test Loss: 0.1366311
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 22 cost time: 0.9314863681793213
Epoch: 22, Steps: 64 | Train Loss: 0.0821780 Vali Loss: 0.1472456 Test Loss: 0.1367128
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 23 cost time: 0.9245283603668213
Epoch: 23, Steps: 64 | Train Loss: 0.0817640 Vali Loss: 0.1451529 Test Loss: 0.1365581
Validation loss decreased (0.146663 --> 0.145153).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 24 cost time: 0.9242861270904541
Epoch: 24, Steps: 64 | Train Loss: 0.0818450 Vali Loss: 0.1478762 Test Loss: 0.1363938
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 25 cost time: 0.9409995079040527
Epoch: 25, Steps: 64 | Train Loss: 0.0817163 Vali Loss: 0.1458615 Test Loss: 0.1364332
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 26 cost time: 0.9570016860961914
Epoch: 26, Steps: 64 | Train Loss: 0.0815355 Vali Loss: 0.1442968 Test Loss: 0.1360478
Validation loss decreased (0.145153 --> 0.144297).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 27 cost time: 0.9476587772369385
Epoch: 27, Steps: 64 | Train Loss: 0.0808759 Vali Loss: 0.1441195 Test Loss: 0.1360744
Validation loss decreased (0.144297 --> 0.144120).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 28 cost time: 0.9653503894805908
Epoch: 28, Steps: 64 | Train Loss: 0.0810218 Vali Loss: 0.1442702 Test Loss: 0.1358721
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 29 cost time: 0.9514865875244141
Epoch: 29, Steps: 64 | Train Loss: 0.0807783 Vali Loss: 0.1458605 Test Loss: 0.1364653
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 30 cost time: 0.9484050273895264
Epoch: 30, Steps: 64 | Train Loss: 0.0809708 Vali Loss: 0.1454368 Test Loss: 0.1359397
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 31 cost time: 0.9584639072418213
Epoch: 31, Steps: 64 | Train Loss: 0.0805785 Vali Loss: 0.1431886 Test Loss: 0.1353184
Validation loss decreased (0.144120 --> 0.143189).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 32 cost time: 0.9503998756408691
Epoch: 32, Steps: 64 | Train Loss: 0.0807366 Vali Loss: 0.1435034 Test Loss: 0.1358295
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 33 cost time: 0.9487831592559814
Epoch: 33, Steps: 64 | Train Loss: 0.0805813 Vali Loss: 0.1443215 Test Loss: 0.1357465
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 34 cost time: 0.9599990844726562
Epoch: 34, Steps: 64 | Train Loss: 0.0806512 Vali Loss: 0.1432430 Test Loss: 0.1357624
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 35 cost time: 0.993999719619751
Epoch: 35, Steps: 64 | Train Loss: 0.0805362 Vali Loss: 0.1445555 Test Loss: 0.1357476
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 36 cost time: 0.983006477355957
Epoch: 36, Steps: 64 | Train Loss: 0.0803779 Vali Loss: 0.1443149 Test Loss: 0.1353453
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 37 cost time: 0.9796473979949951
Epoch: 37, Steps: 64 | Train Loss: 0.0804387 Vali Loss: 0.1446261 Test Loss: 0.1357094
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 38 cost time: 0.98543381690979
Epoch: 38, Steps: 64 | Train Loss: 0.0803982 Vali Loss: 0.1443500 Test Loss: 0.1356397
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 39 cost time: 0.9516863822937012
Epoch: 39, Steps: 64 | Train Loss: 0.0802055 Vali Loss: 0.1436071 Test Loss: 0.1357618
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 40 cost time: 0.9197723865509033
Epoch: 40, Steps: 64 | Train Loss: 0.0800110 Vali Loss: 0.1439426 Test Loss: 0.1359608
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 41 cost time: 0.9243674278259277
Epoch: 41, Steps: 64 | Train Loss: 0.0801749 Vali Loss: 0.1455235 Test Loss: 0.1362234
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 42 cost time: 0.9228067398071289
Epoch: 42, Steps: 64 | Train Loss: 0.0801625 Vali Loss: 0.1427457 Test Loss: 0.1351210
Validation loss decreased (0.143189 --> 0.142746).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 43 cost time: 0.943720817565918
Epoch: 43, Steps: 64 | Train Loss: 0.0800336 Vali Loss: 0.1421445 Test Loss: 0.1358022
Validation loss decreased (0.142746 --> 0.142145).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 44 cost time: 0.9530019760131836
Epoch: 44, Steps: 64 | Train Loss: 0.0800846 Vali Loss: 0.1444883 Test Loss: 0.1359333
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 45 cost time: 0.926645040512085
Epoch: 45, Steps: 64 | Train Loss: 0.0802166 Vali Loss: 0.1426266 Test Loss: 0.1355660
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 46 cost time: 0.9387557506561279
Epoch: 46, Steps: 64 | Train Loss: 0.0801757 Vali Loss: 0.1417972 Test Loss: 0.1350967
Validation loss decreased (0.142145 --> 0.141797).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 47 cost time: 0.9304256439208984
Epoch: 47, Steps: 64 | Train Loss: 0.0797044 Vali Loss: 0.1424609 Test Loss: 0.1352025
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 48 cost time: 0.9329986572265625
Epoch: 48, Steps: 64 | Train Loss: 0.0802393 Vali Loss: 0.1423109 Test Loss: 0.1350418
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 49 cost time: 0.9348597526550293
Epoch: 49, Steps: 64 | Train Loss: 0.0801136 Vali Loss: 0.1424425 Test Loss: 0.1353165
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 50 cost time: 0.9593942165374756
Epoch: 50, Steps: 64 | Train Loss: 0.0798748 Vali Loss: 0.1445868 Test Loss: 0.1363378
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 51 cost time: 0.970388650894165
Epoch: 51, Steps: 64 | Train Loss: 0.0799640 Vali Loss: 0.1438863 Test Loss: 0.1365305
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 52 cost time: 0.9843335151672363
Epoch: 52, Steps: 64 | Train Loss: 0.0797109 Vali Loss: 0.1417003 Test Loss: 0.1353073
Validation loss decreased (0.141797 --> 0.141700).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 53 cost time: 0.9783878326416016
Epoch: 53, Steps: 64 | Train Loss: 0.0799212 Vali Loss: 0.1428755 Test Loss: 0.1354553
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 54 cost time: 0.970644474029541
Epoch: 54, Steps: 64 | Train Loss: 0.0799081 Vali Loss: 0.1413007 Test Loss: 0.1351773
Validation loss decreased (0.141700 --> 0.141301).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 55 cost time: 0.9561359882354736
Epoch: 55, Steps: 64 | Train Loss: 0.0799578 Vali Loss: 0.1432086 Test Loss: 0.1354686
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 56 cost time: 0.9536879062652588
Epoch: 56, Steps: 64 | Train Loss: 0.0799548 Vali Loss: 0.1409129 Test Loss: 0.1352665
Validation loss decreased (0.141301 --> 0.140913).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 57 cost time: 0.9524168968200684
Epoch: 57, Steps: 64 | Train Loss: 0.0800442 Vali Loss: 0.1425369 Test Loss: 0.1358787
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 58 cost time: 0.9563891887664795
Epoch: 58, Steps: 64 | Train Loss: 0.0800467 Vali Loss: 0.1421629 Test Loss: 0.1354600
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 59 cost time: 0.974402904510498
Epoch: 59, Steps: 64 | Train Loss: 0.0800411 Vali Loss: 0.1439014 Test Loss: 0.1368322
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018247604370117188 GB
GPU已分配内存的峰值：0.05200004577636719 GB
Epoch: 60 cost time: 0.98744797706604
Epoch: 60, Steps: 64 | Train Loss: 0.0797573 Vali Loss: 0.1440824 Test Loss: 0.1360966
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1352664977312088, mae:0.2669423520565033, rse:0.1957564651966095
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.05218362808227539 GB
Epoch: 1 cost time: 2.374788522720337
Epoch: 1, Steps: 64 | Train Loss: 0.7490240 Vali Loss: 1.7403779 Test Loss: 3.2438188
Validation loss decreased (inf --> 1.740378).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 2 cost time: 0.9764223098754883
Epoch: 2, Steps: 64 | Train Loss: 0.4630634 Vali Loss: 0.4868078 Test Loss: 0.6291206
Validation loss decreased (1.740378 --> 0.486808).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 3 cost time: 1.0099976062774658
Epoch: 3, Steps: 64 | Train Loss: 0.1491511 Vali Loss: 0.2139444 Test Loss: 0.1792597
Validation loss decreased (0.486808 --> 0.213944).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 4 cost time: 1.0034172534942627
Epoch: 4, Steps: 64 | Train Loss: 0.1060622 Vali Loss: 0.1825469 Test Loss: 0.1646524
Validation loss decreased (0.213944 --> 0.182547).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 5 cost time: 0.9540669918060303
Epoch: 5, Steps: 64 | Train Loss: 0.0976584 Vali Loss: 0.1685100 Test Loss: 0.1509140
Validation loss decreased (0.182547 --> 0.168510).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 6 cost time: 0.9537162780761719
Epoch: 6, Steps: 64 | Train Loss: 0.0932199 Vali Loss: 0.1619837 Test Loss: 0.1471100
Validation loss decreased (0.168510 --> 0.161984).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 7 cost time: 0.9569997787475586
Epoch: 7, Steps: 64 | Train Loss: 0.0905292 Vali Loss: 0.1604845 Test Loss: 0.1440145
Validation loss decreased (0.161984 --> 0.160485).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 8 cost time: 0.9626317024230957
Epoch: 8, Steps: 64 | Train Loss: 0.0887736 Vali Loss: 0.1574501 Test Loss: 0.1435498
Validation loss decreased (0.160485 --> 0.157450).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 9 cost time: 0.9823644161224365
Epoch: 9, Steps: 64 | Train Loss: 0.0870185 Vali Loss: 0.1542500 Test Loss: 0.1420010
Validation loss decreased (0.157450 --> 0.154250).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 10 cost time: 0.9963822364807129
Epoch: 10, Steps: 64 | Train Loss: 0.0858671 Vali Loss: 0.1528826 Test Loss: 0.1399213
Validation loss decreased (0.154250 --> 0.152883).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 11 cost time: 1.0085728168487549
Epoch: 11, Steps: 64 | Train Loss: 0.0848512 Vali Loss: 0.1548179 Test Loss: 0.1400134
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 12 cost time: 1.0154080390930176
Epoch: 12, Steps: 64 | Train Loss: 0.0839514 Vali Loss: 0.1500224 Test Loss: 0.1395711
Validation loss decreased (0.152883 --> 0.150022).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 13 cost time: 1.00581693649292
Epoch: 13, Steps: 64 | Train Loss: 0.0831313 Vali Loss: 0.1480466 Test Loss: 0.1395829
Validation loss decreased (0.150022 --> 0.148047).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 14 cost time: 1.004380464553833
Epoch: 14, Steps: 64 | Train Loss: 0.0823439 Vali Loss: 0.1459315 Test Loss: 0.1385473
Validation loss decreased (0.148047 --> 0.145932).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 15 cost time: 0.9834251403808594
Epoch: 15, Steps: 64 | Train Loss: 0.0819102 Vali Loss: 0.1452939 Test Loss: 0.1391893
Validation loss decreased (0.145932 --> 0.145294).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 16 cost time: 0.9883632659912109
Epoch: 16, Steps: 64 | Train Loss: 0.0817466 Vali Loss: 0.1463271 Test Loss: 0.1384131
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 17 cost time: 1.0004286766052246
Epoch: 17, Steps: 64 | Train Loss: 0.0811539 Vali Loss: 0.1444373 Test Loss: 0.1378376
Validation loss decreased (0.145294 --> 0.144437).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 18 cost time: 1.0058026313781738
Epoch: 18, Steps: 64 | Train Loss: 0.0809702 Vali Loss: 0.1464150 Test Loss: 0.1384499
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 19 cost time: 0.9947233200073242
Epoch: 19, Steps: 64 | Train Loss: 0.0807123 Vali Loss: 0.1460675 Test Loss: 0.1394688
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 20 cost time: 0.9739987850189209
Epoch: 20, Steps: 64 | Train Loss: 0.0803695 Vali Loss: 0.1445012 Test Loss: 0.1378942
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 21 cost time: 0.9623808860778809
Epoch: 21, Steps: 64 | Train Loss: 0.0800817 Vali Loss: 0.1443307 Test Loss: 0.1384227
Validation loss decreased (0.144437 --> 0.144331).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 22 cost time: 0.9526240825653076
Epoch: 22, Steps: 64 | Train Loss: 0.0800425 Vali Loss: 0.1431568 Test Loss: 0.1383301
Validation loss decreased (0.144331 --> 0.143157).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 23 cost time: 0.9623961448669434
Epoch: 23, Steps: 64 | Train Loss: 0.0796773 Vali Loss: 0.1442422 Test Loss: 0.1381582
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 24 cost time: 0.9703705310821533
Epoch: 24, Steps: 64 | Train Loss: 0.0793375 Vali Loss: 0.1414722 Test Loss: 0.1374815
Validation loss decreased (0.143157 --> 0.141472).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 25 cost time: 0.9671733379364014
Epoch: 25, Steps: 64 | Train Loss: 0.0788630 Vali Loss: 0.1413110 Test Loss: 0.1370598
Validation loss decreased (0.141472 --> 0.141311).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 26 cost time: 0.9961423873901367
Epoch: 26, Steps: 64 | Train Loss: 0.0789371 Vali Loss: 0.1425678 Test Loss: 0.1381781
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 27 cost time: 1.0114483833312988
Epoch: 27, Steps: 64 | Train Loss: 0.0790780 Vali Loss: 0.1408130 Test Loss: 0.1375274
Validation loss decreased (0.141311 --> 0.140813).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 28 cost time: 0.9814314842224121
Epoch: 28, Steps: 64 | Train Loss: 0.0791915 Vali Loss: 0.1423681 Test Loss: 0.1379115
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 29 cost time: 0.9877777099609375
Epoch: 29, Steps: 64 | Train Loss: 0.0785804 Vali Loss: 0.1433673 Test Loss: 0.1388329
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 30 cost time: 0.9907584190368652
Epoch: 30, Steps: 64 | Train Loss: 0.0785809 Vali Loss: 0.1422487 Test Loss: 0.1383303
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 31 cost time: 1.0108354091644287
Epoch: 31, Steps: 64 | Train Loss: 0.0784508 Vali Loss: 0.1417520 Test Loss: 0.1367614
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 32 cost time: 1.005000114440918
Epoch: 32, Steps: 64 | Train Loss: 0.0786431 Vali Loss: 0.1432919 Test Loss: 0.1384438
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 33 cost time: 1.0060555934906006
Epoch: 33, Steps: 64 | Train Loss: 0.0783583 Vali Loss: 0.1422876 Test Loss: 0.1377185
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 34 cost time: 1.0156254768371582
Epoch: 34, Steps: 64 | Train Loss: 0.0781235 Vali Loss: 0.1416092 Test Loss: 0.1382082
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 35 cost time: 1.0186412334442139
Epoch: 35, Steps: 64 | Train Loss: 0.0781037 Vali Loss: 0.1397448 Test Loss: 0.1371716
Validation loss decreased (0.140813 --> 0.139745).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 36 cost time: 1.0074620246887207
Epoch: 36, Steps: 64 | Train Loss: 0.0784655 Vali Loss: 0.1406272 Test Loss: 0.1369820
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 37 cost time: 1.0167787075042725
Epoch: 37, Steps: 64 | Train Loss: 0.0782570 Vali Loss: 0.1411795 Test Loss: 0.1381216
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 38 cost time: 0.9683659076690674
Epoch: 38, Steps: 64 | Train Loss: 0.0779166 Vali Loss: 0.1422201 Test Loss: 0.1389070
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 39 cost time: 0.9534878730773926
Epoch: 39, Steps: 64 | Train Loss: 0.0784301 Vali Loss: 0.1430173 Test Loss: 0.1384415
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 40 cost time: 0.95819091796875
Epoch: 40, Steps: 64 | Train Loss: 0.0780368 Vali Loss: 0.1408090 Test Loss: 0.1384614
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 41 cost time: 0.9498605728149414
Epoch: 41, Steps: 64 | Train Loss: 0.0781583 Vali Loss: 0.1420324 Test Loss: 0.1375160
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 42 cost time: 0.9837837219238281
Epoch: 42, Steps: 64 | Train Loss: 0.0775881 Vali Loss: 0.1418924 Test Loss: 0.1369617
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 43 cost time: 0.9777288436889648
Epoch: 43, Steps: 64 | Train Loss: 0.0776296 Vali Loss: 0.1402622 Test Loss: 0.1369836
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 44 cost time: 0.9760012626647949
Epoch: 44, Steps: 64 | Train Loss: 0.0779102 Vali Loss: 0.1417863 Test Loss: 0.1386099
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 45 cost time: 0.9937734603881836
Epoch: 45, Steps: 64 | Train Loss: 0.0775947 Vali Loss: 0.1403741 Test Loss: 0.1376655
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 46 cost time: 0.964648962020874
Epoch: 46, Steps: 64 | Train Loss: 0.0781491 Vali Loss: 0.1396861 Test Loss: 0.1372101
Validation loss decreased (0.139745 --> 0.139686).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 47 cost time: 0.9754953384399414
Epoch: 47, Steps: 64 | Train Loss: 0.0777803 Vali Loss: 0.1414449 Test Loss: 0.1376953
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 48 cost time: 0.9924511909484863
Epoch: 48, Steps: 64 | Train Loss: 0.0779783 Vali Loss: 0.1399525 Test Loss: 0.1383277
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 49 cost time: 0.9834413528442383
Epoch: 49, Steps: 64 | Train Loss: 0.0774343 Vali Loss: 0.1422406 Test Loss: 0.1376815
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 50 cost time: 1.028386116027832
Epoch: 50, Steps: 64 | Train Loss: 0.0776619 Vali Loss: 0.1411611 Test Loss: 0.1378900
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 51 cost time: 1.0103504657745361
Epoch: 51, Steps: 64 | Train Loss: 0.0777175 Vali Loss: 0.1390448 Test Loss: 0.1379750
Validation loss decreased (0.139686 --> 0.139045).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 52 cost time: 1.013401985168457
Epoch: 52, Steps: 64 | Train Loss: 0.0776903 Vali Loss: 0.1400797 Test Loss: 0.1366866
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 53 cost time: 1.0293917655944824
Epoch: 53, Steps: 64 | Train Loss: 0.0776469 Vali Loss: 0.1419569 Test Loss: 0.1394806
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 54 cost time: 0.9863355159759521
Epoch: 54, Steps: 64 | Train Loss: 0.0780276 Vali Loss: 0.1408602 Test Loss: 0.1371819
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 55 cost time: 0.9767701625823975
Epoch: 55, Steps: 64 | Train Loss: 0.0774228 Vali Loss: 0.1390624 Test Loss: 0.1379555
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 56 cost time: 0.9907855987548828
Epoch: 56, Steps: 64 | Train Loss: 0.0777710 Vali Loss: 0.1415149 Test Loss: 0.1373429
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 57 cost time: 0.9660007953643799
Epoch: 57, Steps: 64 | Train Loss: 0.0778844 Vali Loss: 0.1419049 Test Loss: 0.1381766
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 58 cost time: 0.9786965847015381
Epoch: 58, Steps: 64 | Train Loss: 0.0775378 Vali Loss: 0.1399542 Test Loss: 0.1365620
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 59 cost time: 0.982635498046875
Epoch: 59, Steps: 64 | Train Loss: 0.0779629 Vali Loss: 0.1418758 Test Loss: 0.1384362
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018316268920898438 GB
GPU已分配内存的峰值：0.053516387939453125 GB
Epoch: 60 cost time: 1.0021922588348389
Epoch: 60, Steps: 64 | Train Loss: 0.0777664 Vali Loss: 0.1383754 Test Loss: 0.1363430
Validation loss decreased (0.139045 --> 0.138375).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13634300231933594, mae:0.2681114971637726, rse:0.19653387367725372
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.04979372024536133 GB
Epoch: 1 cost time: 2.3013124465942383
Epoch: 1, Steps: 64 | Train Loss: 1.1763314 Vali Loss: 2.4534702 Test Loss: 4.5573187
Validation loss decreased (inf --> 2.453470).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 2 cost time: 0.9316360950469971
Epoch: 2, Steps: 64 | Train Loss: 0.6731749 Vali Loss: 0.7016406 Test Loss: 1.0477457
Validation loss decreased (2.453470 --> 0.701641).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 3 cost time: 0.934438943862915
Epoch: 3, Steps: 64 | Train Loss: 0.3129706 Vali Loss: 0.3946329 Test Loss: 0.5012422
Validation loss decreased (0.701641 --> 0.394633).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 4 cost time: 0.9254167079925537
Epoch: 4, Steps: 64 | Train Loss: 0.1995553 Vali Loss: 0.2441859 Test Loss: 0.2397681
Validation loss decreased (0.394633 --> 0.244186).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 5 cost time: 0.9103643894195557
Epoch: 5, Steps: 64 | Train Loss: 0.1519283 Vali Loss: 0.2024995 Test Loss: 0.1797026
Validation loss decreased (0.244186 --> 0.202500).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 6 cost time: 0.9187572002410889
Epoch: 6, Steps: 64 | Train Loss: 0.1375328 Vali Loss: 0.1850394 Test Loss: 0.1647106
Validation loss decreased (0.202500 --> 0.185039).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 7 cost time: 0.9070546627044678
Epoch: 7, Steps: 64 | Train Loss: 0.1286497 Vali Loss: 0.1738918 Test Loss: 0.1573767
Validation loss decreased (0.185039 --> 0.173892).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 8 cost time: 0.9082396030426025
Epoch: 8, Steps: 64 | Train Loss: 0.1235749 Vali Loss: 0.1699511 Test Loss: 0.1539540
Validation loss decreased (0.173892 --> 0.169951).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 9 cost time: 0.9308640956878662
Epoch: 9, Steps: 64 | Train Loss: 0.1191418 Vali Loss: 0.1647336 Test Loss: 0.1508422
Validation loss decreased (0.169951 --> 0.164734).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 10 cost time: 0.9396398067474365
Epoch: 10, Steps: 64 | Train Loss: 0.1165623 Vali Loss: 0.1617758 Test Loss: 0.1485209
Validation loss decreased (0.164734 --> 0.161776).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 11 cost time: 0.9583477973937988
Epoch: 11, Steps: 64 | Train Loss: 0.1145354 Vali Loss: 0.1595502 Test Loss: 0.1477777
Validation loss decreased (0.161776 --> 0.159550).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 12 cost time: 0.9593820571899414
Epoch: 12, Steps: 64 | Train Loss: 0.1122995 Vali Loss: 0.1593271 Test Loss: 0.1467198
Validation loss decreased (0.159550 --> 0.159327).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 13 cost time: 0.9344604015350342
Epoch: 13, Steps: 64 | Train Loss: 0.1113771 Vali Loss: 0.1591353 Test Loss: 0.1467365
Validation loss decreased (0.159327 --> 0.159135).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 14 cost time: 0.9484686851501465
Epoch: 14, Steps: 64 | Train Loss: 0.1097448 Vali Loss: 0.1562943 Test Loss: 0.1454939
Validation loss decreased (0.159135 --> 0.156294).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 15 cost time: 0.9384262561798096
Epoch: 15, Steps: 64 | Train Loss: 0.1083512 Vali Loss: 0.1578575 Test Loss: 0.1455423
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 16 cost time: 0.9328606128692627
Epoch: 16, Steps: 64 | Train Loss: 0.1074833 Vali Loss: 0.1572274 Test Loss: 0.1444721
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 17 cost time: 0.9348239898681641
Epoch: 17, Steps: 64 | Train Loss: 0.1069219 Vali Loss: 0.1568586 Test Loss: 0.1445363
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 18 cost time: 0.951000452041626
Epoch: 18, Steps: 64 | Train Loss: 0.1063353 Vali Loss: 0.1543870 Test Loss: 0.1445229
Validation loss decreased (0.156294 --> 0.154387).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 19 cost time: 0.955425500869751
Epoch: 19, Steps: 64 | Train Loss: 0.1053482 Vali Loss: 0.1554568 Test Loss: 0.1441092
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 20 cost time: 0.9563734531402588
Epoch: 20, Steps: 64 | Train Loss: 0.1045048 Vali Loss: 0.1554196 Test Loss: 0.1437169
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 21 cost time: 0.9353454113006592
Epoch: 21, Steps: 64 | Train Loss: 0.1043610 Vali Loss: 0.1525721 Test Loss: 0.1429334
Validation loss decreased (0.154387 --> 0.152572).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 22 cost time: 0.9224057197570801
Epoch: 22, Steps: 64 | Train Loss: 0.1036363 Vali Loss: 0.1554699 Test Loss: 0.1431283
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 23 cost time: 0.9193964004516602
Epoch: 23, Steps: 64 | Train Loss: 0.1032692 Vali Loss: 0.1556135 Test Loss: 0.1434607
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 24 cost time: 0.9143729209899902
Epoch: 24, Steps: 64 | Train Loss: 0.1030082 Vali Loss: 0.1559879 Test Loss: 0.1439512
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 25 cost time: 0.9149999618530273
Epoch: 25, Steps: 64 | Train Loss: 0.1023144 Vali Loss: 0.1555721 Test Loss: 0.1435362
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 26 cost time: 0.9209983348846436
Epoch: 26, Steps: 64 | Train Loss: 0.1022444 Vali Loss: 0.1532972 Test Loss: 0.1425897
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 27 cost time: 0.9366402626037598
Epoch: 27, Steps: 64 | Train Loss: 0.1011454 Vali Loss: 0.1509834 Test Loss: 0.1430030
Validation loss decreased (0.152572 --> 0.150983).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 28 cost time: 0.9353759288787842
Epoch: 28, Steps: 64 | Train Loss: 0.1017405 Vali Loss: 0.1527849 Test Loss: 0.1421359
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 29 cost time: 0.9245448112487793
Epoch: 29, Steps: 64 | Train Loss: 0.1015875 Vali Loss: 0.1542985 Test Loss: 0.1422683
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 30 cost time: 0.9334666728973389
Epoch: 30, Steps: 64 | Train Loss: 0.1010073 Vali Loss: 0.1524213 Test Loss: 0.1422533
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 31 cost time: 0.9253756999969482
Epoch: 31, Steps: 64 | Train Loss: 0.1002724 Vali Loss: 0.1527176 Test Loss: 0.1420473
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 32 cost time: 0.9290456771850586
Epoch: 32, Steps: 64 | Train Loss: 0.1006278 Vali Loss: 0.1528411 Test Loss: 0.1424099
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 33 cost time: 0.9360013008117676
Epoch: 33, Steps: 64 | Train Loss: 0.1008362 Vali Loss: 0.1543619 Test Loss: 0.1427246
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 34 cost time: 0.9416272640228271
Epoch: 34, Steps: 64 | Train Loss: 0.1007983 Vali Loss: 0.1527878 Test Loss: 0.1420223
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 35 cost time: 0.9576380252838135
Epoch: 35, Steps: 64 | Train Loss: 0.1001508 Vali Loss: 0.1516863 Test Loss: 0.1421711
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 36 cost time: 0.9538271427154541
Epoch: 36, Steps: 64 | Train Loss: 0.1002446 Vali Loss: 0.1534307 Test Loss: 0.1424191
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 37 cost time: 0.9574544429779053
Epoch: 37, Steps: 64 | Train Loss: 0.1001267 Vali Loss: 0.1531016 Test Loss: 0.1423181
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 38 cost time: 0.9584872722625732
Epoch: 38, Steps: 64 | Train Loss: 0.0997245 Vali Loss: 0.1532301 Test Loss: 0.1422496
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 39 cost time: 0.9300687313079834
Epoch: 39, Steps: 64 | Train Loss: 0.1000591 Vali Loss: 0.1519826 Test Loss: 0.1425845
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 40 cost time: 0.9478566646575928
Epoch: 40, Steps: 64 | Train Loss: 0.0995827 Vali Loss: 0.1513480 Test Loss: 0.1416716
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 41 cost time: 0.9137585163116455
Epoch: 41, Steps: 64 | Train Loss: 0.0997966 Vali Loss: 0.1524951 Test Loss: 0.1417469
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 42 cost time: 0.9030022621154785
Epoch: 42, Steps: 64 | Train Loss: 0.0998045 Vali Loss: 0.1537679 Test Loss: 0.1419848
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 43 cost time: 0.9226188659667969
Epoch: 43, Steps: 64 | Train Loss: 0.0998416 Vali Loss: 0.1515782 Test Loss: 0.1423256
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 44 cost time: 0.947481632232666
Epoch: 44, Steps: 64 | Train Loss: 0.0997562 Vali Loss: 0.1508780 Test Loss: 0.1414749
Validation loss decreased (0.150983 --> 0.150878).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 45 cost time: 0.9318735599517822
Epoch: 45, Steps: 64 | Train Loss: 0.0998657 Vali Loss: 0.1507261 Test Loss: 0.1416839
Validation loss decreased (0.150878 --> 0.150726).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 46 cost time: 0.9413847923278809
Epoch: 46, Steps: 64 | Train Loss: 0.0995333 Vali Loss: 0.1518192 Test Loss: 0.1415703
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 47 cost time: 0.9373681545257568
Epoch: 47, Steps: 64 | Train Loss: 0.0996145 Vali Loss: 0.1521095 Test Loss: 0.1413974
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 48 cost time: 0.92185378074646
Epoch: 48, Steps: 64 | Train Loss: 0.0995519 Vali Loss: 0.1535411 Test Loss: 0.1416641
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 49 cost time: 0.915001630783081
Epoch: 49, Steps: 64 | Train Loss: 0.0994313 Vali Loss: 0.1524548 Test Loss: 0.1419495
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 50 cost time: 0.9106175899505615
Epoch: 50, Steps: 64 | Train Loss: 0.0994730 Vali Loss: 0.1528410 Test Loss: 0.1416126
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 51 cost time: 0.9416344165802002
Epoch: 51, Steps: 64 | Train Loss: 0.0989328 Vali Loss: 0.1542690 Test Loss: 0.1417412
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 52 cost time: 0.9594390392303467
Epoch: 52, Steps: 64 | Train Loss: 0.0995160 Vali Loss: 0.1498818 Test Loss: 0.1412851
Validation loss decreased (0.150726 --> 0.149882).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 53 cost time: 0.9443800449371338
Epoch: 53, Steps: 64 | Train Loss: 0.0997592 Vali Loss: 0.1528083 Test Loss: 0.1416558
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 54 cost time: 0.967888593673706
Epoch: 54, Steps: 64 | Train Loss: 0.0994741 Vali Loss: 0.1510180 Test Loss: 0.1412017
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 55 cost time: 0.9565606117248535
Epoch: 55, Steps: 64 | Train Loss: 0.0993226 Vali Loss: 0.1511740 Test Loss: 0.1423233
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 56 cost time: 0.935481071472168
Epoch: 56, Steps: 64 | Train Loss: 0.0996365 Vali Loss: 0.1507472 Test Loss: 0.1417748
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 57 cost time: 0.9387259483337402
Epoch: 57, Steps: 64 | Train Loss: 0.0994511 Vali Loss: 0.1519370 Test Loss: 0.1420467
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 58 cost time: 0.9374725818634033
Epoch: 58, Steps: 64 | Train Loss: 0.0992489 Vali Loss: 0.1494577 Test Loss: 0.1415847
Validation loss decreased (0.149882 --> 0.149458).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 59 cost time: 0.9317095279693604
Epoch: 59, Steps: 64 | Train Loss: 0.0988063 Vali Loss: 0.1524365 Test Loss: 0.1414574
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018125534057617188 GB
GPU已分配内存的峰值：0.05060386657714844 GB
Epoch: 60 cost time: 0.9514045715332031
Epoch: 60, Steps: 64 | Train Loss: 0.0992056 Vali Loss: 0.1526493 Test Loss: 0.1423942
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14158472418785095, mae:0.2744322419166565, rse:0.20027612149715424
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05122566223144531 GB
Epoch: 1 cost time: 2.3395678997039795
Epoch: 1, Steps: 64 | Train Loss: 0.9786748 Vali Loss: 2.1467516 Test Loss: 4.1683054
Validation loss decreased (inf --> 2.146752).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 2 cost time: 0.9733576774597168
Epoch: 2, Steps: 64 | Train Loss: 0.4827702 Vali Loss: 0.4012859 Test Loss: 0.5105398
Validation loss decreased (2.146752 --> 0.401286).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 3 cost time: 0.9726641178131104
Epoch: 3, Steps: 64 | Train Loss: 0.1472181 Vali Loss: 0.2089529 Test Loss: 0.1703582
Validation loss decreased (0.401286 --> 0.208953).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 4 cost time: 0.9814014434814453
Epoch: 4, Steps: 64 | Train Loss: 0.1092641 Vali Loss: 0.1826995 Test Loss: 0.1498005
Validation loss decreased (0.208953 --> 0.182699).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 5 cost time: 0.9658553600311279
Epoch: 5, Steps: 64 | Train Loss: 0.1026098 Vali Loss: 0.1752209 Test Loss: 0.1463131
Validation loss decreased (0.182699 --> 0.175221).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 6 cost time: 0.9459259510040283
Epoch: 6, Steps: 64 | Train Loss: 0.0987286 Vali Loss: 0.1706349 Test Loss: 0.1437724
Validation loss decreased (0.175221 --> 0.170635).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 7 cost time: 0.954387903213501
Epoch: 7, Steps: 64 | Train Loss: 0.0956371 Vali Loss: 0.1669142 Test Loss: 0.1412959
Validation loss decreased (0.170635 --> 0.166914).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 8 cost time: 0.9514000415802002
Epoch: 8, Steps: 64 | Train Loss: 0.0931096 Vali Loss: 0.1631999 Test Loss: 0.1396926
Validation loss decreased (0.166914 --> 0.163200).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 9 cost time: 0.9805176258087158
Epoch: 9, Steps: 64 | Train Loss: 0.0919630 Vali Loss: 0.1616508 Test Loss: 0.1390688
Validation loss decreased (0.163200 --> 0.161651).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 10 cost time: 0.9807484149932861
Epoch: 10, Steps: 64 | Train Loss: 0.0909974 Vali Loss: 0.1602963 Test Loss: 0.1382918
Validation loss decreased (0.161651 --> 0.160296).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 11 cost time: 0.9878273010253906
Epoch: 11, Steps: 64 | Train Loss: 0.0891138 Vali Loss: 0.1580601 Test Loss: 0.1373286
Validation loss decreased (0.160296 --> 0.158060).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 12 cost time: 0.9959995746612549
Epoch: 12, Steps: 64 | Train Loss: 0.0892330 Vali Loss: 0.1595026 Test Loss: 0.1379201
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 13 cost time: 0.984999418258667
Epoch: 13, Steps: 64 | Train Loss: 0.0880723 Vali Loss: 0.1556961 Test Loss: 0.1359951
Validation loss decreased (0.158060 --> 0.155696).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 14 cost time: 0.9623739719390869
Epoch: 14, Steps: 64 | Train Loss: 0.0875563 Vali Loss: 0.1536079 Test Loss: 0.1365605
Validation loss decreased (0.155696 --> 0.153608).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 15 cost time: 0.9676437377929688
Epoch: 15, Steps: 64 | Train Loss: 0.0865417 Vali Loss: 0.1545087 Test Loss: 0.1363245
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 16 cost time: 0.9654743671417236
Epoch: 16, Steps: 64 | Train Loss: 0.0862184 Vali Loss: 0.1539801 Test Loss: 0.1349790
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 17 cost time: 0.9645020961761475
Epoch: 17, Steps: 64 | Train Loss: 0.0858147 Vali Loss: 0.1544641 Test Loss: 0.1358920
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 18 cost time: 0.9933969974517822
Epoch: 18, Steps: 64 | Train Loss: 0.0852978 Vali Loss: 0.1534661 Test Loss: 0.1354238
Validation loss decreased (0.153608 --> 0.153466).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 19 cost time: 0.9914202690124512
Epoch: 19, Steps: 64 | Train Loss: 0.0851563 Vali Loss: 0.1517873 Test Loss: 0.1343758
Validation loss decreased (0.153466 --> 0.151787).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 20 cost time: 0.9823949337005615
Epoch: 20, Steps: 64 | Train Loss: 0.0849783 Vali Loss: 0.1523305 Test Loss: 0.1350406
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 21 cost time: 0.9644467830657959
Epoch: 21, Steps: 64 | Train Loss: 0.0846582 Vali Loss: 0.1527853 Test Loss: 0.1352081
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 22 cost time: 0.9583585262298584
Epoch: 22, Steps: 64 | Train Loss: 0.0843768 Vali Loss: 0.1506983 Test Loss: 0.1349618
Validation loss decreased (0.151787 --> 0.150698).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 23 cost time: 0.9546136856079102
Epoch: 23, Steps: 64 | Train Loss: 0.0841859 Vali Loss: 0.1506094 Test Loss: 0.1343758
Validation loss decreased (0.150698 --> 0.150609).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 24 cost time: 0.9550001621246338
Epoch: 24, Steps: 64 | Train Loss: 0.0838934 Vali Loss: 0.1516057 Test Loss: 0.1344903
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 25 cost time: 0.9606368541717529
Epoch: 25, Steps: 64 | Train Loss: 0.0839093 Vali Loss: 0.1515297 Test Loss: 0.1347680
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 26 cost time: 0.9804468154907227
Epoch: 26, Steps: 64 | Train Loss: 0.0836146 Vali Loss: 0.1503544 Test Loss: 0.1343416
Validation loss decreased (0.150609 --> 0.150354).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 27 cost time: 0.9502894878387451
Epoch: 27, Steps: 64 | Train Loss: 0.0832713 Vali Loss: 0.1495261 Test Loss: 0.1347558
Validation loss decreased (0.150354 --> 0.149526).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 28 cost time: 0.9723546504974365
Epoch: 28, Steps: 64 | Train Loss: 0.0834359 Vali Loss: 0.1506046 Test Loss: 0.1343984
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 29 cost time: 0.9657833576202393
Epoch: 29, Steps: 64 | Train Loss: 0.0832693 Vali Loss: 0.1489631 Test Loss: 0.1341698
Validation loss decreased (0.149526 --> 0.148963).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 30 cost time: 0.9726030826568604
Epoch: 30, Steps: 64 | Train Loss: 0.0829517 Vali Loss: 0.1495838 Test Loss: 0.1345161
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 31 cost time: 0.9720096588134766
Epoch: 31, Steps: 64 | Train Loss: 0.0830229 Vali Loss: 0.1478859 Test Loss: 0.1332696
Validation loss decreased (0.148963 --> 0.147886).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 32 cost time: 0.9638135433197021
Epoch: 32, Steps: 64 | Train Loss: 0.0829612 Vali Loss: 0.1471958 Test Loss: 0.1342366
Validation loss decreased (0.147886 --> 0.147196).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 33 cost time: 0.9717676639556885
Epoch: 33, Steps: 64 | Train Loss: 0.0831107 Vali Loss: 0.1483760 Test Loss: 0.1339162
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 34 cost time: 0.9990007877349854
Epoch: 34, Steps: 64 | Train Loss: 0.0828091 Vali Loss: 0.1473182 Test Loss: 0.1337092
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 35 cost time: 0.9896259307861328
Epoch: 35, Steps: 64 | Train Loss: 0.0827892 Vali Loss: 0.1482649 Test Loss: 0.1335563
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 36 cost time: 0.9896442890167236
Epoch: 36, Steps: 64 | Train Loss: 0.0822969 Vali Loss: 0.1498860 Test Loss: 0.1340345
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 37 cost time: 0.9967148303985596
Epoch: 37, Steps: 64 | Train Loss: 0.0825955 Vali Loss: 0.1481827 Test Loss: 0.1339608
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 38 cost time: 0.980466365814209
Epoch: 38, Steps: 64 | Train Loss: 0.0823402 Vali Loss: 0.1479954 Test Loss: 0.1341205
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 39 cost time: 0.9812970161437988
Epoch: 39, Steps: 64 | Train Loss: 0.0822149 Vali Loss: 0.1491796 Test Loss: 0.1340395
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 40 cost time: 0.9714546203613281
Epoch: 40, Steps: 64 | Train Loss: 0.0819607 Vali Loss: 0.1477407 Test Loss: 0.1340936
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 41 cost time: 0.9514188766479492
Epoch: 41, Steps: 64 | Train Loss: 0.0822406 Vali Loss: 0.1482465 Test Loss: 0.1334343
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 42 cost time: 0.9681198596954346
Epoch: 42, Steps: 64 | Train Loss: 0.0823103 Vali Loss: 0.1474658 Test Loss: 0.1329132
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 43 cost time: 0.9708006381988525
Epoch: 43, Steps: 64 | Train Loss: 0.0825013 Vali Loss: 0.1492437 Test Loss: 0.1337162
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 44 cost time: 0.9733576774597168
Epoch: 44, Steps: 64 | Train Loss: 0.0823500 Vali Loss: 0.1479135 Test Loss: 0.1331379
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 45 cost time: 0.9700016975402832
Epoch: 45, Steps: 64 | Train Loss: 0.0823221 Vali Loss: 0.1480208 Test Loss: 0.1337532
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 46 cost time: 0.9579982757568359
Epoch: 46, Steps: 64 | Train Loss: 0.0823712 Vali Loss: 0.1484208 Test Loss: 0.1334170
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 47 cost time: 0.9406287670135498
Epoch: 47, Steps: 64 | Train Loss: 0.0825078 Vali Loss: 0.1472291 Test Loss: 0.1336120
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 48 cost time: 0.9463934898376465
Epoch: 48, Steps: 64 | Train Loss: 0.0821664 Vali Loss: 0.1487536 Test Loss: 0.1343450
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 49 cost time: 0.9563982486724854
Epoch: 49, Steps: 64 | Train Loss: 0.0818430 Vali Loss: 0.1472348 Test Loss: 0.1337090
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 50 cost time: 0.960533618927002
Epoch: 50, Steps: 64 | Train Loss: 0.0819080 Vali Loss: 0.1476672 Test Loss: 0.1334160
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 51 cost time: 0.9844107627868652
Epoch: 51, Steps: 64 | Train Loss: 0.0822355 Vali Loss: 0.1475549 Test Loss: 0.1333819
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 52 cost time: 0.9886026382446289
Epoch: 52, Steps: 64 | Train Loss: 0.0819354 Vali Loss: 0.1475682 Test Loss: 0.1336347
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 53 cost time: 0.9894020557403564
Epoch: 53, Steps: 64 | Train Loss: 0.0821619 Vali Loss: 0.1470170 Test Loss: 0.1329244
Validation loss decreased (0.147196 --> 0.147017).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 54 cost time: 0.9747645854949951
Epoch: 54, Steps: 64 | Train Loss: 0.0820217 Vali Loss: 0.1469344 Test Loss: 0.1333747
Validation loss decreased (0.147017 --> 0.146934).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 55 cost time: 0.9671216011047363
Epoch: 55, Steps: 64 | Train Loss: 0.0821740 Vali Loss: 0.1481254 Test Loss: 0.1334161
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 56 cost time: 0.9659998416900635
Epoch: 56, Steps: 64 | Train Loss: 0.0821405 Vali Loss: 0.1456249 Test Loss: 0.1338909
Validation loss decreased (0.146934 --> 0.145625).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 57 cost time: 0.9896261692047119
Epoch: 57, Steps: 64 | Train Loss: 0.0819549 Vali Loss: 0.1480945 Test Loss: 0.1341302
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 58 cost time: 0.9886326789855957
Epoch: 58, Steps: 64 | Train Loss: 0.0821805 Vali Loss: 0.1474010 Test Loss: 0.1348649
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 59 cost time: 0.986051082611084
Epoch: 59, Steps: 64 | Train Loss: 0.0821432 Vali Loss: 0.1468767 Test Loss: 0.1333893
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.052165985107421875 GB
Epoch: 60 cost time: 0.9944813251495361
Epoch: 60, Steps: 64 | Train Loss: 0.0820943 Vali Loss: 0.1450924 Test Loss: 0.1331864
Validation loss decreased (0.145625 --> 0.145092).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1331864446401596, mae:0.25783073902130127, rse:0.19424550235271454
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05234575271606445 GB
Epoch: 1 cost time: 2.3843653202056885
Epoch: 1, Steps: 64 | Train Loss: 0.7742423 Vali Loss: 1.7695078 Test Loss: 3.3857574
Validation loss decreased (inf --> 1.769508).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 2 cost time: 1.0016603469848633
Epoch: 2, Steps: 64 | Train Loss: 0.4565422 Vali Loss: 0.4523713 Test Loss: 0.6071879
Validation loss decreased (1.769508 --> 0.452371).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 3 cost time: 0.987128734588623
Epoch: 3, Steps: 64 | Train Loss: 0.1404093 Vali Loss: 0.2081354 Test Loss: 0.1678663
Validation loss decreased (0.452371 --> 0.208135).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 4 cost time: 1.004368782043457
Epoch: 4, Steps: 64 | Train Loss: 0.0993830 Vali Loss: 0.1818075 Test Loss: 0.1504907
Validation loss decreased (0.208135 --> 0.181808).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 5 cost time: 0.9763705730438232
Epoch: 5, Steps: 64 | Train Loss: 0.0939701 Vali Loss: 0.1701796 Test Loss: 0.1431867
Validation loss decreased (0.181808 --> 0.170180).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 6 cost time: 0.9774219989776611
Epoch: 6, Steps: 64 | Train Loss: 0.0897892 Vali Loss: 0.1636626 Test Loss: 0.1399119
Validation loss decreased (0.170180 --> 0.163663).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 7 cost time: 0.9670510292053223
Epoch: 7, Steps: 64 | Train Loss: 0.0876660 Vali Loss: 0.1566147 Test Loss: 0.1377544
Validation loss decreased (0.163663 --> 0.156615).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 8 cost time: 0.9703917503356934
Epoch: 8, Steps: 64 | Train Loss: 0.0862708 Vali Loss: 0.1543031 Test Loss: 0.1360760
Validation loss decreased (0.156615 --> 0.154303).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 9 cost time: 1.007408857345581
Epoch: 9, Steps: 64 | Train Loss: 0.0855016 Vali Loss: 0.1516682 Test Loss: 0.1362453
Validation loss decreased (0.154303 --> 0.151668).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 10 cost time: 1.0023963451385498
Epoch: 10, Steps: 64 | Train Loss: 0.0842375 Vali Loss: 0.1504463 Test Loss: 0.1353953
Validation loss decreased (0.151668 --> 0.150446).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 11 cost time: 1.0138370990753174
Epoch: 11, Steps: 64 | Train Loss: 0.0833556 Vali Loss: 0.1487232 Test Loss: 0.1347763
Validation loss decreased (0.150446 --> 0.148723).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 12 cost time: 1.011735439300537
Epoch: 12, Steps: 64 | Train Loss: 0.0827488 Vali Loss: 0.1471982 Test Loss: 0.1335806
Validation loss decreased (0.148723 --> 0.147198).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 13 cost time: 0.9817521572113037
Epoch: 13, Steps: 64 | Train Loss: 0.0815814 Vali Loss: 0.1456803 Test Loss: 0.1337483
Validation loss decreased (0.147198 --> 0.145680).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 14 cost time: 0.988999605178833
Epoch: 14, Steps: 64 | Train Loss: 0.0809475 Vali Loss: 0.1447985 Test Loss: 0.1324453
Validation loss decreased (0.145680 --> 0.144799).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 15 cost time: 0.990020751953125
Epoch: 15, Steps: 64 | Train Loss: 0.0800609 Vali Loss: 0.1426001 Test Loss: 0.1322093
Validation loss decreased (0.144799 --> 0.142600).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 16 cost time: 0.9606471061706543
Epoch: 16, Steps: 64 | Train Loss: 0.0797726 Vali Loss: 0.1409924 Test Loss: 0.1329862
Validation loss decreased (0.142600 --> 0.140992).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 17 cost time: 1.0114459991455078
Epoch: 17, Steps: 64 | Train Loss: 0.0794348 Vali Loss: 0.1418469 Test Loss: 0.1328792
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 18 cost time: 1.0093989372253418
Epoch: 18, Steps: 64 | Train Loss: 0.0787400 Vali Loss: 0.1410067 Test Loss: 0.1323577
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 19 cost time: 1.0138680934906006
Epoch: 19, Steps: 64 | Train Loss: 0.0785663 Vali Loss: 0.1404216 Test Loss: 0.1332343
Validation loss decreased (0.140992 --> 0.140422).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 20 cost time: 1.0098931789398193
Epoch: 20, Steps: 64 | Train Loss: 0.0780660 Vali Loss: 0.1393609 Test Loss: 0.1327262
Validation loss decreased (0.140422 --> 0.139361).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 21 cost time: 1.0027639865875244
Epoch: 21, Steps: 64 | Train Loss: 0.0779144 Vali Loss: 0.1398172 Test Loss: 0.1325630
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 22 cost time: 0.9923901557922363
Epoch: 22, Steps: 64 | Train Loss: 0.0775232 Vali Loss: 0.1405454 Test Loss: 0.1321692
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 23 cost time: 0.9564080238342285
Epoch: 23, Steps: 64 | Train Loss: 0.0771727 Vali Loss: 0.1392298 Test Loss: 0.1322834
Validation loss decreased (0.139361 --> 0.139230).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 24 cost time: 0.9634599685668945
Epoch: 24, Steps: 64 | Train Loss: 0.0774335 Vali Loss: 0.1395790 Test Loss: 0.1336877
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 25 cost time: 0.9738514423370361
Epoch: 25, Steps: 64 | Train Loss: 0.0769385 Vali Loss: 0.1400871 Test Loss: 0.1328620
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 26 cost time: 0.9817237854003906
Epoch: 26, Steps: 64 | Train Loss: 0.0770032 Vali Loss: 0.1397136 Test Loss: 0.1328160
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 27 cost time: 0.979449987411499
Epoch: 27, Steps: 64 | Train Loss: 0.0767476 Vali Loss: 0.1375949 Test Loss: 0.1323335
Validation loss decreased (0.139230 --> 0.137595).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 28 cost time: 0.9922468662261963
Epoch: 28, Steps: 64 | Train Loss: 0.0766069 Vali Loss: 0.1383892 Test Loss: 0.1326352
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 29 cost time: 0.9876382350921631
Epoch: 29, Steps: 64 | Train Loss: 0.0766603 Vali Loss: 0.1379334 Test Loss: 0.1330313
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 30 cost time: 0.9913740158081055
Epoch: 30, Steps: 64 | Train Loss: 0.0765343 Vali Loss: 0.1370243 Test Loss: 0.1330537
Validation loss decreased (0.137595 --> 0.137024).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 31 cost time: 0.995736837387085
Epoch: 31, Steps: 64 | Train Loss: 0.0766265 Vali Loss: 0.1356201 Test Loss: 0.1320656
Validation loss decreased (0.137024 --> 0.135620).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 32 cost time: 1.0013618469238281
Epoch: 32, Steps: 64 | Train Loss: 0.0761853 Vali Loss: 0.1377808 Test Loss: 0.1324318
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 33 cost time: 1.0023612976074219
Epoch: 33, Steps: 64 | Train Loss: 0.0763702 Vali Loss: 0.1376232 Test Loss: 0.1329025
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 34 cost time: 1.0223863124847412
Epoch: 34, Steps: 64 | Train Loss: 0.0764653 Vali Loss: 0.1381944 Test Loss: 0.1327300
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 35 cost time: 1.0224483013153076
Epoch: 35, Steps: 64 | Train Loss: 0.0760995 Vali Loss: 0.1373395 Test Loss: 0.1322851
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 36 cost time: 1.0167694091796875
Epoch: 36, Steps: 64 | Train Loss: 0.0760227 Vali Loss: 0.1382356 Test Loss: 0.1335433
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 37 cost time: 1.0054023265838623
Epoch: 37, Steps: 64 | Train Loss: 0.0764360 Vali Loss: 0.1379339 Test Loss: 0.1329857
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 38 cost time: 1.0053985118865967
Epoch: 38, Steps: 64 | Train Loss: 0.0760224 Vali Loss: 0.1374809 Test Loss: 0.1328812
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 39 cost time: 0.9551594257354736
Epoch: 39, Steps: 64 | Train Loss: 0.0761541 Vali Loss: 0.1365052 Test Loss: 0.1319178
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 40 cost time: 0.9549999237060547
Epoch: 40, Steps: 64 | Train Loss: 0.0760498 Vali Loss: 0.1350046 Test Loss: 0.1314666
Validation loss decreased (0.135620 --> 0.135005).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 41 cost time: 0.9656414985656738
Epoch: 41, Steps: 64 | Train Loss: 0.0759049 Vali Loss: 0.1361252 Test Loss: 0.1328011
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 42 cost time: 0.9826211929321289
Epoch: 42, Steps: 64 | Train Loss: 0.0760940 Vali Loss: 0.1361773 Test Loss: 0.1322150
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 43 cost time: 0.9817285537719727
Epoch: 43, Steps: 64 | Train Loss: 0.0759035 Vali Loss: 0.1373420 Test Loss: 0.1331384
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 44 cost time: 1.0155069828033447
Epoch: 44, Steps: 64 | Train Loss: 0.0756876 Vali Loss: 0.1362035 Test Loss: 0.1318979
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 45 cost time: 0.9913790225982666
Epoch: 45, Steps: 64 | Train Loss: 0.0756898 Vali Loss: 0.1371135 Test Loss: 0.1315620
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 46 cost time: 0.9634435176849365
Epoch: 46, Steps: 64 | Train Loss: 0.0757938 Vali Loss: 0.1376942 Test Loss: 0.1328144
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 47 cost time: 0.9583830833435059
Epoch: 47, Steps: 64 | Train Loss: 0.0759215 Vali Loss: 0.1378908 Test Loss: 0.1329819
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 48 cost time: 1.0013554096221924
Epoch: 48, Steps: 64 | Train Loss: 0.0758803 Vali Loss: 0.1357030 Test Loss: 0.1330297
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 49 cost time: 0.983515739440918
Epoch: 49, Steps: 64 | Train Loss: 0.0758086 Vali Loss: 0.1356229 Test Loss: 0.1327304
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 50 cost time: 1.0097501277923584
Epoch: 50, Steps: 64 | Train Loss: 0.0754833 Vali Loss: 0.1368960 Test Loss: 0.1320818
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 51 cost time: 1.019195795059204
Epoch: 51, Steps: 64 | Train Loss: 0.0757913 Vali Loss: 0.1353576 Test Loss: 0.1317755
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 52 cost time: 1.011735439300537
Epoch: 52, Steps: 64 | Train Loss: 0.0759690 Vali Loss: 0.1368883 Test Loss: 0.1322709
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 53 cost time: 1.006998062133789
Epoch: 53, Steps: 64 | Train Loss: 0.0756025 Vali Loss: 0.1368101 Test Loss: 0.1329167
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 54 cost time: 1.0106453895568848
Epoch: 54, Steps: 64 | Train Loss: 0.0754995 Vali Loss: 0.1379330 Test Loss: 0.1325670
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 55 cost time: 0.987032413482666
Epoch: 55, Steps: 64 | Train Loss: 0.0756056 Vali Loss: 0.1363854 Test Loss: 0.1324419
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 56 cost time: 0.9823727607727051
Epoch: 56, Steps: 64 | Train Loss: 0.0757864 Vali Loss: 0.1370938 Test Loss: 0.1323991
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 57 cost time: 0.9733774662017822
Epoch: 57, Steps: 64 | Train Loss: 0.0755987 Vali Loss: 0.1371456 Test Loss: 0.1327397
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 58 cost time: 1.0013434886932373
Epoch: 58, Steps: 64 | Train Loss: 0.0758082 Vali Loss: 0.1357541 Test Loss: 0.1328590
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 59 cost time: 0.9884860515594482
Epoch: 59, Steps: 64 | Train Loss: 0.0758732 Vali Loss: 0.1367859 Test Loss: 0.1329461
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018323898315429688 GB
GPU已分配内存的峰值：0.05368232727050781 GB
Epoch: 60 cost time: 0.985581636428833
Epoch: 60, Steps: 64 | Train Loss: 0.0756034 Vali Loss: 0.1353532 Test Loss: 0.1316399
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1314665824174881, mae:0.26012808084487915, rse:0.19298726320266724
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.057065486907958984 GB
Epoch: 1 cost time: 2.288658857345581
Epoch: 1, Steps: 64 | Train Loss: 0.8053811 Vali Loss: 1.6098768 Test Loss: 2.7864428
Validation loss decreased (inf --> 1.609877).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 2 cost time: 0.9104444980621338
Epoch: 2, Steps: 64 | Train Loss: 0.4508181 Vali Loss: 0.3821224 Test Loss: 0.4204649
Validation loss decreased (1.609877 --> 0.382122).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 3 cost time: 0.9013824462890625
Epoch: 3, Steps: 64 | Train Loss: 0.1988705 Vali Loss: 0.2388583 Test Loss: 0.1936349
Validation loss decreased (0.382122 --> 0.238858).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 4 cost time: 0.9131770133972168
Epoch: 4, Steps: 64 | Train Loss: 0.1556477 Vali Loss: 0.2068716 Test Loss: 0.1706614
Validation loss decreased (0.238858 --> 0.206872).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 5 cost time: 0.8940019607543945
Epoch: 5, Steps: 64 | Train Loss: 0.1403146 Vali Loss: 0.1913459 Test Loss: 0.1615533
Validation loss decreased (0.206872 --> 0.191346).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 6 cost time: 0.8786365985870361
Epoch: 6, Steps: 64 | Train Loss: 0.1317573 Vali Loss: 0.1876360 Test Loss: 0.1614770
Validation loss decreased (0.191346 --> 0.187636).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 7 cost time: 0.8956472873687744
Epoch: 7, Steps: 64 | Train Loss: 0.1257042 Vali Loss: 0.1806204 Test Loss: 0.1566108
Validation loss decreased (0.187636 --> 0.180620).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 8 cost time: 0.8894472122192383
Epoch: 8, Steps: 64 | Train Loss: 0.1211297 Vali Loss: 0.1750807 Test Loss: 0.1538388
Validation loss decreased (0.180620 --> 0.175081).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 9 cost time: 0.9175214767456055
Epoch: 9, Steps: 64 | Train Loss: 0.1179758 Vali Loss: 0.1742955 Test Loss: 0.1546882
Validation loss decreased (0.175081 --> 0.174295).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 10 cost time: 0.9214255809783936
Epoch: 10, Steps: 64 | Train Loss: 0.1140592 Vali Loss: 0.1715794 Test Loss: 0.1506479
Validation loss decreased (0.174295 --> 0.171579).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 11 cost time: 0.9268894195556641
Epoch: 11, Steps: 64 | Train Loss: 0.1120213 Vali Loss: 0.1685817 Test Loss: 0.1499067
Validation loss decreased (0.171579 --> 0.168582).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 12 cost time: 0.9332687854766846
Epoch: 12, Steps: 64 | Train Loss: 0.1103218 Vali Loss: 0.1662243 Test Loss: 0.1482689
Validation loss decreased (0.168582 --> 0.166224).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 13 cost time: 0.9412684440612793
Epoch: 13, Steps: 64 | Train Loss: 0.1090252 Vali Loss: 0.1664167 Test Loss: 0.1488989
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 14 cost time: 0.9226362705230713
Epoch: 14, Steps: 64 | Train Loss: 0.1079526 Vali Loss: 0.1662441 Test Loss: 0.1491933
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 15 cost time: 0.917341947555542
Epoch: 15, Steps: 64 | Train Loss: 0.1064128 Vali Loss: 0.1628135 Test Loss: 0.1474867
Validation loss decreased (0.166224 --> 0.162814).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 16 cost time: 0.9194052219390869
Epoch: 16, Steps: 64 | Train Loss: 0.1052239 Vali Loss: 0.1622834 Test Loss: 0.1460555
Validation loss decreased (0.162814 --> 0.162283).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 17 cost time: 0.9180178642272949
Epoch: 17, Steps: 64 | Train Loss: 0.1037038 Vali Loss: 0.1609736 Test Loss: 0.1467485
Validation loss decreased (0.162283 --> 0.160974).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 18 cost time: 0.9227442741394043
Epoch: 18, Steps: 64 | Train Loss: 0.1032741 Vali Loss: 0.1582088 Test Loss: 0.1449411
Validation loss decreased (0.160974 --> 0.158209).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 19 cost time: 0.9230000972747803
Epoch: 19, Steps: 64 | Train Loss: 0.1022166 Vali Loss: 0.1592161 Test Loss: 0.1462190
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 20 cost time: 0.9216110706329346
Epoch: 20, Steps: 64 | Train Loss: 0.1021100 Vali Loss: 0.1588598 Test Loss: 0.1462979
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 21 cost time: 0.9272053241729736
Epoch: 21, Steps: 64 | Train Loss: 0.1019013 Vali Loss: 0.1575858 Test Loss: 0.1447982
Validation loss decreased (0.158209 --> 0.157586).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 22 cost time: 0.9142448902130127
Epoch: 22, Steps: 64 | Train Loss: 0.1012053 Vali Loss: 0.1580316 Test Loss: 0.1465599
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 23 cost time: 0.9013721942901611
Epoch: 23, Steps: 64 | Train Loss: 0.1005693 Vali Loss: 0.1563247 Test Loss: 0.1445415
Validation loss decreased (0.157586 --> 0.156325).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 24 cost time: 0.8984582424163818
Epoch: 24, Steps: 64 | Train Loss: 0.1000895 Vali Loss: 0.1570670 Test Loss: 0.1447191
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 25 cost time: 0.9053745269775391
Epoch: 25, Steps: 64 | Train Loss: 0.1002564 Vali Loss: 0.1591135 Test Loss: 0.1455019
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 26 cost time: 0.8999996185302734
Epoch: 26, Steps: 64 | Train Loss: 0.0993319 Vali Loss: 0.1549486 Test Loss: 0.1437758
Validation loss decreased (0.156325 --> 0.154949).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 27 cost time: 0.9046387672424316
Epoch: 27, Steps: 64 | Train Loss: 0.0992551 Vali Loss: 0.1563857 Test Loss: 0.1439664
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 28 cost time: 0.9153883457183838
Epoch: 28, Steps: 64 | Train Loss: 0.0988927 Vali Loss: 0.1553233 Test Loss: 0.1448684
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 29 cost time: 0.9234018325805664
Epoch: 29, Steps: 64 | Train Loss: 0.0987754 Vali Loss: 0.1572506 Test Loss: 0.1441977
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 30 cost time: 0.9129858016967773
Epoch: 30, Steps: 64 | Train Loss: 0.0985224 Vali Loss: 0.1546032 Test Loss: 0.1428852
Validation loss decreased (0.154949 --> 0.154603).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 31 cost time: 0.932427167892456
Epoch: 31, Steps: 64 | Train Loss: 0.0987244 Vali Loss: 0.1565958 Test Loss: 0.1450575
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 32 cost time: 0.914762020111084
Epoch: 32, Steps: 64 | Train Loss: 0.0984704 Vali Loss: 0.1566277 Test Loss: 0.1431127
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 33 cost time: 0.9059996604919434
Epoch: 33, Steps: 64 | Train Loss: 0.0978611 Vali Loss: 0.1549467 Test Loss: 0.1440914
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 34 cost time: 0.911278486251831
Epoch: 34, Steps: 64 | Train Loss: 0.0977825 Vali Loss: 0.1577518 Test Loss: 0.1461646
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 35 cost time: 0.9123802185058594
Epoch: 35, Steps: 64 | Train Loss: 0.0979939 Vali Loss: 0.1572538 Test Loss: 0.1448204
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 36 cost time: 0.9374094009399414
Epoch: 36, Steps: 64 | Train Loss: 0.0978544 Vali Loss: 0.1562465 Test Loss: 0.1437002
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 37 cost time: 0.9304924011230469
Epoch: 37, Steps: 64 | Train Loss: 0.0974369 Vali Loss: 0.1567279 Test Loss: 0.1442095
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 38 cost time: 0.9334349632263184
Epoch: 38, Steps: 64 | Train Loss: 0.0974713 Vali Loss: 0.1557688 Test Loss: 0.1440412
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 39 cost time: 0.9437215328216553
Epoch: 39, Steps: 64 | Train Loss: 0.0979346 Vali Loss: 0.1544161 Test Loss: 0.1437445
Validation loss decreased (0.154603 --> 0.154416).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 40 cost time: 0.931999921798706
Epoch: 40, Steps: 64 | Train Loss: 0.0973807 Vali Loss: 0.1542609 Test Loss: 0.1431118
Validation loss decreased (0.154416 --> 0.154261).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 41 cost time: 0.9106252193450928
Epoch: 41, Steps: 64 | Train Loss: 0.0972146 Vali Loss: 0.1539961 Test Loss: 0.1426993
Validation loss decreased (0.154261 --> 0.153996).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 42 cost time: 0.8998396396636963
Epoch: 42, Steps: 64 | Train Loss: 0.0967494 Vali Loss: 0.1538714 Test Loss: 0.1432391
Validation loss decreased (0.153996 --> 0.153871).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 43 cost time: 0.8994410037994385
Epoch: 43, Steps: 64 | Train Loss: 0.0966833 Vali Loss: 0.1554481 Test Loss: 0.1443238
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 44 cost time: 0.8973603248596191
Epoch: 44, Steps: 64 | Train Loss: 0.0969228 Vali Loss: 0.1546052 Test Loss: 0.1434201
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 45 cost time: 0.9067397117614746
Epoch: 45, Steps: 64 | Train Loss: 0.0972771 Vali Loss: 0.1545155 Test Loss: 0.1440630
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 46 cost time: 0.9290001392364502
Epoch: 46, Steps: 64 | Train Loss: 0.0971315 Vali Loss: 0.1539034 Test Loss: 0.1439785
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 47 cost time: 0.9130380153656006
Epoch: 47, Steps: 64 | Train Loss: 0.0967784 Vali Loss: 0.1535383 Test Loss: 0.1430677
Validation loss decreased (0.153871 --> 0.153538).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 48 cost time: 0.9046666622161865
Epoch: 48, Steps: 64 | Train Loss: 0.0971175 Vali Loss: 0.1555713 Test Loss: 0.1453581
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 49 cost time: 0.9088358879089355
Epoch: 49, Steps: 64 | Train Loss: 0.0968572 Vali Loss: 0.1550516 Test Loss: 0.1449155
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 50 cost time: 0.9154119491577148
Epoch: 50, Steps: 64 | Train Loss: 0.0968601 Vali Loss: 0.1534176 Test Loss: 0.1425404
Validation loss decreased (0.153538 --> 0.153418).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 51 cost time: 0.9064035415649414
Epoch: 51, Steps: 64 | Train Loss: 0.0967886 Vali Loss: 0.1545861 Test Loss: 0.1434343
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 52 cost time: 0.9150934219360352
Epoch: 52, Steps: 64 | Train Loss: 0.0969213 Vali Loss: 0.1552457 Test Loss: 0.1424524
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 53 cost time: 0.9259998798370361
Epoch: 53, Steps: 64 | Train Loss: 0.0968300 Vali Loss: 0.1526935 Test Loss: 0.1429373
Validation loss decreased (0.153418 --> 0.152694).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 54 cost time: 0.9346301555633545
Epoch: 54, Steps: 64 | Train Loss: 0.0968238 Vali Loss: 0.1537814 Test Loss: 0.1431789
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 55 cost time: 0.932429313659668
Epoch: 55, Steps: 64 | Train Loss: 0.0969743 Vali Loss: 0.1553134 Test Loss: 0.1437982
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 56 cost time: 0.9374077320098877
Epoch: 56, Steps: 64 | Train Loss: 0.0964503 Vali Loss: 0.1564364 Test Loss: 0.1441035
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 57 cost time: 0.9354102611541748
Epoch: 57, Steps: 64 | Train Loss: 0.0966054 Vali Loss: 0.1558246 Test Loss: 0.1455712
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 58 cost time: 0.9223620891571045
Epoch: 58, Steps: 64 | Train Loss: 0.0970534 Vali Loss: 0.1555231 Test Loss: 0.1437305
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 59 cost time: 0.9087400436401367
Epoch: 59, Steps: 64 | Train Loss: 0.0966998 Vali Loss: 0.1533852 Test Loss: 0.1427714
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018465042114257812 GB
GPU已分配内存的峰值：0.058777809143066406 GB
Epoch: 60 cost time: 0.9167916774749756
Epoch: 60, Steps: 64 | Train Loss: 0.0965160 Vali Loss: 0.1544819 Test Loss: 0.1441619
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14293736219406128, mae:0.2705904543399811, rse:0.2012305110692978
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.05849742889404297 GB
Epoch: 1 cost time: 2.3304996490478516
Epoch: 1, Steps: 64 | Train Loss: 0.9035441 Vali Loss: 1.9729993 Test Loss: 3.7456403
Validation loss decreased (inf --> 1.972999).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 2 cost time: 0.9469997882843018
Epoch: 2, Steps: 64 | Train Loss: 0.5405301 Vali Loss: 0.5291055 Test Loss: 0.7904802
Validation loss decreased (1.972999 --> 0.529105).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 3 cost time: 0.9636416435241699
Epoch: 3, Steps: 64 | Train Loss: 0.1794865 Vali Loss: 0.2044459 Test Loss: 0.1786275
Validation loss decreased (0.529105 --> 0.204446).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 4 cost time: 0.9415979385375977
Epoch: 4, Steps: 64 | Train Loss: 0.1180018 Vali Loss: 0.1779203 Test Loss: 0.1574776
Validation loss decreased (0.204446 --> 0.177920).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 5 cost time: 0.9297165870666504
Epoch: 5, Steps: 64 | Train Loss: 0.1087681 Vali Loss: 0.1711486 Test Loss: 0.1529911
Validation loss decreased (0.177920 --> 0.171149).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 6 cost time: 0.9370110034942627
Epoch: 6, Steps: 64 | Train Loss: 0.1033640 Vali Loss: 0.1655176 Test Loss: 0.1498562
Validation loss decreased (0.171149 --> 0.165518).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 7 cost time: 0.937760591506958
Epoch: 7, Steps: 64 | Train Loss: 0.0997728 Vali Loss: 0.1636701 Test Loss: 0.1479573
Validation loss decreased (0.165518 --> 0.163670).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 8 cost time: 0.9313721656799316
Epoch: 8, Steps: 64 | Train Loss: 0.0968649 Vali Loss: 0.1605958 Test Loss: 0.1460263
Validation loss decreased (0.163670 --> 0.160596).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 9 cost time: 0.9324400424957275
Epoch: 9, Steps: 64 | Train Loss: 0.0950899 Vali Loss: 0.1594540 Test Loss: 0.1465405
Validation loss decreased (0.160596 --> 0.159454).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 10 cost time: 0.9599993228912354
Epoch: 10, Steps: 64 | Train Loss: 0.0932542 Vali Loss: 0.1577993 Test Loss: 0.1464547
Validation loss decreased (0.159454 --> 0.157799).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 11 cost time: 0.9630007743835449
Epoch: 11, Steps: 64 | Train Loss: 0.0916977 Vali Loss: 0.1571450 Test Loss: 0.1462773
Validation loss decreased (0.157799 --> 0.157145).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 12 cost time: 0.9656481742858887
Epoch: 12, Steps: 64 | Train Loss: 0.0910010 Vali Loss: 0.1550192 Test Loss: 0.1459445
Validation loss decreased (0.157145 --> 0.155019).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 13 cost time: 0.9638595581054688
Epoch: 13, Steps: 64 | Train Loss: 0.0897368 Vali Loss: 0.1549748 Test Loss: 0.1456660
Validation loss decreased (0.155019 --> 0.154975).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 14 cost time: 0.9475259780883789
Epoch: 14, Steps: 64 | Train Loss: 0.0895384 Vali Loss: 0.1549940 Test Loss: 0.1458935
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 15 cost time: 0.9473903179168701
Epoch: 15, Steps: 64 | Train Loss: 0.0885572 Vali Loss: 0.1538596 Test Loss: 0.1456165
Validation loss decreased (0.154975 --> 0.153860).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 16 cost time: 0.9453918933868408
Epoch: 16, Steps: 64 | Train Loss: 0.0883080 Vali Loss: 0.1533144 Test Loss: 0.1453520
Validation loss decreased (0.153860 --> 0.153314).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 17 cost time: 0.9531750679016113
Epoch: 17, Steps: 64 | Train Loss: 0.0877897 Vali Loss: 0.1542630 Test Loss: 0.1460530
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 18 cost time: 0.9667811393737793
Epoch: 18, Steps: 64 | Train Loss: 0.0873685 Vali Loss: 0.1513037 Test Loss: 0.1451308
Validation loss decreased (0.153314 --> 0.151304).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 19 cost time: 0.9560022354125977
Epoch: 19, Steps: 64 | Train Loss: 0.0871595 Vali Loss: 0.1532905 Test Loss: 0.1454062
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 20 cost time: 0.9469993114471436
Epoch: 20, Steps: 64 | Train Loss: 0.0861868 Vali Loss: 0.1530732 Test Loss: 0.1451287
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 21 cost time: 0.9487752914428711
Epoch: 21, Steps: 64 | Train Loss: 0.0861699 Vali Loss: 0.1518072 Test Loss: 0.1454008
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 22 cost time: 0.9352297782897949
Epoch: 22, Steps: 64 | Train Loss: 0.0860167 Vali Loss: 0.1497095 Test Loss: 0.1451462
Validation loss decreased (0.151304 --> 0.149710).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 23 cost time: 0.9274165630340576
Epoch: 23, Steps: 64 | Train Loss: 0.0853806 Vali Loss: 0.1496802 Test Loss: 0.1454992
Validation loss decreased (0.149710 --> 0.149680).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 24 cost time: 0.9333994388580322
Epoch: 24, Steps: 64 | Train Loss: 0.0853167 Vali Loss: 0.1509073 Test Loss: 0.1452344
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 25 cost time: 0.9324517250061035
Epoch: 25, Steps: 64 | Train Loss: 0.0856272 Vali Loss: 0.1493519 Test Loss: 0.1457390
Validation loss decreased (0.149680 --> 0.149352).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 26 cost time: 0.9382691383361816
Epoch: 26, Steps: 64 | Train Loss: 0.0845589 Vali Loss: 0.1487583 Test Loss: 0.1451610
Validation loss decreased (0.149352 --> 0.148758).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 27 cost time: 0.9429993629455566
Epoch: 27, Steps: 64 | Train Loss: 0.0846401 Vali Loss: 0.1515981 Test Loss: 0.1462551
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 28 cost time: 0.9136455059051514
Epoch: 28, Steps: 64 | Train Loss: 0.0845201 Vali Loss: 0.1500484 Test Loss: 0.1455078
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 29 cost time: 0.9436113834381104
Epoch: 29, Steps: 64 | Train Loss: 0.0844200 Vali Loss: 0.1485763 Test Loss: 0.1455953
Validation loss decreased (0.148758 --> 0.148576).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 30 cost time: 0.9633009433746338
Epoch: 30, Steps: 64 | Train Loss: 0.0839575 Vali Loss: 0.1503958 Test Loss: 0.1451754
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 31 cost time: 0.9503979682922363
Epoch: 31, Steps: 64 | Train Loss: 0.0844568 Vali Loss: 0.1506949 Test Loss: 0.1458686
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 32 cost time: 0.9512131214141846
Epoch: 32, Steps: 64 | Train Loss: 0.0839013 Vali Loss: 0.1490710 Test Loss: 0.1451962
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 33 cost time: 0.9524223804473877
Epoch: 33, Steps: 64 | Train Loss: 0.0837086 Vali Loss: 0.1495699 Test Loss: 0.1455851
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 34 cost time: 0.9527852535247803
Epoch: 34, Steps: 64 | Train Loss: 0.0838485 Vali Loss: 0.1503676 Test Loss: 0.1459630
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 35 cost time: 0.9504163265228271
Epoch: 35, Steps: 64 | Train Loss: 0.0838627 Vali Loss: 0.1499356 Test Loss: 0.1452699
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 36 cost time: 0.9656474590301514
Epoch: 36, Steps: 64 | Train Loss: 0.0837095 Vali Loss: 0.1500985 Test Loss: 0.1454440
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 37 cost time: 0.9676201343536377
Epoch: 37, Steps: 64 | Train Loss: 0.0837052 Vali Loss: 0.1501399 Test Loss: 0.1453514
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 38 cost time: 0.9574501514434814
Epoch: 38, Steps: 64 | Train Loss: 0.0838861 Vali Loss: 0.1483739 Test Loss: 0.1455944
Validation loss decreased (0.148576 --> 0.148374).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 39 cost time: 0.9490964412689209
Epoch: 39, Steps: 64 | Train Loss: 0.0835357 Vali Loss: 0.1499810 Test Loss: 0.1452472
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 40 cost time: 0.9214046001434326
Epoch: 40, Steps: 64 | Train Loss: 0.0837270 Vali Loss: 0.1487309 Test Loss: 0.1447056
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 41 cost time: 0.9345526695251465
Epoch: 41, Steps: 64 | Train Loss: 0.0837893 Vali Loss: 0.1502076 Test Loss: 0.1447933
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 42 cost time: 0.929063081741333
Epoch: 42, Steps: 64 | Train Loss: 0.0836648 Vali Loss: 0.1476718 Test Loss: 0.1452362
Validation loss decreased (0.148374 --> 0.147672).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 43 cost time: 0.9300000667572021
Epoch: 43, Steps: 64 | Train Loss: 0.0835857 Vali Loss: 0.1478559 Test Loss: 0.1450348
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 44 cost time: 0.952643632888794
Epoch: 44, Steps: 64 | Train Loss: 0.0832089 Vali Loss: 0.1483980 Test Loss: 0.1447717
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 45 cost time: 0.9406287670135498
Epoch: 45, Steps: 64 | Train Loss: 0.0835089 Vali Loss: 0.1487152 Test Loss: 0.1457035
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 46 cost time: 0.9455075263977051
Epoch: 46, Steps: 64 | Train Loss: 0.0837209 Vali Loss: 0.1495699 Test Loss: 0.1458575
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 47 cost time: 0.9393734931945801
Epoch: 47, Steps: 64 | Train Loss: 0.0830795 Vali Loss: 0.1483130 Test Loss: 0.1463319
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 48 cost time: 0.9423916339874268
Epoch: 48, Steps: 64 | Train Loss: 0.0831516 Vali Loss: 0.1494510 Test Loss: 0.1445409
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 49 cost time: 0.9494211673736572
Epoch: 49, Steps: 64 | Train Loss: 0.0832032 Vali Loss: 0.1502134 Test Loss: 0.1459590
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 50 cost time: 0.9517576694488525
Epoch: 50, Steps: 64 | Train Loss: 0.0833381 Vali Loss: 0.1493959 Test Loss: 0.1463067
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 51 cost time: 0.9491467475891113
Epoch: 51, Steps: 64 | Train Loss: 0.0828930 Vali Loss: 0.1485778 Test Loss: 0.1444107
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 52 cost time: 0.9533398151397705
Epoch: 52, Steps: 64 | Train Loss: 0.0832014 Vali Loss: 0.1487790 Test Loss: 0.1466203
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 53 cost time: 0.9556164741516113
Epoch: 53, Steps: 64 | Train Loss: 0.0826074 Vali Loss: 0.1479027 Test Loss: 0.1451868
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 54 cost time: 0.9624226093292236
Epoch: 54, Steps: 64 | Train Loss: 0.0833685 Vali Loss: 0.1514942 Test Loss: 0.1460208
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 55 cost time: 0.9597303867340088
Epoch: 55, Steps: 64 | Train Loss: 0.0833876 Vali Loss: 0.1487769 Test Loss: 0.1457166
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 56 cost time: 0.9610409736633301
Epoch: 56, Steps: 64 | Train Loss: 0.0831684 Vali Loss: 0.1479013 Test Loss: 0.1454491
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 57 cost time: 0.9403548240661621
Epoch: 57, Steps: 64 | Train Loss: 0.0834292 Vali Loss: 0.1476684 Test Loss: 0.1455850
Validation loss decreased (0.147672 --> 0.147668).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 58 cost time: 0.950291633605957
Epoch: 58, Steps: 64 | Train Loss: 0.0832791 Vali Loss: 0.1492289 Test Loss: 0.1450708
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 59 cost time: 0.9305837154388428
Epoch: 59, Steps: 64 | Train Loss: 0.0831155 Vali Loss: 0.1492497 Test Loss: 0.1450979
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018594741821289062 GB
GPU已分配内存的峰值：0.060339927673339844 GB
Epoch: 60 cost time: 0.9240014553070068
Epoch: 60, Steps: 64 | Train Loss: 0.0832579 Vali Loss: 0.1491647 Test Loss: 0.1464955
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1455850452184677, mae:0.27940675616264343, rse:0.20308570563793182
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.05961751937866211 GB
Epoch: 1 cost time: 2.3574249744415283
Epoch: 1, Steps: 64 | Train Loss: 0.8860358 Vali Loss: 2.0226779 Test Loss: 3.9024880
Validation loss decreased (inf --> 2.022678).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 2 cost time: 0.9596259593963623
Epoch: 2, Steps: 64 | Train Loss: 0.5746767 Vali Loss: 0.6772109 Test Loss: 1.0266720
Validation loss decreased (2.022678 --> 0.677211).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 3 cost time: 0.9576337337493896
Epoch: 3, Steps: 64 | Train Loss: 0.1836903 Vali Loss: 0.2124575 Test Loss: 0.1794278
Validation loss decreased (0.677211 --> 0.212457).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 4 cost time: 0.9826474189758301
Epoch: 4, Steps: 64 | Train Loss: 0.1097528 Vali Loss: 0.1848994 Test Loss: 0.1659428
Validation loss decreased (0.212457 --> 0.184899).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 5 cost time: 0.9338586330413818
Epoch: 5, Steps: 64 | Train Loss: 0.1006481 Vali Loss: 0.1710392 Test Loss: 0.1526636
Validation loss decreased (0.184899 --> 0.171039).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 6 cost time: 0.9404022693634033
Epoch: 6, Steps: 64 | Train Loss: 0.0966898 Vali Loss: 0.1666840 Test Loss: 0.1507441
Validation loss decreased (0.171039 --> 0.166684).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 7 cost time: 0.9354844093322754
Epoch: 7, Steps: 64 | Train Loss: 0.0934871 Vali Loss: 0.1624163 Test Loss: 0.1480450
Validation loss decreased (0.166684 --> 0.162416).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 8 cost time: 0.9473934173583984
Epoch: 8, Steps: 64 | Train Loss: 0.0911443 Vali Loss: 0.1585688 Test Loss: 0.1464700
Validation loss decreased (0.162416 --> 0.158569).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 9 cost time: 0.9524269104003906
Epoch: 9, Steps: 64 | Train Loss: 0.0900809 Vali Loss: 0.1568338 Test Loss: 0.1461549
Validation loss decreased (0.158569 --> 0.156834).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 10 cost time: 0.9887673854827881
Epoch: 10, Steps: 64 | Train Loss: 0.0887336 Vali Loss: 0.1546711 Test Loss: 0.1453176
Validation loss decreased (0.156834 --> 0.154671).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 11 cost time: 0.9967272281646729
Epoch: 11, Steps: 64 | Train Loss: 0.0874908 Vali Loss: 0.1555922 Test Loss: 0.1452921
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 12 cost time: 0.9849998950958252
Epoch: 12, Steps: 64 | Train Loss: 0.0865585 Vali Loss: 0.1517928 Test Loss: 0.1447829
Validation loss decreased (0.154671 --> 0.151793).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 13 cost time: 0.9706358909606934
Epoch: 13, Steps: 64 | Train Loss: 0.0857870 Vali Loss: 0.1533118 Test Loss: 0.1453846
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 14 cost time: 1.05362868309021
Epoch: 14, Steps: 64 | Train Loss: 0.0853367 Vali Loss: 0.1508451 Test Loss: 0.1438584
Validation loss decreased (0.151793 --> 0.150845).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 15 cost time: 1.002363920211792
Epoch: 15, Steps: 64 | Train Loss: 0.0846894 Vali Loss: 0.1526855 Test Loss: 0.1448517
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 16 cost time: 0.9755432605743408
Epoch: 16, Steps: 64 | Train Loss: 0.0841126 Vali Loss: 0.1492497 Test Loss: 0.1444093
Validation loss decreased (0.150845 --> 0.149250).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 17 cost time: 0.9745371341705322
Epoch: 17, Steps: 64 | Train Loss: 0.0838639 Vali Loss: 0.1493852 Test Loss: 0.1435202
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 18 cost time: 0.9952917098999023
Epoch: 18, Steps: 64 | Train Loss: 0.0834724 Vali Loss: 0.1480448 Test Loss: 0.1433320
Validation loss decreased (0.149250 --> 0.148045).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 19 cost time: 0.9732575416564941
Epoch: 19, Steps: 64 | Train Loss: 0.0830096 Vali Loss: 0.1482487 Test Loss: 0.1434765
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 20 cost time: 0.9593703746795654
Epoch: 20, Steps: 64 | Train Loss: 0.0825842 Vali Loss: 0.1482425 Test Loss: 0.1434463
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 21 cost time: 0.9597640037536621
Epoch: 21, Steps: 64 | Train Loss: 0.0824763 Vali Loss: 0.1453893 Test Loss: 0.1433949
Validation loss decreased (0.148045 --> 0.145389).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 22 cost time: 0.9652338027954102
Epoch: 22, Steps: 64 | Train Loss: 0.0821844 Vali Loss: 0.1475516 Test Loss: 0.1431754
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 23 cost time: 0.9789998531341553
Epoch: 23, Steps: 64 | Train Loss: 0.0819484 Vali Loss: 0.1464356 Test Loss: 0.1434692
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 24 cost time: 0.9796254634857178
Epoch: 24, Steps: 64 | Train Loss: 0.0817258 Vali Loss: 0.1480322 Test Loss: 0.1432700
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 25 cost time: 0.9393918514251709
Epoch: 25, Steps: 64 | Train Loss: 0.0812920 Vali Loss: 0.1468220 Test Loss: 0.1433259
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 26 cost time: 0.953399658203125
Epoch: 26, Steps: 64 | Train Loss: 0.0812464 Vali Loss: 0.1468807 Test Loss: 0.1430463
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 27 cost time: 0.964385986328125
Epoch: 27, Steps: 64 | Train Loss: 0.0808366 Vali Loss: 0.1463948 Test Loss: 0.1435758
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 28 cost time: 0.929387092590332
Epoch: 28, Steps: 64 | Train Loss: 0.0809468 Vali Loss: 0.1457652 Test Loss: 0.1425859
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 29 cost time: 0.9804553985595703
Epoch: 29, Steps: 64 | Train Loss: 0.0807428 Vali Loss: 0.1453646 Test Loss: 0.1431385
Validation loss decreased (0.145389 --> 0.145365).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 30 cost time: 0.9823808670043945
Epoch: 30, Steps: 64 | Train Loss: 0.0805888 Vali Loss: 0.1455901 Test Loss: 0.1425150
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 31 cost time: 0.9817979335784912
Epoch: 31, Steps: 64 | Train Loss: 0.0804528 Vali Loss: 0.1462651 Test Loss: 0.1431404
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 32 cost time: 0.9669981002807617
Epoch: 32, Steps: 64 | Train Loss: 0.0801586 Vali Loss: 0.1460555 Test Loss: 0.1433646
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 33 cost time: 0.9726057052612305
Epoch: 33, Steps: 64 | Train Loss: 0.0805561 Vali Loss: 0.1447091 Test Loss: 0.1427612
Validation loss decreased (0.145365 --> 0.144709).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 34 cost time: 0.9810476303100586
Epoch: 34, Steps: 64 | Train Loss: 0.0801292 Vali Loss: 0.1470799 Test Loss: 0.1431895
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 35 cost time: 0.9873969554901123
Epoch: 35, Steps: 64 | Train Loss: 0.0804543 Vali Loss: 0.1453836 Test Loss: 0.1423151
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 36 cost time: 0.9860720634460449
Epoch: 36, Steps: 64 | Train Loss: 0.0803482 Vali Loss: 0.1449598 Test Loss: 0.1425643
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 37 cost time: 0.9923515319824219
Epoch: 37, Steps: 64 | Train Loss: 0.0801470 Vali Loss: 0.1459101 Test Loss: 0.1429639
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 38 cost time: 0.9689784049987793
Epoch: 38, Steps: 64 | Train Loss: 0.0803741 Vali Loss: 0.1466561 Test Loss: 0.1420631
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 39 cost time: 0.9324777126312256
Epoch: 39, Steps: 64 | Train Loss: 0.0799555 Vali Loss: 0.1466601 Test Loss: 0.1424829
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 40 cost time: 0.9347186088562012
Epoch: 40, Steps: 64 | Train Loss: 0.0797561 Vali Loss: 0.1446592 Test Loss: 0.1426983
Validation loss decreased (0.144709 --> 0.144659).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 41 cost time: 0.9580001831054688
Epoch: 41, Steps: 64 | Train Loss: 0.0803587 Vali Loss: 0.1453163 Test Loss: 0.1425117
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 42 cost time: 0.9757356643676758
Epoch: 42, Steps: 64 | Train Loss: 0.0798472 Vali Loss: 0.1448783 Test Loss: 0.1419583
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 43 cost time: 0.9746487140655518
Epoch: 43, Steps: 64 | Train Loss: 0.0799159 Vali Loss: 0.1458282 Test Loss: 0.1425172
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 44 cost time: 0.9724888801574707
Epoch: 44, Steps: 64 | Train Loss: 0.0798802 Vali Loss: 0.1453412 Test Loss: 0.1425093
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 45 cost time: 0.9673829078674316
Epoch: 45, Steps: 64 | Train Loss: 0.0798528 Vali Loss: 0.1459308 Test Loss: 0.1432874
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 46 cost time: 0.9583902359008789
Epoch: 46, Steps: 64 | Train Loss: 0.0799902 Vali Loss: 0.1453228 Test Loss: 0.1419697
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 47 cost time: 0.9689884185791016
Epoch: 47, Steps: 64 | Train Loss: 0.0799633 Vali Loss: 0.1443105 Test Loss: 0.1420455
Validation loss decreased (0.144659 --> 0.144311).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 48 cost time: 0.9735133647918701
Epoch: 48, Steps: 64 | Train Loss: 0.0794814 Vali Loss: 0.1432963 Test Loss: 0.1424449
Validation loss decreased (0.144311 --> 0.143296).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 49 cost time: 0.9737823009490967
Epoch: 49, Steps: 64 | Train Loss: 0.0796429 Vali Loss: 0.1455210 Test Loss: 0.1420004
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 50 cost time: 0.9747493267059326
Epoch: 50, Steps: 64 | Train Loss: 0.0798039 Vali Loss: 0.1455017 Test Loss: 0.1423135
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 51 cost time: 0.9746353626251221
Epoch: 51, Steps: 64 | Train Loss: 0.0797206 Vali Loss: 0.1458026 Test Loss: 0.1422040
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 52 cost time: 0.9856357574462891
Epoch: 52, Steps: 64 | Train Loss: 0.0799330 Vali Loss: 0.1446529 Test Loss: 0.1423097
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 53 cost time: 0.9896252155303955
Epoch: 53, Steps: 64 | Train Loss: 0.0796303 Vali Loss: 0.1455037 Test Loss: 0.1421769
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 54 cost time: 1.0003888607025146
Epoch: 54, Steps: 64 | Train Loss: 0.0795933 Vali Loss: 0.1446776 Test Loss: 0.1426853
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 55 cost time: 0.9863815307617188
Epoch: 55, Steps: 64 | Train Loss: 0.0798547 Vali Loss: 0.1447531 Test Loss: 0.1437335
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 56 cost time: 0.9654936790466309
Epoch: 56, Steps: 64 | Train Loss: 0.0796079 Vali Loss: 0.1446030 Test Loss: 0.1424430
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 57 cost time: 0.9383902549743652
Epoch: 57, Steps: 64 | Train Loss: 0.0797700 Vali Loss: 0.1454036 Test Loss: 0.1435014
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 58 cost time: 0.9503967761993408
Epoch: 58, Steps: 64 | Train Loss: 0.0798337 Vali Loss: 0.1458567 Test Loss: 0.1428706
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 59 cost time: 0.929250955581665
Epoch: 59, Steps: 64 | Train Loss: 0.0800602 Vali Loss: 0.1453121 Test Loss: 0.1425931
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018663406372070312 GB
GPU已分配内存的峰值：0.06185626983642578 GB
Epoch: 60 cost time: 0.950000524520874
Epoch: 60, Steps: 64 | Train Loss: 0.0794568 Vali Loss: 0.1452382 Test Loss: 0.1418964
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1424449384212494, mae:0.2763116657733917, rse:0.20088361203670502
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.057227134704589844 GB
Epoch: 1 cost time: 2.310918092727661
Epoch: 1, Steps: 64 | Train Loss: 0.6646167 Vali Loss: 1.2928802 Test Loss: 2.2330730
Validation loss decreased (inf --> 1.292880).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 2 cost time: 0.9130008220672607
Epoch: 2, Steps: 64 | Train Loss: 0.3933992 Vali Loss: 0.3604592 Test Loss: 0.3720374
Validation loss decreased (1.292880 --> 0.360459).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 3 cost time: 0.9101071357727051
Epoch: 3, Steps: 64 | Train Loss: 0.1877776 Vali Loss: 0.2473207 Test Loss: 0.2043495
Validation loss decreased (0.360459 --> 0.247321).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 4 cost time: 0.9208533763885498
Epoch: 4, Steps: 64 | Train Loss: 0.1436841 Vali Loss: 0.2056864 Test Loss: 0.1684035
Validation loss decreased (0.247321 --> 0.205686).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 5 cost time: 0.89650559425354
Epoch: 5, Steps: 64 | Train Loss: 0.1273800 Vali Loss: 0.1843176 Test Loss: 0.1526829
Validation loss decreased (0.205686 --> 0.184318).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 6 cost time: 0.8893916606903076
Epoch: 6, Steps: 64 | Train Loss: 0.1175231 Vali Loss: 0.1729832 Test Loss: 0.1472248
Validation loss decreased (0.184318 --> 0.172983).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 7 cost time: 0.8954124450683594
Epoch: 7, Steps: 64 | Train Loss: 0.1127068 Vali Loss: 0.1666809 Test Loss: 0.1453626
Validation loss decreased (0.172983 --> 0.166681).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 8 cost time: 0.9021139144897461
Epoch: 8, Steps: 64 | Train Loss: 0.1082802 Vali Loss: 0.1644246 Test Loss: 0.1444484
Validation loss decreased (0.166681 --> 0.164425).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 9 cost time: 0.8900001049041748
Epoch: 9, Steps: 64 | Train Loss: 0.1053392 Vali Loss: 0.1626511 Test Loss: 0.1429078
Validation loss decreased (0.164425 --> 0.162651).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 10 cost time: 0.9136395454406738
Epoch: 10, Steps: 64 | Train Loss: 0.1035913 Vali Loss: 0.1577461 Test Loss: 0.1429210
Validation loss decreased (0.162651 --> 0.157746).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 11 cost time: 0.9334225654602051
Epoch: 11, Steps: 64 | Train Loss: 0.1009533 Vali Loss: 0.1584773 Test Loss: 0.1429832
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 12 cost time: 0.9358994960784912
Epoch: 12, Steps: 64 | Train Loss: 0.1002866 Vali Loss: 0.1565247 Test Loss: 0.1418532
Validation loss decreased (0.157746 --> 0.156525).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 13 cost time: 0.9373912811279297
Epoch: 13, Steps: 64 | Train Loss: 0.0988673 Vali Loss: 0.1554255 Test Loss: 0.1413859
Validation loss decreased (0.156525 --> 0.155425).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 14 cost time: 0.9093954563140869
Epoch: 14, Steps: 64 | Train Loss: 0.0976380 Vali Loss: 0.1544180 Test Loss: 0.1430953
Validation loss decreased (0.155425 --> 0.154418).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 15 cost time: 0.9257597923278809
Epoch: 15, Steps: 64 | Train Loss: 0.0971638 Vali Loss: 0.1558465 Test Loss: 0.1432910
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 16 cost time: 0.9129998683929443
Epoch: 16, Steps: 64 | Train Loss: 0.0965633 Vali Loss: 0.1550021 Test Loss: 0.1419124
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 17 cost time: 0.914644718170166
Epoch: 17, Steps: 64 | Train Loss: 0.0960937 Vali Loss: 0.1530700 Test Loss: 0.1418869
Validation loss decreased (0.154418 --> 0.153070).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 18 cost time: 0.9283792972564697
Epoch: 18, Steps: 64 | Train Loss: 0.0946801 Vali Loss: 0.1523451 Test Loss: 0.1434038
Validation loss decreased (0.153070 --> 0.152345).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 19 cost time: 0.934377908706665
Epoch: 19, Steps: 64 | Train Loss: 0.0941896 Vali Loss: 0.1521269 Test Loss: 0.1420234
Validation loss decreased (0.152345 --> 0.152127).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 20 cost time: 0.9413762092590332
Epoch: 20, Steps: 64 | Train Loss: 0.0930704 Vali Loss: 0.1517293 Test Loss: 0.1415990
Validation loss decreased (0.152127 --> 0.151729).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 21 cost time: 0.9117820262908936
Epoch: 21, Steps: 64 | Train Loss: 0.0928039 Vali Loss: 0.1515225 Test Loss: 0.1422295
Validation loss decreased (0.151729 --> 0.151523).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 22 cost time: 0.9188964366912842
Epoch: 22, Steps: 64 | Train Loss: 0.0922781 Vali Loss: 0.1508785 Test Loss: 0.1431559
Validation loss decreased (0.151523 --> 0.150879).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 23 cost time: 0.8855533599853516
Epoch: 23, Steps: 64 | Train Loss: 0.0923672 Vali Loss: 0.1507498 Test Loss: 0.1425874
Validation loss decreased (0.150879 --> 0.150750).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 24 cost time: 0.8846356868743896
Epoch: 24, Steps: 64 | Train Loss: 0.0917669 Vali Loss: 0.1504552 Test Loss: 0.1415792
Validation loss decreased (0.150750 --> 0.150455).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 25 cost time: 0.8998217582702637
Epoch: 25, Steps: 64 | Train Loss: 0.0918153 Vali Loss: 0.1503832 Test Loss: 0.1423946
Validation loss decreased (0.150455 --> 0.150383).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 26 cost time: 0.8913874626159668
Epoch: 26, Steps: 64 | Train Loss: 0.0911788 Vali Loss: 0.1473330 Test Loss: 0.1404370
Validation loss decreased (0.150383 --> 0.147333).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 27 cost time: 0.9104211330413818
Epoch: 27, Steps: 64 | Train Loss: 0.0911280 Vali Loss: 0.1474257 Test Loss: 0.1408532
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 28 cost time: 0.9087834358215332
Epoch: 28, Steps: 64 | Train Loss: 0.0908926 Vali Loss: 0.1491262 Test Loss: 0.1417076
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 29 cost time: 0.9077732563018799
Epoch: 29, Steps: 64 | Train Loss: 0.0906096 Vali Loss: 0.1483441 Test Loss: 0.1416255
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 30 cost time: 0.9083423614501953
Epoch: 30, Steps: 64 | Train Loss: 0.0910003 Vali Loss: 0.1481116 Test Loss: 0.1415992
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 31 cost time: 0.9236388206481934
Epoch: 31, Steps: 64 | Train Loss: 0.0906929 Vali Loss: 0.1487604 Test Loss: 0.1405611
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 32 cost time: 0.9172840118408203
Epoch: 32, Steps: 64 | Train Loss: 0.0905157 Vali Loss: 0.1491788 Test Loss: 0.1416044
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 33 cost time: 0.9263715744018555
Epoch: 33, Steps: 64 | Train Loss: 0.0903018 Vali Loss: 0.1481780 Test Loss: 0.1407574
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 34 cost time: 0.9237930774688721
Epoch: 34, Steps: 64 | Train Loss: 0.0901371 Vali Loss: 0.1468302 Test Loss: 0.1410692
Validation loss decreased (0.147333 --> 0.146830).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 35 cost time: 0.9298303127288818
Epoch: 35, Steps: 64 | Train Loss: 0.0905762 Vali Loss: 0.1472835 Test Loss: 0.1400449
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 36 cost time: 0.9440011978149414
Epoch: 36, Steps: 64 | Train Loss: 0.0895851 Vali Loss: 0.1481915 Test Loss: 0.1409543
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 37 cost time: 0.9389996528625488
Epoch: 37, Steps: 64 | Train Loss: 0.0895220 Vali Loss: 0.1475518 Test Loss: 0.1407995
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 38 cost time: 0.9341022968292236
Epoch: 38, Steps: 64 | Train Loss: 0.0894722 Vali Loss: 0.1458718 Test Loss: 0.1412825
Validation loss decreased (0.146830 --> 0.145872).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 39 cost time: 0.938356876373291
Epoch: 39, Steps: 64 | Train Loss: 0.0899577 Vali Loss: 0.1477812 Test Loss: 0.1416746
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 40 cost time: 0.9265248775482178
Epoch: 40, Steps: 64 | Train Loss: 0.0893495 Vali Loss: 0.1464237 Test Loss: 0.1417226
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 41 cost time: 0.8974356651306152
Epoch: 41, Steps: 64 | Train Loss: 0.0897199 Vali Loss: 0.1462809 Test Loss: 0.1404748
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 42 cost time: 0.8797471523284912
Epoch: 42, Steps: 64 | Train Loss: 0.0892152 Vali Loss: 0.1465449 Test Loss: 0.1417047
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 43 cost time: 0.8950011730194092
Epoch: 43, Steps: 64 | Train Loss: 0.0892838 Vali Loss: 0.1485491 Test Loss: 0.1425724
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 44 cost time: 0.8756358623504639
Epoch: 44, Steps: 64 | Train Loss: 0.0893687 Vali Loss: 0.1475685 Test Loss: 0.1412611
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 45 cost time: 0.9024307727813721
Epoch: 45, Steps: 64 | Train Loss: 0.0890385 Vali Loss: 0.1476224 Test Loss: 0.1413029
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 46 cost time: 0.9054017066955566
Epoch: 46, Steps: 64 | Train Loss: 0.0889945 Vali Loss: 0.1468565 Test Loss: 0.1414987
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 47 cost time: 0.9227719306945801
Epoch: 47, Steps: 64 | Train Loss: 0.0893015 Vali Loss: 0.1462819 Test Loss: 0.1414631
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 48 cost time: 0.9404656887054443
Epoch: 48, Steps: 64 | Train Loss: 0.0889670 Vali Loss: 0.1477698 Test Loss: 0.1423418
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 49 cost time: 0.924811840057373
Epoch: 49, Steps: 64 | Train Loss: 0.0891874 Vali Loss: 0.1478262 Test Loss: 0.1419272
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 50 cost time: 0.919999361038208
Epoch: 50, Steps: 64 | Train Loss: 0.0897239 Vali Loss: 0.1459287 Test Loss: 0.1411272
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 51 cost time: 0.9030802249908447
Epoch: 51, Steps: 64 | Train Loss: 0.0890152 Vali Loss: 0.1457087 Test Loss: 0.1410456
Validation loss decreased (0.145872 --> 0.145709).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 52 cost time: 0.9283432960510254
Epoch: 52, Steps: 64 | Train Loss: 0.0895073 Vali Loss: 0.1469756 Test Loss: 0.1418910
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 53 cost time: 0.929455041885376
Epoch: 53, Steps: 64 | Train Loss: 0.0892337 Vali Loss: 0.1466318 Test Loss: 0.1420565
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 54 cost time: 0.9374041557312012
Epoch: 54, Steps: 64 | Train Loss: 0.0892405 Vali Loss: 0.1458599 Test Loss: 0.1404082
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 55 cost time: 0.9325199127197266
Epoch: 55, Steps: 64 | Train Loss: 0.0888645 Vali Loss: 0.1474915 Test Loss: 0.1432603
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 56 cost time: 0.9347095489501953
Epoch: 56, Steps: 64 | Train Loss: 0.0890199 Vali Loss: 0.1476596 Test Loss: 0.1428333
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 57 cost time: 0.942997932434082
Epoch: 57, Steps: 64 | Train Loss: 0.0892055 Vali Loss: 0.1473874 Test Loss: 0.1408688
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 58 cost time: 0.9286339282989502
Epoch: 58, Steps: 64 | Train Loss: 0.0890814 Vali Loss: 0.1461546 Test Loss: 0.1404258
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 59 cost time: 0.9307212829589844
Epoch: 59, Steps: 64 | Train Loss: 0.0893934 Vali Loss: 0.1458731 Test Loss: 0.1417687
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01847076416015625 GB
GPU已分配内存的峰值：0.058942317962646484 GB
Epoch: 60 cost time: 0.9294266700744629
Epoch: 60, Steps: 64 | Train Loss: 0.0890805 Vali Loss: 0.1477200 Test Loss: 0.1416213
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14104557037353516, mae:0.2724595069885254, rse:0.19989442825317383
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.05865907669067383 GB
Epoch: 1 cost time: 2.353875160217285
Epoch: 1, Steps: 64 | Train Loss: 1.0407958 Vali Loss: 2.3226376 Test Loss: 4.4375720
Validation loss decreased (inf --> 2.322638).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 2 cost time: 0.9394006729125977
Epoch: 2, Steps: 64 | Train Loss: 0.5896457 Vali Loss: 0.6283270 Test Loss: 0.8949564
Validation loss decreased (2.322638 --> 0.628327).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 3 cost time: 0.92938232421875
Epoch: 3, Steps: 64 | Train Loss: 0.2012059 Vali Loss: 0.2675425 Test Loss: 0.2165920
Validation loss decreased (0.628327 --> 0.267542).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 4 cost time: 0.9414002895355225
Epoch: 4, Steps: 64 | Train Loss: 0.1224943 Vali Loss: 0.2065198 Test Loss: 0.1595347
Validation loss decreased (0.267542 --> 0.206520).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 5 cost time: 0.9173915386199951
Epoch: 5, Steps: 64 | Train Loss: 0.1095646 Vali Loss: 0.1850249 Test Loss: 0.1492719
Validation loss decreased (0.206520 --> 0.185025).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 6 cost time: 0.9929494857788086
Epoch: 6, Steps: 64 | Train Loss: 0.1024488 Vali Loss: 0.1732027 Test Loss: 0.1427943
Validation loss decreased (0.185025 --> 0.173203).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 7 cost time: 0.9407651424407959
Epoch: 7, Steps: 64 | Train Loss: 0.0989983 Vali Loss: 0.1650950 Test Loss: 0.1399479
Validation loss decreased (0.173203 --> 0.165095).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 8 cost time: 0.9163877964019775
Epoch: 8, Steps: 64 | Train Loss: 0.0957136 Vali Loss: 0.1612814 Test Loss: 0.1379350
Validation loss decreased (0.165095 --> 0.161281).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 9 cost time: 0.927631139755249
Epoch: 9, Steps: 64 | Train Loss: 0.0934298 Vali Loss: 0.1568848 Test Loss: 0.1364829
Validation loss decreased (0.161281 --> 0.156885).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 10 cost time: 0.952378511428833
Epoch: 10, Steps: 64 | Train Loss: 0.0918675 Vali Loss: 0.1552164 Test Loss: 0.1365181
Validation loss decreased (0.156885 --> 0.155216).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 11 cost time: 0.9704310894012451
Epoch: 11, Steps: 64 | Train Loss: 0.0902322 Vali Loss: 0.1539740 Test Loss: 0.1351400
Validation loss decreased (0.155216 --> 0.153974).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 12 cost time: 0.9710407257080078
Epoch: 12, Steps: 64 | Train Loss: 0.0894039 Vali Loss: 0.1502255 Test Loss: 0.1347636
Validation loss decreased (0.153974 --> 0.150225).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 13 cost time: 0.9715633392333984
Epoch: 13, Steps: 64 | Train Loss: 0.0883497 Vali Loss: 0.1474809 Test Loss: 0.1328280
Validation loss decreased (0.150225 --> 0.147481).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 14 cost time: 0.9450137615203857
Epoch: 14, Steps: 64 | Train Loss: 0.0877378 Vali Loss: 0.1481488 Test Loss: 0.1342983
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 15 cost time: 0.9555544853210449
Epoch: 15, Steps: 64 | Train Loss: 0.0871079 Vali Loss: 0.1477894 Test Loss: 0.1331571
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 16 cost time: 0.9427280426025391
Epoch: 16, Steps: 64 | Train Loss: 0.0863173 Vali Loss: 0.1462992 Test Loss: 0.1335399
Validation loss decreased (0.147481 --> 0.146299).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 17 cost time: 0.956474781036377
Epoch: 17, Steps: 64 | Train Loss: 0.0856768 Vali Loss: 0.1468178 Test Loss: 0.1333242
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 18 cost time: 0.9706525802612305
Epoch: 18, Steps: 64 | Train Loss: 0.0850499 Vali Loss: 0.1460693 Test Loss: 0.1336001
Validation loss decreased (0.146299 --> 0.146069).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 19 cost time: 0.9746341705322266
Epoch: 19, Steps: 64 | Train Loss: 0.0850570 Vali Loss: 0.1439692 Test Loss: 0.1323542
Validation loss decreased (0.146069 --> 0.143969).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 20 cost time: 0.9764447212219238
Epoch: 20, Steps: 64 | Train Loss: 0.0847327 Vali Loss: 0.1446891 Test Loss: 0.1323363
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 21 cost time: 0.9710226058959961
Epoch: 21, Steps: 64 | Train Loss: 0.0840664 Vali Loss: 0.1450519 Test Loss: 0.1326605
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 22 cost time: 0.9604947566986084
Epoch: 22, Steps: 64 | Train Loss: 0.0838373 Vali Loss: 0.1434300 Test Loss: 0.1323457
Validation loss decreased (0.143969 --> 0.143430).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 23 cost time: 0.9644572734832764
Epoch: 23, Steps: 64 | Train Loss: 0.0836723 Vali Loss: 0.1433970 Test Loss: 0.1322922
Validation loss decreased (0.143430 --> 0.143397).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 24 cost time: 0.9395003318786621
Epoch: 24, Steps: 64 | Train Loss: 0.0834937 Vali Loss: 0.1437354 Test Loss: 0.1324240
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 25 cost time: 0.920367956161499
Epoch: 25, Steps: 64 | Train Loss: 0.0834554 Vali Loss: 0.1428933 Test Loss: 0.1319109
Validation loss decreased (0.143397 --> 0.142893).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 26 cost time: 0.9260008335113525
Epoch: 26, Steps: 64 | Train Loss: 0.0831018 Vali Loss: 0.1427230 Test Loss: 0.1326359
Validation loss decreased (0.142893 --> 0.142723).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 27 cost time: 0.9516375064849854
Epoch: 27, Steps: 64 | Train Loss: 0.0826503 Vali Loss: 0.1417807 Test Loss: 0.1319878
Validation loss decreased (0.142723 --> 0.141781).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 28 cost time: 0.9513373374938965
Epoch: 28, Steps: 64 | Train Loss: 0.0830266 Vali Loss: 0.1409730 Test Loss: 0.1334470
Validation loss decreased (0.141781 --> 0.140973).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 29 cost time: 0.9431436061859131
Epoch: 29, Steps: 64 | Train Loss: 0.0829846 Vali Loss: 0.1420676 Test Loss: 0.1324083
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 30 cost time: 0.9634079933166504
Epoch: 30, Steps: 64 | Train Loss: 0.0823728 Vali Loss: 0.1419273 Test Loss: 0.1328319
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 31 cost time: 0.951486349105835
Epoch: 31, Steps: 64 | Train Loss: 0.0823417 Vali Loss: 0.1414701 Test Loss: 0.1323909
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 32 cost time: 0.9514148235321045
Epoch: 32, Steps: 64 | Train Loss: 0.0820347 Vali Loss: 0.1415240 Test Loss: 0.1316979
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 33 cost time: 0.9518673419952393
Epoch: 33, Steps: 64 | Train Loss: 0.0821187 Vali Loss: 0.1416675 Test Loss: 0.1332047
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 34 cost time: 0.947634220123291
Epoch: 34, Steps: 64 | Train Loss: 0.0822482 Vali Loss: 0.1386798 Test Loss: 0.1321308
Validation loss decreased (0.140973 --> 0.138680).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 35 cost time: 0.9710021018981934
Epoch: 35, Steps: 64 | Train Loss: 0.0817179 Vali Loss: 0.1408855 Test Loss: 0.1316780
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 36 cost time: 0.9649999141693115
Epoch: 36, Steps: 64 | Train Loss: 0.0818329 Vali Loss: 0.1414146 Test Loss: 0.1320620
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 37 cost time: 0.9784321784973145
Epoch: 37, Steps: 64 | Train Loss: 0.0815761 Vali Loss: 0.1383071 Test Loss: 0.1312377
Validation loss decreased (0.138680 --> 0.138307).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 38 cost time: 0.9602828025817871
Epoch: 38, Steps: 64 | Train Loss: 0.0815688 Vali Loss: 0.1421643 Test Loss: 0.1323031
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 39 cost time: 0.9373612403869629
Epoch: 39, Steps: 64 | Train Loss: 0.0815991 Vali Loss: 0.1390207 Test Loss: 0.1315154
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 40 cost time: 0.9163670539855957
Epoch: 40, Steps: 64 | Train Loss: 0.0817437 Vali Loss: 0.1411156 Test Loss: 0.1324600
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 41 cost time: 0.9234368801116943
Epoch: 41, Steps: 64 | Train Loss: 0.0815492 Vali Loss: 0.1416734 Test Loss: 0.1314898
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 42 cost time: 0.9151225090026855
Epoch: 42, Steps: 64 | Train Loss: 0.0816350 Vali Loss: 0.1420727 Test Loss: 0.1321487
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 43 cost time: 0.9259998798370361
Epoch: 43, Steps: 64 | Train Loss: 0.0816622 Vali Loss: 0.1407636 Test Loss: 0.1316517
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 44 cost time: 0.9486446380615234
Epoch: 44, Steps: 64 | Train Loss: 0.0813957 Vali Loss: 0.1415962 Test Loss: 0.1329318
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 45 cost time: 0.9390220642089844
Epoch: 45, Steps: 64 | Train Loss: 0.0813173 Vali Loss: 0.1410158 Test Loss: 0.1316603
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 46 cost time: 0.9430172443389893
Epoch: 46, Steps: 64 | Train Loss: 0.0813388 Vali Loss: 0.1411001 Test Loss: 0.1329304
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 47 cost time: 0.9384024143218994
Epoch: 47, Steps: 64 | Train Loss: 0.0814670 Vali Loss: 0.1395038 Test Loss: 0.1315605
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 48 cost time: 0.9185023307800293
Epoch: 48, Steps: 64 | Train Loss: 0.0814491 Vali Loss: 0.1403441 Test Loss: 0.1326952
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 49 cost time: 0.9457545280456543
Epoch: 49, Steps: 64 | Train Loss: 0.0810274 Vali Loss: 0.1414740 Test Loss: 0.1321162
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 50 cost time: 0.9567956924438477
Epoch: 50, Steps: 64 | Train Loss: 0.0810945 Vali Loss: 0.1405443 Test Loss: 0.1324934
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 51 cost time: 0.9479997158050537
Epoch: 51, Steps: 64 | Train Loss: 0.0812373 Vali Loss: 0.1399202 Test Loss: 0.1325348
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 52 cost time: 0.9616281986236572
Epoch: 52, Steps: 64 | Train Loss: 0.0812633 Vali Loss: 0.1408139 Test Loss: 0.1318883
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 53 cost time: 0.9693846702575684
Epoch: 53, Steps: 64 | Train Loss: 0.0811134 Vali Loss: 0.1392493 Test Loss: 0.1332198
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 54 cost time: 0.9814016819000244
Epoch: 54, Steps: 64 | Train Loss: 0.0811843 Vali Loss: 0.1392806 Test Loss: 0.1309076
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 55 cost time: 0.9674568176269531
Epoch: 55, Steps: 64 | Train Loss: 0.0809737 Vali Loss: 0.1408268 Test Loss: 0.1313054
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 56 cost time: 0.9574582576751709
Epoch: 56, Steps: 64 | Train Loss: 0.0813827 Vali Loss: 0.1414382 Test Loss: 0.1322705
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 57 cost time: 0.9493894577026367
Epoch: 57, Steps: 64 | Train Loss: 0.0811362 Vali Loss: 0.1409175 Test Loss: 0.1323413
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 58 cost time: 0.9367654323577881
Epoch: 58, Steps: 64 | Train Loss: 0.0811595 Vali Loss: 0.1408857 Test Loss: 0.1322377
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 59 cost time: 0.9046361446380615
Epoch: 59, Steps: 64 | Train Loss: 0.0810671 Vali Loss: 0.1404383 Test Loss: 0.1325649
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186004638671875 GB
GPU已分配内存的峰值：0.06050443649291992 GB
Epoch: 60 cost time: 0.9200408458709717
Epoch: 60, Steps: 64 | Train Loss: 0.0810737 Vali Loss: 0.1395347 Test Loss: 0.1315954
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1312377154827118, mae:0.25971519947052, rse:0.19281920790672302
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.05977916717529297 GB
Epoch: 1 cost time: 2.3835625648498535
Epoch: 1, Steps: 64 | Train Loss: 0.7818616 Vali Loss: 1.7929593 Test Loss: 3.4546940
Validation loss decreased (inf --> 1.792959).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 2 cost time: 0.9720008373260498
Epoch: 2, Steps: 64 | Train Loss: 0.4763354 Vali Loss: 0.4696541 Test Loss: 0.6343534
Validation loss decreased (1.792959 --> 0.469654).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 3 cost time: 0.9700040817260742
Epoch: 3, Steps: 64 | Train Loss: 0.1430082 Vali Loss: 0.1962933 Test Loss: 0.1658891
Validation loss decreased (0.469654 --> 0.196293).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 4 cost time: 0.9754610061645508
Epoch: 4, Steps: 64 | Train Loss: 0.0964179 Vali Loss: 0.1638790 Test Loss: 0.1433488
Validation loss decreased (0.196293 --> 0.163879).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 5 cost time: 0.9496417045593262
Epoch: 5, Steps: 64 | Train Loss: 0.0900640 Vali Loss: 0.1587832 Test Loss: 0.1408179
Validation loss decreased (0.163879 --> 0.158783).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 6 cost time: 0.9444255828857422
Epoch: 6, Steps: 64 | Train Loss: 0.0870269 Vali Loss: 0.1545981 Test Loss: 0.1407925
Validation loss decreased (0.158783 --> 0.154598).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 7 cost time: 0.9451231956481934
Epoch: 7, Steps: 64 | Train Loss: 0.0851911 Vali Loss: 0.1502491 Test Loss: 0.1389211
Validation loss decreased (0.154598 --> 0.150249).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 8 cost time: 0.9456791877746582
Epoch: 8, Steps: 64 | Train Loss: 0.0837556 Vali Loss: 0.1495201 Test Loss: 0.1402772
Validation loss decreased (0.150249 --> 0.149520).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 9 cost time: 0.9645073413848877
Epoch: 9, Steps: 64 | Train Loss: 0.0824846 Vali Loss: 0.1450888 Test Loss: 0.1393901
Validation loss decreased (0.149520 --> 0.145089).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 10 cost time: 0.9958555698394775
Epoch: 10, Steps: 64 | Train Loss: 0.0817761 Vali Loss: 0.1455714 Test Loss: 0.1388783
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 11 cost time: 1.008798360824585
Epoch: 11, Steps: 64 | Train Loss: 0.0813377 Vali Loss: 0.1444020 Test Loss: 0.1394815
Validation loss decreased (0.145089 --> 0.144402).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 12 cost time: 0.9940009117126465
Epoch: 12, Steps: 64 | Train Loss: 0.0802094 Vali Loss: 0.1423825 Test Loss: 0.1394776
Validation loss decreased (0.144402 --> 0.142383).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 13 cost time: 0.9830007553100586
Epoch: 13, Steps: 64 | Train Loss: 0.0797144 Vali Loss: 0.1415731 Test Loss: 0.1381211
Validation loss decreased (0.142383 --> 0.141573).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 14 cost time: 0.9916236400604248
Epoch: 14, Steps: 64 | Train Loss: 0.0791291 Vali Loss: 0.1417990 Test Loss: 0.1397511
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 15 cost time: 0.9701528549194336
Epoch: 15, Steps: 64 | Train Loss: 0.0785419 Vali Loss: 0.1402342 Test Loss: 0.1382387
Validation loss decreased (0.141573 --> 0.140234).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 16 cost time: 0.9773962497711182
Epoch: 16, Steps: 64 | Train Loss: 0.0786890 Vali Loss: 0.1404315 Test Loss: 0.1392932
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 17 cost time: 0.9913949966430664
Epoch: 17, Steps: 64 | Train Loss: 0.0780486 Vali Loss: 0.1390399 Test Loss: 0.1383149
Validation loss decreased (0.140234 --> 0.139040).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 18 cost time: 1.004366397857666
Epoch: 18, Steps: 64 | Train Loss: 0.0778480 Vali Loss: 0.1407361 Test Loss: 0.1382203
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 19 cost time: 0.9832184314727783
Epoch: 19, Steps: 64 | Train Loss: 0.0773176 Vali Loss: 0.1395711 Test Loss: 0.1387288
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 20 cost time: 0.9684240818023682
Epoch: 20, Steps: 64 | Train Loss: 0.0775428 Vali Loss: 0.1373018 Test Loss: 0.1364209
Validation loss decreased (0.139040 --> 0.137302).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 21 cost time: 0.9837372303009033
Epoch: 21, Steps: 64 | Train Loss: 0.0771286 Vali Loss: 0.1367189 Test Loss: 0.1382616
Validation loss decreased (0.137302 --> 0.136719).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 22 cost time: 0.9518260955810547
Epoch: 22, Steps: 64 | Train Loss: 0.0770075 Vali Loss: 0.1374600 Test Loss: 0.1372485
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 23 cost time: 0.9526398181915283
Epoch: 23, Steps: 64 | Train Loss: 0.0769527 Vali Loss: 0.1386998 Test Loss: 0.1386850
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 24 cost time: 0.9738259315490723
Epoch: 24, Steps: 64 | Train Loss: 0.0764979 Vali Loss: 0.1382114 Test Loss: 0.1377759
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 25 cost time: 0.9612481594085693
Epoch: 25, Steps: 64 | Train Loss: 0.0766319 Vali Loss: 0.1369427 Test Loss: 0.1376513
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 26 cost time: 0.9744832515716553
Epoch: 26, Steps: 64 | Train Loss: 0.0763627 Vali Loss: 0.1360225 Test Loss: 0.1370912
Validation loss decreased (0.136719 --> 0.136023).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 27 cost time: 0.9783856868743896
Epoch: 27, Steps: 64 | Train Loss: 0.0761565 Vali Loss: 0.1366829 Test Loss: 0.1371633
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 28 cost time: 0.9740209579467773
Epoch: 28, Steps: 64 | Train Loss: 0.0761679 Vali Loss: 0.1374872 Test Loss: 0.1377297
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 29 cost time: 0.9955441951751709
Epoch: 29, Steps: 64 | Train Loss: 0.0759441 Vali Loss: 0.1358557 Test Loss: 0.1366321
Validation loss decreased (0.136023 --> 0.135856).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 30 cost time: 0.9764518737792969
Epoch: 30, Steps: 64 | Train Loss: 0.0759792 Vali Loss: 0.1350565 Test Loss: 0.1370523
Validation loss decreased (0.135856 --> 0.135056).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 31 cost time: 0.9803853034973145
Epoch: 31, Steps: 64 | Train Loss: 0.0759938 Vali Loss: 0.1339685 Test Loss: 0.1376254
Validation loss decreased (0.135056 --> 0.133969).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 32 cost time: 0.9750657081604004
Epoch: 32, Steps: 64 | Train Loss: 0.0761020 Vali Loss: 0.1363938 Test Loss: 0.1378254
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 33 cost time: 0.9989306926727295
Epoch: 33, Steps: 64 | Train Loss: 0.0756316 Vali Loss: 0.1363377 Test Loss: 0.1359787
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 34 cost time: 0.9992549419403076
Epoch: 34, Steps: 64 | Train Loss: 0.0756639 Vali Loss: 0.1371429 Test Loss: 0.1373419
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 35 cost time: 1.000655174255371
Epoch: 35, Steps: 64 | Train Loss: 0.0760686 Vali Loss: 0.1370279 Test Loss: 0.1369513
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 36 cost time: 1.0072479248046875
Epoch: 36, Steps: 64 | Train Loss: 0.0758866 Vali Loss: 0.1351179 Test Loss: 0.1362242
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 37 cost time: 1.0146124362945557
Epoch: 37, Steps: 64 | Train Loss: 0.0757887 Vali Loss: 0.1367369 Test Loss: 0.1365881
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 38 cost time: 1.0032401084899902
Epoch: 38, Steps: 64 | Train Loss: 0.0754730 Vali Loss: 0.1361504 Test Loss: 0.1363181
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 39 cost time: 0.9979639053344727
Epoch: 39, Steps: 64 | Train Loss: 0.0752385 Vali Loss: 0.1351993 Test Loss: 0.1369006
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 40 cost time: 1.0104267597198486
Epoch: 40, Steps: 64 | Train Loss: 0.0759885 Vali Loss: 0.1347448 Test Loss: 0.1366198
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 41 cost time: 0.9494044780731201
Epoch: 41, Steps: 64 | Train Loss: 0.0756126 Vali Loss: 0.1360128 Test Loss: 0.1372256
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 42 cost time: 0.966404914855957
Epoch: 42, Steps: 64 | Train Loss: 0.0758659 Vali Loss: 0.1355960 Test Loss: 0.1366630
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 43 cost time: 0.973806619644165
Epoch: 43, Steps: 64 | Train Loss: 0.0754500 Vali Loss: 0.1348820 Test Loss: 0.1365486
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 44 cost time: 0.9733045101165771
Epoch: 44, Steps: 64 | Train Loss: 0.0753848 Vali Loss: 0.1362644 Test Loss: 0.1373104
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 45 cost time: 0.9802837371826172
Epoch: 45, Steps: 64 | Train Loss: 0.0755462 Vali Loss: 0.1362819 Test Loss: 0.1368144
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 46 cost time: 0.9736385345458984
Epoch: 46, Steps: 64 | Train Loss: 0.0752908 Vali Loss: 0.1353155 Test Loss: 0.1368791
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 47 cost time: 0.9786727428436279
Epoch: 47, Steps: 64 | Train Loss: 0.0756719 Vali Loss: 0.1341983 Test Loss: 0.1367118
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 48 cost time: 0.9754657745361328
Epoch: 48, Steps: 64 | Train Loss: 0.0755424 Vali Loss: 0.1363186 Test Loss: 0.1360992
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 49 cost time: 0.9842369556427002
Epoch: 49, Steps: 64 | Train Loss: 0.0751626 Vali Loss: 0.1342158 Test Loss: 0.1363871
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 50 cost time: 0.9870104789733887
Epoch: 50, Steps: 64 | Train Loss: 0.0753031 Vali Loss: 0.1369962 Test Loss: 0.1363761
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 51 cost time: 0.9904043674468994
Epoch: 51, Steps: 64 | Train Loss: 0.0754511 Vali Loss: 0.1347008 Test Loss: 0.1372460
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 52 cost time: 1.0013909339904785
Epoch: 52, Steps: 64 | Train Loss: 0.0754262 Vali Loss: 0.1347169 Test Loss: 0.1362678
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 53 cost time: 1.0030412673950195
Epoch: 53, Steps: 64 | Train Loss: 0.0753858 Vali Loss: 0.1351983 Test Loss: 0.1361028
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 54 cost time: 0.9998517036437988
Epoch: 54, Steps: 64 | Train Loss: 0.0753735 Vali Loss: 0.1354889 Test Loss: 0.1365791
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 55 cost time: 0.9753429889678955
Epoch: 55, Steps: 64 | Train Loss: 0.0751959 Vali Loss: 0.1368374 Test Loss: 0.1363661
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 56 cost time: 0.9580004215240479
Epoch: 56, Steps: 64 | Train Loss: 0.0755415 Vali Loss: 0.1355264 Test Loss: 0.1368240
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 57 cost time: 0.9566383361816406
Epoch: 57, Steps: 64 | Train Loss: 0.0751859 Vali Loss: 0.1349373 Test Loss: 0.1360476
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 58 cost time: 0.9506356716156006
Epoch: 58, Steps: 64 | Train Loss: 0.0756017 Vali Loss: 0.1345131 Test Loss: 0.1361850
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 59 cost time: 0.95939040184021
Epoch: 59, Steps: 64 | Train Loss: 0.0753886 Vali Loss: 0.1351273 Test Loss: 0.1367906
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01866912841796875 GB
GPU已分配内存的峰值：0.06202077865600586 GB
Epoch: 60 cost time: 0.9773693084716797
Epoch: 60, Steps: 64 | Train Loss: 0.0752580 Vali Loss: 0.1357774 Test Loss: 0.1368641
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13762539625167847, mae:0.27197957038879395, rse:0.1974559724330902
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.057389259338378906 GB
Epoch: 1 cost time: 2.326032876968384
Epoch: 1, Steps: 64 | Train Loss: 1.0531635 Vali Loss: 2.0056591 Test Loss: 3.9395466
Validation loss decreased (inf --> 2.005659).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 2 cost time: 0.9226541519165039
Epoch: 2, Steps: 64 | Train Loss: 0.5260904 Vali Loss: 0.3614218 Test Loss: 0.4479196
Validation loss decreased (2.005659 --> 0.361422).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 3 cost time: 0.922396183013916
Epoch: 3, Steps: 64 | Train Loss: 0.2071174 Vali Loss: 0.2186933 Test Loss: 0.1841317
Validation loss decreased (0.361422 --> 0.218693).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 4 cost time: 0.9233789443969727
Epoch: 4, Steps: 64 | Train Loss: 0.1584881 Vali Loss: 0.1909665 Test Loss: 0.1599510
Validation loss decreased (0.218693 --> 0.190967).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 5 cost time: 0.9047613143920898
Epoch: 5, Steps: 64 | Train Loss: 0.1424095 Vali Loss: 0.1816927 Test Loss: 0.1532056
Validation loss decreased (0.190967 --> 0.181693).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 6 cost time: 0.8980000019073486
Epoch: 6, Steps: 64 | Train Loss: 0.1326514 Vali Loss: 0.1732866 Test Loss: 0.1504571
Validation loss decreased (0.181693 --> 0.173287).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 7 cost time: 0.8959999084472656
Epoch: 7, Steps: 64 | Train Loss: 0.1257818 Vali Loss: 0.1724986 Test Loss: 0.1488150
Validation loss decreased (0.173287 --> 0.172499).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 8 cost time: 0.8983986377716064
Epoch: 8, Steps: 64 | Train Loss: 0.1208170 Vali Loss: 0.1702746 Test Loss: 0.1480611
Validation loss decreased (0.172499 --> 0.170275).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 9 cost time: 0.9084172248840332
Epoch: 9, Steps: 64 | Train Loss: 0.1173286 Vali Loss: 0.1654334 Test Loss: 0.1471431
Validation loss decreased (0.170275 --> 0.165433).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 10 cost time: 0.9213955402374268
Epoch: 10, Steps: 64 | Train Loss: 0.1140363 Vali Loss: 0.1644392 Test Loss: 0.1459268
Validation loss decreased (0.165433 --> 0.164439).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 11 cost time: 0.9408643245697021
Epoch: 11, Steps: 64 | Train Loss: 0.1116249 Vali Loss: 0.1634911 Test Loss: 0.1461230
Validation loss decreased (0.164439 --> 0.163491).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 12 cost time: 0.9468472003936768
Epoch: 12, Steps: 64 | Train Loss: 0.1096706 Vali Loss: 0.1598952 Test Loss: 0.1454463
Validation loss decreased (0.163491 --> 0.159895).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 13 cost time: 0.950763463973999
Epoch: 13, Steps: 64 | Train Loss: 0.1082625 Vali Loss: 0.1582617 Test Loss: 0.1442185
Validation loss decreased (0.159895 --> 0.158262).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 14 cost time: 0.9309999942779541
Epoch: 14, Steps: 64 | Train Loss: 0.1068189 Vali Loss: 0.1578753 Test Loss: 0.1451260
Validation loss decreased (0.158262 --> 0.157875).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 15 cost time: 0.9219884872436523
Epoch: 15, Steps: 64 | Train Loss: 0.1049465 Vali Loss: 0.1580412 Test Loss: 0.1444761
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 16 cost time: 0.9313507080078125
Epoch: 16, Steps: 64 | Train Loss: 0.1038038 Vali Loss: 0.1540684 Test Loss: 0.1439770
Validation loss decreased (0.157875 --> 0.154068).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 17 cost time: 0.9364376068115234
Epoch: 17, Steps: 64 | Train Loss: 0.1025740 Vali Loss: 0.1559932 Test Loss: 0.1436172
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 18 cost time: 0.9484670162200928
Epoch: 18, Steps: 64 | Train Loss: 0.1019870 Vali Loss: 0.1549311 Test Loss: 0.1446468
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 19 cost time: 0.9474012851715088
Epoch: 19, Steps: 64 | Train Loss: 0.1013258 Vali Loss: 0.1544747 Test Loss: 0.1434235
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 20 cost time: 0.9463298320770264
Epoch: 20, Steps: 64 | Train Loss: 0.1010868 Vali Loss: 0.1560741 Test Loss: 0.1436344
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 21 cost time: 0.9150006771087646
Epoch: 21, Steps: 64 | Train Loss: 0.1002670 Vali Loss: 0.1546884 Test Loss: 0.1432096
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 22 cost time: 0.9090030193328857
Epoch: 22, Steps: 64 | Train Loss: 0.0994419 Vali Loss: 0.1513769 Test Loss: 0.1426492
Validation loss decreased (0.154068 --> 0.151377).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 23 cost time: 0.8974142074584961
Epoch: 23, Steps: 64 | Train Loss: 0.0992042 Vali Loss: 0.1537998 Test Loss: 0.1429100
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 24 cost time: 0.9174175262451172
Epoch: 24, Steps: 64 | Train Loss: 0.0987845 Vali Loss: 0.1531912 Test Loss: 0.1428458
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 25 cost time: 0.8994064331054688
Epoch: 25, Steps: 64 | Train Loss: 0.0985157 Vali Loss: 0.1529603 Test Loss: 0.1429021
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 26 cost time: 0.8984284400939941
Epoch: 26, Steps: 64 | Train Loss: 0.0985207 Vali Loss: 0.1522338 Test Loss: 0.1432063
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 27 cost time: 0.9147317409515381
Epoch: 27, Steps: 64 | Train Loss: 0.0980869 Vali Loss: 0.1536159 Test Loss: 0.1431081
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 28 cost time: 0.932227373123169
Epoch: 28, Steps: 64 | Train Loss: 0.0975322 Vali Loss: 0.1519285 Test Loss: 0.1433526
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 29 cost time: 0.9246361255645752
Epoch: 29, Steps: 64 | Train Loss: 0.0967446 Vali Loss: 0.1519397 Test Loss: 0.1433945
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 30 cost time: 0.9246327877044678
Epoch: 30, Steps: 64 | Train Loss: 0.0973049 Vali Loss: 0.1511970 Test Loss: 0.1427830
Validation loss decreased (0.151377 --> 0.151197).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 31 cost time: 0.9327449798583984
Epoch: 31, Steps: 64 | Train Loss: 0.0972013 Vali Loss: 0.1515453 Test Loss: 0.1429316
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 32 cost time: 0.9193768501281738
Epoch: 32, Steps: 64 | Train Loss: 0.0965479 Vali Loss: 0.1510007 Test Loss: 0.1432886
Validation loss decreased (0.151197 --> 0.151001).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 33 cost time: 0.9260561466217041
Epoch: 33, Steps: 64 | Train Loss: 0.0963122 Vali Loss: 0.1527445 Test Loss: 0.1431580
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 34 cost time: 0.9198484420776367
Epoch: 34, Steps: 64 | Train Loss: 0.0966706 Vali Loss: 0.1526655 Test Loss: 0.1426933
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 35 cost time: 0.9398031234741211
Epoch: 35, Steps: 64 | Train Loss: 0.0960435 Vali Loss: 0.1527010 Test Loss: 0.1429516
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 36 cost time: 0.9520001411437988
Epoch: 36, Steps: 64 | Train Loss: 0.0959372 Vali Loss: 0.1506831 Test Loss: 0.1420044
Validation loss decreased (0.151001 --> 0.150683).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 37 cost time: 0.9446461200714111
Epoch: 37, Steps: 64 | Train Loss: 0.0957238 Vali Loss: 0.1531395 Test Loss: 0.1429321
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 38 cost time: 0.9537250995635986
Epoch: 38, Steps: 64 | Train Loss: 0.0958594 Vali Loss: 0.1518184 Test Loss: 0.1427475
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 39 cost time: 0.946357011795044
Epoch: 39, Steps: 64 | Train Loss: 0.0954333 Vali Loss: 0.1507327 Test Loss: 0.1426591
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 40 cost time: 0.9510564804077148
Epoch: 40, Steps: 64 | Train Loss: 0.0958683 Vali Loss: 0.1514507 Test Loss: 0.1431236
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 41 cost time: 0.9419958591461182
Epoch: 41, Steps: 64 | Train Loss: 0.0955927 Vali Loss: 0.1521553 Test Loss: 0.1423538
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 42 cost time: 0.8924036026000977
Epoch: 42, Steps: 64 | Train Loss: 0.0958035 Vali Loss: 0.1518416 Test Loss: 0.1425030
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 43 cost time: 0.8979997634887695
Epoch: 43, Steps: 64 | Train Loss: 0.0952209 Vali Loss: 0.1521814 Test Loss: 0.1428067
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 44 cost time: 0.9249992370605469
Epoch: 44, Steps: 64 | Train Loss: 0.0958512 Vali Loss: 0.1529909 Test Loss: 0.1424485
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 45 cost time: 0.9380197525024414
Epoch: 45, Steps: 64 | Train Loss: 0.0955753 Vali Loss: 0.1499494 Test Loss: 0.1429189
Validation loss decreased (0.150683 --> 0.149949).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 46 cost time: 0.9194002151489258
Epoch: 46, Steps: 64 | Train Loss: 0.0951167 Vali Loss: 0.1506695 Test Loss: 0.1439167
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 47 cost time: 0.918503999710083
Epoch: 47, Steps: 64 | Train Loss: 0.0947822 Vali Loss: 0.1508451 Test Loss: 0.1424371
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 48 cost time: 0.9155447483062744
Epoch: 48, Steps: 64 | Train Loss: 0.0950077 Vali Loss: 0.1527536 Test Loss: 0.1428940
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 49 cost time: 0.9024515151977539
Epoch: 49, Steps: 64 | Train Loss: 0.0947838 Vali Loss: 0.1513608 Test Loss: 0.1424961
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 50 cost time: 0.9157936573028564
Epoch: 50, Steps: 64 | Train Loss: 0.0945171 Vali Loss: 0.1519484 Test Loss: 0.1431732
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 51 cost time: 0.9260759353637695
Epoch: 51, Steps: 64 | Train Loss: 0.0953402 Vali Loss: 0.1508248 Test Loss: 0.1425392
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 52 cost time: 0.9356493949890137
Epoch: 52, Steps: 64 | Train Loss: 0.0947579 Vali Loss: 0.1528338 Test Loss: 0.1429669
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 53 cost time: 0.950584888458252
Epoch: 53, Steps: 64 | Train Loss: 0.0947152 Vali Loss: 0.1522014 Test Loss: 0.1429581
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 54 cost time: 0.9484364986419678
Epoch: 54, Steps: 64 | Train Loss: 0.0950534 Vali Loss: 0.1500477 Test Loss: 0.1421144
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 55 cost time: 0.9464449882507324
Epoch: 55, Steps: 64 | Train Loss: 0.0949132 Vali Loss: 0.1515964 Test Loss: 0.1429389
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 56 cost time: 0.9504282474517822
Epoch: 56, Steps: 64 | Train Loss: 0.0950314 Vali Loss: 0.1502480 Test Loss: 0.1423160
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 57 cost time: 0.9268186092376709
Epoch: 57, Steps: 64 | Train Loss: 0.0951609 Vali Loss: 0.1505681 Test Loss: 0.1419277
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 58 cost time: 0.9303984642028809
Epoch: 58, Steps: 64 | Train Loss: 0.0948749 Vali Loss: 0.1496138 Test Loss: 0.1426831
Validation loss decreased (0.149949 --> 0.149614).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 59 cost time: 0.9249999523162842
Epoch: 59, Steps: 64 | Train Loss: 0.0943227 Vali Loss: 0.1515296 Test Loss: 0.1424487
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0184783935546875 GB
GPU已分配内存的峰值：0.05910825729370117 GB
Epoch: 60 cost time: 0.9286460876464844
Epoch: 60, Steps: 64 | Train Loss: 0.0945228 Vali Loss: 0.1510617 Test Loss: 0.1430615
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14268313348293304, mae:0.2736908495426178, rse:0.2010514885187149
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.05882120132446289 GB
Epoch: 1 cost time: 2.341622829437256
Epoch: 1, Steps: 64 | Train Loss: 0.8387833 Vali Loss: 1.8734741 Test Loss: 3.5622439
Validation loss decreased (inf --> 1.873474).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 2 cost time: 0.9686324596405029
Epoch: 2, Steps: 64 | Train Loss: 0.4618066 Vali Loss: 0.4516414 Test Loss: 0.5378497
Validation loss decreased (1.873474 --> 0.451641).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 3 cost time: 0.9624600410461426
Epoch: 3, Steps: 64 | Train Loss: 0.1509050 Vali Loss: 0.2065397 Test Loss: 0.1669016
Validation loss decreased (0.451641 --> 0.206540).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 4 cost time: 0.9612975120544434
Epoch: 4, Steps: 64 | Train Loss: 0.1082692 Vali Loss: 0.1708646 Test Loss: 0.1445931
Validation loss decreased (0.206540 --> 0.170865).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 5 cost time: 0.9454793930053711
Epoch: 5, Steps: 64 | Train Loss: 0.1006567 Vali Loss: 0.1640352 Test Loss: 0.1411349
Validation loss decreased (0.170865 --> 0.164035).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 6 cost time: 0.9344396591186523
Epoch: 6, Steps: 64 | Train Loss: 0.0971185 Vali Loss: 0.1621977 Test Loss: 0.1394462
Validation loss decreased (0.164035 --> 0.162198).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 7 cost time: 0.9453508853912354
Epoch: 7, Steps: 64 | Train Loss: 0.0942331 Vali Loss: 0.1587263 Test Loss: 0.1385556
Validation loss decreased (0.162198 --> 0.158726).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 8 cost time: 0.9347612857818604
Epoch: 8, Steps: 64 | Train Loss: 0.0922362 Vali Loss: 0.1546562 Test Loss: 0.1379679
Validation loss decreased (0.158726 --> 0.154656).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 9 cost time: 0.9762420654296875
Epoch: 9, Steps: 64 | Train Loss: 0.0901575 Vali Loss: 0.1543299 Test Loss: 0.1375909
Validation loss decreased (0.154656 --> 0.154330).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 10 cost time: 0.9780006408691406
Epoch: 10, Steps: 64 | Train Loss: 0.0895429 Vali Loss: 0.1549313 Test Loss: 0.1375200
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 11 cost time: 0.984001636505127
Epoch: 11, Steps: 64 | Train Loss: 0.0882673 Vali Loss: 0.1545731 Test Loss: 0.1381479
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 12 cost time: 0.9946150779724121
Epoch: 12, Steps: 64 | Train Loss: 0.0877594 Vali Loss: 0.1547576 Test Loss: 0.1388921
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 13 cost time: 0.9686470031738281
Epoch: 13, Steps: 64 | Train Loss: 0.0868683 Vali Loss: 0.1537301 Test Loss: 0.1383200
Validation loss decreased (0.154330 --> 0.153730).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 14 cost time: 0.9703497886657715
Epoch: 14, Steps: 64 | Train Loss: 0.0863038 Vali Loss: 0.1526788 Test Loss: 0.1385501
Validation loss decreased (0.153730 --> 0.152679).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 15 cost time: 0.9551975727081299
Epoch: 15, Steps: 64 | Train Loss: 0.0855504 Vali Loss: 0.1510307 Test Loss: 0.1386485
Validation loss decreased (0.152679 --> 0.151031).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 16 cost time: 0.9814341068267822
Epoch: 16, Steps: 64 | Train Loss: 0.0846204 Vali Loss: 0.1497381 Test Loss: 0.1381889
Validation loss decreased (0.151031 --> 0.149738).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 17 cost time: 0.9741742610931396
Epoch: 17, Steps: 64 | Train Loss: 0.0846211 Vali Loss: 0.1494873 Test Loss: 0.1386889
Validation loss decreased (0.149738 --> 0.149487).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 18 cost time: 0.9841344356536865
Epoch: 18, Steps: 64 | Train Loss: 0.0840227 Vali Loss: 0.1494898 Test Loss: 0.1380706
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 19 cost time: 0.9823660850524902
Epoch: 19, Steps: 64 | Train Loss: 0.0836139 Vali Loss: 0.1486257 Test Loss: 0.1378028
Validation loss decreased (0.149487 --> 0.148626).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 20 cost time: 0.9494974613189697
Epoch: 20, Steps: 64 | Train Loss: 0.0835274 Vali Loss: 0.1495457 Test Loss: 0.1378095
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 21 cost time: 0.9489998817443848
Epoch: 21, Steps: 64 | Train Loss: 0.0832846 Vali Loss: 0.1486590 Test Loss: 0.1374936
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 22 cost time: 0.9380147457122803
Epoch: 22, Steps: 64 | Train Loss: 0.0831625 Vali Loss: 0.1489558 Test Loss: 0.1376496
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 23 cost time: 0.9276437759399414
Epoch: 23, Steps: 64 | Train Loss: 0.0830196 Vali Loss: 0.1487089 Test Loss: 0.1381124
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 24 cost time: 0.9274675846099854
Epoch: 24, Steps: 64 | Train Loss: 0.0822634 Vali Loss: 0.1494900 Test Loss: 0.1379244
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 25 cost time: 0.9323604106903076
Epoch: 25, Steps: 64 | Train Loss: 0.0826873 Vali Loss: 0.1479724 Test Loss: 0.1377516
Validation loss decreased (0.148626 --> 0.147972).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 26 cost time: 0.9553728103637695
Epoch: 26, Steps: 64 | Train Loss: 0.0817794 Vali Loss: 0.1485337 Test Loss: 0.1374068
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 27 cost time: 0.9464607238769531
Epoch: 27, Steps: 64 | Train Loss: 0.0822732 Vali Loss: 0.1492050 Test Loss: 0.1380989
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 28 cost time: 0.951552152633667
Epoch: 28, Steps: 64 | Train Loss: 0.0817484 Vali Loss: 0.1482329 Test Loss: 0.1384804
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 29 cost time: 0.9534392356872559
Epoch: 29, Steps: 64 | Train Loss: 0.0818564 Vali Loss: 0.1473667 Test Loss: 0.1377673
Validation loss decreased (0.147972 --> 0.147367).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 30 cost time: 0.9659998416900635
Epoch: 30, Steps: 64 | Train Loss: 0.0817737 Vali Loss: 0.1476982 Test Loss: 0.1374327
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 31 cost time: 0.9586126804351807
Epoch: 31, Steps: 64 | Train Loss: 0.0817314 Vali Loss: 0.1482345 Test Loss: 0.1377244
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 32 cost time: 0.9613373279571533
Epoch: 32, Steps: 64 | Train Loss: 0.0815820 Vali Loss: 0.1480493 Test Loss: 0.1372876
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 33 cost time: 0.9573652744293213
Epoch: 33, Steps: 64 | Train Loss: 0.0813670 Vali Loss: 0.1469408 Test Loss: 0.1376535
Validation loss decreased (0.147367 --> 0.146941).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 34 cost time: 0.9684031009674072
Epoch: 34, Steps: 64 | Train Loss: 0.0813642 Vali Loss: 0.1480572 Test Loss: 0.1371469
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 35 cost time: 0.9819579124450684
Epoch: 35, Steps: 64 | Train Loss: 0.0812552 Vali Loss: 0.1461826 Test Loss: 0.1375149
Validation loss decreased (0.146941 --> 0.146183).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 36 cost time: 0.9825618267059326
Epoch: 36, Steps: 64 | Train Loss: 0.0810417 Vali Loss: 0.1454367 Test Loss: 0.1368052
Validation loss decreased (0.146183 --> 0.145437).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 37 cost time: 0.9777657985687256
Epoch: 37, Steps: 64 | Train Loss: 0.0810167 Vali Loss: 0.1474900 Test Loss: 0.1379474
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 38 cost time: 0.9748022556304932
Epoch: 38, Steps: 64 | Train Loss: 0.0811382 Vali Loss: 0.1480737 Test Loss: 0.1369584
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 39 cost time: 0.9483919143676758
Epoch: 39, Steps: 64 | Train Loss: 0.0809558 Vali Loss: 0.1475004 Test Loss: 0.1365692
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 40 cost time: 0.9166581630706787
Epoch: 40, Steps: 64 | Train Loss: 0.0810769 Vali Loss: 0.1451682 Test Loss: 0.1363898
Validation loss decreased (0.145437 --> 0.145168).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 41 cost time: 0.9265308380126953
Epoch: 41, Steps: 64 | Train Loss: 0.0810347 Vali Loss: 0.1464184 Test Loss: 0.1377973
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 42 cost time: 0.9333760738372803
Epoch: 42, Steps: 64 | Train Loss: 0.0808055 Vali Loss: 0.1474019 Test Loss: 0.1372329
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 43 cost time: 0.960385799407959
Epoch: 43, Steps: 64 | Train Loss: 0.0810536 Vali Loss: 0.1461448 Test Loss: 0.1371132
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 44 cost time: 0.9584846496582031
Epoch: 44, Steps: 64 | Train Loss: 0.0812796 Vali Loss: 0.1461545 Test Loss: 0.1376149
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 45 cost time: 0.9745473861694336
Epoch: 45, Steps: 64 | Train Loss: 0.0811326 Vali Loss: 0.1460747 Test Loss: 0.1373696
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 46 cost time: 0.9487535953521729
Epoch: 46, Steps: 64 | Train Loss: 0.0811864 Vali Loss: 0.1469975 Test Loss: 0.1366611
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 47 cost time: 0.9481692314147949
Epoch: 47, Steps: 64 | Train Loss: 0.0811822 Vali Loss: 0.1469882 Test Loss: 0.1377746
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 48 cost time: 0.930001974105835
Epoch: 48, Steps: 64 | Train Loss: 0.0811330 Vali Loss: 0.1464948 Test Loss: 0.1375838
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 49 cost time: 0.9626438617706299
Epoch: 49, Steps: 64 | Train Loss: 0.0810514 Vali Loss: 0.1470597 Test Loss: 0.1374578
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 50 cost time: 0.9637322425842285
Epoch: 50, Steps: 64 | Train Loss: 0.0810810 Vali Loss: 0.1465416 Test Loss: 0.1371212
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 51 cost time: 0.9697592258453369
Epoch: 51, Steps: 64 | Train Loss: 0.0809414 Vali Loss: 0.1481167 Test Loss: 0.1371193
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 52 cost time: 0.987473726272583
Epoch: 52, Steps: 64 | Train Loss: 0.0810299 Vali Loss: 0.1462047 Test Loss: 0.1369851
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 53 cost time: 0.9864013195037842
Epoch: 53, Steps: 64 | Train Loss: 0.0809587 Vali Loss: 0.1456308 Test Loss: 0.1368068
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 54 cost time: 0.9771037101745605
Epoch: 54, Steps: 64 | Train Loss: 0.0807587 Vali Loss: 0.1476185 Test Loss: 0.1374907
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 55 cost time: 0.9774069786071777
Epoch: 55, Steps: 64 | Train Loss: 0.0811548 Vali Loss: 0.1461113 Test Loss: 0.1377921
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 56 cost time: 0.9567768573760986
Epoch: 56, Steps: 64 | Train Loss: 0.0807112 Vali Loss: 0.1468919 Test Loss: 0.1380026
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 57 cost time: 0.952998161315918
Epoch: 57, Steps: 64 | Train Loss: 0.0807504 Vali Loss: 0.1471488 Test Loss: 0.1367894
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 58 cost time: 0.9506361484527588
Epoch: 58, Steps: 64 | Train Loss: 0.0807134 Vali Loss: 0.1483659 Test Loss: 0.1367743
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 59 cost time: 0.9353938102722168
Epoch: 59, Steps: 64 | Train Loss: 0.0809318 Vali Loss: 0.1462773 Test Loss: 0.1368939
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01860809326171875 GB
GPU已分配内存的峰值：0.06067037582397461 GB
Epoch: 60 cost time: 0.9533951282501221
Epoch: 60, Steps: 64 | Train Loss: 0.0810461 Vali Loss: 0.1472421 Test Loss: 0.1372788
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13638979196548462, mae:0.2681537866592407, rse:0.1965675950050354
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.05994129180908203 GB
Epoch: 1 cost time: 2.3961260318756104
Epoch: 1, Steps: 64 | Train Loss: 0.7566277 Vali Loss: 1.7784303 Test Loss: 3.2817707
Validation loss decreased (inf --> 1.778430).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 2 cost time: 0.9996423721313477
Epoch: 2, Steps: 64 | Train Loss: 0.4582823 Vali Loss: 0.4185822 Test Loss: 0.5220586
Validation loss decreased (1.778430 --> 0.418582).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 3 cost time: 0.9801931381225586
Epoch: 3, Steps: 64 | Train Loss: 0.1315244 Vali Loss: 0.1845121 Test Loss: 0.1706146
Validation loss decreased (0.418582 --> 0.184512).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 4 cost time: 0.9833681583404541
Epoch: 4, Steps: 64 | Train Loss: 0.1001940 Vali Loss: 0.1691029 Test Loss: 0.1517022
Validation loss decreased (0.184512 --> 0.169103).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 5 cost time: 0.9714517593383789
Epoch: 5, Steps: 64 | Train Loss: 0.0933006 Vali Loss: 0.1656901 Test Loss: 0.1451202
Validation loss decreased (0.169103 --> 0.165690).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 6 cost time: 0.9585070610046387
Epoch: 6, Steps: 64 | Train Loss: 0.0897210 Vali Loss: 0.1594838 Test Loss: 0.1409850
Validation loss decreased (0.165690 --> 0.159484).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 7 cost time: 0.9593627452850342
Epoch: 7, Steps: 64 | Train Loss: 0.0877630 Vali Loss: 0.1597913 Test Loss: 0.1407103
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 8 cost time: 0.9647505283355713
Epoch: 8, Steps: 64 | Train Loss: 0.0861990 Vali Loss: 0.1558677 Test Loss: 0.1399205
Validation loss decreased (0.159484 --> 0.155868).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 9 cost time: 0.9867768287658691
Epoch: 9, Steps: 64 | Train Loss: 0.0848142 Vali Loss: 0.1525319 Test Loss: 0.1382957
Validation loss decreased (0.155868 --> 0.152532).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 10 cost time: 1.0057291984558105
Epoch: 10, Steps: 64 | Train Loss: 0.0837239 Vali Loss: 0.1544002 Test Loss: 0.1396171
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 11 cost time: 1.014432430267334
Epoch: 11, Steps: 64 | Train Loss: 0.0833078 Vali Loss: 0.1522856 Test Loss: 0.1385641
Validation loss decreased (0.152532 --> 0.152286).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 12 cost time: 1.0163755416870117
Epoch: 12, Steps: 64 | Train Loss: 0.0823609 Vali Loss: 0.1534170 Test Loss: 0.1391987
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 13 cost time: 0.9986436367034912
Epoch: 13, Steps: 64 | Train Loss: 0.0821878 Vali Loss: 0.1497268 Test Loss: 0.1384007
Validation loss decreased (0.152286 --> 0.149727).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 14 cost time: 0.9936659336090088
Epoch: 14, Steps: 64 | Train Loss: 0.0813011 Vali Loss: 0.1483656 Test Loss: 0.1389949
Validation loss decreased (0.149727 --> 0.148366).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 15 cost time: 0.9976375102996826
Epoch: 15, Steps: 64 | Train Loss: 0.0811585 Vali Loss: 0.1489588 Test Loss: 0.1382889
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 16 cost time: 0.9944384098052979
Epoch: 16, Steps: 64 | Train Loss: 0.0805420 Vali Loss: 0.1481283 Test Loss: 0.1376094
Validation loss decreased (0.148366 --> 0.148128).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 17 cost time: 1.000375509262085
Epoch: 17, Steps: 64 | Train Loss: 0.0804553 Vali Loss: 0.1470048 Test Loss: 0.1372063
Validation loss decreased (0.148128 --> 0.147005).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 18 cost time: 1.011451005935669
Epoch: 18, Steps: 64 | Train Loss: 0.0802095 Vali Loss: 0.1477100 Test Loss: 0.1371363
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 19 cost time: 0.9894533157348633
Epoch: 19, Steps: 64 | Train Loss: 0.0796034 Vali Loss: 0.1461598 Test Loss: 0.1372605
Validation loss decreased (0.147005 --> 0.146160).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 20 cost time: 0.9810600280761719
Epoch: 20, Steps: 64 | Train Loss: 0.0796040 Vali Loss: 0.1464933 Test Loss: 0.1374383
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 21 cost time: 0.9803452491760254
Epoch: 21, Steps: 64 | Train Loss: 0.0789908 Vali Loss: 0.1455277 Test Loss: 0.1358817
Validation loss decreased (0.146160 --> 0.145528).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 22 cost time: 0.9613869190216064
Epoch: 22, Steps: 64 | Train Loss: 0.0786217 Vali Loss: 0.1437562 Test Loss: 0.1362471
Validation loss decreased (0.145528 --> 0.143756).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 23 cost time: 0.9608166217803955
Epoch: 23, Steps: 64 | Train Loss: 0.0785082 Vali Loss: 0.1452982 Test Loss: 0.1373211
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 24 cost time: 0.9604189395904541
Epoch: 24, Steps: 64 | Train Loss: 0.0786133 Vali Loss: 0.1446174 Test Loss: 0.1361295
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 25 cost time: 0.9786343574523926
Epoch: 25, Steps: 64 | Train Loss: 0.0783057 Vali Loss: 0.1445783 Test Loss: 0.1361901
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 26 cost time: 0.9846391677856445
Epoch: 26, Steps: 64 | Train Loss: 0.0783371 Vali Loss: 0.1428785 Test Loss: 0.1365235
Validation loss decreased (0.143756 --> 0.142878).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 27 cost time: 0.9883832931518555
Epoch: 27, Steps: 64 | Train Loss: 0.0783408 Vali Loss: 0.1451006 Test Loss: 0.1369308
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 28 cost time: 1.001077651977539
Epoch: 28, Steps: 64 | Train Loss: 0.0780849 Vali Loss: 0.1439842 Test Loss: 0.1368676
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 29 cost time: 1.0133748054504395
Epoch: 29, Steps: 64 | Train Loss: 0.0780607 Vali Loss: 0.1425395 Test Loss: 0.1358154
Validation loss decreased (0.142878 --> 0.142539).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 30 cost time: 0.9884417057037354
Epoch: 30, Steps: 64 | Train Loss: 0.0778038 Vali Loss: 0.1444019 Test Loss: 0.1358081
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 31 cost time: 0.9943954944610596
Epoch: 31, Steps: 64 | Train Loss: 0.0777714 Vali Loss: 0.1427179 Test Loss: 0.1364408
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 32 cost time: 1.002417802810669
Epoch: 32, Steps: 64 | Train Loss: 0.0777111 Vali Loss: 0.1439609 Test Loss: 0.1377716
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 33 cost time: 1.0095138549804688
Epoch: 33, Steps: 64 | Train Loss: 0.0773516 Vali Loss: 0.1432798 Test Loss: 0.1360289
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 34 cost time: 1.013444423675537
Epoch: 34, Steps: 64 | Train Loss: 0.0777121 Vali Loss: 0.1429577 Test Loss: 0.1363118
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 35 cost time: 1.0118176937103271
Epoch: 35, Steps: 64 | Train Loss: 0.0776593 Vali Loss: 0.1423566 Test Loss: 0.1359740
Validation loss decreased (0.142539 --> 0.142357).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 36 cost time: 1.0131990909576416
Epoch: 36, Steps: 64 | Train Loss: 0.0776420 Vali Loss: 0.1433561 Test Loss: 0.1362431
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 37 cost time: 0.9974579811096191
Epoch: 37, Steps: 64 | Train Loss: 0.0773196 Vali Loss: 0.1422830 Test Loss: 0.1358287
Validation loss decreased (0.142357 --> 0.142283).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 38 cost time: 0.99399733543396
Epoch: 38, Steps: 64 | Train Loss: 0.0776212 Vali Loss: 0.1433870 Test Loss: 0.1356815
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 39 cost time: 1.0086126327514648
Epoch: 39, Steps: 64 | Train Loss: 0.0775132 Vali Loss: 0.1417194 Test Loss: 0.1365792
Validation loss decreased (0.142283 --> 0.141719).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 40 cost time: 1.0062685012817383
Epoch: 40, Steps: 64 | Train Loss: 0.0772226 Vali Loss: 0.1418031 Test Loss: 0.1351583
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 41 cost time: 0.9834649562835693
Epoch: 41, Steps: 64 | Train Loss: 0.0772220 Vali Loss: 0.1437709 Test Loss: 0.1368757
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 42 cost time: 0.9825229644775391
Epoch: 42, Steps: 64 | Train Loss: 0.0772949 Vali Loss: 0.1426478 Test Loss: 0.1366937
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 43 cost time: 0.9804306030273438
Epoch: 43, Steps: 64 | Train Loss: 0.0773091 Vali Loss: 0.1432584 Test Loss: 0.1366251
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 44 cost time: 0.9923932552337646
Epoch: 44, Steps: 64 | Train Loss: 0.0768104 Vali Loss: 0.1419662 Test Loss: 0.1357883
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 45 cost time: 0.989408016204834
Epoch: 45, Steps: 64 | Train Loss: 0.0774590 Vali Loss: 0.1412437 Test Loss: 0.1359539
Validation loss decreased (0.141719 --> 0.141244).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 46 cost time: 0.9843981266021729
Epoch: 46, Steps: 64 | Train Loss: 0.0770292 Vali Loss: 0.1409382 Test Loss: 0.1355655
Validation loss decreased (0.141244 --> 0.140938).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 47 cost time: 1.0014805793762207
Epoch: 47, Steps: 64 | Train Loss: 0.0772909 Vali Loss: 0.1421403 Test Loss: 0.1356068
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 48 cost time: 0.9971625804901123
Epoch: 48, Steps: 64 | Train Loss: 0.0768330 Vali Loss: 0.1426060 Test Loss: 0.1362860
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 49 cost time: 0.9938526153564453
Epoch: 49, Steps: 64 | Train Loss: 0.0771825 Vali Loss: 0.1415939 Test Loss: 0.1358348
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 50 cost time: 0.9990005493164062
Epoch: 50, Steps: 64 | Train Loss: 0.0770661 Vali Loss: 0.1427220 Test Loss: 0.1359963
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 51 cost time: 1.0268089771270752
Epoch: 51, Steps: 64 | Train Loss: 0.0772625 Vali Loss: 0.1411571 Test Loss: 0.1344586
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 52 cost time: 1.0071005821228027
Epoch: 52, Steps: 64 | Train Loss: 0.0772252 Vali Loss: 0.1430938 Test Loss: 0.1368939
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 53 cost time: 1.0126152038574219
Epoch: 53, Steps: 64 | Train Loss: 0.0768901 Vali Loss: 0.1424790 Test Loss: 0.1356685
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 54 cost time: 1.0081846714019775
Epoch: 54, Steps: 64 | Train Loss: 0.0769199 Vali Loss: 0.1419398 Test Loss: 0.1351765
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 55 cost time: 0.9844570159912109
Epoch: 55, Steps: 64 | Train Loss: 0.0769787 Vali Loss: 0.1423612 Test Loss: 0.1351291
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 56 cost time: 0.9624536037445068
Epoch: 56, Steps: 64 | Train Loss: 0.0770168 Vali Loss: 0.1426946 Test Loss: 0.1365383
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 57 cost time: 0.9774017333984375
Epoch: 57, Steps: 64 | Train Loss: 0.0772019 Vali Loss: 0.1415150 Test Loss: 0.1350477
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 58 cost time: 0.9653689861297607
Epoch: 58, Steps: 64 | Train Loss: 0.0771348 Vali Loss: 0.1397090 Test Loss: 0.1351510
Validation loss decreased (0.140938 --> 0.139709).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 59 cost time: 0.9954633712768555
Epoch: 59, Steps: 64 | Train Loss: 0.0771220 Vali Loss: 0.1425088 Test Loss: 0.1361686
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0186767578125 GB
GPU已分配内存的峰值：0.06218671798706055 GB
Epoch: 60 cost time: 0.9937334060668945
Epoch: 60, Steps: 64 | Train Loss: 0.0768441 Vali Loss: 0.1411815 Test Loss: 0.1355268
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13515104353427887, mae:0.26636895537376404, rse:0.1956728845834732
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.057550907135009766 GB
Epoch: 1 cost time: 2.326857089996338
Epoch: 1, Steps: 64 | Train Loss: 0.8858635 Vali Loss: 1.7109339 Test Loss: 3.2700396
Validation loss decreased (inf --> 1.710934).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 2 cost time: 0.9483499526977539
Epoch: 2, Steps: 64 | Train Loss: 0.4205248 Vali Loss: 0.2630845 Test Loss: 0.2515783
Validation loss decreased (1.710934 --> 0.263084).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 3 cost time: 0.9468715190887451
Epoch: 3, Steps: 64 | Train Loss: 0.1722071 Vali Loss: 0.1992158 Test Loss: 0.1699000
Validation loss decreased (0.263084 --> 0.199216).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 4 cost time: 0.9280014038085938
Epoch: 4, Steps: 64 | Train Loss: 0.1424827 Vali Loss: 0.1821225 Test Loss: 0.1569730
Validation loss decreased (0.199216 --> 0.182122).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 5 cost time: 0.9070005416870117
Epoch: 5, Steps: 64 | Train Loss: 0.1294759 Vali Loss: 0.1747089 Test Loss: 0.1512541
Validation loss decreased (0.182122 --> 0.174709).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 6 cost time: 0.9139735698699951
Epoch: 6, Steps: 64 | Train Loss: 0.1210990 Vali Loss: 0.1710723 Test Loss: 0.1475217
Validation loss decreased (0.174709 --> 0.171072).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 7 cost time: 0.9123680591583252
Epoch: 7, Steps: 64 | Train Loss: 0.1157563 Vali Loss: 0.1658954 Test Loss: 0.1438610
Validation loss decreased (0.171072 --> 0.165895).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 8 cost time: 0.9010319709777832
Epoch: 8, Steps: 64 | Train Loss: 0.1117891 Vali Loss: 0.1641994 Test Loss: 0.1422364
Validation loss decreased (0.165895 --> 0.164199).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 9 cost time: 0.9183697700500488
Epoch: 9, Steps: 64 | Train Loss: 0.1091779 Vali Loss: 0.1624112 Test Loss: 0.1409983
Validation loss decreased (0.164199 --> 0.162411).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 10 cost time: 0.9424312114715576
Epoch: 10, Steps: 64 | Train Loss: 0.1070463 Vali Loss: 0.1623913 Test Loss: 0.1409530
Validation loss decreased (0.162411 --> 0.162391).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 11 cost time: 0.9461178779602051
Epoch: 11, Steps: 64 | Train Loss: 0.1048788 Vali Loss: 0.1611933 Test Loss: 0.1400689
Validation loss decreased (0.162391 --> 0.161193).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 12 cost time: 0.9549999237060547
Epoch: 12, Steps: 64 | Train Loss: 0.1033780 Vali Loss: 0.1576330 Test Loss: 0.1396036
Validation loss decreased (0.161193 --> 0.157633).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 13 cost time: 0.9569995403289795
Epoch: 13, Steps: 64 | Train Loss: 0.1019267 Vali Loss: 0.1613352 Test Loss: 0.1395474
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 14 cost time: 0.9466443061828613
Epoch: 14, Steps: 64 | Train Loss: 0.1013465 Vali Loss: 0.1582478 Test Loss: 0.1385606
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 15 cost time: 0.9318723678588867
Epoch: 15, Steps: 64 | Train Loss: 0.1002725 Vali Loss: 0.1582573 Test Loss: 0.1385784
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 16 cost time: 0.9308123588562012
Epoch: 16, Steps: 64 | Train Loss: 0.0995088 Vali Loss: 0.1557351 Test Loss: 0.1378023
Validation loss decreased (0.157633 --> 0.155735).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 17 cost time: 0.9311692714691162
Epoch: 17, Steps: 64 | Train Loss: 0.0986929 Vali Loss: 0.1565603 Test Loss: 0.1378907
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 18 cost time: 0.9493908882141113
Epoch: 18, Steps: 64 | Train Loss: 0.0982888 Vali Loss: 0.1553120 Test Loss: 0.1378051
Validation loss decreased (0.155735 --> 0.155312).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 19 cost time: 0.9496562480926514
Epoch: 19, Steps: 64 | Train Loss: 0.0981147 Vali Loss: 0.1555611 Test Loss: 0.1377490
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 20 cost time: 0.9523482322692871
Epoch: 20, Steps: 64 | Train Loss: 0.0974239 Vali Loss: 0.1573248 Test Loss: 0.1383887
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 21 cost time: 0.9179990291595459
Epoch: 21, Steps: 64 | Train Loss: 0.0970977 Vali Loss: 0.1531281 Test Loss: 0.1370956
Validation loss decreased (0.155312 --> 0.153128).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 22 cost time: 0.9136519432067871
Epoch: 22, Steps: 64 | Train Loss: 0.0964655 Vali Loss: 0.1554193 Test Loss: 0.1378132
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 23 cost time: 0.9069836139678955
Epoch: 23, Steps: 64 | Train Loss: 0.0965557 Vali Loss: 0.1540027 Test Loss: 0.1368869
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 24 cost time: 0.9122180938720703
Epoch: 24, Steps: 64 | Train Loss: 0.0955174 Vali Loss: 0.1544459 Test Loss: 0.1373608
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 25 cost time: 0.9394347667694092
Epoch: 25, Steps: 64 | Train Loss: 0.0955484 Vali Loss: 0.1558179 Test Loss: 0.1368620
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 26 cost time: 0.932457447052002
Epoch: 26, Steps: 64 | Train Loss: 0.0949740 Vali Loss: 0.1542623 Test Loss: 0.1366776
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 27 cost time: 0.9488296508789062
Epoch: 27, Steps: 64 | Train Loss: 0.0946081 Vali Loss: 0.1540999 Test Loss: 0.1366868
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 28 cost time: 0.920001745223999
Epoch: 28, Steps: 64 | Train Loss: 0.0945873 Vali Loss: 0.1531498 Test Loss: 0.1367122
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 29 cost time: 0.9293069839477539
Epoch: 29, Steps: 64 | Train Loss: 0.0946445 Vali Loss: 0.1520240 Test Loss: 0.1372155
Validation loss decreased (0.153128 --> 0.152024).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 30 cost time: 0.9238011837005615
Epoch: 30, Steps: 64 | Train Loss: 0.0942861 Vali Loss: 0.1538626 Test Loss: 0.1366773
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 31 cost time: 0.9353628158569336
Epoch: 31, Steps: 64 | Train Loss: 0.0945903 Vali Loss: 0.1529220 Test Loss: 0.1364467
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 32 cost time: 0.9344701766967773
Epoch: 32, Steps: 64 | Train Loss: 0.0936815 Vali Loss: 0.1540311 Test Loss: 0.1370182
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 33 cost time: 0.9317340850830078
Epoch: 33, Steps: 64 | Train Loss: 0.0933574 Vali Loss: 0.1536070 Test Loss: 0.1360354
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 34 cost time: 0.933774471282959
Epoch: 34, Steps: 64 | Train Loss: 0.0935206 Vali Loss: 0.1525839 Test Loss: 0.1359518
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 35 cost time: 0.9459993839263916
Epoch: 35, Steps: 64 | Train Loss: 0.0937930 Vali Loss: 0.1536930 Test Loss: 0.1367034
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 36 cost time: 0.9479997158050537
Epoch: 36, Steps: 64 | Train Loss: 0.0934847 Vali Loss: 0.1533113 Test Loss: 0.1364301
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 37 cost time: 0.9562854766845703
Epoch: 37, Steps: 64 | Train Loss: 0.0931366 Vali Loss: 0.1524510 Test Loss: 0.1360245
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 38 cost time: 0.9536118507385254
Epoch: 38, Steps: 64 | Train Loss: 0.0928219 Vali Loss: 0.1534352 Test Loss: 0.1366103
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 39 cost time: 0.9483349323272705
Epoch: 39, Steps: 64 | Train Loss: 0.0929640 Vali Loss: 0.1526462 Test Loss: 0.1355098
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 40 cost time: 0.9333603382110596
Epoch: 40, Steps: 64 | Train Loss: 0.0933728 Vali Loss: 0.1529979 Test Loss: 0.1364146
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 41 cost time: 0.9104735851287842
Epoch: 41, Steps: 64 | Train Loss: 0.0931968 Vali Loss: 0.1526563 Test Loss: 0.1365980
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 42 cost time: 0.9447579383850098
Epoch: 42, Steps: 64 | Train Loss: 0.0932456 Vali Loss: 0.1508787 Test Loss: 0.1359836
Validation loss decreased (0.152024 --> 0.150879).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 43 cost time: 0.9388055801391602
Epoch: 43, Steps: 64 | Train Loss: 0.0931188 Vali Loss: 0.1501707 Test Loss: 0.1360638
Validation loss decreased (0.150879 --> 0.150171).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 44 cost time: 0.9539988040924072
Epoch: 44, Steps: 64 | Train Loss: 0.0926298 Vali Loss: 0.1512053 Test Loss: 0.1361998
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 45 cost time: 0.9356327056884766
Epoch: 45, Steps: 64 | Train Loss: 0.0931669 Vali Loss: 0.1532033 Test Loss: 0.1358844
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 46 cost time: 0.9365420341491699
Epoch: 46, Steps: 64 | Train Loss: 0.0932595 Vali Loss: 0.1549981 Test Loss: 0.1370807
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 47 cost time: 0.9230222702026367
Epoch: 47, Steps: 64 | Train Loss: 0.0928562 Vali Loss: 0.1531349 Test Loss: 0.1367225
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 48 cost time: 0.9234364032745361
Epoch: 48, Steps: 64 | Train Loss: 0.0930359 Vali Loss: 0.1517576 Test Loss: 0.1361584
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 49 cost time: 0.9145216941833496
Epoch: 49, Steps: 64 | Train Loss: 0.0930978 Vali Loss: 0.1525208 Test Loss: 0.1363154
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 50 cost time: 0.9099264144897461
Epoch: 50, Steps: 64 | Train Loss: 0.0926658 Vali Loss: 0.1526496 Test Loss: 0.1359231
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 51 cost time: 0.9274210929870605
Epoch: 51, Steps: 64 | Train Loss: 0.0927013 Vali Loss: 0.1528472 Test Loss: 0.1362021
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 52 cost time: 0.9459984302520752
Epoch: 52, Steps: 64 | Train Loss: 0.0924097 Vali Loss: 0.1518968 Test Loss: 0.1362951
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 53 cost time: 0.9526352882385254
Epoch: 53, Steps: 64 | Train Loss: 0.0926656 Vali Loss: 0.1513639 Test Loss: 0.1369893
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 54 cost time: 0.9450809955596924
Epoch: 54, Steps: 64 | Train Loss: 0.0927683 Vali Loss: 0.1519712 Test Loss: 0.1356674
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 55 cost time: 0.9624054431915283
Epoch: 55, Steps: 64 | Train Loss: 0.0926363 Vali Loss: 0.1529803 Test Loss: 0.1361413
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 56 cost time: 0.9473667144775391
Epoch: 56, Steps: 64 | Train Loss: 0.0925305 Vali Loss: 0.1538909 Test Loss: 0.1364257
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 57 cost time: 0.9262378215789795
Epoch: 57, Steps: 64 | Train Loss: 0.0927413 Vali Loss: 0.1510164 Test Loss: 0.1357745
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 58 cost time: 0.935859203338623
Epoch: 58, Steps: 64 | Train Loss: 0.0927186 Vali Loss: 0.1509136 Test Loss: 0.1354479
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 59 cost time: 0.9473671913146973
Epoch: 59, Steps: 64 | Train Loss: 0.0925183 Vali Loss: 0.1523014 Test Loss: 0.1359679
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018484115600585938 GB
GPU已分配内存的峰值：0.05927276611328125 GB
Epoch: 60 cost time: 0.9480013847351074
Epoch: 60, Steps: 64 | Train Loss: 0.0923725 Vali Loss: 0.1498871 Test Loss: 0.1361671
Validation loss decreased (0.150171 --> 0.149887).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13616707921028137, mae:0.26268041133880615, rse:0.1964070200920105
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.05898284912109375 GB
Epoch: 1 cost time: 2.3567428588867188
Epoch: 1, Steps: 64 | Train Loss: 0.9474879 Vali Loss: 2.0687635 Test Loss: 4.0142612
Validation loss decreased (inf --> 2.068763).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 2 cost time: 0.9643783569335938
Epoch: 2, Steps: 64 | Train Loss: 0.4866748 Vali Loss: 0.4503890 Test Loss: 0.5755244
Validation loss decreased (2.068763 --> 0.450389).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 3 cost time: 0.9700002670288086
Epoch: 3, Steps: 64 | Train Loss: 0.1559847 Vali Loss: 0.2291061 Test Loss: 0.1898764
Validation loss decreased (0.450389 --> 0.229106).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 4 cost time: 0.9661107063293457
Epoch: 4, Steps: 64 | Train Loss: 0.1105863 Vali Loss: 0.1851863 Test Loss: 0.1542800
Validation loss decreased (0.229106 --> 0.185186).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 5 cost time: 0.9466323852539062
Epoch: 5, Steps: 64 | Train Loss: 0.1016720 Vali Loss: 0.1713465 Test Loss: 0.1437571
Validation loss decreased (0.185186 --> 0.171347).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 6 cost time: 0.9384188652038574
Epoch: 6, Steps: 64 | Train Loss: 0.0972072 Vali Loss: 0.1620036 Test Loss: 0.1403877
Validation loss decreased (0.171347 --> 0.162004).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 7 cost time: 0.9404556751251221
Epoch: 7, Steps: 64 | Train Loss: 0.0943308 Vali Loss: 0.1590569 Test Loss: 0.1372274
Validation loss decreased (0.162004 --> 0.159057).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 8 cost time: 0.9487402439117432
Epoch: 8, Steps: 64 | Train Loss: 0.0923756 Vali Loss: 0.1573786 Test Loss: 0.1363993
Validation loss decreased (0.159057 --> 0.157379).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 9 cost time: 0.962416410446167
Epoch: 9, Steps: 64 | Train Loss: 0.0908161 Vali Loss: 0.1540573 Test Loss: 0.1352160
Validation loss decreased (0.157379 --> 0.154057).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 10 cost time: 0.9763493537902832
Epoch: 10, Steps: 64 | Train Loss: 0.0892429 Vali Loss: 0.1522149 Test Loss: 0.1341568
Validation loss decreased (0.154057 --> 0.152215).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 11 cost time: 0.9993875026702881
Epoch: 11, Steps: 64 | Train Loss: 0.0883226 Vali Loss: 0.1517883 Test Loss: 0.1338384
Validation loss decreased (0.152215 --> 0.151788).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 12 cost time: 0.9881265163421631
Epoch: 12, Steps: 64 | Train Loss: 0.0872387 Vali Loss: 0.1520197 Test Loss: 0.1354199
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 13 cost time: 0.9686005115509033
Epoch: 13, Steps: 64 | Train Loss: 0.0867657 Vali Loss: 0.1493811 Test Loss: 0.1333359
Validation loss decreased (0.151788 --> 0.149381).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 14 cost time: 0.9619982242584229
Epoch: 14, Steps: 64 | Train Loss: 0.0859039 Vali Loss: 0.1466017 Test Loss: 0.1334765
Validation loss decreased (0.149381 --> 0.146602).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 15 cost time: 0.9626500606536865
Epoch: 15, Steps: 64 | Train Loss: 0.0850626 Vali Loss: 0.1457732 Test Loss: 0.1325377
Validation loss decreased (0.146602 --> 0.145773).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 16 cost time: 0.9606211185455322
Epoch: 16, Steps: 64 | Train Loss: 0.0845085 Vali Loss: 0.1458291 Test Loss: 0.1323272
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 17 cost time: 0.9774856567382812
Epoch: 17, Steps: 64 | Train Loss: 0.0840888 Vali Loss: 0.1461950 Test Loss: 0.1331600
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 18 cost time: 1.0054361820220947
Epoch: 18, Steps: 64 | Train Loss: 0.0837325 Vali Loss: 0.1431512 Test Loss: 0.1315579
Validation loss decreased (0.145773 --> 0.143151).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 19 cost time: 0.9884724617004395
Epoch: 19, Steps: 64 | Train Loss: 0.0832725 Vali Loss: 0.1427083 Test Loss: 0.1312324
Validation loss decreased (0.143151 --> 0.142708).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 20 cost time: 0.9689896106719971
Epoch: 20, Steps: 64 | Train Loss: 0.0831358 Vali Loss: 0.1432422 Test Loss: 0.1318154
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 21 cost time: 0.9676368236541748
Epoch: 21, Steps: 64 | Train Loss: 0.0827157 Vali Loss: 0.1424621 Test Loss: 0.1310598
Validation loss decreased (0.142708 --> 0.142462).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 22 cost time: 0.9307847023010254
Epoch: 22, Steps: 64 | Train Loss: 0.0821848 Vali Loss: 0.1397368 Test Loss: 0.1307169
Validation loss decreased (0.142462 --> 0.139737).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 23 cost time: 0.9448904991149902
Epoch: 23, Steps: 64 | Train Loss: 0.0822324 Vali Loss: 0.1424499 Test Loss: 0.1312240
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 24 cost time: 0.9453768730163574
Epoch: 24, Steps: 64 | Train Loss: 0.0818885 Vali Loss: 0.1412203 Test Loss: 0.1304406
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 25 cost time: 0.939643144607544
Epoch: 25, Steps: 64 | Train Loss: 0.0814462 Vali Loss: 0.1417185 Test Loss: 0.1312706
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 26 cost time: 0.9594039916992188
Epoch: 26, Steps: 64 | Train Loss: 0.0816402 Vali Loss: 0.1411903 Test Loss: 0.1308320
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 27 cost time: 0.9604313373565674
Epoch: 27, Steps: 64 | Train Loss: 0.0811503 Vali Loss: 0.1418717 Test Loss: 0.1314570
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 28 cost time: 0.937981367111206
Epoch: 28, Steps: 64 | Train Loss: 0.0810657 Vali Loss: 0.1416137 Test Loss: 0.1323945
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 29 cost time: 0.9243643283843994
Epoch: 29, Steps: 64 | Train Loss: 0.0812809 Vali Loss: 0.1404824 Test Loss: 0.1314318
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 30 cost time: 0.9724273681640625
Epoch: 30, Steps: 64 | Train Loss: 0.0809961 Vali Loss: 0.1399493 Test Loss: 0.1318789
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 31 cost time: 0.9729423522949219
Epoch: 31, Steps: 64 | Train Loss: 0.0809598 Vali Loss: 0.1392551 Test Loss: 0.1309175
Validation loss decreased (0.139737 --> 0.139255).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 32 cost time: 0.9584219455718994
Epoch: 32, Steps: 64 | Train Loss: 0.0806272 Vali Loss: 0.1416277 Test Loss: 0.1312579
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 33 cost time: 0.9639999866485596
Epoch: 33, Steps: 64 | Train Loss: 0.0808996 Vali Loss: 0.1395603 Test Loss: 0.1301191
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 34 cost time: 0.982536792755127
Epoch: 34, Steps: 64 | Train Loss: 0.0805614 Vali Loss: 0.1400899 Test Loss: 0.1306776
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 35 cost time: 0.9931027889251709
Epoch: 35, Steps: 64 | Train Loss: 0.0804423 Vali Loss: 0.1412616 Test Loss: 0.1315785
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 36 cost time: 0.9925940036773682
Epoch: 36, Steps: 64 | Train Loss: 0.0807224 Vali Loss: 0.1399650 Test Loss: 0.1311935
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 37 cost time: 0.9873306751251221
Epoch: 37, Steps: 64 | Train Loss: 0.0801862 Vali Loss: 0.1404178 Test Loss: 0.1310582
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 38 cost time: 0.9774036407470703
Epoch: 38, Steps: 64 | Train Loss: 0.0806427 Vali Loss: 0.1380303 Test Loss: 0.1301355
Validation loss decreased (0.139255 --> 0.138030).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 39 cost time: 0.952540397644043
Epoch: 39, Steps: 64 | Train Loss: 0.0803725 Vali Loss: 0.1386593 Test Loss: 0.1305449
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 40 cost time: 0.9423904418945312
Epoch: 40, Steps: 64 | Train Loss: 0.0801770 Vali Loss: 0.1398457 Test Loss: 0.1315129
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 41 cost time: 0.9464869499206543
Epoch: 41, Steps: 64 | Train Loss: 0.0803113 Vali Loss: 0.1399956 Test Loss: 0.1311229
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 42 cost time: 0.9497373104095459
Epoch: 42, Steps: 64 | Train Loss: 0.0803423 Vali Loss: 0.1395274 Test Loss: 0.1307446
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 43 cost time: 0.9679968357086182
Epoch: 43, Steps: 64 | Train Loss: 0.0800407 Vali Loss: 0.1390406 Test Loss: 0.1304633
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 44 cost time: 0.9574346542358398
Epoch: 44, Steps: 64 | Train Loss: 0.0800115 Vali Loss: 0.1382896 Test Loss: 0.1307457
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 45 cost time: 0.9646506309509277
Epoch: 45, Steps: 64 | Train Loss: 0.0800421 Vali Loss: 0.1397558 Test Loss: 0.1299294
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 46 cost time: 0.9584188461303711
Epoch: 46, Steps: 64 | Train Loss: 0.0797621 Vali Loss: 0.1380774 Test Loss: 0.1307492
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 47 cost time: 0.9519758224487305
Epoch: 47, Steps: 64 | Train Loss: 0.0798987 Vali Loss: 0.1376424 Test Loss: 0.1307428
Validation loss decreased (0.138030 --> 0.137642).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 48 cost time: 0.9545178413391113
Epoch: 48, Steps: 64 | Train Loss: 0.0797485 Vali Loss: 0.1389478 Test Loss: 0.1312522
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 49 cost time: 0.9621522426605225
Epoch: 49, Steps: 64 | Train Loss: 0.0797694 Vali Loss: 0.1405796 Test Loss: 0.1315749
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 50 cost time: 0.9654850959777832
Epoch: 50, Steps: 64 | Train Loss: 0.0799450 Vali Loss: 0.1374726 Test Loss: 0.1309329
Validation loss decreased (0.137642 --> 0.137473).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 51 cost time: 0.999830961227417
Epoch: 51, Steps: 64 | Train Loss: 0.0801977 Vali Loss: 0.1399282 Test Loss: 0.1316553
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 52 cost time: 0.9945616722106934
Epoch: 52, Steps: 64 | Train Loss: 0.0799837 Vali Loss: 0.1387444 Test Loss: 0.1307824
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 53 cost time: 0.9806380271911621
Epoch: 53, Steps: 64 | Train Loss: 0.0798227 Vali Loss: 0.1386953 Test Loss: 0.1306625
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 54 cost time: 0.9840002059936523
Epoch: 54, Steps: 64 | Train Loss: 0.0799233 Vali Loss: 0.1388585 Test Loss: 0.1309094
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 55 cost time: 0.961637020111084
Epoch: 55, Steps: 64 | Train Loss: 0.0797279 Vali Loss: 0.1382626 Test Loss: 0.1305360
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 56 cost time: 0.9673645496368408
Epoch: 56, Steps: 64 | Train Loss: 0.0799856 Vali Loss: 0.1387272 Test Loss: 0.1299360
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 57 cost time: 0.9626219272613525
Epoch: 57, Steps: 64 | Train Loss: 0.0797476 Vali Loss: 0.1386759 Test Loss: 0.1302319
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 58 cost time: 0.9514377117156982
Epoch: 58, Steps: 64 | Train Loss: 0.0800682 Vali Loss: 0.1399240 Test Loss: 0.1306653
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 59 cost time: 0.9663956165313721
Epoch: 59, Steps: 64 | Train Loss: 0.0798876 Vali Loss: 0.1385413 Test Loss: 0.1303497
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018613815307617188 GB
GPU已分配内存的峰值：0.06083488464355469 GB
Epoch: 60 cost time: 0.9724023342132568
Epoch: 60, Steps: 64 | Train Loss: 0.0795121 Vali Loss: 0.1386191 Test Loss: 0.1305754
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13093295693397522, mae:0.25745394825935364, rse:0.1925952136516571
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.06010293960571289 GB
Epoch: 1 cost time: 2.4056200981140137
Epoch: 1, Steps: 64 | Train Loss: 0.7415132 Vali Loss: 1.7271343 Test Loss: 3.2323461
Validation loss decreased (inf --> 1.727134).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 2 cost time: 0.9914116859436035
Epoch: 2, Steps: 64 | Train Loss: 0.4331873 Vali Loss: 0.3498970 Test Loss: 0.3912918
Validation loss decreased (1.727134 --> 0.349897).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 3 cost time: 0.9925885200500488
Epoch: 3, Steps: 64 | Train Loss: 0.1229068 Vali Loss: 0.1782036 Test Loss: 0.1498191
Validation loss decreased (0.349897 --> 0.178204).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 4 cost time: 0.9924557209014893
Epoch: 4, Steps: 64 | Train Loss: 0.0985601 Vali Loss: 0.1720535 Test Loss: 0.1460684
Validation loss decreased (0.178204 --> 0.172054).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 5 cost time: 0.9574129581451416
Epoch: 5, Steps: 64 | Train Loss: 0.0923688 Vali Loss: 0.1659656 Test Loss: 0.1423149
Validation loss decreased (0.172054 --> 0.165966).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 6 cost time: 0.955406665802002
Epoch: 6, Steps: 64 | Train Loss: 0.0900385 Vali Loss: 0.1615251 Test Loss: 0.1390583
Validation loss decreased (0.165966 --> 0.161525).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 7 cost time: 0.9637558460235596
Epoch: 7, Steps: 64 | Train Loss: 0.0881997 Vali Loss: 0.1605701 Test Loss: 0.1383264
Validation loss decreased (0.161525 --> 0.160570).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 8 cost time: 0.9691081047058105
Epoch: 8, Steps: 64 | Train Loss: 0.0868466 Vali Loss: 0.1596277 Test Loss: 0.1379524
Validation loss decreased (0.160570 --> 0.159628).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 9 cost time: 0.9863970279693604
Epoch: 9, Steps: 64 | Train Loss: 0.0851475 Vali Loss: 0.1575507 Test Loss: 0.1368672
Validation loss decreased (0.159628 --> 0.157551).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 10 cost time: 1.0046532154083252
Epoch: 10, Steps: 64 | Train Loss: 0.0849448 Vali Loss: 0.1573781 Test Loss: 0.1371571
Validation loss decreased (0.157551 --> 0.157378).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 11 cost time: 1.0146114826202393
Epoch: 11, Steps: 64 | Train Loss: 0.0841489 Vali Loss: 0.1538778 Test Loss: 0.1365972
Validation loss decreased (0.157378 --> 0.153878).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 12 cost time: 1.0135407447814941
Epoch: 12, Steps: 64 | Train Loss: 0.0835185 Vali Loss: 0.1537893 Test Loss: 0.1362786
Validation loss decreased (0.153878 --> 0.153789).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 13 cost time: 0.9999709129333496
Epoch: 13, Steps: 64 | Train Loss: 0.0827725 Vali Loss: 0.1528081 Test Loss: 0.1351766
Validation loss decreased (0.153789 --> 0.152808).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 14 cost time: 1.00152587890625
Epoch: 14, Steps: 64 | Train Loss: 0.0828215 Vali Loss: 0.1513686 Test Loss: 0.1360830
Validation loss decreased (0.152808 --> 0.151369).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 15 cost time: 0.9949445724487305
Epoch: 15, Steps: 64 | Train Loss: 0.0821122 Vali Loss: 0.1507873 Test Loss: 0.1352671
Validation loss decreased (0.151369 --> 0.150787).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 16 cost time: 0.9943661689758301
Epoch: 16, Steps: 64 | Train Loss: 0.0819129 Vali Loss: 0.1526820 Test Loss: 0.1358079
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 17 cost time: 1.0154039859771729
Epoch: 17, Steps: 64 | Train Loss: 0.0814267 Vali Loss: 0.1521217 Test Loss: 0.1357560
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 18 cost time: 1.013439416885376
Epoch: 18, Steps: 64 | Train Loss: 0.0813445 Vali Loss: 0.1506018 Test Loss: 0.1346304
Validation loss decreased (0.150787 --> 0.150602).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 19 cost time: 1.0075173377990723
Epoch: 19, Steps: 64 | Train Loss: 0.0811705 Vali Loss: 0.1488066 Test Loss: 0.1345083
Validation loss decreased (0.150602 --> 0.148807).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 20 cost time: 0.9895129203796387
Epoch: 20, Steps: 64 | Train Loss: 0.0807873 Vali Loss: 0.1488789 Test Loss: 0.1346999
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 21 cost time: 0.9597523212432861
Epoch: 21, Steps: 64 | Train Loss: 0.0805952 Vali Loss: 0.1510327 Test Loss: 0.1348181
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 22 cost time: 0.9688146114349365
Epoch: 22, Steps: 64 | Train Loss: 0.0803772 Vali Loss: 0.1506411 Test Loss: 0.1345077
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 23 cost time: 0.9599997997283936
Epoch: 23, Steps: 64 | Train Loss: 0.0803191 Vali Loss: 0.1477718 Test Loss: 0.1345246
Validation loss decreased (0.148807 --> 0.147772).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 24 cost time: 0.961266040802002
Epoch: 24, Steps: 64 | Train Loss: 0.0802396 Vali Loss: 0.1507647 Test Loss: 0.1349255
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 25 cost time: 0.9764676094055176
Epoch: 25, Steps: 64 | Train Loss: 0.0797362 Vali Loss: 0.1494393 Test Loss: 0.1343501
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 26 cost time: 0.9932444095611572
Epoch: 26, Steps: 64 | Train Loss: 0.0798561 Vali Loss: 0.1474801 Test Loss: 0.1342164
Validation loss decreased (0.147772 --> 0.147480).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 27 cost time: 0.9980871677398682
Epoch: 27, Steps: 64 | Train Loss: 0.0794588 Vali Loss: 0.1484244 Test Loss: 0.1336994
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 28 cost time: 0.9882655143737793
Epoch: 28, Steps: 64 | Train Loss: 0.0790390 Vali Loss: 0.1475809 Test Loss: 0.1335426
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 29 cost time: 1.0013964176177979
Epoch: 29, Steps: 64 | Train Loss: 0.0793125 Vali Loss: 0.1473181 Test Loss: 0.1343369
Validation loss decreased (0.147480 --> 0.147318).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 30 cost time: 0.9994120597839355
Epoch: 30, Steps: 64 | Train Loss: 0.0791468 Vali Loss: 0.1469592 Test Loss: 0.1335644
Validation loss decreased (0.147318 --> 0.146959).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 31 cost time: 0.9954471588134766
Epoch: 31, Steps: 64 | Train Loss: 0.0795693 Vali Loss: 0.1454440 Test Loss: 0.1335977
Validation loss decreased (0.146959 --> 0.145444).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 32 cost time: 0.9974033832550049
Epoch: 32, Steps: 64 | Train Loss: 0.0791593 Vali Loss: 0.1471749 Test Loss: 0.1343591
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 33 cost time: 1.0664341449737549
Epoch: 33, Steps: 64 | Train Loss: 0.0792031 Vali Loss: 0.1458586 Test Loss: 0.1333276
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 34 cost time: 1.0265514850616455
Epoch: 34, Steps: 64 | Train Loss: 0.0788970 Vali Loss: 0.1437775 Test Loss: 0.1337828
Validation loss decreased (0.145444 --> 0.143778).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 35 cost time: 1.0180063247680664
Epoch: 35, Steps: 64 | Train Loss: 0.0788781 Vali Loss: 0.1458288 Test Loss: 0.1337217
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 36 cost time: 1.0288217067718506
Epoch: 36, Steps: 64 | Train Loss: 0.0789961 Vali Loss: 0.1447859 Test Loss: 0.1335361
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 37 cost time: 1.0107550621032715
Epoch: 37, Steps: 64 | Train Loss: 0.0788124 Vali Loss: 0.1460965 Test Loss: 0.1333197
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 38 cost time: 0.987999677658081
Epoch: 38, Steps: 64 | Train Loss: 0.0783442 Vali Loss: 0.1457911 Test Loss: 0.1330101
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 39 cost time: 0.9806404113769531
Epoch: 39, Steps: 64 | Train Loss: 0.0789636 Vali Loss: 0.1461553 Test Loss: 0.1332485
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 40 cost time: 0.9493808746337891
Epoch: 40, Steps: 64 | Train Loss: 0.0788097 Vali Loss: 0.1470597 Test Loss: 0.1335670
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 41 cost time: 0.9726223945617676
Epoch: 41, Steps: 64 | Train Loss: 0.0786959 Vali Loss: 0.1467416 Test Loss: 0.1340211
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 42 cost time: 1.001276969909668
Epoch: 42, Steps: 64 | Train Loss: 0.0786502 Vali Loss: 0.1445095 Test Loss: 0.1329819
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 43 cost time: 0.9804105758666992
Epoch: 43, Steps: 64 | Train Loss: 0.0785771 Vali Loss: 0.1457593 Test Loss: 0.1329960
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 44 cost time: 1.0034148693084717
Epoch: 44, Steps: 64 | Train Loss: 0.0786224 Vali Loss: 0.1455237 Test Loss: 0.1347782
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 45 cost time: 0.9983868598937988
Epoch: 45, Steps: 64 | Train Loss: 0.0784886 Vali Loss: 0.1447694 Test Loss: 0.1337678
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 46 cost time: 0.9888145923614502
Epoch: 46, Steps: 64 | Train Loss: 0.0783750 Vali Loss: 0.1454147 Test Loss: 0.1335621
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 47 cost time: 0.9917347431182861
Epoch: 47, Steps: 64 | Train Loss: 0.0784977 Vali Loss: 0.1457108 Test Loss: 0.1333833
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 48 cost time: 1.0028016567230225
Epoch: 48, Steps: 64 | Train Loss: 0.0780357 Vali Loss: 0.1458621 Test Loss: 0.1335115
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 49 cost time: 1.0099999904632568
Epoch: 49, Steps: 64 | Train Loss: 0.0785382 Vali Loss: 0.1462472 Test Loss: 0.1329708
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 50 cost time: 1.0114684104919434
Epoch: 50, Steps: 64 | Train Loss: 0.0786028 Vali Loss: 0.1431551 Test Loss: 0.1330900
Validation loss decreased (0.143778 --> 0.143155).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 51 cost time: 1.0126464366912842
Epoch: 51, Steps: 64 | Train Loss: 0.0786028 Vali Loss: 0.1444272 Test Loss: 0.1332182
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 52 cost time: 1.0106546878814697
Epoch: 52, Steps: 64 | Train Loss: 0.0783473 Vali Loss: 0.1464349 Test Loss: 0.1337640
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 53 cost time: 1.0171256065368652
Epoch: 53, Steps: 64 | Train Loss: 0.0786795 Vali Loss: 0.1473312 Test Loss: 0.1332107
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 54 cost time: 0.9923102855682373
Epoch: 54, Steps: 64 | Train Loss: 0.0786114 Vali Loss: 0.1461522 Test Loss: 0.1324632
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 55 cost time: 0.9982433319091797
Epoch: 55, Steps: 64 | Train Loss: 0.0786603 Vali Loss: 0.1449118 Test Loss: 0.1325112
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 56 cost time: 1.0005614757537842
Epoch: 56, Steps: 64 | Train Loss: 0.0782200 Vali Loss: 0.1457040 Test Loss: 0.1336895
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 57 cost time: 0.9784343242645264
Epoch: 57, Steps: 64 | Train Loss: 0.0785294 Vali Loss: 0.1446990 Test Loss: 0.1329482
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 58 cost time: 0.995018720626831
Epoch: 58, Steps: 64 | Train Loss: 0.0784073 Vali Loss: 0.1456889 Test Loss: 0.1332459
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 59 cost time: 1.0053772926330566
Epoch: 59, Steps: 64 | Train Loss: 0.0782719 Vali Loss: 0.1457703 Test Loss: 0.1334306
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018682479858398438 GB
GPU已分配内存的峰值：0.062351226806640625 GB
Epoch: 60 cost time: 0.9994080066680908
Epoch: 60, Steps: 64 | Train Loss: 0.0780076 Vali Loss: 0.1450939 Test Loss: 0.1328682
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1330900490283966, mae:0.26234492659568787, rse:0.19417521357536316
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05771303176879883 GB
Epoch: 1 cost time: 2.346242666244507
Epoch: 1, Steps: 64 | Train Loss: 1.1155293 Vali Loss: 2.2252572 Test Loss: 4.2173095
Validation loss decreased (inf --> 2.225257).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 2 cost time: 0.954514741897583
Epoch: 2, Steps: 64 | Train Loss: 0.5282039 Vali Loss: 0.3481837 Test Loss: 0.3895232
Validation loss decreased (2.225257 --> 0.348184).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 3 cost time: 0.9464869499206543
Epoch: 3, Steps: 64 | Train Loss: 0.1937653 Vali Loss: 0.2395177 Test Loss: 0.2042599
Validation loss decreased (0.348184 --> 0.239518).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 4 cost time: 0.9367539882659912
Epoch: 4, Steps: 64 | Train Loss: 0.1472617 Vali Loss: 0.2074789 Test Loss: 0.1681554
Validation loss decreased (0.239518 --> 0.207479).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 5 cost time: 0.9169995784759521
Epoch: 5, Steps: 64 | Train Loss: 0.1304298 Vali Loss: 0.1892419 Test Loss: 0.1547289
Validation loss decreased (0.207479 --> 0.189242).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 6 cost time: 0.9450335502624512
Epoch: 6, Steps: 64 | Train Loss: 0.1216990 Vali Loss: 0.1773058 Test Loss: 0.1485958
Validation loss decreased (0.189242 --> 0.177306).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 7 cost time: 0.9126365184783936
Epoch: 7, Steps: 64 | Train Loss: 0.1165613 Vali Loss: 0.1723838 Test Loss: 0.1459752
Validation loss decreased (0.177306 --> 0.172384).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 8 cost time: 0.9064247608184814
Epoch: 8, Steps: 64 | Train Loss: 0.1130880 Vali Loss: 0.1701245 Test Loss: 0.1447083
Validation loss decreased (0.172384 --> 0.170125).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 9 cost time: 0.9414041042327881
Epoch: 9, Steps: 64 | Train Loss: 0.1096962 Vali Loss: 0.1637063 Test Loss: 0.1426578
Validation loss decreased (0.170125 --> 0.163706).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 10 cost time: 0.9484882354736328
Epoch: 10, Steps: 64 | Train Loss: 0.1078720 Vali Loss: 0.1639950 Test Loss: 0.1427682
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 11 cost time: 0.965425968170166
Epoch: 11, Steps: 64 | Train Loss: 0.1058904 Vali Loss: 0.1631558 Test Loss: 0.1424492
Validation loss decreased (0.163706 --> 0.163156).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 12 cost time: 0.9714503288269043
Epoch: 12, Steps: 64 | Train Loss: 0.1037959 Vali Loss: 0.1613629 Test Loss: 0.1421843
Validation loss decreased (0.163156 --> 0.161363).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 13 cost time: 0.959151029586792
Epoch: 13, Steps: 64 | Train Loss: 0.1025768 Vali Loss: 0.1591662 Test Loss: 0.1421805
Validation loss decreased (0.161363 --> 0.159166).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 14 cost time: 0.9437911510467529
Epoch: 14, Steps: 64 | Train Loss: 0.1017259 Vali Loss: 0.1573178 Test Loss: 0.1404832
Validation loss decreased (0.159166 --> 0.157318).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 15 cost time: 0.944998025894165
Epoch: 15, Steps: 64 | Train Loss: 0.1005578 Vali Loss: 0.1564561 Test Loss: 0.1405405
Validation loss decreased (0.157318 --> 0.156456).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 16 cost time: 0.9416458606719971
Epoch: 16, Steps: 64 | Train Loss: 0.0998055 Vali Loss: 0.1560827 Test Loss: 0.1414394
Validation loss decreased (0.156456 --> 0.156083).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 17 cost time: 0.9384651184082031
Epoch: 17, Steps: 64 | Train Loss: 0.0983004 Vali Loss: 0.1551611 Test Loss: 0.1406998
Validation loss decreased (0.156083 --> 0.155161).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 18 cost time: 0.9685459136962891
Epoch: 18, Steps: 64 | Train Loss: 0.0977217 Vali Loss: 0.1552859 Test Loss: 0.1397838
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 19 cost time: 0.9743847846984863
Epoch: 19, Steps: 64 | Train Loss: 0.0984688 Vali Loss: 0.1558840 Test Loss: 0.1401292
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 20 cost time: 0.973149299621582
Epoch: 20, Steps: 64 | Train Loss: 0.0968919 Vali Loss: 0.1556089 Test Loss: 0.1404847
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 21 cost time: 0.9339606761932373
Epoch: 21, Steps: 64 | Train Loss: 0.0962653 Vali Loss: 0.1551017 Test Loss: 0.1410446
Validation loss decreased (0.155161 --> 0.155102).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 22 cost time: 0.9302055835723877
Epoch: 22, Steps: 64 | Train Loss: 0.0964605 Vali Loss: 0.1525407 Test Loss: 0.1397619
Validation loss decreased (0.155102 --> 0.152541).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 23 cost time: 0.9244387149810791
Epoch: 23, Steps: 64 | Train Loss: 0.0954151 Vali Loss: 0.1525725 Test Loss: 0.1398592
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 24 cost time: 0.9209985733032227
Epoch: 24, Steps: 64 | Train Loss: 0.0951840 Vali Loss: 0.1536976 Test Loss: 0.1390610
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 25 cost time: 0.9236359596252441
Epoch: 25, Steps: 64 | Train Loss: 0.0954721 Vali Loss: 0.1529572 Test Loss: 0.1401152
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 26 cost time: 0.9482080936431885
Epoch: 26, Steps: 64 | Train Loss: 0.0950417 Vali Loss: 0.1507002 Test Loss: 0.1392844
Validation loss decreased (0.152541 --> 0.150700).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 27 cost time: 0.9401431083679199
Epoch: 27, Steps: 64 | Train Loss: 0.0947113 Vali Loss: 0.1526636 Test Loss: 0.1398871
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 28 cost time: 0.9445233345031738
Epoch: 28, Steps: 64 | Train Loss: 0.0946471 Vali Loss: 0.1533429 Test Loss: 0.1406575
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 29 cost time: 0.9313638210296631
Epoch: 29, Steps: 64 | Train Loss: 0.0941257 Vali Loss: 0.1534563 Test Loss: 0.1397763
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 30 cost time: 0.9596505165100098
Epoch: 30, Steps: 64 | Train Loss: 0.0941566 Vali Loss: 0.1523548 Test Loss: 0.1397870
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 31 cost time: 0.9637799263000488
Epoch: 31, Steps: 64 | Train Loss: 0.0932841 Vali Loss: 0.1538785 Test Loss: 0.1401450
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 32 cost time: 0.9676258563995361
Epoch: 32, Steps: 64 | Train Loss: 0.0935813 Vali Loss: 0.1522500 Test Loss: 0.1398024
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 33 cost time: 0.9396085739135742
Epoch: 33, Steps: 64 | Train Loss: 0.0933751 Vali Loss: 0.1532400 Test Loss: 0.1398995
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 34 cost time: 0.9486398696899414
Epoch: 34, Steps: 64 | Train Loss: 0.0929984 Vali Loss: 0.1520607 Test Loss: 0.1389698
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 35 cost time: 0.9634363651275635
Epoch: 35, Steps: 64 | Train Loss: 0.0934509 Vali Loss: 0.1543084 Test Loss: 0.1406297
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 36 cost time: 0.9752421379089355
Epoch: 36, Steps: 64 | Train Loss: 0.0932898 Vali Loss: 0.1530243 Test Loss: 0.1391258
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 37 cost time: 0.9614272117614746
Epoch: 37, Steps: 64 | Train Loss: 0.0926324 Vali Loss: 0.1522213 Test Loss: 0.1398132
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 38 cost time: 0.9653887748718262
Epoch: 38, Steps: 64 | Train Loss: 0.0933986 Vali Loss: 0.1526635 Test Loss: 0.1396590
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 39 cost time: 0.9603683948516846
Epoch: 39, Steps: 64 | Train Loss: 0.0931400 Vali Loss: 0.1505342 Test Loss: 0.1390275
Validation loss decreased (0.150700 --> 0.150534).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 40 cost time: 0.9422752857208252
Epoch: 40, Steps: 64 | Train Loss: 0.0930640 Vali Loss: 0.1511480 Test Loss: 0.1399031
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 41 cost time: 0.9390108585357666
Epoch: 41, Steps: 64 | Train Loss: 0.0930091 Vali Loss: 0.1522723 Test Loss: 0.1400481
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 42 cost time: 0.9240045547485352
Epoch: 42, Steps: 64 | Train Loss: 0.0925590 Vali Loss: 0.1515560 Test Loss: 0.1396835
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 43 cost time: 0.9426507949829102
Epoch: 43, Steps: 64 | Train Loss: 0.0928210 Vali Loss: 0.1506905 Test Loss: 0.1394981
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 44 cost time: 0.9382846355438232
Epoch: 44, Steps: 64 | Train Loss: 0.0925014 Vali Loss: 0.1528557 Test Loss: 0.1401493
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 45 cost time: 0.941429615020752
Epoch: 45, Steps: 64 | Train Loss: 0.0925911 Vali Loss: 0.1497152 Test Loss: 0.1393872
Validation loss decreased (0.150534 --> 0.149715).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 46 cost time: 0.9493672847747803
Epoch: 46, Steps: 64 | Train Loss: 0.0922148 Vali Loss: 0.1505553 Test Loss: 0.1395084
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 47 cost time: 0.9193892478942871
Epoch: 47, Steps: 64 | Train Loss: 0.0924132 Vali Loss: 0.1506191 Test Loss: 0.1394233
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 48 cost time: 0.9177520275115967
Epoch: 48, Steps: 64 | Train Loss: 0.0922972 Vali Loss: 0.1525903 Test Loss: 0.1395305
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 49 cost time: 0.9299087524414062
Epoch: 49, Steps: 64 | Train Loss: 0.0925847 Vali Loss: 0.1512259 Test Loss: 0.1393639
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 50 cost time: 0.9212868213653564
Epoch: 50, Steps: 64 | Train Loss: 0.0926129 Vali Loss: 0.1527867 Test Loss: 0.1403525
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 51 cost time: 0.9516158103942871
Epoch: 51, Steps: 64 | Train Loss: 0.0927417 Vali Loss: 0.1520694 Test Loss: 0.1392137
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 52 cost time: 0.9624366760253906
Epoch: 52, Steps: 64 | Train Loss: 0.0929792 Vali Loss: 0.1508570 Test Loss: 0.1392627
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 53 cost time: 0.9683597087860107
Epoch: 53, Steps: 64 | Train Loss: 0.0925829 Vali Loss: 0.1526732 Test Loss: 0.1396157
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 54 cost time: 0.9633755683898926
Epoch: 54, Steps: 64 | Train Loss: 0.0926321 Vali Loss: 0.1517563 Test Loss: 0.1398214
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 55 cost time: 0.9523861408233643
Epoch: 55, Steps: 64 | Train Loss: 0.0921709 Vali Loss: 0.1498629 Test Loss: 0.1393119
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 56 cost time: 0.9494030475616455
Epoch: 56, Steps: 64 | Train Loss: 0.0923342 Vali Loss: 0.1499536 Test Loss: 0.1390638
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 57 cost time: 0.9377329349517822
Epoch: 57, Steps: 64 | Train Loss: 0.0926791 Vali Loss: 0.1512091 Test Loss: 0.1400113
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 58 cost time: 0.9389998912811279
Epoch: 58, Steps: 64 | Train Loss: 0.0922826 Vali Loss: 0.1523276 Test Loss: 0.1396299
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 59 cost time: 0.9450013637542725
Epoch: 59, Steps: 64 | Train Loss: 0.0929150 Vali Loss: 0.1498443 Test Loss: 0.1398827
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018491744995117188 GB
GPU已分配内存的峰值：0.05943870544433594 GB
Epoch: 60 cost time: 0.9616208076477051
Epoch: 60, Steps: 64 | Train Loss: 0.0924279 Vali Loss: 0.1503087 Test Loss: 0.1390647
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13938722014427185, mae:0.26784878969192505, rse:0.19871583580970764
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.05914497375488281 GB
Epoch: 1 cost time: 2.369391441345215
Epoch: 1, Steps: 64 | Train Loss: 0.7090645 Vali Loss: 1.4931458 Test Loss: 2.8153887
Validation loss decreased (inf --> 1.493146).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 2 cost time: 1.0118117332458496
Epoch: 2, Steps: 64 | Train Loss: 0.3162136 Vali Loss: 0.2197088 Test Loss: 0.1861597
Validation loss decreased (1.493146 --> 0.219709).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 3 cost time: 0.9799997806549072
Epoch: 3, Steps: 64 | Train Loss: 0.1190093 Vali Loss: 0.1820765 Test Loss: 0.1476345
Validation loss decreased (0.219709 --> 0.182077).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 4 cost time: 0.9776504039764404
Epoch: 4, Steps: 64 | Train Loss: 0.1048784 Vali Loss: 0.1671825 Test Loss: 0.1427891
Validation loss decreased (0.182077 --> 0.167183).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 5 cost time: 0.9360876083374023
Epoch: 5, Steps: 64 | Train Loss: 0.0985442 Vali Loss: 0.1611969 Test Loss: 0.1390665
Validation loss decreased (0.167183 --> 0.161197).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 6 cost time: 0.9524133205413818
Epoch: 6, Steps: 64 | Train Loss: 0.0953431 Vali Loss: 0.1592313 Test Loss: 0.1386174
Validation loss decreased (0.161197 --> 0.159231).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 7 cost time: 0.956458330154419
Epoch: 7, Steps: 64 | Train Loss: 0.0929065 Vali Loss: 0.1588064 Test Loss: 0.1375385
Validation loss decreased (0.159231 --> 0.158806).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 8 cost time: 0.9543642997741699
Epoch: 8, Steps: 64 | Train Loss: 0.0910466 Vali Loss: 0.1563976 Test Loss: 0.1361160
Validation loss decreased (0.158806 --> 0.156398).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 9 cost time: 0.9814648628234863
Epoch: 9, Steps: 64 | Train Loss: 0.0893080 Vali Loss: 0.1551238 Test Loss: 0.1360148
Validation loss decreased (0.156398 --> 0.155124).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 10 cost time: 0.983349084854126
Epoch: 10, Steps: 64 | Train Loss: 0.0883221 Vali Loss: 0.1520742 Test Loss: 0.1350602
Validation loss decreased (0.155124 --> 0.152074).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 11 cost time: 1.003394603729248
Epoch: 11, Steps: 64 | Train Loss: 0.0870403 Vali Loss: 0.1519866 Test Loss: 0.1353399
Validation loss decreased (0.152074 --> 0.151987).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 12 cost time: 1.0168225765228271
Epoch: 12, Steps: 64 | Train Loss: 0.0862428 Vali Loss: 0.1523573 Test Loss: 0.1358594
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 13 cost time: 0.9707729816436768
Epoch: 13, Steps: 64 | Train Loss: 0.0858387 Vali Loss: 0.1507747 Test Loss: 0.1356357
Validation loss decreased (0.151987 --> 0.150775).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 14 cost time: 0.980445146560669
Epoch: 14, Steps: 64 | Train Loss: 0.0852787 Vali Loss: 0.1499402 Test Loss: 0.1353084
Validation loss decreased (0.150775 --> 0.149940).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 15 cost time: 0.9829998016357422
Epoch: 15, Steps: 64 | Train Loss: 0.0846607 Vali Loss: 0.1489927 Test Loss: 0.1350699
Validation loss decreased (0.149940 --> 0.148993).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 16 cost time: 0.9916341304779053
Epoch: 16, Steps: 64 | Train Loss: 0.0839077 Vali Loss: 0.1450409 Test Loss: 0.1331914
Validation loss decreased (0.148993 --> 0.145041).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 17 cost time: 0.995631217956543
Epoch: 17, Steps: 64 | Train Loss: 0.0837015 Vali Loss: 0.1458249 Test Loss: 0.1339203
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 18 cost time: 1.0018131732940674
Epoch: 18, Steps: 64 | Train Loss: 0.0831532 Vali Loss: 0.1469791 Test Loss: 0.1340718
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 19 cost time: 0.9873661994934082
Epoch: 19, Steps: 64 | Train Loss: 0.0829816 Vali Loss: 0.1440108 Test Loss: 0.1350305
Validation loss decreased (0.145041 --> 0.144011).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 20 cost time: 0.9754176139831543
Epoch: 20, Steps: 64 | Train Loss: 0.0821665 Vali Loss: 0.1444359 Test Loss: 0.1342511
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 21 cost time: 0.9613656997680664
Epoch: 21, Steps: 64 | Train Loss: 0.0825486 Vali Loss: 0.1452535 Test Loss: 0.1343513
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 22 cost time: 0.9883809089660645
Epoch: 22, Steps: 64 | Train Loss: 0.0821360 Vali Loss: 0.1434819 Test Loss: 0.1336862
Validation loss decreased (0.144011 --> 0.143482).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 23 cost time: 0.997434139251709
Epoch: 23, Steps: 64 | Train Loss: 0.0816794 Vali Loss: 0.1428650 Test Loss: 0.1332579
Validation loss decreased (0.143482 --> 0.142865).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 24 cost time: 0.99639892578125
Epoch: 24, Steps: 64 | Train Loss: 0.0814431 Vali Loss: 0.1405966 Test Loss: 0.1334333
Validation loss decreased (0.142865 --> 0.140597).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 25 cost time: 0.996821403503418
Epoch: 25, Steps: 64 | Train Loss: 0.0812363 Vali Loss: 0.1419812 Test Loss: 0.1329745
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 26 cost time: 0.9798898696899414
Epoch: 26, Steps: 64 | Train Loss: 0.0813212 Vali Loss: 0.1415482 Test Loss: 0.1332007
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 27 cost time: 0.9739987850189209
Epoch: 27, Steps: 64 | Train Loss: 0.0812087 Vali Loss: 0.1417818 Test Loss: 0.1331102
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 28 cost time: 0.9849984645843506
Epoch: 28, Steps: 64 | Train Loss: 0.0810871 Vali Loss: 0.1394931 Test Loss: 0.1323599
Validation loss decreased (0.140597 --> 0.139493).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 29 cost time: 0.9656434059143066
Epoch: 29, Steps: 64 | Train Loss: 0.0809425 Vali Loss: 0.1404466 Test Loss: 0.1325324
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 30 cost time: 0.9697580337524414
Epoch: 30, Steps: 64 | Train Loss: 0.0808781 Vali Loss: 0.1408114 Test Loss: 0.1327390
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 31 cost time: 0.9793622493743896
Epoch: 31, Steps: 64 | Train Loss: 0.0806635 Vali Loss: 0.1412542 Test Loss: 0.1328427
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 32 cost time: 0.9944167137145996
Epoch: 32, Steps: 64 | Train Loss: 0.0806110 Vali Loss: 0.1411382 Test Loss: 0.1329112
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 33 cost time: 0.984400749206543
Epoch: 33, Steps: 64 | Train Loss: 0.0804602 Vali Loss: 0.1427497 Test Loss: 0.1329208
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 34 cost time: 0.9981417655944824
Epoch: 34, Steps: 64 | Train Loss: 0.0805348 Vali Loss: 0.1423100 Test Loss: 0.1330142
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 35 cost time: 1.0063304901123047
Epoch: 35, Steps: 64 | Train Loss: 0.0801165 Vali Loss: 0.1409990 Test Loss: 0.1330253
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 36 cost time: 0.996962308883667
Epoch: 36, Steps: 64 | Train Loss: 0.0802443 Vali Loss: 0.1404000 Test Loss: 0.1335429
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 37 cost time: 1.0018343925476074
Epoch: 37, Steps: 64 | Train Loss: 0.0802664 Vali Loss: 0.1418863 Test Loss: 0.1335936
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 38 cost time: 0.9911847114562988
Epoch: 38, Steps: 64 | Train Loss: 0.0803578 Vali Loss: 0.1423681 Test Loss: 0.1331215
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 39 cost time: 0.9624624252319336
Epoch: 39, Steps: 64 | Train Loss: 0.0801633 Vali Loss: 0.1396387 Test Loss: 0.1323378
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 40 cost time: 0.9508926868438721
Epoch: 40, Steps: 64 | Train Loss: 0.0802785 Vali Loss: 0.1378319 Test Loss: 0.1332919
Validation loss decreased (0.139493 --> 0.137832).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 41 cost time: 0.9546356201171875
Epoch: 41, Steps: 64 | Train Loss: 0.0800336 Vali Loss: 0.1413102 Test Loss: 0.1340524
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 42 cost time: 0.9690983295440674
Epoch: 42, Steps: 64 | Train Loss: 0.0802243 Vali Loss: 0.1424492 Test Loss: 0.1346129
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 43 cost time: 0.9714107513427734
Epoch: 43, Steps: 64 | Train Loss: 0.0802559 Vali Loss: 0.1398225 Test Loss: 0.1323989
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 44 cost time: 0.980353593826294
Epoch: 44, Steps: 64 | Train Loss: 0.0797735 Vali Loss: 0.1402913 Test Loss: 0.1325851
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 45 cost time: 0.9794294834136963
Epoch: 45, Steps: 64 | Train Loss: 0.0801079 Vali Loss: 0.1405415 Test Loss: 0.1334906
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 46 cost time: 0.9644753932952881
Epoch: 46, Steps: 64 | Train Loss: 0.0796677 Vali Loss: 0.1416811 Test Loss: 0.1338657
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 47 cost time: 0.9650163650512695
Epoch: 47, Steps: 64 | Train Loss: 0.0797211 Vali Loss: 0.1398355 Test Loss: 0.1325941
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 48 cost time: 0.9647543430328369
Epoch: 48, Steps: 64 | Train Loss: 0.0799831 Vali Loss: 0.1412120 Test Loss: 0.1331081
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 49 cost time: 0.9832334518432617
Epoch: 49, Steps: 64 | Train Loss: 0.0797972 Vali Loss: 0.1383757 Test Loss: 0.1332901
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 50 cost time: 1.0099999904632568
Epoch: 50, Steps: 64 | Train Loss: 0.0799647 Vali Loss: 0.1399463 Test Loss: 0.1322077
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 51 cost time: 0.9960095882415771
Epoch: 51, Steps: 64 | Train Loss: 0.0796805 Vali Loss: 0.1404440 Test Loss: 0.1339586
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 52 cost time: 1.0016436576843262
Epoch: 52, Steps: 64 | Train Loss: 0.0798627 Vali Loss: 0.1388736 Test Loss: 0.1335907
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 53 cost time: 1.0024425983428955
Epoch: 53, Steps: 64 | Train Loss: 0.0796645 Vali Loss: 0.1396503 Test Loss: 0.1336638
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 54 cost time: 0.972400426864624
Epoch: 54, Steps: 64 | Train Loss: 0.0798798 Vali Loss: 0.1412996 Test Loss: 0.1338310
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 55 cost time: 0.9789767265319824
Epoch: 55, Steps: 64 | Train Loss: 0.0799848 Vali Loss: 0.1406617 Test Loss: 0.1324694
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 56 cost time: 0.9745182991027832
Epoch: 56, Steps: 64 | Train Loss: 0.0799375 Vali Loss: 0.1405693 Test Loss: 0.1330997
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 57 cost time: 0.9775505065917969
Epoch: 57, Steps: 64 | Train Loss: 0.0797258 Vali Loss: 0.1391477 Test Loss: 0.1334472
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 58 cost time: 0.9844183921813965
Epoch: 58, Steps: 64 | Train Loss: 0.0795161 Vali Loss: 0.1401364 Test Loss: 0.1326281
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 59 cost time: 0.9830451011657715
Epoch: 59, Steps: 64 | Train Loss: 0.0798677 Vali Loss: 0.1409576 Test Loss: 0.1336833
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018621444702148438 GB
GPU已分配内存的峰值：0.061000823974609375 GB
Epoch: 60 cost time: 0.981525182723999
Epoch: 60, Steps: 64 | Train Loss: 0.0795237 Vali Loss: 0.1390017 Test Loss: 0.1328000
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13329188525676727, mae:0.2590393126010895, rse:0.1943223774433136
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=1, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp1_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06026506423950195 GB
Epoch: 1 cost time: 2.3803045749664307
Epoch: 1, Steps: 64 | Train Loss: 0.8220617 Vali Loss: 1.8716909 Test Loss: 3.5966957
Validation loss decreased (inf --> 1.871691).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 2 cost time: 0.9891893863677979
Epoch: 2, Steps: 64 | Train Loss: 0.4548249 Vali Loss: 0.3706419 Test Loss: 0.4729171
Validation loss decreased (1.871691 --> 0.370642).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 3 cost time: 1.0003728866577148
Epoch: 3, Steps: 64 | Train Loss: 0.1296436 Vali Loss: 0.1961548 Test Loss: 0.1742765
Validation loss decreased (0.370642 --> 0.196155).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 4 cost time: 0.9933719635009766
Epoch: 4, Steps: 64 | Train Loss: 0.0997765 Vali Loss: 0.1737768 Test Loss: 0.1587857
Validation loss decreased (0.196155 --> 0.173777).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 5 cost time: 0.9627947807312012
Epoch: 5, Steps: 64 | Train Loss: 0.0933237 Vali Loss: 0.1668494 Test Loss: 0.1472651
Validation loss decreased (0.173777 --> 0.166849).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 6 cost time: 0.9540002346038818
Epoch: 6, Steps: 64 | Train Loss: 0.0903558 Vali Loss: 0.1611553 Test Loss: 0.1429856
Validation loss decreased (0.166849 --> 0.161155).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 7 cost time: 0.9687464237213135
Epoch: 7, Steps: 64 | Train Loss: 0.0880133 Vali Loss: 0.1565934 Test Loss: 0.1405626
Validation loss decreased (0.161155 --> 0.156593).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 8 cost time: 0.9646522998809814
Epoch: 8, Steps: 64 | Train Loss: 0.0862819 Vali Loss: 0.1573260 Test Loss: 0.1407581
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 9 cost time: 0.9951183795928955
Epoch: 9, Steps: 64 | Train Loss: 0.0851046 Vali Loss: 0.1550116 Test Loss: 0.1401121
Validation loss decreased (0.156593 --> 0.155012).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 10 cost time: 1.0110981464385986
Epoch: 10, Steps: 64 | Train Loss: 0.0840782 Vali Loss: 0.1525226 Test Loss: 0.1386282
Validation loss decreased (0.155012 --> 0.152523).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 11 cost time: 1.0270981788635254
Epoch: 11, Steps: 64 | Train Loss: 0.0832518 Vali Loss: 0.1532716 Test Loss: 0.1393132
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 12 cost time: 1.017348289489746
Epoch: 12, Steps: 64 | Train Loss: 0.0828884 Vali Loss: 0.1493339 Test Loss: 0.1375710
Validation loss decreased (0.152523 --> 0.149334).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 13 cost time: 1.0174412727355957
Epoch: 13, Steps: 64 | Train Loss: 0.0818059 Vali Loss: 0.1523389 Test Loss: 0.1387718
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 14 cost time: 1.0004699230194092
Epoch: 14, Steps: 64 | Train Loss: 0.0817406 Vali Loss: 0.1500498 Test Loss: 0.1385171
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 15 cost time: 0.9941990375518799
Epoch: 15, Steps: 64 | Train Loss: 0.0815140 Vali Loss: 0.1493960 Test Loss: 0.1377172
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 16 cost time: 0.9964306354522705
Epoch: 16, Steps: 64 | Train Loss: 0.0807137 Vali Loss: 0.1480708 Test Loss: 0.1379580
Validation loss decreased (0.149334 --> 0.148071).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 17 cost time: 1.0035004615783691
Epoch: 17, Steps: 64 | Train Loss: 0.0806275 Vali Loss: 0.1476984 Test Loss: 0.1377850
Validation loss decreased (0.148071 --> 0.147698).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 18 cost time: 1.0227370262145996
Epoch: 18, Steps: 64 | Train Loss: 0.0801385 Vali Loss: 0.1462099 Test Loss: 0.1368813
Validation loss decreased (0.147698 --> 0.146210).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 19 cost time: 1.0164008140563965
Epoch: 19, Steps: 64 | Train Loss: 0.0799865 Vali Loss: 0.1461981 Test Loss: 0.1366698
Validation loss decreased (0.146210 --> 0.146198).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 20 cost time: 1.0113656520843506
Epoch: 20, Steps: 64 | Train Loss: 0.0798288 Vali Loss: 0.1474834 Test Loss: 0.1375905
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 21 cost time: 0.9607305526733398
Epoch: 21, Steps: 64 | Train Loss: 0.0794835 Vali Loss: 0.1440153 Test Loss: 0.1377144
Validation loss decreased (0.146198 --> 0.144015).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 22 cost time: 0.9879798889160156
Epoch: 22, Steps: 64 | Train Loss: 0.0789954 Vali Loss: 0.1453961 Test Loss: 0.1375995
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 23 cost time: 0.9666111469268799
Epoch: 23, Steps: 64 | Train Loss: 0.0788857 Vali Loss: 0.1455892 Test Loss: 0.1376928
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 24 cost time: 0.9596333503723145
Epoch: 24, Steps: 64 | Train Loss: 0.0784614 Vali Loss: 0.1440815 Test Loss: 0.1374860
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 25 cost time: 0.9893925189971924
Epoch: 25, Steps: 64 | Train Loss: 0.0789260 Vali Loss: 0.1450394 Test Loss: 0.1370775
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 26 cost time: 0.9944460391998291
Epoch: 26, Steps: 64 | Train Loss: 0.0781682 Vali Loss: 0.1433643 Test Loss: 0.1375239
Validation loss decreased (0.144015 --> 0.143364).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 27 cost time: 0.9482986927032471
Epoch: 27, Steps: 64 | Train Loss: 0.0782360 Vali Loss: 0.1429222 Test Loss: 0.1364613
Validation loss decreased (0.143364 --> 0.142922).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 28 cost time: 0.9894239902496338
Epoch: 28, Steps: 64 | Train Loss: 0.0780901 Vali Loss: 0.1420340 Test Loss: 0.1373278
Validation loss decreased (0.142922 --> 0.142034).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 29 cost time: 0.9940896034240723
Epoch: 29, Steps: 64 | Train Loss: 0.0780347 Vali Loss: 0.1426765 Test Loss: 0.1370203
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 30 cost time: 0.9983944892883301
Epoch: 30, Steps: 64 | Train Loss: 0.0776833 Vali Loss: 0.1419661 Test Loss: 0.1368071
Validation loss decreased (0.142034 --> 0.141966).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 31 cost time: 1.012451171875
Epoch: 31, Steps: 64 | Train Loss: 0.0778087 Vali Loss: 0.1403767 Test Loss: 0.1370812
Validation loss decreased (0.141966 --> 0.140377).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 32 cost time: 1.0084154605865479
Epoch: 32, Steps: 64 | Train Loss: 0.0775978 Vali Loss: 0.1420211 Test Loss: 0.1375227
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 33 cost time: 1.0191335678100586
Epoch: 33, Steps: 64 | Train Loss: 0.0777234 Vali Loss: 0.1434441 Test Loss: 0.1380382
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 34 cost time: 1.014815330505371
Epoch: 34, Steps: 64 | Train Loss: 0.0775154 Vali Loss: 0.1435137 Test Loss: 0.1377358
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 35 cost time: 1.0160002708435059
Epoch: 35, Steps: 64 | Train Loss: 0.0771843 Vali Loss: 0.1404665 Test Loss: 0.1380847
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 36 cost time: 1.0319993495941162
Epoch: 36, Steps: 64 | Train Loss: 0.0774934 Vali Loss: 0.1410759 Test Loss: 0.1375223
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 37 cost time: 1.011622667312622
Epoch: 37, Steps: 64 | Train Loss: 0.0772788 Vali Loss: 0.1417068 Test Loss: 0.1377813
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 38 cost time: 1.0063748359680176
Epoch: 38, Steps: 64 | Train Loss: 0.0775122 Vali Loss: 0.1420411 Test Loss: 0.1377268
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 39 cost time: 1.016638994216919
Epoch: 39, Steps: 64 | Train Loss: 0.0771593 Vali Loss: 0.1402406 Test Loss: 0.1364593
Validation loss decreased (0.140377 --> 0.140241).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 40 cost time: 0.9519674777984619
Epoch: 40, Steps: 64 | Train Loss: 0.0772948 Vali Loss: 0.1416787 Test Loss: 0.1363939
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 41 cost time: 0.9702768325805664
Epoch: 41, Steps: 64 | Train Loss: 0.0774518 Vali Loss: 0.1405185 Test Loss: 0.1364678
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 42 cost time: 0.9970297813415527
Epoch: 42, Steps: 64 | Train Loss: 0.0767530 Vali Loss: 0.1408179 Test Loss: 0.1367393
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 43 cost time: 1.001438856124878
Epoch: 43, Steps: 64 | Train Loss: 0.0768548 Vali Loss: 0.1396195 Test Loss: 0.1376586
Validation loss decreased (0.140241 --> 0.139620).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 44 cost time: 0.9869091510772705
Epoch: 44, Steps: 64 | Train Loss: 0.0770673 Vali Loss: 0.1403056 Test Loss: 0.1363975
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 45 cost time: 0.9690647125244141
Epoch: 45, Steps: 64 | Train Loss: 0.0769857 Vali Loss: 0.1406239 Test Loss: 0.1373921
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 46 cost time: 0.9734008312225342
Epoch: 46, Steps: 64 | Train Loss: 0.0771613 Vali Loss: 0.1395323 Test Loss: 0.1361055
Validation loss decreased (0.139620 --> 0.139532).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 47 cost time: 0.96376633644104
Epoch: 47, Steps: 64 | Train Loss: 0.0771594 Vali Loss: 0.1406381 Test Loss: 0.1372928
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 48 cost time: 0.9907526969909668
Epoch: 48, Steps: 64 | Train Loss: 0.0771671 Vali Loss: 0.1389933 Test Loss: 0.1368369
Validation loss decreased (0.139532 --> 0.138993).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 49 cost time: 1.009657859802246
Epoch: 49, Steps: 64 | Train Loss: 0.0768384 Vali Loss: 0.1417838 Test Loss: 0.1378860
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 50 cost time: 1.0109989643096924
Epoch: 50, Steps: 64 | Train Loss: 0.0769291 Vali Loss: 0.1391323 Test Loss: 0.1363990
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 51 cost time: 1.0166387557983398
Epoch: 51, Steps: 64 | Train Loss: 0.0771003 Vali Loss: 0.1403385 Test Loss: 0.1370007
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 52 cost time: 1.032637596130371
Epoch: 52, Steps: 64 | Train Loss: 0.0768292 Vali Loss: 0.1399636 Test Loss: 0.1373193
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 53 cost time: 1.007547378540039
Epoch: 53, Steps: 64 | Train Loss: 0.0771281 Vali Loss: 0.1413762 Test Loss: 0.1374980
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 54 cost time: 1.0008759498596191
Epoch: 54, Steps: 64 | Train Loss: 0.0769241 Vali Loss: 0.1391093 Test Loss: 0.1377036
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 55 cost time: 0.9893178939819336
Epoch: 55, Steps: 64 | Train Loss: 0.0768926 Vali Loss: 0.1394526 Test Loss: 0.1364124
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 56 cost time: 0.9854247570037842
Epoch: 56, Steps: 64 | Train Loss: 0.0771752 Vali Loss: 0.1389139 Test Loss: 0.1364112
Validation loss decreased (0.138993 --> 0.138914).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 57 cost time: 0.9814169406890869
Epoch: 57, Steps: 64 | Train Loss: 0.0769260 Vali Loss: 0.1418736 Test Loss: 0.1371351
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 58 cost time: 0.9947500228881836
Epoch: 58, Steps: 64 | Train Loss: 0.0769999 Vali Loss: 0.1402694 Test Loss: 0.1374477
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 59 cost time: 0.9959568977355957
Epoch: 59, Steps: 64 | Train Loss: 0.0769173 Vali Loss: 0.1380847 Test Loss: 0.1370276
Validation loss decreased (0.138914 --> 0.138085).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018690109252929688 GB
GPU已分配内存的峰值：0.06251716613769531 GB
Epoch: 60 cost time: 0.9943971633911133
Epoch: 60, Steps: 64 | Train Loss: 0.0767584 Vali Loss: 0.1397332 Test Loss: 0.1367054
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp1_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13702762126922607, mae:0.26846936345100403, rse:0.19702668488025665
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.045563697814941406 GB
Epoch: 1 cost time: 2.2546398639678955
Epoch: 1, Steps: 64 | Train Loss: 0.8178228 Vali Loss: 1.8489698 Test Loss: 3.4659092
Validation loss decreased (inf --> 1.848970).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 2 cost time: 0.8684611320495605
Epoch: 2, Steps: 64 | Train Loss: 0.7194555 Vali Loss: 1.4293638 Test Loss: 2.6344082
Validation loss decreased (1.848970 --> 1.429364).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 3 cost time: 0.859001874923706
Epoch: 3, Steps: 64 | Train Loss: 0.5689482 Vali Loss: 1.1131876 Test Loss: 1.9846295
Validation loss decreased (1.429364 --> 1.113188).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 4 cost time: 0.8540012836456299
Epoch: 4, Steps: 64 | Train Loss: 0.4492581 Vali Loss: 0.8810586 Test Loss: 1.5105479
Validation loss decreased (1.113188 --> 0.881059).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 5 cost time: 0.8432564735412598
Epoch: 5, Steps: 64 | Train Loss: 0.3586808 Vali Loss: 0.7184733 Test Loss: 1.1813430
Validation loss decreased (0.881059 --> 0.718473).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 6 cost time: 0.8364355564117432
Epoch: 6, Steps: 64 | Train Loss: 0.2929349 Vali Loss: 0.5961292 Test Loss: 0.9260103
Validation loss decreased (0.718473 --> 0.596129).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 7 cost time: 0.8374035358428955
Epoch: 7, Steps: 64 | Train Loss: 0.2463266 Vali Loss: 0.5033056 Test Loss: 0.7442662
Validation loss decreased (0.596129 --> 0.503306).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 8 cost time: 0.8327250480651855
Epoch: 8, Steps: 64 | Train Loss: 0.2126467 Vali Loss: 0.4313452 Test Loss: 0.6115970
Validation loss decreased (0.503306 --> 0.431345).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 9 cost time: 0.8558039665222168
Epoch: 9, Steps: 64 | Train Loss: 0.1876829 Vali Loss: 0.3785692 Test Loss: 0.5107225
Validation loss decreased (0.431345 --> 0.378569).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 10 cost time: 0.8646507263183594
Epoch: 10, Steps: 64 | Train Loss: 0.1695803 Vali Loss: 0.3422765 Test Loss: 0.4362301
Validation loss decreased (0.378569 --> 0.342277).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 11 cost time: 0.8630356788635254
Epoch: 11, Steps: 64 | Train Loss: 0.1560908 Vali Loss: 0.3108037 Test Loss: 0.3840700
Validation loss decreased (0.342277 --> 0.310804).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 12 cost time: 0.8884305953979492
Epoch: 12, Steps: 64 | Train Loss: 0.1458053 Vali Loss: 0.2921341 Test Loss: 0.3482724
Validation loss decreased (0.310804 --> 0.292134).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 13 cost time: 0.8878183364868164
Epoch: 13, Steps: 64 | Train Loss: 0.1385634 Vali Loss: 0.2719238 Test Loss: 0.3159398
Validation loss decreased (0.292134 --> 0.271924).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 14 cost time: 0.8790006637573242
Epoch: 14, Steps: 64 | Train Loss: 0.1322601 Vali Loss: 0.2614238 Test Loss: 0.2943892
Validation loss decreased (0.271924 --> 0.261424).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 15 cost time: 0.8724181652069092
Epoch: 15, Steps: 64 | Train Loss: 0.1274659 Vali Loss: 0.2500938 Test Loss: 0.2751223
Validation loss decreased (0.261424 --> 0.250094).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 16 cost time: 0.8765780925750732
Epoch: 16, Steps: 64 | Train Loss: 0.1241126 Vali Loss: 0.2399009 Test Loss: 0.2584387
Validation loss decreased (0.250094 --> 0.239901).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 17 cost time: 0.8644213676452637
Epoch: 17, Steps: 64 | Train Loss: 0.1205466 Vali Loss: 0.2338568 Test Loss: 0.2487295
Validation loss decreased (0.239901 --> 0.233857).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 18 cost time: 0.8623976707458496
Epoch: 18, Steps: 64 | Train Loss: 0.1184134 Vali Loss: 0.2261044 Test Loss: 0.2361482
Validation loss decreased (0.233857 --> 0.226104).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 19 cost time: 0.8807640075683594
Epoch: 19, Steps: 64 | Train Loss: 0.1157778 Vali Loss: 0.2236667 Test Loss: 0.2309780
Validation loss decreased (0.226104 --> 0.223667).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 20 cost time: 0.895000696182251
Epoch: 20, Steps: 64 | Train Loss: 0.1147063 Vali Loss: 0.2199718 Test Loss: 0.2260523
Validation loss decreased (0.223667 --> 0.219972).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 21 cost time: 0.880624532699585
Epoch: 21, Steps: 64 | Train Loss: 0.1132638 Vali Loss: 0.2141229 Test Loss: 0.2171003
Validation loss decreased (0.219972 --> 0.214123).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 22 cost time: 0.8793814182281494
Epoch: 22, Steps: 64 | Train Loss: 0.1125184 Vali Loss: 0.2123194 Test Loss: 0.2135917
Validation loss decreased (0.214123 --> 0.212319).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 23 cost time: 0.8444030284881592
Epoch: 23, Steps: 64 | Train Loss: 0.1106377 Vali Loss: 0.2090805 Test Loss: 0.2073946
Validation loss decreased (0.212319 --> 0.209080).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 24 cost time: 0.8508422374725342
Epoch: 24, Steps: 64 | Train Loss: 0.1097735 Vali Loss: 0.2074678 Test Loss: 0.2059765
Validation loss decreased (0.209080 --> 0.207468).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 25 cost time: 0.8380002975463867
Epoch: 25, Steps: 64 | Train Loss: 0.1093544 Vali Loss: 0.2051247 Test Loss: 0.2030376
Validation loss decreased (0.207468 --> 0.205125).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 26 cost time: 0.8339989185333252
Epoch: 26, Steps: 64 | Train Loss: 0.1081874 Vali Loss: 0.2036366 Test Loss: 0.1998065
Validation loss decreased (0.205125 --> 0.203637).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 27 cost time: 0.8303890228271484
Epoch: 27, Steps: 64 | Train Loss: 0.1076241 Vali Loss: 0.2013673 Test Loss: 0.1996186
Validation loss decreased (0.203637 --> 0.201367).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 28 cost time: 0.8303840160369873
Epoch: 28, Steps: 64 | Train Loss: 0.1073733 Vali Loss: 0.2008931 Test Loss: 0.1970242
Validation loss decreased (0.201367 --> 0.200893).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 29 cost time: 0.8590173721313477
Epoch: 29, Steps: 64 | Train Loss: 0.1065042 Vali Loss: 0.2004914 Test Loss: 0.1954075
Validation loss decreased (0.200893 --> 0.200491).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 30 cost time: 0.8586471080780029
Epoch: 30, Steps: 64 | Train Loss: 0.1064968 Vali Loss: 0.1990130 Test Loss: 0.1944691
Validation loss decreased (0.200491 --> 0.199013).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 31 cost time: 0.8939995765686035
Epoch: 31, Steps: 64 | Train Loss: 0.1063573 Vali Loss: 0.1990564 Test Loss: 0.1946209
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 32 cost time: 0.8416357040405273
Epoch: 32, Steps: 64 | Train Loss: 0.1059982 Vali Loss: 0.1962967 Test Loss: 0.1915512
Validation loss decreased (0.199013 --> 0.196297).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 33 cost time: 0.8354032039642334
Epoch: 33, Steps: 64 | Train Loss: 0.1055607 Vali Loss: 0.1980192 Test Loss: 0.1905407
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 34 cost time: 0.8534398078918457
Epoch: 34, Steps: 64 | Train Loss: 0.1059416 Vali Loss: 0.1978015 Test Loss: 0.1904790
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 35 cost time: 0.8667798042297363
Epoch: 35, Steps: 64 | Train Loss: 0.1053365 Vali Loss: 0.1967513 Test Loss: 0.1888811
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 36 cost time: 0.8660032749176025
Epoch: 36, Steps: 64 | Train Loss: 0.1049993 Vali Loss: 0.1956619 Test Loss: 0.1880932
Validation loss decreased (0.196297 --> 0.195662).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 37 cost time: 0.8856325149536133
Epoch: 37, Steps: 64 | Train Loss: 0.1052618 Vali Loss: 0.1973035 Test Loss: 0.1882511
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 38 cost time: 0.8888933658599854
Epoch: 38, Steps: 64 | Train Loss: 0.1045656 Vali Loss: 0.1949929 Test Loss: 0.1863200
Validation loss decreased (0.195662 --> 0.194993).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 39 cost time: 0.8845419883728027
Epoch: 39, Steps: 64 | Train Loss: 0.1041163 Vali Loss: 0.1934483 Test Loss: 0.1866248
Validation loss decreased (0.194993 --> 0.193448).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 40 cost time: 0.8834261894226074
Epoch: 40, Steps: 64 | Train Loss: 0.1043110 Vali Loss: 0.1938345 Test Loss: 0.1866107
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 41 cost time: 0.8707623481750488
Epoch: 41, Steps: 64 | Train Loss: 0.1045711 Vali Loss: 0.1927235 Test Loss: 0.1858562
Validation loss decreased (0.193448 --> 0.192723).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 42 cost time: 0.8793578147888184
Epoch: 42, Steps: 64 | Train Loss: 0.1041579 Vali Loss: 0.1929968 Test Loss: 0.1847226
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 43 cost time: 0.8716452121734619
Epoch: 43, Steps: 64 | Train Loss: 0.1043007 Vali Loss: 0.1925727 Test Loss: 0.1847102
Validation loss decreased (0.192723 --> 0.192573).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 44 cost time: 0.8665671348571777
Epoch: 44, Steps: 64 | Train Loss: 0.1041414 Vali Loss: 0.1923209 Test Loss: 0.1855313
Validation loss decreased (0.192573 --> 0.192321).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 45 cost time: 0.859351634979248
Epoch: 45, Steps: 64 | Train Loss: 0.1041525 Vali Loss: 0.1927005 Test Loss: 0.1857905
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 46 cost time: 0.8677432537078857
Epoch: 46, Steps: 64 | Train Loss: 0.1038655 Vali Loss: 0.1944195 Test Loss: 0.1842233
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 47 cost time: 0.8642821311950684
Epoch: 47, Steps: 64 | Train Loss: 0.1039611 Vali Loss: 0.1935952 Test Loss: 0.1840488
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 48 cost time: 0.8586454391479492
Epoch: 48, Steps: 64 | Train Loss: 0.1037001 Vali Loss: 0.1918443 Test Loss: 0.1851426
Validation loss decreased (0.192321 --> 0.191844).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 49 cost time: 0.8551936149597168
Epoch: 49, Steps: 64 | Train Loss: 0.1036990 Vali Loss: 0.1919728 Test Loss: 0.1833866
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 50 cost time: 0.8834352493286133
Epoch: 50, Steps: 64 | Train Loss: 0.1031954 Vali Loss: 0.1932429 Test Loss: 0.1833997
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 51 cost time: 0.8759810924530029
Epoch: 51, Steps: 64 | Train Loss: 0.1033789 Vali Loss: 0.1928292 Test Loss: 0.1827614
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 52 cost time: 0.8757336139678955
Epoch: 52, Steps: 64 | Train Loss: 0.1033161 Vali Loss: 0.1907777 Test Loss: 0.1825781
Validation loss decreased (0.191844 --> 0.190778).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 53 cost time: 0.8729984760284424
Epoch: 53, Steps: 64 | Train Loss: 0.1028083 Vali Loss: 0.1908290 Test Loss: 0.1822704
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 54 cost time: 0.8426327705383301
Epoch: 54, Steps: 64 | Train Loss: 0.1030133 Vali Loss: 0.1897316 Test Loss: 0.1835985
Validation loss decreased (0.190778 --> 0.189732).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 55 cost time: 0.8524048328399658
Epoch: 55, Steps: 64 | Train Loss: 0.1033699 Vali Loss: 0.1913173 Test Loss: 0.1820465
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 56 cost time: 0.8631558418273926
Epoch: 56, Steps: 64 | Train Loss: 0.1036391 Vali Loss: 0.1914622 Test Loss: 0.1826616
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 57 cost time: 0.8898322582244873
Epoch: 57, Steps: 64 | Train Loss: 0.1039718 Vali Loss: 0.1925718 Test Loss: 0.1825668
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 58 cost time: 0.8859994411468506
Epoch: 58, Steps: 64 | Train Loss: 0.1028089 Vali Loss: 0.1908416 Test Loss: 0.1817533
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 59 cost time: 0.8706457614898682
Epoch: 59, Steps: 64 | Train Loss: 0.1035074 Vali Loss: 0.1912035 Test Loss: 0.1817491
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017543792724609375 GB
GPU已分配内存的峰值：0.04573822021484375 GB
Epoch: 60 cost time: 0.8830704689025879
Epoch: 60, Steps: 64 | Train Loss: 0.1033513 Vali Loss: 0.1907427 Test Loss: 0.1815460
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.18359851837158203, mae:0.3386717140674591, rse:0.22806338965892792
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 1 cost time: 2.2877535820007324
Epoch: 1, Steps: 64 | Train Loss: 0.7877940 Vali Loss: 1.8197950 Test Loss: 3.4658058
Validation loss decreased (inf --> 1.819795).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 2 cost time: 0.9074907302856445
Epoch: 2, Steps: 64 | Train Loss: 0.5176656 Vali Loss: 0.6041085 Test Loss: 1.0312059
Validation loss decreased (1.819795 --> 0.604109).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 3 cost time: 0.9260537624359131
Epoch: 3, Steps: 64 | Train Loss: 0.1761247 Vali Loss: 0.1915471 Test Loss: 0.1733127
Validation loss decreased (0.604109 --> 0.191547).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 4 cost time: 0.8961067199707031
Epoch: 4, Steps: 64 | Train Loss: 0.1132746 Vali Loss: 0.1774590 Test Loss: 0.1511889
Validation loss decreased (0.191547 --> 0.177459).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 5 cost time: 0.9099266529083252
Epoch: 5, Steps: 64 | Train Loss: 0.1082558 Vali Loss: 0.1813898 Test Loss: 0.1557194
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 6 cost time: 0.9083387851715088
Epoch: 6, Steps: 64 | Train Loss: 0.1046309 Vali Loss: 0.1768158 Test Loss: 0.1519410
Validation loss decreased (0.177459 --> 0.176816).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 7 cost time: 0.8740003108978271
Epoch: 7, Steps: 64 | Train Loss: 0.1019840 Vali Loss: 0.1754278 Test Loss: 0.1516059
Validation loss decreased (0.176816 --> 0.175428).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 8 cost time: 0.8905892372131348
Epoch: 8, Steps: 64 | Train Loss: 0.1008631 Vali Loss: 0.1737107 Test Loss: 0.1509382
Validation loss decreased (0.175428 --> 0.173711).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 9 cost time: 0.8830554485321045
Epoch: 9, Steps: 64 | Train Loss: 0.0992357 Vali Loss: 0.1737798 Test Loss: 0.1491098
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 10 cost time: 0.8934004306793213
Epoch: 10, Steps: 64 | Train Loss: 0.0975667 Vali Loss: 0.1710324 Test Loss: 0.1497052
Validation loss decreased (0.173711 --> 0.171032).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 11 cost time: 0.891024112701416
Epoch: 11, Steps: 64 | Train Loss: 0.0970220 Vali Loss: 0.1703995 Test Loss: 0.1483912
Validation loss decreased (0.171032 --> 0.170399).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 12 cost time: 0.9096479415893555
Epoch: 12, Steps: 64 | Train Loss: 0.0960893 Vali Loss: 0.1686887 Test Loss: 0.1485351
Validation loss decreased (0.170399 --> 0.168689).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 13 cost time: 0.9178018569946289
Epoch: 13, Steps: 64 | Train Loss: 0.0954426 Vali Loss: 0.1691855 Test Loss: 0.1495951
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 14 cost time: 0.9070000648498535
Epoch: 14, Steps: 64 | Train Loss: 0.0949954 Vali Loss: 0.1685920 Test Loss: 0.1481465
Validation loss decreased (0.168689 --> 0.168592).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 15 cost time: 0.9006369113922119
Epoch: 15, Steps: 64 | Train Loss: 0.0944487 Vali Loss: 0.1680509 Test Loss: 0.1482329
Validation loss decreased (0.168592 --> 0.168051).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 16 cost time: 0.8953871726989746
Epoch: 16, Steps: 64 | Train Loss: 0.0938884 Vali Loss: 0.1669074 Test Loss: 0.1473286
Validation loss decreased (0.168051 --> 0.166907).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 17 cost time: 0.8988676071166992
Epoch: 17, Steps: 64 | Train Loss: 0.0935039 Vali Loss: 0.1653025 Test Loss: 0.1480856
Validation loss decreased (0.166907 --> 0.165302).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 18 cost time: 0.9090168476104736
Epoch: 18, Steps: 64 | Train Loss: 0.0931108 Vali Loss: 0.1666297 Test Loss: 0.1480121
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 19 cost time: 0.9147891998291016
Epoch: 19, Steps: 64 | Train Loss: 0.0925569 Vali Loss: 0.1656235 Test Loss: 0.1475772
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 20 cost time: 0.9124643802642822
Epoch: 20, Steps: 64 | Train Loss: 0.0921083 Vali Loss: 0.1647630 Test Loss: 0.1484313
Validation loss decreased (0.165302 --> 0.164763).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 21 cost time: 0.9109995365142822
Epoch: 21, Steps: 64 | Train Loss: 0.0924390 Vali Loss: 0.1658808 Test Loss: 0.1475776
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 22 cost time: 0.9032983779907227
Epoch: 22, Steps: 64 | Train Loss: 0.0917305 Vali Loss: 0.1647355 Test Loss: 0.1478135
Validation loss decreased (0.164763 --> 0.164736).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 23 cost time: 0.8714597225189209
Epoch: 23, Steps: 64 | Train Loss: 0.0920729 Vali Loss: 0.1643566 Test Loss: 0.1478664
Validation loss decreased (0.164736 --> 0.164357).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 24 cost time: 0.875208854675293
Epoch: 24, Steps: 64 | Train Loss: 0.0918463 Vali Loss: 0.1650141 Test Loss: 0.1474325
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 25 cost time: 0.8934705257415771
Epoch: 25, Steps: 64 | Train Loss: 0.0914190 Vali Loss: 0.1658581 Test Loss: 0.1480665
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 26 cost time: 0.8767843246459961
Epoch: 26, Steps: 64 | Train Loss: 0.0910527 Vali Loss: 0.1660611 Test Loss: 0.1475378
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 27 cost time: 0.8940002918243408
Epoch: 27, Steps: 64 | Train Loss: 0.0910367 Vali Loss: 0.1649375 Test Loss: 0.1479415
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 28 cost time: 0.8956139087677002
Epoch: 28, Steps: 64 | Train Loss: 0.0906239 Vali Loss: 0.1636035 Test Loss: 0.1476577
Validation loss decreased (0.164357 --> 0.163604).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 29 cost time: 0.8963978290557861
Epoch: 29, Steps: 64 | Train Loss: 0.0908274 Vali Loss: 0.1633106 Test Loss: 0.1478864
Validation loss decreased (0.163604 --> 0.163311).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 30 cost time: 0.8904824256896973
Epoch: 30, Steps: 64 | Train Loss: 0.0905237 Vali Loss: 0.1635659 Test Loss: 0.1476614
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 31 cost time: 0.8667798042297363
Epoch: 31, Steps: 64 | Train Loss: 0.0902477 Vali Loss: 0.1639244 Test Loss: 0.1485859
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 32 cost time: 0.877476692199707
Epoch: 32, Steps: 64 | Train Loss: 0.0902224 Vali Loss: 0.1635398 Test Loss: 0.1476398
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 33 cost time: 0.8709979057312012
Epoch: 33, Steps: 64 | Train Loss: 0.0906142 Vali Loss: 0.1627930 Test Loss: 0.1474729
Validation loss decreased (0.163311 --> 0.162793).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 34 cost time: 0.8946375846862793
Epoch: 34, Steps: 64 | Train Loss: 0.0906493 Vali Loss: 0.1653038 Test Loss: 0.1483974
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 35 cost time: 0.9197158813476562
Epoch: 35, Steps: 64 | Train Loss: 0.0899957 Vali Loss: 0.1652556 Test Loss: 0.1480478
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 36 cost time: 0.9160881042480469
Epoch: 36, Steps: 64 | Train Loss: 0.0900988 Vali Loss: 0.1634754 Test Loss: 0.1471938
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 37 cost time: 0.9174396991729736
Epoch: 37, Steps: 64 | Train Loss: 0.0900085 Vali Loss: 0.1635440 Test Loss: 0.1476315
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 38 cost time: 0.9204835891723633
Epoch: 38, Steps: 64 | Train Loss: 0.0903664 Vali Loss: 0.1646000 Test Loss: 0.1479746
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 39 cost time: 0.919776439666748
Epoch: 39, Steps: 64 | Train Loss: 0.0899566 Vali Loss: 0.1634688 Test Loss: 0.1477415
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 40 cost time: 0.8940005302429199
Epoch: 40, Steps: 64 | Train Loss: 0.0900036 Vali Loss: 0.1639751 Test Loss: 0.1477205
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 41 cost time: 0.8936412334442139
Epoch: 41, Steps: 64 | Train Loss: 0.0900235 Vali Loss: 0.1635829 Test Loss: 0.1478766
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 42 cost time: 0.9063901901245117
Epoch: 42, Steps: 64 | Train Loss: 0.0906546 Vali Loss: 0.1631276 Test Loss: 0.1470636
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 43 cost time: 0.9033963680267334
Epoch: 43, Steps: 64 | Train Loss: 0.0900233 Vali Loss: 0.1641874 Test Loss: 0.1476763
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 44 cost time: 0.9021885395050049
Epoch: 44, Steps: 64 | Train Loss: 0.0895062 Vali Loss: 0.1628361 Test Loss: 0.1477095
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 45 cost time: 0.8917834758758545
Epoch: 45, Steps: 64 | Train Loss: 0.0900826 Vali Loss: 0.1606141 Test Loss: 0.1476897
Validation loss decreased (0.162793 --> 0.160614).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 46 cost time: 0.9000005722045898
Epoch: 46, Steps: 64 | Train Loss: 0.0897665 Vali Loss: 0.1647863 Test Loss: 0.1475158
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 47 cost time: 0.8916511535644531
Epoch: 47, Steps: 64 | Train Loss: 0.0898587 Vali Loss: 0.1644635 Test Loss: 0.1480709
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 48 cost time: 0.8720791339874268
Epoch: 48, Steps: 64 | Train Loss: 0.0898239 Vali Loss: 0.1647053 Test Loss: 0.1478728
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 49 cost time: 0.8780906200408936
Epoch: 49, Steps: 64 | Train Loss: 0.0896218 Vali Loss: 0.1629985 Test Loss: 0.1485297
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 50 cost time: 0.8725337982177734
Epoch: 50, Steps: 64 | Train Loss: 0.0900263 Vali Loss: 0.1628272 Test Loss: 0.1480674
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 51 cost time: 0.8727908134460449
Epoch: 51, Steps: 64 | Train Loss: 0.0900664 Vali Loss: 0.1642468 Test Loss: 0.1473543
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 52 cost time: 0.8809993267059326
Epoch: 52, Steps: 64 | Train Loss: 0.0898367 Vali Loss: 0.1641443 Test Loss: 0.1480475
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 53 cost time: 0.8910262584686279
Epoch: 53, Steps: 64 | Train Loss: 0.0896379 Vali Loss: 0.1644001 Test Loss: 0.1479921
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 54 cost time: 0.884371280670166
Epoch: 54, Steps: 64 | Train Loss: 0.0895850 Vali Loss: 0.1647593 Test Loss: 0.1475149
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 55 cost time: 0.8963956832885742
Epoch: 55, Steps: 64 | Train Loss: 0.0897714 Vali Loss: 0.1630904 Test Loss: 0.1477734
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 56 cost time: 0.9154882431030273
Epoch: 56, Steps: 64 | Train Loss: 0.0898483 Vali Loss: 0.1622464 Test Loss: 0.1480065
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 57 cost time: 0.9108450412750244
Epoch: 57, Steps: 64 | Train Loss: 0.0897451 Vali Loss: 0.1619779 Test Loss: 0.1479700
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 58 cost time: 0.9006450176239014
Epoch: 58, Steps: 64 | Train Loss: 0.0897170 Vali Loss: 0.1645608 Test Loss: 0.1480704
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 59 cost time: 0.8980016708374023
Epoch: 59, Steps: 64 | Train Loss: 0.0897083 Vali Loss: 0.1629053 Test Loss: 0.1480937
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019260406494140625 GB
GPU已分配内存的峰值：0.049777984619140625 GB
Epoch: 60 cost time: 0.8966360092163086
Epoch: 60, Steps: 64 | Train Loss: 0.0897889 Vali Loss: 0.1632940 Test Loss: 0.1479742
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14768970012664795, mae:0.29031771421432495, rse:0.2045484036207199
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05285072326660156 GB
Epoch: 1 cost time: 2.29815673828125
Epoch: 1, Steps: 64 | Train Loss: 0.7618660 Vali Loss: 1.7800831 Test Loss: 3.3786519
Validation loss decreased (inf --> 1.780083).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 2 cost time: 0.9160366058349609
Epoch: 2, Steps: 64 | Train Loss: 0.4154315 Vali Loss: 0.2111265 Test Loss: 0.2198221
Validation loss decreased (1.780083 --> 0.211126).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 3 cost time: 0.9224302768707275
Epoch: 3, Steps: 64 | Train Loss: 0.1223011 Vali Loss: 0.1933720 Test Loss: 0.1695116
Validation loss decreased (0.211126 --> 0.193372).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 4 cost time: 0.917410135269165
Epoch: 4, Steps: 64 | Train Loss: 0.1093044 Vali Loss: 0.1772352 Test Loss: 0.1509494
Validation loss decreased (0.193372 --> 0.177235).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 5 cost time: 0.8949737548828125
Epoch: 5, Steps: 64 | Train Loss: 0.1044959 Vali Loss: 0.1755309 Test Loss: 0.1516546
Validation loss decreased (0.177235 --> 0.175531).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 6 cost time: 0.8993852138519287
Epoch: 6, Steps: 64 | Train Loss: 0.1013290 Vali Loss: 0.1739498 Test Loss: 0.1495630
Validation loss decreased (0.175531 --> 0.173950).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 7 cost time: 0.90909743309021
Epoch: 7, Steps: 64 | Train Loss: 0.0991960 Vali Loss: 0.1708083 Test Loss: 0.1495710
Validation loss decreased (0.173950 --> 0.170808).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 8 cost time: 0.9150006771087646
Epoch: 8, Steps: 64 | Train Loss: 0.0975796 Vali Loss: 0.1707936 Test Loss: 0.1475118
Validation loss decreased (0.170808 --> 0.170794).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 9 cost time: 0.9246394634246826
Epoch: 9, Steps: 64 | Train Loss: 0.0963173 Vali Loss: 0.1678019 Test Loss: 0.1473113
Validation loss decreased (0.170794 --> 0.167802).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 10 cost time: 0.9306490421295166
Epoch: 10, Steps: 64 | Train Loss: 0.0949698 Vali Loss: 0.1670077 Test Loss: 0.1476685
Validation loss decreased (0.167802 --> 0.167008).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 11 cost time: 0.936779260635376
Epoch: 11, Steps: 64 | Train Loss: 0.0946677 Vali Loss: 0.1674944 Test Loss: 0.1455755
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 12 cost time: 0.9393796920776367
Epoch: 12, Steps: 64 | Train Loss: 0.0932201 Vali Loss: 0.1669221 Test Loss: 0.1464297
Validation loss decreased (0.167008 --> 0.166922).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 13 cost time: 0.9374163150787354
Epoch: 13, Steps: 64 | Train Loss: 0.0930559 Vali Loss: 0.1672907 Test Loss: 0.1469695
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 14 cost time: 0.9274330139160156
Epoch: 14, Steps: 64 | Train Loss: 0.0924411 Vali Loss: 0.1635097 Test Loss: 0.1459425
Validation loss decreased (0.166922 --> 0.163510).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 15 cost time: 0.9288568496704102
Epoch: 15, Steps: 64 | Train Loss: 0.0921191 Vali Loss: 0.1644494 Test Loss: 0.1462194
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 16 cost time: 0.9250006675720215
Epoch: 16, Steps: 64 | Train Loss: 0.0920412 Vali Loss: 0.1643198 Test Loss: 0.1467070
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 17 cost time: 0.9176130294799805
Epoch: 17, Steps: 64 | Train Loss: 0.0914298 Vali Loss: 0.1635783 Test Loss: 0.1459578
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 18 cost time: 0.9386649131774902
Epoch: 18, Steps: 64 | Train Loss: 0.0906934 Vali Loss: 0.1649459 Test Loss: 0.1459681
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 19 cost time: 0.9423935413360596
Epoch: 19, Steps: 64 | Train Loss: 0.0905560 Vali Loss: 0.1627653 Test Loss: 0.1460461
Validation loss decreased (0.163510 --> 0.162765).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 20 cost time: 0.9373693466186523
Epoch: 20, Steps: 64 | Train Loss: 0.0903023 Vali Loss: 0.1656303 Test Loss: 0.1466115
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 21 cost time: 0.9363903999328613
Epoch: 21, Steps: 64 | Train Loss: 0.0903248 Vali Loss: 0.1625575 Test Loss: 0.1465434
Validation loss decreased (0.162765 --> 0.162558).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 22 cost time: 0.9163744449615479
Epoch: 22, Steps: 64 | Train Loss: 0.0895007 Vali Loss: 0.1627911 Test Loss: 0.1462342
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 23 cost time: 0.9106965065002441
Epoch: 23, Steps: 64 | Train Loss: 0.0894563 Vali Loss: 0.1631778 Test Loss: 0.1460210
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 24 cost time: 0.9133813381195068
Epoch: 24, Steps: 64 | Train Loss: 0.0897917 Vali Loss: 0.1629040 Test Loss: 0.1468386
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 25 cost time: 0.909642219543457
Epoch: 25, Steps: 64 | Train Loss: 0.0890723 Vali Loss: 0.1635979 Test Loss: 0.1462711
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 26 cost time: 0.922417402267456
Epoch: 26, Steps: 64 | Train Loss: 0.0891090 Vali Loss: 0.1622850 Test Loss: 0.1459828
Validation loss decreased (0.162558 --> 0.162285).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 27 cost time: 0.9254305362701416
Epoch: 27, Steps: 64 | Train Loss: 0.0890835 Vali Loss: 0.1612851 Test Loss: 0.1464874
Validation loss decreased (0.162285 --> 0.161285).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 28 cost time: 0.9182970523834229
Epoch: 28, Steps: 64 | Train Loss: 0.0887585 Vali Loss: 0.1614850 Test Loss: 0.1459011
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 29 cost time: 0.9204115867614746
Epoch: 29, Steps: 64 | Train Loss: 0.0885278 Vali Loss: 0.1611004 Test Loss: 0.1454264
Validation loss decreased (0.161285 --> 0.161100).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 30 cost time: 0.9074666500091553
Epoch: 30, Steps: 64 | Train Loss: 0.0888086 Vali Loss: 0.1613419 Test Loss: 0.1463113
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 31 cost time: 0.9237387180328369
Epoch: 31, Steps: 64 | Train Loss: 0.0886232 Vali Loss: 0.1626353 Test Loss: 0.1463354
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 32 cost time: 0.9146335124969482
Epoch: 32, Steps: 64 | Train Loss: 0.0883958 Vali Loss: 0.1625891 Test Loss: 0.1462653
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 33 cost time: 0.9212112426757812
Epoch: 33, Steps: 64 | Train Loss: 0.0889312 Vali Loss: 0.1611721 Test Loss: 0.1460723
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 34 cost time: 0.9513800144195557
Epoch: 34, Steps: 64 | Train Loss: 0.0882348 Vali Loss: 0.1603988 Test Loss: 0.1465758
Validation loss decreased (0.161100 --> 0.160399).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 35 cost time: 0.9454019069671631
Epoch: 35, Steps: 64 | Train Loss: 0.0881394 Vali Loss: 0.1605852 Test Loss: 0.1464974
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 36 cost time: 0.9383904933929443
Epoch: 36, Steps: 64 | Train Loss: 0.0883487 Vali Loss: 0.1599685 Test Loss: 0.1463130
Validation loss decreased (0.160399 --> 0.159968).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 37 cost time: 0.9407799243927002
Epoch: 37, Steps: 64 | Train Loss: 0.0880979 Vali Loss: 0.1603587 Test Loss: 0.1464181
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 38 cost time: 0.9313573837280273
Epoch: 38, Steps: 64 | Train Loss: 0.0882201 Vali Loss: 0.1609224 Test Loss: 0.1465291
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 39 cost time: 0.9327621459960938
Epoch: 39, Steps: 64 | Train Loss: 0.0881211 Vali Loss: 0.1613396 Test Loss: 0.1459001
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 40 cost time: 0.9250004291534424
Epoch: 40, Steps: 64 | Train Loss: 0.0882078 Vali Loss: 0.1613265 Test Loss: 0.1468158
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 41 cost time: 0.9310104846954346
Epoch: 41, Steps: 64 | Train Loss: 0.0883715 Vali Loss: 0.1596318 Test Loss: 0.1465381
Validation loss decreased (0.159968 --> 0.159632).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 42 cost time: 0.9263436794281006
Epoch: 42, Steps: 64 | Train Loss: 0.0882913 Vali Loss: 0.1614613 Test Loss: 0.1460615
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 43 cost time: 0.9293365478515625
Epoch: 43, Steps: 64 | Train Loss: 0.0886322 Vali Loss: 0.1613865 Test Loss: 0.1464215
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 44 cost time: 0.9164993762969971
Epoch: 44, Steps: 64 | Train Loss: 0.0878361 Vali Loss: 0.1620709 Test Loss: 0.1463351
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 45 cost time: 0.9223871231079102
Epoch: 45, Steps: 64 | Train Loss: 0.0881669 Vali Loss: 0.1592387 Test Loss: 0.1467390
Validation loss decreased (0.159632 --> 0.159239).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 46 cost time: 0.9224143028259277
Epoch: 46, Steps: 64 | Train Loss: 0.0881706 Vali Loss: 0.1618545 Test Loss: 0.1461689
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 47 cost time: 0.9138202667236328
Epoch: 47, Steps: 64 | Train Loss: 0.0879719 Vali Loss: 0.1615959 Test Loss: 0.1462133
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 48 cost time: 0.9209988117218018
Epoch: 48, Steps: 64 | Train Loss: 0.0880285 Vali Loss: 0.1608410 Test Loss: 0.1467667
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 49 cost time: 0.9046299457550049
Epoch: 49, Steps: 64 | Train Loss: 0.0878263 Vali Loss: 0.1598433 Test Loss: 0.1468820
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 50 cost time: 0.911301851272583
Epoch: 50, Steps: 64 | Train Loss: 0.0876440 Vali Loss: 0.1601907 Test Loss: 0.1464097
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 51 cost time: 0.9234330654144287
Epoch: 51, Steps: 64 | Train Loss: 0.0882816 Vali Loss: 0.1592246 Test Loss: 0.1459786
Validation loss decreased (0.159239 --> 0.159225).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 52 cost time: 0.9271721839904785
Epoch: 52, Steps: 64 | Train Loss: 0.0880958 Vali Loss: 0.1596976 Test Loss: 0.1463191
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 53 cost time: 0.9401249885559082
Epoch: 53, Steps: 64 | Train Loss: 0.0879041 Vali Loss: 0.1597380 Test Loss: 0.1462489
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 54 cost time: 0.9369912147521973
Epoch: 54, Steps: 64 | Train Loss: 0.0878032 Vali Loss: 0.1608171 Test Loss: 0.1466300
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 55 cost time: 0.9309995174407959
Epoch: 55, Steps: 64 | Train Loss: 0.0880921 Vali Loss: 0.1611948 Test Loss: 0.1468859
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 56 cost time: 0.9179985523223877
Epoch: 56, Steps: 64 | Train Loss: 0.0879184 Vali Loss: 0.1599452 Test Loss: 0.1462492
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 57 cost time: 0.9166378974914551
Epoch: 57, Steps: 64 | Train Loss: 0.0880769 Vali Loss: 0.1613458 Test Loss: 0.1466005
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 58 cost time: 0.9213988780975342
Epoch: 58, Steps: 64 | Train Loss: 0.0880958 Vali Loss: 0.1613712 Test Loss: 0.1463218
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 59 cost time: 0.9446141719818115
Epoch: 59, Steps: 64 | Train Loss: 0.0878230 Vali Loss: 0.1615432 Test Loss: 0.1465482
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020130157470703125 GB
GPU已分配内存的峰值：0.05502033233642578 GB
Epoch: 60 cost time: 0.9454975128173828
Epoch: 60, Steps: 64 | Train Loss: 0.0879471 Vali Loss: 0.1584873 Test Loss: 0.1465285
Validation loss decreased (0.159225 --> 0.158487).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1465284675359726, mae:0.28832611441612244, rse:0.20374265313148499
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04572486877441406 GB
Epoch: 1 cost time: 2.2568860054016113
Epoch: 1, Steps: 64 | Train Loss: 0.8173711 Vali Loss: 1.8390242 Test Loss: 3.4430003
Validation loss decreased (inf --> 1.839024).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 2 cost time: 0.865006685256958
Epoch: 2, Steps: 64 | Train Loss: 0.6943861 Vali Loss: 1.3289012 Test Loss: 2.4015687
Validation loss decreased (1.839024 --> 1.328901).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 3 cost time: 0.86293625831604
Epoch: 3, Steps: 64 | Train Loss: 0.5257713 Vali Loss: 1.0025984 Test Loss: 1.7354292
Validation loss decreased (1.328901 --> 1.002598).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 4 cost time: 0.8759987354278564
Epoch: 4, Steps: 64 | Train Loss: 0.4005961 Vali Loss: 0.7720308 Test Loss: 1.2653993
Validation loss decreased (1.002598 --> 0.772031).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 5 cost time: 0.876633882522583
Epoch: 5, Steps: 64 | Train Loss: 0.3130068 Vali Loss: 0.6280001 Test Loss: 0.9686240
Validation loss decreased (0.772031 --> 0.628000).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 6 cost time: 0.837540864944458
Epoch: 6, Steps: 64 | Train Loss: 0.2551868 Vali Loss: 0.5203750 Test Loss: 0.7637793
Validation loss decreased (0.628000 --> 0.520375).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 7 cost time: 0.8424146175384521
Epoch: 7, Steps: 64 | Train Loss: 0.2157689 Vali Loss: 0.4420583 Test Loss: 0.6182122
Validation loss decreased (0.520375 --> 0.442058).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 8 cost time: 0.844857931137085
Epoch: 8, Steps: 64 | Train Loss: 0.1872117 Vali Loss: 0.3848901 Test Loss: 0.5114049
Validation loss decreased (0.442058 --> 0.384890).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 9 cost time: 0.855905294418335
Epoch: 9, Steps: 64 | Train Loss: 0.1683938 Vali Loss: 0.3436523 Test Loss: 0.4383586
Validation loss decreased (0.384890 --> 0.343652).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 10 cost time: 0.8647189140319824
Epoch: 10, Steps: 64 | Train Loss: 0.1540668 Vali Loss: 0.3105003 Test Loss: 0.3817275
Validation loss decreased (0.343652 --> 0.310500).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 11 cost time: 0.8656318187713623
Epoch: 11, Steps: 64 | Train Loss: 0.1429783 Vali Loss: 0.2846750 Test Loss: 0.3376485
Validation loss decreased (0.310500 --> 0.284675).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 12 cost time: 0.8917818069458008
Epoch: 12, Steps: 64 | Train Loss: 0.1348099 Vali Loss: 0.2687602 Test Loss: 0.3095587
Validation loss decreased (0.284675 --> 0.268760).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 13 cost time: 0.8865270614624023
Epoch: 13, Steps: 64 | Train Loss: 0.1281271 Vali Loss: 0.2536977 Test Loss: 0.2845891
Validation loss decreased (0.268760 --> 0.253698).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 14 cost time: 0.8747756481170654
Epoch: 14, Steps: 64 | Train Loss: 0.1237929 Vali Loss: 0.2417719 Test Loss: 0.2656623
Validation loss decreased (0.253698 --> 0.241772).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 15 cost time: 0.8696122169494629
Epoch: 15, Steps: 64 | Train Loss: 0.1193025 Vali Loss: 0.2318600 Test Loss: 0.2506008
Validation loss decreased (0.241772 --> 0.231860).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 16 cost time: 0.8766162395477295
Epoch: 16, Steps: 64 | Train Loss: 0.1167347 Vali Loss: 0.2247901 Test Loss: 0.2395185
Validation loss decreased (0.231860 --> 0.224790).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 17 cost time: 0.8676173686981201
Epoch: 17, Steps: 64 | Train Loss: 0.1148953 Vali Loss: 0.2175056 Test Loss: 0.2295942
Validation loss decreased (0.224790 --> 0.217506).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 18 cost time: 0.8684310913085938
Epoch: 18, Steps: 64 | Train Loss: 0.1122569 Vali Loss: 0.2130829 Test Loss: 0.2203813
Validation loss decreased (0.217506 --> 0.213083).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 19 cost time: 0.8885331153869629
Epoch: 19, Steps: 64 | Train Loss: 0.1112713 Vali Loss: 0.2086273 Test Loss: 0.2140560
Validation loss decreased (0.213083 --> 0.208627).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 20 cost time: 0.8879072666168213
Epoch: 20, Steps: 64 | Train Loss: 0.1096303 Vali Loss: 0.2063961 Test Loss: 0.2071663
Validation loss decreased (0.208627 --> 0.206396).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 21 cost time: 0.8884444236755371
Epoch: 21, Steps: 64 | Train Loss: 0.1082052 Vali Loss: 0.2019770 Test Loss: 0.2048112
Validation loss decreased (0.206396 --> 0.201977).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 22 cost time: 0.8880000114440918
Epoch: 22, Steps: 64 | Train Loss: 0.1068984 Vali Loss: 0.2002890 Test Loss: 0.2014040
Validation loss decreased (0.201977 --> 0.200289).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 23 cost time: 0.8509998321533203
Epoch: 23, Steps: 64 | Train Loss: 0.1061157 Vali Loss: 0.1968667 Test Loss: 0.1951910
Validation loss decreased (0.200289 --> 0.196867).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 24 cost time: 0.8464455604553223
Epoch: 24, Steps: 64 | Train Loss: 0.1054783 Vali Loss: 0.1958803 Test Loss: 0.1945924
Validation loss decreased (0.196867 --> 0.195880).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 25 cost time: 0.8384585380554199
Epoch: 25, Steps: 64 | Train Loss: 0.1049206 Vali Loss: 0.1951687 Test Loss: 0.1905748
Validation loss decreased (0.195880 --> 0.195169).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 26 cost time: 0.8423788547515869
Epoch: 26, Steps: 64 | Train Loss: 0.1037422 Vali Loss: 0.1941688 Test Loss: 0.1903008
Validation loss decreased (0.195169 --> 0.194169).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 27 cost time: 0.8559999465942383
Epoch: 27, Steps: 64 | Train Loss: 0.1035196 Vali Loss: 0.1929040 Test Loss: 0.1876426
Validation loss decreased (0.194169 --> 0.192904).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 28 cost time: 0.8614518642425537
Epoch: 28, Steps: 64 | Train Loss: 0.1039778 Vali Loss: 0.1919610 Test Loss: 0.1872956
Validation loss decreased (0.192904 --> 0.191961).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 29 cost time: 0.8644366264343262
Epoch: 29, Steps: 64 | Train Loss: 0.1030845 Vali Loss: 0.1886972 Test Loss: 0.1842668
Validation loss decreased (0.191961 --> 0.188697).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 30 cost time: 0.8603761196136475
Epoch: 30, Steps: 64 | Train Loss: 0.1023557 Vali Loss: 0.1887088 Test Loss: 0.1823589
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 31 cost time: 0.8607649803161621
Epoch: 31, Steps: 64 | Train Loss: 0.1027519 Vali Loss: 0.1911239 Test Loss: 0.1835703
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 32 cost time: 0.8359992504119873
Epoch: 32, Steps: 64 | Train Loss: 0.1018891 Vali Loss: 0.1860230 Test Loss: 0.1808523
Validation loss decreased (0.188697 --> 0.186023).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 33 cost time: 0.8376448154449463
Epoch: 33, Steps: 64 | Train Loss: 0.1016380 Vali Loss: 0.1881003 Test Loss: 0.1797563
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 34 cost time: 0.8593935966491699
Epoch: 34, Steps: 64 | Train Loss: 0.1021298 Vali Loss: 0.1852962 Test Loss: 0.1800850
Validation loss decreased (0.186023 --> 0.185296).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 35 cost time: 0.8800163269042969
Epoch: 35, Steps: 64 | Train Loss: 0.1017465 Vali Loss: 0.1873054 Test Loss: 0.1787944
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 36 cost time: 0.8893489837646484
Epoch: 36, Steps: 64 | Train Loss: 0.1014169 Vali Loss: 0.1840509 Test Loss: 0.1780857
Validation loss decreased (0.185296 --> 0.184051).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 37 cost time: 0.8868899345397949
Epoch: 37, Steps: 64 | Train Loss: 0.1013453 Vali Loss: 0.1851542 Test Loss: 0.1787031
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 38 cost time: 0.9040000438690186
Epoch: 38, Steps: 64 | Train Loss: 0.1012752 Vali Loss: 0.1869430 Test Loss: 0.1776297
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 39 cost time: 0.8890509605407715
Epoch: 39, Steps: 64 | Train Loss: 0.1013522 Vali Loss: 0.1840678 Test Loss: 0.1749384
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 40 cost time: 0.8874459266662598
Epoch: 40, Steps: 64 | Train Loss: 0.1009144 Vali Loss: 0.1827494 Test Loss: 0.1767099
Validation loss decreased (0.184051 --> 0.182749).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 41 cost time: 0.8643712997436523
Epoch: 41, Steps: 64 | Train Loss: 0.1003967 Vali Loss: 0.1825012 Test Loss: 0.1756212
Validation loss decreased (0.182749 --> 0.182501).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 42 cost time: 0.881605863571167
Epoch: 42, Steps: 64 | Train Loss: 0.1005066 Vali Loss: 0.1837458 Test Loss: 0.1751646
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 43 cost time: 0.8839993476867676
Epoch: 43, Steps: 64 | Train Loss: 0.0999833 Vali Loss: 0.1819264 Test Loss: 0.1736427
Validation loss decreased (0.182501 --> 0.181926).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 44 cost time: 0.8809998035430908
Epoch: 44, Steps: 64 | Train Loss: 0.1003691 Vali Loss: 0.1827579 Test Loss: 0.1739769
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 45 cost time: 0.88364577293396
Epoch: 45, Steps: 64 | Train Loss: 0.1004788 Vali Loss: 0.1821481 Test Loss: 0.1747350
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 46 cost time: 0.8883976936340332
Epoch: 46, Steps: 64 | Train Loss: 0.1002841 Vali Loss: 0.1853624 Test Loss: 0.1762327
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 47 cost time: 0.8839318752288818
Epoch: 47, Steps: 64 | Train Loss: 0.1002669 Vali Loss: 0.1814911 Test Loss: 0.1737078
Validation loss decreased (0.181926 --> 0.181491).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 48 cost time: 0.8888731002807617
Epoch: 48, Steps: 64 | Train Loss: 0.1004981 Vali Loss: 0.1839776 Test Loss: 0.1741472
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 49 cost time: 0.8650000095367432
Epoch: 49, Steps: 64 | Train Loss: 0.0999445 Vali Loss: 0.1835618 Test Loss: 0.1737652
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 50 cost time: 0.8469998836517334
Epoch: 50, Steps: 64 | Train Loss: 0.0999365 Vali Loss: 0.1810929 Test Loss: 0.1726786
Validation loss decreased (0.181491 --> 0.181093).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 51 cost time: 0.8483729362487793
Epoch: 51, Steps: 64 | Train Loss: 0.0995816 Vali Loss: 0.1842487 Test Loss: 0.1739098
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 52 cost time: 0.8533370494842529
Epoch: 52, Steps: 64 | Train Loss: 0.0999348 Vali Loss: 0.1839571 Test Loss: 0.1733397
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 53 cost time: 0.8474807739257812
Epoch: 53, Steps: 64 | Train Loss: 0.1001794 Vali Loss: 0.1815563 Test Loss: 0.1728571
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 54 cost time: 0.8569996356964111
Epoch: 54, Steps: 64 | Train Loss: 0.0998829 Vali Loss: 0.1826843 Test Loss: 0.1735538
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 55 cost time: 0.8564720153808594
Epoch: 55, Steps: 64 | Train Loss: 0.0998846 Vali Loss: 0.1831096 Test Loss: 0.1733760
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 56 cost time: 0.8733925819396973
Epoch: 56, Steps: 64 | Train Loss: 0.0997067 Vali Loss: 0.1828965 Test Loss: 0.1728347
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 57 cost time: 0.8853833675384521
Epoch: 57, Steps: 64 | Train Loss: 0.0998107 Vali Loss: 0.1800631 Test Loss: 0.1731516
Validation loss decreased (0.181093 --> 0.180063).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 58 cost time: 0.8853907585144043
Epoch: 58, Steps: 64 | Train Loss: 0.0999510 Vali Loss: 0.1804444 Test Loss: 0.1723999
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 59 cost time: 0.8907761573791504
Epoch: 59, Steps: 64 | Train Loss: 0.1002386 Vali Loss: 0.1805271 Test Loss: 0.1717513
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017547607421875 GB
GPU已分配内存的峰值：0.04590129852294922 GB
Epoch: 60 cost time: 0.8900001049041748
Epoch: 60, Steps: 64 | Train Loss: 0.0996856 Vali Loss: 0.1824640 Test Loss: 0.1717654
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1731516271829605, mae:0.32431116700172424, rse:0.2214798629283905
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 1 cost time: 2.3068485260009766
Epoch: 1, Steps: 64 | Train Loss: 0.7870586 Vali Loss: 1.8132864 Test Loss: 3.4418330
Validation loss decreased (inf --> 1.813286).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 2 cost time: 0.9123649597167969
Epoch: 2, Steps: 64 | Train Loss: 0.5080952 Vali Loss: 0.5390546 Test Loss: 0.8282863
Validation loss decreased (1.813286 --> 0.539055).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 3 cost time: 0.9079999923706055
Epoch: 3, Steps: 64 | Train Loss: 0.1569815 Vali Loss: 0.1882073 Test Loss: 0.1466082
Validation loss decreased (0.539055 --> 0.188207).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 4 cost time: 0.8896410465240479
Epoch: 4, Steps: 64 | Train Loss: 0.1122702 Vali Loss: 0.1878700 Test Loss: 0.1529989
Validation loss decreased (0.188207 --> 0.187870).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 5 cost time: 0.8680222034454346
Epoch: 5, Steps: 64 | Train Loss: 0.1067184 Vali Loss: 0.1840456 Test Loss: 0.1529071
Validation loss decreased (0.187870 --> 0.184046).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 6 cost time: 0.8684008121490479
Epoch: 6, Steps: 64 | Train Loss: 0.1029182 Vali Loss: 0.1768295 Test Loss: 0.1479247
Validation loss decreased (0.184046 --> 0.176830).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 7 cost time: 0.8701066970825195
Epoch: 7, Steps: 64 | Train Loss: 0.1012018 Vali Loss: 0.1766385 Test Loss: 0.1493876
Validation loss decreased (0.176830 --> 0.176639).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 8 cost time: 0.8693497180938721
Epoch: 8, Steps: 64 | Train Loss: 0.0995623 Vali Loss: 0.1736016 Test Loss: 0.1462007
Validation loss decreased (0.176639 --> 0.173602).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 9 cost time: 0.8795411586761475
Epoch: 9, Steps: 64 | Train Loss: 0.0977845 Vali Loss: 0.1719498 Test Loss: 0.1473096
Validation loss decreased (0.173602 --> 0.171950).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 10 cost time: 0.9019160270690918
Epoch: 10, Steps: 64 | Train Loss: 0.0972080 Vali Loss: 0.1712279 Test Loss: 0.1468766
Validation loss decreased (0.171950 --> 0.171228).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 11 cost time: 0.8870489597320557
Epoch: 11, Steps: 64 | Train Loss: 0.0961581 Vali Loss: 0.1683478 Test Loss: 0.1453407
Validation loss decreased (0.171228 --> 0.168348).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 12 cost time: 0.9164071083068848
Epoch: 12, Steps: 64 | Train Loss: 0.0954338 Vali Loss: 0.1681370 Test Loss: 0.1451559
Validation loss decreased (0.168348 --> 0.168137).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 13 cost time: 0.9121377468109131
Epoch: 13, Steps: 64 | Train Loss: 0.0945798 Vali Loss: 0.1660626 Test Loss: 0.1448220
Validation loss decreased (0.168137 --> 0.166063).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 14 cost time: 0.8974587917327881
Epoch: 14, Steps: 64 | Train Loss: 0.0939936 Vali Loss: 0.1684302 Test Loss: 0.1438024
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 15 cost time: 0.8952817916870117
Epoch: 15, Steps: 64 | Train Loss: 0.0936968 Vali Loss: 0.1665592 Test Loss: 0.1449997
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 16 cost time: 0.8940014839172363
Epoch: 16, Steps: 64 | Train Loss: 0.0936268 Vali Loss: 0.1666024 Test Loss: 0.1446186
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 17 cost time: 0.9106826782226562
Epoch: 17, Steps: 64 | Train Loss: 0.0927261 Vali Loss: 0.1644779 Test Loss: 0.1442711
Validation loss decreased (0.166063 --> 0.164478).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 18 cost time: 0.9114136695861816
Epoch: 18, Steps: 64 | Train Loss: 0.0920673 Vali Loss: 0.1640709 Test Loss: 0.1432694
Validation loss decreased (0.164478 --> 0.164071).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 19 cost time: 0.9103884696960449
Epoch: 19, Steps: 64 | Train Loss: 0.0921376 Vali Loss: 0.1633755 Test Loss: 0.1431886
Validation loss decreased (0.164071 --> 0.163375).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 20 cost time: 0.9183800220489502
Epoch: 20, Steps: 64 | Train Loss: 0.0913342 Vali Loss: 0.1625991 Test Loss: 0.1431227
Validation loss decreased (0.163375 --> 0.162599).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 21 cost time: 0.9134161472320557
Epoch: 21, Steps: 64 | Train Loss: 0.0917769 Vali Loss: 0.1646255 Test Loss: 0.1439606
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 22 cost time: 0.9068264961242676
Epoch: 22, Steps: 64 | Train Loss: 0.0913844 Vali Loss: 0.1631277 Test Loss: 0.1436876
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 23 cost time: 0.8678059577941895
Epoch: 23, Steps: 64 | Train Loss: 0.0916168 Vali Loss: 0.1653222 Test Loss: 0.1440111
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 24 cost time: 0.8916373252868652
Epoch: 24, Steps: 64 | Train Loss: 0.0912802 Vali Loss: 0.1646015 Test Loss: 0.1438886
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 25 cost time: 0.873504638671875
Epoch: 25, Steps: 64 | Train Loss: 0.0906053 Vali Loss: 0.1639331 Test Loss: 0.1435038
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 26 cost time: 0.9044387340545654
Epoch: 26, Steps: 64 | Train Loss: 0.0906334 Vali Loss: 0.1615344 Test Loss: 0.1434190
Validation loss decreased (0.162599 --> 0.161534).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 27 cost time: 0.9164950847625732
Epoch: 27, Steps: 64 | Train Loss: 0.0902896 Vali Loss: 0.1647642 Test Loss: 0.1435180
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 28 cost time: 0.8891785144805908
Epoch: 28, Steps: 64 | Train Loss: 0.0906121 Vali Loss: 0.1646182 Test Loss: 0.1432035
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 29 cost time: 0.8940014839172363
Epoch: 29, Steps: 64 | Train Loss: 0.0901668 Vali Loss: 0.1649202 Test Loss: 0.1431164
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 30 cost time: 0.8844459056854248
Epoch: 30, Steps: 64 | Train Loss: 0.0903359 Vali Loss: 0.1622226 Test Loss: 0.1431493
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 31 cost time: 0.9066290855407715
Epoch: 31, Steps: 64 | Train Loss: 0.0900686 Vali Loss: 0.1631931 Test Loss: 0.1433700
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 32 cost time: 0.8704195022583008
Epoch: 32, Steps: 64 | Train Loss: 0.0900899 Vali Loss: 0.1603550 Test Loss: 0.1430224
Validation loss decreased (0.161534 --> 0.160355).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 33 cost time: 0.867408037185669
Epoch: 33, Steps: 64 | Train Loss: 0.0900319 Vali Loss: 0.1627942 Test Loss: 0.1428884
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 34 cost time: 0.8982486724853516
Epoch: 34, Steps: 64 | Train Loss: 0.0900427 Vali Loss: 0.1630184 Test Loss: 0.1433350
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 35 cost time: 0.9210000038146973
Epoch: 35, Steps: 64 | Train Loss: 0.0901013 Vali Loss: 0.1621554 Test Loss: 0.1429995
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 36 cost time: 0.9118037223815918
Epoch: 36, Steps: 64 | Train Loss: 0.0897523 Vali Loss: 0.1633503 Test Loss: 0.1432671
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 37 cost time: 0.9166443347930908
Epoch: 37, Steps: 64 | Train Loss: 0.0902964 Vali Loss: 0.1638731 Test Loss: 0.1427941
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 38 cost time: 0.9213931560516357
Epoch: 38, Steps: 64 | Train Loss: 0.0894550 Vali Loss: 0.1629235 Test Loss: 0.1427911
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 39 cost time: 0.9103915691375732
Epoch: 39, Steps: 64 | Train Loss: 0.0901787 Vali Loss: 0.1623432 Test Loss: 0.1430490
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 40 cost time: 0.9104382991790771
Epoch: 40, Steps: 64 | Train Loss: 0.0891885 Vali Loss: 0.1601409 Test Loss: 0.1425616
Validation loss decreased (0.160355 --> 0.160141).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 41 cost time: 0.9161989688873291
Epoch: 41, Steps: 64 | Train Loss: 0.0899133 Vali Loss: 0.1620648 Test Loss: 0.1433717
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 42 cost time: 0.8959968090057373
Epoch: 42, Steps: 64 | Train Loss: 0.0898819 Vali Loss: 0.1616757 Test Loss: 0.1436045
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 43 cost time: 0.8990011215209961
Epoch: 43, Steps: 64 | Train Loss: 0.0895116 Vali Loss: 0.1620929 Test Loss: 0.1432475
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 44 cost time: 0.9116451740264893
Epoch: 44, Steps: 64 | Train Loss: 0.0896225 Vali Loss: 0.1626267 Test Loss: 0.1433810
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 45 cost time: 0.8960874080657959
Epoch: 45, Steps: 64 | Train Loss: 0.0897744 Vali Loss: 0.1628334 Test Loss: 0.1430458
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 46 cost time: 0.8955538272857666
Epoch: 46, Steps: 64 | Train Loss: 0.0893979 Vali Loss: 0.1631285 Test Loss: 0.1429722
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 47 cost time: 0.8914206027984619
Epoch: 47, Steps: 64 | Train Loss: 0.0894683 Vali Loss: 0.1626493 Test Loss: 0.1429016
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 48 cost time: 0.8677854537963867
Epoch: 48, Steps: 64 | Train Loss: 0.0895711 Vali Loss: 0.1612777 Test Loss: 0.1434058
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 49 cost time: 0.8868212699890137
Epoch: 49, Steps: 64 | Train Loss: 0.0896447 Vali Loss: 0.1622773 Test Loss: 0.1429571
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 50 cost time: 0.8866159915924072
Epoch: 50, Steps: 64 | Train Loss: 0.0895530 Vali Loss: 0.1633188 Test Loss: 0.1434468
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 51 cost time: 0.8824050426483154
Epoch: 51, Steps: 64 | Train Loss: 0.0895557 Vali Loss: 0.1622949 Test Loss: 0.1426596
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 52 cost time: 0.8989362716674805
Epoch: 52, Steps: 64 | Train Loss: 0.0894862 Vali Loss: 0.1628502 Test Loss: 0.1434119
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 53 cost time: 0.8943581581115723
Epoch: 53, Steps: 64 | Train Loss: 0.0892757 Vali Loss: 0.1612901 Test Loss: 0.1426460
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 54 cost time: 0.8971335887908936
Epoch: 54, Steps: 64 | Train Loss: 0.0894859 Vali Loss: 0.1625004 Test Loss: 0.1434384
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 55 cost time: 0.9020016193389893
Epoch: 55, Steps: 64 | Train Loss: 0.0895193 Vali Loss: 0.1625590 Test Loss: 0.1432054
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 56 cost time: 0.9006388187408447
Epoch: 56, Steps: 64 | Train Loss: 0.0893668 Vali Loss: 0.1611476 Test Loss: 0.1431500
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 57 cost time: 0.9004607200622559
Epoch: 57, Steps: 64 | Train Loss: 0.0893309 Vali Loss: 0.1618485 Test Loss: 0.1432947
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 58 cost time: 0.8981423377990723
Epoch: 58, Steps: 64 | Train Loss: 0.0895660 Vali Loss: 0.1624181 Test Loss: 0.1428673
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 59 cost time: 0.9024326801300049
Epoch: 59, Steps: 64 | Train Loss: 0.0895650 Vali Loss: 0.1605691 Test Loss: 0.1433033
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01926422119140625 GB
GPU已分配内存的峰值：0.04993915557861328 GB
Epoch: 60 cost time: 0.9104290008544922
Epoch: 60, Steps: 64 | Train Loss: 0.0895519 Vali Loss: 0.1624920 Test Loss: 0.1428650
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14256159961223602, mae:0.2823988199234009, rse:0.20096583664417267
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05301189422607422 GB
Epoch: 1 cost time: 2.3241524696350098
Epoch: 1, Steps: 64 | Train Loss: 0.7728217 Vali Loss: 1.7991413 Test Loss: 3.4399791
Validation loss decreased (inf --> 1.799141).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 2 cost time: 0.9284133911132812
Epoch: 2, Steps: 64 | Train Loss: 0.4235104 Vali Loss: 0.2057793 Test Loss: 0.1771644
Validation loss decreased (1.799141 --> 0.205779).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 3 cost time: 0.933190107345581
Epoch: 3, Steps: 64 | Train Loss: 0.1210943 Vali Loss: 0.2007328 Test Loss: 0.1738130
Validation loss decreased (0.205779 --> 0.200733).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 4 cost time: 0.9225001335144043
Epoch: 4, Steps: 64 | Train Loss: 0.1070638 Vali Loss: 0.1810561 Test Loss: 0.1482694
Validation loss decreased (0.200733 --> 0.181056).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 5 cost time: 0.9103004932403564
Epoch: 5, Steps: 64 | Train Loss: 0.1027317 Vali Loss: 0.1758639 Test Loss: 0.1477356
Validation loss decreased (0.181056 --> 0.175864).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 6 cost time: 0.9224667549133301
Epoch: 6, Steps: 64 | Train Loss: 0.0999958 Vali Loss: 0.1735046 Test Loss: 0.1481264
Validation loss decreased (0.175864 --> 0.173505).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 7 cost time: 0.9099166393280029
Epoch: 7, Steps: 64 | Train Loss: 0.0978391 Vali Loss: 0.1724207 Test Loss: 0.1466022
Validation loss decreased (0.173505 --> 0.172421).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 8 cost time: 0.9125187397003174
Epoch: 8, Steps: 64 | Train Loss: 0.0963787 Vali Loss: 0.1701259 Test Loss: 0.1453166
Validation loss decreased (0.172421 --> 0.170126).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 9 cost time: 0.936403751373291
Epoch: 9, Steps: 64 | Train Loss: 0.0949873 Vali Loss: 0.1687284 Test Loss: 0.1458246
Validation loss decreased (0.170126 --> 0.168728).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 10 cost time: 0.9313585758209229
Epoch: 10, Steps: 64 | Train Loss: 0.0944069 Vali Loss: 0.1675574 Test Loss: 0.1457686
Validation loss decreased (0.168728 --> 0.167557).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 11 cost time: 0.930748701095581
Epoch: 11, Steps: 64 | Train Loss: 0.0932923 Vali Loss: 0.1660295 Test Loss: 0.1445698
Validation loss decreased (0.167557 --> 0.166030).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 12 cost time: 0.9469101428985596
Epoch: 12, Steps: 64 | Train Loss: 0.0926297 Vali Loss: 0.1653939 Test Loss: 0.1451934
Validation loss decreased (0.166030 --> 0.165394).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 13 cost time: 0.9230015277862549
Epoch: 13, Steps: 64 | Train Loss: 0.0926261 Vali Loss: 0.1646972 Test Loss: 0.1455252
Validation loss decreased (0.165394 --> 0.164697).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 14 cost time: 0.9236347675323486
Epoch: 14, Steps: 64 | Train Loss: 0.0917262 Vali Loss: 0.1650966 Test Loss: 0.1439794
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 15 cost time: 0.93241286277771
Epoch: 15, Steps: 64 | Train Loss: 0.0918401 Vali Loss: 0.1659188 Test Loss: 0.1454839
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 16 cost time: 0.9181075096130371
Epoch: 16, Steps: 64 | Train Loss: 0.0913108 Vali Loss: 0.1641682 Test Loss: 0.1435265
Validation loss decreased (0.164697 --> 0.164168).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 17 cost time: 0.9293851852416992
Epoch: 17, Steps: 64 | Train Loss: 0.0908652 Vali Loss: 0.1628527 Test Loss: 0.1442362
Validation loss decreased (0.164168 --> 0.162853).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 18 cost time: 0.9524617195129395
Epoch: 18, Steps: 64 | Train Loss: 0.0905033 Vali Loss: 0.1645133 Test Loss: 0.1441283
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 19 cost time: 0.9374923706054688
Epoch: 19, Steps: 64 | Train Loss: 0.0900239 Vali Loss: 0.1622240 Test Loss: 0.1439899
Validation loss decreased (0.162853 --> 0.162224).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 20 cost time: 0.9454977512359619
Epoch: 20, Steps: 64 | Train Loss: 0.0896439 Vali Loss: 0.1634475 Test Loss: 0.1447266
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 21 cost time: 0.9303348064422607
Epoch: 21, Steps: 64 | Train Loss: 0.0898675 Vali Loss: 0.1629228 Test Loss: 0.1450248
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 22 cost time: 0.9160003662109375
Epoch: 22, Steps: 64 | Train Loss: 0.0900014 Vali Loss: 0.1617549 Test Loss: 0.1438099
Validation loss decreased (0.162224 --> 0.161755).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 23 cost time: 0.9246573448181152
Epoch: 23, Steps: 64 | Train Loss: 0.0895939 Vali Loss: 0.1634294 Test Loss: 0.1442952
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 24 cost time: 0.9092278480529785
Epoch: 24, Steps: 64 | Train Loss: 0.0892936 Vali Loss: 0.1620001 Test Loss: 0.1448014
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 25 cost time: 0.9244537353515625
Epoch: 25, Steps: 64 | Train Loss: 0.0890727 Vali Loss: 0.1628643 Test Loss: 0.1443247
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 26 cost time: 0.9314472675323486
Epoch: 26, Steps: 64 | Train Loss: 0.0886500 Vali Loss: 0.1628547 Test Loss: 0.1446971
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 27 cost time: 0.9295148849487305
Epoch: 27, Steps: 64 | Train Loss: 0.0893167 Vali Loss: 0.1622101 Test Loss: 0.1440109
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 28 cost time: 0.9272000789642334
Epoch: 28, Steps: 64 | Train Loss: 0.0890914 Vali Loss: 0.1607547 Test Loss: 0.1445022
Validation loss decreased (0.161755 --> 0.160755).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 29 cost time: 0.9219975471496582
Epoch: 29, Steps: 64 | Train Loss: 0.0884580 Vali Loss: 0.1596242 Test Loss: 0.1447691
Validation loss decreased (0.160755 --> 0.159624).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 30 cost time: 0.9210002422332764
Epoch: 30, Steps: 64 | Train Loss: 0.0886720 Vali Loss: 0.1617907 Test Loss: 0.1444392
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 31 cost time: 0.9136371612548828
Epoch: 31, Steps: 64 | Train Loss: 0.0887010 Vali Loss: 0.1614143 Test Loss: 0.1444303
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 32 cost time: 0.9109034538269043
Epoch: 32, Steps: 64 | Train Loss: 0.0886531 Vali Loss: 0.1600982 Test Loss: 0.1446103
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 33 cost time: 0.9364244937896729
Epoch: 33, Steps: 64 | Train Loss: 0.0881658 Vali Loss: 0.1598099 Test Loss: 0.1439698
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 34 cost time: 0.9465107917785645
Epoch: 34, Steps: 64 | Train Loss: 0.0882761 Vali Loss: 0.1606999 Test Loss: 0.1449116
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 35 cost time: 0.9444010257720947
Epoch: 35, Steps: 64 | Train Loss: 0.0878782 Vali Loss: 0.1619630 Test Loss: 0.1440827
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 36 cost time: 0.9427323341369629
Epoch: 36, Steps: 64 | Train Loss: 0.0883917 Vali Loss: 0.1617327 Test Loss: 0.1443012
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 37 cost time: 0.951836347579956
Epoch: 37, Steps: 64 | Train Loss: 0.0881899 Vali Loss: 0.1599474 Test Loss: 0.1443275
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 38 cost time: 0.9299154281616211
Epoch: 38, Steps: 64 | Train Loss: 0.0884069 Vali Loss: 0.1603860 Test Loss: 0.1442095
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 39 cost time: 0.9296457767486572
Epoch: 39, Steps: 64 | Train Loss: 0.0882590 Vali Loss: 0.1612273 Test Loss: 0.1445005
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 40 cost time: 0.9334471225738525
Epoch: 40, Steps: 64 | Train Loss: 0.0880997 Vali Loss: 0.1603125 Test Loss: 0.1440618
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 41 cost time: 0.9270238876342773
Epoch: 41, Steps: 64 | Train Loss: 0.0880008 Vali Loss: 0.1613843 Test Loss: 0.1449557
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 42 cost time: 0.947350025177002
Epoch: 42, Steps: 64 | Train Loss: 0.0884058 Vali Loss: 0.1620927 Test Loss: 0.1445130
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 43 cost time: 0.927438497543335
Epoch: 43, Steps: 64 | Train Loss: 0.0882351 Vali Loss: 0.1606684 Test Loss: 0.1447221
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 44 cost time: 0.9194715023040771
Epoch: 44, Steps: 64 | Train Loss: 0.0878215 Vali Loss: 0.1618707 Test Loss: 0.1445007
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 45 cost time: 0.926182746887207
Epoch: 45, Steps: 64 | Train Loss: 0.0880827 Vali Loss: 0.1601879 Test Loss: 0.1447428
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 46 cost time: 0.9160003662109375
Epoch: 46, Steps: 64 | Train Loss: 0.0884967 Vali Loss: 0.1603534 Test Loss: 0.1443034
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 47 cost time: 0.9190609455108643
Epoch: 47, Steps: 64 | Train Loss: 0.0881509 Vali Loss: 0.1618444 Test Loss: 0.1445489
EarlyStopping counter: 18 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 48 cost time: 0.9083781242370605
Epoch: 48, Steps: 64 | Train Loss: 0.0877621 Vali Loss: 0.1607182 Test Loss: 0.1442493
EarlyStopping counter: 19 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 49 cost time: 0.9154701232910156
Epoch: 49, Steps: 64 | Train Loss: 0.0878361 Vali Loss: 0.1606822 Test Loss: 0.1441496
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 50 cost time: 0.9264345169067383
Epoch: 50, Steps: 64 | Train Loss: 0.0879441 Vali Loss: 0.1611082 Test Loss: 0.1445952
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 51 cost time: 0.9283699989318848
Epoch: 51, Steps: 64 | Train Loss: 0.0879401 Vali Loss: 0.1614383 Test Loss: 0.1448316
EarlyStopping counter: 22 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 52 cost time: 0.9268288612365723
Epoch: 52, Steps: 64 | Train Loss: 0.0876772 Vali Loss: 0.1607814 Test Loss: 0.1441400
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 53 cost time: 0.9293527603149414
Epoch: 53, Steps: 64 | Train Loss: 0.0876328 Vali Loss: 0.1565958 Test Loss: 0.1443264
Validation loss decreased (0.159624 --> 0.156596).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 54 cost time: 0.9089996814727783
Epoch: 54, Steps: 64 | Train Loss: 0.0880815 Vali Loss: 0.1610015 Test Loss: 0.1447844
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 55 cost time: 0.9266254901885986
Epoch: 55, Steps: 64 | Train Loss: 0.0882116 Vali Loss: 0.1586806 Test Loss: 0.1448384
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 56 cost time: 0.9274046421051025
Epoch: 56, Steps: 64 | Train Loss: 0.0877206 Vali Loss: 0.1611917 Test Loss: 0.1452511
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 57 cost time: 0.9311563968658447
Epoch: 57, Steps: 64 | Train Loss: 0.0879526 Vali Loss: 0.1617558 Test Loss: 0.1451520
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 58 cost time: 0.9444262981414795
Epoch: 58, Steps: 64 | Train Loss: 0.0876439 Vali Loss: 0.1608203 Test Loss: 0.1445311
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 59 cost time: 0.9461660385131836
Epoch: 59, Steps: 64 | Train Loss: 0.0880275 Vali Loss: 0.1608152 Test Loss: 0.1452030
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02013397216796875 GB
GPU已分配内存的峰值：0.05518341064453125 GB
Epoch: 60 cost time: 0.9517664909362793
Epoch: 60, Steps: 64 | Train Loss: 0.0878740 Vali Loss: 0.1582103 Test Loss: 0.1446937
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1443263292312622, mae:0.285582959651947, rse:0.2022058665752411
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04588603973388672 GB
Epoch: 1 cost time: 2.2896921634674072
Epoch: 1, Steps: 64 | Train Loss: 0.8134725 Vali Loss: 1.8212461 Test Loss: 3.4508507
Validation loss decreased (inf --> 1.821246).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 2 cost time: 0.8790669441223145
Epoch: 2, Steps: 64 | Train Loss: 0.6956481 Vali Loss: 1.3205366 Test Loss: 2.4133523
Validation loss decreased (1.821246 --> 1.320537).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 3 cost time: 0.8938586711883545
Epoch: 3, Steps: 64 | Train Loss: 0.5181186 Vali Loss: 0.9829299 Test Loss: 1.7004731
Validation loss decreased (1.320537 --> 0.982930).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 4 cost time: 0.8729994297027588
Epoch: 4, Steps: 64 | Train Loss: 0.3918628 Vali Loss: 0.7617213 Test Loss: 1.2390490
Validation loss decreased (0.982930 --> 0.761721).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 5 cost time: 0.8646364212036133
Epoch: 5, Steps: 64 | Train Loss: 0.3058387 Vali Loss: 0.6149554 Test Loss: 0.9442760
Validation loss decreased (0.761721 --> 0.614955).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 6 cost time: 0.8611085414886475
Epoch: 6, Steps: 64 | Train Loss: 0.2481044 Vali Loss: 0.5104628 Test Loss: 0.7394418
Validation loss decreased (0.614955 --> 0.510463).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 7 cost time: 0.8644752502441406
Epoch: 7, Steps: 64 | Train Loss: 0.2099620 Vali Loss: 0.4409666 Test Loss: 0.5998858
Validation loss decreased (0.510463 --> 0.440967).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 8 cost time: 0.8583738803863525
Epoch: 8, Steps: 64 | Train Loss: 0.1832470 Vali Loss: 0.3807403 Test Loss: 0.4897991
Validation loss decreased (0.440967 --> 0.380740).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 9 cost time: 0.8607590198516846
Epoch: 9, Steps: 64 | Train Loss: 0.1638068 Vali Loss: 0.3354153 Test Loss: 0.4123345
Validation loss decreased (0.380740 --> 0.335415).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 10 cost time: 0.87400221824646
Epoch: 10, Steps: 64 | Train Loss: 0.1503668 Vali Loss: 0.3059906 Test Loss: 0.3569255
Validation loss decreased (0.335415 --> 0.305991).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 11 cost time: 0.8797662258148193
Epoch: 11, Steps: 64 | Train Loss: 0.1401302 Vali Loss: 0.2777169 Test Loss: 0.3110737
Validation loss decreased (0.305991 --> 0.277717).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 12 cost time: 0.8963923454284668
Epoch: 12, Steps: 64 | Train Loss: 0.1326725 Vali Loss: 0.2631900 Test Loss: 0.2877387
Validation loss decreased (0.277717 --> 0.263190).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 13 cost time: 0.8943808078765869
Epoch: 13, Steps: 64 | Train Loss: 0.1262928 Vali Loss: 0.2506946 Test Loss: 0.2627469
Validation loss decreased (0.263190 --> 0.250695).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 14 cost time: 0.8925013542175293
Epoch: 14, Steps: 64 | Train Loss: 0.1221907 Vali Loss: 0.2378267 Test Loss: 0.2435120
Validation loss decreased (0.250695 --> 0.237827).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 15 cost time: 0.8718819618225098
Epoch: 15, Steps: 64 | Train Loss: 0.1186200 Vali Loss: 0.2299239 Test Loss: 0.2304302
Validation loss decreased (0.237827 --> 0.229924).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 16 cost time: 0.8723611831665039
Epoch: 16, Steps: 64 | Train Loss: 0.1155673 Vali Loss: 0.2235886 Test Loss: 0.2192221
Validation loss decreased (0.229924 --> 0.223589).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 17 cost time: 0.8666412830352783
Epoch: 17, Steps: 64 | Train Loss: 0.1131687 Vali Loss: 0.2160618 Test Loss: 0.2087329
Validation loss decreased (0.223589 --> 0.216062).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 18 cost time: 0.8862781524658203
Epoch: 18, Steps: 64 | Train Loss: 0.1113387 Vali Loss: 0.2110818 Test Loss: 0.2031619
Validation loss decreased (0.216062 --> 0.211082).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 19 cost time: 0.8893289566040039
Epoch: 19, Steps: 64 | Train Loss: 0.1103227 Vali Loss: 0.2054433 Test Loss: 0.1937255
Validation loss decreased (0.211082 --> 0.205443).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 20 cost time: 0.8933556079864502
Epoch: 20, Steps: 64 | Train Loss: 0.1084662 Vali Loss: 0.2020993 Test Loss: 0.1919403
Validation loss decreased (0.205443 --> 0.202099).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 21 cost time: 0.8907930850982666
Epoch: 21, Steps: 64 | Train Loss: 0.1074872 Vali Loss: 0.1999041 Test Loss: 0.1875779
Validation loss decreased (0.202099 --> 0.199904).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 22 cost time: 0.8830010890960693
Epoch: 22, Steps: 64 | Train Loss: 0.1066851 Vali Loss: 0.1989929 Test Loss: 0.1842941
Validation loss decreased (0.199904 --> 0.198993).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 23 cost time: 0.8650000095367432
Epoch: 23, Steps: 64 | Train Loss: 0.1062751 Vali Loss: 0.1938982 Test Loss: 0.1794935
Validation loss decreased (0.198993 --> 0.193898).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 24 cost time: 0.8553652763366699
Epoch: 24, Steps: 64 | Train Loss: 0.1052835 Vali Loss: 0.1927820 Test Loss: 0.1784598
Validation loss decreased (0.193898 --> 0.192782).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 25 cost time: 0.8660404682159424
Epoch: 25, Steps: 64 | Train Loss: 0.1045141 Vali Loss: 0.1922237 Test Loss: 0.1763492
Validation loss decreased (0.192782 --> 0.192224).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 26 cost time: 0.8955659866333008
Epoch: 26, Steps: 64 | Train Loss: 0.1043450 Vali Loss: 0.1908517 Test Loss: 0.1751960
Validation loss decreased (0.192224 --> 0.190852).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 27 cost time: 0.8722712993621826
Epoch: 27, Steps: 64 | Train Loss: 0.1039278 Vali Loss: 0.1872934 Test Loss: 0.1733016
Validation loss decreased (0.190852 --> 0.187293).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 28 cost time: 0.8799998760223389
Epoch: 28, Steps: 64 | Train Loss: 0.1032850 Vali Loss: 0.1896009 Test Loss: 0.1714627
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 29 cost time: 0.8859481811523438
Epoch: 29, Steps: 64 | Train Loss: 0.1031325 Vali Loss: 0.1890239 Test Loss: 0.1722809
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 30 cost time: 0.8803670406341553
Epoch: 30, Steps: 64 | Train Loss: 0.1021129 Vali Loss: 0.1857890 Test Loss: 0.1684969
Validation loss decreased (0.187293 --> 0.185789).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 31 cost time: 0.8722758293151855
Epoch: 31, Steps: 64 | Train Loss: 0.1024587 Vali Loss: 0.1832032 Test Loss: 0.1672195
Validation loss decreased (0.185789 --> 0.183203).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 32 cost time: 0.8643832206726074
Epoch: 32, Steps: 64 | Train Loss: 0.1021703 Vali Loss: 0.1837131 Test Loss: 0.1666713
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 33 cost time: 0.8591055870056152
Epoch: 33, Steps: 64 | Train Loss: 0.1017026 Vali Loss: 0.1852388 Test Loss: 0.1657663
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 34 cost time: 0.8636415004730225
Epoch: 34, Steps: 64 | Train Loss: 0.1015685 Vali Loss: 0.1838437 Test Loss: 0.1656768
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 35 cost time: 0.880634069442749
Epoch: 35, Steps: 64 | Train Loss: 0.1014595 Vali Loss: 0.1834122 Test Loss: 0.1643860
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 36 cost time: 0.901839017868042
Epoch: 36, Steps: 64 | Train Loss: 0.1012829 Vali Loss: 0.1829821 Test Loss: 0.1645346
Validation loss decreased (0.183203 --> 0.182982).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 37 cost time: 0.8914294242858887
Epoch: 37, Steps: 64 | Train Loss: 0.1014770 Vali Loss: 0.1832390 Test Loss: 0.1639873
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 38 cost time: 0.8910126686096191
Epoch: 38, Steps: 64 | Train Loss: 0.1009210 Vali Loss: 0.1825140 Test Loss: 0.1639637
Validation loss decreased (0.182982 --> 0.182514).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 39 cost time: 0.8877506256103516
Epoch: 39, Steps: 64 | Train Loss: 0.1007710 Vali Loss: 0.1830459 Test Loss: 0.1632940
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 40 cost time: 0.8730001449584961
Epoch: 40, Steps: 64 | Train Loss: 0.1010331 Vali Loss: 0.1798889 Test Loss: 0.1648712
Validation loss decreased (0.182514 --> 0.179889).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 41 cost time: 0.8716368675231934
Epoch: 41, Steps: 64 | Train Loss: 0.1006084 Vali Loss: 0.1808264 Test Loss: 0.1633571
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 42 cost time: 0.8751785755157471
Epoch: 42, Steps: 64 | Train Loss: 0.1011227 Vali Loss: 0.1813491 Test Loss: 0.1622572
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 43 cost time: 0.8793885707855225
Epoch: 43, Steps: 64 | Train Loss: 0.1006519 Vali Loss: 0.1793210 Test Loss: 0.1617339
Validation loss decreased (0.179889 --> 0.179321).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 44 cost time: 0.8873627185821533
Epoch: 44, Steps: 64 | Train Loss: 0.1007679 Vali Loss: 0.1799777 Test Loss: 0.1617236
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 45 cost time: 0.8937609195709229
Epoch: 45, Steps: 64 | Train Loss: 0.1004012 Vali Loss: 0.1783523 Test Loss: 0.1619239
Validation loss decreased (0.179321 --> 0.178352).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 46 cost time: 0.879997968673706
Epoch: 46, Steps: 64 | Train Loss: 0.1002153 Vali Loss: 0.1818047 Test Loss: 0.1624294
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 47 cost time: 0.8556170463562012
Epoch: 47, Steps: 64 | Train Loss: 0.1003165 Vali Loss: 0.1810217 Test Loss: 0.1609127
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 48 cost time: 0.8764603137969971
Epoch: 48, Steps: 64 | Train Loss: 0.1001922 Vali Loss: 0.1798500 Test Loss: 0.1623647
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 49 cost time: 0.8583896160125732
Epoch: 49, Steps: 64 | Train Loss: 0.1001281 Vali Loss: 0.1797931 Test Loss: 0.1610104
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 50 cost time: 0.8643970489501953
Epoch: 50, Steps: 64 | Train Loss: 0.1002306 Vali Loss: 0.1803851 Test Loss: 0.1620189
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 51 cost time: 0.8594350814819336
Epoch: 51, Steps: 64 | Train Loss: 0.1000966 Vali Loss: 0.1774248 Test Loss: 0.1606602
Validation loss decreased (0.178352 --> 0.177425).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 52 cost time: 0.8597419261932373
Epoch: 52, Steps: 64 | Train Loss: 0.1002990 Vali Loss: 0.1796537 Test Loss: 0.1618248
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 53 cost time: 0.8706448078155518
Epoch: 53, Steps: 64 | Train Loss: 0.0999040 Vali Loss: 0.1804729 Test Loss: 0.1607346
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 54 cost time: 0.8853518962860107
Epoch: 54, Steps: 64 | Train Loss: 0.1000881 Vali Loss: 0.1778599 Test Loss: 0.1608377
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 55 cost time: 0.8793771266937256
Epoch: 55, Steps: 64 | Train Loss: 0.0999386 Vali Loss: 0.1792820 Test Loss: 0.1604101
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 56 cost time: 0.8753726482391357
Epoch: 56, Steps: 64 | Train Loss: 0.1001594 Vali Loss: 0.1798747 Test Loss: 0.1614924
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 57 cost time: 0.8839986324310303
Epoch: 57, Steps: 64 | Train Loss: 0.1001565 Vali Loss: 0.1765999 Test Loss: 0.1601497
Validation loss decreased (0.177425 --> 0.176600).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 58 cost time: 0.867999792098999
Epoch: 58, Steps: 64 | Train Loss: 0.0996520 Vali Loss: 0.1783288 Test Loss: 0.1598421
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 59 cost time: 0.8724267482757568
Epoch: 59, Steps: 64 | Train Loss: 0.1004994 Vali Loss: 0.1811529 Test Loss: 0.1613483
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017551422119140625 GB
GPU已分配内存的峰值：0.04606437683105469 GB
Epoch: 60 cost time: 0.87601637840271
Epoch: 60, Steps: 64 | Train Loss: 0.0998161 Vali Loss: 0.1779005 Test Loss: 0.1604029
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1601497381925583, mae:0.3085395097732544, rse:0.21300220489501953
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 1 cost time: 2.3023719787597656
Epoch: 1, Steps: 64 | Train Loss: 0.7695651 Vali Loss: 1.7793683 Test Loss: 3.3511248
Validation loss decreased (inf --> 1.779368).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 2 cost time: 0.9162619113922119
Epoch: 2, Steps: 64 | Train Loss: 0.5054384 Vali Loss: 0.5519363 Test Loss: 0.7908002
Validation loss decreased (1.779368 --> 0.551936).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 3 cost time: 0.918433427810669
Epoch: 3, Steps: 64 | Train Loss: 0.1604487 Vali Loss: 0.2057059 Test Loss: 0.1612812
Validation loss decreased (0.551936 --> 0.205706).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 4 cost time: 0.9200594425201416
Epoch: 4, Steps: 64 | Train Loss: 0.1137777 Vali Loss: 0.1885800 Test Loss: 0.1547337
Validation loss decreased (0.205706 --> 0.188580).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 5 cost time: 0.8917453289031982
Epoch: 5, Steps: 64 | Train Loss: 0.1066223 Vali Loss: 0.1826549 Test Loss: 0.1506096
Validation loss decreased (0.188580 --> 0.182655).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 6 cost time: 0.8939986228942871
Epoch: 6, Steps: 64 | Train Loss: 0.1033440 Vali Loss: 0.1763935 Test Loss: 0.1475385
Validation loss decreased (0.182655 --> 0.176393).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 7 cost time: 0.897618293762207
Epoch: 7, Steps: 64 | Train Loss: 0.1006614 Vali Loss: 0.1740311 Test Loss: 0.1466690
Validation loss decreased (0.176393 --> 0.174031).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 8 cost time: 0.9036123752593994
Epoch: 8, Steps: 64 | Train Loss: 0.0988886 Vali Loss: 0.1737049 Test Loss: 0.1453063
Validation loss decreased (0.174031 --> 0.173705).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 9 cost time: 0.9163973331451416
Epoch: 9, Steps: 64 | Train Loss: 0.0980059 Vali Loss: 0.1691345 Test Loss: 0.1441090
Validation loss decreased (0.173705 --> 0.169135).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 10 cost time: 0.9340436458587646
Epoch: 10, Steps: 64 | Train Loss: 0.0965109 Vali Loss: 0.1692080 Test Loss: 0.1444135
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 11 cost time: 0.9546458721160889
Epoch: 11, Steps: 64 | Train Loss: 0.0957710 Vali Loss: 0.1693236 Test Loss: 0.1440568
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 12 cost time: 0.9243881702423096
Epoch: 12, Steps: 64 | Train Loss: 0.0943891 Vali Loss: 0.1655310 Test Loss: 0.1432811
Validation loss decreased (0.169135 --> 0.165531).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 13 cost time: 0.9158291816711426
Epoch: 13, Steps: 64 | Train Loss: 0.0938112 Vali Loss: 0.1637293 Test Loss: 0.1429591
Validation loss decreased (0.165531 --> 0.163729).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 14 cost time: 0.9119179248809814
Epoch: 14, Steps: 64 | Train Loss: 0.0938112 Vali Loss: 0.1648088 Test Loss: 0.1425450
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 15 cost time: 0.9056510925292969
Epoch: 15, Steps: 64 | Train Loss: 0.0927205 Vali Loss: 0.1638502 Test Loss: 0.1427708
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 16 cost time: 0.9054327011108398
Epoch: 16, Steps: 64 | Train Loss: 0.0923378 Vali Loss: 0.1631774 Test Loss: 0.1428358
Validation loss decreased (0.163729 --> 0.163177).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 17 cost time: 0.9124810695648193
Epoch: 17, Steps: 64 | Train Loss: 0.0921979 Vali Loss: 0.1620906 Test Loss: 0.1424864
Validation loss decreased (0.163177 --> 0.162091).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 18 cost time: 0.9174156188964844
Epoch: 18, Steps: 64 | Train Loss: 0.0921867 Vali Loss: 0.1617879 Test Loss: 0.1428801
Validation loss decreased (0.162091 --> 0.161788).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 19 cost time: 0.9314985275268555
Epoch: 19, Steps: 64 | Train Loss: 0.0916285 Vali Loss: 0.1629798 Test Loss: 0.1429282
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 20 cost time: 0.9323818683624268
Epoch: 20, Steps: 64 | Train Loss: 0.0912826 Vali Loss: 0.1627503 Test Loss: 0.1426639
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 21 cost time: 0.9297702312469482
Epoch: 21, Steps: 64 | Train Loss: 0.0913986 Vali Loss: 0.1634252 Test Loss: 0.1428567
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 22 cost time: 0.9070403575897217
Epoch: 22, Steps: 64 | Train Loss: 0.0909289 Vali Loss: 0.1620500 Test Loss: 0.1429960
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 23 cost time: 0.9003503322601318
Epoch: 23, Steps: 64 | Train Loss: 0.0912439 Vali Loss: 0.1606673 Test Loss: 0.1423163
Validation loss decreased (0.161788 --> 0.160667).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 24 cost time: 0.8913965225219727
Epoch: 24, Steps: 64 | Train Loss: 0.0910051 Vali Loss: 0.1619501 Test Loss: 0.1426222
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 25 cost time: 0.893404483795166
Epoch: 25, Steps: 64 | Train Loss: 0.0907497 Vali Loss: 0.1611640 Test Loss: 0.1426717
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 26 cost time: 0.9114072322845459
Epoch: 26, Steps: 64 | Train Loss: 0.0901609 Vali Loss: 0.1617723 Test Loss: 0.1424314
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 27 cost time: 0.9123892784118652
Epoch: 27, Steps: 64 | Train Loss: 0.0900101 Vali Loss: 0.1618136 Test Loss: 0.1429527
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 28 cost time: 0.9098145961761475
Epoch: 28, Steps: 64 | Train Loss: 0.0898900 Vali Loss: 0.1607561 Test Loss: 0.1424061
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 29 cost time: 0.9110000133514404
Epoch: 29, Steps: 64 | Train Loss: 0.0904242 Vali Loss: 0.1610862 Test Loss: 0.1427462
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 30 cost time: 0.8936333656311035
Epoch: 30, Steps: 64 | Train Loss: 0.0897662 Vali Loss: 0.1599375 Test Loss: 0.1428500
Validation loss decreased (0.160667 --> 0.159938).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 31 cost time: 0.8913898468017578
Epoch: 31, Steps: 64 | Train Loss: 0.0898906 Vali Loss: 0.1603431 Test Loss: 0.1432022
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 32 cost time: 0.8933680057525635
Epoch: 32, Steps: 64 | Train Loss: 0.0896449 Vali Loss: 0.1605144 Test Loss: 0.1424995
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 33 cost time: 0.89839768409729
Epoch: 33, Steps: 64 | Train Loss: 0.0892950 Vali Loss: 0.1615396 Test Loss: 0.1430576
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 34 cost time: 0.9273476600646973
Epoch: 34, Steps: 64 | Train Loss: 0.0898031 Vali Loss: 0.1607885 Test Loss: 0.1426552
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 35 cost time: 0.9412379264831543
Epoch: 35, Steps: 64 | Train Loss: 0.0897593 Vali Loss: 0.1600654 Test Loss: 0.1430781
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 36 cost time: 0.9277629852294922
Epoch: 36, Steps: 64 | Train Loss: 0.0897769 Vali Loss: 0.1595775 Test Loss: 0.1423558
Validation loss decreased (0.159938 --> 0.159578).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 37 cost time: 0.9256231784820557
Epoch: 37, Steps: 64 | Train Loss: 0.0893824 Vali Loss: 0.1574855 Test Loss: 0.1426669
Validation loss decreased (0.159578 --> 0.157486).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 38 cost time: 0.932633638381958
Epoch: 38, Steps: 64 | Train Loss: 0.0900635 Vali Loss: 0.1608613 Test Loss: 0.1426418
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 39 cost time: 0.9170284271240234
Epoch: 39, Steps: 64 | Train Loss: 0.0893708 Vali Loss: 0.1600589 Test Loss: 0.1430853
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 40 cost time: 0.9073820114135742
Epoch: 40, Steps: 64 | Train Loss: 0.0893420 Vali Loss: 0.1604370 Test Loss: 0.1426430
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 41 cost time: 0.9103794097900391
Epoch: 41, Steps: 64 | Train Loss: 0.0895502 Vali Loss: 0.1614551 Test Loss: 0.1429273
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 42 cost time: 0.9205987453460693
Epoch: 42, Steps: 64 | Train Loss: 0.0897934 Vali Loss: 0.1615550 Test Loss: 0.1428078
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 43 cost time: 0.9367237091064453
Epoch: 43, Steps: 64 | Train Loss: 0.0892654 Vali Loss: 0.1616828 Test Loss: 0.1425860
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 44 cost time: 0.9120016098022461
Epoch: 44, Steps: 64 | Train Loss: 0.0890621 Vali Loss: 0.1585034 Test Loss: 0.1424295
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 45 cost time: 0.9146242141723633
Epoch: 45, Steps: 64 | Train Loss: 0.0895540 Vali Loss: 0.1578769 Test Loss: 0.1425937
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 46 cost time: 0.9284670352935791
Epoch: 46, Steps: 64 | Train Loss: 0.0896643 Vali Loss: 0.1607364 Test Loss: 0.1434060
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 47 cost time: 0.8973772525787354
Epoch: 47, Steps: 64 | Train Loss: 0.0890822 Vali Loss: 0.1603532 Test Loss: 0.1426278
EarlyStopping counter: 10 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 48 cost time: 0.8981873989105225
Epoch: 48, Steps: 64 | Train Loss: 0.0895387 Vali Loss: 0.1600105 Test Loss: 0.1430121
EarlyStopping counter: 11 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 49 cost time: 0.898461103439331
Epoch: 49, Steps: 64 | Train Loss: 0.0894726 Vali Loss: 0.1608089 Test Loss: 0.1429635
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 50 cost time: 0.8927888870239258
Epoch: 50, Steps: 64 | Train Loss: 0.0892173 Vali Loss: 0.1603904 Test Loss: 0.1430174
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 51 cost time: 0.9129016399383545
Epoch: 51, Steps: 64 | Train Loss: 0.0896539 Vali Loss: 0.1592761 Test Loss: 0.1426340
EarlyStopping counter: 14 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 52 cost time: 0.9110124111175537
Epoch: 52, Steps: 64 | Train Loss: 0.0892613 Vali Loss: 0.1598124 Test Loss: 0.1429354
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 53 cost time: 0.918623685836792
Epoch: 53, Steps: 64 | Train Loss: 0.0889729 Vali Loss: 0.1597395 Test Loss: 0.1426667
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 54 cost time: 0.9175069332122803
Epoch: 54, Steps: 64 | Train Loss: 0.0891483 Vali Loss: 0.1607182 Test Loss: 0.1431536
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 55 cost time: 0.9074380397796631
Epoch: 55, Steps: 64 | Train Loss: 0.0890722 Vali Loss: 0.1602470 Test Loss: 0.1431054
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 56 cost time: 0.917532205581665
Epoch: 56, Steps: 64 | Train Loss: 0.0889042 Vali Loss: 0.1606897 Test Loss: 0.1428482
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 57 cost time: 0.907116174697876
Epoch: 57, Steps: 64 | Train Loss: 0.0889749 Vali Loss: 0.1594570 Test Loss: 0.1428605
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 58 cost time: 0.9030003547668457
Epoch: 58, Steps: 64 | Train Loss: 0.0888998 Vali Loss: 0.1607740 Test Loss: 0.1427106
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 59 cost time: 0.9286222457885742
Epoch: 59, Steps: 64 | Train Loss: 0.0890863 Vali Loss: 0.1582844 Test Loss: 0.1427210
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019268035888671875 GB
GPU已分配内存的峰值：0.05010032653808594 GB
Epoch: 60 cost time: 0.9216344356536865
Epoch: 60, Steps: 64 | Train Loss: 0.0891751 Vali Loss: 0.1596642 Test Loss: 0.1428215
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14266693592071533, mae:0.2807600200176239, rse:0.2010400891304016
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.053173065185546875 GB
Epoch: 1 cost time: 2.321770191192627
Epoch: 1, Steps: 64 | Train Loss: 0.7615729 Vali Loss: 1.7765059 Test Loss: 3.3851643
Validation loss decreased (inf --> 1.776506).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 2 cost time: 0.9442965984344482
Epoch: 2, Steps: 64 | Train Loss: 0.4066298 Vali Loss: 0.2121632 Test Loss: 0.1566673
Validation loss decreased (1.776506 --> 0.212163).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 3 cost time: 0.9328300952911377
Epoch: 3, Steps: 64 | Train Loss: 0.1206247 Vali Loss: 0.2004819 Test Loss: 0.1775536
Validation loss decreased (0.212163 --> 0.200482).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 4 cost time: 0.9383630752563477
Epoch: 4, Steps: 64 | Train Loss: 0.1063362 Vali Loss: 0.1787458 Test Loss: 0.1471608
Validation loss decreased (0.200482 --> 0.178746).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 5 cost time: 0.9211738109588623
Epoch: 5, Steps: 64 | Train Loss: 0.1011017 Vali Loss: 0.1759353 Test Loss: 0.1474587
Validation loss decreased (0.178746 --> 0.175935).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 6 cost time: 0.9284963607788086
Epoch: 6, Steps: 64 | Train Loss: 0.0986516 Vali Loss: 0.1733849 Test Loss: 0.1439642
Validation loss decreased (0.175935 --> 0.173385).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 7 cost time: 0.9184277057647705
Epoch: 7, Steps: 64 | Train Loss: 0.0968408 Vali Loss: 0.1688169 Test Loss: 0.1438457
Validation loss decreased (0.173385 --> 0.168817).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 8 cost time: 0.9215266704559326
Epoch: 8, Steps: 64 | Train Loss: 0.0957072 Vali Loss: 0.1713628 Test Loss: 0.1439717
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 9 cost time: 0.945885181427002
Epoch: 9, Steps: 64 | Train Loss: 0.0947208 Vali Loss: 0.1691666 Test Loss: 0.1449748
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 10 cost time: 0.9416203498840332
Epoch: 10, Steps: 64 | Train Loss: 0.0935239 Vali Loss: 0.1683898 Test Loss: 0.1446328
Validation loss decreased (0.168817 --> 0.168390).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 11 cost time: 0.9516382217407227
Epoch: 11, Steps: 64 | Train Loss: 0.0932015 Vali Loss: 0.1669602 Test Loss: 0.1441657
Validation loss decreased (0.168390 --> 0.166960).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 12 cost time: 0.9536359310150146
Epoch: 12, Steps: 64 | Train Loss: 0.0922632 Vali Loss: 0.1656944 Test Loss: 0.1447724
Validation loss decreased (0.166960 --> 0.165694).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 13 cost time: 0.9474387168884277
Epoch: 13, Steps: 64 | Train Loss: 0.0917366 Vali Loss: 0.1659516 Test Loss: 0.1443445
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 14 cost time: 0.9389917850494385
Epoch: 14, Steps: 64 | Train Loss: 0.0913462 Vali Loss: 0.1669547 Test Loss: 0.1442667
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 15 cost time: 0.9383976459503174
Epoch: 15, Steps: 64 | Train Loss: 0.0906567 Vali Loss: 0.1636235 Test Loss: 0.1444730
Validation loss decreased (0.165694 --> 0.163623).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 16 cost time: 0.9484012126922607
Epoch: 16, Steps: 64 | Train Loss: 0.0908767 Vali Loss: 0.1639012 Test Loss: 0.1452589
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 17 cost time: 0.9543490409851074
Epoch: 17, Steps: 64 | Train Loss: 0.0901871 Vali Loss: 0.1653850 Test Loss: 0.1440087
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 18 cost time: 0.953157901763916
Epoch: 18, Steps: 64 | Train Loss: 0.0897343 Vali Loss: 0.1646896 Test Loss: 0.1447431
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 19 cost time: 0.9550013542175293
Epoch: 19, Steps: 64 | Train Loss: 0.0894269 Vali Loss: 0.1609134 Test Loss: 0.1440183
Validation loss decreased (0.163623 --> 0.160913).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 20 cost time: 0.9510016441345215
Epoch: 20, Steps: 64 | Train Loss: 0.0894008 Vali Loss: 0.1635611 Test Loss: 0.1450441
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 21 cost time: 0.9416253566741943
Epoch: 21, Steps: 64 | Train Loss: 0.0892925 Vali Loss: 0.1642334 Test Loss: 0.1449259
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 22 cost time: 0.9110722541809082
Epoch: 22, Steps: 64 | Train Loss: 0.0887661 Vali Loss: 0.1605717 Test Loss: 0.1443509
Validation loss decreased (0.160913 --> 0.160572).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 23 cost time: 0.9331114292144775
Epoch: 23, Steps: 64 | Train Loss: 0.0889201 Vali Loss: 0.1619320 Test Loss: 0.1441532
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 24 cost time: 0.9224023818969727
Epoch: 24, Steps: 64 | Train Loss: 0.0887761 Vali Loss: 0.1614107 Test Loss: 0.1446331
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 25 cost time: 0.9373936653137207
Epoch: 25, Steps: 64 | Train Loss: 0.0886191 Vali Loss: 0.1632839 Test Loss: 0.1454488
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 26 cost time: 0.9380385875701904
Epoch: 26, Steps: 64 | Train Loss: 0.0885229 Vali Loss: 0.1608841 Test Loss: 0.1444763
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 27 cost time: 0.9438097476959229
Epoch: 27, Steps: 64 | Train Loss: 0.0881567 Vali Loss: 0.1613551 Test Loss: 0.1452001
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 28 cost time: 0.9369995594024658
Epoch: 28, Steps: 64 | Train Loss: 0.0882026 Vali Loss: 0.1601388 Test Loss: 0.1445463
Validation loss decreased (0.160572 --> 0.160139).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 29 cost time: 0.9260003566741943
Epoch: 29, Steps: 64 | Train Loss: 0.0880959 Vali Loss: 0.1624653 Test Loss: 0.1444178
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 30 cost time: 0.9434590339660645
Epoch: 30, Steps: 64 | Train Loss: 0.0877700 Vali Loss: 0.1594361 Test Loss: 0.1449408
Validation loss decreased (0.160139 --> 0.159436).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 31 cost time: 0.9504737854003906
Epoch: 31, Steps: 64 | Train Loss: 0.0880386 Vali Loss: 0.1596955 Test Loss: 0.1439109
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 32 cost time: 0.9504189491271973
Epoch: 32, Steps: 64 | Train Loss: 0.0881689 Vali Loss: 0.1600239 Test Loss: 0.1448447
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 33 cost time: 0.9574809074401855
Epoch: 33, Steps: 64 | Train Loss: 0.0880136 Vali Loss: 0.1623115 Test Loss: 0.1451549
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 34 cost time: 0.9503638744354248
Epoch: 34, Steps: 64 | Train Loss: 0.0876717 Vali Loss: 0.1621121 Test Loss: 0.1450784
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 35 cost time: 0.9505672454833984
Epoch: 35, Steps: 64 | Train Loss: 0.0882297 Vali Loss: 0.1621587 Test Loss: 0.1448683
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 36 cost time: 0.9684593677520752
Epoch: 36, Steps: 64 | Train Loss: 0.0879597 Vali Loss: 0.1619811 Test Loss: 0.1452304
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 37 cost time: 0.9443516731262207
Epoch: 37, Steps: 64 | Train Loss: 0.0876504 Vali Loss: 0.1614078 Test Loss: 0.1452493
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 38 cost time: 0.9410018920898438
Epoch: 38, Steps: 64 | Train Loss: 0.0874172 Vali Loss: 0.1616049 Test Loss: 0.1449332
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 39 cost time: 0.9410679340362549
Epoch: 39, Steps: 64 | Train Loss: 0.0878392 Vali Loss: 0.1611490 Test Loss: 0.1447801
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 40 cost time: 0.9356555938720703
Epoch: 40, Steps: 64 | Train Loss: 0.0874305 Vali Loss: 0.1607399 Test Loss: 0.1450261
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 41 cost time: 0.9444103240966797
Epoch: 41, Steps: 64 | Train Loss: 0.0875104 Vali Loss: 0.1618385 Test Loss: 0.1455292
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 42 cost time: 0.9597291946411133
Epoch: 42, Steps: 64 | Train Loss: 0.0875885 Vali Loss: 0.1600154 Test Loss: 0.1445736
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 43 cost time: 0.9484343528747559
Epoch: 43, Steps: 64 | Train Loss: 0.0875636 Vali Loss: 0.1593483 Test Loss: 0.1445570
Validation loss decreased (0.159436 --> 0.159348).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 44 cost time: 0.9384317398071289
Epoch: 44, Steps: 64 | Train Loss: 0.0873928 Vali Loss: 0.1605509 Test Loss: 0.1447682
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 45 cost time: 0.9294548034667969
Epoch: 45, Steps: 64 | Train Loss: 0.0875688 Vali Loss: 0.1604511 Test Loss: 0.1449101
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 46 cost time: 0.9327845573425293
Epoch: 46, Steps: 64 | Train Loss: 0.0870194 Vali Loss: 0.1615514 Test Loss: 0.1454243
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 47 cost time: 0.9263405799865723
Epoch: 47, Steps: 64 | Train Loss: 0.0871240 Vali Loss: 0.1614230 Test Loss: 0.1453107
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 48 cost time: 0.9251265525817871
Epoch: 48, Steps: 64 | Train Loss: 0.0872979 Vali Loss: 0.1607135 Test Loss: 0.1448987
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 49 cost time: 0.9266269207000732
Epoch: 49, Steps: 64 | Train Loss: 0.0869738 Vali Loss: 0.1612892 Test Loss: 0.1447343
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 50 cost time: 0.9433846473693848
Epoch: 50, Steps: 64 | Train Loss: 0.0876246 Vali Loss: 0.1611081 Test Loss: 0.1453833
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 51 cost time: 0.9374475479125977
Epoch: 51, Steps: 64 | Train Loss: 0.0874679 Vali Loss: 0.1614738 Test Loss: 0.1452835
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 52 cost time: 0.9364125728607178
Epoch: 52, Steps: 64 | Train Loss: 0.0873418 Vali Loss: 0.1618439 Test Loss: 0.1453930
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 53 cost time: 0.9530398845672607
Epoch: 53, Steps: 64 | Train Loss: 0.0873623 Vali Loss: 0.1604148 Test Loss: 0.1450903
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 54 cost time: 0.9357590675354004
Epoch: 54, Steps: 64 | Train Loss: 0.0874578 Vali Loss: 0.1605162 Test Loss: 0.1451308
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 55 cost time: 0.93784499168396
Epoch: 55, Steps: 64 | Train Loss: 0.0872206 Vali Loss: 0.1616366 Test Loss: 0.1448872
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 56 cost time: 0.9410011768341064
Epoch: 56, Steps: 64 | Train Loss: 0.0870491 Vali Loss: 0.1617829 Test Loss: 0.1454758
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 57 cost time: 0.9326300621032715
Epoch: 57, Steps: 64 | Train Loss: 0.0875010 Vali Loss: 0.1603850 Test Loss: 0.1453702
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 58 cost time: 0.9553811550140381
Epoch: 58, Steps: 64 | Train Loss: 0.0877852 Vali Loss: 0.1579653 Test Loss: 0.1448276
Validation loss decreased (0.159348 --> 0.157965).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 59 cost time: 0.958561897277832
Epoch: 59, Steps: 64 | Train Loss: 0.0872962 Vali Loss: 0.1610602 Test Loss: 0.1450706
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020137786865234375 GB
GPU已分配内存的峰值：0.05534648895263672 GB
Epoch: 60 cost time: 0.9591038227081299
Epoch: 60, Steps: 64 | Train Loss: 0.0871810 Vali Loss: 0.1589266 Test Loss: 0.1452227
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14482760429382324, mae:0.2860329747200012, rse:0.20255671441555023
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04604673385620117 GB
Epoch: 1 cost time: 2.2884461879730225
Epoch: 1, Steps: 64 | Train Loss: 0.9252089 Vali Loss: 2.0819168 Test Loss: 4.0466614
Validation loss decreased (inf --> 2.081917).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 2 cost time: 0.8953924179077148
Epoch: 2, Steps: 64 | Train Loss: 0.7713556 Vali Loss: 1.4680202 Test Loss: 2.7502148
Validation loss decreased (2.081917 --> 1.468020).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 3 cost time: 0.9034993648529053
Epoch: 3, Steps: 64 | Train Loss: 0.5719881 Vali Loss: 1.0775849 Test Loss: 1.9257129
Validation loss decreased (1.468020 --> 1.077585).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 4 cost time: 0.8901124000549316
Epoch: 4, Steps: 64 | Train Loss: 0.4202214 Vali Loss: 0.8056928 Test Loss: 1.3496772
Validation loss decreased (1.077585 --> 0.805693).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 5 cost time: 0.8972828388214111
Epoch: 5, Steps: 64 | Train Loss: 0.3244992 Vali Loss: 0.6527527 Test Loss: 1.0378661
Validation loss decreased (0.805693 --> 0.652753).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 6 cost time: 0.9049985408782959
Epoch: 6, Steps: 64 | Train Loss: 0.2621621 Vali Loss: 0.5430139 Test Loss: 0.8222082
Validation loss decreased (0.652753 --> 0.543014).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 7 cost time: 0.8726370334625244
Epoch: 7, Steps: 64 | Train Loss: 0.2195033 Vali Loss: 0.4640606 Test Loss: 0.6667030
Validation loss decreased (0.543014 --> 0.464061).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 8 cost time: 0.8634059429168701
Epoch: 8, Steps: 64 | Train Loss: 0.1905114 Vali Loss: 0.4096685 Test Loss: 0.5589921
Validation loss decreased (0.464061 --> 0.409669).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 9 cost time: 0.8739845752716064
Epoch: 9, Steps: 64 | Train Loss: 0.1694910 Vali Loss: 0.3620548 Test Loss: 0.4744280
Validation loss decreased (0.409669 --> 0.362055).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 10 cost time: 0.8933844566345215
Epoch: 10, Steps: 64 | Train Loss: 0.1541730 Vali Loss: 0.3256063 Test Loss: 0.4076705
Validation loss decreased (0.362055 --> 0.325606).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 11 cost time: 0.8907618522644043
Epoch: 11, Steps: 64 | Train Loss: 0.1424626 Vali Loss: 0.3011891 Test Loss: 0.3622125
Validation loss decreased (0.325606 --> 0.301189).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 12 cost time: 0.9030003547668457
Epoch: 12, Steps: 64 | Train Loss: 0.1339773 Vali Loss: 0.2800184 Test Loss: 0.3272108
Validation loss decreased (0.301189 --> 0.280018).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 13 cost time: 0.9057211875915527
Epoch: 13, Steps: 64 | Train Loss: 0.1278006 Vali Loss: 0.2647889 Test Loss: 0.2998735
Validation loss decreased (0.280018 --> 0.264789).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 14 cost time: 0.8786332607269287
Epoch: 14, Steps: 64 | Train Loss: 0.1225295 Vali Loss: 0.2513430 Test Loss: 0.2772779
Validation loss decreased (0.264789 --> 0.251343).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 15 cost time: 0.8773505687713623
Epoch: 15, Steps: 64 | Train Loss: 0.1182884 Vali Loss: 0.2407233 Test Loss: 0.2613665
Validation loss decreased (0.251343 --> 0.240723).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 16 cost time: 0.8763737678527832
Epoch: 16, Steps: 64 | Train Loss: 0.1156433 Vali Loss: 0.2320651 Test Loss: 0.2480281
Validation loss decreased (0.240723 --> 0.232065).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 17 cost time: 0.8893895149230957
Epoch: 17, Steps: 64 | Train Loss: 0.1132009 Vali Loss: 0.2282118 Test Loss: 0.2380129
Validation loss decreased (0.232065 --> 0.228212).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 18 cost time: 0.8982274532318115
Epoch: 18, Steps: 64 | Train Loss: 0.1109696 Vali Loss: 0.2216630 Test Loss: 0.2270551
Validation loss decreased (0.228212 --> 0.221663).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 19 cost time: 0.8980002403259277
Epoch: 19, Steps: 64 | Train Loss: 0.1100001 Vali Loss: 0.2138017 Test Loss: 0.2173937
Validation loss decreased (0.221663 --> 0.213802).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 20 cost time: 0.9026143550872803
Epoch: 20, Steps: 64 | Train Loss: 0.1077145 Vali Loss: 0.2122549 Test Loss: 0.2125342
Validation loss decreased (0.213802 --> 0.212255).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 21 cost time: 0.9104068279266357
Epoch: 21, Steps: 64 | Train Loss: 0.1069483 Vali Loss: 0.2093227 Test Loss: 0.2086928
Validation loss decreased (0.212255 --> 0.209323).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 22 cost time: 0.8930392265319824
Epoch: 22, Steps: 64 | Train Loss: 0.1057947 Vali Loss: 0.2050346 Test Loss: 0.2022334
Validation loss decreased (0.209323 --> 0.205035).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 23 cost time: 0.8702123165130615
Epoch: 23, Steps: 64 | Train Loss: 0.1051702 Vali Loss: 0.2016463 Test Loss: 0.1978807
Validation loss decreased (0.205035 --> 0.201646).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 24 cost time: 0.8754668235778809
Epoch: 24, Steps: 64 | Train Loss: 0.1043869 Vali Loss: 0.2008759 Test Loss: 0.1968878
Validation loss decreased (0.201646 --> 0.200876).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 25 cost time: 0.8740015029907227
Epoch: 25, Steps: 64 | Train Loss: 0.1036418 Vali Loss: 0.2006362 Test Loss: 0.1945977
Validation loss decreased (0.200876 --> 0.200636).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 26 cost time: 0.8660016059875488
Epoch: 26, Steps: 64 | Train Loss: 0.1035465 Vali Loss: 0.1993030 Test Loss: 0.1925566
Validation loss decreased (0.200636 --> 0.199303).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 27 cost time: 0.8766324520111084
Epoch: 27, Steps: 64 | Train Loss: 0.1031587 Vali Loss: 0.1958466 Test Loss: 0.1895565
Validation loss decreased (0.199303 --> 0.195847).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 28 cost time: 0.8883886337280273
Epoch: 28, Steps: 64 | Train Loss: 0.1023141 Vali Loss: 0.1954275 Test Loss: 0.1875796
Validation loss decreased (0.195847 --> 0.195428).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 29 cost time: 0.8863906860351562
Epoch: 29, Steps: 64 | Train Loss: 0.1021843 Vali Loss: 0.1941826 Test Loss: 0.1869265
Validation loss decreased (0.195428 --> 0.194183).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 30 cost time: 0.8873872756958008
Epoch: 30, Steps: 64 | Train Loss: 0.1018809 Vali Loss: 0.1942346 Test Loss: 0.1848041
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 31 cost time: 0.8962080478668213
Epoch: 31, Steps: 64 | Train Loss: 0.1012910 Vali Loss: 0.1918949 Test Loss: 0.1851371
Validation loss decreased (0.194183 --> 0.191895).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 32 cost time: 0.8689999580383301
Epoch: 32, Steps: 64 | Train Loss: 0.1010545 Vali Loss: 0.1909775 Test Loss: 0.1830642
Validation loss decreased (0.191895 --> 0.190977).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 33 cost time: 0.864630937576294
Epoch: 33, Steps: 64 | Train Loss: 0.1012155 Vali Loss: 0.1920816 Test Loss: 0.1818065
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 34 cost time: 0.8725159168243408
Epoch: 34, Steps: 64 | Train Loss: 0.1006979 Vali Loss: 0.1919314 Test Loss: 0.1804498
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 35 cost time: 0.8960187435150146
Epoch: 35, Steps: 64 | Train Loss: 0.1006440 Vali Loss: 0.1883984 Test Loss: 0.1788802
Validation loss decreased (0.190977 --> 0.188398).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 36 cost time: 0.9093911647796631
Epoch: 36, Steps: 64 | Train Loss: 0.1006386 Vali Loss: 0.1899695 Test Loss: 0.1794644
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 37 cost time: 0.903822660446167
Epoch: 37, Steps: 64 | Train Loss: 0.0998261 Vali Loss: 0.1892258 Test Loss: 0.1795164
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 38 cost time: 0.9134879112243652
Epoch: 38, Steps: 64 | Train Loss: 0.1000051 Vali Loss: 0.1894856 Test Loss: 0.1787027
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 39 cost time: 0.8946409225463867
Epoch: 39, Steps: 64 | Train Loss: 0.0998917 Vali Loss: 0.1860086 Test Loss: 0.1769148
Validation loss decreased (0.188398 --> 0.186009).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 40 cost time: 0.883638858795166
Epoch: 40, Steps: 64 | Train Loss: 0.0999676 Vali Loss: 0.1883468 Test Loss: 0.1775890
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 41 cost time: 0.8833870887756348
Epoch: 41, Steps: 64 | Train Loss: 0.0998778 Vali Loss: 0.1876260 Test Loss: 0.1768725
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 42 cost time: 0.8904399871826172
Epoch: 42, Steps: 64 | Train Loss: 0.1000286 Vali Loss: 0.1870198 Test Loss: 0.1764633
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 43 cost time: 0.8784141540527344
Epoch: 43, Steps: 64 | Train Loss: 0.0995091 Vali Loss: 0.1878714 Test Loss: 0.1767247
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 44 cost time: 0.8954198360443115
Epoch: 44, Steps: 64 | Train Loss: 0.0996719 Vali Loss: 0.1872740 Test Loss: 0.1759582
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 45 cost time: 0.8916497230529785
Epoch: 45, Steps: 64 | Train Loss: 0.0992384 Vali Loss: 0.1871660 Test Loss: 0.1758542
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 46 cost time: 0.8871562480926514
Epoch: 46, Steps: 64 | Train Loss: 0.0995195 Vali Loss: 0.1854633 Test Loss: 0.1753486
Validation loss decreased (0.186009 --> 0.185463).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 47 cost time: 0.8984355926513672
Epoch: 47, Steps: 64 | Train Loss: 0.0994307 Vali Loss: 0.1853472 Test Loss: 0.1743045
Validation loss decreased (0.185463 --> 0.185347).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 48 cost time: 0.8983988761901855
Epoch: 48, Steps: 64 | Train Loss: 0.0992821 Vali Loss: 0.1868115 Test Loss: 0.1756314
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 49 cost time: 0.8953812122344971
Epoch: 49, Steps: 64 | Train Loss: 0.0990703 Vali Loss: 0.1862804 Test Loss: 0.1747873
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 50 cost time: 0.8687458038330078
Epoch: 50, Steps: 64 | Train Loss: 0.0982512 Vali Loss: 0.1844949 Test Loss: 0.1750316
Validation loss decreased (0.185347 --> 0.184495).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 51 cost time: 0.8629987239837646
Epoch: 51, Steps: 64 | Train Loss: 0.0991968 Vali Loss: 0.1847711 Test Loss: 0.1735807
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 52 cost time: 0.8686461448669434
Epoch: 52, Steps: 64 | Train Loss: 0.0992551 Vali Loss: 0.1870451 Test Loss: 0.1741409
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 53 cost time: 0.8853504657745361
Epoch: 53, Steps: 64 | Train Loss: 0.0992308 Vali Loss: 0.1841742 Test Loss: 0.1739384
Validation loss decreased (0.184495 --> 0.184174).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 54 cost time: 0.8883585929870605
Epoch: 54, Steps: 64 | Train Loss: 0.0990695 Vali Loss: 0.1863828 Test Loss: 0.1743372
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 55 cost time: 0.8824808597564697
Epoch: 55, Steps: 64 | Train Loss: 0.0988497 Vali Loss: 0.1839054 Test Loss: 0.1753491
Validation loss decreased (0.184174 --> 0.183905).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 56 cost time: 0.8909389972686768
Epoch: 56, Steps: 64 | Train Loss: 0.0985298 Vali Loss: 0.1858930 Test Loss: 0.1746455
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 57 cost time: 0.8743741512298584
Epoch: 57, Steps: 64 | Train Loss: 0.0988368 Vali Loss: 0.1837548 Test Loss: 0.1741698
Validation loss decreased (0.183905 --> 0.183755).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 58 cost time: 0.8736498355865479
Epoch: 58, Steps: 64 | Train Loss: 0.0988062 Vali Loss: 0.1859761 Test Loss: 0.1721862
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 59 cost time: 0.8784246444702148
Epoch: 59, Steps: 64 | Train Loss: 0.0993270 Vali Loss: 0.1850150 Test Loss: 0.1739320
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017553329467773438 GB
GPU已分配内存的峰值：0.04622602462768555 GB
Epoch: 60 cost time: 0.8873496055603027
Epoch: 60, Steps: 64 | Train Loss: 0.0986250 Vali Loss: 0.1854648 Test Loss: 0.1732033
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.17416977882385254, mae:0.32483726739883423, rse:0.22213007509708405
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 1 cost time: 2.3097965717315674
Epoch: 1, Steps: 64 | Train Loss: 0.7498261 Vali Loss: 1.7539818 Test Loss: 3.2883892
Validation loss decreased (inf --> 1.753982).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 2 cost time: 0.9294517040252686
Epoch: 2, Steps: 64 | Train Loss: 0.4888187 Vali Loss: 0.5103718 Test Loss: 0.7444612
Validation loss decreased (1.753982 --> 0.510372).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 3 cost time: 0.9233553409576416
Epoch: 3, Steps: 64 | Train Loss: 0.1552877 Vali Loss: 0.1962360 Test Loss: 0.1578495
Validation loss decreased (0.510372 --> 0.196236).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 4 cost time: 0.915503740310669
Epoch: 4, Steps: 64 | Train Loss: 0.1122426 Vali Loss: 0.1765818 Test Loss: 0.1492750
Validation loss decreased (0.196236 --> 0.176582).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 5 cost time: 0.8897261619567871
Epoch: 5, Steps: 64 | Train Loss: 0.1057061 Vali Loss: 0.1719516 Test Loss: 0.1460164
Validation loss decreased (0.176582 --> 0.171952).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 6 cost time: 0.9013838768005371
Epoch: 6, Steps: 64 | Train Loss: 0.1025349 Vali Loss: 0.1685728 Test Loss: 0.1440253
Validation loss decreased (0.171952 --> 0.168573).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 7 cost time: 0.9206323623657227
Epoch: 7, Steps: 64 | Train Loss: 0.1002194 Vali Loss: 0.1647065 Test Loss: 0.1408548
Validation loss decreased (0.168573 --> 0.164707).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 8 cost time: 0.9214177131652832
Epoch: 8, Steps: 64 | Train Loss: 0.0987955 Vali Loss: 0.1638573 Test Loss: 0.1407520
Validation loss decreased (0.164707 --> 0.163857).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 9 cost time: 0.9364397525787354
Epoch: 9, Steps: 64 | Train Loss: 0.0974195 Vali Loss: 0.1589528 Test Loss: 0.1396899
Validation loss decreased (0.163857 --> 0.158953).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 10 cost time: 0.9291276931762695
Epoch: 10, Steps: 64 | Train Loss: 0.0963684 Vali Loss: 0.1615322 Test Loss: 0.1399873
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 11 cost time: 0.926414966583252
Epoch: 11, Steps: 64 | Train Loss: 0.0955780 Vali Loss: 0.1594438 Test Loss: 0.1398605
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 12 cost time: 0.9355583190917969
Epoch: 12, Steps: 64 | Train Loss: 0.0947273 Vali Loss: 0.1557989 Test Loss: 0.1387415
Validation loss decreased (0.158953 --> 0.155799).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 13 cost time: 0.9207460880279541
Epoch: 13, Steps: 64 | Train Loss: 0.0936912 Vali Loss: 0.1565706 Test Loss: 0.1382636
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 14 cost time: 0.9159994125366211
Epoch: 14, Steps: 64 | Train Loss: 0.0934220 Vali Loss: 0.1541432 Test Loss: 0.1386125
Validation loss decreased (0.155799 --> 0.154143).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 15 cost time: 0.9156394004821777
Epoch: 15, Steps: 64 | Train Loss: 0.0932585 Vali Loss: 0.1556242 Test Loss: 0.1389952
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 16 cost time: 0.9124841690063477
Epoch: 16, Steps: 64 | Train Loss: 0.0929965 Vali Loss: 0.1546160 Test Loss: 0.1384737
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 17 cost time: 0.9193999767303467
Epoch: 17, Steps: 64 | Train Loss: 0.0925561 Vali Loss: 0.1563964 Test Loss: 0.1390227
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 18 cost time: 0.9334442615509033
Epoch: 18, Steps: 64 | Train Loss: 0.0917578 Vali Loss: 0.1555656 Test Loss: 0.1386048
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 19 cost time: 0.9338228702545166
Epoch: 19, Steps: 64 | Train Loss: 0.0915084 Vali Loss: 0.1542961 Test Loss: 0.1386151
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 20 cost time: 0.9374988079071045
Epoch: 20, Steps: 64 | Train Loss: 0.0911214 Vali Loss: 0.1537258 Test Loss: 0.1389660
Validation loss decreased (0.154143 --> 0.153726).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 21 cost time: 0.9367318153381348
Epoch: 21, Steps: 64 | Train Loss: 0.0912292 Vali Loss: 0.1560515 Test Loss: 0.1395406
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 22 cost time: 0.9179997444152832
Epoch: 22, Steps: 64 | Train Loss: 0.0907977 Vali Loss: 0.1537533 Test Loss: 0.1389194
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 23 cost time: 0.9420261383056641
Epoch: 23, Steps: 64 | Train Loss: 0.0906805 Vali Loss: 0.1525684 Test Loss: 0.1386658
Validation loss decreased (0.153726 --> 0.152568).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 24 cost time: 0.9026124477386475
Epoch: 24, Steps: 64 | Train Loss: 0.0902833 Vali Loss: 0.1557039 Test Loss: 0.1392672
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 25 cost time: 0.9063482284545898
Epoch: 25, Steps: 64 | Train Loss: 0.0899107 Vali Loss: 0.1539743 Test Loss: 0.1397600
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 26 cost time: 0.9193572998046875
Epoch: 26, Steps: 64 | Train Loss: 0.0900902 Vali Loss: 0.1531427 Test Loss: 0.1393965
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 27 cost time: 0.9204092025756836
Epoch: 27, Steps: 64 | Train Loss: 0.0899144 Vali Loss: 0.1551649 Test Loss: 0.1396853
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 28 cost time: 0.8999874591827393
Epoch: 28, Steps: 64 | Train Loss: 0.0889520 Vali Loss: 0.1515629 Test Loss: 0.1394112
Validation loss decreased (0.152568 --> 0.151563).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 29 cost time: 0.8997559547424316
Epoch: 29, Steps: 64 | Train Loss: 0.0897186 Vali Loss: 0.1533782 Test Loss: 0.1394883
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 30 cost time: 0.902000904083252
Epoch: 30, Steps: 64 | Train Loss: 0.0894040 Vali Loss: 0.1535366 Test Loss: 0.1393252
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 31 cost time: 0.8974385261535645
Epoch: 31, Steps: 64 | Train Loss: 0.0896505 Vali Loss: 0.1543812 Test Loss: 0.1395256
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 32 cost time: 0.8930366039276123
Epoch: 32, Steps: 64 | Train Loss: 0.0893822 Vali Loss: 0.1532256 Test Loss: 0.1394191
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 33 cost time: 0.8990440368652344
Epoch: 33, Steps: 64 | Train Loss: 0.0890722 Vali Loss: 0.1526466 Test Loss: 0.1390159
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 34 cost time: 0.9294052124023438
Epoch: 34, Steps: 64 | Train Loss: 0.0895353 Vali Loss: 0.1541038 Test Loss: 0.1392487
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 35 cost time: 0.9331061840057373
Epoch: 35, Steps: 64 | Train Loss: 0.0894097 Vali Loss: 0.1531713 Test Loss: 0.1393422
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 36 cost time: 0.9324352741241455
Epoch: 36, Steps: 64 | Train Loss: 0.0891307 Vali Loss: 0.1530543 Test Loss: 0.1391826
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 37 cost time: 0.9449987411499023
Epoch: 37, Steps: 64 | Train Loss: 0.0885642 Vali Loss: 0.1536093 Test Loss: 0.1393548
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 38 cost time: 0.9227190017700195
Epoch: 38, Steps: 64 | Train Loss: 0.0893658 Vali Loss: 0.1540592 Test Loss: 0.1401304
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 39 cost time: 0.909386157989502
Epoch: 39, Steps: 64 | Train Loss: 0.0890922 Vali Loss: 0.1530528 Test Loss: 0.1395894
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 40 cost time: 0.9119052886962891
Epoch: 40, Steps: 64 | Train Loss: 0.0890642 Vali Loss: 0.1526300 Test Loss: 0.1397532
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 41 cost time: 0.9315896034240723
Epoch: 41, Steps: 64 | Train Loss: 0.0889040 Vali Loss: 0.1509850 Test Loss: 0.1395483
Validation loss decreased (0.151563 --> 0.150985).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 42 cost time: 0.9264962673187256
Epoch: 42, Steps: 64 | Train Loss: 0.0891055 Vali Loss: 0.1527133 Test Loss: 0.1392857
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 43 cost time: 0.9275121688842773
Epoch: 43, Steps: 64 | Train Loss: 0.0882395 Vali Loss: 0.1529062 Test Loss: 0.1396912
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 44 cost time: 0.9167673587799072
Epoch: 44, Steps: 64 | Train Loss: 0.0891325 Vali Loss: 0.1533099 Test Loss: 0.1397448
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 45 cost time: 0.9089994430541992
Epoch: 45, Steps: 64 | Train Loss: 0.0888493 Vali Loss: 0.1535054 Test Loss: 0.1390286
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 46 cost time: 0.9086437225341797
Epoch: 46, Steps: 64 | Train Loss: 0.0885310 Vali Loss: 0.1542968 Test Loss: 0.1399944
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 47 cost time: 0.900371789932251
Epoch: 47, Steps: 64 | Train Loss: 0.0883383 Vali Loss: 0.1548476 Test Loss: 0.1398862
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 48 cost time: 0.9013936519622803
Epoch: 48, Steps: 64 | Train Loss: 0.0887354 Vali Loss: 0.1535019 Test Loss: 0.1394189
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 49 cost time: 0.901951789855957
Epoch: 49, Steps: 64 | Train Loss: 0.0887949 Vali Loss: 0.1525926 Test Loss: 0.1393100
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 50 cost time: 0.9053723812103271
Epoch: 50, Steps: 64 | Train Loss: 0.0887677 Vali Loss: 0.1522465 Test Loss: 0.1398807
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 51 cost time: 0.9287309646606445
Epoch: 51, Steps: 64 | Train Loss: 0.0888209 Vali Loss: 0.1523984 Test Loss: 0.1396964
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 52 cost time: 0.9199979305267334
Epoch: 52, Steps: 64 | Train Loss: 0.0889662 Vali Loss: 0.1540171 Test Loss: 0.1396714
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 53 cost time: 0.92000412940979
Epoch: 53, Steps: 64 | Train Loss: 0.0888314 Vali Loss: 0.1537846 Test Loss: 0.1396163
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 54 cost time: 0.9084055423736572
Epoch: 54, Steps: 64 | Train Loss: 0.0883494 Vali Loss: 0.1531704 Test Loss: 0.1400123
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 55 cost time: 0.9034838676452637
Epoch: 55, Steps: 64 | Train Loss: 0.0887058 Vali Loss: 0.1531321 Test Loss: 0.1397367
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 56 cost time: 0.9134731292724609
Epoch: 56, Steps: 64 | Train Loss: 0.0883920 Vali Loss: 0.1524249 Test Loss: 0.1392639
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 57 cost time: 0.9077796936035156
Epoch: 57, Steps: 64 | Train Loss: 0.0882813 Vali Loss: 0.1522107 Test Loss: 0.1399685
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 58 cost time: 0.9217987060546875
Epoch: 58, Steps: 64 | Train Loss: 0.0886500 Vali Loss: 0.1519100 Test Loss: 0.1391947
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 59 cost time: 0.9219996929168701
Epoch: 59, Steps: 64 | Train Loss: 0.0885199 Vali Loss: 0.1512104 Test Loss: 0.1397775
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019269943237304688 GB
GPU已分配内存的峰值：0.05026102066040039 GB
Epoch: 60 cost time: 0.9356179237365723
Epoch: 60, Steps: 64 | Train Loss: 0.0887901 Vali Loss: 0.1527489 Test Loss: 0.1393067
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13954828679561615, mae:0.27628058195114136, rse:0.19883060455322266
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05333375930786133 GB
Epoch: 1 cost time: 2.3292834758758545
Epoch: 1, Steps: 64 | Train Loss: 0.7897172 Vali Loss: 1.8450325 Test Loss: 3.4940255
Validation loss decreased (inf --> 1.845032).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 2 cost time: 0.9302780628204346
Epoch: 2, Steps: 64 | Train Loss: 0.4215667 Vali Loss: 0.2283403 Test Loss: 0.1791470
Validation loss decreased (1.845032 --> 0.228340).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 3 cost time: 0.9436111450195312
Epoch: 3, Steps: 64 | Train Loss: 0.1232583 Vali Loss: 0.1989310 Test Loss: 0.1759765
Validation loss decreased (0.228340 --> 0.198931).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 4 cost time: 0.9456350803375244
Epoch: 4, Steps: 64 | Train Loss: 0.1083506 Vali Loss: 0.1795878 Test Loss: 0.1479658
Validation loss decreased (0.198931 --> 0.179588).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 5 cost time: 0.9166479110717773
Epoch: 5, Steps: 64 | Train Loss: 0.1028851 Vali Loss: 0.1715905 Test Loss: 0.1489929
Validation loss decreased (0.179588 --> 0.171590).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 6 cost time: 0.9134275913238525
Epoch: 6, Steps: 64 | Train Loss: 0.1000009 Vali Loss: 0.1707896 Test Loss: 0.1448744
Validation loss decreased (0.171590 --> 0.170790).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 7 cost time: 0.9114134311676025
Epoch: 7, Steps: 64 | Train Loss: 0.0976192 Vali Loss: 0.1682130 Test Loss: 0.1471444
Validation loss decreased (0.170790 --> 0.168213).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 8 cost time: 0.9234023094177246
Epoch: 8, Steps: 64 | Train Loss: 0.0965052 Vali Loss: 0.1678779 Test Loss: 0.1449729
Validation loss decreased (0.168213 --> 0.167878).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 9 cost time: 0.9348323345184326
Epoch: 9, Steps: 64 | Train Loss: 0.0951837 Vali Loss: 0.1668799 Test Loss: 0.1460951
Validation loss decreased (0.167878 --> 0.166880).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 10 cost time: 0.9330825805664062
Epoch: 10, Steps: 64 | Train Loss: 0.0935588 Vali Loss: 0.1657938 Test Loss: 0.1447513
Validation loss decreased (0.166880 --> 0.165794).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 11 cost time: 0.9559977054595947
Epoch: 11, Steps: 64 | Train Loss: 0.0933278 Vali Loss: 0.1618654 Test Loss: 0.1437950
Validation loss decreased (0.165794 --> 0.161865).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 12 cost time: 0.9619994163513184
Epoch: 12, Steps: 64 | Train Loss: 0.0917836 Vali Loss: 0.1630429 Test Loss: 0.1439689
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 13 cost time: 0.9406423568725586
Epoch: 13, Steps: 64 | Train Loss: 0.0915887 Vali Loss: 0.1637614 Test Loss: 0.1449988
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 14 cost time: 0.9467642307281494
Epoch: 14, Steps: 64 | Train Loss: 0.0916016 Vali Loss: 0.1624796 Test Loss: 0.1437477
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 15 cost time: 0.9384868144989014
Epoch: 15, Steps: 64 | Train Loss: 0.0910664 Vali Loss: 0.1608999 Test Loss: 0.1444062
Validation loss decreased (0.161865 --> 0.160900).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 16 cost time: 0.9353790283203125
Epoch: 16, Steps: 64 | Train Loss: 0.0903633 Vali Loss: 0.1599458 Test Loss: 0.1447893
Validation loss decreased (0.160900 --> 0.159946).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 17 cost time: 0.9614427089691162
Epoch: 17, Steps: 64 | Train Loss: 0.0906034 Vali Loss: 0.1613087 Test Loss: 0.1444762
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 18 cost time: 0.9623432159423828
Epoch: 18, Steps: 64 | Train Loss: 0.0900585 Vali Loss: 0.1620122 Test Loss: 0.1442713
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 19 cost time: 0.9614717960357666
Epoch: 19, Steps: 64 | Train Loss: 0.0895091 Vali Loss: 0.1583543 Test Loss: 0.1430100
Validation loss decreased (0.159946 --> 0.158354).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 20 cost time: 0.9577522277832031
Epoch: 20, Steps: 64 | Train Loss: 0.0896437 Vali Loss: 0.1589886 Test Loss: 0.1439461
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 21 cost time: 0.948000431060791
Epoch: 21, Steps: 64 | Train Loss: 0.0893239 Vali Loss: 0.1611763 Test Loss: 0.1449327
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 22 cost time: 0.9140000343322754
Epoch: 22, Steps: 64 | Train Loss: 0.0885758 Vali Loss: 0.1603035 Test Loss: 0.1437124
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 23 cost time: 0.9086403846740723
Epoch: 23, Steps: 64 | Train Loss: 0.0891461 Vali Loss: 0.1604529 Test Loss: 0.1446918
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 24 cost time: 0.9124081134796143
Epoch: 24, Steps: 64 | Train Loss: 0.0887788 Vali Loss: 0.1602764 Test Loss: 0.1444048
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 25 cost time: 0.934389591217041
Epoch: 25, Steps: 64 | Train Loss: 0.0886183 Vali Loss: 0.1593441 Test Loss: 0.1443056
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 26 cost time: 0.9344019889831543
Epoch: 26, Steps: 64 | Train Loss: 0.0883009 Vali Loss: 0.1582393 Test Loss: 0.1444098
Validation loss decreased (0.158354 --> 0.158239).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 27 cost time: 0.9488754272460938
Epoch: 27, Steps: 64 | Train Loss: 0.0885702 Vali Loss: 0.1592787 Test Loss: 0.1449551
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 28 cost time: 0.9408092498779297
Epoch: 28, Steps: 64 | Train Loss: 0.0882962 Vali Loss: 0.1594992 Test Loss: 0.1440545
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 29 cost time: 0.907825231552124
Epoch: 29, Steps: 64 | Train Loss: 0.0882117 Vali Loss: 0.1599312 Test Loss: 0.1452788
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 30 cost time: 0.9080002307891846
Epoch: 30, Steps: 64 | Train Loss: 0.0877166 Vali Loss: 0.1582383 Test Loss: 0.1445727
Validation loss decreased (0.158239 --> 0.158238).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 31 cost time: 0.9160501956939697
Epoch: 31, Steps: 64 | Train Loss: 0.0882976 Vali Loss: 0.1586391 Test Loss: 0.1446137
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 32 cost time: 0.9564001560211182
Epoch: 32, Steps: 64 | Train Loss: 0.0879758 Vali Loss: 0.1566694 Test Loss: 0.1444564
Validation loss decreased (0.158238 --> 0.156669).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 33 cost time: 0.9654355049133301
Epoch: 33, Steps: 64 | Train Loss: 0.0879819 Vali Loss: 0.1578603 Test Loss: 0.1444150
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 34 cost time: 0.9653961658477783
Epoch: 34, Steps: 64 | Train Loss: 0.0878094 Vali Loss: 0.1574656 Test Loss: 0.1448335
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 35 cost time: 0.9593708515167236
Epoch: 35, Steps: 64 | Train Loss: 0.0876730 Vali Loss: 0.1583932 Test Loss: 0.1447453
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 36 cost time: 0.96044921875
Epoch: 36, Steps: 64 | Train Loss: 0.0879371 Vali Loss: 0.1595036 Test Loss: 0.1446837
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 37 cost time: 0.9556362628936768
Epoch: 37, Steps: 64 | Train Loss: 0.0874993 Vali Loss: 0.1585877 Test Loss: 0.1447434
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 38 cost time: 0.9497992992401123
Epoch: 38, Steps: 64 | Train Loss: 0.0873675 Vali Loss: 0.1585851 Test Loss: 0.1444221
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 39 cost time: 0.9423773288726807
Epoch: 39, Steps: 64 | Train Loss: 0.0877639 Vali Loss: 0.1591485 Test Loss: 0.1443726
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 40 cost time: 0.9459993839263916
Epoch: 40, Steps: 64 | Train Loss: 0.0876469 Vali Loss: 0.1591663 Test Loss: 0.1445906
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 41 cost time: 0.9556477069854736
Epoch: 41, Steps: 64 | Train Loss: 0.0874093 Vali Loss: 0.1579706 Test Loss: 0.1445491
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 42 cost time: 0.9603910446166992
Epoch: 42, Steps: 64 | Train Loss: 0.0873544 Vali Loss: 0.1579130 Test Loss: 0.1445805
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 43 cost time: 0.9617633819580078
Epoch: 43, Steps: 64 | Train Loss: 0.0875572 Vali Loss: 0.1605900 Test Loss: 0.1451889
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 44 cost time: 0.9643654823303223
Epoch: 44, Steps: 64 | Train Loss: 0.0874798 Vali Loss: 0.1585024 Test Loss: 0.1447933
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 45 cost time: 0.9203944206237793
Epoch: 45, Steps: 64 | Train Loss: 0.0872454 Vali Loss: 0.1584592 Test Loss: 0.1447852
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 46 cost time: 0.9124064445495605
Epoch: 46, Steps: 64 | Train Loss: 0.0872859 Vali Loss: 0.1595136 Test Loss: 0.1450441
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 47 cost time: 0.9107246398925781
Epoch: 47, Steps: 64 | Train Loss: 0.0876288 Vali Loss: 0.1576629 Test Loss: 0.1447406
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 48 cost time: 0.9270005226135254
Epoch: 48, Steps: 64 | Train Loss: 0.0874674 Vali Loss: 0.1592524 Test Loss: 0.1450498
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 49 cost time: 0.9299991130828857
Epoch: 49, Steps: 64 | Train Loss: 0.0873842 Vali Loss: 0.1565622 Test Loss: 0.1445587
Validation loss decreased (0.156669 --> 0.156562).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 50 cost time: 0.9326460361480713
Epoch: 50, Steps: 64 | Train Loss: 0.0877100 Vali Loss: 0.1584013 Test Loss: 0.1448849
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 51 cost time: 0.9381072521209717
Epoch: 51, Steps: 64 | Train Loss: 0.0875744 Vali Loss: 0.1597188 Test Loss: 0.1445991
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 52 cost time: 0.9383711814880371
Epoch: 52, Steps: 64 | Train Loss: 0.0872697 Vali Loss: 0.1587025 Test Loss: 0.1450461
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 53 cost time: 0.9214625358581543
Epoch: 53, Steps: 64 | Train Loss: 0.0873750 Vali Loss: 0.1582603 Test Loss: 0.1451806
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 54 cost time: 0.9383857250213623
Epoch: 54, Steps: 64 | Train Loss: 0.0876529 Vali Loss: 0.1598151 Test Loss: 0.1454992
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 55 cost time: 0.9433605670928955
Epoch: 55, Steps: 64 | Train Loss: 0.0871607 Vali Loss: 0.1581764 Test Loss: 0.1455787
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 56 cost time: 0.9464168548583984
Epoch: 56, Steps: 64 | Train Loss: 0.0873486 Vali Loss: 0.1578648 Test Loss: 0.1453381
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 57 cost time: 0.9459998607635498
Epoch: 57, Steps: 64 | Train Loss: 0.0872636 Vali Loss: 0.1584510 Test Loss: 0.1455512
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 58 cost time: 0.9739999771118164
Epoch: 58, Steps: 64 | Train Loss: 0.0870950 Vali Loss: 0.1593490 Test Loss: 0.1453591
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 59 cost time: 0.9606661796569824
Epoch: 59, Steps: 64 | Train Loss: 0.0877482 Vali Loss: 0.1589198 Test Loss: 0.1452845
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020139694213867188 GB
GPU已分配内存的峰值：0.05550813674926758 GB
Epoch: 60 cost time: 0.9609577655792236
Epoch: 60, Steps: 64 | Train Loss: 0.0872406 Vali Loss: 0.1568613 Test Loss: 0.1450793
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14455871284008026, mae:0.28532835841178894, rse:0.2023686021566391
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.04620790481567383 GB
Epoch: 1 cost time: 2.2633538246154785
Epoch: 1, Steps: 64 | Train Loss: 0.8078243 Vali Loss: 1.7755938 Test Loss: 3.3956401
Validation loss decreased (inf --> 1.775594).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 2 cost time: 0.8896303176879883
Epoch: 2, Steps: 64 | Train Loss: 0.6535043 Vali Loss: 1.1867529 Test Loss: 2.1650383
Validation loss decreased (1.775594 --> 1.186753).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 3 cost time: 0.8856503963470459
Epoch: 3, Steps: 64 | Train Loss: 0.4788310 Vali Loss: 0.8993806 Test Loss: 1.5768578
Validation loss decreased (1.186753 --> 0.899381).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 4 cost time: 0.882108211517334
Epoch: 4, Steps: 64 | Train Loss: 0.3670536 Vali Loss: 0.6986287 Test Loss: 1.1630785
Validation loss decreased (0.899381 --> 0.698629).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 5 cost time: 0.861013650894165
Epoch: 5, Steps: 64 | Train Loss: 0.2901000 Vali Loss: 0.5703325 Test Loss: 0.8960602
Validation loss decreased (0.698629 --> 0.570333).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 6 cost time: 0.8547334671020508
Epoch: 6, Steps: 64 | Train Loss: 0.2385000 Vali Loss: 0.4768677 Test Loss: 0.7142988
Validation loss decreased (0.570333 --> 0.476868).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 7 cost time: 0.8638288974761963
Epoch: 7, Steps: 64 | Train Loss: 0.2026654 Vali Loss: 0.4079740 Test Loss: 0.5841268
Validation loss decreased (0.476868 --> 0.407974).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 8 cost time: 0.8669998645782471
Epoch: 8, Steps: 64 | Train Loss: 0.1777991 Vali Loss: 0.3586745 Test Loss: 0.4893361
Validation loss decreased (0.407974 --> 0.358674).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 9 cost time: 0.8733983039855957
Epoch: 9, Steps: 64 | Train Loss: 0.1595719 Vali Loss: 0.3155085 Test Loss: 0.4088744
Validation loss decreased (0.358674 --> 0.315509).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 10 cost time: 0.8934125900268555
Epoch: 10, Steps: 64 | Train Loss: 0.1470724 Vali Loss: 0.2925867 Test Loss: 0.3653856
Validation loss decreased (0.315509 --> 0.292587).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 11 cost time: 0.9068927764892578
Epoch: 11, Steps: 64 | Train Loss: 0.1368615 Vali Loss: 0.2663427 Test Loss: 0.3225592
Validation loss decreased (0.292587 --> 0.266343).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 12 cost time: 0.9034793376922607
Epoch: 12, Steps: 64 | Train Loss: 0.1293911 Vali Loss: 0.2503134 Test Loss: 0.2926652
Validation loss decreased (0.266343 --> 0.250313).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 13 cost time: 0.9029173851013184
Epoch: 13, Steps: 64 | Train Loss: 0.1241494 Vali Loss: 0.2378067 Test Loss: 0.2711009
Validation loss decreased (0.250313 --> 0.237807).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 14 cost time: 0.9046189785003662
Epoch: 14, Steps: 64 | Train Loss: 0.1196598 Vali Loss: 0.2276957 Test Loss: 0.2539994
Validation loss decreased (0.237807 --> 0.227696).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 15 cost time: 0.903998613357544
Epoch: 15, Steps: 64 | Train Loss: 0.1157809 Vali Loss: 0.2167372 Test Loss: 0.2333148
Validation loss decreased (0.227696 --> 0.216737).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 16 cost time: 0.8896567821502686
Epoch: 16, Steps: 64 | Train Loss: 0.1131473 Vali Loss: 0.2130964 Test Loss: 0.2267043
Validation loss decreased (0.216737 --> 0.213096).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 17 cost time: 0.8863863945007324
Epoch: 17, Steps: 64 | Train Loss: 0.1106302 Vali Loss: 0.2063937 Test Loss: 0.2142342
Validation loss decreased (0.213096 --> 0.206394).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 18 cost time: 0.9053990840911865
Epoch: 18, Steps: 64 | Train Loss: 0.1089026 Vali Loss: 0.2016885 Test Loss: 0.2075800
Validation loss decreased (0.206394 --> 0.201689).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 19 cost time: 0.9123766422271729
Epoch: 19, Steps: 64 | Train Loss: 0.1070755 Vali Loss: 0.1973436 Test Loss: 0.1984797
Validation loss decreased (0.201689 --> 0.197344).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 20 cost time: 0.9127449989318848
Epoch: 20, Steps: 64 | Train Loss: 0.1061190 Vali Loss: 0.1948223 Test Loss: 0.1933480
Validation loss decreased (0.197344 --> 0.194822).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 21 cost time: 0.9030008316040039
Epoch: 21, Steps: 64 | Train Loss: 0.1056355 Vali Loss: 0.1906662 Test Loss: 0.1919659
Validation loss decreased (0.194822 --> 0.190666).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 22 cost time: 0.9090402126312256
Epoch: 22, Steps: 64 | Train Loss: 0.1039950 Vali Loss: 0.1897213 Test Loss: 0.1875833
Validation loss decreased (0.190666 --> 0.189721).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 23 cost time: 0.8696310520172119
Epoch: 23, Steps: 64 | Train Loss: 0.1037644 Vali Loss: 0.1903953 Test Loss: 0.1847245
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 24 cost time: 0.8543853759765625
Epoch: 24, Steps: 64 | Train Loss: 0.1024535 Vali Loss: 0.1874947 Test Loss: 0.1817849
Validation loss decreased (0.189721 --> 0.187495).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 25 cost time: 0.8543577194213867
Epoch: 25, Steps: 64 | Train Loss: 0.1019045 Vali Loss: 0.1851941 Test Loss: 0.1813647
Validation loss decreased (0.187495 --> 0.185194).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 26 cost time: 0.8707485198974609
Epoch: 26, Steps: 64 | Train Loss: 0.1013142 Vali Loss: 0.1848562 Test Loss: 0.1796329
Validation loss decreased (0.185194 --> 0.184856).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 27 cost time: 0.8916411399841309
Epoch: 27, Steps: 64 | Train Loss: 0.1008027 Vali Loss: 0.1824332 Test Loss: 0.1769776
Validation loss decreased (0.184856 --> 0.182433).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 28 cost time: 0.8860018253326416
Epoch: 28, Steps: 64 | Train Loss: 0.1013653 Vali Loss: 0.1812977 Test Loss: 0.1754680
Validation loss decreased (0.182433 --> 0.181298).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 29 cost time: 0.9066410064697266
Epoch: 29, Steps: 64 | Train Loss: 0.1005000 Vali Loss: 0.1805286 Test Loss: 0.1733423
Validation loss decreased (0.181298 --> 0.180529).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 30 cost time: 0.8793864250183105
Epoch: 30, Steps: 64 | Train Loss: 0.0996629 Vali Loss: 0.1811915 Test Loss: 0.1737479
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 31 cost time: 0.8504102230072021
Epoch: 31, Steps: 64 | Train Loss: 0.0997295 Vali Loss: 0.1807752 Test Loss: 0.1727514
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 32 cost time: 0.8533637523651123
Epoch: 32, Steps: 64 | Train Loss: 0.0991248 Vali Loss: 0.1776792 Test Loss: 0.1702584
Validation loss decreased (0.180529 --> 0.177679).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 33 cost time: 0.8629999160766602
Epoch: 33, Steps: 64 | Train Loss: 0.0991426 Vali Loss: 0.1768110 Test Loss: 0.1698457
Validation loss decreased (0.177679 --> 0.176811).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 34 cost time: 0.859999418258667
Epoch: 34, Steps: 64 | Train Loss: 0.0991638 Vali Loss: 0.1773027 Test Loss: 0.1696996
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 35 cost time: 0.8980987071990967
Epoch: 35, Steps: 64 | Train Loss: 0.0990452 Vali Loss: 0.1781778 Test Loss: 0.1700244
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 36 cost time: 0.9114377498626709
Epoch: 36, Steps: 64 | Train Loss: 0.0991094 Vali Loss: 0.1777094 Test Loss: 0.1692199
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 37 cost time: 0.9083976745605469
Epoch: 37, Steps: 64 | Train Loss: 0.0983205 Vali Loss: 0.1777296 Test Loss: 0.1681872
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 38 cost time: 0.9093778133392334
Epoch: 38, Steps: 64 | Train Loss: 0.0984868 Vali Loss: 0.1780313 Test Loss: 0.1677597
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 39 cost time: 0.8968567848205566
Epoch: 39, Steps: 64 | Train Loss: 0.0987664 Vali Loss: 0.1783370 Test Loss: 0.1677381
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 40 cost time: 0.9036483764648438
Epoch: 40, Steps: 64 | Train Loss: 0.0982491 Vali Loss: 0.1766792 Test Loss: 0.1677965
Validation loss decreased (0.176811 --> 0.176679).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 41 cost time: 0.8856277465820312
Epoch: 41, Steps: 64 | Train Loss: 0.0979004 Vali Loss: 0.1769514 Test Loss: 0.1670736
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 42 cost time: 0.8814966678619385
Epoch: 42, Steps: 64 | Train Loss: 0.0983286 Vali Loss: 0.1768448 Test Loss: 0.1675472
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 43 cost time: 0.8813679218292236
Epoch: 43, Steps: 64 | Train Loss: 0.0985359 Vali Loss: 0.1757744 Test Loss: 0.1658004
Validation loss decreased (0.176679 --> 0.175774).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 44 cost time: 0.910355806350708
Epoch: 44, Steps: 64 | Train Loss: 0.0978784 Vali Loss: 0.1751796 Test Loss: 0.1661630
Validation loss decreased (0.175774 --> 0.175180).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 45 cost time: 0.9114716053009033
Epoch: 45, Steps: 64 | Train Loss: 0.0983147 Vali Loss: 0.1766951 Test Loss: 0.1664498
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 46 cost time: 0.8860583305358887
Epoch: 46, Steps: 64 | Train Loss: 0.0979035 Vali Loss: 0.1752311 Test Loss: 0.1654367
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 47 cost time: 0.8700015544891357
Epoch: 47, Steps: 64 | Train Loss: 0.0980006 Vali Loss: 0.1760659 Test Loss: 0.1652102
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 48 cost time: 0.8714721202850342
Epoch: 48, Steps: 64 | Train Loss: 0.0981402 Vali Loss: 0.1744508 Test Loss: 0.1657732
Validation loss decreased (0.175180 --> 0.174451).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 49 cost time: 0.8593580722808838
Epoch: 49, Steps: 64 | Train Loss: 0.0976826 Vali Loss: 0.1745688 Test Loss: 0.1658242
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 50 cost time: 0.8761546611785889
Epoch: 50, Steps: 64 | Train Loss: 0.0973959 Vali Loss: 0.1748522 Test Loss: 0.1664051
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 51 cost time: 0.8554050922393799
Epoch: 51, Steps: 64 | Train Loss: 0.0974718 Vali Loss: 0.1759651 Test Loss: 0.1647361
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 52 cost time: 0.8800675868988037
Epoch: 52, Steps: 64 | Train Loss: 0.0977281 Vali Loss: 0.1739824 Test Loss: 0.1645945
Validation loss decreased (0.174451 --> 0.173982).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 53 cost time: 0.9037497043609619
Epoch: 53, Steps: 64 | Train Loss: 0.0973961 Vali Loss: 0.1741548 Test Loss: 0.1639289
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 54 cost time: 0.9203002452850342
Epoch: 54, Steps: 64 | Train Loss: 0.0975643 Vali Loss: 0.1752846 Test Loss: 0.1648690
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 55 cost time: 0.8913702964782715
Epoch: 55, Steps: 64 | Train Loss: 0.0969026 Vali Loss: 0.1762154 Test Loss: 0.1653984
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 56 cost time: 0.8853671550750732
Epoch: 56, Steps: 64 | Train Loss: 0.0973920 Vali Loss: 0.1754942 Test Loss: 0.1653569
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 57 cost time: 0.8854732513427734
Epoch: 57, Steps: 64 | Train Loss: 0.0971544 Vali Loss: 0.1756906 Test Loss: 0.1641931
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 58 cost time: 0.8933918476104736
Epoch: 58, Steps: 64 | Train Loss: 0.0969515 Vali Loss: 0.1739995 Test Loss: 0.1643980
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 59 cost time: 0.8829998970031738
Epoch: 59, Steps: 64 | Train Loss: 0.0974707 Vali Loss: 0.1746151 Test Loss: 0.1638925
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017557144165039062 GB
GPU已分配内存的峰值：0.046389102935791016 GB
Epoch: 60 cost time: 0.8816115856170654
Epoch: 60, Steps: 64 | Train Loss: 0.0976636 Vali Loss: 0.1746186 Test Loss: 0.1641560
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.16459447145462036, mae:0.3154144287109375, rse:0.2159377634525299
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 1 cost time: 2.3174266815185547
Epoch: 1, Steps: 64 | Train Loss: 0.7714019 Vali Loss: 1.7702143 Test Loss: 3.3866839
Validation loss decreased (inf --> 1.770214).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 2 cost time: 0.9244256019592285
Epoch: 2, Steps: 64 | Train Loss: 0.4728779 Vali Loss: 0.3994365 Test Loss: 0.5881445
Validation loss decreased (1.770214 --> 0.399437).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 3 cost time: 0.9386374950408936
Epoch: 3, Steps: 64 | Train Loss: 0.1370159 Vali Loss: 0.1783736 Test Loss: 0.1484127
Validation loss decreased (0.399437 --> 0.178374).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 4 cost time: 0.9490885734558105
Epoch: 4, Steps: 64 | Train Loss: 0.1079231 Vali Loss: 0.1810960 Test Loss: 0.1513021
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 5 cost time: 0.8873603343963623
Epoch: 5, Steps: 64 | Train Loss: 0.1026031 Vali Loss: 0.1715509 Test Loss: 0.1478365
Validation loss decreased (0.178374 --> 0.171551).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 6 cost time: 0.8903841972351074
Epoch: 6, Steps: 64 | Train Loss: 0.0999214 Vali Loss: 0.1706902 Test Loss: 0.1457293
Validation loss decreased (0.171551 --> 0.170690).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 7 cost time: 0.8870353698730469
Epoch: 7, Steps: 64 | Train Loss: 0.0982415 Vali Loss: 0.1661259 Test Loss: 0.1454106
Validation loss decreased (0.170690 --> 0.166126).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 8 cost time: 0.8977100849151611
Epoch: 8, Steps: 64 | Train Loss: 0.0964200 Vali Loss: 0.1664838 Test Loss: 0.1458956
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 9 cost time: 0.9199995994567871
Epoch: 9, Steps: 64 | Train Loss: 0.0949958 Vali Loss: 0.1646518 Test Loss: 0.1432925
Validation loss decreased (0.166126 --> 0.164652).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 10 cost time: 0.9406354427337646
Epoch: 10, Steps: 64 | Train Loss: 0.0940425 Vali Loss: 0.1634808 Test Loss: 0.1447618
Validation loss decreased (0.164652 --> 0.163481).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 11 cost time: 0.9496092796325684
Epoch: 11, Steps: 64 | Train Loss: 0.0935214 Vali Loss: 0.1631493 Test Loss: 0.1433442
Validation loss decreased (0.163481 --> 0.163149).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 12 cost time: 0.9414322376251221
Epoch: 12, Steps: 64 | Train Loss: 0.0927345 Vali Loss: 0.1631869 Test Loss: 0.1431948
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 13 cost time: 0.9444115161895752
Epoch: 13, Steps: 64 | Train Loss: 0.0919265 Vali Loss: 0.1616890 Test Loss: 0.1426389
Validation loss decreased (0.163149 --> 0.161689).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 14 cost time: 0.9354233741760254
Epoch: 14, Steps: 64 | Train Loss: 0.0913937 Vali Loss: 0.1620384 Test Loss: 0.1423824
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 15 cost time: 0.918968677520752
Epoch: 15, Steps: 64 | Train Loss: 0.0911574 Vali Loss: 0.1608824 Test Loss: 0.1442840
Validation loss decreased (0.161689 --> 0.160882).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 16 cost time: 0.914393424987793
Epoch: 16, Steps: 64 | Train Loss: 0.0910669 Vali Loss: 0.1592792 Test Loss: 0.1429109
Validation loss decreased (0.160882 --> 0.159279).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 17 cost time: 0.94687819480896
Epoch: 17, Steps: 64 | Train Loss: 0.0904197 Vali Loss: 0.1616265 Test Loss: 0.1429210
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 18 cost time: 0.9580001831054688
Epoch: 18, Steps: 64 | Train Loss: 0.0902139 Vali Loss: 0.1595202 Test Loss: 0.1431199
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 19 cost time: 0.9373795986175537
Epoch: 19, Steps: 64 | Train Loss: 0.0898132 Vali Loss: 0.1598377 Test Loss: 0.1427552
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 20 cost time: 0.9446332454681396
Epoch: 20, Steps: 64 | Train Loss: 0.0896245 Vali Loss: 0.1594759 Test Loss: 0.1427231
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 21 cost time: 0.9423980712890625
Epoch: 21, Steps: 64 | Train Loss: 0.0895479 Vali Loss: 0.1598159 Test Loss: 0.1431694
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 22 cost time: 0.9083008766174316
Epoch: 22, Steps: 64 | Train Loss: 0.0897647 Vali Loss: 0.1597007 Test Loss: 0.1431852
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 23 cost time: 0.9244699478149414
Epoch: 23, Steps: 64 | Train Loss: 0.0892931 Vali Loss: 0.1591045 Test Loss: 0.1431125
Validation loss decreased (0.159279 --> 0.159104).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 24 cost time: 0.9293997287750244
Epoch: 24, Steps: 64 | Train Loss: 0.0887694 Vali Loss: 0.1578003 Test Loss: 0.1424068
Validation loss decreased (0.159104 --> 0.157800).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 25 cost time: 0.9124360084533691
Epoch: 25, Steps: 64 | Train Loss: 0.0887124 Vali Loss: 0.1596863 Test Loss: 0.1425084
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 26 cost time: 0.916740894317627
Epoch: 26, Steps: 64 | Train Loss: 0.0890010 Vali Loss: 0.1575224 Test Loss: 0.1425723
Validation loss decreased (0.157800 --> 0.157522).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 27 cost time: 0.9227755069732666
Epoch: 27, Steps: 64 | Train Loss: 0.0888410 Vali Loss: 0.1589860 Test Loss: 0.1435644
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 28 cost time: 0.9226295948028564
Epoch: 28, Steps: 64 | Train Loss: 0.0886832 Vali Loss: 0.1599239 Test Loss: 0.1435284
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 29 cost time: 0.9336307048797607
Epoch: 29, Steps: 64 | Train Loss: 0.0889550 Vali Loss: 0.1583503 Test Loss: 0.1429582
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 30 cost time: 0.9284813404083252
Epoch: 30, Steps: 64 | Train Loss: 0.0884782 Vali Loss: 0.1577062 Test Loss: 0.1428810
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 31 cost time: 0.9414997100830078
Epoch: 31, Steps: 64 | Train Loss: 0.0885740 Vali Loss: 0.1587075 Test Loss: 0.1429313
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 32 cost time: 0.8874132633209229
Epoch: 32, Steps: 64 | Train Loss: 0.0880330 Vali Loss: 0.1592560 Test Loss: 0.1433055
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 33 cost time: 0.8987767696380615
Epoch: 33, Steps: 64 | Train Loss: 0.0879530 Vali Loss: 0.1583550 Test Loss: 0.1433342
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 34 cost time: 0.9477858543395996
Epoch: 34, Steps: 64 | Train Loss: 0.0875906 Vali Loss: 0.1567769 Test Loss: 0.1437823
Validation loss decreased (0.157522 --> 0.156777).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 35 cost time: 0.9500000476837158
Epoch: 35, Steps: 64 | Train Loss: 0.0877884 Vali Loss: 0.1591863 Test Loss: 0.1432147
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 36 cost time: 0.9466123580932617
Epoch: 36, Steps: 64 | Train Loss: 0.0880847 Vali Loss: 0.1569671 Test Loss: 0.1429429
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 37 cost time: 0.9426498413085938
Epoch: 37, Steps: 64 | Train Loss: 0.0875917 Vali Loss: 0.1601232 Test Loss: 0.1424786
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 38 cost time: 0.9433937072753906
Epoch: 38, Steps: 64 | Train Loss: 0.0880829 Vali Loss: 0.1584202 Test Loss: 0.1432414
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 39 cost time: 0.9164018630981445
Epoch: 39, Steps: 64 | Train Loss: 0.0879828 Vali Loss: 0.1578736 Test Loss: 0.1428666
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 40 cost time: 0.9219808578491211
Epoch: 40, Steps: 64 | Train Loss: 0.0876623 Vali Loss: 0.1590983 Test Loss: 0.1435644
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 41 cost time: 0.9210450649261475
Epoch: 41, Steps: 64 | Train Loss: 0.0881885 Vali Loss: 0.1590682 Test Loss: 0.1435112
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 42 cost time: 0.9347250461578369
Epoch: 42, Steps: 64 | Train Loss: 0.0884169 Vali Loss: 0.1586167 Test Loss: 0.1435868
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 43 cost time: 0.9427516460418701
Epoch: 43, Steps: 64 | Train Loss: 0.0879346 Vali Loss: 0.1590492 Test Loss: 0.1433518
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 44 cost time: 0.9314982891082764
Epoch: 44, Steps: 64 | Train Loss: 0.0880087 Vali Loss: 0.1572702 Test Loss: 0.1437061
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 45 cost time: 0.9248232841491699
Epoch: 45, Steps: 64 | Train Loss: 0.0875884 Vali Loss: 0.1586148 Test Loss: 0.1434832
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 46 cost time: 0.9396193027496338
Epoch: 46, Steps: 64 | Train Loss: 0.0878026 Vali Loss: 0.1582900 Test Loss: 0.1435085
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 47 cost time: 0.9345169067382812
Epoch: 47, Steps: 64 | Train Loss: 0.0879686 Vali Loss: 0.1577727 Test Loss: 0.1433392
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 48 cost time: 0.9431183338165283
Epoch: 48, Steps: 64 | Train Loss: 0.0876915 Vali Loss: 0.1590352 Test Loss: 0.1436736
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 49 cost time: 0.8907790184020996
Epoch: 49, Steps: 64 | Train Loss: 0.0877826 Vali Loss: 0.1581304 Test Loss: 0.1435259
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 50 cost time: 0.9234204292297363
Epoch: 50, Steps: 64 | Train Loss: 0.0879139 Vali Loss: 0.1583382 Test Loss: 0.1435215
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 51 cost time: 0.918729305267334
Epoch: 51, Steps: 64 | Train Loss: 0.0877166 Vali Loss: 0.1593189 Test Loss: 0.1436521
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 52 cost time: 0.9187901020050049
Epoch: 52, Steps: 64 | Train Loss: 0.0877258 Vali Loss: 0.1575471 Test Loss: 0.1435937
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 53 cost time: 0.938007116317749
Epoch: 53, Steps: 64 | Train Loss: 0.0878718 Vali Loss: 0.1577401 Test Loss: 0.1437456
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 54 cost time: 0.9086401462554932
Epoch: 54, Steps: 64 | Train Loss: 0.0877214 Vali Loss: 0.1578141 Test Loss: 0.1438309
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 55 cost time: 0.9444799423217773
Epoch: 55, Steps: 64 | Train Loss: 0.0878432 Vali Loss: 0.1556279 Test Loss: 0.1432221
Validation loss decreased (0.156777 --> 0.155628).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 56 cost time: 0.932471513748169
Epoch: 56, Steps: 64 | Train Loss: 0.0870510 Vali Loss: 0.1565142 Test Loss: 0.1437951
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 57 cost time: 0.935438871383667
Epoch: 57, Steps: 64 | Train Loss: 0.0876787 Vali Loss: 0.1597234 Test Loss: 0.1436226
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 58 cost time: 0.936453104019165
Epoch: 58, Steps: 64 | Train Loss: 0.0876085 Vali Loss: 0.1592397 Test Loss: 0.1434471
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 59 cost time: 0.9443886280059814
Epoch: 59, Steps: 64 | Train Loss: 0.0877122 Vali Loss: 0.1587971 Test Loss: 0.1436802
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019273757934570312 GB
GPU已分配内存的峰值：0.05042219161987305 GB
Epoch: 60 cost time: 0.9477875232696533
Epoch: 60, Steps: 64 | Train Loss: 0.0878866 Vali Loss: 0.1578807 Test Loss: 0.1435704
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14322207868099213, mae:0.28283312916755676, rse:0.20143084228038788
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.053494930267333984 GB
Epoch: 1 cost time: 2.3579225540161133
Epoch: 1, Steps: 64 | Train Loss: 0.7758415 Vali Loss: 1.8091230 Test Loss: 3.4466143
Validation loss decreased (inf --> 1.809123).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 2 cost time: 0.9474737644195557
Epoch: 2, Steps: 64 | Train Loss: 0.4214882 Vali Loss: 0.1852784 Test Loss: 0.1691219
Validation loss decreased (1.809123 --> 0.185278).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 3 cost time: 0.9458138942718506
Epoch: 3, Steps: 64 | Train Loss: 0.1204835 Vali Loss: 0.1977063 Test Loss: 0.1766476
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 4 cost time: 0.9462354183197021
Epoch: 4, Steps: 64 | Train Loss: 0.1073358 Vali Loss: 0.1723199 Test Loss: 0.1476430
Validation loss decreased (0.185278 --> 0.172320).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 5 cost time: 0.9610002040863037
Epoch: 5, Steps: 64 | Train Loss: 0.1021743 Vali Loss: 0.1679372 Test Loss: 0.1486399
Validation loss decreased (0.172320 --> 0.167937).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 6 cost time: 0.9640004634857178
Epoch: 6, Steps: 64 | Train Loss: 0.0993007 Vali Loss: 0.1680609 Test Loss: 0.1494945
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 7 cost time: 0.9726419448852539
Epoch: 7, Steps: 64 | Train Loss: 0.0969682 Vali Loss: 0.1653519 Test Loss: 0.1471381
Validation loss decreased (0.167937 --> 0.165352).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 8 cost time: 0.9536261558532715
Epoch: 8, Steps: 64 | Train Loss: 0.0956283 Vali Loss: 0.1650462 Test Loss: 0.1458540
Validation loss decreased (0.165352 --> 0.165046).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 9 cost time: 0.9483973979949951
Epoch: 9, Steps: 64 | Train Loss: 0.0946218 Vali Loss: 0.1641478 Test Loss: 0.1471747
Validation loss decreased (0.165046 --> 0.164148).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 10 cost time: 0.949251651763916
Epoch: 10, Steps: 64 | Train Loss: 0.0938506 Vali Loss: 0.1650189 Test Loss: 0.1481156
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 11 cost time: 0.9634041786193848
Epoch: 11, Steps: 64 | Train Loss: 0.0924299 Vali Loss: 0.1638000 Test Loss: 0.1472866
Validation loss decreased (0.164148 --> 0.163800).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 12 cost time: 0.9733977317810059
Epoch: 12, Steps: 64 | Train Loss: 0.0918292 Vali Loss: 0.1624096 Test Loss: 0.1454946
Validation loss decreased (0.163800 --> 0.162410).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 13 cost time: 0.9493453502655029
Epoch: 13, Steps: 64 | Train Loss: 0.0915299 Vali Loss: 0.1629290 Test Loss: 0.1474518
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 14 cost time: 0.9499976634979248
Epoch: 14, Steps: 64 | Train Loss: 0.0912551 Vali Loss: 0.1624953 Test Loss: 0.1467151
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 15 cost time: 0.9308092594146729
Epoch: 15, Steps: 64 | Train Loss: 0.0905854 Vali Loss: 0.1620357 Test Loss: 0.1469347
Validation loss decreased (0.162410 --> 0.162036).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 16 cost time: 0.9583096504211426
Epoch: 16, Steps: 64 | Train Loss: 0.0902552 Vali Loss: 0.1633449 Test Loss: 0.1478692
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 17 cost time: 0.9719977378845215
Epoch: 17, Steps: 64 | Train Loss: 0.0900534 Vali Loss: 0.1603369 Test Loss: 0.1464639
Validation loss decreased (0.162036 --> 0.160337).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 18 cost time: 0.97503662109375
Epoch: 18, Steps: 64 | Train Loss: 0.0900046 Vali Loss: 0.1624824 Test Loss: 0.1473414
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 19 cost time: 0.9716441631317139
Epoch: 19, Steps: 64 | Train Loss: 0.0895431 Vali Loss: 0.1609382 Test Loss: 0.1480806
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 20 cost time: 0.9665012359619141
Epoch: 20, Steps: 64 | Train Loss: 0.0890150 Vali Loss: 0.1630425 Test Loss: 0.1483193
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 21 cost time: 0.9614293575286865
Epoch: 21, Steps: 64 | Train Loss: 0.0890089 Vali Loss: 0.1604863 Test Loss: 0.1473756
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 22 cost time: 0.9327843189239502
Epoch: 22, Steps: 64 | Train Loss: 0.0888096 Vali Loss: 0.1618308 Test Loss: 0.1478857
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 23 cost time: 0.9195137023925781
Epoch: 23, Steps: 64 | Train Loss: 0.0887258 Vali Loss: 0.1613615 Test Loss: 0.1478859
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 24 cost time: 0.9214255809783936
Epoch: 24, Steps: 64 | Train Loss: 0.0882051 Vali Loss: 0.1597039 Test Loss: 0.1475988
Validation loss decreased (0.160337 --> 0.159704).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 25 cost time: 0.9454028606414795
Epoch: 25, Steps: 64 | Train Loss: 0.0883261 Vali Loss: 0.1618940 Test Loss: 0.1485403
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 26 cost time: 0.9447252750396729
Epoch: 26, Steps: 64 | Train Loss: 0.0887124 Vali Loss: 0.1606682 Test Loss: 0.1484336
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 27 cost time: 0.9459991455078125
Epoch: 27, Steps: 64 | Train Loss: 0.0882860 Vali Loss: 0.1617511 Test Loss: 0.1488890
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 28 cost time: 0.9419996738433838
Epoch: 28, Steps: 64 | Train Loss: 0.0877242 Vali Loss: 0.1625510 Test Loss: 0.1481198
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 29 cost time: 0.9506344795227051
Epoch: 29, Steps: 64 | Train Loss: 0.0882278 Vali Loss: 0.1617031 Test Loss: 0.1491523
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 30 cost time: 0.9583070278167725
Epoch: 30, Steps: 64 | Train Loss: 0.0880512 Vali Loss: 0.1618914 Test Loss: 0.1481011
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 31 cost time: 0.9694850444793701
Epoch: 31, Steps: 64 | Train Loss: 0.0879728 Vali Loss: 0.1601329 Test Loss: 0.1490875
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 32 cost time: 0.9699838161468506
Epoch: 32, Steps: 64 | Train Loss: 0.0874938 Vali Loss: 0.1604884 Test Loss: 0.1480296
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 33 cost time: 0.9743897914886475
Epoch: 33, Steps: 64 | Train Loss: 0.0878410 Vali Loss: 0.1615455 Test Loss: 0.1485308
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 34 cost time: 0.9751696586608887
Epoch: 34, Steps: 64 | Train Loss: 0.0878163 Vali Loss: 0.1611270 Test Loss: 0.1491956
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 35 cost time: 0.9693489074707031
Epoch: 35, Steps: 64 | Train Loss: 0.0875020 Vali Loss: 0.1621872 Test Loss: 0.1480520
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 36 cost time: 0.9664688110351562
Epoch: 36, Steps: 64 | Train Loss: 0.0874522 Vali Loss: 0.1629170 Test Loss: 0.1491978
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 37 cost time: 0.9467852115631104
Epoch: 37, Steps: 64 | Train Loss: 0.0874942 Vali Loss: 0.1609120 Test Loss: 0.1494030
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 38 cost time: 0.9748220443725586
Epoch: 38, Steps: 64 | Train Loss: 0.0876636 Vali Loss: 0.1614758 Test Loss: 0.1497056
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 39 cost time: 0.9709997177124023
Epoch: 39, Steps: 64 | Train Loss: 0.0878459 Vali Loss: 0.1589949 Test Loss: 0.1484660
Validation loss decreased (0.159704 --> 0.158995).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 40 cost time: 0.970653772354126
Epoch: 40, Steps: 64 | Train Loss: 0.0876362 Vali Loss: 0.1622968 Test Loss: 0.1494487
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 41 cost time: 0.9916074275970459
Epoch: 41, Steps: 64 | Train Loss: 0.0873983 Vali Loss: 0.1603879 Test Loss: 0.1486787
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 42 cost time: 0.9742298126220703
Epoch: 42, Steps: 64 | Train Loss: 0.0877450 Vali Loss: 0.1621247 Test Loss: 0.1486831
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 43 cost time: 0.9623932838439941
Epoch: 43, Steps: 64 | Train Loss: 0.0875975 Vali Loss: 0.1604821 Test Loss: 0.1488818
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 44 cost time: 0.9433948993682861
Epoch: 44, Steps: 64 | Train Loss: 0.0877336 Vali Loss: 0.1623497 Test Loss: 0.1489286
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 45 cost time: 0.9194555282592773
Epoch: 45, Steps: 64 | Train Loss: 0.0875792 Vali Loss: 0.1604309 Test Loss: 0.1488145
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 46 cost time: 0.9261703491210938
Epoch: 46, Steps: 64 | Train Loss: 0.0870805 Vali Loss: 0.1599925 Test Loss: 0.1493388
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 47 cost time: 0.9143669605255127
Epoch: 47, Steps: 64 | Train Loss: 0.0874584 Vali Loss: 0.1603729 Test Loss: 0.1486780
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 48 cost time: 0.9457533359527588
Epoch: 48, Steps: 64 | Train Loss: 0.0869487 Vali Loss: 0.1629232 Test Loss: 0.1490008
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 49 cost time: 0.9469995498657227
Epoch: 49, Steps: 64 | Train Loss: 0.0874801 Vali Loss: 0.1612327 Test Loss: 0.1492935
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 50 cost time: 0.9516317844390869
Epoch: 50, Steps: 64 | Train Loss: 0.0876586 Vali Loss: 0.1607354 Test Loss: 0.1494813
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 51 cost time: 0.9556324481964111
Epoch: 51, Steps: 64 | Train Loss: 0.0874088 Vali Loss: 0.1604375 Test Loss: 0.1489909
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 52 cost time: 0.9334220886230469
Epoch: 52, Steps: 64 | Train Loss: 0.0870238 Vali Loss: 0.1609067 Test Loss: 0.1495440
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 53 cost time: 0.9203841686248779
Epoch: 53, Steps: 64 | Train Loss: 0.0872177 Vali Loss: 0.1614338 Test Loss: 0.1491114
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 54 cost time: 0.9574141502380371
Epoch: 54, Steps: 64 | Train Loss: 0.0874197 Vali Loss: 0.1594414 Test Loss: 0.1490231
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 55 cost time: 0.9584002494812012
Epoch: 55, Steps: 64 | Train Loss: 0.0873807 Vali Loss: 0.1607245 Test Loss: 0.1499223
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 56 cost time: 0.9804224967956543
Epoch: 56, Steps: 64 | Train Loss: 0.0874678 Vali Loss: 0.1604306 Test Loss: 0.1490616
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 57 cost time: 0.9854371547698975
Epoch: 57, Steps: 64 | Train Loss: 0.0874451 Vali Loss: 0.1616832 Test Loss: 0.1490685
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 58 cost time: 0.9748048782348633
Epoch: 58, Steps: 64 | Train Loss: 0.0875407 Vali Loss: 0.1592942 Test Loss: 0.1487413
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 59 cost time: 0.9723811149597168
Epoch: 59, Steps: 64 | Train Loss: 0.0869509 Vali Loss: 0.1596807 Test Loss: 0.1488833
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020143508911132812 GB
GPU已分配内存的峰值：0.05567121505737305 GB
Epoch: 60 cost time: 0.9610002040863037
Epoch: 60, Steps: 64 | Train Loss: 0.0873570 Vali Loss: 0.1600796 Test Loss: 0.1495123
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14846602082252502, mae:0.29302674531936646, rse:0.20508529245853424
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.049500465393066406 GB
Epoch: 1 cost time: 2.247915029525757
Epoch: 1, Steps: 64 | Train Loss: 0.8273314 Vali Loss: 1.8260645 Test Loss: 3.4842649
Validation loss decreased (inf --> 1.826064).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 2 cost time: 0.8596301078796387
Epoch: 2, Steps: 64 | Train Loss: 0.7056552 Vali Loss: 1.3615258 Test Loss: 2.5130963
Validation loss decreased (1.826064 --> 1.361526).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 3 cost time: 0.8646445274353027
Epoch: 3, Steps: 64 | Train Loss: 0.5501144 Vali Loss: 1.0618975 Test Loss: 1.8998004
Validation loss decreased (1.361526 --> 1.061898).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 4 cost time: 0.8814215660095215
Epoch: 4, Steps: 64 | Train Loss: 0.4321144 Vali Loss: 0.8326688 Test Loss: 1.4347547
Validation loss decreased (1.061898 --> 0.832669).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 5 cost time: 0.8529667854309082
Epoch: 5, Steps: 64 | Train Loss: 0.3428968 Vali Loss: 0.6704634 Test Loss: 1.1086947
Validation loss decreased (0.832669 --> 0.670463).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 6 cost time: 0.8518688678741455
Epoch: 6, Steps: 64 | Train Loss: 0.2788357 Vali Loss: 0.5547175 Test Loss: 0.8689668
Validation loss decreased (0.670463 --> 0.554717).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 7 cost time: 0.8521959781646729
Epoch: 7, Steps: 64 | Train Loss: 0.2337625 Vali Loss: 0.4700272 Test Loss: 0.7063760
Validation loss decreased (0.554717 --> 0.470027).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 8 cost time: 0.8627560138702393
Epoch: 8, Steps: 64 | Train Loss: 0.2026281 Vali Loss: 0.4089362 Test Loss: 0.5843466
Validation loss decreased (0.470027 --> 0.408936).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 9 cost time: 0.8466293811798096
Epoch: 9, Steps: 64 | Train Loss: 0.1791495 Vali Loss: 0.3636736 Test Loss: 0.4977222
Validation loss decreased (0.408936 --> 0.363674).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 10 cost time: 0.8644559383392334
Epoch: 10, Steps: 64 | Train Loss: 0.1625307 Vali Loss: 0.3286607 Test Loss: 0.4332673
Validation loss decreased (0.363674 --> 0.328661).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 11 cost time: 0.8614459037780762
Epoch: 11, Steps: 64 | Train Loss: 0.1510263 Vali Loss: 0.3020440 Test Loss: 0.3843321
Validation loss decreased (0.328661 --> 0.302044).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 12 cost time: 0.8798666000366211
Epoch: 12, Steps: 64 | Train Loss: 0.1417077 Vali Loss: 0.2852262 Test Loss: 0.3488682
Validation loss decreased (0.302044 --> 0.285226).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 13 cost time: 0.8823502063751221
Epoch: 13, Steps: 64 | Train Loss: 0.1345455 Vali Loss: 0.2674651 Test Loss: 0.3168058
Validation loss decreased (0.285226 --> 0.267465).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 14 cost time: 0.8656375408172607
Epoch: 14, Steps: 64 | Train Loss: 0.1292945 Vali Loss: 0.2532062 Test Loss: 0.2948562
Validation loss decreased (0.267465 --> 0.253206).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 15 cost time: 0.8647754192352295
Epoch: 15, Steps: 64 | Train Loss: 0.1252068 Vali Loss: 0.2446625 Test Loss: 0.2770634
Validation loss decreased (0.253206 --> 0.244662).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 16 cost time: 0.8674454689025879
Epoch: 16, Steps: 64 | Train Loss: 0.1214483 Vali Loss: 0.2369650 Test Loss: 0.2604659
Validation loss decreased (0.244662 --> 0.236965).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 17 cost time: 0.8604223728179932
Epoch: 17, Steps: 64 | Train Loss: 0.1180350 Vali Loss: 0.2313204 Test Loss: 0.2519270
Validation loss decreased (0.236965 --> 0.231320).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 18 cost time: 0.8617472648620605
Epoch: 18, Steps: 64 | Train Loss: 0.1161148 Vali Loss: 0.2249299 Test Loss: 0.2395171
Validation loss decreased (0.231320 --> 0.224930).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 19 cost time: 0.8870022296905518
Epoch: 19, Steps: 64 | Train Loss: 0.1141593 Vali Loss: 0.2205348 Test Loss: 0.2297262
Validation loss decreased (0.224930 --> 0.220535).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 20 cost time: 0.8796184062957764
Epoch: 20, Steps: 64 | Train Loss: 0.1126907 Vali Loss: 0.2179108 Test Loss: 0.2250499
Validation loss decreased (0.220535 --> 0.217911).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 21 cost time: 0.8773553371429443
Epoch: 21, Steps: 64 | Train Loss: 0.1108406 Vali Loss: 0.2129523 Test Loss: 0.2190550
Validation loss decreased (0.217911 --> 0.212952).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 22 cost time: 0.8813841342926025
Epoch: 22, Steps: 64 | Train Loss: 0.1105325 Vali Loss: 0.2089636 Test Loss: 0.2124828
Validation loss decreased (0.212952 --> 0.208964).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 23 cost time: 0.8613998889923096
Epoch: 23, Steps: 64 | Train Loss: 0.1092883 Vali Loss: 0.2085382 Test Loss: 0.2094606
Validation loss decreased (0.208964 --> 0.208538).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 24 cost time: 0.8570003509521484
Epoch: 24, Steps: 64 | Train Loss: 0.1083102 Vali Loss: 0.2071375 Test Loss: 0.2081972
Validation loss decreased (0.208538 --> 0.207137).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 25 cost time: 0.8490011692047119
Epoch: 25, Steps: 64 | Train Loss: 0.1071024 Vali Loss: 0.2025860 Test Loss: 0.2055441
Validation loss decreased (0.207137 --> 0.202586).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 26 cost time: 0.8525030612945557
Epoch: 26, Steps: 64 | Train Loss: 0.1068532 Vali Loss: 0.2003149 Test Loss: 0.2008703
Validation loss decreased (0.202586 --> 0.200315).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 27 cost time: 0.8504722118377686
Epoch: 27, Steps: 64 | Train Loss: 0.1067834 Vali Loss: 0.1999438 Test Loss: 0.1996003
Validation loss decreased (0.200315 --> 0.199944).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 28 cost time: 0.8597557544708252
Epoch: 28, Steps: 64 | Train Loss: 0.1058476 Vali Loss: 0.1986339 Test Loss: 0.1980359
Validation loss decreased (0.199944 --> 0.198634).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 29 cost time: 0.8667910099029541
Epoch: 29, Steps: 64 | Train Loss: 0.1055269 Vali Loss: 0.1970214 Test Loss: 0.1948498
Validation loss decreased (0.198634 --> 0.197021).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 30 cost time: 0.8690004348754883
Epoch: 30, Steps: 64 | Train Loss: 0.1054540 Vali Loss: 0.1977476 Test Loss: 0.1943566
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 31 cost time: 0.8626327514648438
Epoch: 31, Steps: 64 | Train Loss: 0.1045557 Vali Loss: 0.1967461 Test Loss: 0.1912813
Validation loss decreased (0.197021 --> 0.196746).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 32 cost time: 0.847775936126709
Epoch: 32, Steps: 64 | Train Loss: 0.1040304 Vali Loss: 0.1959829 Test Loss: 0.1910930
Validation loss decreased (0.196746 --> 0.195983).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 33 cost time: 0.8595452308654785
Epoch: 33, Steps: 64 | Train Loss: 0.1042710 Vali Loss: 0.1962183 Test Loss: 0.1912932
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 34 cost time: 0.8517680168151855
Epoch: 34, Steps: 64 | Train Loss: 0.1042197 Vali Loss: 0.1951570 Test Loss: 0.1902634
Validation loss decreased (0.195983 --> 0.195157).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 35 cost time: 0.8600003719329834
Epoch: 35, Steps: 64 | Train Loss: 0.1037115 Vali Loss: 0.1942885 Test Loss: 0.1896629
Validation loss decreased (0.195157 --> 0.194288).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 36 cost time: 0.8636107444763184
Epoch: 36, Steps: 64 | Train Loss: 0.1036795 Vali Loss: 0.1932730 Test Loss: 0.1886076
Validation loss decreased (0.194288 --> 0.193273).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 37 cost time: 0.8874409198760986
Epoch: 37, Steps: 64 | Train Loss: 0.1035644 Vali Loss: 0.1937621 Test Loss: 0.1882433
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 38 cost time: 0.8884212970733643
Epoch: 38, Steps: 64 | Train Loss: 0.1033657 Vali Loss: 0.1927544 Test Loss: 0.1859259
Validation loss decreased (0.193273 --> 0.192754).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 39 cost time: 0.883507251739502
Epoch: 39, Steps: 64 | Train Loss: 0.1033402 Vali Loss: 0.1932838 Test Loss: 0.1856781
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 40 cost time: 0.8868179321289062
Epoch: 40, Steps: 64 | Train Loss: 0.1027632 Vali Loss: 0.1934882 Test Loss: 0.1865729
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 41 cost time: 0.8493702411651611
Epoch: 41, Steps: 64 | Train Loss: 0.1034347 Vali Loss: 0.1915776 Test Loss: 0.1857487
Validation loss decreased (0.192754 --> 0.191578).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 42 cost time: 0.8616442680358887
Epoch: 42, Steps: 64 | Train Loss: 0.1029105 Vali Loss: 0.1916498 Test Loss: 0.1846537
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 43 cost time: 0.8655140399932861
Epoch: 43, Steps: 64 | Train Loss: 0.1031361 Vali Loss: 0.1927534 Test Loss: 0.1855841
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 44 cost time: 0.8654322624206543
Epoch: 44, Steps: 64 | Train Loss: 0.1028420 Vali Loss: 0.1926242 Test Loss: 0.1848104
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 45 cost time: 0.8607907295227051
Epoch: 45, Steps: 64 | Train Loss: 0.1025630 Vali Loss: 0.1918256 Test Loss: 0.1834437
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 46 cost time: 0.8573980331420898
Epoch: 46, Steps: 64 | Train Loss: 0.1022347 Vali Loss: 0.1921509 Test Loss: 0.1849755
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 47 cost time: 0.8636116981506348
Epoch: 47, Steps: 64 | Train Loss: 0.1023564 Vali Loss: 0.1919701 Test Loss: 0.1841067
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 48 cost time: 0.8714730739593506
Epoch: 48, Steps: 64 | Train Loss: 0.1022733 Vali Loss: 0.1894079 Test Loss: 0.1823667
Validation loss decreased (0.191578 --> 0.189408).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 49 cost time: 0.8603975772857666
Epoch: 49, Steps: 64 | Train Loss: 0.1019786 Vali Loss: 0.1893535 Test Loss: 0.1832330
Validation loss decreased (0.189408 --> 0.189354).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 50 cost time: 0.8443789482116699
Epoch: 50, Steps: 64 | Train Loss: 0.1018492 Vali Loss: 0.1905909 Test Loss: 0.1838553
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 51 cost time: 0.8590013980865479
Epoch: 51, Steps: 64 | Train Loss: 0.1014847 Vali Loss: 0.1902311 Test Loss: 0.1831222
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 52 cost time: 0.8486440181732178
Epoch: 52, Steps: 64 | Train Loss: 0.1024162 Vali Loss: 0.1891589 Test Loss: 0.1839403
Validation loss decreased (0.189354 --> 0.189159).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 53 cost time: 0.8444068431854248
Epoch: 53, Steps: 64 | Train Loss: 0.1021689 Vali Loss: 0.1875803 Test Loss: 0.1818728
Validation loss decreased (0.189159 --> 0.187580).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 54 cost time: 0.8533849716186523
Epoch: 54, Steps: 64 | Train Loss: 0.1019090 Vali Loss: 0.1901858 Test Loss: 0.1823557
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 55 cost time: 0.8629624843597412
Epoch: 55, Steps: 64 | Train Loss: 0.1021738 Vali Loss: 0.1885385 Test Loss: 0.1806795
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 56 cost time: 0.8667426109313965
Epoch: 56, Steps: 64 | Train Loss: 0.1019965 Vali Loss: 0.1902870 Test Loss: 0.1816965
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 57 cost time: 0.8810009956359863
Epoch: 57, Steps: 64 | Train Loss: 0.1021726 Vali Loss: 0.1879265 Test Loss: 0.1813134
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 58 cost time: 0.8836348056793213
Epoch: 58, Steps: 64 | Train Loss: 0.1022521 Vali Loss: 0.1894348 Test Loss: 0.1827624
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 59 cost time: 0.878241777420044
Epoch: 59, Steps: 64 | Train Loss: 0.1017025 Vali Loss: 0.1865709 Test Loss: 0.1808508
Validation loss decreased (0.187580 --> 0.186571).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017635345458984375 GB
GPU已分配内存的峰值：0.04972076416015625 GB
Epoch: 60 cost time: 0.8634767532348633
Epoch: 60, Steps: 64 | Train Loss: 0.1018528 Vali Loss: 0.1884479 Test Loss: 0.1826695
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1808508038520813, mae:0.3347701132297516, rse:0.22635036706924438
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 1 cost time: 2.2911181449890137
Epoch: 1, Steps: 64 | Train Loss: 0.8419300 Vali Loss: 1.9246503 Test Loss: 3.6751187
Validation loss decreased (inf --> 1.924650).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 2 cost time: 0.9055676460266113
Epoch: 2, Steps: 64 | Train Loss: 0.5407957 Vali Loss: 0.6534241 Test Loss: 1.0801120
Validation loss decreased (1.924650 --> 0.653424).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 3 cost time: 0.8997330665588379
Epoch: 3, Steps: 64 | Train Loss: 0.1854713 Vali Loss: 0.2156180 Test Loss: 0.1989099
Validation loss decreased (0.653424 --> 0.215618).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 4 cost time: 0.8983945846557617
Epoch: 4, Steps: 64 | Train Loss: 0.1178969 Vali Loss: 0.1863007 Test Loss: 0.1603537
Validation loss decreased (0.215618 --> 0.186301).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 5 cost time: 0.8849995136260986
Epoch: 5, Steps: 64 | Train Loss: 0.1104939 Vali Loss: 0.1840368 Test Loss: 0.1590445
Validation loss decreased (0.186301 --> 0.184037).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 6 cost time: 0.8876299858093262
Epoch: 6, Steps: 64 | Train Loss: 0.1069081 Vali Loss: 0.1787317 Test Loss: 0.1542891
Validation loss decreased (0.184037 --> 0.178732).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 7 cost time: 0.8814668655395508
Epoch: 7, Steps: 64 | Train Loss: 0.1040835 Vali Loss: 0.1804679 Test Loss: 0.1537908
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 8 cost time: 0.8813931941986084
Epoch: 8, Steps: 64 | Train Loss: 0.1021292 Vali Loss: 0.1755863 Test Loss: 0.1514109
Validation loss decreased (0.178732 --> 0.175586).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 9 cost time: 0.9024596214294434
Epoch: 9, Steps: 64 | Train Loss: 0.0999991 Vali Loss: 0.1730024 Test Loss: 0.1510196
Validation loss decreased (0.175586 --> 0.173002).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 10 cost time: 0.901742696762085
Epoch: 10, Steps: 64 | Train Loss: 0.0987975 Vali Loss: 0.1727254 Test Loss: 0.1502130
Validation loss decreased (0.173002 --> 0.172725).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 11 cost time: 0.9011454582214355
Epoch: 11, Steps: 64 | Train Loss: 0.0978297 Vali Loss: 0.1711499 Test Loss: 0.1492580
Validation loss decreased (0.172725 --> 0.171150).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 12 cost time: 0.9236383438110352
Epoch: 12, Steps: 64 | Train Loss: 0.0964574 Vali Loss: 0.1700718 Test Loss: 0.1499207
Validation loss decreased (0.171150 --> 0.170072).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 13 cost time: 0.9166173934936523
Epoch: 13, Steps: 64 | Train Loss: 0.0964693 Vali Loss: 0.1695237 Test Loss: 0.1491005
Validation loss decreased (0.170072 --> 0.169524).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 14 cost time: 0.8994133472442627
Epoch: 14, Steps: 64 | Train Loss: 0.0956387 Vali Loss: 0.1669657 Test Loss: 0.1478902
Validation loss decreased (0.169524 --> 0.166966).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 15 cost time: 0.9013597965240479
Epoch: 15, Steps: 64 | Train Loss: 0.0940377 Vali Loss: 0.1659575 Test Loss: 0.1482334
Validation loss decreased (0.166966 --> 0.165957).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 16 cost time: 0.9044792652130127
Epoch: 16, Steps: 64 | Train Loss: 0.0941699 Vali Loss: 0.1663937 Test Loss: 0.1476838
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 17 cost time: 0.89835524559021
Epoch: 17, Steps: 64 | Train Loss: 0.0937825 Vali Loss: 0.1681010 Test Loss: 0.1484262
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 18 cost time: 0.9059998989105225
Epoch: 18, Steps: 64 | Train Loss: 0.0929717 Vali Loss: 0.1664061 Test Loss: 0.1480601
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 19 cost time: 0.909653902053833
Epoch: 19, Steps: 64 | Train Loss: 0.0926456 Vali Loss: 0.1654006 Test Loss: 0.1475030
Validation loss decreased (0.165957 --> 0.165401).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 20 cost time: 0.92234206199646
Epoch: 20, Steps: 64 | Train Loss: 0.0926298 Vali Loss: 0.1657701 Test Loss: 0.1479004
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 21 cost time: 0.9152398109436035
Epoch: 21, Steps: 64 | Train Loss: 0.0917948 Vali Loss: 0.1657418 Test Loss: 0.1480287
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 22 cost time: 0.8934664726257324
Epoch: 22, Steps: 64 | Train Loss: 0.0916197 Vali Loss: 0.1634760 Test Loss: 0.1472273
Validation loss decreased (0.165401 --> 0.163476).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 23 cost time: 0.8943996429443359
Epoch: 23, Steps: 64 | Train Loss: 0.0916839 Vali Loss: 0.1643441 Test Loss: 0.1476806
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 24 cost time: 0.8850502967834473
Epoch: 24, Steps: 64 | Train Loss: 0.0916075 Vali Loss: 0.1642175 Test Loss: 0.1480694
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 25 cost time: 0.8859992027282715
Epoch: 25, Steps: 64 | Train Loss: 0.0917654 Vali Loss: 0.1654610 Test Loss: 0.1475666
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 26 cost time: 0.8926296234130859
Epoch: 26, Steps: 64 | Train Loss: 0.0908874 Vali Loss: 0.1620205 Test Loss: 0.1476152
Validation loss decreased (0.163476 --> 0.162020).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 27 cost time: 0.9024872779846191
Epoch: 27, Steps: 64 | Train Loss: 0.0910337 Vali Loss: 0.1637423 Test Loss: 0.1473545
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 28 cost time: 0.8993549346923828
Epoch: 28, Steps: 64 | Train Loss: 0.0907334 Vali Loss: 0.1629330 Test Loss: 0.1473181
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 29 cost time: 0.8943498134613037
Epoch: 29, Steps: 64 | Train Loss: 0.0904207 Vali Loss: 0.1643611 Test Loss: 0.1474427
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 30 cost time: 0.8974094390869141
Epoch: 30, Steps: 64 | Train Loss: 0.0904082 Vali Loss: 0.1620972 Test Loss: 0.1470204
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 31 cost time: 0.8860020637512207
Epoch: 31, Steps: 64 | Train Loss: 0.0900664 Vali Loss: 0.1622995 Test Loss: 0.1477700
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 32 cost time: 0.8786463737487793
Epoch: 32, Steps: 64 | Train Loss: 0.0898111 Vali Loss: 0.1622575 Test Loss: 0.1475051
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 33 cost time: 0.8863866329193115
Epoch: 33, Steps: 64 | Train Loss: 0.0903449 Vali Loss: 0.1628311 Test Loss: 0.1473495
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 34 cost time: 0.9044134616851807
Epoch: 34, Steps: 64 | Train Loss: 0.0897863 Vali Loss: 0.1626066 Test Loss: 0.1474967
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 35 cost time: 0.9134809970855713
Epoch: 35, Steps: 64 | Train Loss: 0.0898499 Vali Loss: 0.1630112 Test Loss: 0.1472616
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 36 cost time: 0.9168751239776611
Epoch: 36, Steps: 64 | Train Loss: 0.0896304 Vali Loss: 0.1626699 Test Loss: 0.1476098
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 37 cost time: 0.9137377738952637
Epoch: 37, Steps: 64 | Train Loss: 0.0896442 Vali Loss: 0.1622364 Test Loss: 0.1474112
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 38 cost time: 0.9109971523284912
Epoch: 38, Steps: 64 | Train Loss: 0.0898540 Vali Loss: 0.1631257 Test Loss: 0.1473263
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 39 cost time: 0.9036355018615723
Epoch: 39, Steps: 64 | Train Loss: 0.0900432 Vali Loss: 0.1629208 Test Loss: 0.1472077
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 40 cost time: 0.9014630317687988
Epoch: 40, Steps: 64 | Train Loss: 0.0892931 Vali Loss: 0.1626970 Test Loss: 0.1476840
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 41 cost time: 0.9064681529998779
Epoch: 41, Steps: 64 | Train Loss: 0.0894077 Vali Loss: 0.1629636 Test Loss: 0.1473015
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 42 cost time: 0.8990530967712402
Epoch: 42, Steps: 64 | Train Loss: 0.0891347 Vali Loss: 0.1639591 Test Loss: 0.1475897
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 43 cost time: 0.8954498767852783
Epoch: 43, Steps: 64 | Train Loss: 0.0898759 Vali Loss: 0.1636015 Test Loss: 0.1472493
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 44 cost time: 0.8979990482330322
Epoch: 44, Steps: 64 | Train Loss: 0.0894322 Vali Loss: 0.1621252 Test Loss: 0.1473141
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 45 cost time: 0.8980073928833008
Epoch: 45, Steps: 64 | Train Loss: 0.0895836 Vali Loss: 0.1627783 Test Loss: 0.1474680
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 46 cost time: 0.899359941482544
Epoch: 46, Steps: 64 | Train Loss: 0.0895271 Vali Loss: 0.1618232 Test Loss: 0.1474818
Validation loss decreased (0.162020 --> 0.161823).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 47 cost time: 0.898566722869873
Epoch: 47, Steps: 64 | Train Loss: 0.0891793 Vali Loss: 0.1632370 Test Loss: 0.1472383
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 48 cost time: 0.8904414176940918
Epoch: 48, Steps: 64 | Train Loss: 0.0895301 Vali Loss: 0.1619816 Test Loss: 0.1478498
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 49 cost time: 0.8891265392303467
Epoch: 49, Steps: 64 | Train Loss: 0.0889469 Vali Loss: 0.1601102 Test Loss: 0.1475252
Validation loss decreased (0.161823 --> 0.160110).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 50 cost time: 0.8847203254699707
Epoch: 50, Steps: 64 | Train Loss: 0.0890122 Vali Loss: 0.1611647 Test Loss: 0.1473449
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 51 cost time: 0.8890011310577393
Epoch: 51, Steps: 64 | Train Loss: 0.0892733 Vali Loss: 0.1615882 Test Loss: 0.1475426
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 52 cost time: 0.894277811050415
Epoch: 52, Steps: 64 | Train Loss: 0.0895805 Vali Loss: 0.1594457 Test Loss: 0.1480310
Validation loss decreased (0.160110 --> 0.159446).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 53 cost time: 0.8994235992431641
Epoch: 53, Steps: 64 | Train Loss: 0.0895271 Vali Loss: 0.1619759 Test Loss: 0.1478296
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 54 cost time: 0.9023716449737549
Epoch: 54, Steps: 64 | Train Loss: 0.0895208 Vali Loss: 0.1604910 Test Loss: 0.1471886
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 55 cost time: 0.9204261302947998
Epoch: 55, Steps: 64 | Train Loss: 0.0896481 Vali Loss: 0.1611866 Test Loss: 0.1476518
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 56 cost time: 0.9104182720184326
Epoch: 56, Steps: 64 | Train Loss: 0.0897974 Vali Loss: 0.1621622 Test Loss: 0.1476655
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 57 cost time: 0.8950004577636719
Epoch: 57, Steps: 64 | Train Loss: 0.0892331 Vali Loss: 0.1617776 Test Loss: 0.1475279
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 58 cost time: 0.8999981880187988
Epoch: 58, Steps: 64 | Train Loss: 0.0892225 Vali Loss: 0.1619253 Test Loss: 0.1477335
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 59 cost time: 0.8995637893676758
Epoch: 59, Steps: 64 | Train Loss: 0.0895733 Vali Loss: 0.1597834 Test Loss: 0.1472954
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019351959228515625 GB
GPU已分配内存的峰值：0.053714752197265625 GB
Epoch: 60 cost time: 0.8953721523284912
Epoch: 60, Steps: 64 | Train Loss: 0.0893822 Vali Loss: 0.1602129 Test Loss: 0.1478693
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14803099632263184, mae:0.2911582291126251, rse:0.2047846019268036
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05678749084472656 GB
Epoch: 1 cost time: 2.3440866470336914
Epoch: 1, Steps: 64 | Train Loss: 0.7461353 Vali Loss: 1.7368199 Test Loss: 3.2988384
Validation loss decreased (inf --> 1.736820).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 2 cost time: 0.9331638813018799
Epoch: 2, Steps: 64 | Train Loss: 0.3849347 Vali Loss: 0.2118696 Test Loss: 0.1913665
Validation loss decreased (1.736820 --> 0.211870).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 3 cost time: 0.925114631652832
Epoch: 3, Steps: 64 | Train Loss: 0.1244806 Vali Loss: 0.2025955 Test Loss: 0.1828732
Validation loss decreased (0.211870 --> 0.202596).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 4 cost time: 0.9345221519470215
Epoch: 4, Steps: 64 | Train Loss: 0.1107565 Vali Loss: 0.1803525 Test Loss: 0.1530981
Validation loss decreased (0.202596 --> 0.180352).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 5 cost time: 0.9094374179840088
Epoch: 5, Steps: 64 | Train Loss: 0.1050442 Vali Loss: 0.1776319 Test Loss: 0.1528046
Validation loss decreased (0.180352 --> 0.177632).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 6 cost time: 0.8989279270172119
Epoch: 6, Steps: 64 | Train Loss: 0.1021472 Vali Loss: 0.1757028 Test Loss: 0.1508864
Validation loss decreased (0.177632 --> 0.175703).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 7 cost time: 0.8950002193450928
Epoch: 7, Steps: 64 | Train Loss: 0.0998081 Vali Loss: 0.1713227 Test Loss: 0.1496044
Validation loss decreased (0.175703 --> 0.171323).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 8 cost time: 0.9019999504089355
Epoch: 8, Steps: 64 | Train Loss: 0.0976217 Vali Loss: 0.1710384 Test Loss: 0.1479512
Validation loss decreased (0.171323 --> 0.171038).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 9 cost time: 0.9296145439147949
Epoch: 9, Steps: 64 | Train Loss: 0.0964071 Vali Loss: 0.1702974 Test Loss: 0.1484455
Validation loss decreased (0.171038 --> 0.170297).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 10 cost time: 0.9241480827331543
Epoch: 10, Steps: 64 | Train Loss: 0.0958202 Vali Loss: 0.1675903 Test Loss: 0.1472213
Validation loss decreased (0.170297 --> 0.167590).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 11 cost time: 0.9284186363220215
Epoch: 11, Steps: 64 | Train Loss: 0.0946730 Vali Loss: 0.1651079 Test Loss: 0.1478526
Validation loss decreased (0.167590 --> 0.165108).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 12 cost time: 0.9494657516479492
Epoch: 12, Steps: 64 | Train Loss: 0.0934512 Vali Loss: 0.1649694 Test Loss: 0.1469487
Validation loss decreased (0.165108 --> 0.164969).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 13 cost time: 0.9244546890258789
Epoch: 13, Steps: 64 | Train Loss: 0.0931606 Vali Loss: 0.1651167 Test Loss: 0.1461349
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 14 cost time: 0.916771411895752
Epoch: 14, Steps: 64 | Train Loss: 0.0923893 Vali Loss: 0.1645165 Test Loss: 0.1461407
Validation loss decreased (0.164969 --> 0.164516).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 15 cost time: 0.9270021915435791
Epoch: 15, Steps: 64 | Train Loss: 0.0912517 Vali Loss: 0.1625376 Test Loss: 0.1456308
Validation loss decreased (0.164516 --> 0.162538).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 16 cost time: 0.9400002956390381
Epoch: 16, Steps: 64 | Train Loss: 0.0908080 Vali Loss: 0.1618827 Test Loss: 0.1452416
Validation loss decreased (0.162538 --> 0.161883).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 17 cost time: 0.9376368522644043
Epoch: 17, Steps: 64 | Train Loss: 0.0909209 Vali Loss: 0.1632883 Test Loss: 0.1470914
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 18 cost time: 0.9373676776885986
Epoch: 18, Steps: 64 | Train Loss: 0.0901138 Vali Loss: 0.1619657 Test Loss: 0.1458715
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 19 cost time: 0.9532461166381836
Epoch: 19, Steps: 64 | Train Loss: 0.0902508 Vali Loss: 0.1625319 Test Loss: 0.1463450
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 20 cost time: 0.9344565868377686
Epoch: 20, Steps: 64 | Train Loss: 0.0894327 Vali Loss: 0.1611982 Test Loss: 0.1461831
Validation loss decreased (0.161883 --> 0.161198).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 21 cost time: 0.940497875213623
Epoch: 21, Steps: 64 | Train Loss: 0.0889221 Vali Loss: 0.1616809 Test Loss: 0.1456726
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 22 cost time: 0.9425702095031738
Epoch: 22, Steps: 64 | Train Loss: 0.0885544 Vali Loss: 0.1604565 Test Loss: 0.1459770
Validation loss decreased (0.161198 --> 0.160456).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 23 cost time: 0.9051656723022461
Epoch: 23, Steps: 64 | Train Loss: 0.0887007 Vali Loss: 0.1596643 Test Loss: 0.1459387
Validation loss decreased (0.160456 --> 0.159664).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 24 cost time: 0.9080009460449219
Epoch: 24, Steps: 64 | Train Loss: 0.0886563 Vali Loss: 0.1598221 Test Loss: 0.1462729
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 25 cost time: 0.9116387367248535
Epoch: 25, Steps: 64 | Train Loss: 0.0886516 Vali Loss: 0.1601060 Test Loss: 0.1460884
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 26 cost time: 0.923367977142334
Epoch: 26, Steps: 64 | Train Loss: 0.0882510 Vali Loss: 0.1580666 Test Loss: 0.1455815
Validation loss decreased (0.159664 --> 0.158067).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 27 cost time: 0.9249882698059082
Epoch: 27, Steps: 64 | Train Loss: 0.0882322 Vali Loss: 0.1588868 Test Loss: 0.1452282
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 28 cost time: 0.9215388298034668
Epoch: 28, Steps: 64 | Train Loss: 0.0878617 Vali Loss: 0.1576774 Test Loss: 0.1455538
Validation loss decreased (0.158067 --> 0.157677).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 29 cost time: 0.918954610824585
Epoch: 29, Steps: 64 | Train Loss: 0.0876555 Vali Loss: 0.1592307 Test Loss: 0.1461228
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 30 cost time: 0.940413236618042
Epoch: 30, Steps: 64 | Train Loss: 0.0877351 Vali Loss: 0.1580925 Test Loss: 0.1457082
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 31 cost time: 0.9313580989837646
Epoch: 31, Steps: 64 | Train Loss: 0.0876529 Vali Loss: 0.1572615 Test Loss: 0.1462200
Validation loss decreased (0.157677 --> 0.157261).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 32 cost time: 0.9330008029937744
Epoch: 32, Steps: 64 | Train Loss: 0.0873397 Vali Loss: 0.1555654 Test Loss: 0.1455538
Validation loss decreased (0.157261 --> 0.155565).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 33 cost time: 0.9286460876464844
Epoch: 33, Steps: 64 | Train Loss: 0.0873580 Vali Loss: 0.1587014 Test Loss: 0.1459430
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 34 cost time: 0.9524667263031006
Epoch: 34, Steps: 64 | Train Loss: 0.0871502 Vali Loss: 0.1583374 Test Loss: 0.1458147
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 35 cost time: 0.9341485500335693
Epoch: 35, Steps: 64 | Train Loss: 0.0875434 Vali Loss: 0.1592553 Test Loss: 0.1461428
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 36 cost time: 0.9514176845550537
Epoch: 36, Steps: 64 | Train Loss: 0.0869299 Vali Loss: 0.1579707 Test Loss: 0.1466725
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 37 cost time: 0.9423737525939941
Epoch: 37, Steps: 64 | Train Loss: 0.0865255 Vali Loss: 0.1578759 Test Loss: 0.1457204
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 38 cost time: 0.9294562339782715
Epoch: 38, Steps: 64 | Train Loss: 0.0873888 Vali Loss: 0.1572461 Test Loss: 0.1459908
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 39 cost time: 0.9418761730194092
Epoch: 39, Steps: 64 | Train Loss: 0.0866932 Vali Loss: 0.1560971 Test Loss: 0.1460504
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 40 cost time: 0.9306125640869141
Epoch: 40, Steps: 64 | Train Loss: 0.0868564 Vali Loss: 0.1574369 Test Loss: 0.1459486
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 41 cost time: 0.9296438694000244
Epoch: 41, Steps: 64 | Train Loss: 0.0870592 Vali Loss: 0.1580109 Test Loss: 0.1463834
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 42 cost time: 0.9306485652923584
Epoch: 42, Steps: 64 | Train Loss: 0.0867117 Vali Loss: 0.1579802 Test Loss: 0.1461669
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 43 cost time: 0.9324133396148682
Epoch: 43, Steps: 64 | Train Loss: 0.0868361 Vali Loss: 0.1579864 Test Loss: 0.1460606
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 44 cost time: 0.9210295677185059
Epoch: 44, Steps: 64 | Train Loss: 0.0866305 Vali Loss: 0.1572442 Test Loss: 0.1461910
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 45 cost time: 0.9273748397827148
Epoch: 45, Steps: 64 | Train Loss: 0.0866439 Vali Loss: 0.1573589 Test Loss: 0.1461039
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 46 cost time: 0.9324343204498291
Epoch: 46, Steps: 64 | Train Loss: 0.0868173 Vali Loss: 0.1578807 Test Loss: 0.1460404
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 47 cost time: 0.9087684154510498
Epoch: 47, Steps: 64 | Train Loss: 0.0869062 Vali Loss: 0.1574521 Test Loss: 0.1457814
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 48 cost time: 0.9113955497741699
Epoch: 48, Steps: 64 | Train Loss: 0.0871437 Vali Loss: 0.1570247 Test Loss: 0.1456999
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 49 cost time: 0.9126482009887695
Epoch: 49, Steps: 64 | Train Loss: 0.0866492 Vali Loss: 0.1576776 Test Loss: 0.1463199
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 50 cost time: 0.9174017906188965
Epoch: 50, Steps: 64 | Train Loss: 0.0865941 Vali Loss: 0.1576384 Test Loss: 0.1466663
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 51 cost time: 0.9354534149169922
Epoch: 51, Steps: 64 | Train Loss: 0.0868616 Vali Loss: 0.1577167 Test Loss: 0.1460758
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 52 cost time: 0.9289705753326416
Epoch: 52, Steps: 64 | Train Loss: 0.0867897 Vali Loss: 0.1602323 Test Loss: 0.1465675
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 53 cost time: 0.9374265670776367
Epoch: 53, Steps: 64 | Train Loss: 0.0865241 Vali Loss: 0.1585295 Test Loss: 0.1459667
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 54 cost time: 0.948415994644165
Epoch: 54, Steps: 64 | Train Loss: 0.0866396 Vali Loss: 0.1589086 Test Loss: 0.1460844
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 55 cost time: 0.9407520294189453
Epoch: 55, Steps: 64 | Train Loss: 0.0867196 Vali Loss: 0.1592727 Test Loss: 0.1464878
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 56 cost time: 0.9367349147796631
Epoch: 56, Steps: 64 | Train Loss: 0.0863440 Vali Loss: 0.1585891 Test Loss: 0.1469687
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 57 cost time: 0.9265592098236084
Epoch: 57, Steps: 64 | Train Loss: 0.0866037 Vali Loss: 0.1562546 Test Loss: 0.1463763
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 58 cost time: 0.9347283840179443
Epoch: 58, Steps: 64 | Train Loss: 0.0872410 Vali Loss: 0.1586080 Test Loss: 0.1463766
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 59 cost time: 0.9474167823791504
Epoch: 59, Steps: 64 | Train Loss: 0.0863792 Vali Loss: 0.1574016 Test Loss: 0.1458261
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020221710205078125 GB
GPU已分配内存的峰值：0.05900287628173828 GB
Epoch: 60 cost time: 0.9478766918182373
Epoch: 60, Steps: 64 | Train Loss: 0.0864514 Vali Loss: 0.1589703 Test Loss: 0.1458342
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1455537974834442, mae:0.2874974310398102, rse:0.20306390523910522
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04966163635253906 GB
Epoch: 1 cost time: 2.284593105316162
Epoch: 1, Steps: 64 | Train Loss: 0.8624554 Vali Loss: 1.9316077 Test Loss: 3.6905711
Validation loss decreased (inf --> 1.931608).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 2 cost time: 0.8912291526794434
Epoch: 2, Steps: 64 | Train Loss: 0.7461223 Vali Loss: 1.4569314 Test Loss: 2.7050817
Validation loss decreased (1.931608 --> 1.456931).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 3 cost time: 0.8954465389251709
Epoch: 3, Steps: 64 | Train Loss: 0.5700901 Vali Loss: 1.1084968 Test Loss: 1.9907396
Validation loss decreased (1.456931 --> 1.108497).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 4 cost time: 0.877805233001709
Epoch: 4, Steps: 64 | Train Loss: 0.4349169 Vali Loss: 0.8374856 Test Loss: 1.4415003
Validation loss decreased (1.108497 --> 0.837486).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 5 cost time: 0.8650002479553223
Epoch: 5, Steps: 64 | Train Loss: 0.3374672 Vali Loss: 0.6689546 Test Loss: 1.0980647
Validation loss decreased (0.837486 --> 0.668955).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 6 cost time: 0.8616223335266113
Epoch: 6, Steps: 64 | Train Loss: 0.2708994 Vali Loss: 0.5501285 Test Loss: 0.8557063
Validation loss decreased (0.668955 --> 0.550129).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 7 cost time: 0.8645977973937988
Epoch: 7, Steps: 64 | Train Loss: 0.2262719 Vali Loss: 0.4671528 Test Loss: 0.6911245
Validation loss decreased (0.550129 --> 0.467153).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 8 cost time: 0.8743910789489746
Epoch: 8, Steps: 64 | Train Loss: 0.1952785 Vali Loss: 0.4027840 Test Loss: 0.5656131
Validation loss decreased (0.467153 --> 0.402784).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 9 cost time: 0.8863844871520996
Epoch: 9, Steps: 64 | Train Loss: 0.1727279 Vali Loss: 0.3575526 Test Loss: 0.4776570
Validation loss decreased (0.402784 --> 0.357553).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 10 cost time: 0.9034023284912109
Epoch: 10, Steps: 64 | Train Loss: 0.1569823 Vali Loss: 0.3162847 Test Loss: 0.4104038
Validation loss decreased (0.357553 --> 0.316285).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 11 cost time: 0.875999927520752
Epoch: 11, Steps: 64 | Train Loss: 0.1451889 Vali Loss: 0.2930095 Test Loss: 0.3618917
Validation loss decreased (0.316285 --> 0.293009).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 12 cost time: 0.894000768661499
Epoch: 12, Steps: 64 | Train Loss: 0.1365070 Vali Loss: 0.2764792 Test Loss: 0.3264228
Validation loss decreased (0.293009 --> 0.276479).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 13 cost time: 0.8890271186828613
Epoch: 13, Steps: 64 | Train Loss: 0.1306751 Vali Loss: 0.2590120 Test Loss: 0.2984334
Validation loss decreased (0.276479 --> 0.259012).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 14 cost time: 0.8944928646087646
Epoch: 14, Steps: 64 | Train Loss: 0.1254011 Vali Loss: 0.2471787 Test Loss: 0.2747422
Validation loss decreased (0.259012 --> 0.247179).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 15 cost time: 0.8750321865081787
Epoch: 15, Steps: 64 | Train Loss: 0.1204297 Vali Loss: 0.2331699 Test Loss: 0.2541950
Validation loss decreased (0.247179 --> 0.233170).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 16 cost time: 0.8761639595031738
Epoch: 16, Steps: 64 | Train Loss: 0.1176475 Vali Loss: 0.2279053 Test Loss: 0.2431127
Validation loss decreased (0.233170 --> 0.227905).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 17 cost time: 0.8750004768371582
Epoch: 17, Steps: 64 | Train Loss: 0.1155990 Vali Loss: 0.2216224 Test Loss: 0.2350103
Validation loss decreased (0.227905 --> 0.221622).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 18 cost time: 0.8819997310638428
Epoch: 18, Steps: 64 | Train Loss: 0.1129147 Vali Loss: 0.2167214 Test Loss: 0.2228146
Validation loss decreased (0.221622 --> 0.216721).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 19 cost time: 0.8941378593444824
Epoch: 19, Steps: 64 | Train Loss: 0.1113279 Vali Loss: 0.2120074 Test Loss: 0.2159367
Validation loss decreased (0.216721 --> 0.212007).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 20 cost time: 0.8884665966033936
Epoch: 20, Steps: 64 | Train Loss: 0.1098796 Vali Loss: 0.2066577 Test Loss: 0.2077554
Validation loss decreased (0.212007 --> 0.206658).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 21 cost time: 0.9024388790130615
Epoch: 21, Steps: 64 | Train Loss: 0.1083765 Vali Loss: 0.2062980 Test Loss: 0.2052998
Validation loss decreased (0.206658 --> 0.206298).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 22 cost time: 0.8905043601989746
Epoch: 22, Steps: 64 | Train Loss: 0.1081272 Vali Loss: 0.2018208 Test Loss: 0.1997676
Validation loss decreased (0.206298 --> 0.201821).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 23 cost time: 0.8495545387268066
Epoch: 23, Steps: 64 | Train Loss: 0.1073163 Vali Loss: 0.1990183 Test Loss: 0.1968973
Validation loss decreased (0.201821 --> 0.199018).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 24 cost time: 0.8483541011810303
Epoch: 24, Steps: 64 | Train Loss: 0.1063461 Vali Loss: 0.1980049 Test Loss: 0.1929534
Validation loss decreased (0.199018 --> 0.198005).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 25 cost time: 0.8481566905975342
Epoch: 25, Steps: 64 | Train Loss: 0.1055391 Vali Loss: 0.1955614 Test Loss: 0.1906275
Validation loss decreased (0.198005 --> 0.195561).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 26 cost time: 0.8463661670684814
Epoch: 26, Steps: 64 | Train Loss: 0.1044196 Vali Loss: 0.1945809 Test Loss: 0.1891367
Validation loss decreased (0.195561 --> 0.194581).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 27 cost time: 0.8674566745758057
Epoch: 27, Steps: 64 | Train Loss: 0.1045128 Vali Loss: 0.1901121 Test Loss: 0.1854311
Validation loss decreased (0.194581 --> 0.190112).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 28 cost time: 0.8777527809143066
Epoch: 28, Steps: 64 | Train Loss: 0.1041049 Vali Loss: 0.1915625 Test Loss: 0.1850835
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 29 cost time: 0.882000207901001
Epoch: 29, Steps: 64 | Train Loss: 0.1036193 Vali Loss: 0.1897416 Test Loss: 0.1817409
Validation loss decreased (0.190112 --> 0.189742).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 30 cost time: 0.8716475963592529
Epoch: 30, Steps: 64 | Train Loss: 0.1033115 Vali Loss: 0.1882358 Test Loss: 0.1811877
Validation loss decreased (0.189742 --> 0.188236).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 31 cost time: 0.8608348369598389
Epoch: 31, Steps: 64 | Train Loss: 0.1033581 Vali Loss: 0.1874657 Test Loss: 0.1792680
Validation loss decreased (0.188236 --> 0.187466).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 32 cost time: 0.8585159778594971
Epoch: 32, Steps: 64 | Train Loss: 0.1023810 Vali Loss: 0.1873154 Test Loss: 0.1782237
Validation loss decreased (0.187466 --> 0.187315).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 33 cost time: 0.8434944152832031
Epoch: 33, Steps: 64 | Train Loss: 0.1028032 Vali Loss: 0.1869586 Test Loss: 0.1787762
Validation loss decreased (0.187315 --> 0.186959).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 34 cost time: 0.8526079654693604
Epoch: 34, Steps: 64 | Train Loss: 0.1023471 Vali Loss: 0.1874072 Test Loss: 0.1778742
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 35 cost time: 0.8750009536743164
Epoch: 35, Steps: 64 | Train Loss: 0.1021013 Vali Loss: 0.1850348 Test Loss: 0.1743038
Validation loss decreased (0.186959 --> 0.185035).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 36 cost time: 0.895625114440918
Epoch: 36, Steps: 64 | Train Loss: 0.1015834 Vali Loss: 0.1849946 Test Loss: 0.1765472
Validation loss decreased (0.185035 --> 0.184995).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 37 cost time: 0.8919672966003418
Epoch: 37, Steps: 64 | Train Loss: 0.1017513 Vali Loss: 0.1848926 Test Loss: 0.1744056
Validation loss decreased (0.184995 --> 0.184893).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 38 cost time: 0.886389970779419
Epoch: 38, Steps: 64 | Train Loss: 0.1016100 Vali Loss: 0.1849887 Test Loss: 0.1738586
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 39 cost time: 0.9004242420196533
Epoch: 39, Steps: 64 | Train Loss: 0.1013280 Vali Loss: 0.1841270 Test Loss: 0.1738128
Validation loss decreased (0.184893 --> 0.184127).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 40 cost time: 0.8898041248321533
Epoch: 40, Steps: 64 | Train Loss: 0.1010815 Vali Loss: 0.1833682 Test Loss: 0.1744775
Validation loss decreased (0.184127 --> 0.183368).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 41 cost time: 0.8850002288818359
Epoch: 41, Steps: 64 | Train Loss: 0.1014621 Vali Loss: 0.1831337 Test Loss: 0.1722946
Validation loss decreased (0.183368 --> 0.183134).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 42 cost time: 0.8814754486083984
Epoch: 42, Steps: 64 | Train Loss: 0.1017161 Vali Loss: 0.1833824 Test Loss: 0.1720372
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 43 cost time: 0.8750030994415283
Epoch: 43, Steps: 64 | Train Loss: 0.1011199 Vali Loss: 0.1829122 Test Loss: 0.1721767
Validation loss decreased (0.183134 --> 0.182912).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 44 cost time: 0.8703789710998535
Epoch: 44, Steps: 64 | Train Loss: 0.1012922 Vali Loss: 0.1803540 Test Loss: 0.1717365
Validation loss decreased (0.182912 --> 0.180354).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 45 cost time: 0.8873708248138428
Epoch: 45, Steps: 64 | Train Loss: 0.1013949 Vali Loss: 0.1824153 Test Loss: 0.1719377
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 46 cost time: 0.8758044242858887
Epoch: 46, Steps: 64 | Train Loss: 0.1009240 Vali Loss: 0.1812645 Test Loss: 0.1710661
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 47 cost time: 0.871650218963623
Epoch: 47, Steps: 64 | Train Loss: 0.1006676 Vali Loss: 0.1808216 Test Loss: 0.1717629
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 48 cost time: 0.8756415843963623
Epoch: 48, Steps: 64 | Train Loss: 0.1011744 Vali Loss: 0.1815172 Test Loss: 0.1708347
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 49 cost time: 0.8464329242706299
Epoch: 49, Steps: 64 | Train Loss: 0.1007436 Vali Loss: 0.1815166 Test Loss: 0.1720137
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 50 cost time: 0.8554518222808838
Epoch: 50, Steps: 64 | Train Loss: 0.1007223 Vali Loss: 0.1845362 Test Loss: 0.1717181
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 51 cost time: 0.8867998123168945
Epoch: 51, Steps: 64 | Train Loss: 0.1005780 Vali Loss: 0.1817892 Test Loss: 0.1706668
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 52 cost time: 0.8839998245239258
Epoch: 52, Steps: 64 | Train Loss: 0.1005796 Vali Loss: 0.1832053 Test Loss: 0.1704887
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 53 cost time: 0.8796474933624268
Epoch: 53, Steps: 64 | Train Loss: 0.1005320 Vali Loss: 0.1828899 Test Loss: 0.1705071
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 54 cost time: 0.8774099349975586
Epoch: 54, Steps: 64 | Train Loss: 0.1007696 Vali Loss: 0.1803664 Test Loss: 0.1702866
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 55 cost time: 0.8883919715881348
Epoch: 55, Steps: 64 | Train Loss: 0.1012339 Vali Loss: 0.1809554 Test Loss: 0.1699774
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 56 cost time: 0.8990631103515625
Epoch: 56, Steps: 64 | Train Loss: 0.1006216 Vali Loss: 0.1824389 Test Loss: 0.1716021
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 57 cost time: 0.9057672023773193
Epoch: 57, Steps: 64 | Train Loss: 0.1009449 Vali Loss: 0.1811728 Test Loss: 0.1686463
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 58 cost time: 0.8809995651245117
Epoch: 58, Steps: 64 | Train Loss: 0.1006837 Vali Loss: 0.1825285 Test Loss: 0.1700927
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 59 cost time: 0.8829984664916992
Epoch: 59, Steps: 64 | Train Loss: 0.1003737 Vali Loss: 0.1792969 Test Loss: 0.1686847
Validation loss decreased (0.180354 --> 0.179297).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01763916015625 GB
GPU已分配内存的峰值：0.04988384246826172 GB
Epoch: 60 cost time: 0.8810834884643555
Epoch: 60, Steps: 64 | Train Loss: 0.1003137 Vali Loss: 0.1813850 Test Loss: 0.1702907
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1686846911907196, mae:0.31867891550064087, rse:0.21860435605049133
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 1 cost time: 2.3004510402679443
Epoch: 1, Steps: 64 | Train Loss: 0.7883050 Vali Loss: 1.8130916 Test Loss: 3.4691932
Validation loss decreased (inf --> 1.813092).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 2 cost time: 0.8946375846862793
Epoch: 2, Steps: 64 | Train Loss: 0.4944281 Vali Loss: 0.4641525 Test Loss: 0.6622718
Validation loss decreased (1.813092 --> 0.464153).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 3 cost time: 0.9019999504089355
Epoch: 3, Steps: 64 | Train Loss: 0.1436771 Vali Loss: 0.1896130 Test Loss: 0.1470120
Validation loss decreased (0.464153 --> 0.189613).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 4 cost time: 0.9078915119171143
Epoch: 4, Steps: 64 | Train Loss: 0.1099541 Vali Loss: 0.1831718 Test Loss: 0.1597115
Validation loss decreased (0.189613 --> 0.183172).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 5 cost time: 0.8867802619934082
Epoch: 5, Steps: 64 | Train Loss: 0.1041786 Vali Loss: 0.1803056 Test Loss: 0.1557170
Validation loss decreased (0.183172 --> 0.180306).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 6 cost time: 0.8877439498901367
Epoch: 6, Steps: 64 | Train Loss: 0.1009559 Vali Loss: 0.1780485 Test Loss: 0.1543910
Validation loss decreased (0.180306 --> 0.178049).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 7 cost time: 0.8969998359680176
Epoch: 7, Steps: 64 | Train Loss: 0.0988753 Vali Loss: 0.1747264 Test Loss: 0.1547669
Validation loss decreased (0.178049 --> 0.174726).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 8 cost time: 0.8929975032806396
Epoch: 8, Steps: 64 | Train Loss: 0.0974369 Vali Loss: 0.1697383 Test Loss: 0.1532084
Validation loss decreased (0.174726 --> 0.169738).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 9 cost time: 0.8938736915588379
Epoch: 9, Steps: 64 | Train Loss: 0.0962426 Vali Loss: 0.1723056 Test Loss: 0.1557056
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 10 cost time: 0.9057867527008057
Epoch: 10, Steps: 64 | Train Loss: 0.0948985 Vali Loss: 0.1712577 Test Loss: 0.1531398
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 11 cost time: 0.9163901805877686
Epoch: 11, Steps: 64 | Train Loss: 0.0944019 Vali Loss: 0.1713896 Test Loss: 0.1542146
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 12 cost time: 0.9234006404876709
Epoch: 12, Steps: 64 | Train Loss: 0.0928524 Vali Loss: 0.1690284 Test Loss: 0.1530023
Validation loss decreased (0.169738 --> 0.169028).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 13 cost time: 0.919762134552002
Epoch: 13, Steps: 64 | Train Loss: 0.0928849 Vali Loss: 0.1699620 Test Loss: 0.1536161
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 14 cost time: 0.9040079116821289
Epoch: 14, Steps: 64 | Train Loss: 0.0923504 Vali Loss: 0.1697889 Test Loss: 0.1533980
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 15 cost time: 0.8826286792755127
Epoch: 15, Steps: 64 | Train Loss: 0.0916203 Vali Loss: 0.1678442 Test Loss: 0.1535199
Validation loss decreased (0.169028 --> 0.167844).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 16 cost time: 0.8910000324249268
Epoch: 16, Steps: 64 | Train Loss: 0.0907782 Vali Loss: 0.1657169 Test Loss: 0.1529116
Validation loss decreased (0.167844 --> 0.165717).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 17 cost time: 0.8996293544769287
Epoch: 17, Steps: 64 | Train Loss: 0.0906394 Vali Loss: 0.1673583 Test Loss: 0.1533019
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 18 cost time: 0.9240055084228516
Epoch: 18, Steps: 64 | Train Loss: 0.0901704 Vali Loss: 0.1669643 Test Loss: 0.1531062
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 19 cost time: 0.9234132766723633
Epoch: 19, Steps: 64 | Train Loss: 0.0902818 Vali Loss: 0.1644920 Test Loss: 0.1525455
Validation loss decreased (0.165717 --> 0.164492).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 20 cost time: 0.9227497577667236
Epoch: 20, Steps: 64 | Train Loss: 0.0897251 Vali Loss: 0.1645194 Test Loss: 0.1529022
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 21 cost time: 0.9269983768463135
Epoch: 21, Steps: 64 | Train Loss: 0.0896311 Vali Loss: 0.1652129 Test Loss: 0.1527954
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 22 cost time: 0.9010059833526611
Epoch: 22, Steps: 64 | Train Loss: 0.0891949 Vali Loss: 0.1645353 Test Loss: 0.1523407
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 23 cost time: 0.8834366798400879
Epoch: 23, Steps: 64 | Train Loss: 0.0890459 Vali Loss: 0.1645263 Test Loss: 0.1522452
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 24 cost time: 0.8846960067749023
Epoch: 24, Steps: 64 | Train Loss: 0.0887912 Vali Loss: 0.1647611 Test Loss: 0.1534389
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 25 cost time: 0.8843989372253418
Epoch: 25, Steps: 64 | Train Loss: 0.0890474 Vali Loss: 0.1646754 Test Loss: 0.1535919
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 26 cost time: 0.9193706512451172
Epoch: 26, Steps: 64 | Train Loss: 0.0887364 Vali Loss: 0.1635701 Test Loss: 0.1532347
Validation loss decreased (0.164492 --> 0.163570).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 27 cost time: 0.9157779216766357
Epoch: 27, Steps: 64 | Train Loss: 0.0885984 Vali Loss: 0.1637032 Test Loss: 0.1523046
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 28 cost time: 0.934999942779541
Epoch: 28, Steps: 64 | Train Loss: 0.0880849 Vali Loss: 0.1629114 Test Loss: 0.1532975
Validation loss decreased (0.163570 --> 0.162911).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 29 cost time: 0.9016969203948975
Epoch: 29, Steps: 64 | Train Loss: 0.0887476 Vali Loss: 0.1646955 Test Loss: 0.1529706
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 30 cost time: 0.8984010219573975
Epoch: 30, Steps: 64 | Train Loss: 0.0883155 Vali Loss: 0.1631052 Test Loss: 0.1528309
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 31 cost time: 0.8810513019561768
Epoch: 31, Steps: 64 | Train Loss: 0.0882350 Vali Loss: 0.1644088 Test Loss: 0.1529293
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 32 cost time: 0.8883812427520752
Epoch: 32, Steps: 64 | Train Loss: 0.0875074 Vali Loss: 0.1634155 Test Loss: 0.1528426
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 33 cost time: 0.8917393684387207
Epoch: 33, Steps: 64 | Train Loss: 0.0879331 Vali Loss: 0.1644323 Test Loss: 0.1535402
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 34 cost time: 0.8960013389587402
Epoch: 34, Steps: 64 | Train Loss: 0.0881167 Vali Loss: 0.1630407 Test Loss: 0.1522198
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 35 cost time: 0.9160363674163818
Epoch: 35, Steps: 64 | Train Loss: 0.0881492 Vali Loss: 0.1634346 Test Loss: 0.1529131
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 36 cost time: 0.918647289276123
Epoch: 36, Steps: 64 | Train Loss: 0.0877085 Vali Loss: 0.1621418 Test Loss: 0.1527571
Validation loss decreased (0.162911 --> 0.162142).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 37 cost time: 0.9144225120544434
Epoch: 37, Steps: 64 | Train Loss: 0.0876635 Vali Loss: 0.1620507 Test Loss: 0.1524368
Validation loss decreased (0.162142 --> 0.162051).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 38 cost time: 0.9234566688537598
Epoch: 38, Steps: 64 | Train Loss: 0.0880141 Vali Loss: 0.1625348 Test Loss: 0.1522795
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 39 cost time: 0.915381669998169
Epoch: 39, Steps: 64 | Train Loss: 0.0873860 Vali Loss: 0.1620438 Test Loss: 0.1524232
Validation loss decreased (0.162051 --> 0.162044).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 40 cost time: 0.900759220123291
Epoch: 40, Steps: 64 | Train Loss: 0.0879235 Vali Loss: 0.1632812 Test Loss: 0.1531319
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 41 cost time: 0.9017188549041748
Epoch: 41, Steps: 64 | Train Loss: 0.0874738 Vali Loss: 0.1614119 Test Loss: 0.1517930
Validation loss decreased (0.162044 --> 0.161412).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 42 cost time: 0.9120006561279297
Epoch: 42, Steps: 64 | Train Loss: 0.0872331 Vali Loss: 0.1630798 Test Loss: 0.1519884
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 43 cost time: 0.9044041633605957
Epoch: 43, Steps: 64 | Train Loss: 0.0874951 Vali Loss: 0.1623871 Test Loss: 0.1529046
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 44 cost time: 0.9045186042785645
Epoch: 44, Steps: 64 | Train Loss: 0.0876258 Vali Loss: 0.1638414 Test Loss: 0.1531850
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 45 cost time: 0.8974053859710693
Epoch: 45, Steps: 64 | Train Loss: 0.0873730 Vali Loss: 0.1630959 Test Loss: 0.1527485
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 46 cost time: 0.9054491519927979
Epoch: 46, Steps: 64 | Train Loss: 0.0874901 Vali Loss: 0.1637205 Test Loss: 0.1523260
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 47 cost time: 0.9017534255981445
Epoch: 47, Steps: 64 | Train Loss: 0.0874499 Vali Loss: 0.1629492 Test Loss: 0.1521494
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 48 cost time: 0.8853638172149658
Epoch: 48, Steps: 64 | Train Loss: 0.0872603 Vali Loss: 0.1631614 Test Loss: 0.1528050
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 49 cost time: 0.8836352825164795
Epoch: 49, Steps: 64 | Train Loss: 0.0874407 Vali Loss: 0.1630929 Test Loss: 0.1520073
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 50 cost time: 0.8863883018493652
Epoch: 50, Steps: 64 | Train Loss: 0.0877358 Vali Loss: 0.1644236 Test Loss: 0.1529006
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 51 cost time: 0.8843941688537598
Epoch: 51, Steps: 64 | Train Loss: 0.0877181 Vali Loss: 0.1636832 Test Loss: 0.1534055
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 52 cost time: 0.897470235824585
Epoch: 52, Steps: 64 | Train Loss: 0.0877634 Vali Loss: 0.1649281 Test Loss: 0.1533000
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 53 cost time: 0.9077417850494385
Epoch: 53, Steps: 64 | Train Loss: 0.0875170 Vali Loss: 0.1631820 Test Loss: 0.1530291
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 54 cost time: 0.9009997844696045
Epoch: 54, Steps: 64 | Train Loss: 0.0875462 Vali Loss: 0.1641895 Test Loss: 0.1527286
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 55 cost time: 0.9310007095336914
Epoch: 55, Steps: 64 | Train Loss: 0.0878977 Vali Loss: 0.1635655 Test Loss: 0.1521277
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 56 cost time: 0.9124608039855957
Epoch: 56, Steps: 64 | Train Loss: 0.0874752 Vali Loss: 0.1634564 Test Loss: 0.1535141
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 57 cost time: 0.8914268016815186
Epoch: 57, Steps: 64 | Train Loss: 0.0875744 Vali Loss: 0.1636031 Test Loss: 0.1530829
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 58 cost time: 0.9004583358764648
Epoch: 58, Steps: 64 | Train Loss: 0.0876418 Vali Loss: 0.1629638 Test Loss: 0.1525529
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 59 cost time: 0.9014513492584229
Epoch: 59, Steps: 64 | Train Loss: 0.0875191 Vali Loss: 0.1623474 Test Loss: 0.1521417
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01935577392578125 GB
GPU已分配内存的峰值：0.05387592315673828 GB
Epoch: 60 cost time: 0.9058430194854736
Epoch: 60, Steps: 64 | Train Loss: 0.0878338 Vali Loss: 0.1630373 Test Loss: 0.1530850
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.151792973279953, mae:0.2986835539340973, rse:0.20737041532993317
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05694866180419922 GB
Epoch: 1 cost time: 2.3680951595306396
Epoch: 1, Steps: 64 | Train Loss: 0.7639314 Vali Loss: 1.7759390 Test Loss: 3.3949690
Validation loss decreased (inf --> 1.775939).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 2 cost time: 0.9661271572113037
Epoch: 2, Steps: 64 | Train Loss: 0.4000034 Vali Loss: 0.2063275 Test Loss: 0.1630590
Validation loss decreased (1.775939 --> 0.206327).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 3 cost time: 0.9639410972595215
Epoch: 3, Steps: 64 | Train Loss: 0.1213534 Vali Loss: 0.2005209 Test Loss: 0.1799956
Validation loss decreased (0.206327 --> 0.200521).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 4 cost time: 0.9428796768188477
Epoch: 4, Steps: 64 | Train Loss: 0.1076344 Vali Loss: 0.1759758 Test Loss: 0.1504246
Validation loss decreased (0.200521 --> 0.175976).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 5 cost time: 0.9633572101593018
Epoch: 5, Steps: 64 | Train Loss: 0.1023563 Vali Loss: 0.1753347 Test Loss: 0.1507783
Validation loss decreased (0.175976 --> 0.175335).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 6 cost time: 0.9550004005432129
Epoch: 6, Steps: 64 | Train Loss: 0.0994360 Vali Loss: 0.1739679 Test Loss: 0.1503646
Validation loss decreased (0.175335 --> 0.173968).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 7 cost time: 0.9276342391967773
Epoch: 7, Steps: 64 | Train Loss: 0.0969413 Vali Loss: 0.1724167 Test Loss: 0.1514460
Validation loss decreased (0.173968 --> 0.172417).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 8 cost time: 0.9250504970550537
Epoch: 8, Steps: 64 | Train Loss: 0.0951979 Vali Loss: 0.1697530 Test Loss: 0.1499473
Validation loss decreased (0.172417 --> 0.169753).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 9 cost time: 0.9451158046722412
Epoch: 9, Steps: 64 | Train Loss: 0.0942878 Vali Loss: 0.1701150 Test Loss: 0.1518516
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 10 cost time: 0.9564540386199951
Epoch: 10, Steps: 64 | Train Loss: 0.0930101 Vali Loss: 0.1666832 Test Loss: 0.1504014
Validation loss decreased (0.169753 --> 0.166683).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 11 cost time: 0.9543743133544922
Epoch: 11, Steps: 64 | Train Loss: 0.0927233 Vali Loss: 0.1675793 Test Loss: 0.1518014
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 12 cost time: 0.9634521007537842
Epoch: 12, Steps: 64 | Train Loss: 0.0911971 Vali Loss: 0.1652982 Test Loss: 0.1496078
Validation loss decreased (0.166683 --> 0.165298).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 13 cost time: 0.9468040466308594
Epoch: 13, Steps: 64 | Train Loss: 0.0908377 Vali Loss: 0.1640977 Test Loss: 0.1511259
Validation loss decreased (0.165298 --> 0.164098).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 14 cost time: 0.9537246227264404
Epoch: 14, Steps: 64 | Train Loss: 0.0904630 Vali Loss: 0.1613419 Test Loss: 0.1506093
Validation loss decreased (0.164098 --> 0.161342).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 15 cost time: 0.9399981498718262
Epoch: 15, Steps: 64 | Train Loss: 0.0901206 Vali Loss: 0.1610121 Test Loss: 0.1502891
Validation loss decreased (0.161342 --> 0.161012).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 16 cost time: 0.9446330070495605
Epoch: 16, Steps: 64 | Train Loss: 0.0891891 Vali Loss: 0.1619351 Test Loss: 0.1499159
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 17 cost time: 0.9553453922271729
Epoch: 17, Steps: 64 | Train Loss: 0.0892298 Vali Loss: 0.1619578 Test Loss: 0.1495690
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 18 cost time: 0.9632518291473389
Epoch: 18, Steps: 64 | Train Loss: 0.0887583 Vali Loss: 0.1629189 Test Loss: 0.1516908
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 19 cost time: 0.9624588489532471
Epoch: 19, Steps: 64 | Train Loss: 0.0881454 Vali Loss: 0.1639145 Test Loss: 0.1510017
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 20 cost time: 0.9623606204986572
Epoch: 20, Steps: 64 | Train Loss: 0.0881488 Vali Loss: 0.1612730 Test Loss: 0.1504111
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 21 cost time: 0.937476634979248
Epoch: 21, Steps: 64 | Train Loss: 0.0883458 Vali Loss: 0.1612920 Test Loss: 0.1504686
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 22 cost time: 0.9243919849395752
Epoch: 22, Steps: 64 | Train Loss: 0.0877263 Vali Loss: 0.1638155 Test Loss: 0.1506010
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 23 cost time: 0.9327399730682373
Epoch: 23, Steps: 64 | Train Loss: 0.0876947 Vali Loss: 0.1609457 Test Loss: 0.1508488
Validation loss decreased (0.161012 --> 0.160946).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 24 cost time: 0.9239990711212158
Epoch: 24, Steps: 64 | Train Loss: 0.0876305 Vali Loss: 0.1618785 Test Loss: 0.1505662
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 25 cost time: 0.9316351413726807
Epoch: 25, Steps: 64 | Train Loss: 0.0871323 Vali Loss: 0.1620271 Test Loss: 0.1504559
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 26 cost time: 0.9179549217224121
Epoch: 26, Steps: 64 | Train Loss: 0.0872654 Vali Loss: 0.1616812 Test Loss: 0.1503653
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 27 cost time: 0.942387580871582
Epoch: 27, Steps: 64 | Train Loss: 0.0872096 Vali Loss: 0.1615428 Test Loss: 0.1506441
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 28 cost time: 0.9593954086303711
Epoch: 28, Steps: 64 | Train Loss: 0.0871880 Vali Loss: 0.1609012 Test Loss: 0.1515982
Validation loss decreased (0.160946 --> 0.160901).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 29 cost time: 0.9583554267883301
Epoch: 29, Steps: 64 | Train Loss: 0.0871606 Vali Loss: 0.1619748 Test Loss: 0.1506679
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 30 cost time: 0.9369781017303467
Epoch: 30, Steps: 64 | Train Loss: 0.0866543 Vali Loss: 0.1610107 Test Loss: 0.1505579
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 31 cost time: 0.9387500286102295
Epoch: 31, Steps: 64 | Train Loss: 0.0867265 Vali Loss: 0.1615087 Test Loss: 0.1501320
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 32 cost time: 0.9399998188018799
Epoch: 32, Steps: 64 | Train Loss: 0.0866901 Vali Loss: 0.1600141 Test Loss: 0.1503818
Validation loss decreased (0.160901 --> 0.160014).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 33 cost time: 0.9509999752044678
Epoch: 33, Steps: 64 | Train Loss: 0.0864071 Vali Loss: 0.1611458 Test Loss: 0.1514685
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 34 cost time: 0.9670119285583496
Epoch: 34, Steps: 64 | Train Loss: 0.0864205 Vali Loss: 0.1592242 Test Loss: 0.1504886
Validation loss decreased (0.160014 --> 0.159224).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 35 cost time: 0.9769134521484375
Epoch: 35, Steps: 64 | Train Loss: 0.0864105 Vali Loss: 0.1594018 Test Loss: 0.1509035
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 36 cost time: 0.9675004482269287
Epoch: 36, Steps: 64 | Train Loss: 0.0861761 Vali Loss: 0.1611307 Test Loss: 0.1506477
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 37 cost time: 0.9624607563018799
Epoch: 37, Steps: 64 | Train Loss: 0.0859871 Vali Loss: 0.1608413 Test Loss: 0.1510526
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 38 cost time: 0.9470813274383545
Epoch: 38, Steps: 64 | Train Loss: 0.0865510 Vali Loss: 0.1603669 Test Loss: 0.1500709
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 39 cost time: 0.9423704147338867
Epoch: 39, Steps: 64 | Train Loss: 0.0862751 Vali Loss: 0.1589736 Test Loss: 0.1502540
Validation loss decreased (0.159224 --> 0.158974).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 40 cost time: 0.9524767398834229
Epoch: 40, Steps: 64 | Train Loss: 0.0866131 Vali Loss: 0.1590567 Test Loss: 0.1508922
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 41 cost time: 0.9309370517730713
Epoch: 41, Steps: 64 | Train Loss: 0.0860377 Vali Loss: 0.1608039 Test Loss: 0.1504928
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 42 cost time: 0.9438862800598145
Epoch: 42, Steps: 64 | Train Loss: 0.0864408 Vali Loss: 0.1591558 Test Loss: 0.1505139
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 43 cost time: 0.9539990425109863
Epoch: 43, Steps: 64 | Train Loss: 0.0858943 Vali Loss: 0.1596289 Test Loss: 0.1501942
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 44 cost time: 0.9486277103424072
Epoch: 44, Steps: 64 | Train Loss: 0.0859384 Vali Loss: 0.1602162 Test Loss: 0.1512222
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 45 cost time: 0.9423418045043945
Epoch: 45, Steps: 64 | Train Loss: 0.0857968 Vali Loss: 0.1591695 Test Loss: 0.1509124
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 46 cost time: 0.9351370334625244
Epoch: 46, Steps: 64 | Train Loss: 0.0862324 Vali Loss: 0.1585487 Test Loss: 0.1501713
Validation loss decreased (0.158974 --> 0.158549).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 47 cost time: 0.9333827495574951
Epoch: 47, Steps: 64 | Train Loss: 0.0859195 Vali Loss: 0.1589014 Test Loss: 0.1505802
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 48 cost time: 0.9323592185974121
Epoch: 48, Steps: 64 | Train Loss: 0.0860117 Vali Loss: 0.1592646 Test Loss: 0.1515255
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 49 cost time: 0.9327993392944336
Epoch: 49, Steps: 64 | Train Loss: 0.0858598 Vali Loss: 0.1608717 Test Loss: 0.1504104
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 50 cost time: 0.9437928199768066
Epoch: 50, Steps: 64 | Train Loss: 0.0857778 Vali Loss: 0.1605355 Test Loss: 0.1506743
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 51 cost time: 0.9535691738128662
Epoch: 51, Steps: 64 | Train Loss: 0.0857102 Vali Loss: 0.1604628 Test Loss: 0.1502980
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 52 cost time: 0.9569990634918213
Epoch: 52, Steps: 64 | Train Loss: 0.0860704 Vali Loss: 0.1609109 Test Loss: 0.1513409
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 53 cost time: 0.9686446189880371
Epoch: 53, Steps: 64 | Train Loss: 0.0860189 Vali Loss: 0.1587323 Test Loss: 0.1500823
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 54 cost time: 0.9487907886505127
Epoch: 54, Steps: 64 | Train Loss: 0.0860444 Vali Loss: 0.1596775 Test Loss: 0.1508615
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 55 cost time: 0.9422662258148193
Epoch: 55, Steps: 64 | Train Loss: 0.0859586 Vali Loss: 0.1603541 Test Loss: 0.1509158
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 56 cost time: 0.9424235820770264
Epoch: 56, Steps: 64 | Train Loss: 0.0861411 Vali Loss: 0.1602827 Test Loss: 0.1506756
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 57 cost time: 0.9505116939544678
Epoch: 57, Steps: 64 | Train Loss: 0.0859185 Vali Loss: 0.1595215 Test Loss: 0.1507883
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 58 cost time: 0.9523584842681885
Epoch: 58, Steps: 64 | Train Loss: 0.0861355 Vali Loss: 0.1586558 Test Loss: 0.1507846
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 59 cost time: 0.9701230525970459
Epoch: 59, Steps: 64 | Train Loss: 0.0861480 Vali Loss: 0.1599092 Test Loss: 0.1502454
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02022552490234375 GB
GPU已分配内存的峰值：0.05916595458984375 GB
Epoch: 60 cost time: 0.9708518981933594
Epoch: 60, Steps: 64 | Train Loss: 0.0863860 Vali Loss: 0.1606475 Test Loss: 0.1506858
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15017123520374298, mae:0.2961481511592865, rse:0.20625968277454376
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.04982280731201172 GB
Epoch: 1 cost time: 2.257216691970825
Epoch: 1, Steps: 64 | Train Loss: 0.8664655 Vali Loss: 1.9619542 Test Loss: 3.6990170
Validation loss decreased (inf --> 1.961954).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 2 cost time: 0.8770005702972412
Epoch: 2, Steps: 64 | Train Loss: 0.7190259 Vali Loss: 1.3718889 Test Loss: 2.4818690
Validation loss decreased (1.961954 --> 1.371889).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 3 cost time: 0.8879990577697754
Epoch: 3, Steps: 64 | Train Loss: 0.5366193 Vali Loss: 1.0407330 Test Loss: 1.8051550
Validation loss decreased (1.371889 --> 1.040733).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 4 cost time: 0.8756606578826904
Epoch: 4, Steps: 64 | Train Loss: 0.4125147 Vali Loss: 0.8152573 Test Loss: 1.3586079
Validation loss decreased (1.040733 --> 0.815257).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 5 cost time: 0.8560855388641357
Epoch: 5, Steps: 64 | Train Loss: 0.3221909 Vali Loss: 0.6507125 Test Loss: 1.0347276
Validation loss decreased (0.815257 --> 0.650712).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 6 cost time: 0.8484139442443848
Epoch: 6, Steps: 64 | Train Loss: 0.2615696 Vali Loss: 0.5259563 Test Loss: 0.8016051
Validation loss decreased (0.650712 --> 0.525956).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 7 cost time: 0.8744235038757324
Epoch: 7, Steps: 64 | Train Loss: 0.2180459 Vali Loss: 0.4456668 Test Loss: 0.6457067
Validation loss decreased (0.525956 --> 0.445667).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 8 cost time: 0.8613903522491455
Epoch: 8, Steps: 64 | Train Loss: 0.1880269 Vali Loss: 0.3801316 Test Loss: 0.5297527
Validation loss decreased (0.445667 --> 0.380132).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 9 cost time: 0.8576352596282959
Epoch: 9, Steps: 64 | Train Loss: 0.1681963 Vali Loss: 0.3358922 Test Loss: 0.4424272
Validation loss decreased (0.380132 --> 0.335892).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 10 cost time: 0.8863670825958252
Epoch: 10, Steps: 64 | Train Loss: 0.1529032 Vali Loss: 0.3037911 Test Loss: 0.3805245
Validation loss decreased (0.335892 --> 0.303791).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 11 cost time: 0.8833324909210205
Epoch: 11, Steps: 64 | Train Loss: 0.1416452 Vali Loss: 0.2786745 Test Loss: 0.3343582
Validation loss decreased (0.303791 --> 0.278675).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 12 cost time: 0.8824288845062256
Epoch: 12, Steps: 64 | Train Loss: 0.1327327 Vali Loss: 0.2605603 Test Loss: 0.2997416
Validation loss decreased (0.278675 --> 0.260560).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 13 cost time: 0.8903748989105225
Epoch: 13, Steps: 64 | Train Loss: 0.1256901 Vali Loss: 0.2453635 Test Loss: 0.2707109
Validation loss decreased (0.260560 --> 0.245363).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 14 cost time: 0.8728857040405273
Epoch: 14, Steps: 64 | Train Loss: 0.1215132 Vali Loss: 0.2313759 Test Loss: 0.2521329
Validation loss decreased (0.245363 --> 0.231376).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 15 cost time: 0.8721234798431396
Epoch: 15, Steps: 64 | Train Loss: 0.1182225 Vali Loss: 0.2204895 Test Loss: 0.2335382
Validation loss decreased (0.231376 --> 0.220489).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 16 cost time: 0.8686153888702393
Epoch: 16, Steps: 64 | Train Loss: 0.1149630 Vali Loss: 0.2145224 Test Loss: 0.2219876
Validation loss decreased (0.220489 --> 0.214522).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 17 cost time: 0.8724353313446045
Epoch: 17, Steps: 64 | Train Loss: 0.1125729 Vali Loss: 0.2106507 Test Loss: 0.2117863
Validation loss decreased (0.214522 --> 0.210651).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 18 cost time: 0.8833835124969482
Epoch: 18, Steps: 64 | Train Loss: 0.1101575 Vali Loss: 0.2048703 Test Loss: 0.2042865
Validation loss decreased (0.210651 --> 0.204870).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 19 cost time: 0.8883864879608154
Epoch: 19, Steps: 64 | Train Loss: 0.1085805 Vali Loss: 0.2000383 Test Loss: 0.1999585
Validation loss decreased (0.204870 --> 0.200038).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 20 cost time: 0.8909354209899902
Epoch: 20, Steps: 64 | Train Loss: 0.1072923 Vali Loss: 0.1974573 Test Loss: 0.1933506
Validation loss decreased (0.200038 --> 0.197457).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 21 cost time: 0.8994126319885254
Epoch: 21, Steps: 64 | Train Loss: 0.1061108 Vali Loss: 0.1953003 Test Loss: 0.1892827
Validation loss decreased (0.197457 --> 0.195300).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 22 cost time: 0.8896408081054688
Epoch: 22, Steps: 64 | Train Loss: 0.1051320 Vali Loss: 0.1932852 Test Loss: 0.1844533
Validation loss decreased (0.195300 --> 0.193285).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 23 cost time: 0.8843607902526855
Epoch: 23, Steps: 64 | Train Loss: 0.1044486 Vali Loss: 0.1890973 Test Loss: 0.1821772
Validation loss decreased (0.193285 --> 0.189097).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 24 cost time: 0.8818204402923584
Epoch: 24, Steps: 64 | Train Loss: 0.1034227 Vali Loss: 0.1863982 Test Loss: 0.1790065
Validation loss decreased (0.189097 --> 0.186398).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 25 cost time: 0.8684468269348145
Epoch: 25, Steps: 64 | Train Loss: 0.1031626 Vali Loss: 0.1866089 Test Loss: 0.1776914
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 26 cost time: 0.8554563522338867
Epoch: 26, Steps: 64 | Train Loss: 0.1023842 Vali Loss: 0.1861011 Test Loss: 0.1753789
Validation loss decreased (0.186398 --> 0.186101).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 27 cost time: 0.8769974708557129
Epoch: 27, Steps: 64 | Train Loss: 0.1019731 Vali Loss: 0.1849605 Test Loss: 0.1733368
Validation loss decreased (0.186101 --> 0.184961).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 28 cost time: 0.8786313533782959
Epoch: 28, Steps: 64 | Train Loss: 0.1019117 Vali Loss: 0.1819875 Test Loss: 0.1725401
Validation loss decreased (0.184961 --> 0.181987).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 29 cost time: 0.8754565715789795
Epoch: 29, Steps: 64 | Train Loss: 0.1018772 Vali Loss: 0.1811543 Test Loss: 0.1714769
Validation loss decreased (0.181987 --> 0.181154).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 30 cost time: 0.8673436641693115
Epoch: 30, Steps: 64 | Train Loss: 0.1010008 Vali Loss: 0.1830437 Test Loss: 0.1704074
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 31 cost time: 0.881413459777832
Epoch: 31, Steps: 64 | Train Loss: 0.1011678 Vali Loss: 0.1827848 Test Loss: 0.1683097
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 32 cost time: 0.8727543354034424
Epoch: 32, Steps: 64 | Train Loss: 0.1002794 Vali Loss: 0.1811666 Test Loss: 0.1685689
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 33 cost time: 0.8499979972839355
Epoch: 33, Steps: 64 | Train Loss: 0.1001082 Vali Loss: 0.1808683 Test Loss: 0.1683482
Validation loss decreased (0.181154 --> 0.180868).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 34 cost time: 0.8521773815155029
Epoch: 34, Steps: 64 | Train Loss: 0.1001895 Vali Loss: 0.1809631 Test Loss: 0.1667425
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 35 cost time: 0.862398624420166
Epoch: 35, Steps: 64 | Train Loss: 0.1002549 Vali Loss: 0.1801421 Test Loss: 0.1669253
Validation loss decreased (0.180868 --> 0.180142).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 36 cost time: 0.8914592266082764
Epoch: 36, Steps: 64 | Train Loss: 0.0997500 Vali Loss: 0.1787181 Test Loss: 0.1656058
Validation loss decreased (0.180142 --> 0.178718).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 37 cost time: 0.8878490924835205
Epoch: 37, Steps: 64 | Train Loss: 0.0999675 Vali Loss: 0.1800750 Test Loss: 0.1655475
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 38 cost time: 0.8920001983642578
Epoch: 38, Steps: 64 | Train Loss: 0.0995672 Vali Loss: 0.1782153 Test Loss: 0.1652191
Validation loss decreased (0.178718 --> 0.178215).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 39 cost time: 0.9036757946014404
Epoch: 39, Steps: 64 | Train Loss: 0.0990384 Vali Loss: 0.1785320 Test Loss: 0.1648426
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 40 cost time: 0.875629186630249
Epoch: 40, Steps: 64 | Train Loss: 0.0994437 Vali Loss: 0.1770819 Test Loss: 0.1640823
Validation loss decreased (0.178215 --> 0.177082).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 41 cost time: 0.8714728355407715
Epoch: 41, Steps: 64 | Train Loss: 0.0993335 Vali Loss: 0.1767306 Test Loss: 0.1638273
Validation loss decreased (0.177082 --> 0.176731).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 42 cost time: 0.8741776943206787
Epoch: 42, Steps: 64 | Train Loss: 0.0990906 Vali Loss: 0.1775466 Test Loss: 0.1626844
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 43 cost time: 0.8757421970367432
Epoch: 43, Steps: 64 | Train Loss: 0.0989870 Vali Loss: 0.1745359 Test Loss: 0.1628422
Validation loss decreased (0.176731 --> 0.174536).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 44 cost time: 0.8700001239776611
Epoch: 44, Steps: 64 | Train Loss: 0.0988733 Vali Loss: 0.1779045 Test Loss: 0.1642950
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 45 cost time: 0.8876316547393799
Epoch: 45, Steps: 64 | Train Loss: 0.0995187 Vali Loss: 0.1746683 Test Loss: 0.1619727
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 46 cost time: 0.8974058628082275
Epoch: 46, Steps: 64 | Train Loss: 0.0986014 Vali Loss: 0.1785482 Test Loss: 0.1621023
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 47 cost time: 0.8684346675872803
Epoch: 47, Steps: 64 | Train Loss: 0.0987146 Vali Loss: 0.1755415 Test Loss: 0.1634665
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 48 cost time: 0.8668231964111328
Epoch: 48, Steps: 64 | Train Loss: 0.0994227 Vali Loss: 0.1739568 Test Loss: 0.1612217
Validation loss decreased (0.174536 --> 0.173957).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 49 cost time: 0.8497359752655029
Epoch: 49, Steps: 64 | Train Loss: 0.0982840 Vali Loss: 0.1740000 Test Loss: 0.1604124
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 50 cost time: 0.8609976768493652
Epoch: 50, Steps: 64 | Train Loss: 0.0990838 Vali Loss: 0.1768498 Test Loss: 0.1620338
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 51 cost time: 0.8426485061645508
Epoch: 51, Steps: 64 | Train Loss: 0.0986606 Vali Loss: 0.1739684 Test Loss: 0.1619098
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 52 cost time: 0.8458302021026611
Epoch: 52, Steps: 64 | Train Loss: 0.0987458 Vali Loss: 0.1756113 Test Loss: 0.1623175
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 53 cost time: 0.8543756008148193
Epoch: 53, Steps: 64 | Train Loss: 0.0981921 Vali Loss: 0.1755161 Test Loss: 0.1611226
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 54 cost time: 0.8558254241943359
Epoch: 54, Steps: 64 | Train Loss: 0.0989031 Vali Loss: 0.1740118 Test Loss: 0.1606361
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 55 cost time: 0.8692560195922852
Epoch: 55, Steps: 64 | Train Loss: 0.0985191 Vali Loss: 0.1754346 Test Loss: 0.1617593
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 56 cost time: 0.8676168918609619
Epoch: 56, Steps: 64 | Train Loss: 0.0984078 Vali Loss: 0.1747325 Test Loss: 0.1614159
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 57 cost time: 0.8894200325012207
Epoch: 57, Steps: 64 | Train Loss: 0.0992175 Vali Loss: 0.1760858 Test Loss: 0.1597755
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 58 cost time: 0.8694684505462646
Epoch: 58, Steps: 64 | Train Loss: 0.0980904 Vali Loss: 0.1748070 Test Loss: 0.1600160
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 59 cost time: 0.8674049377441406
Epoch: 59, Steps: 64 | Train Loss: 0.0992645 Vali Loss: 0.1750879 Test Loss: 0.1597549
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017642974853515625 GB
GPU已分配内存的峰值：0.05004692077636719 GB
Epoch: 60 cost time: 0.8684470653533936
Epoch: 60, Steps: 64 | Train Loss: 0.0985019 Vali Loss: 0.1760443 Test Loss: 0.1616342
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.16122165322303772, mae:0.3107929229736328, rse:0.2137138545513153
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 1 cost time: 2.311659336090088
Epoch: 1, Steps: 64 | Train Loss: 0.8074207 Vali Loss: 1.8488597 Test Loss: 3.5600810
Validation loss decreased (inf --> 1.848860).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 2 cost time: 0.9084262847900391
Epoch: 2, Steps: 64 | Train Loss: 0.5009011 Vali Loss: 0.4269556 Test Loss: 0.5675521
Validation loss decreased (1.848860 --> 0.426956).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 3 cost time: 0.909637451171875
Epoch: 3, Steps: 64 | Train Loss: 0.1394210 Vali Loss: 0.1881684 Test Loss: 0.1438830
Validation loss decreased (0.426956 --> 0.188168).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 4 cost time: 0.9121663570404053
Epoch: 4, Steps: 64 | Train Loss: 0.1092075 Vali Loss: 0.1819007 Test Loss: 0.1489838
Validation loss decreased (0.188168 --> 0.181901).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 5 cost time: 0.877640962600708
Epoch: 5, Steps: 64 | Train Loss: 0.1032701 Vali Loss: 0.1753214 Test Loss: 0.1452251
Validation loss decreased (0.181901 --> 0.175321).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 6 cost time: 0.8831319808959961
Epoch: 6, Steps: 64 | Train Loss: 0.1003777 Vali Loss: 0.1723840 Test Loss: 0.1442921
Validation loss decreased (0.175321 --> 0.172384).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 7 cost time: 0.8823971748352051
Epoch: 7, Steps: 64 | Train Loss: 0.0985684 Vali Loss: 0.1693750 Test Loss: 0.1417006
Validation loss decreased (0.172384 --> 0.169375).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 8 cost time: 0.8814132213592529
Epoch: 8, Steps: 64 | Train Loss: 0.0969326 Vali Loss: 0.1700458 Test Loss: 0.1436533
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 9 cost time: 0.9009537696838379
Epoch: 9, Steps: 64 | Train Loss: 0.0957766 Vali Loss: 0.1661809 Test Loss: 0.1429481
Validation loss decreased (0.169375 --> 0.166181).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 10 cost time: 0.9120001792907715
Epoch: 10, Steps: 64 | Train Loss: 0.0948329 Vali Loss: 0.1647877 Test Loss: 0.1406576
Validation loss decreased (0.166181 --> 0.164788).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 11 cost time: 0.9183802604675293
Epoch: 11, Steps: 64 | Train Loss: 0.0938218 Vali Loss: 0.1655356 Test Loss: 0.1412327
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 12 cost time: 0.9336469173431396
Epoch: 12, Steps: 64 | Train Loss: 0.0929351 Vali Loss: 0.1647840 Test Loss: 0.1417203
Validation loss decreased (0.164788 --> 0.164784).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 13 cost time: 0.9235858917236328
Epoch: 13, Steps: 64 | Train Loss: 0.0925788 Vali Loss: 0.1612984 Test Loss: 0.1407634
Validation loss decreased (0.164784 --> 0.161298).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 14 cost time: 0.9344580173492432
Epoch: 14, Steps: 64 | Train Loss: 0.0921477 Vali Loss: 0.1622084 Test Loss: 0.1411506
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 15 cost time: 0.9074180126190186
Epoch: 15, Steps: 64 | Train Loss: 0.0916544 Vali Loss: 0.1615118 Test Loss: 0.1406493
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 16 cost time: 0.9163684844970703
Epoch: 16, Steps: 64 | Train Loss: 0.0909612 Vali Loss: 0.1609133 Test Loss: 0.1412992
Validation loss decreased (0.161298 --> 0.160913).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 17 cost time: 0.9158093929290771
Epoch: 17, Steps: 64 | Train Loss: 0.0906135 Vali Loss: 0.1598665 Test Loss: 0.1412629
Validation loss decreased (0.160913 --> 0.159867).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 18 cost time: 0.9420011043548584
Epoch: 18, Steps: 64 | Train Loss: 0.0907075 Vali Loss: 0.1614983 Test Loss: 0.1412782
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 19 cost time: 0.9330615997314453
Epoch: 19, Steps: 64 | Train Loss: 0.0903759 Vali Loss: 0.1604464 Test Loss: 0.1418675
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 20 cost time: 0.9256284236907959
Epoch: 20, Steps: 64 | Train Loss: 0.0898232 Vali Loss: 0.1614785 Test Loss: 0.1413560
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 21 cost time: 0.9424858093261719
Epoch: 21, Steps: 64 | Train Loss: 0.0895334 Vali Loss: 0.1619985 Test Loss: 0.1426603
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 22 cost time: 0.9114823341369629
Epoch: 22, Steps: 64 | Train Loss: 0.0892154 Vali Loss: 0.1606958 Test Loss: 0.1418077
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 23 cost time: 0.8804049491882324
Epoch: 23, Steps: 64 | Train Loss: 0.0895118 Vali Loss: 0.1595747 Test Loss: 0.1425765
Validation loss decreased (0.159867 --> 0.159575).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 24 cost time: 0.8867805004119873
Epoch: 24, Steps: 64 | Train Loss: 0.0892901 Vali Loss: 0.1616649 Test Loss: 0.1426744
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 25 cost time: 0.8889999389648438
Epoch: 25, Steps: 64 | Train Loss: 0.0892984 Vali Loss: 0.1606740 Test Loss: 0.1427000
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 26 cost time: 0.9106297492980957
Epoch: 26, Steps: 64 | Train Loss: 0.0886564 Vali Loss: 0.1596663 Test Loss: 0.1421872
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 27 cost time: 0.9026367664337158
Epoch: 27, Steps: 64 | Train Loss: 0.0886289 Vali Loss: 0.1595300 Test Loss: 0.1424808
Validation loss decreased (0.159575 --> 0.159530).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 28 cost time: 0.9144537448883057
Epoch: 28, Steps: 64 | Train Loss: 0.0882581 Vali Loss: 0.1609300 Test Loss: 0.1425959
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 29 cost time: 0.909428596496582
Epoch: 29, Steps: 64 | Train Loss: 0.0883620 Vali Loss: 0.1592806 Test Loss: 0.1424681
Validation loss decreased (0.159530 --> 0.159281).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 30 cost time: 0.8794052600860596
Epoch: 30, Steps: 64 | Train Loss: 0.0887890 Vali Loss: 0.1570180 Test Loss: 0.1422213
Validation loss decreased (0.159281 --> 0.157018).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 31 cost time: 0.8787765502929688
Epoch: 31, Steps: 64 | Train Loss: 0.0880387 Vali Loss: 0.1599819 Test Loss: 0.1427444
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 32 cost time: 0.9040019512176514
Epoch: 32, Steps: 64 | Train Loss: 0.0886430 Vali Loss: 0.1607243 Test Loss: 0.1428623
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 33 cost time: 0.92862868309021
Epoch: 33, Steps: 64 | Train Loss: 0.0885212 Vali Loss: 0.1589916 Test Loss: 0.1425856
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 34 cost time: 0.920623779296875
Epoch: 34, Steps: 64 | Train Loss: 0.0880924 Vali Loss: 0.1604563 Test Loss: 0.1426417
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 35 cost time: 0.9395904541015625
Epoch: 35, Steps: 64 | Train Loss: 0.0879427 Vali Loss: 0.1586896 Test Loss: 0.1429757
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 36 cost time: 0.9295496940612793
Epoch: 36, Steps: 64 | Train Loss: 0.0881855 Vali Loss: 0.1588045 Test Loss: 0.1433922
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 37 cost time: 0.9290666580200195
Epoch: 37, Steps: 64 | Train Loss: 0.0879858 Vali Loss: 0.1598091 Test Loss: 0.1424482
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 38 cost time: 0.9213440418243408
Epoch: 38, Steps: 64 | Train Loss: 0.0877985 Vali Loss: 0.1587125 Test Loss: 0.1427427
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 39 cost time: 0.920757532119751
Epoch: 39, Steps: 64 | Train Loss: 0.0879836 Vali Loss: 0.1582370 Test Loss: 0.1427392
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 40 cost time: 0.9161243438720703
Epoch: 40, Steps: 64 | Train Loss: 0.0878860 Vali Loss: 0.1594586 Test Loss: 0.1432378
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 41 cost time: 0.9100737571716309
Epoch: 41, Steps: 64 | Train Loss: 0.0880282 Vali Loss: 0.1595592 Test Loss: 0.1432067
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 42 cost time: 0.9163565635681152
Epoch: 42, Steps: 64 | Train Loss: 0.0876776 Vali Loss: 0.1594391 Test Loss: 0.1431809
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 43 cost time: 0.932396650314331
Epoch: 43, Steps: 64 | Train Loss: 0.0876766 Vali Loss: 0.1596863 Test Loss: 0.1430266
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 44 cost time: 0.9143719673156738
Epoch: 44, Steps: 64 | Train Loss: 0.0879094 Vali Loss: 0.1581068 Test Loss: 0.1433901
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 45 cost time: 0.9048078060150146
Epoch: 45, Steps: 64 | Train Loss: 0.0877563 Vali Loss: 0.1596567 Test Loss: 0.1428274
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 46 cost time: 0.9027233123779297
Epoch: 46, Steps: 64 | Train Loss: 0.0878724 Vali Loss: 0.1585563 Test Loss: 0.1428553
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 47 cost time: 0.8840000629425049
Epoch: 47, Steps: 64 | Train Loss: 0.0875782 Vali Loss: 0.1595062 Test Loss: 0.1436143
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 48 cost time: 0.8870000839233398
Epoch: 48, Steps: 64 | Train Loss: 0.0874651 Vali Loss: 0.1578075 Test Loss: 0.1434135
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 49 cost time: 0.8906412124633789
Epoch: 49, Steps: 64 | Train Loss: 0.0878554 Vali Loss: 0.1584707 Test Loss: 0.1427867
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 50 cost time: 0.875246524810791
Epoch: 50, Steps: 64 | Train Loss: 0.0878563 Vali Loss: 0.1597998 Test Loss: 0.1435023
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 51 cost time: 0.8983702659606934
Epoch: 51, Steps: 64 | Train Loss: 0.0877652 Vali Loss: 0.1612699 Test Loss: 0.1437222
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 52 cost time: 0.9103603363037109
Epoch: 52, Steps: 64 | Train Loss: 0.0876375 Vali Loss: 0.1580180 Test Loss: 0.1436844
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 53 cost time: 0.9148268699645996
Epoch: 53, Steps: 64 | Train Loss: 0.0876353 Vali Loss: 0.1596388 Test Loss: 0.1435274
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 54 cost time: 0.8994128704071045
Epoch: 54, Steps: 64 | Train Loss: 0.0876848 Vali Loss: 0.1605118 Test Loss: 0.1434212
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 55 cost time: 0.8986446857452393
Epoch: 55, Steps: 64 | Train Loss: 0.0877973 Vali Loss: 0.1593406 Test Loss: 0.1436280
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 56 cost time: 0.9164490699768066
Epoch: 56, Steps: 64 | Train Loss: 0.0876800 Vali Loss: 0.1602185 Test Loss: 0.1435526
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 57 cost time: 0.9113681316375732
Epoch: 57, Steps: 64 | Train Loss: 0.0877984 Vali Loss: 0.1589408 Test Loss: 0.1430974
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 58 cost time: 0.9060232639312744
Epoch: 58, Steps: 64 | Train Loss: 0.0877121 Vali Loss: 0.1586582 Test Loss: 0.1432719
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 59 cost time: 0.913388729095459
Epoch: 59, Steps: 64 | Train Loss: 0.0876106 Vali Loss: 0.1592920 Test Loss: 0.1430229
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019359588623046875 GB
GPU已分配内存的峰值：0.05403709411621094 GB
Epoch: 60 cost time: 0.9397611618041992
Epoch: 60, Steps: 64 | Train Loss: 0.0875279 Vali Loss: 0.1597171 Test Loss: 0.1429252
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14222131669521332, mae:0.28175121545791626, rse:0.20072585344314575
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.057109832763671875 GB
Epoch: 1 cost time: 2.3410725593566895
Epoch: 1, Steps: 64 | Train Loss: 0.7847708 Vali Loss: 1.8435086 Test Loss: 3.4837029
Validation loss decreased (inf --> 1.843509).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 2 cost time: 0.9580590724945068
Epoch: 2, Steps: 64 | Train Loss: 0.4286870 Vali Loss: 0.2575479 Test Loss: 0.1828756
Validation loss decreased (1.843509 --> 0.257548).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 3 cost time: 0.9411232471466064
Epoch: 3, Steps: 64 | Train Loss: 0.1238486 Vali Loss: 0.1987386 Test Loss: 0.1694624
Validation loss decreased (0.257548 --> 0.198739).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 4 cost time: 0.9247477054595947
Epoch: 4, Steps: 64 | Train Loss: 0.1076161 Vali Loss: 0.1780221 Test Loss: 0.1455942
Validation loss decreased (0.198739 --> 0.178022).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 5 cost time: 0.9119992256164551
Epoch: 5, Steps: 64 | Train Loss: 0.1027097 Vali Loss: 0.1746842 Test Loss: 0.1430341
Validation loss decreased (0.178022 --> 0.174684).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 6 cost time: 0.9306237697601318
Epoch: 6, Steps: 64 | Train Loss: 0.0993268 Vali Loss: 0.1698545 Test Loss: 0.1411986
Validation loss decreased (0.174684 --> 0.169855).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 7 cost time: 0.9530661106109619
Epoch: 7, Steps: 64 | Train Loss: 0.0969064 Vali Loss: 0.1691104 Test Loss: 0.1409623
Validation loss decreased (0.169855 --> 0.169110).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 8 cost time: 0.9494583606719971
Epoch: 8, Steps: 64 | Train Loss: 0.0954513 Vali Loss: 0.1655953 Test Loss: 0.1409212
Validation loss decreased (0.169110 --> 0.165595).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 9 cost time: 0.9665143489837646
Epoch: 9, Steps: 64 | Train Loss: 0.0945944 Vali Loss: 0.1631575 Test Loss: 0.1397854
Validation loss decreased (0.165595 --> 0.163157).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 10 cost time: 0.9553735256195068
Epoch: 10, Steps: 64 | Train Loss: 0.0930967 Vali Loss: 0.1637008 Test Loss: 0.1408961
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 11 cost time: 0.9434242248535156
Epoch: 11, Steps: 64 | Train Loss: 0.0921696 Vali Loss: 0.1624123 Test Loss: 0.1399957
Validation loss decreased (0.163157 --> 0.162412).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 12 cost time: 0.9562571048736572
Epoch: 12, Steps: 64 | Train Loss: 0.0916934 Vali Loss: 0.1629535 Test Loss: 0.1411665
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 13 cost time: 0.9399633407592773
Epoch: 13, Steps: 64 | Train Loss: 0.0912279 Vali Loss: 0.1631889 Test Loss: 0.1409121
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 14 cost time: 0.9407463073730469
Epoch: 14, Steps: 64 | Train Loss: 0.0910787 Vali Loss: 0.1623856 Test Loss: 0.1408928
Validation loss decreased (0.162412 --> 0.162386).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 15 cost time: 0.9443676471710205
Epoch: 15, Steps: 64 | Train Loss: 0.0900301 Vali Loss: 0.1614428 Test Loss: 0.1416369
Validation loss decreased (0.162386 --> 0.161443).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 16 cost time: 0.9466335773468018
Epoch: 16, Steps: 64 | Train Loss: 0.0897125 Vali Loss: 0.1620863 Test Loss: 0.1410380
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 17 cost time: 0.9527082443237305
Epoch: 17, Steps: 64 | Train Loss: 0.0897319 Vali Loss: 0.1609245 Test Loss: 0.1411783
Validation loss decreased (0.161443 --> 0.160925).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 18 cost time: 0.9554505348205566
Epoch: 18, Steps: 64 | Train Loss: 0.0891057 Vali Loss: 0.1607792 Test Loss: 0.1415048
Validation loss decreased (0.160925 --> 0.160779).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 19 cost time: 0.9712038040161133
Epoch: 19, Steps: 64 | Train Loss: 0.0889862 Vali Loss: 0.1614204 Test Loss: 0.1416018
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 20 cost time: 0.9633975028991699
Epoch: 20, Steps: 64 | Train Loss: 0.0887813 Vali Loss: 0.1612307 Test Loss: 0.1420016
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 21 cost time: 0.9408230781555176
Epoch: 21, Steps: 64 | Train Loss: 0.0887502 Vali Loss: 0.1611375 Test Loss: 0.1428259
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 22 cost time: 0.9115734100341797
Epoch: 22, Steps: 64 | Train Loss: 0.0882574 Vali Loss: 0.1593181 Test Loss: 0.1421835
Validation loss decreased (0.160779 --> 0.159318).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 23 cost time: 0.946765661239624
Epoch: 23, Steps: 64 | Train Loss: 0.0881092 Vali Loss: 0.1613267 Test Loss: 0.1427460
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 24 cost time: 0.9479997158050537
Epoch: 24, Steps: 64 | Train Loss: 0.0877133 Vali Loss: 0.1608274 Test Loss: 0.1427440
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 25 cost time: 0.9519643783569336
Epoch: 25, Steps: 64 | Train Loss: 0.0877035 Vali Loss: 0.1607224 Test Loss: 0.1426358
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 26 cost time: 0.9506595134735107
Epoch: 26, Steps: 64 | Train Loss: 0.0872710 Vali Loss: 0.1601365 Test Loss: 0.1434122
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 27 cost time: 0.9261391162872314
Epoch: 27, Steps: 64 | Train Loss: 0.0874097 Vali Loss: 0.1607918 Test Loss: 0.1425053
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 28 cost time: 0.9334042072296143
Epoch: 28, Steps: 64 | Train Loss: 0.0874676 Vali Loss: 0.1600678 Test Loss: 0.1429561
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 29 cost time: 0.9133422374725342
Epoch: 29, Steps: 64 | Train Loss: 0.0874742 Vali Loss: 0.1586230 Test Loss: 0.1430361
Validation loss decreased (0.159318 --> 0.158623).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 30 cost time: 0.9045710563659668
Epoch: 30, Steps: 64 | Train Loss: 0.0870769 Vali Loss: 0.1592851 Test Loss: 0.1426050
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 31 cost time: 0.9087529182434082
Epoch: 31, Steps: 64 | Train Loss: 0.0872618 Vali Loss: 0.1600837 Test Loss: 0.1430175
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 32 cost time: 0.9154424667358398
Epoch: 32, Steps: 64 | Train Loss: 0.0870159 Vali Loss: 0.1602511 Test Loss: 0.1433007
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 33 cost time: 0.9499995708465576
Epoch: 33, Steps: 64 | Train Loss: 0.0867820 Vali Loss: 0.1599421 Test Loss: 0.1430406
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 34 cost time: 0.9556081295013428
Epoch: 34, Steps: 64 | Train Loss: 0.0866979 Vali Loss: 0.1582146 Test Loss: 0.1429633
Validation loss decreased (0.158623 --> 0.158215).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 35 cost time: 0.9546194076538086
Epoch: 35, Steps: 64 | Train Loss: 0.0864644 Vali Loss: 0.1595880 Test Loss: 0.1432288
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 36 cost time: 0.9676330089569092
Epoch: 36, Steps: 64 | Train Loss: 0.0863883 Vali Loss: 0.1593112 Test Loss: 0.1431521
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 37 cost time: 0.9474782943725586
Epoch: 37, Steps: 64 | Train Loss: 0.0868502 Vali Loss: 0.1595861 Test Loss: 0.1435231
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 38 cost time: 0.9343664646148682
Epoch: 38, Steps: 64 | Train Loss: 0.0867354 Vali Loss: 0.1585025 Test Loss: 0.1432790
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 39 cost time: 0.9413824081420898
Epoch: 39, Steps: 64 | Train Loss: 0.0867882 Vali Loss: 0.1596508 Test Loss: 0.1433669
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 40 cost time: 0.9398539066314697
Epoch: 40, Steps: 64 | Train Loss: 0.0866670 Vali Loss: 0.1592790 Test Loss: 0.1436961
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 41 cost time: 0.9497475624084473
Epoch: 41, Steps: 64 | Train Loss: 0.0868944 Vali Loss: 0.1599486 Test Loss: 0.1428357
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 42 cost time: 0.9570002555847168
Epoch: 42, Steps: 64 | Train Loss: 0.0867727 Vali Loss: 0.1597081 Test Loss: 0.1430331
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 43 cost time: 0.9370009899139404
Epoch: 43, Steps: 64 | Train Loss: 0.0866533 Vali Loss: 0.1587117 Test Loss: 0.1429001
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 44 cost time: 0.9350597858428955
Epoch: 44, Steps: 64 | Train Loss: 0.0866310 Vali Loss: 0.1610570 Test Loss: 0.1437134
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 45 cost time: 0.9264109134674072
Epoch: 45, Steps: 64 | Train Loss: 0.0867238 Vali Loss: 0.1598760 Test Loss: 0.1429352
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 46 cost time: 0.9184091091156006
Epoch: 46, Steps: 64 | Train Loss: 0.0863003 Vali Loss: 0.1610664 Test Loss: 0.1439585
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 47 cost time: 0.9363899230957031
Epoch: 47, Steps: 64 | Train Loss: 0.0869688 Vali Loss: 0.1599820 Test Loss: 0.1434457
EarlyStopping counter: 13 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 48 cost time: 0.9454491138458252
Epoch: 48, Steps: 64 | Train Loss: 0.0864145 Vali Loss: 0.1583780 Test Loss: 0.1431474
EarlyStopping counter: 14 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 49 cost time: 0.9595961570739746
Epoch: 49, Steps: 64 | Train Loss: 0.0864440 Vali Loss: 0.1601953 Test Loss: 0.1433776
EarlyStopping counter: 15 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 50 cost time: 0.9467577934265137
Epoch: 50, Steps: 64 | Train Loss: 0.0866610 Vali Loss: 0.1599865 Test Loss: 0.1432440
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 51 cost time: 0.9587986469268799
Epoch: 51, Steps: 64 | Train Loss: 0.0866588 Vali Loss: 0.1587759 Test Loss: 0.1436602
EarlyStopping counter: 17 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 52 cost time: 0.9573941230773926
Epoch: 52, Steps: 64 | Train Loss: 0.0865765 Vali Loss: 0.1591428 Test Loss: 0.1432514
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 53 cost time: 0.9486360549926758
Epoch: 53, Steps: 64 | Train Loss: 0.0864270 Vali Loss: 0.1593900 Test Loss: 0.1434448
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 54 cost time: 0.9376399517059326
Epoch: 54, Steps: 64 | Train Loss: 0.0865860 Vali Loss: 0.1606537 Test Loss: 0.1437497
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 55 cost time: 0.945359468460083
Epoch: 55, Steps: 64 | Train Loss: 0.0866237 Vali Loss: 0.1593945 Test Loss: 0.1434800
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 56 cost time: 0.9397621154785156
Epoch: 56, Steps: 64 | Train Loss: 0.0863810 Vali Loss: 0.1590515 Test Loss: 0.1439639
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 57 cost time: 0.9463648796081543
Epoch: 57, Steps: 64 | Train Loss: 0.0865860 Vali Loss: 0.1579451 Test Loss: 0.1440145
Validation loss decreased (0.158215 --> 0.157945).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 58 cost time: 0.9533889293670654
Epoch: 58, Steps: 64 | Train Loss: 0.0868298 Vali Loss: 0.1597300 Test Loss: 0.1434774
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 59 cost time: 0.9613986015319824
Epoch: 59, Steps: 64 | Train Loss: 0.0863659 Vali Loss: 0.1602208 Test Loss: 0.1431853
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020229339599609375 GB
GPU已分配内存的峰值：0.05932903289794922 GB
Epoch: 60 cost time: 0.9497232437133789
Epoch: 60, Steps: 64 | Train Loss: 0.0863762 Vali Loss: 0.1597586 Test Loss: 0.1439905
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14401455223560333, mae:0.28641536831855774, rse:0.2019873559474945
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.04998350143432617 GB
Epoch: 1 cost time: 2.2624404430389404
Epoch: 1, Steps: 64 | Train Loss: 0.9299546 Vali Loss: 2.0950823 Test Loss: 4.0075307
Validation loss decreased (inf --> 2.095082).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 2 cost time: 0.8843176364898682
Epoch: 2, Steps: 64 | Train Loss: 0.7336390 Vali Loss: 1.2563286 Test Loss: 2.2528932
Validation loss decreased (2.095082 --> 1.256329).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 3 cost time: 0.9000012874603271
Epoch: 3, Steps: 64 | Train Loss: 0.4823985 Vali Loss: 0.9141973 Test Loss: 1.5420289
Validation loss decreased (1.256329 --> 0.914197).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 4 cost time: 0.8990006446838379
Epoch: 4, Steps: 64 | Train Loss: 0.3609413 Vali Loss: 0.7122033 Test Loss: 1.1353304
Validation loss decreased (0.914197 --> 0.712203).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 5 cost time: 0.899010181427002
Epoch: 5, Steps: 64 | Train Loss: 0.2835592 Vali Loss: 0.5742909 Test Loss: 0.8687379
Validation loss decreased (0.712203 --> 0.574291).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 6 cost time: 0.8893852233886719
Epoch: 6, Steps: 64 | Train Loss: 0.2315058 Vali Loss: 0.4727476 Test Loss: 0.6747067
Validation loss decreased (0.574291 --> 0.472748).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 7 cost time: 0.8483905792236328
Epoch: 7, Steps: 64 | Train Loss: 0.1955530 Vali Loss: 0.4021851 Test Loss: 0.5436408
Validation loss decreased (0.472748 --> 0.402185).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 8 cost time: 0.8515348434448242
Epoch: 8, Steps: 64 | Train Loss: 0.1700896 Vali Loss: 0.3494692 Test Loss: 0.4457636
Validation loss decreased (0.402185 --> 0.349469).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 9 cost time: 0.8677809238433838
Epoch: 9, Steps: 64 | Train Loss: 0.1531553 Vali Loss: 0.3077970 Test Loss: 0.3776266
Validation loss decreased (0.349469 --> 0.307797).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 10 cost time: 0.8890016078948975
Epoch: 10, Steps: 64 | Train Loss: 0.1410994 Vali Loss: 0.2846656 Test Loss: 0.3276456
Validation loss decreased (0.307797 --> 0.284666).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 11 cost time: 0.9056291580200195
Epoch: 11, Steps: 64 | Train Loss: 0.1318934 Vali Loss: 0.2603949 Test Loss: 0.2894078
Validation loss decreased (0.284666 --> 0.260395).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 12 cost time: 0.9014337062835693
Epoch: 12, Steps: 64 | Train Loss: 0.1249423 Vali Loss: 0.2459482 Test Loss: 0.2673225
Validation loss decreased (0.260395 --> 0.245948).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 13 cost time: 0.9144039154052734
Epoch: 13, Steps: 64 | Train Loss: 0.1198590 Vali Loss: 0.2314856 Test Loss: 0.2410818
Validation loss decreased (0.245948 --> 0.231486).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 14 cost time: 0.8778190612792969
Epoch: 14, Steps: 64 | Train Loss: 0.1157220 Vali Loss: 0.2224595 Test Loss: 0.2275500
Validation loss decreased (0.231486 --> 0.222460).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 15 cost time: 0.8837909698486328
Epoch: 15, Steps: 64 | Train Loss: 0.1126559 Vali Loss: 0.2151446 Test Loss: 0.2154234
Validation loss decreased (0.222460 --> 0.215145).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 16 cost time: 0.8869993686676025
Epoch: 16, Steps: 64 | Train Loss: 0.1104476 Vali Loss: 0.2070880 Test Loss: 0.2051113
Validation loss decreased (0.215145 --> 0.207088).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 17 cost time: 0.8856363296508789
Epoch: 17, Steps: 64 | Train Loss: 0.1084938 Vali Loss: 0.2034400 Test Loss: 0.1993578
Validation loss decreased (0.207088 --> 0.203440).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 18 cost time: 0.9007041454315186
Epoch: 18, Steps: 64 | Train Loss: 0.1064061 Vali Loss: 0.2006801 Test Loss: 0.1945069
Validation loss decreased (0.203440 --> 0.200680).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 19 cost time: 0.8994109630584717
Epoch: 19, Steps: 64 | Train Loss: 0.1058215 Vali Loss: 0.1951473 Test Loss: 0.1860845
Validation loss decreased (0.200680 --> 0.195147).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 20 cost time: 0.9064416885375977
Epoch: 20, Steps: 64 | Train Loss: 0.1048846 Vali Loss: 0.1936704 Test Loss: 0.1838120
Validation loss decreased (0.195147 --> 0.193670).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 21 cost time: 0.8474133014678955
Epoch: 21, Steps: 64 | Train Loss: 0.1040990 Vali Loss: 0.1910456 Test Loss: 0.1795397
Validation loss decreased (0.193670 --> 0.191046).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 22 cost time: 0.8909132480621338
Epoch: 22, Steps: 64 | Train Loss: 0.1033184 Vali Loss: 0.1917495 Test Loss: 0.1787891
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 23 cost time: 0.8689985275268555
Epoch: 23, Steps: 64 | Train Loss: 0.1029543 Vali Loss: 0.1894335 Test Loss: 0.1754329
Validation loss decreased (0.191046 --> 0.189434).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 24 cost time: 0.869631290435791
Epoch: 24, Steps: 64 | Train Loss: 0.1021154 Vali Loss: 0.1870578 Test Loss: 0.1735456
Validation loss decreased (0.189434 --> 0.187058).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 25 cost time: 0.8653984069824219
Epoch: 25, Steps: 64 | Train Loss: 0.1023474 Vali Loss: 0.1830465 Test Loss: 0.1722067
Validation loss decreased (0.187058 --> 0.183046).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 26 cost time: 0.868422269821167
Epoch: 26, Steps: 64 | Train Loss: 0.1015638 Vali Loss: 0.1831217 Test Loss: 0.1695410
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 27 cost time: 0.8851528167724609
Epoch: 27, Steps: 64 | Train Loss: 0.1009270 Vali Loss: 0.1837786 Test Loss: 0.1688744
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 28 cost time: 0.8780007362365723
Epoch: 28, Steps: 64 | Train Loss: 0.1004389 Vali Loss: 0.1825987 Test Loss: 0.1683659
Validation loss decreased (0.183046 --> 0.182599).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 29 cost time: 0.8850002288818359
Epoch: 29, Steps: 64 | Train Loss: 0.1001915 Vali Loss: 0.1836061 Test Loss: 0.1669920
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 30 cost time: 0.8808636665344238
Epoch: 30, Steps: 64 | Train Loss: 0.1005058 Vali Loss: 0.1782858 Test Loss: 0.1651025
Validation loss decreased (0.182599 --> 0.178286).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 31 cost time: 0.8671951293945312
Epoch: 31, Steps: 64 | Train Loss: 0.1000663 Vali Loss: 0.1789825 Test Loss: 0.1648209
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 32 cost time: 0.8613893985748291
Epoch: 32, Steps: 64 | Train Loss: 0.0998374 Vali Loss: 0.1785398 Test Loss: 0.1640542
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 33 cost time: 0.8657352924346924
Epoch: 33, Steps: 64 | Train Loss: 0.0987875 Vali Loss: 0.1813466 Test Loss: 0.1647565
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 34 cost time: 0.8650002479553223
Epoch: 34, Steps: 64 | Train Loss: 0.0992859 Vali Loss: 0.1787501 Test Loss: 0.1633693
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 35 cost time: 0.9046154022216797
Epoch: 35, Steps: 64 | Train Loss: 0.0990809 Vali Loss: 0.1804205 Test Loss: 0.1640352
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 36 cost time: 0.9013798236846924
Epoch: 36, Steps: 64 | Train Loss: 0.0992094 Vali Loss: 0.1796947 Test Loss: 0.1630415
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 37 cost time: 0.899397611618042
Epoch: 37, Steps: 64 | Train Loss: 0.0990116 Vali Loss: 0.1789449 Test Loss: 0.1618735
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 38 cost time: 0.9044458866119385
Epoch: 38, Steps: 64 | Train Loss: 0.0993552 Vali Loss: 0.1783379 Test Loss: 0.1619593
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 39 cost time: 0.9024257659912109
Epoch: 39, Steps: 64 | Train Loss: 0.0985195 Vali Loss: 0.1786470 Test Loss: 0.1620069
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 40 cost time: 0.8773305416107178
Epoch: 40, Steps: 64 | Train Loss: 0.0986526 Vali Loss: 0.1783852 Test Loss: 0.1610602
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 41 cost time: 0.8840014934539795
Epoch: 41, Steps: 64 | Train Loss: 0.0986392 Vali Loss: 0.1778018 Test Loss: 0.1606649
Validation loss decreased (0.178286 --> 0.177802).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 42 cost time: 0.8836376667022705
Epoch: 42, Steps: 64 | Train Loss: 0.0985568 Vali Loss: 0.1774068 Test Loss: 0.1603522
Validation loss decreased (0.177802 --> 0.177407).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 43 cost time: 0.8773818016052246
Epoch: 43, Steps: 64 | Train Loss: 0.0985051 Vali Loss: 0.1757517 Test Loss: 0.1610576
Validation loss decreased (0.177407 --> 0.175752).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 44 cost time: 0.8984193801879883
Epoch: 44, Steps: 64 | Train Loss: 0.0985298 Vali Loss: 0.1756433 Test Loss: 0.1611628
Validation loss decreased (0.175752 --> 0.175643).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 45 cost time: 0.8953938484191895
Epoch: 45, Steps: 64 | Train Loss: 0.0982101 Vali Loss: 0.1768991 Test Loss: 0.1611477
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 46 cost time: 0.9121615886688232
Epoch: 46, Steps: 64 | Train Loss: 0.0982564 Vali Loss: 0.1763688 Test Loss: 0.1603272
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 47 cost time: 0.8840005397796631
Epoch: 47, Steps: 64 | Train Loss: 0.0980297 Vali Loss: 0.1758448 Test Loss: 0.1604744
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 48 cost time: 0.8986287117004395
Epoch: 48, Steps: 64 | Train Loss: 0.0980288 Vali Loss: 0.1763988 Test Loss: 0.1601249
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 49 cost time: 0.8863918781280518
Epoch: 49, Steps: 64 | Train Loss: 0.0984148 Vali Loss: 0.1764015 Test Loss: 0.1594979
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 50 cost time: 0.8590383529663086
Epoch: 50, Steps: 64 | Train Loss: 0.0983813 Vali Loss: 0.1781076 Test Loss: 0.1605784
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 51 cost time: 0.8584434986114502
Epoch: 51, Steps: 64 | Train Loss: 0.0978022 Vali Loss: 0.1744252 Test Loss: 0.1605487
Validation loss decreased (0.175643 --> 0.174425).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 52 cost time: 0.8642680644989014
Epoch: 52, Steps: 64 | Train Loss: 0.0983221 Vali Loss: 0.1742905 Test Loss: 0.1602034
Validation loss decreased (0.174425 --> 0.174290).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 53 cost time: 0.8814435005187988
Epoch: 53, Steps: 64 | Train Loss: 0.0979543 Vali Loss: 0.1736425 Test Loss: 0.1587890
Validation loss decreased (0.174290 --> 0.173642).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 54 cost time: 0.8826253414154053
Epoch: 54, Steps: 64 | Train Loss: 0.0985175 Vali Loss: 0.1752329 Test Loss: 0.1594080
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 55 cost time: 0.8773808479309082
Epoch: 55, Steps: 64 | Train Loss: 0.0982235 Vali Loss: 0.1764030 Test Loss: 0.1593233
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 56 cost time: 0.9044525623321533
Epoch: 56, Steps: 64 | Train Loss: 0.0978214 Vali Loss: 0.1781912 Test Loss: 0.1596237
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 57 cost time: 0.8773975372314453
Epoch: 57, Steps: 64 | Train Loss: 0.0977414 Vali Loss: 0.1747685 Test Loss: 0.1591626
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 58 cost time: 0.9015014171600342
Epoch: 58, Steps: 64 | Train Loss: 0.0985348 Vali Loss: 0.1758935 Test Loss: 0.1589690
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 59 cost time: 0.8974509239196777
Epoch: 59, Steps: 64 | Train Loss: 0.0981697 Vali Loss: 0.1762214 Test Loss: 0.1590663
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017644882202148438 GB
GPU已分配内存的峰值：0.05020856857299805 GB
Epoch: 60 cost time: 0.8949992656707764
Epoch: 60, Steps: 64 | Train Loss: 0.0978936 Vali Loss: 0.1752880 Test Loss: 0.1589902
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15878905355930328, mae:0.3062780797481537, rse:0.21209539473056793
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 1 cost time: 2.293792486190796
Epoch: 1, Steps: 64 | Train Loss: 0.8160731 Vali Loss: 1.8783976 Test Loss: 3.5832601
Validation loss decreased (inf --> 1.878398).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 2 cost time: 0.9267714023590088
Epoch: 2, Steps: 64 | Train Loss: 0.5449705 Vali Loss: 0.6049066 Test Loss: 0.9328235
Validation loss decreased (1.878398 --> 0.604907).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 3 cost time: 0.9196405410766602
Epoch: 3, Steps: 64 | Train Loss: 0.1692517 Vali Loss: 0.2038507 Test Loss: 0.1594694
Validation loss decreased (0.604907 --> 0.203851).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 4 cost time: 0.9213294982910156
Epoch: 4, Steps: 64 | Train Loss: 0.1135339 Vali Loss: 0.1817813 Test Loss: 0.1579340
Validation loss decreased (0.203851 --> 0.181781).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 5 cost time: 0.8954758644104004
Epoch: 5, Steps: 64 | Train Loss: 0.1067350 Vali Loss: 0.1749782 Test Loss: 0.1519134
Validation loss decreased (0.181781 --> 0.174978).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 6 cost time: 0.8933725357055664
Epoch: 6, Steps: 64 | Train Loss: 0.1031204 Vali Loss: 0.1716423 Test Loss: 0.1479345
Validation loss decreased (0.174978 --> 0.171642).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 7 cost time: 0.8860664367675781
Epoch: 7, Steps: 64 | Train Loss: 0.1009497 Vali Loss: 0.1662134 Test Loss: 0.1462728
Validation loss decreased (0.171642 --> 0.166213).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 8 cost time: 0.8827688694000244
Epoch: 8, Steps: 64 | Train Loss: 0.0986935 Vali Loss: 0.1663941 Test Loss: 0.1465373
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 9 cost time: 0.9120016098022461
Epoch: 9, Steps: 64 | Train Loss: 0.0974628 Vali Loss: 0.1665386 Test Loss: 0.1449094
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 10 cost time: 0.9216189384460449
Epoch: 10, Steps: 64 | Train Loss: 0.0964467 Vali Loss: 0.1616565 Test Loss: 0.1437169
Validation loss decreased (0.166213 --> 0.161656).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 11 cost time: 0.9153597354888916
Epoch: 11, Steps: 64 | Train Loss: 0.0950349 Vali Loss: 0.1649161 Test Loss: 0.1460462
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 12 cost time: 0.9374940395355225
Epoch: 12, Steps: 64 | Train Loss: 0.0944554 Vali Loss: 0.1640634 Test Loss: 0.1451631
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 13 cost time: 0.9250590801239014
Epoch: 13, Steps: 64 | Train Loss: 0.0939188 Vali Loss: 0.1625990 Test Loss: 0.1435272
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 14 cost time: 0.9163556098937988
Epoch: 14, Steps: 64 | Train Loss: 0.0935115 Vali Loss: 0.1613262 Test Loss: 0.1443182
Validation loss decreased (0.161656 --> 0.161326).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 15 cost time: 0.9154036045074463
Epoch: 15, Steps: 64 | Train Loss: 0.0928887 Vali Loss: 0.1597029 Test Loss: 0.1441329
Validation loss decreased (0.161326 --> 0.159703).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 16 cost time: 0.9157547950744629
Epoch: 16, Steps: 64 | Train Loss: 0.0920092 Vali Loss: 0.1617088 Test Loss: 0.1441828
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 17 cost time: 0.925999641418457
Epoch: 17, Steps: 64 | Train Loss: 0.0918789 Vali Loss: 0.1609953 Test Loss: 0.1437021
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 18 cost time: 0.9346108436584473
Epoch: 18, Steps: 64 | Train Loss: 0.0917261 Vali Loss: 0.1604071 Test Loss: 0.1436949
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 19 cost time: 0.9331603050231934
Epoch: 19, Steps: 64 | Train Loss: 0.0916436 Vali Loss: 0.1610138 Test Loss: 0.1442983
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 20 cost time: 0.9443767070770264
Epoch: 20, Steps: 64 | Train Loss: 0.0909378 Vali Loss: 0.1608771 Test Loss: 0.1438538
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 21 cost time: 0.9383790493011475
Epoch: 21, Steps: 64 | Train Loss: 0.0908992 Vali Loss: 0.1605615 Test Loss: 0.1445570
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 22 cost time: 0.9123849868774414
Epoch: 22, Steps: 64 | Train Loss: 0.0907033 Vali Loss: 0.1570259 Test Loss: 0.1440492
Validation loss decreased (0.159703 --> 0.157026).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 23 cost time: 0.8877246379852295
Epoch: 23, Steps: 64 | Train Loss: 0.0902734 Vali Loss: 0.1580028 Test Loss: 0.1439205
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 24 cost time: 0.8906748294830322
Epoch: 24, Steps: 64 | Train Loss: 0.0899640 Vali Loss: 0.1604078 Test Loss: 0.1439588
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 25 cost time: 0.8854703903198242
Epoch: 25, Steps: 64 | Train Loss: 0.0897973 Vali Loss: 0.1574670 Test Loss: 0.1442949
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 26 cost time: 0.908639669418335
Epoch: 26, Steps: 64 | Train Loss: 0.0897974 Vali Loss: 0.1588513 Test Loss: 0.1446017
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 27 cost time: 0.917327880859375
Epoch: 27, Steps: 64 | Train Loss: 0.0896234 Vali Loss: 0.1588989 Test Loss: 0.1443540
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 28 cost time: 0.9100415706634521
Epoch: 28, Steps: 64 | Train Loss: 0.0896489 Vali Loss: 0.1578196 Test Loss: 0.1445894
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 29 cost time: 0.9143874645233154
Epoch: 29, Steps: 64 | Train Loss: 0.0891065 Vali Loss: 0.1594395 Test Loss: 0.1448871
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 30 cost time: 0.8853986263275146
Epoch: 30, Steps: 64 | Train Loss: 0.0897871 Vali Loss: 0.1596525 Test Loss: 0.1444304
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 31 cost time: 0.8759980201721191
Epoch: 31, Steps: 64 | Train Loss: 0.0892875 Vali Loss: 0.1570594 Test Loss: 0.1442207
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 32 cost time: 0.8813612461090088
Epoch: 32, Steps: 64 | Train Loss: 0.0892949 Vali Loss: 0.1572672 Test Loss: 0.1449912
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 33 cost time: 0.9226346015930176
Epoch: 33, Steps: 64 | Train Loss: 0.0892074 Vali Loss: 0.1559680 Test Loss: 0.1445680
Validation loss decreased (0.157026 --> 0.155968).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 34 cost time: 0.9484717845916748
Epoch: 34, Steps: 64 | Train Loss: 0.0891842 Vali Loss: 0.1571361 Test Loss: 0.1444984
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 35 cost time: 0.9363579750061035
Epoch: 35, Steps: 64 | Train Loss: 0.0884494 Vali Loss: 0.1576396 Test Loss: 0.1446291
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 36 cost time: 0.9370412826538086
Epoch: 36, Steps: 64 | Train Loss: 0.0890110 Vali Loss: 0.1584912 Test Loss: 0.1450368
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 37 cost time: 0.9414441585540771
Epoch: 37, Steps: 64 | Train Loss: 0.0890729 Vali Loss: 0.1576232 Test Loss: 0.1443074
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 38 cost time: 0.9257650375366211
Epoch: 38, Steps: 64 | Train Loss: 0.0887505 Vali Loss: 0.1599575 Test Loss: 0.1439267
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 39 cost time: 0.9160017967224121
Epoch: 39, Steps: 64 | Train Loss: 0.0884783 Vali Loss: 0.1588703 Test Loss: 0.1454408
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 40 cost time: 0.9149997234344482
Epoch: 40, Steps: 64 | Train Loss: 0.0886619 Vali Loss: 0.1573677 Test Loss: 0.1451070
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 41 cost time: 0.921623945236206
Epoch: 41, Steps: 64 | Train Loss: 0.0885717 Vali Loss: 0.1575270 Test Loss: 0.1445378
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 42 cost time: 0.9194071292877197
Epoch: 42, Steps: 64 | Train Loss: 0.0884355 Vali Loss: 0.1564146 Test Loss: 0.1447420
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 43 cost time: 0.931483268737793
Epoch: 43, Steps: 64 | Train Loss: 0.0886786 Vali Loss: 0.1594179 Test Loss: 0.1444534
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 44 cost time: 0.9304237365722656
Epoch: 44, Steps: 64 | Train Loss: 0.0885818 Vali Loss: 0.1576778 Test Loss: 0.1452143
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 45 cost time: 0.9177882671356201
Epoch: 45, Steps: 64 | Train Loss: 0.0885789 Vali Loss: 0.1564985 Test Loss: 0.1452616
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 46 cost time: 0.9098114967346191
Epoch: 46, Steps: 64 | Train Loss: 0.0883555 Vali Loss: 0.1584388 Test Loss: 0.1452314
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 47 cost time: 0.8929967880249023
Epoch: 47, Steps: 64 | Train Loss: 0.0888022 Vali Loss: 0.1575577 Test Loss: 0.1447009
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 48 cost time: 0.8976449966430664
Epoch: 48, Steps: 64 | Train Loss: 0.0882122 Vali Loss: 0.1561225 Test Loss: 0.1445358
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 49 cost time: 0.9301395416259766
Epoch: 49, Steps: 64 | Train Loss: 0.0884638 Vali Loss: 0.1577360 Test Loss: 0.1446899
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 50 cost time: 0.9313919544219971
Epoch: 50, Steps: 64 | Train Loss: 0.0882800 Vali Loss: 0.1574251 Test Loss: 0.1450280
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 51 cost time: 0.9366402626037598
Epoch: 51, Steps: 64 | Train Loss: 0.0881420 Vali Loss: 0.1590810 Test Loss: 0.1452662
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 52 cost time: 0.9124870300292969
Epoch: 52, Steps: 64 | Train Loss: 0.0886980 Vali Loss: 0.1583566 Test Loss: 0.1456076
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 53 cost time: 0.9137434959411621
Epoch: 53, Steps: 64 | Train Loss: 0.0883760 Vali Loss: 0.1586519 Test Loss: 0.1443910
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 54 cost time: 0.9086363315582275
Epoch: 54, Steps: 64 | Train Loss: 0.0884020 Vali Loss: 0.1572912 Test Loss: 0.1448200
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 55 cost time: 0.9080009460449219
Epoch: 55, Steps: 64 | Train Loss: 0.0885035 Vali Loss: 0.1578544 Test Loss: 0.1441024
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 56 cost time: 0.918665885925293
Epoch: 56, Steps: 64 | Train Loss: 0.0883980 Vali Loss: 0.1567606 Test Loss: 0.1448912
EarlyStopping counter: 23 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 57 cost time: 0.9141786098480225
Epoch: 57, Steps: 64 | Train Loss: 0.0884534 Vali Loss: 0.1578115 Test Loss: 0.1445055
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 58 cost time: 0.9225332736968994
Epoch: 58, Steps: 64 | Train Loss: 0.0880488 Vali Loss: 0.1593189 Test Loss: 0.1442488
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 59 cost time: 0.9214303493499756
Epoch: 59, Steps: 64 | Train Loss: 0.0885583 Vali Loss: 0.1567577 Test Loss: 0.1439281
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019361495971679688 GB
GPU已分配内存的峰值：0.05419778823852539 GB
Epoch: 60 cost time: 0.937359094619751
Epoch: 60, Steps: 64 | Train Loss: 0.0886073 Vali Loss: 0.1575258 Test Loss: 0.1449499
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14456801116466522, mae:0.2865445613861084, rse:0.20237508416175842
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05727052688598633 GB
Epoch: 1 cost time: 2.3621695041656494
Epoch: 1, Steps: 64 | Train Loss: 0.7843259 Vali Loss: 1.8304294 Test Loss: 3.4989576
Validation loss decreased (inf --> 1.830429).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 2 cost time: 0.943389892578125
Epoch: 2, Steps: 64 | Train Loss: 0.4619827 Vali Loss: 0.2598652 Test Loss: 0.2270974
Validation loss decreased (1.830429 --> 0.259865).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 3 cost time: 0.9334361553192139
Epoch: 3, Steps: 64 | Train Loss: 0.1229483 Vali Loss: 0.2044441 Test Loss: 0.1875003
Validation loss decreased (0.259865 --> 0.204444).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 4 cost time: 0.9258506298065186
Epoch: 4, Steps: 64 | Train Loss: 0.1067287 Vali Loss: 0.1789400 Test Loss: 0.1516702
Validation loss decreased (0.204444 --> 0.178940).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 5 cost time: 0.9087433815002441
Epoch: 5, Steps: 64 | Train Loss: 0.1010161 Vali Loss: 0.1777669 Test Loss: 0.1530095
Validation loss decreased (0.178940 --> 0.177767).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 6 cost time: 0.9064590930938721
Epoch: 6, Steps: 64 | Train Loss: 0.0989270 Vali Loss: 0.1735043 Test Loss: 0.1509980
Validation loss decreased (0.177767 --> 0.173504).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 7 cost time: 0.9066331386566162
Epoch: 7, Steps: 64 | Train Loss: 0.0965163 Vali Loss: 0.1725182 Test Loss: 0.1505041
Validation loss decreased (0.173504 --> 0.172518).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 8 cost time: 0.915393590927124
Epoch: 8, Steps: 64 | Train Loss: 0.0948494 Vali Loss: 0.1688042 Test Loss: 0.1484845
Validation loss decreased (0.172518 --> 0.168804).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 9 cost time: 0.9354755878448486
Epoch: 9, Steps: 64 | Train Loss: 0.0936458 Vali Loss: 0.1641460 Test Loss: 0.1491487
Validation loss decreased (0.168804 --> 0.164146).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 10 cost time: 0.9354214668273926
Epoch: 10, Steps: 64 | Train Loss: 0.0930745 Vali Loss: 0.1669379 Test Loss: 0.1481888
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 11 cost time: 0.9560379981994629
Epoch: 11, Steps: 64 | Train Loss: 0.0922397 Vali Loss: 0.1665397 Test Loss: 0.1499243
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 12 cost time: 0.9597733020782471
Epoch: 12, Steps: 64 | Train Loss: 0.0919172 Vali Loss: 0.1672151 Test Loss: 0.1490320
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 13 cost time: 0.9417519569396973
Epoch: 13, Steps: 64 | Train Loss: 0.0912201 Vali Loss: 0.1650085 Test Loss: 0.1494156
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 14 cost time: 0.9379997253417969
Epoch: 14, Steps: 64 | Train Loss: 0.0903784 Vali Loss: 0.1657363 Test Loss: 0.1495095
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 15 cost time: 0.9389996528625488
Epoch: 15, Steps: 64 | Train Loss: 0.0901385 Vali Loss: 0.1653730 Test Loss: 0.1496616
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 16 cost time: 0.9416365623474121
Epoch: 16, Steps: 64 | Train Loss: 0.0897543 Vali Loss: 0.1672385 Test Loss: 0.1492409
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 17 cost time: 0.9534165859222412
Epoch: 17, Steps: 64 | Train Loss: 0.0896276 Vali Loss: 0.1641150 Test Loss: 0.1490417
Validation loss decreased (0.164146 --> 0.164115).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 18 cost time: 0.9573569297790527
Epoch: 18, Steps: 64 | Train Loss: 0.0883643 Vali Loss: 0.1609525 Test Loss: 0.1500125
Validation loss decreased (0.164115 --> 0.160952).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 19 cost time: 0.9573898315429688
Epoch: 19, Steps: 64 | Train Loss: 0.0887521 Vali Loss: 0.1650379 Test Loss: 0.1499645
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 20 cost time: 0.9551458358764648
Epoch: 20, Steps: 64 | Train Loss: 0.0883910 Vali Loss: 0.1637454 Test Loss: 0.1516533
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 21 cost time: 0.962517499923706
Epoch: 21, Steps: 64 | Train Loss: 0.0886004 Vali Loss: 0.1631234 Test Loss: 0.1500982
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 22 cost time: 0.912419319152832
Epoch: 22, Steps: 64 | Train Loss: 0.0877845 Vali Loss: 0.1648082 Test Loss: 0.1513458
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 23 cost time: 0.9127352237701416
Epoch: 23, Steps: 64 | Train Loss: 0.0881586 Vali Loss: 0.1620357 Test Loss: 0.1507747
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 24 cost time: 0.905637264251709
Epoch: 24, Steps: 64 | Train Loss: 0.0877188 Vali Loss: 0.1633977 Test Loss: 0.1520274
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 25 cost time: 0.9326455593109131
Epoch: 25, Steps: 64 | Train Loss: 0.0875051 Vali Loss: 0.1641924 Test Loss: 0.1521306
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 26 cost time: 0.9283876419067383
Epoch: 26, Steps: 64 | Train Loss: 0.0876982 Vali Loss: 0.1641008 Test Loss: 0.1517046
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 27 cost time: 0.9323921203613281
Epoch: 27, Steps: 64 | Train Loss: 0.0866077 Vali Loss: 0.1622258 Test Loss: 0.1523890
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 28 cost time: 0.9283742904663086
Epoch: 28, Steps: 64 | Train Loss: 0.0871531 Vali Loss: 0.1640189 Test Loss: 0.1525516
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 29 cost time: 0.9303836822509766
Epoch: 29, Steps: 64 | Train Loss: 0.0867861 Vali Loss: 0.1635327 Test Loss: 0.1523840
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 30 cost time: 0.9026062488555908
Epoch: 30, Steps: 64 | Train Loss: 0.0869198 Vali Loss: 0.1608799 Test Loss: 0.1520038
Validation loss decreased (0.160952 --> 0.160880).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 31 cost time: 0.9048466682434082
Epoch: 31, Steps: 64 | Train Loss: 0.0868410 Vali Loss: 0.1605279 Test Loss: 0.1524828
Validation loss decreased (0.160880 --> 0.160528).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 32 cost time: 0.9068100452423096
Epoch: 32, Steps: 64 | Train Loss: 0.0867476 Vali Loss: 0.1615698 Test Loss: 0.1528891
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 33 cost time: 0.9456303119659424
Epoch: 33, Steps: 64 | Train Loss: 0.0869161 Vali Loss: 0.1627729 Test Loss: 0.1540330
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 34 cost time: 0.9576025009155273
Epoch: 34, Steps: 64 | Train Loss: 0.0871945 Vali Loss: 0.1633383 Test Loss: 0.1523709
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 35 cost time: 0.9575386047363281
Epoch: 35, Steps: 64 | Train Loss: 0.0864921 Vali Loss: 0.1627140 Test Loss: 0.1532410
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 36 cost time: 0.960813045501709
Epoch: 36, Steps: 64 | Train Loss: 0.0863179 Vali Loss: 0.1628803 Test Loss: 0.1537461
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 37 cost time: 0.9554414749145508
Epoch: 37, Steps: 64 | Train Loss: 0.0866723 Vali Loss: 0.1624228 Test Loss: 0.1528529
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 38 cost time: 0.9513821601867676
Epoch: 38, Steps: 64 | Train Loss: 0.0868350 Vali Loss: 0.1634063 Test Loss: 0.1528597
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 39 cost time: 0.9353365898132324
Epoch: 39, Steps: 64 | Train Loss: 0.0865713 Vali Loss: 0.1626032 Test Loss: 0.1525622
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 40 cost time: 0.9407429695129395
Epoch: 40, Steps: 64 | Train Loss: 0.0863688 Vali Loss: 0.1616324 Test Loss: 0.1534851
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 41 cost time: 0.944000244140625
Epoch: 41, Steps: 64 | Train Loss: 0.0864469 Vali Loss: 0.1633807 Test Loss: 0.1531898
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 42 cost time: 0.9499998092651367
Epoch: 42, Steps: 64 | Train Loss: 0.0865443 Vali Loss: 0.1629598 Test Loss: 0.1535552
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 43 cost time: 0.9516241550445557
Epoch: 43, Steps: 64 | Train Loss: 0.0862835 Vali Loss: 0.1625997 Test Loss: 0.1529515
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 44 cost time: 0.9582524299621582
Epoch: 44, Steps: 64 | Train Loss: 0.0864980 Vali Loss: 0.1615307 Test Loss: 0.1533517
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 45 cost time: 0.9568166732788086
Epoch: 45, Steps: 64 | Train Loss: 0.0866414 Vali Loss: 0.1617763 Test Loss: 0.1532949
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 46 cost time: 0.917412519454956
Epoch: 46, Steps: 64 | Train Loss: 0.0865598 Vali Loss: 0.1611004 Test Loss: 0.1533245
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 47 cost time: 0.9173629283905029
Epoch: 47, Steps: 64 | Train Loss: 0.0862944 Vali Loss: 0.1629364 Test Loss: 0.1533069
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 48 cost time: 0.9304041862487793
Epoch: 48, Steps: 64 | Train Loss: 0.0858918 Vali Loss: 0.1627991 Test Loss: 0.1528572
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 49 cost time: 0.9233925342559814
Epoch: 49, Steps: 64 | Train Loss: 0.0863590 Vali Loss: 0.1616100 Test Loss: 0.1530394
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 50 cost time: 0.9320011138916016
Epoch: 50, Steps: 64 | Train Loss: 0.0863185 Vali Loss: 0.1622462 Test Loss: 0.1532715
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 51 cost time: 0.9366369247436523
Epoch: 51, Steps: 64 | Train Loss: 0.0863687 Vali Loss: 0.1639465 Test Loss: 0.1534722
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 52 cost time: 0.9406580924987793
Epoch: 52, Steps: 64 | Train Loss: 0.0864400 Vali Loss: 0.1620742 Test Loss: 0.1536220
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 53 cost time: 0.9398074150085449
Epoch: 53, Steps: 64 | Train Loss: 0.0862022 Vali Loss: 0.1618760 Test Loss: 0.1532403
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 54 cost time: 0.9383847713470459
Epoch: 54, Steps: 64 | Train Loss: 0.0862399 Vali Loss: 0.1633316 Test Loss: 0.1534541
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 55 cost time: 0.93538498878479
Epoch: 55, Steps: 64 | Train Loss: 0.0861279 Vali Loss: 0.1621865 Test Loss: 0.1536541
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 56 cost time: 0.9534711837768555
Epoch: 56, Steps: 64 | Train Loss: 0.0865364 Vali Loss: 0.1614076 Test Loss: 0.1534708
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 57 cost time: 0.9448630809783936
Epoch: 57, Steps: 64 | Train Loss: 0.0862477 Vali Loss: 0.1625498 Test Loss: 0.1539280
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 58 cost time: 0.9727170467376709
Epoch: 58, Steps: 64 | Train Loss: 0.0863644 Vali Loss: 0.1622582 Test Loss: 0.1531567
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 59 cost time: 0.9609997272491455
Epoch: 59, Steps: 64 | Train Loss: 0.0859428 Vali Loss: 0.1623925 Test Loss: 0.1532431
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020231246948242188 GB
GPU已分配内存的峰值：0.05949068069458008 GB
Epoch: 60 cost time: 0.9580016136169434
Epoch: 60, Steps: 64 | Train Loss: 0.0864825 Vali Loss: 0.1640353 Test Loss: 0.1540469
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1524827629327774, mae:0.2994649410247803, rse:0.20784105360507965
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.05014467239379883 GB
Epoch: 1 cost time: 2.2733590602874756
Epoch: 1, Steps: 64 | Train Loss: 0.8324779 Vali Loss: 1.8595266 Test Loss: 3.5251970
Validation loss decreased (inf --> 1.859527).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 2 cost time: 0.9056205749511719
Epoch: 2, Steps: 64 | Train Loss: 0.6922189 Vali Loss: 1.2621112 Test Loss: 2.2866306
Validation loss decreased (1.859527 --> 1.262111).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 3 cost time: 0.8946433067321777
Epoch: 3, Steps: 64 | Train Loss: 0.4875113 Vali Loss: 0.9032524 Test Loss: 1.5515684
Validation loss decreased (1.262111 --> 0.903252).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 4 cost time: 0.8893687725067139
Epoch: 4, Steps: 64 | Train Loss: 0.3649310 Vali Loss: 0.7084661 Test Loss: 1.1632884
Validation loss decreased (0.903252 --> 0.708466).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 5 cost time: 0.8824567794799805
Epoch: 5, Steps: 64 | Train Loss: 0.2876033 Vali Loss: 0.5666184 Test Loss: 0.8920466
Validation loss decreased (0.708466 --> 0.566618).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 6 cost time: 0.8707096576690674
Epoch: 6, Steps: 64 | Train Loss: 0.2348886 Vali Loss: 0.4653708 Test Loss: 0.6987109
Validation loss decreased (0.566618 --> 0.465371).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 7 cost time: 0.8693630695343018
Epoch: 7, Steps: 64 | Train Loss: 0.1987206 Vali Loss: 0.3961236 Test Loss: 0.5714660
Validation loss decreased (0.465371 --> 0.396124).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 8 cost time: 0.8640003204345703
Epoch: 8, Steps: 64 | Train Loss: 0.1734913 Vali Loss: 0.3444787 Test Loss: 0.4737175
Validation loss decreased (0.396124 --> 0.344479).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 9 cost time: 0.8789987564086914
Epoch: 9, Steps: 64 | Train Loss: 0.1552541 Vali Loss: 0.3059353 Test Loss: 0.4043100
Validation loss decreased (0.344479 --> 0.305935).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 10 cost time: 0.8979165554046631
Epoch: 10, Steps: 64 | Train Loss: 0.1419809 Vali Loss: 0.2770380 Test Loss: 0.3533189
Validation loss decreased (0.305935 --> 0.277038).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 11 cost time: 0.8934519290924072
Epoch: 11, Steps: 64 | Train Loss: 0.1319265 Vali Loss: 0.2577338 Test Loss: 0.3176144
Validation loss decreased (0.277038 --> 0.257734).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 12 cost time: 0.9063894748687744
Epoch: 12, Steps: 64 | Train Loss: 0.1249936 Vali Loss: 0.2434815 Test Loss: 0.2889240
Validation loss decreased (0.257734 --> 0.243481).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 13 cost time: 0.9073531627655029
Epoch: 13, Steps: 64 | Train Loss: 0.1194978 Vali Loss: 0.2328219 Test Loss: 0.2677481
Validation loss decreased (0.243481 --> 0.232822).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 14 cost time: 0.8897721767425537
Epoch: 14, Steps: 64 | Train Loss: 0.1157489 Vali Loss: 0.2233144 Test Loss: 0.2515474
Validation loss decreased (0.232822 --> 0.223314).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 15 cost time: 0.8879992961883545
Epoch: 15, Steps: 64 | Train Loss: 0.1122795 Vali Loss: 0.2125785 Test Loss: 0.2349466
Validation loss decreased (0.223314 --> 0.212578).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 16 cost time: 0.8570008277893066
Epoch: 16, Steps: 64 | Train Loss: 0.1096642 Vali Loss: 0.2072454 Test Loss: 0.2233846
Validation loss decreased (0.212578 --> 0.207245).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 17 cost time: 0.892648458480835
Epoch: 17, Steps: 64 | Train Loss: 0.1071400 Vali Loss: 0.2032336 Test Loss: 0.2161873
Validation loss decreased (0.207245 --> 0.203234).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 18 cost time: 0.9124188423156738
Epoch: 18, Steps: 64 | Train Loss: 0.1053469 Vali Loss: 0.1990094 Test Loss: 0.2084262
Validation loss decreased (0.203234 --> 0.199009).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 19 cost time: 0.9207770824432373
Epoch: 19, Steps: 64 | Train Loss: 0.1040040 Vali Loss: 0.1931697 Test Loss: 0.2019593
Validation loss decreased (0.199009 --> 0.193170).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 20 cost time: 0.909529447555542
Epoch: 20, Steps: 64 | Train Loss: 0.1026014 Vali Loss: 0.1876225 Test Loss: 0.1958699
Validation loss decreased (0.193170 --> 0.187623).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 21 cost time: 0.9097731113433838
Epoch: 21, Steps: 64 | Train Loss: 0.1019962 Vali Loss: 0.1889637 Test Loss: 0.1925769
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 22 cost time: 0.8889989852905273
Epoch: 22, Steps: 64 | Train Loss: 0.1009775 Vali Loss: 0.1859126 Test Loss: 0.1896633
Validation loss decreased (0.187623 --> 0.185913).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 23 cost time: 0.8792178630828857
Epoch: 23, Steps: 64 | Train Loss: 0.1003750 Vali Loss: 0.1842177 Test Loss: 0.1865346
Validation loss decreased (0.185913 --> 0.184218).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 24 cost time: 0.870664119720459
Epoch: 24, Steps: 64 | Train Loss: 0.0999836 Vali Loss: 0.1837519 Test Loss: 0.1844729
Validation loss decreased (0.184218 --> 0.183752).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 25 cost time: 0.8754000663757324
Epoch: 25, Steps: 64 | Train Loss: 0.0990430 Vali Loss: 0.1837739 Test Loss: 0.1822815
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 26 cost time: 0.8923397064208984
Epoch: 26, Steps: 64 | Train Loss: 0.0986768 Vali Loss: 0.1800499 Test Loss: 0.1795284
Validation loss decreased (0.183752 --> 0.180050).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 27 cost time: 0.8987791538238525
Epoch: 27, Steps: 64 | Train Loss: 0.0985174 Vali Loss: 0.1785558 Test Loss: 0.1781771
Validation loss decreased (0.180050 --> 0.178556).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 28 cost time: 0.886791467666626
Epoch: 28, Steps: 64 | Train Loss: 0.0980445 Vali Loss: 0.1790817 Test Loss: 0.1765252
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 29 cost time: 0.8899993896484375
Epoch: 29, Steps: 64 | Train Loss: 0.0978567 Vali Loss: 0.1757784 Test Loss: 0.1757700
Validation loss decreased (0.178556 --> 0.175778).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 30 cost time: 0.8866450786590576
Epoch: 30, Steps: 64 | Train Loss: 0.0973016 Vali Loss: 0.1765762 Test Loss: 0.1732597
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 31 cost time: 0.8614494800567627
Epoch: 31, Steps: 64 | Train Loss: 0.0969777 Vali Loss: 0.1747885 Test Loss: 0.1731463
Validation loss decreased (0.175778 --> 0.174788).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 32 cost time: 0.876577615737915
Epoch: 32, Steps: 64 | Train Loss: 0.0971587 Vali Loss: 0.1730705 Test Loss: 0.1717295
Validation loss decreased (0.174788 --> 0.173071).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 33 cost time: 0.8704938888549805
Epoch: 33, Steps: 64 | Train Loss: 0.0962821 Vali Loss: 0.1741458 Test Loss: 0.1720773
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 34 cost time: 0.8787639141082764
Epoch: 34, Steps: 64 | Train Loss: 0.0958863 Vali Loss: 0.1738588 Test Loss: 0.1718017
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 35 cost time: 0.916999101638794
Epoch: 35, Steps: 64 | Train Loss: 0.0960041 Vali Loss: 0.1743802 Test Loss: 0.1708501
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 36 cost time: 0.9069828987121582
Epoch: 36, Steps: 64 | Train Loss: 0.0956705 Vali Loss: 0.1757915 Test Loss: 0.1708885
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 37 cost time: 0.9205577373504639
Epoch: 37, Steps: 64 | Train Loss: 0.0961969 Vali Loss: 0.1741109 Test Loss: 0.1699665
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 38 cost time: 0.9164865016937256
Epoch: 38, Steps: 64 | Train Loss: 0.0957081 Vali Loss: 0.1715507 Test Loss: 0.1677406
Validation loss decreased (0.173071 --> 0.171551).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 39 cost time: 0.9033799171447754
Epoch: 39, Steps: 64 | Train Loss: 0.0950765 Vali Loss: 0.1725909 Test Loss: 0.1679322
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 40 cost time: 0.9118490219116211
Epoch: 40, Steps: 64 | Train Loss: 0.0963179 Vali Loss: 0.1719569 Test Loss: 0.1685532
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 41 cost time: 0.8927521705627441
Epoch: 41, Steps: 64 | Train Loss: 0.0956298 Vali Loss: 0.1726756 Test Loss: 0.1680050
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 42 cost time: 0.8829998970031738
Epoch: 42, Steps: 64 | Train Loss: 0.0953831 Vali Loss: 0.1725663 Test Loss: 0.1666592
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 43 cost time: 0.8956379890441895
Epoch: 43, Steps: 64 | Train Loss: 0.0954499 Vali Loss: 0.1720049 Test Loss: 0.1669444
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 44 cost time: 0.908409595489502
Epoch: 44, Steps: 64 | Train Loss: 0.0957629 Vali Loss: 0.1727040 Test Loss: 0.1668376
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 45 cost time: 0.9012763500213623
Epoch: 45, Steps: 64 | Train Loss: 0.0954689 Vali Loss: 0.1713736 Test Loss: 0.1678334
Validation loss decreased (0.171551 --> 0.171374).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 46 cost time: 0.9045615196228027
Epoch: 46, Steps: 64 | Train Loss: 0.0950963 Vali Loss: 0.1718456 Test Loss: 0.1658209
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 47 cost time: 0.8968091011047363
Epoch: 47, Steps: 64 | Train Loss: 0.0953007 Vali Loss: 0.1698595 Test Loss: 0.1664878
Validation loss decreased (0.171374 --> 0.169860).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 48 cost time: 0.870729923248291
Epoch: 48, Steps: 64 | Train Loss: 0.0952741 Vali Loss: 0.1717006 Test Loss: 0.1663099
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 49 cost time: 0.8693575859069824
Epoch: 49, Steps: 64 | Train Loss: 0.0952800 Vali Loss: 0.1720748 Test Loss: 0.1662262
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 50 cost time: 0.8726403713226318
Epoch: 50, Steps: 64 | Train Loss: 0.0949730 Vali Loss: 0.1719043 Test Loss: 0.1663328
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 51 cost time: 0.8796002864837646
Epoch: 51, Steps: 64 | Train Loss: 0.0951330 Vali Loss: 0.1715610 Test Loss: 0.1664971
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 52 cost time: 0.8934054374694824
Epoch: 52, Steps: 64 | Train Loss: 0.0949213 Vali Loss: 0.1703066 Test Loss: 0.1655950
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 53 cost time: 0.8877418041229248
Epoch: 53, Steps: 64 | Train Loss: 0.0946504 Vali Loss: 0.1711910 Test Loss: 0.1649045
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 54 cost time: 0.8937563896179199
Epoch: 54, Steps: 64 | Train Loss: 0.0946753 Vali Loss: 0.1704060 Test Loss: 0.1652652
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 55 cost time: 0.8919999599456787
Epoch: 55, Steps: 64 | Train Loss: 0.0948915 Vali Loss: 0.1705156 Test Loss: 0.1658154
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 56 cost time: 0.865617036819458
Epoch: 56, Steps: 64 | Train Loss: 0.0951040 Vali Loss: 0.1702043 Test Loss: 0.1643771
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 57 cost time: 0.8814656734466553
Epoch: 57, Steps: 64 | Train Loss: 0.0949539 Vali Loss: 0.1715551 Test Loss: 0.1650335
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 58 cost time: 0.8913712501525879
Epoch: 58, Steps: 64 | Train Loss: 0.0944899 Vali Loss: 0.1717606 Test Loss: 0.1658753
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 59 cost time: 0.8871352672576904
Epoch: 59, Steps: 64 | Train Loss: 0.0951635 Vali Loss: 0.1705414 Test Loss: 0.1643092
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017648696899414062 GB
GPU已分配内存的峰值：0.050371646881103516 GB
Epoch: 60 cost time: 0.8907411098480225
Epoch: 60, Steps: 64 | Train Loss: 0.0951986 Vali Loss: 0.1700435 Test Loss: 0.1658565
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.16648782789707184, mae:0.31530478596687317, rse:0.21717619895935059
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 1 cost time: 2.3395602703094482
Epoch: 1, Steps: 64 | Train Loss: 0.7716803 Vali Loss: 1.7852187 Test Loss: 3.4173093
Validation loss decreased (inf --> 1.785219).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 2 cost time: 0.9403963088989258
Epoch: 2, Steps: 64 | Train Loss: 0.4715457 Vali Loss: 0.3388689 Test Loss: 0.4753188
Validation loss decreased (1.785219 --> 0.338869).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 3 cost time: 0.9330415725708008
Epoch: 3, Steps: 64 | Train Loss: 0.1297342 Vali Loss: 0.1723142 Test Loss: 0.1476695
Validation loss decreased (0.338869 --> 0.172314).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 4 cost time: 0.9370017051696777
Epoch: 4, Steps: 64 | Train Loss: 0.1066642 Vali Loss: 0.1748815 Test Loss: 0.1554214
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 5 cost time: 0.9179997444152832
Epoch: 5, Steps: 64 | Train Loss: 0.1025708 Vali Loss: 0.1679957 Test Loss: 0.1510476
Validation loss decreased (0.172314 --> 0.167996).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 6 cost time: 0.9086415767669678
Epoch: 6, Steps: 64 | Train Loss: 0.0998808 Vali Loss: 0.1673587 Test Loss: 0.1487440
Validation loss decreased (0.167996 --> 0.167359).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 7 cost time: 0.9102611541748047
Epoch: 7, Steps: 64 | Train Loss: 0.0974578 Vali Loss: 0.1651572 Test Loss: 0.1493960
Validation loss decreased (0.167359 --> 0.165157).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 8 cost time: 0.919379472732544
Epoch: 8, Steps: 64 | Train Loss: 0.0964985 Vali Loss: 0.1642210 Test Loss: 0.1469679
Validation loss decreased (0.165157 --> 0.164221).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 9 cost time: 0.9314291477203369
Epoch: 9, Steps: 64 | Train Loss: 0.0947561 Vali Loss: 0.1612828 Test Loss: 0.1466570
Validation loss decreased (0.164221 --> 0.161283).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 10 cost time: 0.9270343780517578
Epoch: 10, Steps: 64 | Train Loss: 0.0936711 Vali Loss: 0.1610670 Test Loss: 0.1462198
Validation loss decreased (0.161283 --> 0.161067).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 11 cost time: 0.9393892288208008
Epoch: 11, Steps: 64 | Train Loss: 0.0925783 Vali Loss: 0.1618459 Test Loss: 0.1471605
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 12 cost time: 0.9526989459991455
Epoch: 12, Steps: 64 | Train Loss: 0.0917033 Vali Loss: 0.1606340 Test Loss: 0.1469076
Validation loss decreased (0.161067 --> 0.160634).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 13 cost time: 0.9250006675720215
Epoch: 13, Steps: 64 | Train Loss: 0.0913033 Vali Loss: 0.1608159 Test Loss: 0.1475125
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 14 cost time: 0.934607982635498
Epoch: 14, Steps: 64 | Train Loss: 0.0907129 Vali Loss: 0.1622933 Test Loss: 0.1484587
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 15 cost time: 0.9251072406768799
Epoch: 15, Steps: 64 | Train Loss: 0.0903388 Vali Loss: 0.1609542 Test Loss: 0.1478384
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 16 cost time: 0.9494285583496094
Epoch: 16, Steps: 64 | Train Loss: 0.0899659 Vali Loss: 0.1618981 Test Loss: 0.1486041
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 17 cost time: 0.94451904296875
Epoch: 17, Steps: 64 | Train Loss: 0.0894108 Vali Loss: 0.1633307 Test Loss: 0.1485206
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 18 cost time: 0.9553749561309814
Epoch: 18, Steps: 64 | Train Loss: 0.0892449 Vali Loss: 0.1595391 Test Loss: 0.1486870
Validation loss decreased (0.160634 --> 0.159539).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 19 cost time: 0.9409165382385254
Epoch: 19, Steps: 64 | Train Loss: 0.0886492 Vali Loss: 0.1604566 Test Loss: 0.1484327
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 20 cost time: 0.9454760551452637
Epoch: 20, Steps: 64 | Train Loss: 0.0884391 Vali Loss: 0.1604756 Test Loss: 0.1494142
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 21 cost time: 0.9368269443511963
Epoch: 21, Steps: 64 | Train Loss: 0.0879916 Vali Loss: 0.1611579 Test Loss: 0.1489653
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 22 cost time: 0.9289984703063965
Epoch: 22, Steps: 64 | Train Loss: 0.0878687 Vali Loss: 0.1608076 Test Loss: 0.1487878
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 23 cost time: 0.9134171009063721
Epoch: 23, Steps: 64 | Train Loss: 0.0874313 Vali Loss: 0.1616471 Test Loss: 0.1489988
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 24 cost time: 0.9096479415893555
Epoch: 24, Steps: 64 | Train Loss: 0.0875717 Vali Loss: 0.1600710 Test Loss: 0.1487025
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 25 cost time: 0.9023904800415039
Epoch: 25, Steps: 64 | Train Loss: 0.0873897 Vali Loss: 0.1614653 Test Loss: 0.1493433
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 26 cost time: 0.9064033031463623
Epoch: 26, Steps: 64 | Train Loss: 0.0873237 Vali Loss: 0.1597477 Test Loss: 0.1493061
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 27 cost time: 0.9354157447814941
Epoch: 27, Steps: 64 | Train Loss: 0.0871019 Vali Loss: 0.1600700 Test Loss: 0.1488736
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 28 cost time: 0.9292209148406982
Epoch: 28, Steps: 64 | Train Loss: 0.0866416 Vali Loss: 0.1597110 Test Loss: 0.1492304
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 29 cost time: 0.9247546195983887
Epoch: 29, Steps: 64 | Train Loss: 0.0863859 Vali Loss: 0.1603407 Test Loss: 0.1493015
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 30 cost time: 0.942000150680542
Epoch: 30, Steps: 64 | Train Loss: 0.0867316 Vali Loss: 0.1592455 Test Loss: 0.1493544
Validation loss decreased (0.159539 --> 0.159245).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 31 cost time: 0.9420020580291748
Epoch: 31, Steps: 64 | Train Loss: 0.0863594 Vali Loss: 0.1596233 Test Loss: 0.1485973
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 32 cost time: 0.9062802791595459
Epoch: 32, Steps: 64 | Train Loss: 0.0863676 Vali Loss: 0.1593809 Test Loss: 0.1488898
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 33 cost time: 0.9274613857269287
Epoch: 33, Steps: 64 | Train Loss: 0.0863605 Vali Loss: 0.1593620 Test Loss: 0.1490459
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 34 cost time: 0.9524495601654053
Epoch: 34, Steps: 64 | Train Loss: 0.0861534 Vali Loss: 0.1599340 Test Loss: 0.1489302
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 35 cost time: 0.9594180583953857
Epoch: 35, Steps: 64 | Train Loss: 0.0866306 Vali Loss: 0.1603512 Test Loss: 0.1495866
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 36 cost time: 0.9561069011688232
Epoch: 36, Steps: 64 | Train Loss: 0.0861051 Vali Loss: 0.1600472 Test Loss: 0.1494125
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 37 cost time: 0.9414184093475342
Epoch: 37, Steps: 64 | Train Loss: 0.0858532 Vali Loss: 0.1598204 Test Loss: 0.1490279
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 38 cost time: 0.9298219680786133
Epoch: 38, Steps: 64 | Train Loss: 0.0865009 Vali Loss: 0.1596484 Test Loss: 0.1491405
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 39 cost time: 0.9429986476898193
Epoch: 39, Steps: 64 | Train Loss: 0.0862419 Vali Loss: 0.1585317 Test Loss: 0.1490672
Validation loss decreased (0.159245 --> 0.158532).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 40 cost time: 0.9383864402770996
Epoch: 40, Steps: 64 | Train Loss: 0.0857879 Vali Loss: 0.1605803 Test Loss: 0.1495300
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 41 cost time: 0.9446439743041992
Epoch: 41, Steps: 64 | Train Loss: 0.0863385 Vali Loss: 0.1598027 Test Loss: 0.1491080
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 42 cost time: 0.9314095973968506
Epoch: 42, Steps: 64 | Train Loss: 0.0860986 Vali Loss: 0.1606572 Test Loss: 0.1497802
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 43 cost time: 0.947425127029419
Epoch: 43, Steps: 64 | Train Loss: 0.0864521 Vali Loss: 0.1586417 Test Loss: 0.1492457
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 44 cost time: 0.933013916015625
Epoch: 44, Steps: 64 | Train Loss: 0.0858668 Vali Loss: 0.1581040 Test Loss: 0.1496075
Validation loss decreased (0.158532 --> 0.158104).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 45 cost time: 0.9353539943695068
Epoch: 45, Steps: 64 | Train Loss: 0.0855830 Vali Loss: 0.1602033 Test Loss: 0.1496695
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 46 cost time: 0.9103975296020508
Epoch: 46, Steps: 64 | Train Loss: 0.0858358 Vali Loss: 0.1579292 Test Loss: 0.1492540
Validation loss decreased (0.158104 --> 0.157929).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 47 cost time: 0.9187395572662354
Epoch: 47, Steps: 64 | Train Loss: 0.0860494 Vali Loss: 0.1596598 Test Loss: 0.1503825
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 48 cost time: 0.9303648471832275
Epoch: 48, Steps: 64 | Train Loss: 0.0860602 Vali Loss: 0.1583536 Test Loss: 0.1489723
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 49 cost time: 0.9190001487731934
Epoch: 49, Steps: 64 | Train Loss: 0.0855752 Vali Loss: 0.1585200 Test Loss: 0.1492485
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 50 cost time: 0.9286439418792725
Epoch: 50, Steps: 64 | Train Loss: 0.0857929 Vali Loss: 0.1595448 Test Loss: 0.1502420
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 51 cost time: 0.9274158477783203
Epoch: 51, Steps: 64 | Train Loss: 0.0857374 Vali Loss: 0.1599338 Test Loss: 0.1493994
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 52 cost time: 0.9394924640655518
Epoch: 52, Steps: 64 | Train Loss: 0.0861465 Vali Loss: 0.1589723 Test Loss: 0.1492714
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 53 cost time: 0.9284355640411377
Epoch: 53, Steps: 64 | Train Loss: 0.0858008 Vali Loss: 0.1606047 Test Loss: 0.1496976
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 54 cost time: 0.9104213714599609
Epoch: 54, Steps: 64 | Train Loss: 0.0855692 Vali Loss: 0.1590455 Test Loss: 0.1490417
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 55 cost time: 0.9337279796600342
Epoch: 55, Steps: 64 | Train Loss: 0.0858910 Vali Loss: 0.1601525 Test Loss: 0.1495859
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 56 cost time: 0.9417557716369629
Epoch: 56, Steps: 64 | Train Loss: 0.0860120 Vali Loss: 0.1605650 Test Loss: 0.1496417
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 57 cost time: 0.9316353797912598
Epoch: 57, Steps: 64 | Train Loss: 0.0856243 Vali Loss: 0.1591751 Test Loss: 0.1493830
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 58 cost time: 0.9436440467834473
Epoch: 58, Steps: 64 | Train Loss: 0.0857335 Vali Loss: 0.1605566 Test Loss: 0.1492150
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 59 cost time: 0.9496467113494873
Epoch: 59, Steps: 64 | Train Loss: 0.0855842 Vali Loss: 0.1593682 Test Loss: 0.1493838
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019365310668945312 GB
GPU已分配内存的峰值：0.05435895919799805 GB
Epoch: 60 cost time: 0.9483547210693359
Epoch: 60, Steps: 64 | Train Loss: 0.0859278 Vali Loss: 0.1594103 Test Loss: 0.1496661
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1492539495229721, mae:0.2942342460155487, rse:0.20562878251075745
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.057431697845458984 GB
Epoch: 1 cost time: 2.350008249282837
Epoch: 1, Steps: 64 | Train Loss: 0.7622268 Vali Loss: 1.7757690 Test Loss: 3.4070823
Validation loss decreased (inf --> 1.775769).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 2 cost time: 0.9576437473297119
Epoch: 2, Steps: 64 | Train Loss: 0.3894267 Vali Loss: 0.1751038 Test Loss: 0.1705272
Validation loss decreased (1.775769 --> 0.175104).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 3 cost time: 0.9614126682281494
Epoch: 3, Steps: 64 | Train Loss: 0.1173857 Vali Loss: 0.1929629 Test Loss: 0.1839638
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 4 cost time: 0.9579918384552002
Epoch: 4, Steps: 64 | Train Loss: 0.1044460 Vali Loss: 0.1669124 Test Loss: 0.1496926
Validation loss decreased (0.175104 --> 0.166912).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 5 cost time: 0.9444079399108887
Epoch: 5, Steps: 64 | Train Loss: 0.1013263 Vali Loss: 0.1644646 Test Loss: 0.1485239
Validation loss decreased (0.166912 --> 0.164465).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 6 cost time: 0.9277000427246094
Epoch: 6, Steps: 64 | Train Loss: 0.0990487 Vali Loss: 0.1631449 Test Loss: 0.1475513
Validation loss decreased (0.164465 --> 0.163145).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 7 cost time: 0.9354190826416016
Epoch: 7, Steps: 64 | Train Loss: 0.0964104 Vali Loss: 0.1593995 Test Loss: 0.1455756
Validation loss decreased (0.163145 --> 0.159400).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 8 cost time: 0.9514884948730469
Epoch: 8, Steps: 64 | Train Loss: 0.0955205 Vali Loss: 0.1609286 Test Loss: 0.1460509
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 9 cost time: 0.962822437286377
Epoch: 9, Steps: 64 | Train Loss: 0.0933615 Vali Loss: 0.1628519 Test Loss: 0.1459308
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 10 cost time: 0.9621415138244629
Epoch: 10, Steps: 64 | Train Loss: 0.0930950 Vali Loss: 0.1589603 Test Loss: 0.1456926
Validation loss decreased (0.159400 --> 0.158960).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 11 cost time: 0.9730021953582764
Epoch: 11, Steps: 64 | Train Loss: 0.0923193 Vali Loss: 0.1577913 Test Loss: 0.1461623
Validation loss decreased (0.158960 --> 0.157791).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 12 cost time: 0.9709997177124023
Epoch: 12, Steps: 64 | Train Loss: 0.0913840 Vali Loss: 0.1608163 Test Loss: 0.1461006
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 13 cost time: 0.9556534290313721
Epoch: 13, Steps: 64 | Train Loss: 0.0914634 Vali Loss: 0.1595158 Test Loss: 0.1450438
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 14 cost time: 0.9503648281097412
Epoch: 14, Steps: 64 | Train Loss: 0.0911235 Vali Loss: 0.1618237 Test Loss: 0.1457514
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 15 cost time: 0.9544389247894287
Epoch: 15, Steps: 64 | Train Loss: 0.0900993 Vali Loss: 0.1581588 Test Loss: 0.1459559
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 16 cost time: 0.9533998966217041
Epoch: 16, Steps: 64 | Train Loss: 0.0897690 Vali Loss: 0.1577878 Test Loss: 0.1457959
Validation loss decreased (0.157791 --> 0.157788).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 17 cost time: 0.9703912734985352
Epoch: 17, Steps: 64 | Train Loss: 0.0892831 Vali Loss: 0.1586310 Test Loss: 0.1455381
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 18 cost time: 0.973182201385498
Epoch: 18, Steps: 64 | Train Loss: 0.0888844 Vali Loss: 0.1591173 Test Loss: 0.1461876
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 19 cost time: 0.9684529304504395
Epoch: 19, Steps: 64 | Train Loss: 0.0886873 Vali Loss: 0.1598602 Test Loss: 0.1462477
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 20 cost time: 0.968442440032959
Epoch: 20, Steps: 64 | Train Loss: 0.0881578 Vali Loss: 0.1583727 Test Loss: 0.1460884
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 21 cost time: 0.9663560390472412
Epoch: 21, Steps: 64 | Train Loss: 0.0881982 Vali Loss: 0.1572270 Test Loss: 0.1459272
Validation loss decreased (0.157788 --> 0.157227).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 22 cost time: 0.9752082824707031
Epoch: 22, Steps: 64 | Train Loss: 0.0874919 Vali Loss: 0.1590696 Test Loss: 0.1462095
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 23 cost time: 0.9600017070770264
Epoch: 23, Steps: 64 | Train Loss: 0.0876354 Vali Loss: 0.1590098 Test Loss: 0.1463393
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 24 cost time: 0.979637622833252
Epoch: 24, Steps: 64 | Train Loss: 0.0875314 Vali Loss: 0.1580797 Test Loss: 0.1463224
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 25 cost time: 0.9596388339996338
Epoch: 25, Steps: 64 | Train Loss: 0.0872172 Vali Loss: 0.1587285 Test Loss: 0.1471401
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 26 cost time: 0.9574754238128662
Epoch: 26, Steps: 64 | Train Loss: 0.0872357 Vali Loss: 0.1579170 Test Loss: 0.1465716
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 27 cost time: 0.9563963413238525
Epoch: 27, Steps: 64 | Train Loss: 0.0869174 Vali Loss: 0.1563092 Test Loss: 0.1463936
Validation loss decreased (0.157227 --> 0.156309).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 28 cost time: 0.9524631500244141
Epoch: 28, Steps: 64 | Train Loss: 0.0868776 Vali Loss: 0.1594556 Test Loss: 0.1471860
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 29 cost time: 0.9313664436340332
Epoch: 29, Steps: 64 | Train Loss: 0.0869917 Vali Loss: 0.1589355 Test Loss: 0.1466415
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 30 cost time: 0.9421284198760986
Epoch: 30, Steps: 64 | Train Loss: 0.0868533 Vali Loss: 0.1580447 Test Loss: 0.1472380
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 31 cost time: 0.9404697418212891
Epoch: 31, Steps: 64 | Train Loss: 0.0872624 Vali Loss: 0.1589107 Test Loss: 0.1469360
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 32 cost time: 0.9480223655700684
Epoch: 32, Steps: 64 | Train Loss: 0.0870258 Vali Loss: 0.1586818 Test Loss: 0.1468726
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 33 cost time: 0.967634916305542
Epoch: 33, Steps: 64 | Train Loss: 0.0865892 Vali Loss: 0.1575930 Test Loss: 0.1473982
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 34 cost time: 0.9819989204406738
Epoch: 34, Steps: 64 | Train Loss: 0.0863566 Vali Loss: 0.1569740 Test Loss: 0.1477445
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 35 cost time: 0.974642276763916
Epoch: 35, Steps: 64 | Train Loss: 0.0863884 Vali Loss: 0.1591901 Test Loss: 0.1479159
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 36 cost time: 0.9626455307006836
Epoch: 36, Steps: 64 | Train Loss: 0.0861879 Vali Loss: 0.1589432 Test Loss: 0.1480094
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 37 cost time: 0.9476327896118164
Epoch: 37, Steps: 64 | Train Loss: 0.0865146 Vali Loss: 0.1576483 Test Loss: 0.1475385
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 38 cost time: 0.9513969421386719
Epoch: 38, Steps: 64 | Train Loss: 0.0859995 Vali Loss: 0.1579132 Test Loss: 0.1467936
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 39 cost time: 0.9599990844726562
Epoch: 39, Steps: 64 | Train Loss: 0.0863083 Vali Loss: 0.1572026 Test Loss: 0.1472457
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 40 cost time: 0.9584074020385742
Epoch: 40, Steps: 64 | Train Loss: 0.0860730 Vali Loss: 0.1582560 Test Loss: 0.1470702
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 41 cost time: 0.9657623767852783
Epoch: 41, Steps: 64 | Train Loss: 0.0861243 Vali Loss: 0.1587580 Test Loss: 0.1468760
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 42 cost time: 0.9740698337554932
Epoch: 42, Steps: 64 | Train Loss: 0.0865146 Vali Loss: 0.1588245 Test Loss: 0.1471258
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 43 cost time: 0.9523828029632568
Epoch: 43, Steps: 64 | Train Loss: 0.0862992 Vali Loss: 0.1581654 Test Loss: 0.1468854
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 44 cost time: 0.9517860412597656
Epoch: 44, Steps: 64 | Train Loss: 0.0863820 Vali Loss: 0.1582013 Test Loss: 0.1470978
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 45 cost time: 0.939000129699707
Epoch: 45, Steps: 64 | Train Loss: 0.0861244 Vali Loss: 0.1599812 Test Loss: 0.1476444
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 46 cost time: 0.9416353702545166
Epoch: 46, Steps: 64 | Train Loss: 0.0861437 Vali Loss: 0.1581801 Test Loss: 0.1480884
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 47 cost time: 0.94063401222229
Epoch: 47, Steps: 64 | Train Loss: 0.0862755 Vali Loss: 0.1583986 Test Loss: 0.1478206
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 48 cost time: 0.9403607845306396
Epoch: 48, Steps: 64 | Train Loss: 0.0860179 Vali Loss: 0.1584636 Test Loss: 0.1471240
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 49 cost time: 0.9623434543609619
Epoch: 49, Steps: 64 | Train Loss: 0.0854985 Vali Loss: 0.1599347 Test Loss: 0.1476209
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 50 cost time: 0.9583907127380371
Epoch: 50, Steps: 64 | Train Loss: 0.0864966 Vali Loss: 0.1593840 Test Loss: 0.1470344
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 51 cost time: 0.9330365657806396
Epoch: 51, Steps: 64 | Train Loss: 0.0862429 Vali Loss: 0.1592158 Test Loss: 0.1482054
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 52 cost time: 0.9453995227813721
Epoch: 52, Steps: 64 | Train Loss: 0.0861509 Vali Loss: 0.1581931 Test Loss: 0.1477403
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 53 cost time: 0.9406914710998535
Epoch: 53, Steps: 64 | Train Loss: 0.0856457 Vali Loss: 0.1583548 Test Loss: 0.1480019
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 54 cost time: 0.9587702751159668
Epoch: 54, Steps: 64 | Train Loss: 0.0861692 Vali Loss: 0.1573563 Test Loss: 0.1472806
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 55 cost time: 0.9543411731719971
Epoch: 55, Steps: 64 | Train Loss: 0.0855848 Vali Loss: 0.1593951 Test Loss: 0.1471787
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 56 cost time: 0.9694979190826416
Epoch: 56, Steps: 64 | Train Loss: 0.0861657 Vali Loss: 0.1580191 Test Loss: 0.1485664
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 57 cost time: 0.9716331958770752
Epoch: 57, Steps: 64 | Train Loss: 0.0859030 Vali Loss: 0.1583673 Test Loss: 0.1475163
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 58 cost time: 0.9784095287322998
Epoch: 58, Steps: 64 | Train Loss: 0.0860823 Vali Loss: 0.1568432 Test Loss: 0.1473592
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 59 cost time: 0.9723939895629883
Epoch: 59, Steps: 64 | Train Loss: 0.0860082 Vali Loss: 0.1591619 Test Loss: 0.1472758
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020235061645507812 GB
GPU已分配内存的峰值：0.05965375900268555 GB
Epoch: 60 cost time: 0.9623823165893555
Epoch: 60, Steps: 64 | Train Loss: 0.0860798 Vali Loss: 0.1592443 Test Loss: 0.1481487
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1463935673236847, mae:0.28985461592674255, rse:0.2036488652229309
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.057007789611816406 GB
Epoch: 1 cost time: 2.2650363445281982
Epoch: 1, Steps: 64 | Train Loss: 0.8664390 Vali Loss: 1.9142258 Test Loss: 3.6225071
Validation loss decreased (inf --> 1.914226).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 2 cost time: 0.872511625289917
Epoch: 2, Steps: 64 | Train Loss: 0.7084362 Vali Loss: 1.3056233 Test Loss: 2.3688705
Validation loss decreased (1.914226 --> 1.305623).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 3 cost time: 0.8733761310577393
Epoch: 3, Steps: 64 | Train Loss: 0.5229584 Vali Loss: 1.0078371 Test Loss: 1.7643678
Validation loss decreased (1.305623 --> 1.007837).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 4 cost time: 0.8863468170166016
Epoch: 4, Steps: 64 | Train Loss: 0.4050112 Vali Loss: 0.8016965 Test Loss: 1.3395340
Validation loss decreased (1.007837 --> 0.801696).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 5 cost time: 0.86100172996521
Epoch: 5, Steps: 64 | Train Loss: 0.3189487 Vali Loss: 0.6330495 Test Loss: 1.0150267
Validation loss decreased (0.801696 --> 0.633049).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 6 cost time: 0.8556416034698486
Epoch: 6, Steps: 64 | Train Loss: 0.2568996 Vali Loss: 0.5228669 Test Loss: 0.7931426
Validation loss decreased (0.633049 --> 0.522867).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 7 cost time: 0.8595104217529297
Epoch: 7, Steps: 64 | Train Loss: 0.2157840 Vali Loss: 0.4376224 Test Loss: 0.6250601
Validation loss decreased (0.522867 --> 0.437622).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 8 cost time: 0.8603930473327637
Epoch: 8, Steps: 64 | Train Loss: 0.1859448 Vali Loss: 0.3837664 Test Loss: 0.5223653
Validation loss decreased (0.437622 --> 0.383766).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 9 cost time: 0.8560636043548584
Epoch: 9, Steps: 64 | Train Loss: 0.1662637 Vali Loss: 0.3357787 Test Loss: 0.4383216
Validation loss decreased (0.383766 --> 0.335779).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 10 cost time: 0.8767759799957275
Epoch: 10, Steps: 64 | Train Loss: 0.1519507 Vali Loss: 0.3047240 Test Loss: 0.3800512
Validation loss decreased (0.335779 --> 0.304724).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 11 cost time: 0.8799989223480225
Epoch: 11, Steps: 64 | Train Loss: 0.1410759 Vali Loss: 0.2797255 Test Loss: 0.3324449
Validation loss decreased (0.304724 --> 0.279725).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 12 cost time: 0.8866405487060547
Epoch: 12, Steps: 64 | Train Loss: 0.1336162 Vali Loss: 0.2632093 Test Loss: 0.2997911
Validation loss decreased (0.279725 --> 0.263209).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 13 cost time: 0.8880462646484375
Epoch: 13, Steps: 64 | Train Loss: 0.1278126 Vali Loss: 0.2489484 Test Loss: 0.2762902
Validation loss decreased (0.263209 --> 0.248948).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 14 cost time: 0.8804349899291992
Epoch: 14, Steps: 64 | Train Loss: 0.1230461 Vali Loss: 0.2379723 Test Loss: 0.2593368
Validation loss decreased (0.248948 --> 0.237972).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 15 cost time: 0.8844077587127686
Epoch: 15, Steps: 64 | Train Loss: 0.1193055 Vali Loss: 0.2276897 Test Loss: 0.2432956
Validation loss decreased (0.237972 --> 0.227690).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 16 cost time: 0.867760181427002
Epoch: 16, Steps: 64 | Train Loss: 0.1163914 Vali Loss: 0.2212426 Test Loss: 0.2333801
Validation loss decreased (0.227690 --> 0.221243).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 17 cost time: 0.8687155246734619
Epoch: 17, Steps: 64 | Train Loss: 0.1145660 Vali Loss: 0.2178734 Test Loss: 0.2217088
Validation loss decreased (0.221243 --> 0.217873).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 18 cost time: 0.8636517524719238
Epoch: 18, Steps: 64 | Train Loss: 0.1128523 Vali Loss: 0.2123034 Test Loss: 0.2162151
Validation loss decreased (0.217873 --> 0.212303).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 19 cost time: 0.889721155166626
Epoch: 19, Steps: 64 | Train Loss: 0.1110580 Vali Loss: 0.2080502 Test Loss: 0.2099750
Validation loss decreased (0.212303 --> 0.208050).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 20 cost time: 0.8814363479614258
Epoch: 20, Steps: 64 | Train Loss: 0.1093879 Vali Loss: 0.2060585 Test Loss: 0.2074864
Validation loss decreased (0.208050 --> 0.206059).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 21 cost time: 0.887465238571167
Epoch: 21, Steps: 64 | Train Loss: 0.1081240 Vali Loss: 0.2024619 Test Loss: 0.2005766
Validation loss decreased (0.206059 --> 0.202462).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 22 cost time: 0.8972773551940918
Epoch: 22, Steps: 64 | Train Loss: 0.1080497 Vali Loss: 0.2014778 Test Loss: 0.1993203
Validation loss decreased (0.202462 --> 0.201478).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 23 cost time: 0.8809998035430908
Epoch: 23, Steps: 64 | Train Loss: 0.1070863 Vali Loss: 0.2000869 Test Loss: 0.1977034
Validation loss decreased (0.201478 --> 0.200087).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 24 cost time: 0.8826396465301514
Epoch: 24, Steps: 64 | Train Loss: 0.1066292 Vali Loss: 0.1952032 Test Loss: 0.1929496
Validation loss decreased (0.200087 --> 0.195203).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 25 cost time: 0.8814408779144287
Epoch: 25, Steps: 64 | Train Loss: 0.1063859 Vali Loss: 0.1955582 Test Loss: 0.1904912
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 26 cost time: 0.856478214263916
Epoch: 26, Steps: 64 | Train Loss: 0.1054216 Vali Loss: 0.1949468 Test Loss: 0.1900764
Validation loss decreased (0.195203 --> 0.194947).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 27 cost time: 0.8477931022644043
Epoch: 27, Steps: 64 | Train Loss: 0.1050054 Vali Loss: 0.1919960 Test Loss: 0.1868719
Validation loss decreased (0.194947 --> 0.191996).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 28 cost time: 0.8643310070037842
Epoch: 28, Steps: 64 | Train Loss: 0.1041722 Vali Loss: 0.1926823 Test Loss: 0.1876068
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 29 cost time: 0.8726177215576172
Epoch: 29, Steps: 64 | Train Loss: 0.1042617 Vali Loss: 0.1917315 Test Loss: 0.1876708
Validation loss decreased (0.191996 --> 0.191731).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 30 cost time: 0.880389928817749
Epoch: 30, Steps: 64 | Train Loss: 0.1041265 Vali Loss: 0.1910435 Test Loss: 0.1843961
Validation loss decreased (0.191731 --> 0.191044).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 31 cost time: 0.8874478340148926
Epoch: 31, Steps: 64 | Train Loss: 0.1036871 Vali Loss: 0.1921816 Test Loss: 0.1844611
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 32 cost time: 0.8774168491363525
Epoch: 32, Steps: 64 | Train Loss: 0.1031642 Vali Loss: 0.1886785 Test Loss: 0.1831311
Validation loss decreased (0.191044 --> 0.188679).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 33 cost time: 0.8717737197875977
Epoch: 33, Steps: 64 | Train Loss: 0.1034653 Vali Loss: 0.1886363 Test Loss: 0.1823371
Validation loss decreased (0.188679 --> 0.188636).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 34 cost time: 0.8689992427825928
Epoch: 34, Steps: 64 | Train Loss: 0.1031619 Vali Loss: 0.1887141 Test Loss: 0.1825774
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 35 cost time: 0.8656270503997803
Epoch: 35, Steps: 64 | Train Loss: 0.1031604 Vali Loss: 0.1885598 Test Loss: 0.1823625
Validation loss decreased (0.188636 --> 0.188560).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 36 cost time: 0.8743789196014404
Epoch: 36, Steps: 64 | Train Loss: 0.1033893 Vali Loss: 0.1869909 Test Loss: 0.1796943
Validation loss decreased (0.188560 --> 0.186991).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 37 cost time: 0.88735032081604
Epoch: 37, Steps: 64 | Train Loss: 0.1023718 Vali Loss: 0.1876783 Test Loss: 0.1813454
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 38 cost time: 0.8898963928222656
Epoch: 38, Steps: 64 | Train Loss: 0.1016936 Vali Loss: 0.1875670 Test Loss: 0.1808845
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 39 cost time: 0.8847837448120117
Epoch: 39, Steps: 64 | Train Loss: 0.1025070 Vali Loss: 0.1891005 Test Loss: 0.1793028
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 40 cost time: 0.8949997425079346
Epoch: 40, Steps: 64 | Train Loss: 0.1015913 Vali Loss: 0.1869145 Test Loss: 0.1793202
Validation loss decreased (0.186991 --> 0.186915).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 41 cost time: 0.8856334686279297
Epoch: 41, Steps: 64 | Train Loss: 0.1018773 Vali Loss: 0.1853987 Test Loss: 0.1776211
Validation loss decreased (0.186915 --> 0.185399).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 42 cost time: 0.8851368427276611
Epoch: 42, Steps: 64 | Train Loss: 0.1015631 Vali Loss: 0.1856698 Test Loss: 0.1795035
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 43 cost time: 0.8734285831451416
Epoch: 43, Steps: 64 | Train Loss: 0.1016641 Vali Loss: 0.1860153 Test Loss: 0.1784595
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 44 cost time: 0.8784527778625488
Epoch: 44, Steps: 64 | Train Loss: 0.1018703 Vali Loss: 0.1873798 Test Loss: 0.1782735
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 45 cost time: 0.8447880744934082
Epoch: 45, Steps: 64 | Train Loss: 0.1021427 Vali Loss: 0.1879835 Test Loss: 0.1778697
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 46 cost time: 0.8606421947479248
Epoch: 46, Steps: 64 | Train Loss: 0.1014259 Vali Loss: 0.1870654 Test Loss: 0.1789290
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 47 cost time: 0.8683867454528809
Epoch: 47, Steps: 64 | Train Loss: 0.1017272 Vali Loss: 0.1854639 Test Loss: 0.1778726
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 48 cost time: 0.866511344909668
Epoch: 48, Steps: 64 | Train Loss: 0.1011862 Vali Loss: 0.1837405 Test Loss: 0.1770265
Validation loss decreased (0.185399 --> 0.183740).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 49 cost time: 0.8633990287780762
Epoch: 49, Steps: 64 | Train Loss: 0.1013877 Vali Loss: 0.1861426 Test Loss: 0.1774020
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 50 cost time: 0.850106954574585
Epoch: 50, Steps: 64 | Train Loss: 0.1014517 Vali Loss: 0.1852289 Test Loss: 0.1771961
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 51 cost time: 0.8489980697631836
Epoch: 51, Steps: 64 | Train Loss: 0.1010922 Vali Loss: 0.1848017 Test Loss: 0.1773607
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 52 cost time: 0.8463943004608154
Epoch: 52, Steps: 64 | Train Loss: 0.1021130 Vali Loss: 0.1836255 Test Loss: 0.1765411
Validation loss decreased (0.183740 --> 0.183626).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 53 cost time: 0.8484363555908203
Epoch: 53, Steps: 64 | Train Loss: 0.1018328 Vali Loss: 0.1862157 Test Loss: 0.1781065
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 54 cost time: 0.8454194068908691
Epoch: 54, Steps: 64 | Train Loss: 0.1019378 Vali Loss: 0.1860984 Test Loss: 0.1774437
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 55 cost time: 0.8867440223693848
Epoch: 55, Steps: 64 | Train Loss: 0.1014888 Vali Loss: 0.1865611 Test Loss: 0.1788513
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 56 cost time: 0.8800003528594971
Epoch: 56, Steps: 64 | Train Loss: 0.1011750 Vali Loss: 0.1837654 Test Loss: 0.1762526
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 57 cost time: 0.8805088996887207
Epoch: 57, Steps: 64 | Train Loss: 0.1016838 Vali Loss: 0.1865384 Test Loss: 0.1772940
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 58 cost time: 0.8854739665985107
Epoch: 58, Steps: 64 | Train Loss: 0.1011511 Vali Loss: 0.1843615 Test Loss: 0.1763710
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 59 cost time: 0.8864126205444336
Epoch: 59, Steps: 64 | Train Loss: 0.1005742 Vali Loss: 0.1849865 Test Loss: 0.1768918
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018245697021484375 GB
GPU已分配内存的峰值：0.05866241455078125 GB
Epoch: 60 cost time: 0.8709104061126709
Epoch: 60, Steps: 64 | Train Loss: 0.1007147 Vali Loss: 0.1847661 Test Loss: 0.1763818
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.17654113471508026, mae:0.33143916726112366, rse:0.2236371487379074
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.060153961181640625 GB
Epoch: 1 cost time: 2.291116952896118
Epoch: 1, Steps: 64 | Train Loss: 0.7525477 Vali Loss: 1.7211092 Test Loss: 3.2709339
Validation loss decreased (inf --> 1.721109).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 2 cost time: 0.9123685359954834
Epoch: 2, Steps: 64 | Train Loss: 0.4662177 Vali Loss: 0.4487660 Test Loss: 0.6805547
Validation loss decreased (1.721109 --> 0.448766).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 3 cost time: 0.8960025310516357
Epoch: 3, Steps: 64 | Train Loss: 0.1467850 Vali Loss: 0.1887674 Test Loss: 0.1569162
Validation loss decreased (0.448766 --> 0.188767).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 4 cost time: 0.8940768241882324
Epoch: 4, Steps: 64 | Train Loss: 0.1131767 Vali Loss: 0.1880979 Test Loss: 0.1598159
Validation loss decreased (0.188767 --> 0.188098).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 5 cost time: 0.8716304302215576
Epoch: 5, Steps: 64 | Train Loss: 0.1076742 Vali Loss: 0.1836189 Test Loss: 0.1570032
Validation loss decreased (0.188098 --> 0.183619).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 6 cost time: 0.9034173488616943
Epoch: 6, Steps: 64 | Train Loss: 0.1043808 Vali Loss: 0.1814627 Test Loss: 0.1572849
Validation loss decreased (0.183619 --> 0.181463).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 7 cost time: 0.90537428855896
Epoch: 7, Steps: 64 | Train Loss: 0.1012539 Vali Loss: 0.1770963 Test Loss: 0.1564405
Validation loss decreased (0.181463 --> 0.177096).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 8 cost time: 0.9123871326446533
Epoch: 8, Steps: 64 | Train Loss: 0.0995624 Vali Loss: 0.1759142 Test Loss: 0.1527578
Validation loss decreased (0.177096 --> 0.175914).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 9 cost time: 0.9024143218994141
Epoch: 9, Steps: 64 | Train Loss: 0.0977147 Vali Loss: 0.1720550 Test Loss: 0.1519647
Validation loss decreased (0.175914 --> 0.172055).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 10 cost time: 0.8940010070800781
Epoch: 10, Steps: 64 | Train Loss: 0.0960765 Vali Loss: 0.1715458 Test Loss: 0.1536830
Validation loss decreased (0.172055 --> 0.171546).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 11 cost time: 0.8970003128051758
Epoch: 11, Steps: 64 | Train Loss: 0.0949447 Vali Loss: 0.1705083 Test Loss: 0.1520531
Validation loss decreased (0.171546 --> 0.170508).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 12 cost time: 0.9246389865875244
Epoch: 12, Steps: 64 | Train Loss: 0.0937416 Vali Loss: 0.1692878 Test Loss: 0.1520282
Validation loss decreased (0.170508 --> 0.169288).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 13 cost time: 0.9156103134155273
Epoch: 13, Steps: 64 | Train Loss: 0.0929552 Vali Loss: 0.1681156 Test Loss: 0.1526562
Validation loss decreased (0.169288 --> 0.168116).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 14 cost time: 0.9073669910430908
Epoch: 14, Steps: 64 | Train Loss: 0.0920643 Vali Loss: 0.1678103 Test Loss: 0.1524252
Validation loss decreased (0.168116 --> 0.167810).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 15 cost time: 0.9103844165802002
Epoch: 15, Steps: 64 | Train Loss: 0.0917023 Vali Loss: 0.1682395 Test Loss: 0.1522958
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 16 cost time: 0.9120497703552246
Epoch: 16, Steps: 64 | Train Loss: 0.0906573 Vali Loss: 0.1649017 Test Loss: 0.1527708
Validation loss decreased (0.167810 --> 0.164902).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 17 cost time: 0.8977429866790771
Epoch: 17, Steps: 64 | Train Loss: 0.0904410 Vali Loss: 0.1646484 Test Loss: 0.1533120
Validation loss decreased (0.164902 --> 0.164648).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 18 cost time: 0.9079995155334473
Epoch: 18, Steps: 64 | Train Loss: 0.0900100 Vali Loss: 0.1661600 Test Loss: 0.1537527
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 19 cost time: 0.9176251888275146
Epoch: 19, Steps: 64 | Train Loss: 0.0896824 Vali Loss: 0.1671942 Test Loss: 0.1533871
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 20 cost time: 0.9113597869873047
Epoch: 20, Steps: 64 | Train Loss: 0.0891666 Vali Loss: 0.1658620 Test Loss: 0.1541619
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 21 cost time: 0.9103903770446777
Epoch: 21, Steps: 64 | Train Loss: 0.0884675 Vali Loss: 0.1648344 Test Loss: 0.1529467
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 22 cost time: 0.8973970413208008
Epoch: 22, Steps: 64 | Train Loss: 0.0880453 Vali Loss: 0.1659697 Test Loss: 0.1539985
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 23 cost time: 0.8928377628326416
Epoch: 23, Steps: 64 | Train Loss: 0.0881019 Vali Loss: 0.1655482 Test Loss: 0.1547059
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 24 cost time: 0.867999792098999
Epoch: 24, Steps: 64 | Train Loss: 0.0877375 Vali Loss: 0.1635796 Test Loss: 0.1540765
Validation loss decreased (0.164648 --> 0.163580).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 25 cost time: 0.8716380596160889
Epoch: 25, Steps: 64 | Train Loss: 0.0875882 Vali Loss: 0.1621904 Test Loss: 0.1552969
Validation loss decreased (0.163580 --> 0.162190).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 26 cost time: 0.8745050430297852
Epoch: 26, Steps: 64 | Train Loss: 0.0869094 Vali Loss: 0.1640074 Test Loss: 0.1547284
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 27 cost time: 0.8904633522033691
Epoch: 27, Steps: 64 | Train Loss: 0.0875133 Vali Loss: 0.1638535 Test Loss: 0.1556186
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 28 cost time: 0.8944301605224609
Epoch: 28, Steps: 64 | Train Loss: 0.0870474 Vali Loss: 0.1643445 Test Loss: 0.1558836
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 29 cost time: 0.885737419128418
Epoch: 29, Steps: 64 | Train Loss: 0.0863154 Vali Loss: 0.1645635 Test Loss: 0.1555554
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 30 cost time: 0.8990004062652588
Epoch: 30, Steps: 64 | Train Loss: 0.0864189 Vali Loss: 0.1621080 Test Loss: 0.1558816
Validation loss decreased (0.162190 --> 0.162108).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 31 cost time: 0.8650078773498535
Epoch: 31, Steps: 64 | Train Loss: 0.0866655 Vali Loss: 0.1644192 Test Loss: 0.1560802
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 32 cost time: 0.9034223556518555
Epoch: 32, Steps: 64 | Train Loss: 0.0860324 Vali Loss: 0.1643969 Test Loss: 0.1561114
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 33 cost time: 0.9063854217529297
Epoch: 33, Steps: 64 | Train Loss: 0.0863518 Vali Loss: 0.1631009 Test Loss: 0.1563252
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 34 cost time: 0.9042229652404785
Epoch: 34, Steps: 64 | Train Loss: 0.0861674 Vali Loss: 0.1647420 Test Loss: 0.1572371
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 35 cost time: 0.9103608131408691
Epoch: 35, Steps: 64 | Train Loss: 0.0859371 Vali Loss: 0.1654337 Test Loss: 0.1571011
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 36 cost time: 0.9037675857543945
Epoch: 36, Steps: 64 | Train Loss: 0.0856830 Vali Loss: 0.1635819 Test Loss: 0.1574257
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 37 cost time: 0.9786858558654785
Epoch: 37, Steps: 64 | Train Loss: 0.0859375 Vali Loss: 0.1655128 Test Loss: 0.1564801
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 38 cost time: 0.9286401271820068
Epoch: 38, Steps: 64 | Train Loss: 0.0859415 Vali Loss: 0.1637617 Test Loss: 0.1569724
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 39 cost time: 0.9274897575378418
Epoch: 39, Steps: 64 | Train Loss: 0.0852679 Vali Loss: 0.1627728 Test Loss: 0.1571973
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 40 cost time: 0.9066011905670166
Epoch: 40, Steps: 64 | Train Loss: 0.0852826 Vali Loss: 0.1639431 Test Loss: 0.1573878
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 41 cost time: 0.9015095233917236
Epoch: 41, Steps: 64 | Train Loss: 0.0860560 Vali Loss: 0.1646319 Test Loss: 0.1578760
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 42 cost time: 0.910269021987915
Epoch: 42, Steps: 64 | Train Loss: 0.0853229 Vali Loss: 0.1642713 Test Loss: 0.1573316
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 43 cost time: 0.9482917785644531
Epoch: 43, Steps: 64 | Train Loss: 0.0856703 Vali Loss: 0.1645836 Test Loss: 0.1577144
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 44 cost time: 0.9270873069763184
Epoch: 44, Steps: 64 | Train Loss: 0.0851545 Vali Loss: 0.1618827 Test Loss: 0.1568344
Validation loss decreased (0.162108 --> 0.161883).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 45 cost time: 0.8970000743865967
Epoch: 45, Steps: 64 | Train Loss: 0.0856703 Vali Loss: 0.1639234 Test Loss: 0.1572593
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 46 cost time: 0.8896298408508301
Epoch: 46, Steps: 64 | Train Loss: 0.0855276 Vali Loss: 0.1633740 Test Loss: 0.1575156
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 47 cost time: 0.8894627094268799
Epoch: 47, Steps: 64 | Train Loss: 0.0854603 Vali Loss: 0.1625664 Test Loss: 0.1577930
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 48 cost time: 0.8803949356079102
Epoch: 48, Steps: 64 | Train Loss: 0.0854439 Vali Loss: 0.1629437 Test Loss: 0.1575142
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 49 cost time: 0.8790514469146729
Epoch: 49, Steps: 64 | Train Loss: 0.0851059 Vali Loss: 0.1641072 Test Loss: 0.1580789
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 50 cost time: 0.8710005283355713
Epoch: 50, Steps: 64 | Train Loss: 0.0851980 Vali Loss: 0.1629160 Test Loss: 0.1576495
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 51 cost time: 0.8800005912780762
Epoch: 51, Steps: 64 | Train Loss: 0.0851231 Vali Loss: 0.1622744 Test Loss: 0.1574090
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 52 cost time: 0.8836381435394287
Epoch: 52, Steps: 64 | Train Loss: 0.0853285 Vali Loss: 0.1641607 Test Loss: 0.1572351
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 53 cost time: 0.8887648582458496
Epoch: 53, Steps: 64 | Train Loss: 0.0855886 Vali Loss: 0.1643522 Test Loss: 0.1583451
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 54 cost time: 0.8940451145172119
Epoch: 54, Steps: 64 | Train Loss: 0.0847414 Vali Loss: 0.1641714 Test Loss: 0.1582217
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 55 cost time: 0.9146480560302734
Epoch: 55, Steps: 64 | Train Loss: 0.0849301 Vali Loss: 0.1624512 Test Loss: 0.1583266
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 56 cost time: 0.9067590236663818
Epoch: 56, Steps: 64 | Train Loss: 0.0851752 Vali Loss: 0.1653926 Test Loss: 0.1579237
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 57 cost time: 0.8889997005462646
Epoch: 57, Steps: 64 | Train Loss: 0.0855492 Vali Loss: 0.1624025 Test Loss: 0.1582088
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 58 cost time: 0.8984136581420898
Epoch: 58, Steps: 64 | Train Loss: 0.0853837 Vali Loss: 0.1631956 Test Loss: 0.1582749
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 59 cost time: 0.8903980255126953
Epoch: 59, Steps: 64 | Train Loss: 0.0847775 Vali Loss: 0.1653645 Test Loss: 0.1585391
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019535064697265625 GB
GPU已分配内存的峰值：0.061751365661621094 GB
Epoch: 60 cost time: 0.8897998332977295
Epoch: 60, Steps: 64 | Train Loss: 0.0851645 Vali Loss: 0.1653202 Test Loss: 0.1575077
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1568344533443451, mae:0.3052125871181488, rse:0.21078597009181976
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06334877014160156 GB
Epoch: 1 cost time: 2.3393030166625977
Epoch: 1, Steps: 64 | Train Loss: 0.7600078 Vali Loss: 1.7625425 Test Loss: 3.3591330
Validation loss decreased (inf --> 1.762542).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 2 cost time: 0.9204130172729492
Epoch: 2, Steps: 64 | Train Loss: 0.3982955 Vali Loss: 0.1873709 Test Loss: 0.1634435
Validation loss decreased (1.762542 --> 0.187371).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 3 cost time: 0.9171352386474609
Epoch: 3, Steps: 64 | Train Loss: 0.1231689 Vali Loss: 0.1996124 Test Loss: 0.1803771
EarlyStopping counter: 1 out of 100
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 4 cost time: 0.9119906425476074
Epoch: 4, Steps: 64 | Train Loss: 0.1090125 Vali Loss: 0.1795195 Test Loss: 0.1534947
Validation loss decreased (0.187371 --> 0.179520).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 5 cost time: 0.9052779674530029
Epoch: 5, Steps: 64 | Train Loss: 0.1042660 Vali Loss: 0.1770998 Test Loss: 0.1536607
Validation loss decreased (0.179520 --> 0.177100).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 6 cost time: 0.9339981079101562
Epoch: 6, Steps: 64 | Train Loss: 0.1006878 Vali Loss: 0.1733241 Test Loss: 0.1522883
Validation loss decreased (0.177100 --> 0.173324).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 7 cost time: 0.9340002536773682
Epoch: 7, Steps: 64 | Train Loss: 0.0981425 Vali Loss: 0.1701525 Test Loss: 0.1503714
Validation loss decreased (0.173324 --> 0.170152).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 8 cost time: 0.9356398582458496
Epoch: 8, Steps: 64 | Train Loss: 0.0963050 Vali Loss: 0.1698245 Test Loss: 0.1509614
Validation loss decreased (0.170152 --> 0.169824).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 9 cost time: 0.9380936622619629
Epoch: 9, Steps: 64 | Train Loss: 0.0949025 Vali Loss: 0.1667897 Test Loss: 0.1502866
Validation loss decreased (0.169824 --> 0.166790).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 10 cost time: 0.9394373893737793
Epoch: 10, Steps: 64 | Train Loss: 0.0936144 Vali Loss: 0.1644796 Test Loss: 0.1486519
Validation loss decreased (0.166790 --> 0.164480).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 11 cost time: 0.9425230026245117
Epoch: 11, Steps: 64 | Train Loss: 0.0922662 Vali Loss: 0.1652418 Test Loss: 0.1486189
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 12 cost time: 0.942380428314209
Epoch: 12, Steps: 64 | Train Loss: 0.0910636 Vali Loss: 0.1644893 Test Loss: 0.1515600
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 13 cost time: 0.9268813133239746
Epoch: 13, Steps: 64 | Train Loss: 0.0897269 Vali Loss: 0.1615862 Test Loss: 0.1504261
Validation loss decreased (0.164480 --> 0.161586).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 14 cost time: 0.9247727394104004
Epoch: 14, Steps: 64 | Train Loss: 0.0894417 Vali Loss: 0.1607213 Test Loss: 0.1508015
Validation loss decreased (0.161586 --> 0.160721).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 15 cost time: 0.9259994029998779
Epoch: 15, Steps: 64 | Train Loss: 0.0886369 Vali Loss: 0.1612736 Test Loss: 0.1519877
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 16 cost time: 0.9276385307312012
Epoch: 16, Steps: 64 | Train Loss: 0.0883458 Vali Loss: 0.1610340 Test Loss: 0.1515730
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 17 cost time: 0.9260444641113281
Epoch: 17, Steps: 64 | Train Loss: 0.0874038 Vali Loss: 0.1617258 Test Loss: 0.1530525
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 18 cost time: 0.9384453296661377
Epoch: 18, Steps: 64 | Train Loss: 0.0870763 Vali Loss: 0.1607207 Test Loss: 0.1528694
Validation loss decreased (0.160721 --> 0.160721).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 19 cost time: 0.9394335746765137
Epoch: 19, Steps: 64 | Train Loss: 0.0864629 Vali Loss: 0.1611302 Test Loss: 0.1526578
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 20 cost time: 0.9284002780914307
Epoch: 20, Steps: 64 | Train Loss: 0.0864068 Vali Loss: 0.1609707 Test Loss: 0.1536715
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 21 cost time: 0.9364056587219238
Epoch: 21, Steps: 64 | Train Loss: 0.0857789 Vali Loss: 0.1597746 Test Loss: 0.1528143
Validation loss decreased (0.160721 --> 0.159775).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 22 cost time: 0.9067814350128174
Epoch: 22, Steps: 64 | Train Loss: 0.0854185 Vali Loss: 0.1602430 Test Loss: 0.1553152
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 23 cost time: 0.8930003643035889
Epoch: 23, Steps: 64 | Train Loss: 0.0854720 Vali Loss: 0.1607472 Test Loss: 0.1550965
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 24 cost time: 0.8926236629486084
Epoch: 24, Steps: 64 | Train Loss: 0.0852005 Vali Loss: 0.1614425 Test Loss: 0.1556911
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 25 cost time: 0.8951787948608398
Epoch: 25, Steps: 64 | Train Loss: 0.0850521 Vali Loss: 0.1595429 Test Loss: 0.1559673
Validation loss decreased (0.159775 --> 0.159543).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 26 cost time: 0.9123737812042236
Epoch: 26, Steps: 64 | Train Loss: 0.0844004 Vali Loss: 0.1613018 Test Loss: 0.1561643
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 27 cost time: 0.9104280471801758
Epoch: 27, Steps: 64 | Train Loss: 0.0841742 Vali Loss: 0.1584022 Test Loss: 0.1550681
Validation loss decreased (0.159543 --> 0.158402).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 28 cost time: 0.9094552993774414
Epoch: 28, Steps: 64 | Train Loss: 0.0843380 Vali Loss: 0.1616094 Test Loss: 0.1569373
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 29 cost time: 0.9157547950744629
Epoch: 29, Steps: 64 | Train Loss: 0.0841169 Vali Loss: 0.1613911 Test Loss: 0.1574959
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 30 cost time: 0.89864182472229
Epoch: 30, Steps: 64 | Train Loss: 0.0840403 Vali Loss: 0.1602312 Test Loss: 0.1575229
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 31 cost time: 0.8996341228485107
Epoch: 31, Steps: 64 | Train Loss: 0.0834014 Vali Loss: 0.1605197 Test Loss: 0.1571907
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 32 cost time: 0.909416913986206
Epoch: 32, Steps: 64 | Train Loss: 0.0836645 Vali Loss: 0.1615161 Test Loss: 0.1577361
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 33 cost time: 0.923403263092041
Epoch: 33, Steps: 64 | Train Loss: 0.0840363 Vali Loss: 0.1616345 Test Loss: 0.1575416
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 34 cost time: 0.9353759288787842
Epoch: 34, Steps: 64 | Train Loss: 0.0832941 Vali Loss: 0.1620824 Test Loss: 0.1579747
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 35 cost time: 0.9494364261627197
Epoch: 35, Steps: 64 | Train Loss: 0.0832952 Vali Loss: 0.1599061 Test Loss: 0.1582200
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 36 cost time: 0.9417154788970947
Epoch: 36, Steps: 64 | Train Loss: 0.0831192 Vali Loss: 0.1617462 Test Loss: 0.1583232
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 37 cost time: 0.9367959499359131
Epoch: 37, Steps: 64 | Train Loss: 0.0832213 Vali Loss: 0.1602405 Test Loss: 0.1584291
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 38 cost time: 0.9414482116699219
Epoch: 38, Steps: 64 | Train Loss: 0.0831517 Vali Loss: 0.1610999 Test Loss: 0.1585046
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 39 cost time: 0.9216482639312744
Epoch: 39, Steps: 64 | Train Loss: 0.0833941 Vali Loss: 0.1604676 Test Loss: 0.1586568
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 40 cost time: 0.9196174144744873
Epoch: 40, Steps: 64 | Train Loss: 0.0833537 Vali Loss: 0.1621032 Test Loss: 0.1594068
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 41 cost time: 0.9223663806915283
Epoch: 41, Steps: 64 | Train Loss: 0.0829994 Vali Loss: 0.1622288 Test Loss: 0.1589119
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 42 cost time: 0.9211328029632568
Epoch: 42, Steps: 64 | Train Loss: 0.0832770 Vali Loss: 0.1625750 Test Loss: 0.1586189
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 43 cost time: 0.9254152774810791
Epoch: 43, Steps: 64 | Train Loss: 0.0830136 Vali Loss: 0.1612476 Test Loss: 0.1591493
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 44 cost time: 0.9157648086547852
Epoch: 44, Steps: 64 | Train Loss: 0.0832910 Vali Loss: 0.1625886 Test Loss: 0.1593681
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 45 cost time: 0.9210004806518555
Epoch: 45, Steps: 64 | Train Loss: 0.0831753 Vali Loss: 0.1604993 Test Loss: 0.1582913
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 46 cost time: 0.925645112991333
Epoch: 46, Steps: 64 | Train Loss: 0.0831166 Vali Loss: 0.1614117 Test Loss: 0.1591154
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 47 cost time: 0.9077935218811035
Epoch: 47, Steps: 64 | Train Loss: 0.0831135 Vali Loss: 0.1612110 Test Loss: 0.1589883
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 48 cost time: 0.8973696231842041
Epoch: 48, Steps: 64 | Train Loss: 0.0829414 Vali Loss: 0.1616752 Test Loss: 0.1596669
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 49 cost time: 0.9033842086791992
Epoch: 49, Steps: 64 | Train Loss: 0.0826989 Vali Loss: 0.1625974 Test Loss: 0.1588515
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 50 cost time: 0.901378870010376
Epoch: 50, Steps: 64 | Train Loss: 0.0829888 Vali Loss: 0.1608642 Test Loss: 0.1588207
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 51 cost time: 0.9251136779785156
Epoch: 51, Steps: 64 | Train Loss: 0.0828958 Vali Loss: 0.1615710 Test Loss: 0.1599975
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 52 cost time: 0.9169986248016357
Epoch: 52, Steps: 64 | Train Loss: 0.0829943 Vali Loss: 0.1616708 Test Loss: 0.1594194
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 53 cost time: 0.9310002326965332
Epoch: 53, Steps: 64 | Train Loss: 0.0829813 Vali Loss: 0.1601840 Test Loss: 0.1594720
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 54 cost time: 0.9426450729370117
Epoch: 54, Steps: 64 | Train Loss: 0.0826056 Vali Loss: 0.1614228 Test Loss: 0.1600491
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 55 cost time: 0.9368278980255127
Epoch: 55, Steps: 64 | Train Loss: 0.0827640 Vali Loss: 0.1608832 Test Loss: 0.1590087
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 56 cost time: 0.9182233810424805
Epoch: 56, Steps: 64 | Train Loss: 0.0828570 Vali Loss: 0.1615201 Test Loss: 0.1597155
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 57 cost time: 0.9213583469390869
Epoch: 57, Steps: 64 | Train Loss: 0.0829819 Vali Loss: 0.1613119 Test Loss: 0.1596468
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 58 cost time: 0.9183688163757324
Epoch: 58, Steps: 64 | Train Loss: 0.0830310 Vali Loss: 0.1609542 Test Loss: 0.1593530
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 59 cost time: 0.9307723045349121
Epoch: 59, Steps: 64 | Train Loss: 0.0830358 Vali Loss: 0.1624873 Test Loss: 0.1601663
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020404815673828125 GB
GPU已分配内存的峰值：0.06525897979736328 GB
Epoch: 60 cost time: 0.9569978713989258
Epoch: 60, Steps: 64 | Train Loss: 0.0827185 Vali Loss: 0.1625250 Test Loss: 0.1599662
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15506809949874878, mae:0.3023048937320709, rse:0.20959562063217163
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05716896057128906 GB
Epoch: 1 cost time: 2.2717719078063965
Epoch: 1, Steps: 64 | Train Loss: 0.9709342 Vali Loss: 2.1630063 Test Loss: 4.1785464
Validation loss decreased (inf --> 2.163006).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 2 cost time: 0.8969998359680176
Epoch: 2, Steps: 64 | Train Loss: 0.8394009 Vali Loss: 1.6611415 Test Loss: 3.1318152
Validation loss decreased (2.163006 --> 1.661142).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 3 cost time: 0.9056398868560791
Epoch: 3, Steps: 64 | Train Loss: 0.6554076 Vali Loss: 1.2823350 Test Loss: 2.3528590
Validation loss decreased (1.661142 --> 1.282335).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 4 cost time: 0.8707754611968994
Epoch: 4, Steps: 64 | Train Loss: 0.5067241 Vali Loss: 0.9921400 Test Loss: 1.7525790
Validation loss decreased (1.282335 --> 0.992140).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 5 cost time: 0.8544542789459229
Epoch: 5, Steps: 64 | Train Loss: 0.4001595 Vali Loss: 0.8028504 Test Loss: 1.3712473
Validation loss decreased (0.992140 --> 0.802850).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 6 cost time: 0.8494539260864258
Epoch: 6, Steps: 64 | Train Loss: 0.3251502 Vali Loss: 0.6652502 Test Loss: 1.0927614
Validation loss decreased (0.802850 --> 0.665250).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 7 cost time: 0.8607542514801025
Epoch: 7, Steps: 64 | Train Loss: 0.2718330 Vali Loss: 0.5564753 Test Loss: 0.8834645
Validation loss decreased (0.665250 --> 0.556475).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 8 cost time: 0.8500001430511475
Epoch: 8, Steps: 64 | Train Loss: 0.2338292 Vali Loss: 0.4773037 Test Loss: 0.7306905
Validation loss decreased (0.556475 --> 0.477304).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 9 cost time: 0.846646785736084
Epoch: 9, Steps: 64 | Train Loss: 0.2055667 Vali Loss: 0.4186929 Test Loss: 0.6183423
Validation loss decreased (0.477304 --> 0.418693).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 10 cost time: 0.8824093341827393
Epoch: 10, Steps: 64 | Train Loss: 0.1847551 Vali Loss: 0.3749632 Test Loss: 0.5316820
Validation loss decreased (0.418693 --> 0.374963).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 11 cost time: 0.8744955062866211
Epoch: 11, Steps: 64 | Train Loss: 0.1685914 Vali Loss: 0.3399147 Test Loss: 0.4649056
Validation loss decreased (0.374963 --> 0.339915).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 12 cost time: 0.8835744857788086
Epoch: 12, Steps: 64 | Train Loss: 0.1563097 Vali Loss: 0.3124158 Test Loss: 0.4177356
Validation loss decreased (0.339915 --> 0.312416).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 13 cost time: 0.8941547870635986
Epoch: 13, Steps: 64 | Train Loss: 0.1471734 Vali Loss: 0.2900108 Test Loss: 0.3733388
Validation loss decreased (0.312416 --> 0.290011).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 14 cost time: 0.8760018348693848
Epoch: 14, Steps: 64 | Train Loss: 0.1401112 Vali Loss: 0.2738181 Test Loss: 0.3419847
Validation loss decreased (0.290011 --> 0.273818).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 15 cost time: 0.8686373233795166
Epoch: 15, Steps: 64 | Train Loss: 0.1332020 Vali Loss: 0.2594834 Test Loss: 0.3174746
Validation loss decreased (0.273818 --> 0.259483).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 16 cost time: 0.8705251216888428
Epoch: 16, Steps: 64 | Train Loss: 0.1287978 Vali Loss: 0.2518251 Test Loss: 0.2995121
Validation loss decreased (0.259483 --> 0.251825).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 17 cost time: 0.8764071464538574
Epoch: 17, Steps: 64 | Train Loss: 0.1245707 Vali Loss: 0.2405348 Test Loss: 0.2789464
Validation loss decreased (0.251825 --> 0.240535).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 18 cost time: 0.8804030418395996
Epoch: 18, Steps: 64 | Train Loss: 0.1214922 Vali Loss: 0.2320096 Test Loss: 0.2673901
Validation loss decreased (0.240535 --> 0.232010).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 19 cost time: 0.88993239402771
Epoch: 19, Steps: 64 | Train Loss: 0.1181650 Vali Loss: 0.2255637 Test Loss: 0.2562755
Validation loss decreased (0.232010 --> 0.225564).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 20 cost time: 0.8887996673583984
Epoch: 20, Steps: 64 | Train Loss: 0.1160589 Vali Loss: 0.2215336 Test Loss: 0.2491902
Validation loss decreased (0.225564 --> 0.221534).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 21 cost time: 0.8966338634490967
Epoch: 21, Steps: 64 | Train Loss: 0.1143875 Vali Loss: 0.2155166 Test Loss: 0.2357417
Validation loss decreased (0.221534 --> 0.215517).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 22 cost time: 0.8923680782318115
Epoch: 22, Steps: 64 | Train Loss: 0.1127081 Vali Loss: 0.2110431 Test Loss: 0.2317168
Validation loss decreased (0.215517 --> 0.211043).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 23 cost time: 0.8834285736083984
Epoch: 23, Steps: 64 | Train Loss: 0.1113920 Vali Loss: 0.2092298 Test Loss: 0.2246854
Validation loss decreased (0.211043 --> 0.209230).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 24 cost time: 0.8829212188720703
Epoch: 24, Steps: 64 | Train Loss: 0.1093271 Vali Loss: 0.2051056 Test Loss: 0.2185246
Validation loss decreased (0.209230 --> 0.205106).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 25 cost time: 0.8737516403198242
Epoch: 25, Steps: 64 | Train Loss: 0.1090532 Vali Loss: 0.2038330 Test Loss: 0.2165828
Validation loss decreased (0.205106 --> 0.203833).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 26 cost time: 0.8664417266845703
Epoch: 26, Steps: 64 | Train Loss: 0.1082951 Vali Loss: 0.2014121 Test Loss: 0.2124326
Validation loss decreased (0.203833 --> 0.201412).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 27 cost time: 0.8706181049346924
Epoch: 27, Steps: 64 | Train Loss: 0.1072451 Vali Loss: 0.1992960 Test Loss: 0.2077595
Validation loss decreased (0.201412 --> 0.199296).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 28 cost time: 0.8764123916625977
Epoch: 28, Steps: 64 | Train Loss: 0.1063686 Vali Loss: 0.2000331 Test Loss: 0.2085914
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 29 cost time: 0.8433918952941895
Epoch: 29, Steps: 64 | Train Loss: 0.1053541 Vali Loss: 0.1967588 Test Loss: 0.2033280
Validation loss decreased (0.199296 --> 0.196759).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 30 cost time: 0.8524558544158936
Epoch: 30, Steps: 64 | Train Loss: 0.1052974 Vali Loss: 0.1924600 Test Loss: 0.2029698
Validation loss decreased (0.196759 --> 0.192460).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 31 cost time: 0.8686511516571045
Epoch: 31, Steps: 64 | Train Loss: 0.1047301 Vali Loss: 0.1947718 Test Loss: 0.1992502
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 32 cost time: 0.8659999370574951
Epoch: 32, Steps: 64 | Train Loss: 0.1041536 Vali Loss: 0.1934591 Test Loss: 0.1966992
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 33 cost time: 0.8614187240600586
Epoch: 33, Steps: 64 | Train Loss: 0.1041100 Vali Loss: 0.1942954 Test Loss: 0.1970827
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 34 cost time: 0.8653852939605713
Epoch: 34, Steps: 64 | Train Loss: 0.1034702 Vali Loss: 0.1895404 Test Loss: 0.1964729
Validation loss decreased (0.192460 --> 0.189540).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 35 cost time: 0.869422435760498
Epoch: 35, Steps: 64 | Train Loss: 0.1032302 Vali Loss: 0.1903835 Test Loss: 0.1948780
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 36 cost time: 0.8983886241912842
Epoch: 36, Steps: 64 | Train Loss: 0.1034445 Vali Loss: 0.1905212 Test Loss: 0.1934234
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 37 cost time: 0.8960011005401611
Epoch: 37, Steps: 64 | Train Loss: 0.1023551 Vali Loss: 0.1896910 Test Loss: 0.1921926
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 38 cost time: 0.8896434307098389
Epoch: 38, Steps: 64 | Train Loss: 0.1025152 Vali Loss: 0.1898414 Test Loss: 0.1916585
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 39 cost time: 0.9014005661010742
Epoch: 39, Steps: 64 | Train Loss: 0.1018560 Vali Loss: 0.1880601 Test Loss: 0.1904434
Validation loss decreased (0.189540 --> 0.188060).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 40 cost time: 0.8940436840057373
Epoch: 40, Steps: 64 | Train Loss: 0.1021105 Vali Loss: 0.1885553 Test Loss: 0.1898761
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 41 cost time: 0.8874771595001221
Epoch: 41, Steps: 64 | Train Loss: 0.1017559 Vali Loss: 0.1881866 Test Loss: 0.1883357
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 42 cost time: 0.8747203350067139
Epoch: 42, Steps: 64 | Train Loss: 0.1014348 Vali Loss: 0.1882729 Test Loss: 0.1879499
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 43 cost time: 0.8839967250823975
Epoch: 43, Steps: 64 | Train Loss: 0.1010941 Vali Loss: 0.1854550 Test Loss: 0.1888479
Validation loss decreased (0.188060 --> 0.185455).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 44 cost time: 0.8750371932983398
Epoch: 44, Steps: 64 | Train Loss: 0.1016829 Vali Loss: 0.1890672 Test Loss: 0.1884259
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 45 cost time: 0.8863842487335205
Epoch: 45, Steps: 64 | Train Loss: 0.1013729 Vali Loss: 0.1837836 Test Loss: 0.1875748
Validation loss decreased (0.185455 --> 0.183784).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 46 cost time: 0.876225471496582
Epoch: 46, Steps: 64 | Train Loss: 0.1011218 Vali Loss: 0.1876511 Test Loss: 0.1882492
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 47 cost time: 0.8753869533538818
Epoch: 47, Steps: 64 | Train Loss: 0.1007090 Vali Loss: 0.1843740 Test Loss: 0.1858715
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 48 cost time: 0.8777501583099365
Epoch: 48, Steps: 64 | Train Loss: 0.1007383 Vali Loss: 0.1847253 Test Loss: 0.1855010
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 49 cost time: 0.8645381927490234
Epoch: 49, Steps: 64 | Train Loss: 0.1010060 Vali Loss: 0.1856590 Test Loss: 0.1851790
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 50 cost time: 0.8756237030029297
Epoch: 50, Steps: 64 | Train Loss: 0.1007360 Vali Loss: 0.1830434 Test Loss: 0.1852663
Validation loss decreased (0.183784 --> 0.183043).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 51 cost time: 0.8633902072906494
Epoch: 51, Steps: 64 | Train Loss: 0.1001871 Vali Loss: 0.1850308 Test Loss: 0.1844107
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 52 cost time: 0.8614566326141357
Epoch: 52, Steps: 64 | Train Loss: 0.1006059 Vali Loss: 0.1848160 Test Loss: 0.1847483
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 53 cost time: 0.8608036041259766
Epoch: 53, Steps: 64 | Train Loss: 0.1009703 Vali Loss: 0.1848709 Test Loss: 0.1848274
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 54 cost time: 0.884998083114624
Epoch: 54, Steps: 64 | Train Loss: 0.1008690 Vali Loss: 0.1841803 Test Loss: 0.1844455
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 55 cost time: 0.8710000514984131
Epoch: 55, Steps: 64 | Train Loss: 0.1001362 Vali Loss: 0.1849893 Test Loss: 0.1837977
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 56 cost time: 0.8714039325714111
Epoch: 56, Steps: 64 | Train Loss: 0.1004281 Vali Loss: 0.1871570 Test Loss: 0.1851267
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 57 cost time: 0.8982522487640381
Epoch: 57, Steps: 64 | Train Loss: 0.1004061 Vali Loss: 0.1851873 Test Loss: 0.1841389
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 58 cost time: 0.8750052452087402
Epoch: 58, Steps: 64 | Train Loss: 0.1004109 Vali Loss: 0.1863577 Test Loss: 0.1833190
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 59 cost time: 0.8717448711395264
Epoch: 59, Steps: 64 | Train Loss: 0.1005859 Vali Loss: 0.1853598 Test Loss: 0.1844924
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01824951171875 GB
GPU已分配内存的峰值：0.05882549285888672 GB
Epoch: 60 cost time: 0.8689992427825928
Epoch: 60, Steps: 64 | Train Loss: 0.1000075 Vali Loss: 0.1832553 Test Loss: 0.1832250
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.18526625633239746, mae:0.33287644386291504, rse:0.22909685969352722
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06031513214111328 GB
Epoch: 1 cost time: 2.3240039348602295
Epoch: 1, Steps: 64 | Train Loss: 0.8245923 Vali Loss: 1.8958606 Test Loss: 3.6125162
Validation loss decreased (inf --> 1.895861).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 2 cost time: 0.9194118976593018
Epoch: 2, Steps: 64 | Train Loss: 0.5417946 Vali Loss: 0.5605652 Test Loss: 0.8772960
Validation loss decreased (1.895861 --> 0.560565).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 3 cost time: 0.9134705066680908
Epoch: 3, Steps: 64 | Train Loss: 0.1646835 Vali Loss: 0.1851312 Test Loss: 0.1556050
Validation loss decreased (0.560565 --> 0.185131).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 4 cost time: 0.9176466464996338
Epoch: 4, Steps: 64 | Train Loss: 0.1083842 Vali Loss: 0.1769051 Test Loss: 0.1502345
Validation loss decreased (0.185131 --> 0.176905).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 5 cost time: 0.89839768409729
Epoch: 5, Steps: 64 | Train Loss: 0.1031477 Vali Loss: 0.1720005 Test Loss: 0.1460330
Validation loss decreased (0.176905 --> 0.172000).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 6 cost time: 0.8953630924224854
Epoch: 6, Steps: 64 | Train Loss: 0.1004507 Vali Loss: 0.1703298 Test Loss: 0.1469802
Validation loss decreased (0.172000 --> 0.170330).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 7 cost time: 0.892425537109375
Epoch: 7, Steps: 64 | Train Loss: 0.0978209 Vali Loss: 0.1693144 Test Loss: 0.1451644
Validation loss decreased (0.170330 --> 0.169314).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 8 cost time: 0.9043705463409424
Epoch: 8, Steps: 64 | Train Loss: 0.0955975 Vali Loss: 0.1661378 Test Loss: 0.1447485
Validation loss decreased (0.169314 --> 0.166138).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 9 cost time: 0.9127743244171143
Epoch: 9, Steps: 64 | Train Loss: 0.0948094 Vali Loss: 0.1640894 Test Loss: 0.1429329
Validation loss decreased (0.166138 --> 0.164089).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 10 cost time: 0.9129981994628906
Epoch: 10, Steps: 64 | Train Loss: 0.0936422 Vali Loss: 0.1625199 Test Loss: 0.1430617
Validation loss decreased (0.164089 --> 0.162520).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 11 cost time: 0.9288842678070068
Epoch: 11, Steps: 64 | Train Loss: 0.0917163 Vali Loss: 0.1608889 Test Loss: 0.1436794
Validation loss decreased (0.162520 --> 0.160889).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 12 cost time: 0.9308693408966064
Epoch: 12, Steps: 64 | Train Loss: 0.0917568 Vali Loss: 0.1630612 Test Loss: 0.1444283
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 13 cost time: 0.9199092388153076
Epoch: 13, Steps: 64 | Train Loss: 0.0904273 Vali Loss: 0.1599808 Test Loss: 0.1443034
Validation loss decreased (0.160889 --> 0.159981).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 14 cost time: 0.9134736061096191
Epoch: 14, Steps: 64 | Train Loss: 0.0902034 Vali Loss: 0.1606162 Test Loss: 0.1445521
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 15 cost time: 0.9144341945648193
Epoch: 15, Steps: 64 | Train Loss: 0.0894290 Vali Loss: 0.1577190 Test Loss: 0.1445617
Validation loss decreased (0.159981 --> 0.157719).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 16 cost time: 0.9094748497009277
Epoch: 16, Steps: 64 | Train Loss: 0.0888280 Vali Loss: 0.1574320 Test Loss: 0.1457293
Validation loss decreased (0.157719 --> 0.157432).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 17 cost time: 0.9119994640350342
Epoch: 17, Steps: 64 | Train Loss: 0.0883533 Vali Loss: 0.1575644 Test Loss: 0.1454214
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 18 cost time: 0.9330003261566162
Epoch: 18, Steps: 64 | Train Loss: 0.0883382 Vali Loss: 0.1582023 Test Loss: 0.1462135
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 19 cost time: 0.9186413288116455
Epoch: 19, Steps: 64 | Train Loss: 0.0877977 Vali Loss: 0.1569196 Test Loss: 0.1452818
Validation loss decreased (0.157432 --> 0.156920).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 20 cost time: 0.9251389503479004
Epoch: 20, Steps: 64 | Train Loss: 0.0875941 Vali Loss: 0.1578826 Test Loss: 0.1462483
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 21 cost time: 0.9350607395172119
Epoch: 21, Steps: 64 | Train Loss: 0.0865960 Vali Loss: 0.1556524 Test Loss: 0.1456618
Validation loss decreased (0.156920 --> 0.155652).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 22 cost time: 0.9063830375671387
Epoch: 22, Steps: 64 | Train Loss: 0.0867794 Vali Loss: 0.1542804 Test Loss: 0.1458126
Validation loss decreased (0.155652 --> 0.154280).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 23 cost time: 0.895620584487915
Epoch: 23, Steps: 64 | Train Loss: 0.0868713 Vali Loss: 0.1567570 Test Loss: 0.1458608
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 24 cost time: 0.8838760852813721
Epoch: 24, Steps: 64 | Train Loss: 0.0861479 Vali Loss: 0.1566556 Test Loss: 0.1459249
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 25 cost time: 0.9076354503631592
Epoch: 25, Steps: 64 | Train Loss: 0.0863999 Vali Loss: 0.1537212 Test Loss: 0.1454105
Validation loss decreased (0.154280 --> 0.153721).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 26 cost time: 0.9106097221374512
Epoch: 26, Steps: 64 | Train Loss: 0.0860866 Vali Loss: 0.1532608 Test Loss: 0.1460169
Validation loss decreased (0.153721 --> 0.153261).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 27 cost time: 0.9154298305511475
Epoch: 27, Steps: 64 | Train Loss: 0.0857281 Vali Loss: 0.1533394 Test Loss: 0.1462305
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 28 cost time: 0.9237723350524902
Epoch: 28, Steps: 64 | Train Loss: 0.0859333 Vali Loss: 0.1556519 Test Loss: 0.1463213
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 29 cost time: 0.9113662242889404
Epoch: 29, Steps: 64 | Train Loss: 0.0857781 Vali Loss: 0.1552165 Test Loss: 0.1458527
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 30 cost time: 0.893479585647583
Epoch: 30, Steps: 64 | Train Loss: 0.0856814 Vali Loss: 0.1534106 Test Loss: 0.1462986
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 31 cost time: 0.8987388610839844
Epoch: 31, Steps: 64 | Train Loss: 0.0854653 Vali Loss: 0.1536338 Test Loss: 0.1457609
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 32 cost time: 0.9000015258789062
Epoch: 32, Steps: 64 | Train Loss: 0.0852021 Vali Loss: 0.1537817 Test Loss: 0.1459900
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 33 cost time: 0.9073851108551025
Epoch: 33, Steps: 64 | Train Loss: 0.0849317 Vali Loss: 0.1547474 Test Loss: 0.1462586
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 34 cost time: 0.9209930896759033
Epoch: 34, Steps: 64 | Train Loss: 0.0851293 Vali Loss: 0.1530059 Test Loss: 0.1464928
Validation loss decreased (0.153261 --> 0.153006).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 35 cost time: 0.9364273548126221
Epoch: 35, Steps: 64 | Train Loss: 0.0851474 Vali Loss: 0.1534216 Test Loss: 0.1462739
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 36 cost time: 0.9244401454925537
Epoch: 36, Steps: 64 | Train Loss: 0.0851653 Vali Loss: 0.1542276 Test Loss: 0.1468678
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 37 cost time: 0.9259641170501709
Epoch: 37, Steps: 64 | Train Loss: 0.0846521 Vali Loss: 0.1541544 Test Loss: 0.1463586
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 38 cost time: 0.9292886257171631
Epoch: 38, Steps: 64 | Train Loss: 0.0849853 Vali Loss: 0.1539183 Test Loss: 0.1460922
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 39 cost time: 0.9170000553131104
Epoch: 39, Steps: 64 | Train Loss: 0.0848064 Vali Loss: 0.1527487 Test Loss: 0.1465215
Validation loss decreased (0.153006 --> 0.152749).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 40 cost time: 0.9116363525390625
Epoch: 40, Steps: 64 | Train Loss: 0.0850582 Vali Loss: 0.1521204 Test Loss: 0.1467049
Validation loss decreased (0.152749 --> 0.152120).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 41 cost time: 0.9155099391937256
Epoch: 41, Steps: 64 | Train Loss: 0.0847881 Vali Loss: 0.1530517 Test Loss: 0.1460291
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 42 cost time: 0.9163534641265869
Epoch: 42, Steps: 64 | Train Loss: 0.0853663 Vali Loss: 0.1521940 Test Loss: 0.1466233
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 43 cost time: 0.9194350242614746
Epoch: 43, Steps: 64 | Train Loss: 0.0851474 Vali Loss: 0.1519278 Test Loss: 0.1470312
Validation loss decreased (0.152120 --> 0.151928).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 44 cost time: 0.9132330417633057
Epoch: 44, Steps: 64 | Train Loss: 0.0847687 Vali Loss: 0.1523532 Test Loss: 0.1463760
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 45 cost time: 0.9108004570007324
Epoch: 45, Steps: 64 | Train Loss: 0.0844266 Vali Loss: 0.1538311 Test Loss: 0.1467254
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 46 cost time: 0.9199981689453125
Epoch: 46, Steps: 64 | Train Loss: 0.0842634 Vali Loss: 0.1521286 Test Loss: 0.1463318
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 47 cost time: 0.8976092338562012
Epoch: 47, Steps: 64 | Train Loss: 0.0850761 Vali Loss: 0.1524826 Test Loss: 0.1462025
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 48 cost time: 0.8946678638458252
Epoch: 48, Steps: 64 | Train Loss: 0.0848906 Vali Loss: 0.1529578 Test Loss: 0.1460366
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 49 cost time: 0.911384105682373
Epoch: 49, Steps: 64 | Train Loss: 0.0843675 Vali Loss: 0.1536117 Test Loss: 0.1466548
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 50 cost time: 0.8934013843536377
Epoch: 50, Steps: 64 | Train Loss: 0.0843531 Vali Loss: 0.1515496 Test Loss: 0.1463458
Validation loss decreased (0.151928 --> 0.151550).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 51 cost time: 0.9129509925842285
Epoch: 51, Steps: 64 | Train Loss: 0.0842922 Vali Loss: 0.1521900 Test Loss: 0.1471918
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 52 cost time: 0.9117226600646973
Epoch: 52, Steps: 64 | Train Loss: 0.0851072 Vali Loss: 0.1519402 Test Loss: 0.1462149
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 53 cost time: 0.9240002632141113
Epoch: 53, Steps: 64 | Train Loss: 0.0847120 Vali Loss: 0.1519950 Test Loss: 0.1466784
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 54 cost time: 0.9076387882232666
Epoch: 54, Steps: 64 | Train Loss: 0.0846028 Vali Loss: 0.1519932 Test Loss: 0.1466346
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 55 cost time: 0.9210608005523682
Epoch: 55, Steps: 64 | Train Loss: 0.0843651 Vali Loss: 0.1533710 Test Loss: 0.1466728
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 56 cost time: 0.9143800735473633
Epoch: 56, Steps: 64 | Train Loss: 0.0849610 Vali Loss: 0.1526687 Test Loss: 0.1466649
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 57 cost time: 0.9053847789764404
Epoch: 57, Steps: 64 | Train Loss: 0.0844624 Vali Loss: 0.1511889 Test Loss: 0.1465828
Validation loss decreased (0.151550 --> 0.151189).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 58 cost time: 0.910529375076294
Epoch: 58, Steps: 64 | Train Loss: 0.0846076 Vali Loss: 0.1525881 Test Loss: 0.1460745
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 59 cost time: 0.9117240905761719
Epoch: 59, Steps: 64 | Train Loss: 0.0843298 Vali Loss: 0.1516897 Test Loss: 0.1464003
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01953887939453125 GB
GPU已分配内存的峰值：0.06191444396972656 GB
Epoch: 60 cost time: 0.9400002956390381
Epoch: 60, Steps: 64 | Train Loss: 0.0846643 Vali Loss: 0.1514577 Test Loss: 0.1460207
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14658278226852417, mae:0.2884293496608734, rse:0.2037804275751114
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06350994110107422 GB
Epoch: 1 cost time: 2.3244621753692627
Epoch: 1, Steps: 64 | Train Loss: 0.7655319 Vali Loss: 1.7772233 Test Loss: 3.3868032
Validation loss decreased (inf --> 1.777223).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 2 cost time: 0.9367167949676514
Epoch: 2, Steps: 64 | Train Loss: 0.4090123 Vali Loss: 0.2008166 Test Loss: 0.1664962
Validation loss decreased (1.777223 --> 0.200817).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 3 cost time: 0.9390017986297607
Epoch: 3, Steps: 64 | Train Loss: 0.1219650 Vali Loss: 0.1874298 Test Loss: 0.1742057
Validation loss decreased (0.200817 --> 0.187430).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 4 cost time: 0.932415246963501
Epoch: 4, Steps: 64 | Train Loss: 0.1076872 Vali Loss: 0.1711585 Test Loss: 0.1466706
Validation loss decreased (0.187430 --> 0.171159).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 5 cost time: 0.9206395149230957
Epoch: 5, Steps: 64 | Train Loss: 0.1020351 Vali Loss: 0.1686813 Test Loss: 0.1445267
Validation loss decreased (0.171159 --> 0.168681).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 6 cost time: 0.9263577461242676
Epoch: 6, Steps: 64 | Train Loss: 0.0994069 Vali Loss: 0.1657077 Test Loss: 0.1439806
Validation loss decreased (0.168681 --> 0.165708).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 7 cost time: 0.9245004653930664
Epoch: 7, Steps: 64 | Train Loss: 0.0970119 Vali Loss: 0.1658864 Test Loss: 0.1435547
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 8 cost time: 0.9160196781158447
Epoch: 8, Steps: 64 | Train Loss: 0.0959068 Vali Loss: 0.1642525 Test Loss: 0.1439460
Validation loss decreased (0.165708 --> 0.164253).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 9 cost time: 0.9393935203552246
Epoch: 9, Steps: 64 | Train Loss: 0.0945146 Vali Loss: 0.1620914 Test Loss: 0.1434889
Validation loss decreased (0.164253 --> 0.162091).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 10 cost time: 0.9354007244110107
Epoch: 10, Steps: 64 | Train Loss: 0.0937046 Vali Loss: 0.1628796 Test Loss: 0.1408707
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 11 cost time: 0.9466545581817627
Epoch: 11, Steps: 64 | Train Loss: 0.0929785 Vali Loss: 0.1603041 Test Loss: 0.1419724
Validation loss decreased (0.162091 --> 0.160304).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 12 cost time: 0.9550008773803711
Epoch: 12, Steps: 64 | Train Loss: 0.0915739 Vali Loss: 0.1589550 Test Loss: 0.1413327
Validation loss decreased (0.160304 --> 0.158955).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 13 cost time: 0.9456062316894531
Epoch: 13, Steps: 64 | Train Loss: 0.0907857 Vali Loss: 0.1588712 Test Loss: 0.1412260
Validation loss decreased (0.158955 --> 0.158871).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 14 cost time: 0.937612771987915
Epoch: 14, Steps: 64 | Train Loss: 0.0902012 Vali Loss: 0.1591644 Test Loss: 0.1407315
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 15 cost time: 0.9341490268707275
Epoch: 15, Steps: 64 | Train Loss: 0.0899345 Vali Loss: 0.1567850 Test Loss: 0.1407535
Validation loss decreased (0.158871 --> 0.156785).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 16 cost time: 0.9373607635498047
Epoch: 16, Steps: 64 | Train Loss: 0.0894937 Vali Loss: 0.1584166 Test Loss: 0.1420851
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 17 cost time: 0.9497907161712646
Epoch: 17, Steps: 64 | Train Loss: 0.0888751 Vali Loss: 0.1563895 Test Loss: 0.1411151
Validation loss decreased (0.156785 --> 0.156389).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 18 cost time: 0.9538097381591797
Epoch: 18, Steps: 64 | Train Loss: 0.0886970 Vali Loss: 0.1557354 Test Loss: 0.1411723
Validation loss decreased (0.156389 --> 0.155735).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 19 cost time: 0.9479742050170898
Epoch: 19, Steps: 64 | Train Loss: 0.0881934 Vali Loss: 0.1549933 Test Loss: 0.1414800
Validation loss decreased (0.155735 --> 0.154993).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 20 cost time: 0.9539060592651367
Epoch: 20, Steps: 64 | Train Loss: 0.0879607 Vali Loss: 0.1575575 Test Loss: 0.1420015
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 21 cost time: 0.9404168128967285
Epoch: 21, Steps: 64 | Train Loss: 0.0877234 Vali Loss: 0.1547157 Test Loss: 0.1409098
Validation loss decreased (0.154993 --> 0.154716).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 22 cost time: 0.918999433517456
Epoch: 22, Steps: 64 | Train Loss: 0.0871156 Vali Loss: 0.1542837 Test Loss: 0.1416543
Validation loss decreased (0.154716 --> 0.154284).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 23 cost time: 0.9266486167907715
Epoch: 23, Steps: 64 | Train Loss: 0.0868603 Vali Loss: 0.1555030 Test Loss: 0.1415158
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 24 cost time: 0.9224462509155273
Epoch: 24, Steps: 64 | Train Loss: 0.0866691 Vali Loss: 0.1525092 Test Loss: 0.1404595
Validation loss decreased (0.154284 --> 0.152509).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 25 cost time: 0.9297592639923096
Epoch: 25, Steps: 64 | Train Loss: 0.0865461 Vali Loss: 0.1534782 Test Loss: 0.1409122
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 26 cost time: 0.942396879196167
Epoch: 26, Steps: 64 | Train Loss: 0.0865870 Vali Loss: 0.1534987 Test Loss: 0.1411242
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 27 cost time: 0.9353499412536621
Epoch: 27, Steps: 64 | Train Loss: 0.0867428 Vali Loss: 0.1542871 Test Loss: 0.1416099
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 28 cost time: 0.9374210834503174
Epoch: 28, Steps: 64 | Train Loss: 0.0863767 Vali Loss: 0.1539427 Test Loss: 0.1412851
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 29 cost time: 0.9287948608398438
Epoch: 29, Steps: 64 | Train Loss: 0.0859821 Vali Loss: 0.1538456 Test Loss: 0.1412787
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 30 cost time: 0.917320966720581
Epoch: 30, Steps: 64 | Train Loss: 0.0862168 Vali Loss: 0.1524955 Test Loss: 0.1417656
Validation loss decreased (0.152509 --> 0.152496).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 31 cost time: 0.9096405506134033
Epoch: 31, Steps: 64 | Train Loss: 0.0860991 Vali Loss: 0.1522495 Test Loss: 0.1408151
Validation loss decreased (0.152496 --> 0.152250).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 32 cost time: 0.9164025783538818
Epoch: 32, Steps: 64 | Train Loss: 0.0856439 Vali Loss: 0.1519608 Test Loss: 0.1410806
Validation loss decreased (0.152250 --> 0.151961).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 33 cost time: 0.9503870010375977
Epoch: 33, Steps: 64 | Train Loss: 0.0858100 Vali Loss: 0.1526704 Test Loss: 0.1409949
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 34 cost time: 0.9581544399261475
Epoch: 34, Steps: 64 | Train Loss: 0.0861459 Vali Loss: 0.1521247 Test Loss: 0.1414278
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 35 cost time: 0.9524939060211182
Epoch: 35, Steps: 64 | Train Loss: 0.0857349 Vali Loss: 0.1536028 Test Loss: 0.1412317
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 36 cost time: 0.9483644962310791
Epoch: 36, Steps: 64 | Train Loss: 0.0854887 Vali Loss: 0.1547995 Test Loss: 0.1420510
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 37 cost time: 0.9558506011962891
Epoch: 37, Steps: 64 | Train Loss: 0.0852268 Vali Loss: 0.1511973 Test Loss: 0.1419027
Validation loss decreased (0.151961 --> 0.151197).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 38 cost time: 0.9310002326965332
Epoch: 38, Steps: 64 | Train Loss: 0.0850984 Vali Loss: 0.1516933 Test Loss: 0.1419453
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 39 cost time: 0.9306542873382568
Epoch: 39, Steps: 64 | Train Loss: 0.0853520 Vali Loss: 0.1522140 Test Loss: 0.1421436
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 40 cost time: 0.933643102645874
Epoch: 40, Steps: 64 | Train Loss: 0.0849644 Vali Loss: 0.1520569 Test Loss: 0.1417973
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 41 cost time: 0.9325010776519775
Epoch: 41, Steps: 64 | Train Loss: 0.0851524 Vali Loss: 0.1517771 Test Loss: 0.1414890
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 42 cost time: 0.9501965045928955
Epoch: 42, Steps: 64 | Train Loss: 0.0849666 Vali Loss: 0.1522654 Test Loss: 0.1412225
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 43 cost time: 0.9340417385101318
Epoch: 43, Steps: 64 | Train Loss: 0.0853327 Vali Loss: 0.1522906 Test Loss: 0.1417064
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 44 cost time: 0.9222207069396973
Epoch: 44, Steps: 64 | Train Loss: 0.0849018 Vali Loss: 0.1534900 Test Loss: 0.1416178
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 45 cost time: 0.9341812133789062
Epoch: 45, Steps: 64 | Train Loss: 0.0848419 Vali Loss: 0.1517160 Test Loss: 0.1419866
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 46 cost time: 0.9087514877319336
Epoch: 46, Steps: 64 | Train Loss: 0.0849639 Vali Loss: 0.1520304 Test Loss: 0.1416692
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 47 cost time: 0.9193565845489502
Epoch: 47, Steps: 64 | Train Loss: 0.0851599 Vali Loss: 0.1506889 Test Loss: 0.1410782
Validation loss decreased (0.151197 --> 0.150689).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 48 cost time: 0.9286477565765381
Epoch: 48, Steps: 64 | Train Loss: 0.0846057 Vali Loss: 0.1508748 Test Loss: 0.1412871
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 49 cost time: 0.9174666404724121
Epoch: 49, Steps: 64 | Train Loss: 0.0850243 Vali Loss: 0.1511759 Test Loss: 0.1414229
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 50 cost time: 0.9414212703704834
Epoch: 50, Steps: 64 | Train Loss: 0.0844259 Vali Loss: 0.1520715 Test Loss: 0.1415752
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 51 cost time: 0.9268686771392822
Epoch: 51, Steps: 64 | Train Loss: 0.0852186 Vali Loss: 0.1504720 Test Loss: 0.1417578
Validation loss decreased (0.150689 --> 0.150472).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 52 cost time: 0.9273808002471924
Epoch: 52, Steps: 64 | Train Loss: 0.0849150 Vali Loss: 0.1515059 Test Loss: 0.1415624
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 53 cost time: 0.9403998851776123
Epoch: 53, Steps: 64 | Train Loss: 0.0844781 Vali Loss: 0.1534549 Test Loss: 0.1420873
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 54 cost time: 0.9297473430633545
Epoch: 54, Steps: 64 | Train Loss: 0.0850237 Vali Loss: 0.1512688 Test Loss: 0.1416603
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 55 cost time: 0.9317367076873779
Epoch: 55, Steps: 64 | Train Loss: 0.0848235 Vali Loss: 0.1522672 Test Loss: 0.1423263
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 56 cost time: 0.9266366958618164
Epoch: 56, Steps: 64 | Train Loss: 0.0851209 Vali Loss: 0.1523399 Test Loss: 0.1416741
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 57 cost time: 0.9434018135070801
Epoch: 57, Steps: 64 | Train Loss: 0.0849361 Vali Loss: 0.1518286 Test Loss: 0.1418720
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 58 cost time: 0.9544098377227783
Epoch: 58, Steps: 64 | Train Loss: 0.0848625 Vali Loss: 0.1512659 Test Loss: 0.1417492
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 59 cost time: 0.9514479637145996
Epoch: 59, Steps: 64 | Train Loss: 0.0844788 Vali Loss: 0.1521769 Test Loss: 0.1417441
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02040863037109375 GB
GPU已分配内存的峰值：0.06542205810546875 GB
Epoch: 60 cost time: 0.9593734741210938
Epoch: 60, Steps: 64 | Train Loss: 0.0850108 Vali Loss: 0.1508961 Test Loss: 0.1417457
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14175783097743988, mae:0.2824126183986664, rse:0.2003985196352005
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05733013153076172 GB
Epoch: 1 cost time: 2.2738399505615234
Epoch: 1, Steps: 64 | Train Loss: 0.9301301 Vali Loss: 2.0936723 Test Loss: 4.0032473
Validation loss decreased (inf --> 2.093672).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 2 cost time: 0.8905928134918213
Epoch: 2, Steps: 64 | Train Loss: 0.7490987 Vali Loss: 1.3251333 Test Loss: 2.4202504
Validation loss decreased (2.093672 --> 1.325133).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 3 cost time: 0.8744087219238281
Epoch: 3, Steps: 64 | Train Loss: 0.5074822 Vali Loss: 0.9240825 Test Loss: 1.6067806
Validation loss decreased (1.325133 --> 0.924082).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 4 cost time: 0.8854248523712158
Epoch: 4, Steps: 64 | Train Loss: 0.3750925 Vali Loss: 0.7072705 Test Loss: 1.1639478
Validation loss decreased (0.924082 --> 0.707271).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 5 cost time: 0.8850011825561523
Epoch: 5, Steps: 64 | Train Loss: 0.2909777 Vali Loss: 0.5708998 Test Loss: 0.8869106
Validation loss decreased (0.707271 --> 0.570900).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 6 cost time: 0.8506424427032471
Epoch: 6, Steps: 64 | Train Loss: 0.2368471 Vali Loss: 0.4718654 Test Loss: 0.6945027
Validation loss decreased (0.570900 --> 0.471865).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 7 cost time: 0.8633596897125244
Epoch: 7, Steps: 64 | Train Loss: 0.1995014 Vali Loss: 0.3985761 Test Loss: 0.5580785
Validation loss decreased (0.471865 --> 0.398576).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 8 cost time: 0.8594121932983398
Epoch: 8, Steps: 64 | Train Loss: 0.1734732 Vali Loss: 0.3491503 Test Loss: 0.4618938
Validation loss decreased (0.398576 --> 0.349150).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 9 cost time: 0.8630297183990479
Epoch: 9, Steps: 64 | Train Loss: 0.1547767 Vali Loss: 0.3093053 Test Loss: 0.3877409
Validation loss decreased (0.349150 --> 0.309305).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 10 cost time: 0.8817241191864014
Epoch: 10, Steps: 64 | Train Loss: 0.1423016 Vali Loss: 0.2794090 Test Loss: 0.3373444
Validation loss decreased (0.309305 --> 0.279409).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 11 cost time: 0.8919992446899414
Epoch: 11, Steps: 64 | Train Loss: 0.1324623 Vali Loss: 0.2611457 Test Loss: 0.3018802
Validation loss decreased (0.279409 --> 0.261146).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 12 cost time: 0.8986520767211914
Epoch: 12, Steps: 64 | Train Loss: 0.1252832 Vali Loss: 0.2430984 Test Loss: 0.2712487
Validation loss decreased (0.261146 --> 0.243098).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 13 cost time: 0.892080545425415
Epoch: 13, Steps: 64 | Train Loss: 0.1194391 Vali Loss: 0.2305131 Test Loss: 0.2491621
Validation loss decreased (0.243098 --> 0.230513).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 14 cost time: 0.8933925628662109
Epoch: 14, Steps: 64 | Train Loss: 0.1155154 Vali Loss: 0.2231124 Test Loss: 0.2341367
Validation loss decreased (0.230513 --> 0.223112).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 15 cost time: 0.876474142074585
Epoch: 15, Steps: 64 | Train Loss: 0.1123051 Vali Loss: 0.2106109 Test Loss: 0.2190868
Validation loss decreased (0.223112 --> 0.210611).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 16 cost time: 0.89174485206604
Epoch: 16, Steps: 64 | Train Loss: 0.1093183 Vali Loss: 0.2079141 Test Loss: 0.2125266
Validation loss decreased (0.210611 --> 0.207914).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 17 cost time: 0.8957338333129883
Epoch: 17, Steps: 64 | Train Loss: 0.1078102 Vali Loss: 0.2035042 Test Loss: 0.2014888
Validation loss decreased (0.207914 --> 0.203504).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 18 cost time: 0.90863037109375
Epoch: 18, Steps: 64 | Train Loss: 0.1058592 Vali Loss: 0.1995060 Test Loss: 0.1974110
Validation loss decreased (0.203504 --> 0.199506).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 19 cost time: 0.907372236251831
Epoch: 19, Steps: 64 | Train Loss: 0.1043443 Vali Loss: 0.1954171 Test Loss: 0.1919334
Validation loss decreased (0.199506 --> 0.195417).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 20 cost time: 0.8454840183258057
Epoch: 20, Steps: 64 | Train Loss: 0.1033428 Vali Loss: 0.1922230 Test Loss: 0.1865602
Validation loss decreased (0.195417 --> 0.192223).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 21 cost time: 0.907447338104248
Epoch: 21, Steps: 64 | Train Loss: 0.1017163 Vali Loss: 0.1861664 Test Loss: 0.1804230
Validation loss decreased (0.192223 --> 0.186166).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 22 cost time: 0.9007894992828369
Epoch: 22, Steps: 64 | Train Loss: 0.1008606 Vali Loss: 0.1869161 Test Loss: 0.1802936
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 23 cost time: 0.9037342071533203
Epoch: 23, Steps: 64 | Train Loss: 0.1005656 Vali Loss: 0.1847987 Test Loss: 0.1752595
Validation loss decreased (0.186166 --> 0.184799).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 24 cost time: 0.8990004062652588
Epoch: 24, Steps: 64 | Train Loss: 0.0998066 Vali Loss: 0.1858053 Test Loss: 0.1752709
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 25 cost time: 0.8816399574279785
Epoch: 25, Steps: 64 | Train Loss: 0.0995281 Vali Loss: 0.1840641 Test Loss: 0.1737254
Validation loss decreased (0.184799 --> 0.184064).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 26 cost time: 0.859032154083252
Epoch: 26, Steps: 64 | Train Loss: 0.0988613 Vali Loss: 0.1828539 Test Loss: 0.1713394
Validation loss decreased (0.184064 --> 0.182854).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 27 cost time: 0.884387731552124
Epoch: 27, Steps: 64 | Train Loss: 0.0985742 Vali Loss: 0.1807887 Test Loss: 0.1708881
Validation loss decreased (0.182854 --> 0.180789).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 28 cost time: 0.8824491500854492
Epoch: 28, Steps: 64 | Train Loss: 0.0985559 Vali Loss: 0.1791304 Test Loss: 0.1697538
Validation loss decreased (0.180789 --> 0.179130).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 29 cost time: 0.8747475147247314
Epoch: 29, Steps: 64 | Train Loss: 0.0979952 Vali Loss: 0.1796311 Test Loss: 0.1684657
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 30 cost time: 0.8800003528594971
Epoch: 30, Steps: 64 | Train Loss: 0.0979802 Vali Loss: 0.1809137 Test Loss: 0.1680630
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 31 cost time: 0.8646366596221924
Epoch: 31, Steps: 64 | Train Loss: 0.0977596 Vali Loss: 0.1797841 Test Loss: 0.1677959
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 32 cost time: 0.8644647598266602
Epoch: 32, Steps: 64 | Train Loss: 0.0968823 Vali Loss: 0.1775643 Test Loss: 0.1672667
Validation loss decreased (0.179130 --> 0.177564).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 33 cost time: 0.8506002426147461
Epoch: 33, Steps: 64 | Train Loss: 0.0973059 Vali Loss: 0.1779276 Test Loss: 0.1647414
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 34 cost time: 0.8749699592590332
Epoch: 34, Steps: 64 | Train Loss: 0.0967833 Vali Loss: 0.1780067 Test Loss: 0.1656673
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 35 cost time: 0.8773758411407471
Epoch: 35, Steps: 64 | Train Loss: 0.0968695 Vali Loss: 0.1783737 Test Loss: 0.1655884
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 36 cost time: 0.9056477546691895
Epoch: 36, Steps: 64 | Train Loss: 0.0965831 Vali Loss: 0.1762347 Test Loss: 0.1647730
Validation loss decreased (0.177564 --> 0.176235).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 37 cost time: 0.9024486541748047
Epoch: 37, Steps: 64 | Train Loss: 0.0964928 Vali Loss: 0.1769696 Test Loss: 0.1637238
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 38 cost time: 0.903383731842041
Epoch: 38, Steps: 64 | Train Loss: 0.0958976 Vali Loss: 0.1771814 Test Loss: 0.1642108
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 39 cost time: 0.9193239212036133
Epoch: 39, Steps: 64 | Train Loss: 0.0964032 Vali Loss: 0.1731061 Test Loss: 0.1628180
Validation loss decreased (0.176235 --> 0.173106).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 40 cost time: 0.893477201461792
Epoch: 40, Steps: 64 | Train Loss: 0.0959257 Vali Loss: 0.1773529 Test Loss: 0.1636945
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 41 cost time: 0.8882632255554199
Epoch: 41, Steps: 64 | Train Loss: 0.0960114 Vali Loss: 0.1742981 Test Loss: 0.1638107
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 42 cost time: 0.8950004577636719
Epoch: 42, Steps: 64 | Train Loss: 0.0960095 Vali Loss: 0.1746191 Test Loss: 0.1620671
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 43 cost time: 0.8962860107421875
Epoch: 43, Steps: 64 | Train Loss: 0.0956591 Vali Loss: 0.1752847 Test Loss: 0.1631820
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 44 cost time: 0.9942362308502197
Epoch: 44, Steps: 64 | Train Loss: 0.0961067 Vali Loss: 0.1724631 Test Loss: 0.1619471
Validation loss decreased (0.173106 --> 0.172463).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 45 cost time: 0.9566135406494141
Epoch: 45, Steps: 64 | Train Loss: 0.0957837 Vali Loss: 0.1749215 Test Loss: 0.1613524
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 46 cost time: 0.9112472534179688
Epoch: 46, Steps: 64 | Train Loss: 0.0956597 Vali Loss: 0.1771759 Test Loss: 0.1625185
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 47 cost time: 0.8984661102294922
Epoch: 47, Steps: 64 | Train Loss: 0.0952396 Vali Loss: 0.1754906 Test Loss: 0.1616289
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 48 cost time: 0.8959276676177979
Epoch: 48, Steps: 64 | Train Loss: 0.0954887 Vali Loss: 0.1743643 Test Loss: 0.1618458
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 49 cost time: 0.9012892246246338
Epoch: 49, Steps: 64 | Train Loss: 0.0953282 Vali Loss: 0.1742609 Test Loss: 0.1612803
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 50 cost time: 0.872622013092041
Epoch: 50, Steps: 64 | Train Loss: 0.0956145 Vali Loss: 0.1731794 Test Loss: 0.1625189
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 51 cost time: 0.8654377460479736
Epoch: 51, Steps: 64 | Train Loss: 0.0957474 Vali Loss: 0.1740292 Test Loss: 0.1611122
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 52 cost time: 0.8614451885223389
Epoch: 52, Steps: 64 | Train Loss: 0.0952116 Vali Loss: 0.1757546 Test Loss: 0.1614287
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 53 cost time: 0.8900792598724365
Epoch: 53, Steps: 64 | Train Loss: 0.0950936 Vali Loss: 0.1737094 Test Loss: 0.1608194
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 54 cost time: 0.9038314819335938
Epoch: 54, Steps: 64 | Train Loss: 0.0953965 Vali Loss: 0.1732610 Test Loss: 0.1608931
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 55 cost time: 0.8979990482330322
Epoch: 55, Steps: 64 | Train Loss: 0.0953791 Vali Loss: 0.1732083 Test Loss: 0.1619458
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 56 cost time: 0.9026005268096924
Epoch: 56, Steps: 64 | Train Loss: 0.0951251 Vali Loss: 0.1754258 Test Loss: 0.1609392
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 57 cost time: 0.8869984149932861
Epoch: 57, Steps: 64 | Train Loss: 0.0954519 Vali Loss: 0.1732953 Test Loss: 0.1605312
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 58 cost time: 0.8804562091827393
Epoch: 58, Steps: 64 | Train Loss: 0.0953848 Vali Loss: 0.1729175 Test Loss: 0.1617343
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 59 cost time: 0.8803873062133789
Epoch: 59, Steps: 64 | Train Loss: 0.0948665 Vali Loss: 0.1746267 Test Loss: 0.1601494
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018253326416015625 GB
GPU已分配内存的峰值：0.05898857116699219 GB
Epoch: 60 cost time: 0.88275146484375
Epoch: 60, Steps: 64 | Train Loss: 0.0954538 Vali Loss: 0.1728699 Test Loss: 0.1610108
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1619470864534378, mae:0.3105303943157196, rse:0.21419410407543182
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06047630310058594 GB
Epoch: 1 cost time: 2.324737787246704
Epoch: 1, Steps: 64 | Train Loss: 0.8166115 Vali Loss: 1.8830750 Test Loss: 3.5423148
Validation loss decreased (inf --> 1.883075).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 2 cost time: 0.9053912162780762
Epoch: 2, Steps: 64 | Train Loss: 0.5185886 Vali Loss: 0.5218723 Test Loss: 0.7523353
Validation loss decreased (1.883075 --> 0.521872).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 3 cost time: 0.8999998569488525
Epoch: 3, Steps: 64 | Train Loss: 0.1582020 Vali Loss: 0.1883231 Test Loss: 0.1487161
Validation loss decreased (0.521872 --> 0.188323).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 4 cost time: 0.9119992256164551
Epoch: 4, Steps: 64 | Train Loss: 0.1131132 Vali Loss: 0.1788445 Test Loss: 0.1524905
Validation loss decreased (0.188323 --> 0.178845).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 5 cost time: 0.8836097717285156
Epoch: 5, Steps: 64 | Train Loss: 0.1073727 Vali Loss: 0.1736007 Test Loss: 0.1435286
Validation loss decreased (0.178845 --> 0.173601).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 6 cost time: 0.8903243541717529
Epoch: 6, Steps: 64 | Train Loss: 0.1034223 Vali Loss: 0.1706993 Test Loss: 0.1449811
Validation loss decreased (0.173601 --> 0.170699).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 7 cost time: 0.8925087451934814
Epoch: 7, Steps: 64 | Train Loss: 0.1011714 Vali Loss: 0.1715536 Test Loss: 0.1441804
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 8 cost time: 0.891402006149292
Epoch: 8, Steps: 64 | Train Loss: 0.0994600 Vali Loss: 0.1671672 Test Loss: 0.1439763
Validation loss decreased (0.170699 --> 0.167167).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 9 cost time: 0.9107897281646729
Epoch: 9, Steps: 64 | Train Loss: 0.0977337 Vali Loss: 0.1657420 Test Loss: 0.1433130
Validation loss decreased (0.167167 --> 0.165742).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 10 cost time: 0.9079995155334473
Epoch: 10, Steps: 64 | Train Loss: 0.0972149 Vali Loss: 0.1690411 Test Loss: 0.1431958
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 11 cost time: 0.962665319442749
Epoch: 11, Steps: 64 | Train Loss: 0.0953958 Vali Loss: 0.1637052 Test Loss: 0.1403669
Validation loss decreased (0.165742 --> 0.163705).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 12 cost time: 0.9246208667755127
Epoch: 12, Steps: 64 | Train Loss: 0.0936806 Vali Loss: 0.1623359 Test Loss: 0.1401664
Validation loss decreased (0.163705 --> 0.162336).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 13 cost time: 0.9154672622680664
Epoch: 13, Steps: 64 | Train Loss: 0.0930940 Vali Loss: 0.1631548 Test Loss: 0.1418341
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 14 cost time: 0.9163925647735596
Epoch: 14, Steps: 64 | Train Loss: 0.0924881 Vali Loss: 0.1621199 Test Loss: 0.1411395
Validation loss decreased (0.162336 --> 0.162120).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 15 cost time: 0.9089975357055664
Epoch: 15, Steps: 64 | Train Loss: 0.0916523 Vali Loss: 0.1604247 Test Loss: 0.1417300
Validation loss decreased (0.162120 --> 0.160425).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 16 cost time: 0.9094448089599609
Epoch: 16, Steps: 64 | Train Loss: 0.0914258 Vali Loss: 0.1609015 Test Loss: 0.1421286
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 17 cost time: 0.902740478515625
Epoch: 17, Steps: 64 | Train Loss: 0.0907252 Vali Loss: 0.1595973 Test Loss: 0.1420412
Validation loss decreased (0.160425 --> 0.159597).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 18 cost time: 0.9209995269775391
Epoch: 18, Steps: 64 | Train Loss: 0.0900608 Vali Loss: 0.1599124 Test Loss: 0.1417702
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 19 cost time: 0.928006649017334
Epoch: 19, Steps: 64 | Train Loss: 0.0900386 Vali Loss: 0.1575337 Test Loss: 0.1412908
Validation loss decreased (0.159597 --> 0.157534).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 20 cost time: 0.9206376075744629
Epoch: 20, Steps: 64 | Train Loss: 0.0894575 Vali Loss: 0.1583847 Test Loss: 0.1428532
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 21 cost time: 0.9193568229675293
Epoch: 21, Steps: 64 | Train Loss: 0.0889940 Vali Loss: 0.1602880 Test Loss: 0.1422975
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 22 cost time: 0.90639328956604
Epoch: 22, Steps: 64 | Train Loss: 0.0886719 Vali Loss: 0.1567956 Test Loss: 0.1431677
Validation loss decreased (0.157534 --> 0.156796).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 23 cost time: 0.8944082260131836
Epoch: 23, Steps: 64 | Train Loss: 0.0884399 Vali Loss: 0.1553914 Test Loss: 0.1429206
Validation loss decreased (0.156796 --> 0.155391).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 24 cost time: 0.9042069911956787
Epoch: 24, Steps: 64 | Train Loss: 0.0882512 Vali Loss: 0.1571378 Test Loss: 0.1425471
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 25 cost time: 0.8929994106292725
Epoch: 25, Steps: 64 | Train Loss: 0.0881048 Vali Loss: 0.1560865 Test Loss: 0.1422599
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 26 cost time: 0.9189999103546143
Epoch: 26, Steps: 64 | Train Loss: 0.0876687 Vali Loss: 0.1564918 Test Loss: 0.1427767
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 27 cost time: 0.9106166362762451
Epoch: 27, Steps: 64 | Train Loss: 0.0878154 Vali Loss: 0.1576254 Test Loss: 0.1423104
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 28 cost time: 0.9131057262420654
Epoch: 28, Steps: 64 | Train Loss: 0.0876260 Vali Loss: 0.1564499 Test Loss: 0.1430032
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 29 cost time: 0.924389123916626
Epoch: 29, Steps: 64 | Train Loss: 0.0872855 Vali Loss: 0.1559157 Test Loss: 0.1435451
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 30 cost time: 0.926426887512207
Epoch: 30, Steps: 64 | Train Loss: 0.0874897 Vali Loss: 0.1555866 Test Loss: 0.1435898
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 31 cost time: 0.9265599250793457
Epoch: 31, Steps: 64 | Train Loss: 0.0871281 Vali Loss: 0.1560483 Test Loss: 0.1434491
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 32 cost time: 0.902782678604126
Epoch: 32, Steps: 64 | Train Loss: 0.0872893 Vali Loss: 0.1557393 Test Loss: 0.1438266
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 33 cost time: 0.9039998054504395
Epoch: 33, Steps: 64 | Train Loss: 0.0872748 Vali Loss: 0.1581523 Test Loss: 0.1437586
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 34 cost time: 0.9166288375854492
Epoch: 34, Steps: 64 | Train Loss: 0.0865773 Vali Loss: 0.1574341 Test Loss: 0.1436183
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 35 cost time: 0.9383645057678223
Epoch: 35, Steps: 64 | Train Loss: 0.0868243 Vali Loss: 0.1551391 Test Loss: 0.1436273
Validation loss decreased (0.155391 --> 0.155139).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 36 cost time: 0.931999683380127
Epoch: 36, Steps: 64 | Train Loss: 0.0866801 Vali Loss: 0.1561240 Test Loss: 0.1443609
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 37 cost time: 0.9174752235412598
Epoch: 37, Steps: 64 | Train Loss: 0.0868053 Vali Loss: 0.1557752 Test Loss: 0.1435620
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 38 cost time: 0.937558650970459
Epoch: 38, Steps: 64 | Train Loss: 0.0869595 Vali Loss: 0.1573664 Test Loss: 0.1439277
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 39 cost time: 0.9077200889587402
Epoch: 39, Steps: 64 | Train Loss: 0.0863975 Vali Loss: 0.1575631 Test Loss: 0.1438410
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 40 cost time: 0.9090018272399902
Epoch: 40, Steps: 64 | Train Loss: 0.0864695 Vali Loss: 0.1551669 Test Loss: 0.1439580
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 41 cost time: 0.9062662124633789
Epoch: 41, Steps: 64 | Train Loss: 0.0866605 Vali Loss: 0.1565419 Test Loss: 0.1439382
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 42 cost time: 0.9086315631866455
Epoch: 42, Steps: 64 | Train Loss: 0.0865583 Vali Loss: 0.1569812 Test Loss: 0.1441291
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 43 cost time: 0.9293694496154785
Epoch: 43, Steps: 64 | Train Loss: 0.0862159 Vali Loss: 0.1553134 Test Loss: 0.1443402
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 44 cost time: 0.9084339141845703
Epoch: 44, Steps: 64 | Train Loss: 0.0858945 Vali Loss: 0.1552407 Test Loss: 0.1438799
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 45 cost time: 0.9244506359100342
Epoch: 45, Steps: 64 | Train Loss: 0.0865447 Vali Loss: 0.1570900 Test Loss: 0.1440563
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 46 cost time: 0.9118256568908691
Epoch: 46, Steps: 64 | Train Loss: 0.0865252 Vali Loss: 0.1567366 Test Loss: 0.1440165
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 47 cost time: 0.9017229080200195
Epoch: 47, Steps: 64 | Train Loss: 0.0865348 Vali Loss: 0.1549028 Test Loss: 0.1439200
Validation loss decreased (0.155139 --> 0.154903).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 48 cost time: 0.9029989242553711
Epoch: 48, Steps: 64 | Train Loss: 0.0865318 Vali Loss: 0.1564281 Test Loss: 0.1437429
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 49 cost time: 0.9054121971130371
Epoch: 49, Steps: 64 | Train Loss: 0.0859865 Vali Loss: 0.1552869 Test Loss: 0.1437184
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 50 cost time: 0.8977508544921875
Epoch: 50, Steps: 64 | Train Loss: 0.0860445 Vali Loss: 0.1569785 Test Loss: 0.1444180
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 51 cost time: 0.9074223041534424
Epoch: 51, Steps: 64 | Train Loss: 0.0859549 Vali Loss: 0.1569177 Test Loss: 0.1436925
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 52 cost time: 0.9173905849456787
Epoch: 52, Steps: 64 | Train Loss: 0.0863530 Vali Loss: 0.1571017 Test Loss: 0.1439015
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 53 cost time: 0.9088826179504395
Epoch: 53, Steps: 64 | Train Loss: 0.0861224 Vali Loss: 0.1557250 Test Loss: 0.1438706
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 54 cost time: 0.9173686504364014
Epoch: 54, Steps: 64 | Train Loss: 0.0861611 Vali Loss: 0.1557900 Test Loss: 0.1437771
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 55 cost time: 0.9219982624053955
Epoch: 55, Steps: 64 | Train Loss: 0.0859666 Vali Loss: 0.1564541 Test Loss: 0.1439952
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 56 cost time: 0.9166114330291748
Epoch: 56, Steps: 64 | Train Loss: 0.0861701 Vali Loss: 0.1555455 Test Loss: 0.1442525
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 57 cost time: 0.909381628036499
Epoch: 57, Steps: 64 | Train Loss: 0.0863465 Vali Loss: 0.1567484 Test Loss: 0.1443741
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 58 cost time: 0.9054176807403564
Epoch: 58, Steps: 64 | Train Loss: 0.0862405 Vali Loss: 0.1566596 Test Loss: 0.1439534
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 59 cost time: 0.9140076637268066
Epoch: 59, Steps: 64 | Train Loss: 0.0864393 Vali Loss: 0.1559540 Test Loss: 0.1441590
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019542694091796875 GB
GPU已分配内存的峰值：0.06207752227783203 GB
Epoch: 60 cost time: 0.9304282665252686
Epoch: 60, Steps: 64 | Train Loss: 0.0864448 Vali Loss: 0.1546498 Test Loss: 0.1438884
Validation loss decreased (0.154903 --> 0.154650).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1438884139060974, mae:0.2837793529033661, rse:0.20189887285232544
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06367111206054688 GB
Epoch: 1 cost time: 2.3488450050354004
Epoch: 1, Steps: 64 | Train Loss: 0.7763704 Vali Loss: 1.8058408 Test Loss: 3.4380894
Validation loss decreased (inf --> 1.805841).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 2 cost time: 0.9631786346435547
Epoch: 2, Steps: 64 | Train Loss: 0.4203895 Vali Loss: 0.2008278 Test Loss: 0.1638358
Validation loss decreased (1.805841 --> 0.200828).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 3 cost time: 0.9363996982574463
Epoch: 3, Steps: 64 | Train Loss: 0.1239519 Vali Loss: 0.1887216 Test Loss: 0.1712206
Validation loss decreased (0.200828 --> 0.188722).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 4 cost time: 0.943413496017456
Epoch: 4, Steps: 64 | Train Loss: 0.1084281 Vali Loss: 0.1702725 Test Loss: 0.1455416
Validation loss decreased (0.188722 --> 0.170272).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 5 cost time: 0.9265589714050293
Epoch: 5, Steps: 64 | Train Loss: 0.1028826 Vali Loss: 0.1681409 Test Loss: 0.1454052
Validation loss decreased (0.170272 --> 0.168141).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 6 cost time: 0.9110002517700195
Epoch: 6, Steps: 64 | Train Loss: 0.0993030 Vali Loss: 0.1650833 Test Loss: 0.1437060
Validation loss decreased (0.168141 --> 0.165083).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 7 cost time: 0.9286396503448486
Epoch: 7, Steps: 64 | Train Loss: 0.0966290 Vali Loss: 0.1644158 Test Loss: 0.1437734
Validation loss decreased (0.165083 --> 0.164416).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 8 cost time: 0.9283871650695801
Epoch: 8, Steps: 64 | Train Loss: 0.0950026 Vali Loss: 0.1625430 Test Loss: 0.1444233
Validation loss decreased (0.164416 --> 0.162543).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 9 cost time: 0.9503819942474365
Epoch: 9, Steps: 64 | Train Loss: 0.0933902 Vali Loss: 0.1592990 Test Loss: 0.1431358
Validation loss decreased (0.162543 --> 0.159299).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 10 cost time: 0.9363546371459961
Epoch: 10, Steps: 64 | Train Loss: 0.0919931 Vali Loss: 0.1615990 Test Loss: 0.1446316
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 11 cost time: 0.9514644145965576
Epoch: 11, Steps: 64 | Train Loss: 0.0908979 Vali Loss: 0.1612345 Test Loss: 0.1441307
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 12 cost time: 0.9633722305297852
Epoch: 12, Steps: 64 | Train Loss: 0.0903326 Vali Loss: 0.1597862 Test Loss: 0.1426134
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 13 cost time: 0.9450891017913818
Epoch: 13, Steps: 64 | Train Loss: 0.0898466 Vali Loss: 0.1608609 Test Loss: 0.1447837
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 14 cost time: 0.948763370513916
Epoch: 14, Steps: 64 | Train Loss: 0.0884770 Vali Loss: 0.1596584 Test Loss: 0.1445487
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 15 cost time: 0.9467189311981201
Epoch: 15, Steps: 64 | Train Loss: 0.0881447 Vali Loss: 0.1564664 Test Loss: 0.1452031
Validation loss decreased (0.159299 --> 0.156466).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 16 cost time: 0.9419999122619629
Epoch: 16, Steps: 64 | Train Loss: 0.0872612 Vali Loss: 0.1576252 Test Loss: 0.1455774
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 17 cost time: 0.9726383686065674
Epoch: 17, Steps: 64 | Train Loss: 0.0875744 Vali Loss: 0.1580962 Test Loss: 0.1446977
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 18 cost time: 0.9605369567871094
Epoch: 18, Steps: 64 | Train Loss: 0.0861019 Vali Loss: 0.1575103 Test Loss: 0.1457697
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 19 cost time: 0.969221830368042
Epoch: 19, Steps: 64 | Train Loss: 0.0858008 Vali Loss: 0.1545795 Test Loss: 0.1450744
Validation loss decreased (0.156466 --> 0.154579).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 20 cost time: 0.9703691005706787
Epoch: 20, Steps: 64 | Train Loss: 0.0859927 Vali Loss: 0.1570757 Test Loss: 0.1460838
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 21 cost time: 0.9625058174133301
Epoch: 21, Steps: 64 | Train Loss: 0.0851338 Vali Loss: 0.1558143 Test Loss: 0.1455364
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 22 cost time: 0.9654171466827393
Epoch: 22, Steps: 64 | Train Loss: 0.0852322 Vali Loss: 0.1569510 Test Loss: 0.1469274
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 23 cost time: 0.9381518363952637
Epoch: 23, Steps: 64 | Train Loss: 0.0845522 Vali Loss: 0.1548447 Test Loss: 0.1458867
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 24 cost time: 0.9337470531463623
Epoch: 24, Steps: 64 | Train Loss: 0.0848458 Vali Loss: 0.1554948 Test Loss: 0.1467544
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 25 cost time: 0.9459998607635498
Epoch: 25, Steps: 64 | Train Loss: 0.0845427 Vali Loss: 0.1549662 Test Loss: 0.1465782
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 26 cost time: 0.9480023384094238
Epoch: 26, Steps: 64 | Train Loss: 0.0842427 Vali Loss: 0.1548280 Test Loss: 0.1471835
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 27 cost time: 0.9496378898620605
Epoch: 27, Steps: 64 | Train Loss: 0.0841940 Vali Loss: 0.1540156 Test Loss: 0.1466640
Validation loss decreased (0.154579 --> 0.154016).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 28 cost time: 0.9526293277740479
Epoch: 28, Steps: 64 | Train Loss: 0.0843138 Vali Loss: 0.1546910 Test Loss: 0.1478932
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 29 cost time: 0.9404089450836182
Epoch: 29, Steps: 64 | Train Loss: 0.0838629 Vali Loss: 0.1532706 Test Loss: 0.1470283
Validation loss decreased (0.154016 --> 0.153271).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 30 cost time: 0.9353983402252197
Epoch: 30, Steps: 64 | Train Loss: 0.0837535 Vali Loss: 0.1543362 Test Loss: 0.1480588
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 31 cost time: 0.9333586692810059
Epoch: 31, Steps: 64 | Train Loss: 0.0835723 Vali Loss: 0.1553250 Test Loss: 0.1471604
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 32 cost time: 0.95206618309021
Epoch: 32, Steps: 64 | Train Loss: 0.0833792 Vali Loss: 0.1526871 Test Loss: 0.1472959
Validation loss decreased (0.153271 --> 0.152687).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 33 cost time: 0.9537503719329834
Epoch: 33, Steps: 64 | Train Loss: 0.0831865 Vali Loss: 0.1535434 Test Loss: 0.1479866
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 34 cost time: 0.962744951248169
Epoch: 34, Steps: 64 | Train Loss: 0.0834009 Vali Loss: 0.1535608 Test Loss: 0.1481196
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 35 cost time: 0.962000846862793
Epoch: 35, Steps: 64 | Train Loss: 0.0836909 Vali Loss: 0.1543574 Test Loss: 0.1478859
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 36 cost time: 0.9646501541137695
Epoch: 36, Steps: 64 | Train Loss: 0.0837153 Vali Loss: 0.1548768 Test Loss: 0.1481682
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 37 cost time: 0.9636542797088623
Epoch: 37, Steps: 64 | Train Loss: 0.0831256 Vali Loss: 0.1539448 Test Loss: 0.1483628
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 38 cost time: 0.9464161396026611
Epoch: 38, Steps: 64 | Train Loss: 0.0829563 Vali Loss: 0.1530564 Test Loss: 0.1483904
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 39 cost time: 0.9533998966217041
Epoch: 39, Steps: 64 | Train Loss: 0.0828131 Vali Loss: 0.1537332 Test Loss: 0.1484093
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 40 cost time: 0.950355052947998
Epoch: 40, Steps: 64 | Train Loss: 0.0827898 Vali Loss: 0.1553035 Test Loss: 0.1485610
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 41 cost time: 0.952376127243042
Epoch: 41, Steps: 64 | Train Loss: 0.0833178 Vali Loss: 0.1537116 Test Loss: 0.1482282
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 42 cost time: 0.9513592720031738
Epoch: 42, Steps: 64 | Train Loss: 0.0828865 Vali Loss: 0.1552776 Test Loss: 0.1483453
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 43 cost time: 0.9517405033111572
Epoch: 43, Steps: 64 | Train Loss: 0.0828682 Vali Loss: 0.1540769 Test Loss: 0.1486520
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 44 cost time: 0.9509711265563965
Epoch: 44, Steps: 64 | Train Loss: 0.0831048 Vali Loss: 0.1539571 Test Loss: 0.1486645
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 45 cost time: 0.9409985542297363
Epoch: 45, Steps: 64 | Train Loss: 0.0825594 Vali Loss: 0.1544493 Test Loss: 0.1486743
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 46 cost time: 0.9346563816070557
Epoch: 46, Steps: 64 | Train Loss: 0.0826277 Vali Loss: 0.1550594 Test Loss: 0.1487516
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 47 cost time: 0.9296391010284424
Epoch: 47, Steps: 64 | Train Loss: 0.0829211 Vali Loss: 0.1546630 Test Loss: 0.1490094
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 48 cost time: 0.9329288005828857
Epoch: 48, Steps: 64 | Train Loss: 0.0824158 Vali Loss: 0.1541280 Test Loss: 0.1483164
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 49 cost time: 0.9454293251037598
Epoch: 49, Steps: 64 | Train Loss: 0.0824729 Vali Loss: 0.1530909 Test Loss: 0.1489485
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 50 cost time: 0.950385332107544
Epoch: 50, Steps: 64 | Train Loss: 0.0825940 Vali Loss: 0.1547836 Test Loss: 0.1487433
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 51 cost time: 0.9454245567321777
Epoch: 51, Steps: 64 | Train Loss: 0.0825278 Vali Loss: 0.1555896 Test Loss: 0.1487252
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 52 cost time: 0.9544038772583008
Epoch: 52, Steps: 64 | Train Loss: 0.0826981 Vali Loss: 0.1549195 Test Loss: 0.1485305
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 53 cost time: 0.9647774696350098
Epoch: 53, Steps: 64 | Train Loss: 0.0832059 Vali Loss: 0.1534416 Test Loss: 0.1483654
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 54 cost time: 0.9480001926422119
Epoch: 54, Steps: 64 | Train Loss: 0.0825201 Vali Loss: 0.1541602 Test Loss: 0.1483740
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 55 cost time: 0.9439983367919922
Epoch: 55, Steps: 64 | Train Loss: 0.0821878 Vali Loss: 0.1540949 Test Loss: 0.1490635
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 56 cost time: 0.948488712310791
Epoch: 56, Steps: 64 | Train Loss: 0.0824275 Vali Loss: 0.1534450 Test Loss: 0.1487628
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 57 cost time: 0.9624536037445068
Epoch: 57, Steps: 64 | Train Loss: 0.0827006 Vali Loss: 0.1546022 Test Loss: 0.1491631
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 58 cost time: 0.9663152694702148
Epoch: 58, Steps: 64 | Train Loss: 0.0829501 Vali Loss: 0.1559368 Test Loss: 0.1489855
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 59 cost time: 0.9684016704559326
Epoch: 59, Steps: 64 | Train Loss: 0.0819869 Vali Loss: 0.1536784 Test Loss: 0.1486301
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020412445068359375 GB
GPU已分配内存的峰值：0.06558513641357422 GB
Epoch: 60 cost time: 0.9640865325927734
Epoch: 60, Steps: 64 | Train Loss: 0.0825250 Vali Loss: 0.1551350 Test Loss: 0.1487796
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14729592204093933, mae:0.2910010516643524, rse:0.20427551865577698
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05749082565307617 GB
Epoch: 1 cost time: 2.303959369659424
Epoch: 1, Steps: 64 | Train Loss: 0.8926216 Vali Loss: 2.0042615 Test Loss: 3.8361747
Validation loss decreased (inf --> 2.004261).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 2 cost time: 0.89603590965271
Epoch: 2, Steps: 64 | Train Loss: 0.7115035 Vali Loss: 1.2522826 Test Loss: 2.2878964
Validation loss decreased (2.004261 --> 1.252283).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 3 cost time: 0.8854846954345703
Epoch: 3, Steps: 64 | Train Loss: 0.4850193 Vali Loss: 0.9118580 Test Loss: 1.5883242
Validation loss decreased (1.252283 --> 0.911858).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 4 cost time: 0.8897662162780762
Epoch: 4, Steps: 64 | Train Loss: 0.3627297 Vali Loss: 0.7046259 Test Loss: 1.1815397
Validation loss decreased (0.911858 --> 0.704626).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 5 cost time: 0.8740003108978271
Epoch: 5, Steps: 64 | Train Loss: 0.2831082 Vali Loss: 0.5646524 Test Loss: 0.8968145
Validation loss decreased (0.704626 --> 0.564652).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 6 cost time: 0.8672921657562256
Epoch: 6, Steps: 64 | Train Loss: 0.2295641 Vali Loss: 0.4662406 Test Loss: 0.6999914
Validation loss decreased (0.564652 --> 0.466241).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 7 cost time: 0.8776729106903076
Epoch: 7, Steps: 64 | Train Loss: 0.1937760 Vali Loss: 0.3930935 Test Loss: 0.5599015
Validation loss decreased (0.466241 --> 0.393094).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 8 cost time: 0.8740980625152588
Epoch: 8, Steps: 64 | Train Loss: 0.1683985 Vali Loss: 0.3401929 Test Loss: 0.4640585
Validation loss decreased (0.393094 --> 0.340193).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 9 cost time: 0.8923587799072266
Epoch: 9, Steps: 64 | Train Loss: 0.1512418 Vali Loss: 0.3023203 Test Loss: 0.3911112
Validation loss decreased (0.340193 --> 0.302320).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 10 cost time: 0.9054269790649414
Epoch: 10, Steps: 64 | Train Loss: 0.1394054 Vali Loss: 0.2746672 Test Loss: 0.3384001
Validation loss decreased (0.302320 --> 0.274667).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 11 cost time: 0.9078071117401123
Epoch: 11, Steps: 64 | Train Loss: 0.1290266 Vali Loss: 0.2577445 Test Loss: 0.3040126
Validation loss decreased (0.274667 --> 0.257744).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 12 cost time: 0.9119999408721924
Epoch: 12, Steps: 64 | Train Loss: 0.1225544 Vali Loss: 0.2398461 Test Loss: 0.2761866
Validation loss decreased (0.257744 --> 0.239846).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 13 cost time: 0.9076523780822754
Epoch: 13, Steps: 64 | Train Loss: 0.1173162 Vali Loss: 0.2289720 Test Loss: 0.2539002
Validation loss decreased (0.239846 --> 0.228972).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 14 cost time: 0.887131929397583
Epoch: 14, Steps: 64 | Train Loss: 0.1140400 Vali Loss: 0.2197326 Test Loss: 0.2387990
Validation loss decreased (0.228972 --> 0.219733).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 15 cost time: 0.8914463520050049
Epoch: 15, Steps: 64 | Train Loss: 0.1110375 Vali Loss: 0.2113194 Test Loss: 0.2229915
Validation loss decreased (0.219733 --> 0.211319).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 16 cost time: 0.895493745803833
Epoch: 16, Steps: 64 | Train Loss: 0.1083709 Vali Loss: 0.2071161 Test Loss: 0.2154832
Validation loss decreased (0.211319 --> 0.207116).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 17 cost time: 0.8878226280212402
Epoch: 17, Steps: 64 | Train Loss: 0.1062282 Vali Loss: 0.2018168 Test Loss: 0.2065875
Validation loss decreased (0.207116 --> 0.201817).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 18 cost time: 0.9097232818603516
Epoch: 18, Steps: 64 | Train Loss: 0.1048764 Vali Loss: 0.1981360 Test Loss: 0.1999132
Validation loss decreased (0.201817 --> 0.198136).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 19 cost time: 0.9106621742248535
Epoch: 19, Steps: 64 | Train Loss: 0.1038286 Vali Loss: 0.1941851 Test Loss: 0.1949400
Validation loss decreased (0.198136 --> 0.194185).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 20 cost time: 0.9136049747467041
Epoch: 20, Steps: 64 | Train Loss: 0.1022749 Vali Loss: 0.1914093 Test Loss: 0.1923661
Validation loss decreased (0.194185 --> 0.191409).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 21 cost time: 0.9104371070861816
Epoch: 21, Steps: 64 | Train Loss: 0.1018143 Vali Loss: 0.1895709 Test Loss: 0.1870967
Validation loss decreased (0.191409 --> 0.189571).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 22 cost time: 0.8993713855743408
Epoch: 22, Steps: 64 | Train Loss: 0.1008735 Vali Loss: 0.1895695 Test Loss: 0.1855382
Validation loss decreased (0.189571 --> 0.189570).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 23 cost time: 0.8763735294342041
Epoch: 23, Steps: 64 | Train Loss: 0.0998234 Vali Loss: 0.1861119 Test Loss: 0.1812083
Validation loss decreased (0.189570 --> 0.186112).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 24 cost time: 0.8717455863952637
Epoch: 24, Steps: 64 | Train Loss: 0.0990629 Vali Loss: 0.1852346 Test Loss: 0.1811299
Validation loss decreased (0.186112 --> 0.185235).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 25 cost time: 0.8669998645782471
Epoch: 25, Steps: 64 | Train Loss: 0.0992758 Vali Loss: 0.1845861 Test Loss: 0.1772281
Validation loss decreased (0.185235 --> 0.184586).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 26 cost time: 0.8780004978179932
Epoch: 26, Steps: 64 | Train Loss: 0.0988631 Vali Loss: 0.1822927 Test Loss: 0.1752721
Validation loss decreased (0.184586 --> 0.182293).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 27 cost time: 0.9011831283569336
Epoch: 27, Steps: 64 | Train Loss: 0.0986127 Vali Loss: 0.1814386 Test Loss: 0.1734587
Validation loss decreased (0.182293 --> 0.181439).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 28 cost time: 0.8914120197296143
Epoch: 28, Steps: 64 | Train Loss: 0.0976157 Vali Loss: 0.1814105 Test Loss: 0.1731903
Validation loss decreased (0.181439 --> 0.181411).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 29 cost time: 0.8973948955535889
Epoch: 29, Steps: 64 | Train Loss: 0.0977794 Vali Loss: 0.1805477 Test Loss: 0.1736588
Validation loss decreased (0.181411 --> 0.180548).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 30 cost time: 0.8697607517242432
Epoch: 30, Steps: 64 | Train Loss: 0.0976410 Vali Loss: 0.1802777 Test Loss: 0.1721030
Validation loss decreased (0.180548 --> 0.180278).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 31 cost time: 0.9053518772125244
Epoch: 31, Steps: 64 | Train Loss: 0.0970602 Vali Loss: 0.1789672 Test Loss: 0.1707745
Validation loss decreased (0.180278 --> 0.178967).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 32 cost time: 0.9026410579681396
Epoch: 32, Steps: 64 | Train Loss: 0.0963746 Vali Loss: 0.1770424 Test Loss: 0.1701524
Validation loss decreased (0.178967 --> 0.177042).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 33 cost time: 0.9026522636413574
Epoch: 33, Steps: 64 | Train Loss: 0.0968464 Vali Loss: 0.1763265 Test Loss: 0.1692575
Validation loss decreased (0.177042 --> 0.176326).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 34 cost time: 0.8936190605163574
Epoch: 34, Steps: 64 | Train Loss: 0.0970559 Vali Loss: 0.1777016 Test Loss: 0.1693997
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 35 cost time: 0.9089996814727783
Epoch: 35, Steps: 64 | Train Loss: 0.0966881 Vali Loss: 0.1784504 Test Loss: 0.1692576
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 36 cost time: 0.9116353988647461
Epoch: 36, Steps: 64 | Train Loss: 0.0962909 Vali Loss: 0.1771377 Test Loss: 0.1677691
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 37 cost time: 0.9073801040649414
Epoch: 37, Steps: 64 | Train Loss: 0.0959698 Vali Loss: 0.1782454 Test Loss: 0.1686035
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 38 cost time: 0.9097988605499268
Epoch: 38, Steps: 64 | Train Loss: 0.0963846 Vali Loss: 0.1768014 Test Loss: 0.1679783
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 39 cost time: 0.9049980640411377
Epoch: 39, Steps: 64 | Train Loss: 0.0958833 Vali Loss: 0.1756373 Test Loss: 0.1675941
Validation loss decreased (0.176326 --> 0.175637).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 40 cost time: 0.9086418151855469
Epoch: 40, Steps: 64 | Train Loss: 0.0957914 Vali Loss: 0.1748008 Test Loss: 0.1664910
Validation loss decreased (0.175637 --> 0.174801).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 41 cost time: 0.8957726955413818
Epoch: 41, Steps: 64 | Train Loss: 0.0956498 Vali Loss: 0.1744688 Test Loss: 0.1668979
Validation loss decreased (0.174801 --> 0.174469).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 42 cost time: 0.8843836784362793
Epoch: 42, Steps: 64 | Train Loss: 0.0957749 Vali Loss: 0.1750709 Test Loss: 0.1656834
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 43 cost time: 0.8925325870513916
Epoch: 43, Steps: 64 | Train Loss: 0.0957735 Vali Loss: 0.1741953 Test Loss: 0.1660871
Validation loss decreased (0.174469 --> 0.174195).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 44 cost time: 0.9147524833679199
Epoch: 44, Steps: 64 | Train Loss: 0.0955763 Vali Loss: 0.1754186 Test Loss: 0.1661709
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 45 cost time: 0.8997814655303955
Epoch: 45, Steps: 64 | Train Loss: 0.0952979 Vali Loss: 0.1751865 Test Loss: 0.1653054
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 46 cost time: 0.8916442394256592
Epoch: 46, Steps: 64 | Train Loss: 0.0956186 Vali Loss: 0.1737749 Test Loss: 0.1649761
Validation loss decreased (0.174195 --> 0.173775).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 47 cost time: 0.887643575668335
Epoch: 47, Steps: 64 | Train Loss: 0.0953022 Vali Loss: 0.1744366 Test Loss: 0.1653965
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 48 cost time: 0.8795738220214844
Epoch: 48, Steps: 64 | Train Loss: 0.0952516 Vali Loss: 0.1744571 Test Loss: 0.1651220
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 49 cost time: 0.8643627166748047
Epoch: 49, Steps: 64 | Train Loss: 0.0955136 Vali Loss: 0.1746179 Test Loss: 0.1656001
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 50 cost time: 0.8674983978271484
Epoch: 50, Steps: 64 | Train Loss: 0.0956091 Vali Loss: 0.1753560 Test Loss: 0.1652214
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 51 cost time: 0.8785157203674316
Epoch: 51, Steps: 64 | Train Loss: 0.0951582 Vali Loss: 0.1738582 Test Loss: 0.1644844
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 52 cost time: 0.9040005207061768
Epoch: 52, Steps: 64 | Train Loss: 0.0947575 Vali Loss: 0.1738411 Test Loss: 0.1633314
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 53 cost time: 0.9106454849243164
Epoch: 53, Steps: 64 | Train Loss: 0.0952639 Vali Loss: 0.1735374 Test Loss: 0.1658265
Validation loss decreased (0.173775 --> 0.173537).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 54 cost time: 0.887364387512207
Epoch: 54, Steps: 64 | Train Loss: 0.0951923 Vali Loss: 0.1739061 Test Loss: 0.1646028
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 55 cost time: 0.8955180644989014
Epoch: 55, Steps: 64 | Train Loss: 0.0953380 Vali Loss: 0.1748127 Test Loss: 0.1642059
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 56 cost time: 0.8930108547210693
Epoch: 56, Steps: 64 | Train Loss: 0.0947905 Vali Loss: 0.1751374 Test Loss: 0.1645222
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 57 cost time: 0.8767707347869873
Epoch: 57, Steps: 64 | Train Loss: 0.0955847 Vali Loss: 0.1741814 Test Loss: 0.1629121
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 58 cost time: 0.8830001354217529
Epoch: 58, Steps: 64 | Train Loss: 0.0950871 Vali Loss: 0.1730443 Test Loss: 0.1649301
Validation loss decreased (0.173537 --> 0.173044).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 59 cost time: 0.8856496810913086
Epoch: 59, Steps: 64 | Train Loss: 0.0950353 Vali Loss: 0.1742476 Test Loss: 0.1635660
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018255233764648438 GB
GPU已分配内存的峰值：0.05915021896362305 GB
Epoch: 60 cost time: 0.8867137432098389
Epoch: 60, Steps: 64 | Train Loss: 0.0950954 Vali Loss: 0.1739777 Test Loss: 0.1643308
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.16493014991283417, mae:0.315886914730072, rse:0.21615783870220184
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06063699722290039 GB
Epoch: 1 cost time: 2.3321516513824463
Epoch: 1, Steps: 64 | Train Loss: 0.8093601 Vali Loss: 1.8626415 Test Loss: 3.5535717
Validation loss decreased (inf --> 1.862641).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 2 cost time: 0.9454300403594971
Epoch: 2, Steps: 64 | Train Loss: 0.5226060 Vali Loss: 0.4846861 Test Loss: 0.7298021
Validation loss decreased (1.862641 --> 0.484686).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 3 cost time: 0.9504110813140869
Epoch: 3, Steps: 64 | Train Loss: 0.1522843 Vali Loss: 0.1855939 Test Loss: 0.1487190
Validation loss decreased (0.484686 --> 0.185594).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 4 cost time: 0.9423189163208008
Epoch: 4, Steps: 64 | Train Loss: 0.1088070 Vali Loss: 0.1803778 Test Loss: 0.1557390
Validation loss decreased (0.185594 --> 0.180378).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 5 cost time: 0.9275391101837158
Epoch: 5, Steps: 64 | Train Loss: 0.1033638 Vali Loss: 0.1713388 Test Loss: 0.1505708
Validation loss decreased (0.180378 --> 0.171339).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 6 cost time: 0.8940789699554443
Epoch: 6, Steps: 64 | Train Loss: 0.0997907 Vali Loss: 0.1717061 Test Loss: 0.1468640
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 7 cost time: 0.8947553634643555
Epoch: 7, Steps: 64 | Train Loss: 0.0979173 Vali Loss: 0.1684897 Test Loss: 0.1470726
Validation loss decreased (0.171339 --> 0.168490).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 8 cost time: 0.9030001163482666
Epoch: 8, Steps: 64 | Train Loss: 0.0965112 Vali Loss: 0.1641422 Test Loss: 0.1461884
Validation loss decreased (0.168490 --> 0.164142).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 9 cost time: 0.9240355491638184
Epoch: 9, Steps: 64 | Train Loss: 0.0943802 Vali Loss: 0.1639516 Test Loss: 0.1456075
Validation loss decreased (0.164142 --> 0.163952).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 10 cost time: 0.9280507564544678
Epoch: 10, Steps: 64 | Train Loss: 0.0935420 Vali Loss: 0.1630328 Test Loss: 0.1464289
Validation loss decreased (0.163952 --> 0.163033).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 11 cost time: 0.920405387878418
Epoch: 11, Steps: 64 | Train Loss: 0.0922584 Vali Loss: 0.1623173 Test Loss: 0.1449720
Validation loss decreased (0.163033 --> 0.162317).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 12 cost time: 0.9585623741149902
Epoch: 12, Steps: 64 | Train Loss: 0.0913090 Vali Loss: 0.1620702 Test Loss: 0.1451064
Validation loss decreased (0.162317 --> 0.162070).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 13 cost time: 0.926001787185669
Epoch: 13, Steps: 64 | Train Loss: 0.0904932 Vali Loss: 0.1602140 Test Loss: 0.1463476
Validation loss decreased (0.162070 --> 0.160214).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 14 cost time: 0.9264814853668213
Epoch: 14, Steps: 64 | Train Loss: 0.0903438 Vali Loss: 0.1634584 Test Loss: 0.1468055
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 15 cost time: 0.9238462448120117
Epoch: 15, Steps: 64 | Train Loss: 0.0896181 Vali Loss: 0.1597546 Test Loss: 0.1446162
Validation loss decreased (0.160214 --> 0.159755).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 16 cost time: 0.9267423152923584
Epoch: 16, Steps: 64 | Train Loss: 0.0890944 Vali Loss: 0.1624725 Test Loss: 0.1474663
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 17 cost time: 0.9344058036804199
Epoch: 17, Steps: 64 | Train Loss: 0.0891408 Vali Loss: 0.1587186 Test Loss: 0.1467307
Validation loss decreased (0.159755 --> 0.158719).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 18 cost time: 0.9496269226074219
Epoch: 18, Steps: 64 | Train Loss: 0.0885171 Vali Loss: 0.1627274 Test Loss: 0.1483701
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 19 cost time: 0.9386115074157715
Epoch: 19, Steps: 64 | Train Loss: 0.0881212 Vali Loss: 0.1627852 Test Loss: 0.1484241
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 20 cost time: 0.9540901184082031
Epoch: 20, Steps: 64 | Train Loss: 0.0877155 Vali Loss: 0.1612884 Test Loss: 0.1488526
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 21 cost time: 0.9467840194702148
Epoch: 21, Steps: 64 | Train Loss: 0.0875537 Vali Loss: 0.1596123 Test Loss: 0.1485983
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 22 cost time: 0.9284107685089111
Epoch: 22, Steps: 64 | Train Loss: 0.0867543 Vali Loss: 0.1600830 Test Loss: 0.1490722
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 23 cost time: 0.9188127517700195
Epoch: 23, Steps: 64 | Train Loss: 0.0867939 Vali Loss: 0.1595981 Test Loss: 0.1489946
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 24 cost time: 0.900904655456543
Epoch: 24, Steps: 64 | Train Loss: 0.0865337 Vali Loss: 0.1593595 Test Loss: 0.1492437
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 25 cost time: 0.9156951904296875
Epoch: 25, Steps: 64 | Train Loss: 0.0863740 Vali Loss: 0.1588978 Test Loss: 0.1499086
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 26 cost time: 0.929772138595581
Epoch: 26, Steps: 64 | Train Loss: 0.0860609 Vali Loss: 0.1587396 Test Loss: 0.1495570
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 27 cost time: 0.9230391979217529
Epoch: 27, Steps: 64 | Train Loss: 0.0859615 Vali Loss: 0.1593688 Test Loss: 0.1501940
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 28 cost time: 0.9233903884887695
Epoch: 28, Steps: 64 | Train Loss: 0.0861387 Vali Loss: 0.1586804 Test Loss: 0.1507484
Validation loss decreased (0.158719 --> 0.158680).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 29 cost time: 0.9225020408630371
Epoch: 29, Steps: 64 | Train Loss: 0.0855016 Vali Loss: 0.1603661 Test Loss: 0.1499366
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 30 cost time: 0.8933882713317871
Epoch: 30, Steps: 64 | Train Loss: 0.0853813 Vali Loss: 0.1584124 Test Loss: 0.1497838
Validation loss decreased (0.158680 --> 0.158412).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 31 cost time: 0.8959522247314453
Epoch: 31, Steps: 64 | Train Loss: 0.0857385 Vali Loss: 0.1590566 Test Loss: 0.1507909
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 32 cost time: 0.904757022857666
Epoch: 32, Steps: 64 | Train Loss: 0.0857808 Vali Loss: 0.1594492 Test Loss: 0.1505271
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 33 cost time: 0.9129977226257324
Epoch: 33, Steps: 64 | Train Loss: 0.0854865 Vali Loss: 0.1602186 Test Loss: 0.1505102
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 34 cost time: 0.948636531829834
Epoch: 34, Steps: 64 | Train Loss: 0.0849930 Vali Loss: 0.1586478 Test Loss: 0.1514575
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 35 cost time: 0.946291446685791
Epoch: 35, Steps: 64 | Train Loss: 0.0849333 Vali Loss: 0.1606832 Test Loss: 0.1520167
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 36 cost time: 0.955378532409668
Epoch: 36, Steps: 64 | Train Loss: 0.0852881 Vali Loss: 0.1580339 Test Loss: 0.1507956
Validation loss decreased (0.158412 --> 0.158034).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 37 cost time: 0.9411239624023438
Epoch: 37, Steps: 64 | Train Loss: 0.0850679 Vali Loss: 0.1597038 Test Loss: 0.1521285
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 38 cost time: 0.9376492500305176
Epoch: 38, Steps: 64 | Train Loss: 0.0848127 Vali Loss: 0.1597480 Test Loss: 0.1515194
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 39 cost time: 0.9423937797546387
Epoch: 39, Steps: 64 | Train Loss: 0.0845730 Vali Loss: 0.1595401 Test Loss: 0.1516251
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 40 cost time: 0.9289007186889648
Epoch: 40, Steps: 64 | Train Loss: 0.0848460 Vali Loss: 0.1593726 Test Loss: 0.1518186
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 41 cost time: 0.9257466793060303
Epoch: 41, Steps: 64 | Train Loss: 0.0848255 Vali Loss: 0.1587983 Test Loss: 0.1518869
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 42 cost time: 0.94700026512146
Epoch: 42, Steps: 64 | Train Loss: 0.0847513 Vali Loss: 0.1602865 Test Loss: 0.1520130
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 43 cost time: 0.9466583728790283
Epoch: 43, Steps: 64 | Train Loss: 0.0846476 Vali Loss: 0.1591630 Test Loss: 0.1522406
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 44 cost time: 0.9296250343322754
Epoch: 44, Steps: 64 | Train Loss: 0.0845160 Vali Loss: 0.1603022 Test Loss: 0.1518999
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 45 cost time: 0.9254400730133057
Epoch: 45, Steps: 64 | Train Loss: 0.0846772 Vali Loss: 0.1593991 Test Loss: 0.1515854
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 46 cost time: 0.915259599685669
Epoch: 46, Steps: 64 | Train Loss: 0.0845480 Vali Loss: 0.1601376 Test Loss: 0.1522603
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 47 cost time: 0.9063665866851807
Epoch: 47, Steps: 64 | Train Loss: 0.0851461 Vali Loss: 0.1597944 Test Loss: 0.1520350
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 48 cost time: 0.9080500602722168
Epoch: 48, Steps: 64 | Train Loss: 0.0849996 Vali Loss: 0.1590460 Test Loss: 0.1521356
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 49 cost time: 0.9107251167297363
Epoch: 49, Steps: 64 | Train Loss: 0.0845203 Vali Loss: 0.1585919 Test Loss: 0.1518660
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 50 cost time: 0.926999568939209
Epoch: 50, Steps: 64 | Train Loss: 0.0850170 Vali Loss: 0.1599906 Test Loss: 0.1519452
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 51 cost time: 0.9286320209503174
Epoch: 51, Steps: 64 | Train Loss: 0.0849035 Vali Loss: 0.1590739 Test Loss: 0.1521113
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 52 cost time: 0.922130823135376
Epoch: 52, Steps: 64 | Train Loss: 0.0848939 Vali Loss: 0.1602133 Test Loss: 0.1522671
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 53 cost time: 0.9314210414886475
Epoch: 53, Steps: 64 | Train Loss: 0.0843708 Vali Loss: 0.1595154 Test Loss: 0.1522518
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 54 cost time: 0.9043712615966797
Epoch: 54, Steps: 64 | Train Loss: 0.0846058 Vali Loss: 0.1600553 Test Loss: 0.1527561
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 55 cost time: 0.923424482345581
Epoch: 55, Steps: 64 | Train Loss: 0.0847626 Vali Loss: 0.1576540 Test Loss: 0.1515220
Validation loss decreased (0.158034 --> 0.157654).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 56 cost time: 0.9247486591339111
Epoch: 56, Steps: 64 | Train Loss: 0.0844290 Vali Loss: 0.1595829 Test Loss: 0.1525723
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 57 cost time: 0.9237289428710938
Epoch: 57, Steps: 64 | Train Loss: 0.0848725 Vali Loss: 0.1587026 Test Loss: 0.1521699
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 58 cost time: 0.9369983673095703
Epoch: 58, Steps: 64 | Train Loss: 0.0845707 Vali Loss: 0.1600804 Test Loss: 0.1523936
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 59 cost time: 0.9406194686889648
Epoch: 59, Steps: 64 | Train Loss: 0.0848373 Vali Loss: 0.1601699 Test Loss: 0.1521945
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019544601440429688 GB
GPU已分配内存的峰值：0.06223917007446289 GB
Epoch: 60 cost time: 0.9483740329742432
Epoch: 60, Steps: 64 | Train Loss: 0.0844831 Vali Loss: 0.1595582 Test Loss: 0.1520988
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15152201056480408, mae:0.29860082268714905, rse:0.20718525350093842
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06383180618286133 GB
Epoch: 1 cost time: 2.339231252670288
Epoch: 1, Steps: 64 | Train Loss: 0.7439859 Vali Loss: 1.7368994 Test Loss: 3.2837586
Validation loss decreased (inf --> 1.736899).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 2 cost time: 0.9746410846710205
Epoch: 2, Steps: 64 | Train Loss: 0.4005266 Vali Loss: 0.2075860 Test Loss: 0.1672090
Validation loss decreased (1.736899 --> 0.207586).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 3 cost time: 0.9390721321105957
Epoch: 3, Steps: 64 | Train Loss: 0.1217820 Vali Loss: 0.1970029 Test Loss: 0.1792785
Validation loss decreased (0.207586 --> 0.197003).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 4 cost time: 0.9508111476898193
Epoch: 4, Steps: 64 | Train Loss: 0.1071596 Vali Loss: 0.1765921 Test Loss: 0.1525116
Validation loss decreased (0.197003 --> 0.176592).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 5 cost time: 0.9203536510467529
Epoch: 5, Steps: 64 | Train Loss: 0.1020596 Vali Loss: 0.1746828 Test Loss: 0.1491694
Validation loss decreased (0.176592 --> 0.174683).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 6 cost time: 0.9270195960998535
Epoch: 6, Steps: 64 | Train Loss: 0.0990580 Vali Loss: 0.1723410 Test Loss: 0.1500231
Validation loss decreased (0.174683 --> 0.172341).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 7 cost time: 0.9309983253479004
Epoch: 7, Steps: 64 | Train Loss: 0.0964361 Vali Loss: 0.1669233 Test Loss: 0.1465007
Validation loss decreased (0.172341 --> 0.166923).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 8 cost time: 0.926262378692627
Epoch: 8, Steps: 64 | Train Loss: 0.0952086 Vali Loss: 0.1670240 Test Loss: 0.1474257
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 9 cost time: 0.9569079875946045
Epoch: 9, Steps: 64 | Train Loss: 0.0937535 Vali Loss: 0.1699904 Test Loss: 0.1495131
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 10 cost time: 0.9527175426483154
Epoch: 10, Steps: 64 | Train Loss: 0.0923033 Vali Loss: 0.1658775 Test Loss: 0.1464239
Validation loss decreased (0.166923 --> 0.165878).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 11 cost time: 0.9569981098175049
Epoch: 11, Steps: 64 | Train Loss: 0.0918791 Vali Loss: 0.1688557 Test Loss: 0.1511212
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 12 cost time: 0.9656336307525635
Epoch: 12, Steps: 64 | Train Loss: 0.0903745 Vali Loss: 0.1657676 Test Loss: 0.1488111
Validation loss decreased (0.165878 --> 0.165768).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 13 cost time: 0.9496486186981201
Epoch: 13, Steps: 64 | Train Loss: 0.0899800 Vali Loss: 0.1658544 Test Loss: 0.1493334
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 14 cost time: 0.9464049339294434
Epoch: 14, Steps: 64 | Train Loss: 0.0897681 Vali Loss: 0.1661797 Test Loss: 0.1502199
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 15 cost time: 0.9514904022216797
Epoch: 15, Steps: 64 | Train Loss: 0.0891260 Vali Loss: 0.1643252 Test Loss: 0.1492687
Validation loss decreased (0.165768 --> 0.164325).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 16 cost time: 0.9544100761413574
Epoch: 16, Steps: 64 | Train Loss: 0.0886964 Vali Loss: 0.1666627 Test Loss: 0.1510384
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 17 cost time: 0.9754300117492676
Epoch: 17, Steps: 64 | Train Loss: 0.0880107 Vali Loss: 0.1645845 Test Loss: 0.1506981
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 18 cost time: 0.9710135459899902
Epoch: 18, Steps: 64 | Train Loss: 0.0876644 Vali Loss: 0.1667483 Test Loss: 0.1526769
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 19 cost time: 0.9789915084838867
Epoch: 19, Steps: 64 | Train Loss: 0.0869218 Vali Loss: 0.1631362 Test Loss: 0.1524264
Validation loss decreased (0.164325 --> 0.163136).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 20 cost time: 0.9658336639404297
Epoch: 20, Steps: 64 | Train Loss: 0.0871622 Vali Loss: 0.1648328 Test Loss: 0.1537701
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 21 cost time: 0.9500012397766113
Epoch: 21, Steps: 64 | Train Loss: 0.0864289 Vali Loss: 0.1629546 Test Loss: 0.1527761
Validation loss decreased (0.163136 --> 0.162955).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 22 cost time: 0.9302873611450195
Epoch: 22, Steps: 64 | Train Loss: 0.0861904 Vali Loss: 0.1643315 Test Loss: 0.1525700
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 23 cost time: 0.9199981689453125
Epoch: 23, Steps: 64 | Train Loss: 0.0862804 Vali Loss: 0.1636763 Test Loss: 0.1532900
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 24 cost time: 0.9273605346679688
Epoch: 24, Steps: 64 | Train Loss: 0.0865872 Vali Loss: 0.1646673 Test Loss: 0.1541409
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 25 cost time: 0.9453723430633545
Epoch: 25, Steps: 64 | Train Loss: 0.0855707 Vali Loss: 0.1634575 Test Loss: 0.1536158
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 26 cost time: 0.9604113101959229
Epoch: 26, Steps: 64 | Train Loss: 0.0848987 Vali Loss: 0.1646501 Test Loss: 0.1542067
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 27 cost time: 0.943058967590332
Epoch: 27, Steps: 64 | Train Loss: 0.0855063 Vali Loss: 0.1614956 Test Loss: 0.1540055
Validation loss decreased (0.162955 --> 0.161496).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 28 cost time: 0.9403753280639648
Epoch: 28, Steps: 64 | Train Loss: 0.0851970 Vali Loss: 0.1623588 Test Loss: 0.1551000
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 29 cost time: 0.9405012130737305
Epoch: 29, Steps: 64 | Train Loss: 0.0847701 Vali Loss: 0.1647591 Test Loss: 0.1553065
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 30 cost time: 0.930837869644165
Epoch: 30, Steps: 64 | Train Loss: 0.0852064 Vali Loss: 0.1647496 Test Loss: 0.1554617
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 31 cost time: 0.916999340057373
Epoch: 31, Steps: 64 | Train Loss: 0.0852502 Vali Loss: 0.1636485 Test Loss: 0.1552753
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 32 cost time: 0.9369151592254639
Epoch: 32, Steps: 64 | Train Loss: 0.0846987 Vali Loss: 0.1652226 Test Loss: 0.1561428
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 33 cost time: 0.9706475734710693
Epoch: 33, Steps: 64 | Train Loss: 0.0848198 Vali Loss: 0.1635686 Test Loss: 0.1561538
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 34 cost time: 0.968372106552124
Epoch: 34, Steps: 64 | Train Loss: 0.0845030 Vali Loss: 0.1637607 Test Loss: 0.1567556
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 35 cost time: 0.9714992046356201
Epoch: 35, Steps: 64 | Train Loss: 0.0843032 Vali Loss: 0.1624792 Test Loss: 0.1558361
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 36 cost time: 0.9871675968170166
Epoch: 36, Steps: 64 | Train Loss: 0.0844462 Vali Loss: 0.1625110 Test Loss: 0.1564399
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 37 cost time: 0.9553718566894531
Epoch: 37, Steps: 64 | Train Loss: 0.0846426 Vali Loss: 0.1628278 Test Loss: 0.1566247
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 38 cost time: 0.9495065212249756
Epoch: 38, Steps: 64 | Train Loss: 0.0843907 Vali Loss: 0.1613380 Test Loss: 0.1559520
Validation loss decreased (0.161496 --> 0.161338).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 39 cost time: 0.9523694515228271
Epoch: 39, Steps: 64 | Train Loss: 0.0843309 Vali Loss: 0.1611331 Test Loss: 0.1560534
Validation loss decreased (0.161338 --> 0.161133).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 40 cost time: 0.9675490856170654
Epoch: 40, Steps: 64 | Train Loss: 0.0837072 Vali Loss: 0.1628785 Test Loss: 0.1560839
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 41 cost time: 0.9638528823852539
Epoch: 41, Steps: 64 | Train Loss: 0.0846827 Vali Loss: 0.1640593 Test Loss: 0.1558853
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 42 cost time: 0.9900002479553223
Epoch: 42, Steps: 64 | Train Loss: 0.0843101 Vali Loss: 0.1623954 Test Loss: 0.1565677
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 43 cost time: 0.9509999752044678
Epoch: 43, Steps: 64 | Train Loss: 0.0837368 Vali Loss: 0.1612965 Test Loss: 0.1565764
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 44 cost time: 0.9366436004638672
Epoch: 44, Steps: 64 | Train Loss: 0.0840757 Vali Loss: 0.1634526 Test Loss: 0.1563720
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 45 cost time: 0.9263684749603271
Epoch: 45, Steps: 64 | Train Loss: 0.0841263 Vali Loss: 0.1625113 Test Loss: 0.1568620
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 46 cost time: 0.9224512577056885
Epoch: 46, Steps: 64 | Train Loss: 0.0838111 Vali Loss: 0.1625687 Test Loss: 0.1571331
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 47 cost time: 0.9333605766296387
Epoch: 47, Steps: 64 | Train Loss: 0.0845482 Vali Loss: 0.1634416 Test Loss: 0.1562648
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 48 cost time: 0.9227795600891113
Epoch: 48, Steps: 64 | Train Loss: 0.0836625 Vali Loss: 0.1639464 Test Loss: 0.1564457
EarlyStopping counter: 9 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 49 cost time: 0.9552381038665771
Epoch: 49, Steps: 64 | Train Loss: 0.0840562 Vali Loss: 0.1634613 Test Loss: 0.1562033
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 50 cost time: 0.9457452297210693
Epoch: 50, Steps: 64 | Train Loss: 0.0837529 Vali Loss: 0.1616685 Test Loss: 0.1567702
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 51 cost time: 0.9429984092712402
Epoch: 51, Steps: 64 | Train Loss: 0.0837385 Vali Loss: 0.1645692 Test Loss: 0.1568329
EarlyStopping counter: 12 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 52 cost time: 0.9472589492797852
Epoch: 52, Steps: 64 | Train Loss: 0.0839122 Vali Loss: 0.1622100 Test Loss: 0.1563076
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 53 cost time: 0.9336187839508057
Epoch: 53, Steps: 64 | Train Loss: 0.0836709 Vali Loss: 0.1636181 Test Loss: 0.1571572
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 54 cost time: 0.9473769664764404
Epoch: 54, Steps: 64 | Train Loss: 0.0836674 Vali Loss: 0.1621231 Test Loss: 0.1565553
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 55 cost time: 0.9494009017944336
Epoch: 55, Steps: 64 | Train Loss: 0.0839617 Vali Loss: 0.1621097 Test Loss: 0.1566240
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 56 cost time: 0.9583954811096191
Epoch: 56, Steps: 64 | Train Loss: 0.0840792 Vali Loss: 0.1630724 Test Loss: 0.1565785
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 57 cost time: 0.9684798717498779
Epoch: 57, Steps: 64 | Train Loss: 0.0837746 Vali Loss: 0.1616078 Test Loss: 0.1567259
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 58 cost time: 0.9703564643859863
Epoch: 58, Steps: 64 | Train Loss: 0.0836384 Vali Loss: 0.1623954 Test Loss: 0.1562541
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 59 cost time: 0.9863519668579102
Epoch: 59, Steps: 64 | Train Loss: 0.0839460 Vali Loss: 0.1616636 Test Loss: 0.1577679
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020414352416992188 GB
GPU已分配内存的峰值：0.06574678421020508 GB
Epoch: 60 cost time: 0.9613912105560303
Epoch: 60, Steps: 64 | Train Loss: 0.0837330 Vali Loss: 0.1614322 Test Loss: 0.1571796
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15605339407920837, mae:0.304294228553772, rse:0.21026043593883514
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 964
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.05765199661254883 GB
Epoch: 1 cost time: 2.2986931800842285
Epoch: 1, Steps: 64 | Train Loss: 0.8554338 Vali Loss: 1.9117248 Test Loss: 3.6859081
Validation loss decreased (inf --> 1.911725).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 2 cost time: 0.9123656749725342
Epoch: 2, Steps: 64 | Train Loss: 0.6566103 Vali Loss: 1.0766344 Test Loss: 1.9369233
Validation loss decreased (1.911725 --> 1.076634).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 3 cost time: 0.8948667049407959
Epoch: 3, Steps: 64 | Train Loss: 0.4354956 Vali Loss: 0.8087897 Test Loss: 1.3996648
Validation loss decreased (1.076634 --> 0.808790).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 4 cost time: 0.8879992961883545
Epoch: 4, Steps: 64 | Train Loss: 0.3257383 Vali Loss: 0.6250094 Test Loss: 1.0204729
Validation loss decreased (0.808790 --> 0.625009).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 5 cost time: 0.8656349182128906
Epoch: 5, Steps: 64 | Train Loss: 0.2545911 Vali Loss: 0.4983734 Test Loss: 0.7722822
Validation loss decreased (0.625009 --> 0.498373).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 6 cost time: 0.8671722412109375
Epoch: 6, Steps: 64 | Train Loss: 0.2081750 Vali Loss: 0.4051724 Test Loss: 0.5966985
Validation loss decreased (0.498373 --> 0.405172).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 7 cost time: 0.859307050704956
Epoch: 7, Steps: 64 | Train Loss: 0.1771599 Vali Loss: 0.3501204 Test Loss: 0.4859886
Validation loss decreased (0.405172 --> 0.350120).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 8 cost time: 0.8645131587982178
Epoch: 8, Steps: 64 | Train Loss: 0.1556793 Vali Loss: 0.3046964 Test Loss: 0.3977727
Validation loss decreased (0.350120 --> 0.304696).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 9 cost time: 0.8867740631103516
Epoch: 9, Steps: 64 | Train Loss: 0.1404281 Vali Loss: 0.2703639 Test Loss: 0.3359787
Validation loss decreased (0.304696 --> 0.270364).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 10 cost time: 0.8966732025146484
Epoch: 10, Steps: 64 | Train Loss: 0.1297060 Vali Loss: 0.2470862 Test Loss: 0.2923613
Validation loss decreased (0.270364 --> 0.247086).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 11 cost time: 0.8920013904571533
Epoch: 11, Steps: 64 | Train Loss: 0.1216127 Vali Loss: 0.2304375 Test Loss: 0.2603041
Validation loss decreased (0.247086 --> 0.230437).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 12 cost time: 0.9146339893341064
Epoch: 12, Steps: 64 | Train Loss: 0.1161217 Vali Loss: 0.2165154 Test Loss: 0.2366555
Validation loss decreased (0.230437 --> 0.216515).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 13 cost time: 0.9164032936096191
Epoch: 13, Steps: 64 | Train Loss: 0.1113312 Vali Loss: 0.2090742 Test Loss: 0.2206684
Validation loss decreased (0.216515 --> 0.209074).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 14 cost time: 0.9021315574645996
Epoch: 14, Steps: 64 | Train Loss: 0.1085104 Vali Loss: 0.2031808 Test Loss: 0.2094708
Validation loss decreased (0.209074 --> 0.203181).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 15 cost time: 0.9064903259277344
Epoch: 15, Steps: 64 | Train Loss: 0.1058879 Vali Loss: 0.1958062 Test Loss: 0.1973182
Validation loss decreased (0.203181 --> 0.195806).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 16 cost time: 0.9103913307189941
Epoch: 16, Steps: 64 | Train Loss: 0.1041375 Vali Loss: 0.1926351 Test Loss: 0.1923695
Validation loss decreased (0.195806 --> 0.192635).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 17 cost time: 0.8877615928649902
Epoch: 17, Steps: 64 | Train Loss: 0.1019999 Vali Loss: 0.1881566 Test Loss: 0.1831850
Validation loss decreased (0.192635 --> 0.188157).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 18 cost time: 0.9184463024139404
Epoch: 18, Steps: 64 | Train Loss: 0.1004478 Vali Loss: 0.1847536 Test Loss: 0.1783633
Validation loss decreased (0.188157 --> 0.184754).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 19 cost time: 0.912045955657959
Epoch: 19, Steps: 64 | Train Loss: 0.0999495 Vali Loss: 0.1826692 Test Loss: 0.1756051
Validation loss decreased (0.184754 --> 0.182669).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 20 cost time: 0.9147930145263672
Epoch: 20, Steps: 64 | Train Loss: 0.0989321 Vali Loss: 0.1817931 Test Loss: 0.1721633
Validation loss decreased (0.182669 --> 0.181793).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 21 cost time: 0.9154572486877441
Epoch: 21, Steps: 64 | Train Loss: 0.0979197 Vali Loss: 0.1762303 Test Loss: 0.1689601
Validation loss decreased (0.181793 --> 0.176230).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 22 cost time: 0.9035007953643799
Epoch: 22, Steps: 64 | Train Loss: 0.0973825 Vali Loss: 0.1764021 Test Loss: 0.1675249
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 23 cost time: 0.8883874416351318
Epoch: 23, Steps: 64 | Train Loss: 0.0966921 Vali Loss: 0.1777855 Test Loss: 0.1667958
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 24 cost time: 0.8647744655609131
Epoch: 24, Steps: 64 | Train Loss: 0.0963576 Vali Loss: 0.1752494 Test Loss: 0.1646719
Validation loss decreased (0.176230 --> 0.175249).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 25 cost time: 0.8651108741760254
Epoch: 25, Steps: 64 | Train Loss: 0.0960112 Vali Loss: 0.1766505 Test Loss: 0.1630486
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 26 cost time: 0.8836405277252197
Epoch: 26, Steps: 64 | Train Loss: 0.0953842 Vali Loss: 0.1732925 Test Loss: 0.1626176
Validation loss decreased (0.175249 --> 0.173292).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 27 cost time: 0.8943798542022705
Epoch: 27, Steps: 64 | Train Loss: 0.0950313 Vali Loss: 0.1731020 Test Loss: 0.1610001
Validation loss decreased (0.173292 --> 0.173102).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 28 cost time: 0.8943476676940918
Epoch: 28, Steps: 64 | Train Loss: 0.0946584 Vali Loss: 0.1717080 Test Loss: 0.1607789
Validation loss decreased (0.173102 --> 0.171708).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 29 cost time: 0.9054045677185059
Epoch: 29, Steps: 64 | Train Loss: 0.0949725 Vali Loss: 0.1713495 Test Loss: 0.1596483
Validation loss decreased (0.171708 --> 0.171349).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 30 cost time: 0.9044289588928223
Epoch: 30, Steps: 64 | Train Loss: 0.0946930 Vali Loss: 0.1735835 Test Loss: 0.1601663
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 31 cost time: 0.8589985370635986
Epoch: 31, Steps: 64 | Train Loss: 0.0941250 Vali Loss: 0.1712801 Test Loss: 0.1591606
Validation loss decreased (0.171349 --> 0.171280).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 32 cost time: 0.8637375831604004
Epoch: 32, Steps: 64 | Train Loss: 0.0939156 Vali Loss: 0.1705305 Test Loss: 0.1579961
Validation loss decreased (0.171280 --> 0.170530).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 33 cost time: 0.8653924465179443
Epoch: 33, Steps: 64 | Train Loss: 0.0940926 Vali Loss: 0.1716449 Test Loss: 0.1580693
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 34 cost time: 0.8773910999298096
Epoch: 34, Steps: 64 | Train Loss: 0.0940214 Vali Loss: 0.1721511 Test Loss: 0.1582716
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 35 cost time: 0.9184572696685791
Epoch: 35, Steps: 64 | Train Loss: 0.0940624 Vali Loss: 0.1707985 Test Loss: 0.1573637
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 36 cost time: 0.9105701446533203
Epoch: 36, Steps: 64 | Train Loss: 0.0934613 Vali Loss: 0.1696914 Test Loss: 0.1570747
Validation loss decreased (0.170530 --> 0.169691).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 37 cost time: 0.9314703941345215
Epoch: 37, Steps: 64 | Train Loss: 0.0928355 Vali Loss: 0.1704942 Test Loss: 0.1573967
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 38 cost time: 0.9179995059967041
Epoch: 38, Steps: 64 | Train Loss: 0.0926840 Vali Loss: 0.1709534 Test Loss: 0.1576263
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 39 cost time: 0.9016108512878418
Epoch: 39, Steps: 64 | Train Loss: 0.0927471 Vali Loss: 0.1685657 Test Loss: 0.1570140
Validation loss decreased (0.169691 --> 0.168566).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 40 cost time: 0.9134843349456787
Epoch: 40, Steps: 64 | Train Loss: 0.0931517 Vali Loss: 0.1706051 Test Loss: 0.1568699
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 41 cost time: 0.9074263572692871
Epoch: 41, Steps: 64 | Train Loss: 0.0928871 Vali Loss: 0.1697366 Test Loss: 0.1562285
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 42 cost time: 0.9045188426971436
Epoch: 42, Steps: 64 | Train Loss: 0.0925356 Vali Loss: 0.1681900 Test Loss: 0.1557357
Validation loss decreased (0.168566 --> 0.168190).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 43 cost time: 0.9103739261627197
Epoch: 43, Steps: 64 | Train Loss: 0.0923305 Vali Loss: 0.1683142 Test Loss: 0.1550153
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 44 cost time: 0.9229042530059814
Epoch: 44, Steps: 64 | Train Loss: 0.0923909 Vali Loss: 0.1689480 Test Loss: 0.1553929
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 45 cost time: 0.9093754291534424
Epoch: 45, Steps: 64 | Train Loss: 0.0926363 Vali Loss: 0.1696503 Test Loss: 0.1558258
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 46 cost time: 0.9130003452301025
Epoch: 46, Steps: 64 | Train Loss: 0.0927259 Vali Loss: 0.1692497 Test Loss: 0.1559280
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 47 cost time: 0.9136340618133545
Epoch: 47, Steps: 64 | Train Loss: 0.0923427 Vali Loss: 0.1694922 Test Loss: 0.1550659
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 48 cost time: 0.8664820194244385
Epoch: 48, Steps: 64 | Train Loss: 0.0927400 Vali Loss: 0.1687379 Test Loss: 0.1548145
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 49 cost time: 0.8691179752349854
Epoch: 49, Steps: 64 | Train Loss: 0.0923952 Vali Loss: 0.1691921 Test Loss: 0.1552520
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 50 cost time: 0.8643648624420166
Epoch: 50, Steps: 64 | Train Loss: 0.0922309 Vali Loss: 0.1689132 Test Loss: 0.1553937
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 51 cost time: 0.8757712841033936
Epoch: 51, Steps: 64 | Train Loss: 0.0923219 Vali Loss: 0.1697944 Test Loss: 0.1549115
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 52 cost time: 0.8899986743927002
Epoch: 52, Steps: 64 | Train Loss: 0.0920553 Vali Loss: 0.1690423 Test Loss: 0.1549711
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 53 cost time: 0.894629955291748
Epoch: 53, Steps: 64 | Train Loss: 0.0926468 Vali Loss: 0.1680966 Test Loss: 0.1548941
Validation loss decreased (0.168190 --> 0.168097).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 54 cost time: 0.8963468074798584
Epoch: 54, Steps: 64 | Train Loss: 0.0928067 Vali Loss: 0.1681143 Test Loss: 0.1548986
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 55 cost time: 0.901374340057373
Epoch: 55, Steps: 64 | Train Loss: 0.0922023 Vali Loss: 0.1688203 Test Loss: 0.1546872
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 56 cost time: 0.8864095211029053
Epoch: 56, Steps: 64 | Train Loss: 0.0927826 Vali Loss: 0.1678002 Test Loss: 0.1545835
Validation loss decreased (0.168097 --> 0.167800).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 57 cost time: 0.884772539138794
Epoch: 57, Steps: 64 | Train Loss: 0.0925605 Vali Loss: 0.1695181 Test Loss: 0.1553991
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 58 cost time: 0.8994169235229492
Epoch: 58, Steps: 64 | Train Loss: 0.0921594 Vali Loss: 0.1673089 Test Loss: 0.1547602
Validation loss decreased (0.167800 --> 0.167309).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 59 cost time: 0.8936128616333008
Epoch: 59, Steps: 64 | Train Loss: 0.0919942 Vali Loss: 0.1684718 Test Loss: 0.1545936
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018259048461914062 GB
GPU已分配内存的峰值：0.059313297271728516 GB
Epoch: 60 cost time: 0.8993728160858154
Epoch: 60, Steps: 64 | Train Loss: 0.0923134 Vali Loss: 0.1698327 Test Loss: 0.1551376
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1547602117061615, mae:0.30215689539909363, rse:0.20938743650913239
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 116164
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06079816818237305 GB
Epoch: 1 cost time: 2.3380508422851562
Epoch: 1, Steps: 64 | Train Loss: 0.7495402 Vali Loss: 1.7123150 Test Loss: 3.2383931
Validation loss decreased (inf --> 1.712315).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 2 cost time: 0.9416348934173584
Epoch: 2, Steps: 64 | Train Loss: 0.4275009 Vali Loss: 0.3045489 Test Loss: 0.3804162
Validation loss decreased (1.712315 --> 0.304549).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 3 cost time: 0.9244289398193359
Epoch: 3, Steps: 64 | Train Loss: 0.1266271 Vali Loss: 0.1780739 Test Loss: 0.1466436
Validation loss decreased (0.304549 --> 0.178074).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 4 cost time: 0.9314885139465332
Epoch: 4, Steps: 64 | Train Loss: 0.1078687 Vali Loss: 0.1767126 Test Loss: 0.1556712
Validation loss decreased (0.178074 --> 0.176713).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 5 cost time: 0.895388126373291
Epoch: 5, Steps: 64 | Train Loss: 0.1032036 Vali Loss: 0.1708741 Test Loss: 0.1489292
Validation loss decreased (0.176713 --> 0.170874).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 6 cost time: 0.8961343765258789
Epoch: 6, Steps: 64 | Train Loss: 0.0998319 Vali Loss: 0.1693768 Test Loss: 0.1470689
Validation loss decreased (0.170874 --> 0.169377).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 7 cost time: 0.8951525688171387
Epoch: 7, Steps: 64 | Train Loss: 0.0974559 Vali Loss: 0.1697478 Test Loss: 0.1476026
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 8 cost time: 0.9120004177093506
Epoch: 8, Steps: 64 | Train Loss: 0.0954403 Vali Loss: 0.1667244 Test Loss: 0.1480672
Validation loss decreased (0.169377 --> 0.166724).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 9 cost time: 0.9240002632141113
Epoch: 9, Steps: 64 | Train Loss: 0.0937637 Vali Loss: 0.1655677 Test Loss: 0.1501923
Validation loss decreased (0.166724 --> 0.165568).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 10 cost time: 0.9346356391906738
Epoch: 10, Steps: 64 | Train Loss: 0.0926153 Vali Loss: 0.1654646 Test Loss: 0.1494482
Validation loss decreased (0.165568 --> 0.165465).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 11 cost time: 0.9369356632232666
Epoch: 11, Steps: 64 | Train Loss: 0.0916887 Vali Loss: 0.1657372 Test Loss: 0.1514130
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 12 cost time: 0.9423720836639404
Epoch: 12, Steps: 64 | Train Loss: 0.0910349 Vali Loss: 0.1656087 Test Loss: 0.1506872
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 13 cost time: 0.9423844814300537
Epoch: 13, Steps: 64 | Train Loss: 0.0899646 Vali Loss: 0.1637297 Test Loss: 0.1511627
Validation loss decreased (0.165465 --> 0.163730).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 14 cost time: 0.9375073909759521
Epoch: 14, Steps: 64 | Train Loss: 0.0895916 Vali Loss: 0.1649314 Test Loss: 0.1515919
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 15 cost time: 0.9313876628875732
Epoch: 15, Steps: 64 | Train Loss: 0.0892232 Vali Loss: 0.1612471 Test Loss: 0.1510363
Validation loss decreased (0.163730 --> 0.161247).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 16 cost time: 0.9218392372131348
Epoch: 16, Steps: 64 | Train Loss: 0.0887897 Vali Loss: 0.1616038 Test Loss: 0.1520001
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 17 cost time: 0.9440004825592041
Epoch: 17, Steps: 64 | Train Loss: 0.0881649 Vali Loss: 0.1611904 Test Loss: 0.1508248
Validation loss decreased (0.161247 --> 0.161190).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 18 cost time: 0.9500019550323486
Epoch: 18, Steps: 64 | Train Loss: 0.0876366 Vali Loss: 0.1618713 Test Loss: 0.1509568
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 19 cost time: 0.9463684558868408
Epoch: 19, Steps: 64 | Train Loss: 0.0876220 Vali Loss: 0.1630595 Test Loss: 0.1520066
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 20 cost time: 0.9718215465545654
Epoch: 20, Steps: 64 | Train Loss: 0.0872369 Vali Loss: 0.1612405 Test Loss: 0.1517237
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 21 cost time: 0.9311981201171875
Epoch: 21, Steps: 64 | Train Loss: 0.0867264 Vali Loss: 0.1613614 Test Loss: 0.1510965
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 22 cost time: 0.9143855571746826
Epoch: 22, Steps: 64 | Train Loss: 0.0862119 Vali Loss: 0.1613097 Test Loss: 0.1518917
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 23 cost time: 0.8973674774169922
Epoch: 23, Steps: 64 | Train Loss: 0.0869193 Vali Loss: 0.1615753 Test Loss: 0.1518453
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 24 cost time: 0.9044055938720703
Epoch: 24, Steps: 64 | Train Loss: 0.0863933 Vali Loss: 0.1610001 Test Loss: 0.1513913
Validation loss decreased (0.161190 --> 0.161000).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 25 cost time: 0.9194161891937256
Epoch: 25, Steps: 64 | Train Loss: 0.0861547 Vali Loss: 0.1597940 Test Loss: 0.1515674
Validation loss decreased (0.161000 --> 0.159794).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 26 cost time: 0.9791011810302734
Epoch: 26, Steps: 64 | Train Loss: 0.0859512 Vali Loss: 0.1606652 Test Loss: 0.1512287
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 27 cost time: 0.9320006370544434
Epoch: 27, Steps: 64 | Train Loss: 0.0858673 Vali Loss: 0.1576501 Test Loss: 0.1519284
Validation loss decreased (0.159794 --> 0.157650).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 28 cost time: 0.9266376495361328
Epoch: 28, Steps: 64 | Train Loss: 0.0859481 Vali Loss: 0.1602316 Test Loss: 0.1519686
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 29 cost time: 0.9044053554534912
Epoch: 29, Steps: 64 | Train Loss: 0.0859932 Vali Loss: 0.1594799 Test Loss: 0.1518197
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 30 cost time: 0.8971664905548096
Epoch: 30, Steps: 64 | Train Loss: 0.0857479 Vali Loss: 0.1609193 Test Loss: 0.1517479
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 31 cost time: 0.8944156169891357
Epoch: 31, Steps: 64 | Train Loss: 0.0856589 Vali Loss: 0.1607010 Test Loss: 0.1518415
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 32 cost time: 0.8998157978057861
Epoch: 32, Steps: 64 | Train Loss: 0.0851477 Vali Loss: 0.1578446 Test Loss: 0.1515178
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 33 cost time: 0.9127733707427979
Epoch: 33, Steps: 64 | Train Loss: 0.0851068 Vali Loss: 0.1590087 Test Loss: 0.1516609
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 34 cost time: 0.9390003681182861
Epoch: 34, Steps: 64 | Train Loss: 0.0850990 Vali Loss: 0.1579075 Test Loss: 0.1522098
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 35 cost time: 0.9496469497680664
Epoch: 35, Steps: 64 | Train Loss: 0.0851849 Vali Loss: 0.1583408 Test Loss: 0.1522111
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 36 cost time: 0.9470839500427246
Epoch: 36, Steps: 64 | Train Loss: 0.0851684 Vali Loss: 0.1607864 Test Loss: 0.1518005
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 37 cost time: 0.9434666633605957
Epoch: 37, Steps: 64 | Train Loss: 0.0853057 Vali Loss: 0.1594892 Test Loss: 0.1515398
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 38 cost time: 0.9253463745117188
Epoch: 38, Steps: 64 | Train Loss: 0.0850483 Vali Loss: 0.1594287 Test Loss: 0.1520292
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 39 cost time: 0.9243707656860352
Epoch: 39, Steps: 64 | Train Loss: 0.0850572 Vali Loss: 0.1588694 Test Loss: 0.1518999
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 40 cost time: 0.926433801651001
Epoch: 40, Steps: 64 | Train Loss: 0.0844077 Vali Loss: 0.1602299 Test Loss: 0.1521274
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 41 cost time: 0.9208524227142334
Epoch: 41, Steps: 64 | Train Loss: 0.0848491 Vali Loss: 0.1586361 Test Loss: 0.1521735
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 42 cost time: 0.9607441425323486
Epoch: 42, Steps: 64 | Train Loss: 0.0850071 Vali Loss: 0.1591203 Test Loss: 0.1521463
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 43 cost time: 0.9455492496490479
Epoch: 43, Steps: 64 | Train Loss: 0.0846599 Vali Loss: 0.1604604 Test Loss: 0.1520901
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 44 cost time: 0.947380542755127
Epoch: 44, Steps: 64 | Train Loss: 0.0845428 Vali Loss: 0.1583733 Test Loss: 0.1522014
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 45 cost time: 0.9536240100860596
Epoch: 45, Steps: 64 | Train Loss: 0.0850012 Vali Loss: 0.1589681 Test Loss: 0.1521666
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 46 cost time: 0.8944735527038574
Epoch: 46, Steps: 64 | Train Loss: 0.0847742 Vali Loss: 0.1585472 Test Loss: 0.1517270
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 47 cost time: 0.901390790939331
Epoch: 47, Steps: 64 | Train Loss: 0.0851802 Vali Loss: 0.1593032 Test Loss: 0.1519010
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 48 cost time: 0.8954133987426758
Epoch: 48, Steps: 64 | Train Loss: 0.0848766 Vali Loss: 0.1575124 Test Loss: 0.1519889
Validation loss decreased (0.157650 --> 0.157512).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 49 cost time: 0.9103827476501465
Epoch: 49, Steps: 64 | Train Loss: 0.0840698 Vali Loss: 0.1594025 Test Loss: 0.1525250
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 50 cost time: 0.914557695388794
Epoch: 50, Steps: 64 | Train Loss: 0.0846960 Vali Loss: 0.1590693 Test Loss: 0.1518243
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 51 cost time: 0.9209995269775391
Epoch: 51, Steps: 64 | Train Loss: 0.0843593 Vali Loss: 0.1597126 Test Loss: 0.1520598
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 52 cost time: 0.9246327877044678
Epoch: 52, Steps: 64 | Train Loss: 0.0848487 Vali Loss: 0.1601632 Test Loss: 0.1516564
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 53 cost time: 0.9323768615722656
Epoch: 53, Steps: 64 | Train Loss: 0.0846026 Vali Loss: 0.1584497 Test Loss: 0.1523026
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 54 cost time: 0.8964531421661377
Epoch: 54, Steps: 64 | Train Loss: 0.0848325 Vali Loss: 0.1592118 Test Loss: 0.1520535
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 55 cost time: 0.922344446182251
Epoch: 55, Steps: 64 | Train Loss: 0.0846548 Vali Loss: 0.1579632 Test Loss: 0.1522840
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 56 cost time: 0.9269998073577881
Epoch: 56, Steps: 64 | Train Loss: 0.0845730 Vali Loss: 0.1577722 Test Loss: 0.1521498
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 57 cost time: 0.9253239631652832
Epoch: 57, Steps: 64 | Train Loss: 0.0844890 Vali Loss: 0.1591242 Test Loss: 0.1522980
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 58 cost time: 0.9300000667572021
Epoch: 58, Steps: 64 | Train Loss: 0.0845376 Vali Loss: 0.1595304 Test Loss: 0.1520500
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 59 cost time: 0.9449999332427979
Epoch: 59, Steps: 64 | Train Loss: 0.0845665 Vali Loss: 0.1590894 Test Loss: 0.1521390
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019548416137695312 GB
GPU已分配内存的峰值：0.06240224838256836 GB
Epoch: 60 cost time: 0.9456443786621094
Epoch: 60, Steps: 64 | Train Loss: 0.0842092 Vali Loss: 0.1595741 Test Loss: 0.1523452
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1519888937473297, mae:0.29727891087532043, rse:0.20750421285629272
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=16, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 174244
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06399297714233398 GB
Epoch: 1 cost time: 2.350930690765381
Epoch: 1, Steps: 64 | Train Loss: 0.7621443 Vali Loss: 1.7790422 Test Loss: 3.3861079
Validation loss decreased (inf --> 1.779042).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 2 cost time: 0.9663619995117188
Epoch: 2, Steps: 64 | Train Loss: 0.3908406 Vali Loss: 0.2098870 Test Loss: 0.2185758
Validation loss decreased (1.779042 --> 0.209887).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 3 cost time: 0.9540002346038818
Epoch: 3, Steps: 64 | Train Loss: 0.1173962 Vali Loss: 0.1915138 Test Loss: 0.1773844
Validation loss decreased (0.209887 --> 0.191514).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 4 cost time: 0.9556365013122559
Epoch: 4, Steps: 64 | Train Loss: 0.1031522 Vali Loss: 0.1715984 Test Loss: 0.1484082
Validation loss decreased (0.191514 --> 0.171598).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 5 cost time: 0.9296360015869141
Epoch: 5, Steps: 64 | Train Loss: 0.0998275 Vali Loss: 0.1677794 Test Loss: 0.1453334
Validation loss decreased (0.171598 --> 0.167779).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 6 cost time: 0.9309275150299072
Epoch: 6, Steps: 64 | Train Loss: 0.0966211 Vali Loss: 0.1650602 Test Loss: 0.1451441
Validation loss decreased (0.167779 --> 0.165060).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 7 cost time: 0.928516149520874
Epoch: 7, Steps: 64 | Train Loss: 0.0952509 Vali Loss: 0.1664959 Test Loss: 0.1463476
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 8 cost time: 0.9283545017242432
Epoch: 8, Steps: 64 | Train Loss: 0.0933480 Vali Loss: 0.1655981 Test Loss: 0.1469034
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 9 cost time: 0.9684360027313232
Epoch: 9, Steps: 64 | Train Loss: 0.0919633 Vali Loss: 0.1643703 Test Loss: 0.1473872
Validation loss decreased (0.165060 --> 0.164370).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 10 cost time: 0.9543931484222412
Epoch: 10, Steps: 64 | Train Loss: 0.0913491 Vali Loss: 0.1667382 Test Loss: 0.1479106
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 11 cost time: 0.9627830982208252
Epoch: 11, Steps: 64 | Train Loss: 0.0901073 Vali Loss: 0.1619872 Test Loss: 0.1472498
Validation loss decreased (0.164370 --> 0.161987).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 12 cost time: 0.9917364120483398
Epoch: 12, Steps: 64 | Train Loss: 0.0899066 Vali Loss: 0.1616684 Test Loss: 0.1460499
Validation loss decreased (0.161987 --> 0.161668).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 13 cost time: 0.9589982032775879
Epoch: 13, Steps: 64 | Train Loss: 0.0886092 Vali Loss: 0.1585384 Test Loss: 0.1469509
Validation loss decreased (0.161668 --> 0.158538).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 14 cost time: 0.9544034004211426
Epoch: 14, Steps: 64 | Train Loss: 0.0879355 Vali Loss: 0.1583720 Test Loss: 0.1492322
Validation loss decreased (0.158538 --> 0.158372).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 15 cost time: 0.9596543312072754
Epoch: 15, Steps: 64 | Train Loss: 0.0879110 Vali Loss: 0.1615602 Test Loss: 0.1497146
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 16 cost time: 0.9616503715515137
Epoch: 16, Steps: 64 | Train Loss: 0.0873239 Vali Loss: 0.1617818 Test Loss: 0.1506934
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 17 cost time: 0.9674687385559082
Epoch: 17, Steps: 64 | Train Loss: 0.0871709 Vali Loss: 0.1593095 Test Loss: 0.1499522
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 18 cost time: 1.0675380229949951
Epoch: 18, Steps: 64 | Train Loss: 0.0865693 Vali Loss: 0.1622906 Test Loss: 0.1511695
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 19 cost time: 0.9752981662750244
Epoch: 19, Steps: 64 | Train Loss: 0.0856508 Vali Loss: 0.1603799 Test Loss: 0.1509285
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 20 cost time: 0.9711062908172607
Epoch: 20, Steps: 64 | Train Loss: 0.0860055 Vali Loss: 0.1601758 Test Loss: 0.1520283
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 21 cost time: 0.9535326957702637
Epoch: 21, Steps: 64 | Train Loss: 0.0857337 Vali Loss: 0.1601895 Test Loss: 0.1511891
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 22 cost time: 0.9683980941772461
Epoch: 22, Steps: 64 | Train Loss: 0.0850008 Vali Loss: 0.1599577 Test Loss: 0.1518402
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 23 cost time: 0.972139835357666
Epoch: 23, Steps: 64 | Train Loss: 0.0849292 Vali Loss: 0.1586174 Test Loss: 0.1518268
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 24 cost time: 0.981661319732666
Epoch: 24, Steps: 64 | Train Loss: 0.0847901 Vali Loss: 0.1591414 Test Loss: 0.1528557
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 25 cost time: 0.9637186527252197
Epoch: 25, Steps: 64 | Train Loss: 0.0841178 Vali Loss: 0.1578066 Test Loss: 0.1521866
Validation loss decreased (0.158372 --> 0.157807).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 26 cost time: 0.9539084434509277
Epoch: 26, Steps: 64 | Train Loss: 0.0845323 Vali Loss: 0.1567763 Test Loss: 0.1519523
Validation loss decreased (0.157807 --> 0.156776).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 27 cost time: 0.953639030456543
Epoch: 27, Steps: 64 | Train Loss: 0.0838801 Vali Loss: 0.1579501 Test Loss: 0.1519023
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 28 cost time: 0.9386355876922607
Epoch: 28, Steps: 64 | Train Loss: 0.0840384 Vali Loss: 0.1582187 Test Loss: 0.1526646
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 29 cost time: 0.9186210632324219
Epoch: 29, Steps: 64 | Train Loss: 0.0838389 Vali Loss: 0.1588781 Test Loss: 0.1526912
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 30 cost time: 0.9153757095336914
Epoch: 30, Steps: 64 | Train Loss: 0.0835519 Vali Loss: 0.1583950 Test Loss: 0.1532614
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 31 cost time: 0.9203827381134033
Epoch: 31, Steps: 64 | Train Loss: 0.0831429 Vali Loss: 0.1559539 Test Loss: 0.1531130
Validation loss decreased (0.156776 --> 0.155954).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 32 cost time: 0.9483928680419922
Epoch: 32, Steps: 64 | Train Loss: 0.0834509 Vali Loss: 0.1584246 Test Loss: 0.1526740
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 33 cost time: 0.9763994216918945
Epoch: 33, Steps: 64 | Train Loss: 0.0832162 Vali Loss: 0.1580779 Test Loss: 0.1535507
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 34 cost time: 0.9734141826629639
Epoch: 34, Steps: 64 | Train Loss: 0.0835414 Vali Loss: 0.1568418 Test Loss: 0.1541996
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 35 cost time: 0.9913308620452881
Epoch: 35, Steps: 64 | Train Loss: 0.0835311 Vali Loss: 0.1585964 Test Loss: 0.1540503
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 36 cost time: 0.9638926982879639
Epoch: 36, Steps: 64 | Train Loss: 0.0834479 Vali Loss: 0.1572187 Test Loss: 0.1542785
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 37 cost time: 0.9600017070770264
Epoch: 37, Steps: 64 | Train Loss: 0.0834071 Vali Loss: 0.1574239 Test Loss: 0.1537390
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 38 cost time: 0.958000659942627
Epoch: 38, Steps: 64 | Train Loss: 0.0831721 Vali Loss: 0.1581747 Test Loss: 0.1545136
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 39 cost time: 0.9532463550567627
Epoch: 39, Steps: 64 | Train Loss: 0.0830859 Vali Loss: 0.1595135 Test Loss: 0.1544059
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 40 cost time: 0.967310905456543
Epoch: 40, Steps: 64 | Train Loss: 0.0827313 Vali Loss: 0.1590973 Test Loss: 0.1549828
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 41 cost time: 0.9784057140350342
Epoch: 41, Steps: 64 | Train Loss: 0.0831724 Vali Loss: 0.1583336 Test Loss: 0.1548307
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 42 cost time: 0.9684033393859863
Epoch: 42, Steps: 64 | Train Loss: 0.0828133 Vali Loss: 0.1577084 Test Loss: 0.1548299
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 43 cost time: 0.949427604675293
Epoch: 43, Steps: 64 | Train Loss: 0.0826078 Vali Loss: 0.1576152 Test Loss: 0.1543157
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 44 cost time: 0.9334306716918945
Epoch: 44, Steps: 64 | Train Loss: 0.0830392 Vali Loss: 0.1579297 Test Loss: 0.1548844
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 45 cost time: 0.9283702373504639
Epoch: 45, Steps: 64 | Train Loss: 0.0827721 Vali Loss: 0.1570921 Test Loss: 0.1546893
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 46 cost time: 0.9207413196563721
Epoch: 46, Steps: 64 | Train Loss: 0.0827107 Vali Loss: 0.1577874 Test Loss: 0.1548243
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 47 cost time: 0.9244344234466553
Epoch: 47, Steps: 64 | Train Loss: 0.0823200 Vali Loss: 0.1584089 Test Loss: 0.1548358
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 48 cost time: 0.9406368732452393
Epoch: 48, Steps: 64 | Train Loss: 0.0827926 Vali Loss: 0.1581115 Test Loss: 0.1552669
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 49 cost time: 0.9446365833282471
Epoch: 49, Steps: 64 | Train Loss: 0.0824787 Vali Loss: 0.1586446 Test Loss: 0.1552451
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 50 cost time: 0.9464194774627686
Epoch: 50, Steps: 64 | Train Loss: 0.0827878 Vali Loss: 0.1557518 Test Loss: 0.1550492
Validation loss decreased (0.155954 --> 0.155752).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 51 cost time: 0.9490630626678467
Epoch: 51, Steps: 64 | Train Loss: 0.0827720 Vali Loss: 0.1569604 Test Loss: 0.1553475
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 52 cost time: 0.932243824005127
Epoch: 52, Steps: 64 | Train Loss: 0.0828116 Vali Loss: 0.1584953 Test Loss: 0.1548541
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 53 cost time: 0.9294230937957764
Epoch: 53, Steps: 64 | Train Loss: 0.0827094 Vali Loss: 0.1597231 Test Loss: 0.1555316
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 54 cost time: 0.9530677795410156
Epoch: 54, Steps: 64 | Train Loss: 0.0825257 Vali Loss: 0.1585660 Test Loss: 0.1550592
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 55 cost time: 0.9637410640716553
Epoch: 55, Steps: 64 | Train Loss: 0.0824857 Vali Loss: 0.1570074 Test Loss: 0.1552172
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 56 cost time: 0.9727494716644287
Epoch: 56, Steps: 64 | Train Loss: 0.0829285 Vali Loss: 0.1583568 Test Loss: 0.1553384
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 57 cost time: 0.9839997291564941
Epoch: 57, Steps: 64 | Train Loss: 0.0826137 Vali Loss: 0.1582243 Test Loss: 0.1558874
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 58 cost time: 0.9870021343231201
Epoch: 58, Steps: 64 | Train Loss: 0.0828055 Vali Loss: 0.1542005 Test Loss: 0.1553506
Validation loss decreased (0.155752 --> 0.154201).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 59 cost time: 0.9810051918029785
Epoch: 59, Steps: 64 | Train Loss: 0.0823943 Vali Loss: 0.1593951 Test Loss: 0.1552802
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020418167114257812 GB
GPU已分配内存的峰值：0.06590986251831055 GB
Epoch: 60 cost time: 0.9696109294891357
Epoch: 60, Steps: 64 | Train Loss: 0.0825605 Vali Loss: 0.1584717 Test Loss: 0.1550580
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_16_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15535055100917816, mae:0.30397656559944153, rse:0.20978641510009766
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.053999900817871094 GB
Epoch: 1 cost time: 2.2471485137939453
Epoch: 1, Steps: 64 | Train Loss: 0.9642084 Vali Loss: 2.1278486 Test Loss: 4.1637607
Validation loss decreased (inf --> 2.127849).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 2 cost time: 0.8526387214660645
Epoch: 2, Steps: 64 | Train Loss: 0.7306685 Vali Loss: 1.1651510 Test Loss: 2.1199925
Validation loss decreased (2.127849 --> 1.165151).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 3 cost time: 0.8513650894165039
Epoch: 3, Steps: 64 | Train Loss: 0.4253795 Vali Loss: 0.6647292 Test Loss: 1.0503936
Validation loss decreased (1.165151 --> 0.664729).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 4 cost time: 0.8534376621246338
Epoch: 4, Steps: 64 | Train Loss: 0.2567158 Vali Loss: 0.4247348 Test Loss: 0.5671171
Validation loss decreased (0.664729 --> 0.424735).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 5 cost time: 0.8354001045227051
Epoch: 5, Steps: 64 | Train Loss: 0.1801298 Vali Loss: 0.3197649 Test Loss: 0.3746164
Validation loss decreased (0.424735 --> 0.319765).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 6 cost time: 0.8249998092651367
Epoch: 6, Steps: 64 | Train Loss: 0.1449938 Vali Loss: 0.2663575 Test Loss: 0.2809418
Validation loss decreased (0.319765 --> 0.266357).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 7 cost time: 0.8300011157989502
Epoch: 7, Steps: 64 | Train Loss: 0.1275435 Vali Loss: 0.2314299 Test Loss: 0.2276324
Validation loss decreased (0.266357 --> 0.231430).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 8 cost time: 0.8383524417877197
Epoch: 8, Steps: 64 | Train Loss: 0.1182992 Vali Loss: 0.2116837 Test Loss: 0.1988315
Validation loss decreased (0.231430 --> 0.211684).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 9 cost time: 0.8691403865814209
Epoch: 9, Steps: 64 | Train Loss: 0.1117810 Vali Loss: 0.1990855 Test Loss: 0.1822429
Validation loss decreased (0.211684 --> 0.199086).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 10 cost time: 0.8714277744293213
Epoch: 10, Steps: 64 | Train Loss: 0.1078418 Vali Loss: 0.1899000 Test Loss: 0.1718845
Validation loss decreased (0.199086 --> 0.189900).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 11 cost time: 0.8667697906494141
Epoch: 11, Steps: 64 | Train Loss: 0.1058330 Vali Loss: 0.1838288 Test Loss: 0.1684120
Validation loss decreased (0.189900 --> 0.183829).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 12 cost time: 0.8704519271850586
Epoch: 12, Steps: 64 | Train Loss: 0.1028362 Vali Loss: 0.1809144 Test Loss: 0.1627643
Validation loss decreased (0.183829 --> 0.180914).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 13 cost time: 0.864013671875
Epoch: 13, Steps: 64 | Train Loss: 0.1021407 Vali Loss: 0.1748417 Test Loss: 0.1608792
Validation loss decreased (0.180914 --> 0.174842).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 14 cost time: 0.8684134483337402
Epoch: 14, Steps: 64 | Train Loss: 0.0999695 Vali Loss: 0.1748795 Test Loss: 0.1588543
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 15 cost time: 0.8574633598327637
Epoch: 15, Steps: 64 | Train Loss: 0.0995290 Vali Loss: 0.1721336 Test Loss: 0.1575771
Validation loss decreased (0.174842 --> 0.172134).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 16 cost time: 0.867732048034668
Epoch: 16, Steps: 64 | Train Loss: 0.0986347 Vali Loss: 0.1711857 Test Loss: 0.1561962
Validation loss decreased (0.172134 --> 0.171186).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 17 cost time: 0.8594939708709717
Epoch: 17, Steps: 64 | Train Loss: 0.0973354 Vali Loss: 0.1680793 Test Loss: 0.1557522
Validation loss decreased (0.171186 --> 0.168079).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 18 cost time: 0.8516361713409424
Epoch: 18, Steps: 64 | Train Loss: 0.0970698 Vali Loss: 0.1683961 Test Loss: 0.1547703
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 19 cost time: 0.8733470439910889
Epoch: 19, Steps: 64 | Train Loss: 0.0963814 Vali Loss: 0.1677552 Test Loss: 0.1541898
Validation loss decreased (0.168079 --> 0.167755).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 20 cost time: 0.8733820915222168
Epoch: 20, Steps: 64 | Train Loss: 0.0955481 Vali Loss: 0.1667896 Test Loss: 0.1534927
Validation loss decreased (0.167755 --> 0.166790).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 21 cost time: 0.8733847141265869
Epoch: 21, Steps: 64 | Train Loss: 0.0954082 Vali Loss: 0.1653370 Test Loss: 0.1535151
Validation loss decreased (0.166790 --> 0.165337).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 22 cost time: 0.8681459426879883
Epoch: 22, Steps: 64 | Train Loss: 0.0945807 Vali Loss: 0.1641595 Test Loss: 0.1531148
Validation loss decreased (0.165337 --> 0.164160).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 23 cost time: 0.8529999256134033
Epoch: 23, Steps: 64 | Train Loss: 0.0946352 Vali Loss: 0.1627976 Test Loss: 0.1525714
Validation loss decreased (0.164160 --> 0.162798).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 24 cost time: 0.8206326961517334
Epoch: 24, Steps: 64 | Train Loss: 0.0936527 Vali Loss: 0.1641637 Test Loss: 0.1526264
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 25 cost time: 0.8324453830718994
Epoch: 25, Steps: 64 | Train Loss: 0.0943511 Vali Loss: 0.1612855 Test Loss: 0.1514996
Validation loss decreased (0.162798 --> 0.161286).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 26 cost time: 0.8274314403533936
Epoch: 26, Steps: 64 | Train Loss: 0.0932773 Vali Loss: 0.1636368 Test Loss: 0.1522051
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 27 cost time: 0.8376235961914062
Epoch: 27, Steps: 64 | Train Loss: 0.0930546 Vali Loss: 0.1626482 Test Loss: 0.1519146
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 28 cost time: 0.8466975688934326
Epoch: 28, Steps: 64 | Train Loss: 0.0934349 Vali Loss: 0.1637010 Test Loss: 0.1514761
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 29 cost time: 0.8513741493225098
Epoch: 29, Steps: 64 | Train Loss: 0.0928608 Vali Loss: 0.1618084 Test Loss: 0.1514258
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 30 cost time: 0.8523924350738525
Epoch: 30, Steps: 64 | Train Loss: 0.0926048 Vali Loss: 0.1616394 Test Loss: 0.1516426
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 31 cost time: 0.847743034362793
Epoch: 31, Steps: 64 | Train Loss: 0.0923624 Vali Loss: 0.1611175 Test Loss: 0.1511201
Validation loss decreased (0.161286 --> 0.161118).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 32 cost time: 0.8379991054534912
Epoch: 32, Steps: 64 | Train Loss: 0.0918347 Vali Loss: 0.1597314 Test Loss: 0.1511324
Validation loss decreased (0.161118 --> 0.159731).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 33 cost time: 0.8226399421691895
Epoch: 33, Steps: 64 | Train Loss: 0.0920389 Vali Loss: 0.1590642 Test Loss: 0.1505663
Validation loss decreased (0.159731 --> 0.159064).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 34 cost time: 0.8304100036621094
Epoch: 34, Steps: 64 | Train Loss: 0.0918594 Vali Loss: 0.1614017 Test Loss: 0.1507575
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 35 cost time: 0.8664541244506836
Epoch: 35, Steps: 64 | Train Loss: 0.0914344 Vali Loss: 0.1579334 Test Loss: 0.1504526
Validation loss decreased (0.159064 --> 0.157933).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 36 cost time: 0.865908145904541
Epoch: 36, Steps: 64 | Train Loss: 0.0921355 Vali Loss: 0.1603434 Test Loss: 0.1503850
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 37 cost time: 0.8690018653869629
Epoch: 37, Steps: 64 | Train Loss: 0.0915771 Vali Loss: 0.1591061 Test Loss: 0.1501164
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 38 cost time: 0.8822782039642334
Epoch: 38, Steps: 64 | Train Loss: 0.0917326 Vali Loss: 0.1583149 Test Loss: 0.1499987
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 39 cost time: 0.8683352470397949
Epoch: 39, Steps: 64 | Train Loss: 0.0918207 Vali Loss: 0.1599337 Test Loss: 0.1503462
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 40 cost time: 0.8731403350830078
Epoch: 40, Steps: 64 | Train Loss: 0.0918857 Vali Loss: 0.1605490 Test Loss: 0.1503354
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 41 cost time: 0.867415189743042
Epoch: 41, Steps: 64 | Train Loss: 0.0910951 Vali Loss: 0.1584374 Test Loss: 0.1503985
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 42 cost time: 0.8627545833587646
Epoch: 42, Steps: 64 | Train Loss: 0.0908844 Vali Loss: 0.1594398 Test Loss: 0.1497979
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 43 cost time: 0.8500003814697266
Epoch: 43, Steps: 64 | Train Loss: 0.0916071 Vali Loss: 0.1582655 Test Loss: 0.1504030
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 44 cost time: 0.8526432514190674
Epoch: 44, Steps: 64 | Train Loss: 0.0911771 Vali Loss: 0.1586984 Test Loss: 0.1504601
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 45 cost time: 0.8594081401824951
Epoch: 45, Steps: 64 | Train Loss: 0.0909173 Vali Loss: 0.1564798 Test Loss: 0.1501990
Validation loss decreased (0.157933 --> 0.156480).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 46 cost time: 0.8725097179412842
Epoch: 46, Steps: 64 | Train Loss: 0.0915285 Vali Loss: 0.1596359 Test Loss: 0.1503548
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 47 cost time: 0.8648421764373779
Epoch: 47, Steps: 64 | Train Loss: 0.0916487 Vali Loss: 0.1579290 Test Loss: 0.1500189
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 48 cost time: 0.8749997615814209
Epoch: 48, Steps: 64 | Train Loss: 0.0914432 Vali Loss: 0.1597838 Test Loss: 0.1498853
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 49 cost time: 0.8723359107971191
Epoch: 49, Steps: 64 | Train Loss: 0.0908437 Vali Loss: 0.1558304 Test Loss: 0.1504368
Validation loss decreased (0.156480 --> 0.155830).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 50 cost time: 0.8474159240722656
Epoch: 50, Steps: 64 | Train Loss: 0.0912719 Vali Loss: 0.1593591 Test Loss: 0.1500736
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 51 cost time: 0.8323090076446533
Epoch: 51, Steps: 64 | Train Loss: 0.0908248 Vali Loss: 0.1576678 Test Loss: 0.1496571
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 52 cost time: 0.8277614116668701
Epoch: 52, Steps: 64 | Train Loss: 0.0912975 Vali Loss: 0.1590831 Test Loss: 0.1499574
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 53 cost time: 0.8499984741210938
Epoch: 53, Steps: 64 | Train Loss: 0.0910192 Vali Loss: 0.1579144 Test Loss: 0.1500662
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 54 cost time: 0.8682231903076172
Epoch: 54, Steps: 64 | Train Loss: 0.0909528 Vali Loss: 0.1590289 Test Loss: 0.1500608
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 55 cost time: 0.872685432434082
Epoch: 55, Steps: 64 | Train Loss: 0.0906203 Vali Loss: 0.1593390 Test Loss: 0.1499213
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 56 cost time: 0.8714156150817871
Epoch: 56, Steps: 64 | Train Loss: 0.0910412 Vali Loss: 0.1580675 Test Loss: 0.1498407
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 57 cost time: 0.8537299633026123
Epoch: 57, Steps: 64 | Train Loss: 0.0909811 Vali Loss: 0.1585408 Test Loss: 0.1494987
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 58 cost time: 0.873999834060669
Epoch: 58, Steps: 64 | Train Loss: 0.0911769 Vali Loss: 0.1587369 Test Loss: 0.1498728
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 59 cost time: 0.8696286678314209
Epoch: 59, Steps: 64 | Train Loss: 0.0909337 Vali Loss: 0.1588008 Test Loss: 0.1498311
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017932891845703125 GB
GPU已分配内存的峰值：0.05436897277832031 GB
Epoch: 60 cost time: 0.8723857402801514
Epoch: 60, Steps: 64 | Train Loss: 0.0911603 Vali Loss: 0.1578199 Test Loss: 0.1502688
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.15043675899505615, mae:0.2898372411727905, rse:0.2064419537782669
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.058394432067871094 GB
Epoch: 1 cost time: 2.3151166439056396
Epoch: 1, Steps: 64 | Train Loss: 0.6958989 Vali Loss: 1.5719441 Test Loss: 2.9391854
Validation loss decreased (inf --> 1.571944).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 2 cost time: 0.9114072322845459
Epoch: 2, Steps: 64 | Train Loss: 0.3125451 Vali Loss: 0.2123504 Test Loss: 0.1812648
Validation loss decreased (1.571944 --> 0.212350).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 3 cost time: 0.9244508743286133
Epoch: 3, Steps: 64 | Train Loss: 0.1071557 Vali Loss: 0.1816831 Test Loss: 0.1505382
Validation loss decreased (0.212350 --> 0.181683).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 4 cost time: 0.8930554389953613
Epoch: 4, Steps: 64 | Train Loss: 0.0973327 Vali Loss: 0.1746818 Test Loss: 0.1462021
Validation loss decreased (0.181683 --> 0.174682).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 5 cost time: 0.871741771697998
Epoch: 5, Steps: 64 | Train Loss: 0.0927599 Vali Loss: 0.1674959 Test Loss: 0.1448547
Validation loss decreased (0.174682 --> 0.167496).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 6 cost time: 0.8670003414154053
Epoch: 6, Steps: 64 | Train Loss: 0.0899500 Vali Loss: 0.1626405 Test Loss: 0.1425337
Validation loss decreased (0.167496 --> 0.162641).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 7 cost time: 0.8730001449584961
Epoch: 7, Steps: 64 | Train Loss: 0.0887043 Vali Loss: 0.1625061 Test Loss: 0.1420060
Validation loss decreased (0.162641 --> 0.162506).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 8 cost time: 0.8742647171020508
Epoch: 8, Steps: 64 | Train Loss: 0.0870164 Vali Loss: 0.1598703 Test Loss: 0.1412284
Validation loss decreased (0.162506 --> 0.159870).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 9 cost time: 0.8873517513275146
Epoch: 9, Steps: 64 | Train Loss: 0.0859165 Vali Loss: 0.1583010 Test Loss: 0.1404867
Validation loss decreased (0.159870 --> 0.158301).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 10 cost time: 0.8974428176879883
Epoch: 10, Steps: 64 | Train Loss: 0.0854043 Vali Loss: 0.1568149 Test Loss: 0.1405158
Validation loss decreased (0.158301 --> 0.156815).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 11 cost time: 0.9204504489898682
Epoch: 11, Steps: 64 | Train Loss: 0.0843025 Vali Loss: 0.1570407 Test Loss: 0.1400392
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 12 cost time: 0.9217808246612549
Epoch: 12, Steps: 64 | Train Loss: 0.0835921 Vali Loss: 0.1563804 Test Loss: 0.1403676
Validation loss decreased (0.156815 --> 0.156380).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 13 cost time: 0.9200015068054199
Epoch: 13, Steps: 64 | Train Loss: 0.0832193 Vali Loss: 0.1560253 Test Loss: 0.1404270
Validation loss decreased (0.156380 --> 0.156025).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 14 cost time: 0.922999382019043
Epoch: 14, Steps: 64 | Train Loss: 0.0826226 Vali Loss: 0.1540729 Test Loss: 0.1402662
Validation loss decreased (0.156025 --> 0.154073).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 15 cost time: 0.907644510269165
Epoch: 15, Steps: 64 | Train Loss: 0.0823433 Vali Loss: 0.1546407 Test Loss: 0.1402448
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 16 cost time: 0.903374433517456
Epoch: 16, Steps: 64 | Train Loss: 0.0817645 Vali Loss: 0.1515024 Test Loss: 0.1400518
Validation loss decreased (0.154073 --> 0.151502).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 17 cost time: 0.8951573371887207
Epoch: 17, Steps: 64 | Train Loss: 0.0814182 Vali Loss: 0.1516621 Test Loss: 0.1392559
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 18 cost time: 0.9170076847076416
Epoch: 18, Steps: 64 | Train Loss: 0.0812582 Vali Loss: 0.1531833 Test Loss: 0.1399882
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 19 cost time: 0.9139225482940674
Epoch: 19, Steps: 64 | Train Loss: 0.0810213 Vali Loss: 0.1529306 Test Loss: 0.1390781
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 20 cost time: 0.9190006256103516
Epoch: 20, Steps: 64 | Train Loss: 0.0809179 Vali Loss: 0.1514055 Test Loss: 0.1386279
Validation loss decreased (0.151502 --> 0.151405).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 21 cost time: 0.8953642845153809
Epoch: 21, Steps: 64 | Train Loss: 0.0801268 Vali Loss: 0.1516327 Test Loss: 0.1392575
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 22 cost time: 0.8966236114501953
Epoch: 22, Steps: 64 | Train Loss: 0.0800626 Vali Loss: 0.1506594 Test Loss: 0.1389957
Validation loss decreased (0.151405 --> 0.150659).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 23 cost time: 0.8764405250549316
Epoch: 23, Steps: 64 | Train Loss: 0.0803118 Vali Loss: 0.1494083 Test Loss: 0.1379806
Validation loss decreased (0.150659 --> 0.149408).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 24 cost time: 0.8824098110198975
Epoch: 24, Steps: 64 | Train Loss: 0.0802776 Vali Loss: 0.1511849 Test Loss: 0.1391404
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 25 cost time: 0.8753962516784668
Epoch: 25, Steps: 64 | Train Loss: 0.0797387 Vali Loss: 0.1516680 Test Loss: 0.1390954
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 26 cost time: 0.8898444175720215
Epoch: 26, Steps: 64 | Train Loss: 0.0801423 Vali Loss: 0.1520745 Test Loss: 0.1397870
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 27 cost time: 0.8880000114440918
Epoch: 27, Steps: 64 | Train Loss: 0.0795627 Vali Loss: 0.1515075 Test Loss: 0.1386525
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 28 cost time: 0.882239580154419
Epoch: 28, Steps: 64 | Train Loss: 0.0797372 Vali Loss: 0.1493694 Test Loss: 0.1389436
Validation loss decreased (0.149408 --> 0.149369).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 29 cost time: 0.8904719352722168
Epoch: 29, Steps: 64 | Train Loss: 0.0793644 Vali Loss: 0.1502136 Test Loss: 0.1392218
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 30 cost time: 0.8890631198883057
Epoch: 30, Steps: 64 | Train Loss: 0.0794700 Vali Loss: 0.1511172 Test Loss: 0.1393413
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 31 cost time: 0.8704421520233154
Epoch: 31, Steps: 64 | Train Loss: 0.0794809 Vali Loss: 0.1520837 Test Loss: 0.1396426
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 32 cost time: 0.8717100620269775
Epoch: 32, Steps: 64 | Train Loss: 0.0795490 Vali Loss: 0.1498856 Test Loss: 0.1387660
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 33 cost time: 0.8669984340667725
Epoch: 33, Steps: 64 | Train Loss: 0.0794080 Vali Loss: 0.1490974 Test Loss: 0.1393963
Validation loss decreased (0.149369 --> 0.149097).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 34 cost time: 0.9009876251220703
Epoch: 34, Steps: 64 | Train Loss: 0.0792281 Vali Loss: 0.1505740 Test Loss: 0.1391738
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 35 cost time: 0.9233968257904053
Epoch: 35, Steps: 64 | Train Loss: 0.0789912 Vali Loss: 0.1492357 Test Loss: 0.1385348
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 36 cost time: 0.9203650951385498
Epoch: 36, Steps: 64 | Train Loss: 0.0790303 Vali Loss: 0.1500558 Test Loss: 0.1386146
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 37 cost time: 0.9183681011199951
Epoch: 37, Steps: 64 | Train Loss: 0.0792338 Vali Loss: 0.1514672 Test Loss: 0.1391656
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 38 cost time: 0.9213979244232178
Epoch: 38, Steps: 64 | Train Loss: 0.0789613 Vali Loss: 0.1489002 Test Loss: 0.1387998
Validation loss decreased (0.149097 --> 0.148900).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 39 cost time: 0.9107444286346436
Epoch: 39, Steps: 64 | Train Loss: 0.0791027 Vali Loss: 0.1499424 Test Loss: 0.1385598
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 40 cost time: 0.9052891731262207
Epoch: 40, Steps: 64 | Train Loss: 0.0791494 Vali Loss: 0.1504142 Test Loss: 0.1387669
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 41 cost time: 0.9056422710418701
Epoch: 41, Steps: 64 | Train Loss: 0.0791139 Vali Loss: 0.1506470 Test Loss: 0.1393697
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 42 cost time: 0.9023854732513428
Epoch: 42, Steps: 64 | Train Loss: 0.0790847 Vali Loss: 0.1481083 Test Loss: 0.1384569
Validation loss decreased (0.148900 --> 0.148108).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 43 cost time: 0.910001277923584
Epoch: 43, Steps: 64 | Train Loss: 0.0787071 Vali Loss: 0.1495925 Test Loss: 0.1390565
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 44 cost time: 0.9094429016113281
Epoch: 44, Steps: 64 | Train Loss: 0.0789014 Vali Loss: 0.1483490 Test Loss: 0.1387370
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 45 cost time: 0.8913681507110596
Epoch: 45, Steps: 64 | Train Loss: 0.0785414 Vali Loss: 0.1491870 Test Loss: 0.1391301
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 46 cost time: 0.8877911567687988
Epoch: 46, Steps: 64 | Train Loss: 0.0789140 Vali Loss: 0.1505381 Test Loss: 0.1394484
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 47 cost time: 0.8903484344482422
Epoch: 47, Steps: 64 | Train Loss: 0.0793094 Vali Loss: 0.1493476 Test Loss: 0.1388511
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 48 cost time: 0.8736386299133301
Epoch: 48, Steps: 64 | Train Loss: 0.0788492 Vali Loss: 0.1506451 Test Loss: 0.1391079
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 49 cost time: 0.8854508399963379
Epoch: 49, Steps: 64 | Train Loss: 0.0788313 Vali Loss: 0.1496113 Test Loss: 0.1385165
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 50 cost time: 0.8683853149414062
Epoch: 50, Steps: 64 | Train Loss: 0.0787127 Vali Loss: 0.1491195 Test Loss: 0.1390687
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 51 cost time: 0.8784682750701904
Epoch: 51, Steps: 64 | Train Loss: 0.0787603 Vali Loss: 0.1491067 Test Loss: 0.1385939
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 52 cost time: 0.9023828506469727
Epoch: 52, Steps: 64 | Train Loss: 0.0785043 Vali Loss: 0.1493548 Test Loss: 0.1390230
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 53 cost time: 0.8930013179779053
Epoch: 53, Steps: 64 | Train Loss: 0.0790106 Vali Loss: 0.1491354 Test Loss: 0.1397900
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 54 cost time: 0.890632152557373
Epoch: 54, Steps: 64 | Train Loss: 0.0791534 Vali Loss: 0.1495476 Test Loss: 0.1389594
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 55 cost time: 0.8974075317382812
Epoch: 55, Steps: 64 | Train Loss: 0.0787403 Vali Loss: 0.1502595 Test Loss: 0.1387047
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 56 cost time: 0.9039454460144043
Epoch: 56, Steps: 64 | Train Loss: 0.0787005 Vali Loss: 0.1469983 Test Loss: 0.1390092
Validation loss decreased (0.148108 --> 0.146998).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 57 cost time: 0.9004123210906982
Epoch: 57, Steps: 64 | Train Loss: 0.0787431 Vali Loss: 0.1481204 Test Loss: 0.1394829
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 58 cost time: 0.8957610130310059
Epoch: 58, Steps: 64 | Train Loss: 0.0784795 Vali Loss: 0.1493287 Test Loss: 0.1392956
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 59 cost time: 0.902998685836792
Epoch: 59, Steps: 64 | Train Loss: 0.0785858 Vali Loss: 0.1487412 Test Loss: 0.1388668
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019886016845703125 GB
GPU已分配内存的峰值：0.05974006652832031 GB
Epoch: 60 cost time: 0.9080214500427246
Epoch: 60, Steps: 64 | Train Loss: 0.0789714 Vali Loss: 0.1490232 Test Loss: 0.1383692
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1390092372894287, mae:0.2717546224594116, rse:0.19844621419906616
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06169319152832031 GB
Epoch: 1 cost time: 2.34158992767334
Epoch: 1, Steps: 64 | Train Loss: 0.7798167 Vali Loss: 1.7879115 Test Loss: 3.3819683
Validation loss decreased (inf --> 1.787912).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 2 cost time: 0.945636510848999
Epoch: 2, Steps: 64 | Train Loss: 0.3019750 Vali Loss: 0.2282914 Test Loss: 0.2499049
Validation loss decreased (1.787912 --> 0.228291).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 3 cost time: 0.944645881652832
Epoch: 3, Steps: 64 | Train Loss: 0.1050318 Vali Loss: 0.1773575 Test Loss: 0.1507243
Validation loss decreased (0.228291 --> 0.177358).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 4 cost time: 0.9249668121337891
Epoch: 4, Steps: 64 | Train Loss: 0.0941842 Vali Loss: 0.1720965 Test Loss: 0.1470943
Validation loss decreased (0.177358 --> 0.172097).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 5 cost time: 0.9052505493164062
Epoch: 5, Steps: 64 | Train Loss: 0.0906376 Vali Loss: 0.1656554 Test Loss: 0.1459778
Validation loss decreased (0.172097 --> 0.165655).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 6 cost time: 0.9133780002593994
Epoch: 6, Steps: 64 | Train Loss: 0.0880379 Vali Loss: 0.1672624 Test Loss: 0.1423894
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 7 cost time: 0.9043600559234619
Epoch: 7, Steps: 64 | Train Loss: 0.0870094 Vali Loss: 0.1608068 Test Loss: 0.1413168
Validation loss decreased (0.165655 --> 0.160807).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 8 cost time: 0.9023542404174805
Epoch: 8, Steps: 64 | Train Loss: 0.0853513 Vali Loss: 0.1606587 Test Loss: 0.1402824
Validation loss decreased (0.160807 --> 0.160659).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 9 cost time: 0.9294707775115967
Epoch: 9, Steps: 64 | Train Loss: 0.0845945 Vali Loss: 0.1593654 Test Loss: 0.1386316
Validation loss decreased (0.160659 --> 0.159365).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 10 cost time: 0.9390003681182861
Epoch: 10, Steps: 64 | Train Loss: 0.0831947 Vali Loss: 0.1585258 Test Loss: 0.1412123
Validation loss decreased (0.159365 --> 0.158526).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 11 cost time: 0.9330005645751953
Epoch: 11, Steps: 64 | Train Loss: 0.0825814 Vali Loss: 0.1537240 Test Loss: 0.1373972
Validation loss decreased (0.158526 --> 0.153724).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 12 cost time: 0.9506292343139648
Epoch: 12, Steps: 64 | Train Loss: 0.0817238 Vali Loss: 0.1562313 Test Loss: 0.1395557
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 13 cost time: 0.9361374378204346
Epoch: 13, Steps: 64 | Train Loss: 0.0819634 Vali Loss: 0.1553942 Test Loss: 0.1387508
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 14 cost time: 0.9388229846954346
Epoch: 14, Steps: 64 | Train Loss: 0.0813451 Vali Loss: 0.1532754 Test Loss: 0.1380395
Validation loss decreased (0.153724 --> 0.153275).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 15 cost time: 0.9313557147979736
Epoch: 15, Steps: 64 | Train Loss: 0.0806317 Vali Loss: 0.1530469 Test Loss: 0.1385124
Validation loss decreased (0.153275 --> 0.153047).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 16 cost time: 0.9323885440826416
Epoch: 16, Steps: 64 | Train Loss: 0.0804319 Vali Loss: 0.1531924 Test Loss: 0.1384755
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 17 cost time: 0.9513833522796631
Epoch: 17, Steps: 64 | Train Loss: 0.0802078 Vali Loss: 0.1514139 Test Loss: 0.1382253
Validation loss decreased (0.153047 --> 0.151414).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 18 cost time: 0.9477643966674805
Epoch: 18, Steps: 64 | Train Loss: 0.0798054 Vali Loss: 0.1510283 Test Loss: 0.1376081
Validation loss decreased (0.151414 --> 0.151028).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 19 cost time: 0.9479992389678955
Epoch: 19, Steps: 64 | Train Loss: 0.0800216 Vali Loss: 0.1520049 Test Loss: 0.1383750
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 20 cost time: 0.9620301723480225
Epoch: 20, Steps: 64 | Train Loss: 0.0794026 Vali Loss: 0.1522912 Test Loss: 0.1377170
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 21 cost time: 0.9406299591064453
Epoch: 21, Steps: 64 | Train Loss: 0.0791772 Vali Loss: 0.1493444 Test Loss: 0.1386070
Validation loss decreased (0.151028 --> 0.149344).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 22 cost time: 0.9223003387451172
Epoch: 22, Steps: 64 | Train Loss: 0.0787537 Vali Loss: 0.1509900 Test Loss: 0.1384305
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 23 cost time: 0.9433345794677734
Epoch: 23, Steps: 64 | Train Loss: 0.0788748 Vali Loss: 0.1491758 Test Loss: 0.1376677
Validation loss decreased (0.149344 --> 0.149176).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 24 cost time: 0.9043898582458496
Epoch: 24, Steps: 64 | Train Loss: 0.0789085 Vali Loss: 0.1497280 Test Loss: 0.1385252
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 25 cost time: 0.9207150936126709
Epoch: 25, Steps: 64 | Train Loss: 0.0791492 Vali Loss: 0.1503388 Test Loss: 0.1375629
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 26 cost time: 0.920107364654541
Epoch: 26, Steps: 64 | Train Loss: 0.0784875 Vali Loss: 0.1498762 Test Loss: 0.1383608
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 27 cost time: 0.9217195510864258
Epoch: 27, Steps: 64 | Train Loss: 0.0784289 Vali Loss: 0.1494053 Test Loss: 0.1379447
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 28 cost time: 0.9289999008178711
Epoch: 28, Steps: 64 | Train Loss: 0.0783236 Vali Loss: 0.1472062 Test Loss: 0.1376935
Validation loss decreased (0.149176 --> 0.147206).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 29 cost time: 0.9126455783843994
Epoch: 29, Steps: 64 | Train Loss: 0.0780500 Vali Loss: 0.1496774 Test Loss: 0.1393715
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 30 cost time: 0.9088120460510254
Epoch: 30, Steps: 64 | Train Loss: 0.0781798 Vali Loss: 0.1484770 Test Loss: 0.1376841
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 31 cost time: 0.9503803253173828
Epoch: 31, Steps: 64 | Train Loss: 0.0783891 Vali Loss: 0.1494748 Test Loss: 0.1388022
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 32 cost time: 0.9484145641326904
Epoch: 32, Steps: 64 | Train Loss: 0.0782434 Vali Loss: 0.1506061 Test Loss: 0.1387612
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 33 cost time: 0.9623942375183105
Epoch: 33, Steps: 64 | Train Loss: 0.0780602 Vali Loss: 0.1484914 Test Loss: 0.1375709
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 34 cost time: 0.9553864002227783
Epoch: 34, Steps: 64 | Train Loss: 0.0779037 Vali Loss: 0.1479841 Test Loss: 0.1383552
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 35 cost time: 0.9457452297210693
Epoch: 35, Steps: 64 | Train Loss: 0.0780223 Vali Loss: 0.1486160 Test Loss: 0.1379179
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 36 cost time: 0.9517831802368164
Epoch: 36, Steps: 64 | Train Loss: 0.0776759 Vali Loss: 0.1490956 Test Loss: 0.1375856
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 37 cost time: 0.9560000896453857
Epoch: 37, Steps: 64 | Train Loss: 0.0778792 Vali Loss: 0.1487069 Test Loss: 0.1380019
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 38 cost time: 0.9439420700073242
Epoch: 38, Steps: 64 | Train Loss: 0.0777323 Vali Loss: 0.1493148 Test Loss: 0.1394860
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 39 cost time: 0.9486746788024902
Epoch: 39, Steps: 64 | Train Loss: 0.0777410 Vali Loss: 0.1478575 Test Loss: 0.1386119
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 40 cost time: 0.9514331817626953
Epoch: 40, Steps: 64 | Train Loss: 0.0778810 Vali Loss: 0.1470309 Test Loss: 0.1381129
Validation loss decreased (0.147206 --> 0.147031).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 41 cost time: 0.9393653869628906
Epoch: 41, Steps: 64 | Train Loss: 0.0776972 Vali Loss: 0.1493255 Test Loss: 0.1384571
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 42 cost time: 0.9551608562469482
Epoch: 42, Steps: 64 | Train Loss: 0.0776579 Vali Loss: 0.1476707 Test Loss: 0.1377799
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 43 cost time: 0.9343698024749756
Epoch: 43, Steps: 64 | Train Loss: 0.0775514 Vali Loss: 0.1484205 Test Loss: 0.1382943
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 44 cost time: 0.9324018955230713
Epoch: 44, Steps: 64 | Train Loss: 0.0777008 Vali Loss: 0.1479898 Test Loss: 0.1371589
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 45 cost time: 0.9207284450531006
Epoch: 45, Steps: 64 | Train Loss: 0.0778342 Vali Loss: 0.1489685 Test Loss: 0.1371383
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 46 cost time: 0.9120011329650879
Epoch: 46, Steps: 64 | Train Loss: 0.0776650 Vali Loss: 0.1471869 Test Loss: 0.1380882
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 47 cost time: 0.9126431941986084
Epoch: 47, Steps: 64 | Train Loss: 0.0773384 Vali Loss: 0.1480066 Test Loss: 0.1383315
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 48 cost time: 0.9026215076446533
Epoch: 48, Steps: 64 | Train Loss: 0.0776126 Vali Loss: 0.1497357 Test Loss: 0.1381428
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 49 cost time: 0.8996737003326416
Epoch: 49, Steps: 64 | Train Loss: 0.0779147 Vali Loss: 0.1469698 Test Loss: 0.1378984
Validation loss decreased (0.147031 --> 0.146970).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 50 cost time: 0.9315850734710693
Epoch: 50, Steps: 64 | Train Loss: 0.0777021 Vali Loss: 0.1473407 Test Loss: 0.1382433
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 51 cost time: 0.9195632934570312
Epoch: 51, Steps: 64 | Train Loss: 0.0774551 Vali Loss: 0.1489851 Test Loss: 0.1387545
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 52 cost time: 0.9300551414489746
Epoch: 52, Steps: 64 | Train Loss: 0.0776391 Vali Loss: 0.1470050 Test Loss: 0.1382140
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 53 cost time: 0.9283266067504883
Epoch: 53, Steps: 64 | Train Loss: 0.0776696 Vali Loss: 0.1489382 Test Loss: 0.1383411
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 54 cost time: 0.9349994659423828
Epoch: 54, Steps: 64 | Train Loss: 0.0778305 Vali Loss: 0.1475006 Test Loss: 0.1377652
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 55 cost time: 0.9390935897827148
Epoch: 55, Steps: 64 | Train Loss: 0.0777898 Vali Loss: 0.1478173 Test Loss: 0.1383345
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 56 cost time: 0.9296443462371826
Epoch: 56, Steps: 64 | Train Loss: 0.0776461 Vali Loss: 0.1485914 Test Loss: 0.1378317
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 57 cost time: 0.9319989681243896
Epoch: 57, Steps: 64 | Train Loss: 0.0774870 Vali Loss: 0.1491947 Test Loss: 0.1385038
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 58 cost time: 0.9496610164642334
Epoch: 58, Steps: 64 | Train Loss: 0.0772586 Vali Loss: 0.1463064 Test Loss: 0.1378946
Validation loss decreased (0.146970 --> 0.146306).  Saving model ...
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 59 cost time: 0.9485580921173096
Epoch: 59, Steps: 64 | Train Loss: 0.0773647 Vali Loss: 0.1476498 Test Loss: 0.1380831
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020870208740234375 GB
GPU已分配内存的峰值：0.06353092193603516 GB
Epoch: 60 cost time: 0.9525275230407715
Epoch: 60, Steps: 64 | Train Loss: 0.0776483 Vali Loss: 0.1465497 Test Loss: 0.1375431
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13789457082748413, mae:0.2698479890823364, rse:0.19764897227287292
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05416154861450195 GB
Epoch: 1 cost time: 2.291262149810791
Epoch: 1, Steps: 64 | Train Loss: 0.9556314 Vali Loss: 2.1205513 Test Loss: 4.0868311
Validation loss decreased (inf --> 2.120551).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 2 cost time: 0.8775262832641602
Epoch: 2, Steps: 64 | Train Loss: 0.7026705 Vali Loss: 1.0621709 Test Loss: 1.8462168
Validation loss decreased (2.120551 --> 1.062171).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 3 cost time: 0.8800017833709717
Epoch: 3, Steps: 64 | Train Loss: 0.3990722 Vali Loss: 0.6527438 Test Loss: 0.9700303
Validation loss decreased (1.062171 --> 0.652744).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 4 cost time: 0.8689603805541992
Epoch: 4, Steps: 64 | Train Loss: 0.2480181 Vali Loss: 0.4252226 Test Loss: 0.5326487
Validation loss decreased (0.652744 --> 0.425223).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 5 cost time: 0.838881254196167
Epoch: 5, Steps: 64 | Train Loss: 0.1740530 Vali Loss: 0.3134347 Test Loss: 0.3318184
Validation loss decreased (0.425223 --> 0.313435).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 6 cost time: 0.8367080688476562
Epoch: 6, Steps: 64 | Train Loss: 0.1389507 Vali Loss: 0.2575894 Test Loss: 0.2449857
Validation loss decreased (0.313435 --> 0.257589).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 7 cost time: 0.8354909420013428
Epoch: 7, Steps: 64 | Train Loss: 0.1216457 Vali Loss: 0.2247974 Test Loss: 0.2026103
Validation loss decreased (0.257589 --> 0.224797).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 8 cost time: 0.8709964752197266
Epoch: 8, Steps: 64 | Train Loss: 0.1125679 Vali Loss: 0.2056111 Test Loss: 0.1788765
Validation loss decreased (0.224797 --> 0.205611).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 9 cost time: 0.873837947845459
Epoch: 9, Steps: 64 | Train Loss: 0.1070898 Vali Loss: 0.1924294 Test Loss: 0.1692580
Validation loss decreased (0.205611 --> 0.192429).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 10 cost time: 0.8822760581970215
Epoch: 10, Steps: 64 | Train Loss: 0.1035406 Vali Loss: 0.1851896 Test Loss: 0.1621259
Validation loss decreased (0.192429 --> 0.185190).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 11 cost time: 0.8845503330230713
Epoch: 11, Steps: 64 | Train Loss: 0.1014779 Vali Loss: 0.1786109 Test Loss: 0.1582991
Validation loss decreased (0.185190 --> 0.178611).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 12 cost time: 0.870410680770874
Epoch: 12, Steps: 64 | Train Loss: 0.0996590 Vali Loss: 0.1749751 Test Loss: 0.1550080
Validation loss decreased (0.178611 --> 0.174975).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 13 cost time: 0.8845295906066895
Epoch: 13, Steps: 64 | Train Loss: 0.0986026 Vali Loss: 0.1733979 Test Loss: 0.1536155
Validation loss decreased (0.174975 --> 0.173398).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 14 cost time: 0.8769116401672363
Epoch: 14, Steps: 64 | Train Loss: 0.0967596 Vali Loss: 0.1691967 Test Loss: 0.1513964
Validation loss decreased (0.173398 --> 0.169197).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 15 cost time: 0.8570032119750977
Epoch: 15, Steps: 64 | Train Loss: 0.0964609 Vali Loss: 0.1692047 Test Loss: 0.1505043
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 16 cost time: 0.8726110458374023
Epoch: 16, Steps: 64 | Train Loss: 0.0957697 Vali Loss: 0.1660205 Test Loss: 0.1491349
Validation loss decreased (0.169197 --> 0.166020).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 17 cost time: 0.879382848739624
Epoch: 17, Steps: 64 | Train Loss: 0.0943781 Vali Loss: 0.1633360 Test Loss: 0.1487120
Validation loss decreased (0.166020 --> 0.163336).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 18 cost time: 0.8884255886077881
Epoch: 18, Steps: 64 | Train Loss: 0.0936524 Vali Loss: 0.1642443 Test Loss: 0.1481385
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 19 cost time: 0.8835592269897461
Epoch: 19, Steps: 64 | Train Loss: 0.0931995 Vali Loss: 0.1614684 Test Loss: 0.1480115
Validation loss decreased (0.163336 --> 0.161468).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 20 cost time: 0.8770430088043213
Epoch: 20, Steps: 64 | Train Loss: 0.0927944 Vali Loss: 0.1629945 Test Loss: 0.1473863
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 21 cost time: 0.8822791576385498
Epoch: 21, Steps: 64 | Train Loss: 0.0923079 Vali Loss: 0.1619964 Test Loss: 0.1475057
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 22 cost time: 0.8910481929779053
Epoch: 22, Steps: 64 | Train Loss: 0.0912416 Vali Loss: 0.1607662 Test Loss: 0.1469268
Validation loss decreased (0.161468 --> 0.160766).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 23 cost time: 0.8474290370941162
Epoch: 23, Steps: 64 | Train Loss: 0.0912828 Vali Loss: 0.1612484 Test Loss: 0.1468580
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 24 cost time: 0.8333883285522461
Epoch: 24, Steps: 64 | Train Loss: 0.0916891 Vali Loss: 0.1605577 Test Loss: 0.1465105
Validation loss decreased (0.160766 --> 0.160558).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 25 cost time: 0.8393385410308838
Epoch: 25, Steps: 64 | Train Loss: 0.0910725 Vali Loss: 0.1590388 Test Loss: 0.1462198
Validation loss decreased (0.160558 --> 0.159039).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 26 cost time: 0.8339998722076416
Epoch: 26, Steps: 64 | Train Loss: 0.0907614 Vali Loss: 0.1595729 Test Loss: 0.1462605
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 27 cost time: 0.8372464179992676
Epoch: 27, Steps: 64 | Train Loss: 0.0903324 Vali Loss: 0.1594105 Test Loss: 0.1452005
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 28 cost time: 0.853370189666748
Epoch: 28, Steps: 64 | Train Loss: 0.0899768 Vali Loss: 0.1581912 Test Loss: 0.1454939
Validation loss decreased (0.159039 --> 0.158191).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 29 cost time: 0.8585057258605957
Epoch: 29, Steps: 64 | Train Loss: 0.0898004 Vali Loss: 0.1590624 Test Loss: 0.1455415
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 30 cost time: 0.854405403137207
Epoch: 30, Steps: 64 | Train Loss: 0.0898357 Vali Loss: 0.1601892 Test Loss: 0.1452299
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 31 cost time: 0.8557262420654297
Epoch: 31, Steps: 64 | Train Loss: 0.0900149 Vali Loss: 0.1586007 Test Loss: 0.1449274
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 32 cost time: 0.8346314430236816
Epoch: 32, Steps: 64 | Train Loss: 0.0899128 Vali Loss: 0.1581856 Test Loss: 0.1450097
Validation loss decreased (0.158191 --> 0.158186).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 33 cost time: 0.8393857479095459
Epoch: 33, Steps: 64 | Train Loss: 0.0893121 Vali Loss: 0.1558760 Test Loss: 0.1448099
Validation loss decreased (0.158186 --> 0.155876).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 34 cost time: 0.8324751853942871
Epoch: 34, Steps: 64 | Train Loss: 0.0898968 Vali Loss: 0.1578374 Test Loss: 0.1448591
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 35 cost time: 0.858396053314209
Epoch: 35, Steps: 64 | Train Loss: 0.0891845 Vali Loss: 0.1563036 Test Loss: 0.1445165
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 36 cost time: 0.8654332160949707
Epoch: 36, Steps: 64 | Train Loss: 0.0889587 Vali Loss: 0.1571073 Test Loss: 0.1443959
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 37 cost time: 0.8816702365875244
Epoch: 37, Steps: 64 | Train Loss: 0.0890091 Vali Loss: 0.1583155 Test Loss: 0.1449304
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 38 cost time: 0.8774371147155762
Epoch: 38, Steps: 64 | Train Loss: 0.0891338 Vali Loss: 0.1575940 Test Loss: 0.1448404
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 39 cost time: 0.8843629360198975
Epoch: 39, Steps: 64 | Train Loss: 0.0890788 Vali Loss: 0.1566201 Test Loss: 0.1447306
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 40 cost time: 0.9069678783416748
Epoch: 40, Steps: 64 | Train Loss: 0.0890153 Vali Loss: 0.1574782 Test Loss: 0.1447748
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 41 cost time: 0.878795862197876
Epoch: 41, Steps: 64 | Train Loss: 0.0888433 Vali Loss: 0.1551092 Test Loss: 0.1443092
Validation loss decreased (0.155876 --> 0.155109).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 42 cost time: 0.8788096904754639
Epoch: 42, Steps: 64 | Train Loss: 0.0887792 Vali Loss: 0.1583887 Test Loss: 0.1445236
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 43 cost time: 0.8756473064422607
Epoch: 43, Steps: 64 | Train Loss: 0.0890705 Vali Loss: 0.1560490 Test Loss: 0.1445359
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 44 cost time: 0.8776407241821289
Epoch: 44, Steps: 64 | Train Loss: 0.0887370 Vali Loss: 0.1567259 Test Loss: 0.1444252
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 45 cost time: 0.8690783977508545
Epoch: 45, Steps: 64 | Train Loss: 0.0882449 Vali Loss: 0.1570800 Test Loss: 0.1446397
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 46 cost time: 0.8664107322692871
Epoch: 46, Steps: 64 | Train Loss: 0.0887117 Vali Loss: 0.1573419 Test Loss: 0.1442225
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 47 cost time: 0.8532531261444092
Epoch: 47, Steps: 64 | Train Loss: 0.0892219 Vali Loss: 0.1560794 Test Loss: 0.1441634
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 48 cost time: 0.8689999580383301
Epoch: 48, Steps: 64 | Train Loss: 0.0891514 Vali Loss: 0.1570643 Test Loss: 0.1441287
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 49 cost time: 0.8580200672149658
Epoch: 49, Steps: 64 | Train Loss: 0.0885561 Vali Loss: 0.1547982 Test Loss: 0.1442770
Validation loss decreased (0.155109 --> 0.154798).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 50 cost time: 0.8405067920684814
Epoch: 50, Steps: 64 | Train Loss: 0.0886269 Vali Loss: 0.1570374 Test Loss: 0.1449369
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 51 cost time: 0.8454391956329346
Epoch: 51, Steps: 64 | Train Loss: 0.0885805 Vali Loss: 0.1563897 Test Loss: 0.1438988
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 52 cost time: 0.8387899398803711
Epoch: 52, Steps: 64 | Train Loss: 0.0878758 Vali Loss: 0.1548248 Test Loss: 0.1439506
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 53 cost time: 0.8397202491760254
Epoch: 53, Steps: 64 | Train Loss: 0.0892523 Vali Loss: 0.1566526 Test Loss: 0.1444084
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 54 cost time: 0.8552765846252441
Epoch: 54, Steps: 64 | Train Loss: 0.0884308 Vali Loss: 0.1560486 Test Loss: 0.1443816
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 55 cost time: 0.8674206733703613
Epoch: 55, Steps: 64 | Train Loss: 0.0886549 Vali Loss: 0.1550741 Test Loss: 0.1440379
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 56 cost time: 0.8593976497650146
Epoch: 56, Steps: 64 | Train Loss: 0.0888000 Vali Loss: 0.1567953 Test Loss: 0.1439218
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 57 cost time: 0.8667893409729004
Epoch: 57, Steps: 64 | Train Loss: 0.0884630 Vali Loss: 0.1561763 Test Loss: 0.1440538
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 58 cost time: 0.8780004978179932
Epoch: 58, Steps: 64 | Train Loss: 0.0885351 Vali Loss: 0.1561601 Test Loss: 0.1439715
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 59 cost time: 0.861640214920044
Epoch: 59, Steps: 64 | Train Loss: 0.0883162 Vali Loss: 0.1557855 Test Loss: 0.1438956
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017938613891601562 GB
GPU已分配内存的峰值：0.05453348159790039 GB
Epoch: 60 cost time: 0.8623924255371094
Epoch: 60, Steps: 64 | Train Loss: 0.0881608 Vali Loss: 0.1547520 Test Loss: 0.1437087
Validation loss decreased (0.154798 --> 0.154752).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14370863139629364, mae:0.2799619436264038, rse:0.20177270472049713
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05855607986450195 GB
Epoch: 1 cost time: 2.3315117359161377
Epoch: 1, Steps: 64 | Train Loss: 0.8157266 Vali Loss: 1.8443326 Test Loss: 3.5147560
Validation loss decreased (inf --> 1.844333).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 2 cost time: 0.9085264205932617
Epoch: 2, Steps: 64 | Train Loss: 0.3850732 Vali Loss: 0.2500227 Test Loss: 0.2224512
Validation loss decreased (1.844333 --> 0.250023).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 3 cost time: 0.8928773403167725
Epoch: 3, Steps: 64 | Train Loss: 0.1062775 Vali Loss: 0.1745073 Test Loss: 0.1387466
Validation loss decreased (0.250023 --> 0.174507).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 4 cost time: 0.9014720916748047
Epoch: 4, Steps: 64 | Train Loss: 0.0943913 Vali Loss: 0.1671063 Test Loss: 0.1358202
Validation loss decreased (0.174507 --> 0.167106).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 5 cost time: 0.8798317909240723
Epoch: 5, Steps: 64 | Train Loss: 0.0902879 Vali Loss: 0.1614208 Test Loss: 0.1352347
Validation loss decreased (0.167106 --> 0.161421).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 6 cost time: 0.8817989826202393
Epoch: 6, Steps: 64 | Train Loss: 0.0877788 Vali Loss: 0.1555414 Test Loss: 0.1342794
Validation loss decreased (0.161421 --> 0.155541).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 7 cost time: 0.9160001277923584
Epoch: 7, Steps: 64 | Train Loss: 0.0857363 Vali Loss: 0.1520519 Test Loss: 0.1338858
Validation loss decreased (0.155541 --> 0.152052).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 8 cost time: 0.9176585674285889
Epoch: 8, Steps: 64 | Train Loss: 0.0838529 Vali Loss: 0.1483078 Test Loss: 0.1330954
Validation loss decreased (0.152052 --> 0.148308).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 9 cost time: 0.9263715744018555
Epoch: 9, Steps: 64 | Train Loss: 0.0826175 Vali Loss: 0.1476278 Test Loss: 0.1326359
Validation loss decreased (0.148308 --> 0.147628).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 10 cost time: 0.9260385036468506
Epoch: 10, Steps: 64 | Train Loss: 0.0818387 Vali Loss: 0.1431237 Test Loss: 0.1316747
Validation loss decreased (0.147628 --> 0.143124).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 11 cost time: 0.9273843765258789
Epoch: 11, Steps: 64 | Train Loss: 0.0808016 Vali Loss: 0.1432567 Test Loss: 0.1317637
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 12 cost time: 0.9287774562835693
Epoch: 12, Steps: 64 | Train Loss: 0.0796163 Vali Loss: 0.1429907 Test Loss: 0.1327262
Validation loss decreased (0.143124 --> 0.142991).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 13 cost time: 0.9108445644378662
Epoch: 13, Steps: 64 | Train Loss: 0.0794404 Vali Loss: 0.1399736 Test Loss: 0.1323609
Validation loss decreased (0.142991 --> 0.139974).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 14 cost time: 0.9000015258789062
Epoch: 14, Steps: 64 | Train Loss: 0.0782003 Vali Loss: 0.1380297 Test Loss: 0.1321451
Validation loss decreased (0.139974 --> 0.138030).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 15 cost time: 0.9036369323730469
Epoch: 15, Steps: 64 | Train Loss: 0.0778033 Vali Loss: 0.1379587 Test Loss: 0.1328103
Validation loss decreased (0.138030 --> 0.137959).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 16 cost time: 0.901097297668457
Epoch: 16, Steps: 64 | Train Loss: 0.0777780 Vali Loss: 0.1382398 Test Loss: 0.1318944
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 17 cost time: 0.9003820419311523
Epoch: 17, Steps: 64 | Train Loss: 0.0768414 Vali Loss: 0.1373754 Test Loss: 0.1321763
Validation loss decreased (0.137959 --> 0.137375).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 18 cost time: 0.920123815536499
Epoch: 18, Steps: 64 | Train Loss: 0.0766892 Vali Loss: 0.1364375 Test Loss: 0.1330321
Validation loss decreased (0.137375 --> 0.136437).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 19 cost time: 0.9264488220214844
Epoch: 19, Steps: 64 | Train Loss: 0.0767174 Vali Loss: 0.1351182 Test Loss: 0.1331389
Validation loss decreased (0.136437 --> 0.135118).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 20 cost time: 0.9199538230895996
Epoch: 20, Steps: 64 | Train Loss: 0.0758915 Vali Loss: 0.1357388 Test Loss: 0.1325451
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 21 cost time: 0.9179999828338623
Epoch: 21, Steps: 64 | Train Loss: 0.0759633 Vali Loss: 0.1350615 Test Loss: 0.1331223
Validation loss decreased (0.135118 --> 0.135062).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 22 cost time: 0.8900001049041748
Epoch: 22, Steps: 64 | Train Loss: 0.0752526 Vali Loss: 0.1335322 Test Loss: 0.1327367
Validation loss decreased (0.135062 --> 0.133532).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 23 cost time: 0.8862028121948242
Epoch: 23, Steps: 64 | Train Loss: 0.0753132 Vali Loss: 0.1339724 Test Loss: 0.1330733
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 24 cost time: 0.8694462776184082
Epoch: 24, Steps: 64 | Train Loss: 0.0755225 Vali Loss: 0.1356373 Test Loss: 0.1324200
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 25 cost time: 0.8739862442016602
Epoch: 25, Steps: 64 | Train Loss: 0.0753850 Vali Loss: 0.1331607 Test Loss: 0.1320271
Validation loss decreased (0.133532 --> 0.133161).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 26 cost time: 0.8936903476715088
Epoch: 26, Steps: 64 | Train Loss: 0.0751001 Vali Loss: 0.1347096 Test Loss: 0.1331799
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 27 cost time: 0.898409366607666
Epoch: 27, Steps: 64 | Train Loss: 0.0750035 Vali Loss: 0.1345228 Test Loss: 0.1323162
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 28 cost time: 0.8909997940063477
Epoch: 28, Steps: 64 | Train Loss: 0.0750962 Vali Loss: 0.1344962 Test Loss: 0.1327764
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 29 cost time: 0.925025224685669
Epoch: 29, Steps: 64 | Train Loss: 0.0746171 Vali Loss: 0.1347816 Test Loss: 0.1327896
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 30 cost time: 0.9055149555206299
Epoch: 30, Steps: 64 | Train Loss: 0.0749005 Vali Loss: 0.1349910 Test Loss: 0.1327470
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 31 cost time: 0.8753688335418701
Epoch: 31, Steps: 64 | Train Loss: 0.0747316 Vali Loss: 0.1353741 Test Loss: 0.1336393
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 32 cost time: 0.875450849533081
Epoch: 32, Steps: 64 | Train Loss: 0.0746061 Vali Loss: 0.1344716 Test Loss: 0.1330040
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 33 cost time: 0.8870053291320801
Epoch: 33, Steps: 64 | Train Loss: 0.0744859 Vali Loss: 0.1346242 Test Loss: 0.1328359
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 34 cost time: 0.8979992866516113
Epoch: 34, Steps: 64 | Train Loss: 0.0742918 Vali Loss: 0.1341248 Test Loss: 0.1324360
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 35 cost time: 0.9229991436004639
Epoch: 35, Steps: 64 | Train Loss: 0.0743497 Vali Loss: 0.1333493 Test Loss: 0.1333424
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 36 cost time: 0.9236485958099365
Epoch: 36, Steps: 64 | Train Loss: 0.0744119 Vali Loss: 0.1335879 Test Loss: 0.1325644
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 37 cost time: 0.9265725612640381
Epoch: 37, Steps: 64 | Train Loss: 0.0744981 Vali Loss: 0.1341892 Test Loss: 0.1331368
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 38 cost time: 0.917025089263916
Epoch: 38, Steps: 64 | Train Loss: 0.0741228 Vali Loss: 0.1340984 Test Loss: 0.1331886
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 39 cost time: 0.9055094718933105
Epoch: 39, Steps: 64 | Train Loss: 0.0745077 Vali Loss: 0.1344685 Test Loss: 0.1326166
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 40 cost time: 0.9067656993865967
Epoch: 40, Steps: 64 | Train Loss: 0.0744002 Vali Loss: 0.1336623 Test Loss: 0.1329041
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 41 cost time: 0.9039976596832275
Epoch: 41, Steps: 64 | Train Loss: 0.0740917 Vali Loss: 0.1332153 Test Loss: 0.1325966
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 42 cost time: 0.9023404121398926
Epoch: 42, Steps: 64 | Train Loss: 0.0739920 Vali Loss: 0.1344656 Test Loss: 0.1332696
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 43 cost time: 0.9116432666778564
Epoch: 43, Steps: 64 | Train Loss: 0.0740153 Vali Loss: 0.1355569 Test Loss: 0.1332562
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 44 cost time: 0.9043967723846436
Epoch: 44, Steps: 64 | Train Loss: 0.0743585 Vali Loss: 0.1334187 Test Loss: 0.1330242
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 45 cost time: 0.8986015319824219
Epoch: 45, Steps: 64 | Train Loss: 0.0739178 Vali Loss: 0.1335047 Test Loss: 0.1329570
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 46 cost time: 0.8934192657470703
Epoch: 46, Steps: 64 | Train Loss: 0.0743457 Vali Loss: 0.1337548 Test Loss: 0.1318871
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 47 cost time: 0.8937199115753174
Epoch: 47, Steps: 64 | Train Loss: 0.0739441 Vali Loss: 0.1350480 Test Loss: 0.1325923
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 48 cost time: 0.8750009536743164
Epoch: 48, Steps: 64 | Train Loss: 0.0740559 Vali Loss: 0.1352470 Test Loss: 0.1328272
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 49 cost time: 0.8806049823760986
Epoch: 49, Steps: 64 | Train Loss: 0.0740913 Vali Loss: 0.1340257 Test Loss: 0.1325337
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 50 cost time: 0.8784239292144775
Epoch: 50, Steps: 64 | Train Loss: 0.0739923 Vali Loss: 0.1342481 Test Loss: 0.1330788
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 51 cost time: 0.8900291919708252
Epoch: 51, Steps: 64 | Train Loss: 0.0744197 Vali Loss: 0.1345278 Test Loss: 0.1328183
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 52 cost time: 0.8953423500061035
Epoch: 52, Steps: 64 | Train Loss: 0.0739962 Vali Loss: 0.1344960 Test Loss: 0.1328785
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 53 cost time: 0.8968222141265869
Epoch: 53, Steps: 64 | Train Loss: 0.0743903 Vali Loss: 0.1333571 Test Loss: 0.1323317
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 54 cost time: 0.8979983329772949
Epoch: 54, Steps: 64 | Train Loss: 0.0742145 Vali Loss: 0.1345906 Test Loss: 0.1328159
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 55 cost time: 0.870927095413208
Epoch: 55, Steps: 64 | Train Loss: 0.0742063 Vali Loss: 0.1335177 Test Loss: 0.1331334
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 56 cost time: 0.8983972072601318
Epoch: 56, Steps: 64 | Train Loss: 0.0741187 Vali Loss: 0.1340133 Test Loss: 0.1326466
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 57 cost time: 0.902493953704834
Epoch: 57, Steps: 64 | Train Loss: 0.0740318 Vali Loss: 0.1345095 Test Loss: 0.1325884
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 58 cost time: 0.9051380157470703
Epoch: 58, Steps: 64 | Train Loss: 0.0744283 Vali Loss: 0.1347804 Test Loss: 0.1329897
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 59 cost time: 0.903357982635498
Epoch: 59, Steps: 64 | Train Loss: 0.0741022 Vali Loss: 0.1334447 Test Loss: 0.1332627
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019891738891601562 GB
GPU已分配内存的峰值：0.05990457534790039 GB
Epoch: 60 cost time: 0.9208145141601562
Epoch: 60, Steps: 64 | Train Loss: 0.0740741 Vali Loss: 0.1337015 Test Loss: 0.1327070
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13202717900276184, mae:0.2623499631881714, rse:0.19339829683303833
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06185483932495117 GB
Epoch: 1 cost time: 2.3367221355438232
Epoch: 1, Steps: 64 | Train Loss: 0.7658265 Vali Loss: 1.7580029 Test Loss: 3.3380847
Validation loss decreased (inf --> 1.758003).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 2 cost time: 0.9594252109527588
Epoch: 2, Steps: 64 | Train Loss: 0.3048574 Vali Loss: 0.2338276 Test Loss: 0.2476624
Validation loss decreased (1.758003 --> 0.233828).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 3 cost time: 0.9346411228179932
Epoch: 3, Steps: 64 | Train Loss: 0.1017879 Vali Loss: 0.1751001 Test Loss: 0.1416429
Validation loss decreased (0.233828 --> 0.175100).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 4 cost time: 0.9443149566650391
Epoch: 4, Steps: 64 | Train Loss: 0.0906750 Vali Loss: 0.1671198 Test Loss: 0.1385670
Validation loss decreased (0.175100 --> 0.167120).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 5 cost time: 0.9160010814666748
Epoch: 5, Steps: 64 | Train Loss: 0.0876482 Vali Loss: 0.1626393 Test Loss: 0.1363255
Validation loss decreased (0.167120 --> 0.162639).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 6 cost time: 0.9106390476226807
Epoch: 6, Steps: 64 | Train Loss: 0.0858396 Vali Loss: 0.1584067 Test Loss: 0.1348782
Validation loss decreased (0.162639 --> 0.158407).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 7 cost time: 0.9154658317565918
Epoch: 7, Steps: 64 | Train Loss: 0.0839466 Vali Loss: 0.1576520 Test Loss: 0.1347231
Validation loss decreased (0.158407 --> 0.157652).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 8 cost time: 0.9170141220092773
Epoch: 8, Steps: 64 | Train Loss: 0.0826365 Vali Loss: 0.1531543 Test Loss: 0.1332112
Validation loss decreased (0.157652 --> 0.153154).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 9 cost time: 0.9443750381469727
Epoch: 9, Steps: 64 | Train Loss: 0.0818269 Vali Loss: 0.1513604 Test Loss: 0.1326556
Validation loss decreased (0.153154 --> 0.151360).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 10 cost time: 0.9414756298065186
Epoch: 10, Steps: 64 | Train Loss: 0.0810655 Vali Loss: 0.1489612 Test Loss: 0.1313450
Validation loss decreased (0.151360 --> 0.148961).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 11 cost time: 0.9604315757751465
Epoch: 11, Steps: 64 | Train Loss: 0.0802749 Vali Loss: 0.1477376 Test Loss: 0.1311216
Validation loss decreased (0.148961 --> 0.147738).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 12 cost time: 0.9633903503417969
Epoch: 12, Steps: 64 | Train Loss: 0.0794940 Vali Loss: 0.1458698 Test Loss: 0.1312019
Validation loss decreased (0.147738 --> 0.145870).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 13 cost time: 0.9510354995727539
Epoch: 13, Steps: 64 | Train Loss: 0.0787549 Vali Loss: 0.1432862 Test Loss: 0.1294463
Validation loss decreased (0.145870 --> 0.143286).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 14 cost time: 0.9440004825592041
Epoch: 14, Steps: 64 | Train Loss: 0.0780795 Vali Loss: 0.1414513 Test Loss: 0.1306717
Validation loss decreased (0.143286 --> 0.141451).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 15 cost time: 0.9506368637084961
Epoch: 15, Steps: 64 | Train Loss: 0.0778412 Vali Loss: 0.1399568 Test Loss: 0.1296889
Validation loss decreased (0.141451 --> 0.139957).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 16 cost time: 0.9503626823425293
Epoch: 16, Steps: 64 | Train Loss: 0.0773800 Vali Loss: 0.1405311 Test Loss: 0.1307835
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 17 cost time: 0.9580507278442383
Epoch: 17, Steps: 64 | Train Loss: 0.0772167 Vali Loss: 0.1388707 Test Loss: 0.1296324
Validation loss decreased (0.139957 --> 0.138871).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 18 cost time: 0.9744775295257568
Epoch: 18, Steps: 64 | Train Loss: 0.0768996 Vali Loss: 0.1379320 Test Loss: 0.1288104
Validation loss decreased (0.138871 --> 0.137932).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 19 cost time: 0.9633681774139404
Epoch: 19, Steps: 64 | Train Loss: 0.0764705 Vali Loss: 0.1392204 Test Loss: 0.1291093
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 20 cost time: 0.966341495513916
Epoch: 20, Steps: 64 | Train Loss: 0.0764718 Vali Loss: 0.1371641 Test Loss: 0.1301122
Validation loss decreased (0.137932 --> 0.137164).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 21 cost time: 0.9490396976470947
Epoch: 21, Steps: 64 | Train Loss: 0.0760471 Vali Loss: 0.1373581 Test Loss: 0.1298421
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 22 cost time: 0.9237575531005859
Epoch: 22, Steps: 64 | Train Loss: 0.0760418 Vali Loss: 0.1370551 Test Loss: 0.1293609
Validation loss decreased (0.137164 --> 0.137055).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 23 cost time: 0.9247574806213379
Epoch: 23, Steps: 64 | Train Loss: 0.0758546 Vali Loss: 0.1355383 Test Loss: 0.1298515
Validation loss decreased (0.137055 --> 0.135538).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 24 cost time: 0.9219996929168701
Epoch: 24, Steps: 64 | Train Loss: 0.0760145 Vali Loss: 0.1340787 Test Loss: 0.1292194
Validation loss decreased (0.135538 --> 0.134079).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 25 cost time: 0.91802978515625
Epoch: 25, Steps: 64 | Train Loss: 0.0757372 Vali Loss: 0.1359202 Test Loss: 0.1292778
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 26 cost time: 0.9314026832580566
Epoch: 26, Steps: 64 | Train Loss: 0.0758733 Vali Loss: 0.1359179 Test Loss: 0.1292978
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 27 cost time: 0.9395661354064941
Epoch: 27, Steps: 64 | Train Loss: 0.0755609 Vali Loss: 0.1367072 Test Loss: 0.1293715
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 28 cost time: 0.9364457130432129
Epoch: 28, Steps: 64 | Train Loss: 0.0751881 Vali Loss: 0.1363739 Test Loss: 0.1289467
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 29 cost time: 0.9241807460784912
Epoch: 29, Steps: 64 | Train Loss: 0.0751417 Vali Loss: 0.1351039 Test Loss: 0.1293554
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 30 cost time: 0.9210493564605713
Epoch: 30, Steps: 64 | Train Loss: 0.0754600 Vali Loss: 0.1360087 Test Loss: 0.1292914
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 31 cost time: 0.9257867336273193
Epoch: 31, Steps: 64 | Train Loss: 0.0752299 Vali Loss: 0.1343623 Test Loss: 0.1291044
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 32 cost time: 0.9379992485046387
Epoch: 32, Steps: 64 | Train Loss: 0.0746801 Vali Loss: 0.1342839 Test Loss: 0.1292934
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 33 cost time: 0.9616317749023438
Epoch: 33, Steps: 64 | Train Loss: 0.0747685 Vali Loss: 0.1352491 Test Loss: 0.1290505
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 34 cost time: 0.9656293392181396
Epoch: 34, Steps: 64 | Train Loss: 0.0751902 Vali Loss: 0.1348755 Test Loss: 0.1288543
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 35 cost time: 0.9713888168334961
Epoch: 35, Steps: 64 | Train Loss: 0.0749781 Vali Loss: 0.1358146 Test Loss: 0.1287790
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 36 cost time: 0.9645881652832031
Epoch: 36, Steps: 64 | Train Loss: 0.0749510 Vali Loss: 0.1344436 Test Loss: 0.1294754
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 37 cost time: 0.9634673595428467
Epoch: 37, Steps: 64 | Train Loss: 0.0749071 Vali Loss: 0.1352620 Test Loss: 0.1285299
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 38 cost time: 0.96523118019104
Epoch: 38, Steps: 64 | Train Loss: 0.0747173 Vali Loss: 0.1348627 Test Loss: 0.1292682
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 39 cost time: 0.9424483776092529
Epoch: 39, Steps: 64 | Train Loss: 0.0748956 Vali Loss: 0.1341357 Test Loss: 0.1297232
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 40 cost time: 0.9375417232513428
Epoch: 40, Steps: 64 | Train Loss: 0.0747670 Vali Loss: 0.1344519 Test Loss: 0.1291787
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 41 cost time: 0.9564347267150879
Epoch: 41, Steps: 64 | Train Loss: 0.0747047 Vali Loss: 0.1344962 Test Loss: 0.1285477
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 42 cost time: 0.9544322490692139
Epoch: 42, Steps: 64 | Train Loss: 0.0746963 Vali Loss: 0.1335209 Test Loss: 0.1294733
Validation loss decreased (0.134079 --> 0.133521).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 43 cost time: 0.9470024108886719
Epoch: 43, Steps: 64 | Train Loss: 0.0748675 Vali Loss: 0.1348687 Test Loss: 0.1295623
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 44 cost time: 0.941638708114624
Epoch: 44, Steps: 64 | Train Loss: 0.0747866 Vali Loss: 0.1345972 Test Loss: 0.1297247
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 45 cost time: 0.951439380645752
Epoch: 45, Steps: 64 | Train Loss: 0.0744372 Vali Loss: 0.1353649 Test Loss: 0.1287564
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 46 cost time: 0.928459644317627
Epoch: 46, Steps: 64 | Train Loss: 0.0744602 Vali Loss: 0.1338811 Test Loss: 0.1285249
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 47 cost time: 0.9524612426757812
Epoch: 47, Steps: 64 | Train Loss: 0.0747553 Vali Loss: 0.1348504 Test Loss: 0.1292168
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 48 cost time: 0.962890625
Epoch: 48, Steps: 64 | Train Loss: 0.0747329 Vali Loss: 0.1344464 Test Loss: 0.1286088
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 49 cost time: 0.9323928356170654
Epoch: 49, Steps: 64 | Train Loss: 0.0743410 Vali Loss: 0.1353268 Test Loss: 0.1288993
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 50 cost time: 0.9391963481903076
Epoch: 50, Steps: 64 | Train Loss: 0.0744989 Vali Loss: 0.1346416 Test Loss: 0.1295872
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 51 cost time: 0.9440014362335205
Epoch: 51, Steps: 64 | Train Loss: 0.0750520 Vali Loss: 0.1345491 Test Loss: 0.1286188
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 52 cost time: 0.9409995079040527
Epoch: 52, Steps: 64 | Train Loss: 0.0747717 Vali Loss: 0.1328426 Test Loss: 0.1289923
Validation loss decreased (0.133521 --> 0.132843).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 53 cost time: 0.9616506099700928
Epoch: 53, Steps: 64 | Train Loss: 0.0747447 Vali Loss: 0.1342320 Test Loss: 0.1299773
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 54 cost time: 0.943889856338501
Epoch: 54, Steps: 64 | Train Loss: 0.0747539 Vali Loss: 0.1342501 Test Loss: 0.1291096
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 55 cost time: 0.9494297504425049
Epoch: 55, Steps: 64 | Train Loss: 0.0747750 Vali Loss: 0.1349662 Test Loss: 0.1291030
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 56 cost time: 0.9463968276977539
Epoch: 56, Steps: 64 | Train Loss: 0.0743711 Vali Loss: 0.1343433 Test Loss: 0.1293477
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 57 cost time: 0.9423859119415283
Epoch: 57, Steps: 64 | Train Loss: 0.0744588 Vali Loss: 0.1347980 Test Loss: 0.1289022
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 58 cost time: 0.968374490737915
Epoch: 58, Steps: 64 | Train Loss: 0.0744531 Vali Loss: 0.1347830 Test Loss: 0.1290029
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 59 cost time: 0.9674263000488281
Epoch: 59, Steps: 64 | Train Loss: 0.0746489 Vali Loss: 0.1348719 Test Loss: 0.1290937
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020875930786132812 GB
GPU已分配内存的峰值：0.06369543075561523 GB
Epoch: 60 cost time: 0.9647610187530518
Epoch: 60, Steps: 64 | Train Loss: 0.0744181 Vali Loss: 0.1345052 Test Loss: 0.1289627
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.12899228930473328, mae:0.2558550536632538, rse:0.191162571310997
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.054323673248291016 GB
Epoch: 1 cost time: 2.2861688137054443
Epoch: 1, Steps: 64 | Train Loss: 0.8287286 Vali Loss: 1.8070817 Test Loss: 3.4638782
Validation loss decreased (inf --> 1.807082).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 2 cost time: 0.8714277744293213
Epoch: 2, Steps: 64 | Train Loss: 0.6056106 Vali Loss: 0.9082462 Test Loss: 1.5578159
Validation loss decreased (1.807082 --> 0.908246).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 3 cost time: 0.8693864345550537
Epoch: 3, Steps: 64 | Train Loss: 0.3355608 Vali Loss: 0.4983855 Test Loss: 0.7154683
Validation loss decreased (0.908246 --> 0.498386).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 4 cost time: 0.8696770668029785
Epoch: 4, Steps: 64 | Train Loss: 0.2043031 Vali Loss: 0.3348633 Test Loss: 0.4103551
Validation loss decreased (0.498386 --> 0.334863).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 5 cost time: 0.8643803596496582
Epoch: 5, Steps: 64 | Train Loss: 0.1458717 Vali Loss: 0.2473858 Test Loss: 0.2636388
Validation loss decreased (0.334863 --> 0.247386).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 6 cost time: 0.8521437644958496
Epoch: 6, Steps: 64 | Train Loss: 0.1217945 Vali Loss: 0.2059218 Test Loss: 0.2049467
Validation loss decreased (0.247386 --> 0.205922).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 7 cost time: 0.8453850746154785
Epoch: 7, Steps: 64 | Train Loss: 0.1108027 Vali Loss: 0.1867803 Test Loss: 0.1760487
Validation loss decreased (0.205922 --> 0.186780).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 8 cost time: 0.8439991474151611
Epoch: 8, Steps: 64 | Train Loss: 0.1048390 Vali Loss: 0.1785618 Test Loss: 0.1643329
Validation loss decreased (0.186780 --> 0.178562).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 9 cost time: 0.8510000705718994
Epoch: 9, Steps: 64 | Train Loss: 0.1012056 Vali Loss: 0.1683592 Test Loss: 0.1562894
Validation loss decreased (0.178562 --> 0.168359).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 10 cost time: 0.874173641204834
Epoch: 10, Steps: 64 | Train Loss: 0.0988907 Vali Loss: 0.1670289 Test Loss: 0.1535284
Validation loss decreased (0.168359 --> 0.167029).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 11 cost time: 0.8753750324249268
Epoch: 11, Steps: 64 | Train Loss: 0.0975701 Vali Loss: 0.1640511 Test Loss: 0.1514338
Validation loss decreased (0.167029 --> 0.164051).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 12 cost time: 0.8827643394470215
Epoch: 12, Steps: 64 | Train Loss: 0.0952881 Vali Loss: 0.1611251 Test Loss: 0.1493340
Validation loss decreased (0.164051 --> 0.161125).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 13 cost time: 0.8913698196411133
Epoch: 13, Steps: 64 | Train Loss: 0.0946586 Vali Loss: 0.1615279 Test Loss: 0.1479022
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 14 cost time: 0.8650014400482178
Epoch: 14, Steps: 64 | Train Loss: 0.0938648 Vali Loss: 0.1585837 Test Loss: 0.1470480
Validation loss decreased (0.161125 --> 0.158584).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 15 cost time: 0.8679995536804199
Epoch: 15, Steps: 64 | Train Loss: 0.0929620 Vali Loss: 0.1592881 Test Loss: 0.1466612
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 16 cost time: 0.8637616634368896
Epoch: 16, Steps: 64 | Train Loss: 0.0917219 Vali Loss: 0.1578804 Test Loss: 0.1460529
Validation loss decreased (0.158584 --> 0.157880).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 17 cost time: 0.867434024810791
Epoch: 17, Steps: 64 | Train Loss: 0.0916889 Vali Loss: 0.1579465 Test Loss: 0.1456779
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 18 cost time: 0.8803524971008301
Epoch: 18, Steps: 64 | Train Loss: 0.0911763 Vali Loss: 0.1576381 Test Loss: 0.1453081
Validation loss decreased (0.157880 --> 0.157638).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 19 cost time: 0.8860671520233154
Epoch: 19, Steps: 64 | Train Loss: 0.0906379 Vali Loss: 0.1577702 Test Loss: 0.1452998
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 20 cost time: 0.8860015869140625
Epoch: 20, Steps: 64 | Train Loss: 0.0902685 Vali Loss: 0.1585589 Test Loss: 0.1449739
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 21 cost time: 0.8856415748596191
Epoch: 21, Steps: 64 | Train Loss: 0.0896020 Vali Loss: 0.1548235 Test Loss: 0.1445789
Validation loss decreased (0.157638 --> 0.154823).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 22 cost time: 0.8944218158721924
Epoch: 22, Steps: 64 | Train Loss: 0.0893901 Vali Loss: 0.1551073 Test Loss: 0.1444651
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 23 cost time: 0.8721654415130615
Epoch: 23, Steps: 64 | Train Loss: 0.0895569 Vali Loss: 0.1559677 Test Loss: 0.1445698
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 24 cost time: 0.8504765033721924
Epoch: 24, Steps: 64 | Train Loss: 0.0887550 Vali Loss: 0.1550644 Test Loss: 0.1444078
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 25 cost time: 0.8511204719543457
Epoch: 25, Steps: 64 | Train Loss: 0.0889781 Vali Loss: 0.1566741 Test Loss: 0.1440662
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 26 cost time: 0.8510000705718994
Epoch: 26, Steps: 64 | Train Loss: 0.0889046 Vali Loss: 0.1534868 Test Loss: 0.1442292
Validation loss decreased (0.154823 --> 0.153487).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 27 cost time: 0.8616108894348145
Epoch: 27, Steps: 64 | Train Loss: 0.0882021 Vali Loss: 0.1541830 Test Loss: 0.1440660
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 28 cost time: 0.86598801612854
Epoch: 28, Steps: 64 | Train Loss: 0.0882562 Vali Loss: 0.1545225 Test Loss: 0.1438921
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 29 cost time: 0.8684039115905762
Epoch: 29, Steps: 64 | Train Loss: 0.0879773 Vali Loss: 0.1559406 Test Loss: 0.1437906
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 30 cost time: 0.8672208786010742
Epoch: 30, Steps: 64 | Train Loss: 0.0877710 Vali Loss: 0.1548862 Test Loss: 0.1437846
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 31 cost time: 0.871999979019165
Epoch: 31, Steps: 64 | Train Loss: 0.0876544 Vali Loss: 0.1548370 Test Loss: 0.1439226
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 32 cost time: 0.8449990749359131
Epoch: 32, Steps: 64 | Train Loss: 0.0876227 Vali Loss: 0.1558479 Test Loss: 0.1438146
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 33 cost time: 0.8445076942443848
Epoch: 33, Steps: 64 | Train Loss: 0.0873270 Vali Loss: 0.1543449 Test Loss: 0.1441290
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 34 cost time: 0.85854172706604
Epoch: 34, Steps: 64 | Train Loss: 0.0876141 Vali Loss: 0.1545586 Test Loss: 0.1436229
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 35 cost time: 0.874443769454956
Epoch: 35, Steps: 64 | Train Loss: 0.0875760 Vali Loss: 0.1543781 Test Loss: 0.1433254
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 36 cost time: 0.8867363929748535
Epoch: 36, Steps: 64 | Train Loss: 0.0872283 Vali Loss: 0.1548835 Test Loss: 0.1435092
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 37 cost time: 0.8889980316162109
Epoch: 37, Steps: 64 | Train Loss: 0.0867781 Vali Loss: 0.1528073 Test Loss: 0.1436010
Validation loss decreased (0.153487 --> 0.152807).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 38 cost time: 0.8836302757263184
Epoch: 38, Steps: 64 | Train Loss: 0.0873504 Vali Loss: 0.1531212 Test Loss: 0.1435344
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 39 cost time: 0.8892829418182373
Epoch: 39, Steps: 64 | Train Loss: 0.0866903 Vali Loss: 0.1529131 Test Loss: 0.1435298
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 40 cost time: 0.8923938274383545
Epoch: 40, Steps: 64 | Train Loss: 0.0869780 Vali Loss: 0.1539702 Test Loss: 0.1437871
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 41 cost time: 0.8875434398651123
Epoch: 41, Steps: 64 | Train Loss: 0.0870003 Vali Loss: 0.1535972 Test Loss: 0.1438199
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 42 cost time: 0.8707437515258789
Epoch: 42, Steps: 64 | Train Loss: 0.0865621 Vali Loss: 0.1539293 Test Loss: 0.1433963
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 43 cost time: 0.8733870983123779
Epoch: 43, Steps: 64 | Train Loss: 0.0868727 Vali Loss: 0.1524295 Test Loss: 0.1436331
Validation loss decreased (0.152807 --> 0.152429).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 44 cost time: 0.8676338195800781
Epoch: 44, Steps: 64 | Train Loss: 0.0866891 Vali Loss: 0.1518752 Test Loss: 0.1432737
Validation loss decreased (0.152429 --> 0.151875).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 45 cost time: 0.8985419273376465
Epoch: 45, Steps: 64 | Train Loss: 0.0867102 Vali Loss: 0.1528740 Test Loss: 0.1434312
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 46 cost time: 0.878375768661499
Epoch: 46, Steps: 64 | Train Loss: 0.0865632 Vali Loss: 0.1516859 Test Loss: 0.1434501
Validation loss decreased (0.151875 --> 0.151686).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 47 cost time: 0.8724048137664795
Epoch: 47, Steps: 64 | Train Loss: 0.0864154 Vali Loss: 0.1539547 Test Loss: 0.1434192
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 48 cost time: 0.8833832740783691
Epoch: 48, Steps: 64 | Train Loss: 0.0868045 Vali Loss: 0.1528442 Test Loss: 0.1433091
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 49 cost time: 0.8660023212432861
Epoch: 49, Steps: 64 | Train Loss: 0.0867427 Vali Loss: 0.1535055 Test Loss: 0.1433052
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 50 cost time: 0.8536438941955566
Epoch: 50, Steps: 64 | Train Loss: 0.0862787 Vali Loss: 0.1548161 Test Loss: 0.1435921
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 51 cost time: 0.851477861404419
Epoch: 51, Steps: 64 | Train Loss: 0.0863188 Vali Loss: 0.1533146 Test Loss: 0.1434129
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 52 cost time: 0.8654608726501465
Epoch: 52, Steps: 64 | Train Loss: 0.0865658 Vali Loss: 0.1539433 Test Loss: 0.1433893
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 53 cost time: 0.8564743995666504
Epoch: 53, Steps: 64 | Train Loss: 0.0863517 Vali Loss: 0.1521497 Test Loss: 0.1433695
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 54 cost time: 0.8619983196258545
Epoch: 54, Steps: 64 | Train Loss: 0.0866199 Vali Loss: 0.1542105 Test Loss: 0.1434013
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 55 cost time: 0.8706459999084473
Epoch: 55, Steps: 64 | Train Loss: 0.0860606 Vali Loss: 0.1532499 Test Loss: 0.1431963
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 56 cost time: 0.8784029483795166
Epoch: 56, Steps: 64 | Train Loss: 0.0862113 Vali Loss: 0.1545807 Test Loss: 0.1430732
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 57 cost time: 0.8833916187286377
Epoch: 57, Steps: 64 | Train Loss: 0.0866578 Vali Loss: 0.1531971 Test Loss: 0.1434613
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 58 cost time: 0.8934369087219238
Epoch: 58, Steps: 64 | Train Loss: 0.0867160 Vali Loss: 0.1534235 Test Loss: 0.1434176
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 59 cost time: 0.8824045658111572
Epoch: 59, Steps: 64 | Train Loss: 0.0870303 Vali Loss: 0.1532817 Test Loss: 0.1432274
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.017946243286132812 GB
GPU已分配内存的峰值：0.05469942092895508 GB
Epoch: 60 cost time: 0.8870015144348145
Epoch: 60, Steps: 64 | Train Loss: 0.0865598 Vali Loss: 0.1541362 Test Loss: 0.1435022
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1434500515460968, mae:0.28033238649368286, rse:0.20159108936786652
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.058718204498291016 GB
Epoch: 1 cost time: 2.305511236190796
Epoch: 1, Steps: 64 | Train Loss: 0.7367689 Vali Loss: 1.6681973 Test Loss: 3.1476252
Validation loss decreased (inf --> 1.668197).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 2 cost time: 0.939225435256958
Epoch: 2, Steps: 64 | Train Loss: 0.3266860 Vali Loss: 0.2005607 Test Loss: 0.1661657
Validation loss decreased (1.668197 --> 0.200561).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 3 cost time: 0.9128363132476807
Epoch: 3, Steps: 64 | Train Loss: 0.1016691 Vali Loss: 0.1697792 Test Loss: 0.1446211
Validation loss decreased (0.200561 --> 0.169779).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 4 cost time: 0.9159896373748779
Epoch: 4, Steps: 64 | Train Loss: 0.0917773 Vali Loss: 0.1613106 Test Loss: 0.1374525
Validation loss decreased (0.169779 --> 0.161311).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 5 cost time: 0.8974490165710449
Epoch: 5, Steps: 64 | Train Loss: 0.0885261 Vali Loss: 0.1595245 Test Loss: 0.1367662
Validation loss decreased (0.161311 --> 0.159524).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 6 cost time: 0.9031908512115479
Epoch: 6, Steps: 64 | Train Loss: 0.0869844 Vali Loss: 0.1590312 Test Loss: 0.1361000
Validation loss decreased (0.159524 --> 0.159031).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 7 cost time: 0.9042649269104004
Epoch: 7, Steps: 64 | Train Loss: 0.0855873 Vali Loss: 0.1558785 Test Loss: 0.1352006
Validation loss decreased (0.159031 --> 0.155879).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 8 cost time: 0.8994460105895996
Epoch: 8, Steps: 64 | Train Loss: 0.0844999 Vali Loss: 0.1531017 Test Loss: 0.1345491
Validation loss decreased (0.155879 --> 0.153102).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 9 cost time: 0.9267735481262207
Epoch: 9, Steps: 64 | Train Loss: 0.0834590 Vali Loss: 0.1531738 Test Loss: 0.1346499
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 10 cost time: 0.9139974117279053
Epoch: 10, Steps: 64 | Train Loss: 0.0832931 Vali Loss: 0.1524031 Test Loss: 0.1350437
Validation loss decreased (0.153102 --> 0.152403).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 11 cost time: 0.9179983139038086
Epoch: 11, Steps: 64 | Train Loss: 0.0823884 Vali Loss: 0.1528198 Test Loss: 0.1351767
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 12 cost time: 0.937650203704834
Epoch: 12, Steps: 64 | Train Loss: 0.0819691 Vali Loss: 0.1520931 Test Loss: 0.1344423
Validation loss decreased (0.152403 --> 0.152093).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 13 cost time: 0.9224436283111572
Epoch: 13, Steps: 64 | Train Loss: 0.0816415 Vali Loss: 0.1511442 Test Loss: 0.1347649
Validation loss decreased (0.152093 --> 0.151144).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 14 cost time: 0.9132566452026367
Epoch: 14, Steps: 64 | Train Loss: 0.0812163 Vali Loss: 0.1528476 Test Loss: 0.1340938
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 15 cost time: 0.9134097099304199
Epoch: 15, Steps: 64 | Train Loss: 0.0810526 Vali Loss: 0.1496195 Test Loss: 0.1340605
Validation loss decreased (0.151144 --> 0.149620).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 16 cost time: 0.9224157333374023
Epoch: 16, Steps: 64 | Train Loss: 0.0808801 Vali Loss: 0.1511951 Test Loss: 0.1335083
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 17 cost time: 0.9207830429077148
Epoch: 17, Steps: 64 | Train Loss: 0.0807608 Vali Loss: 0.1507908 Test Loss: 0.1333478
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 18 cost time: 0.9249956607818604
Epoch: 18, Steps: 64 | Train Loss: 0.0801526 Vali Loss: 0.1478580 Test Loss: 0.1335110
Validation loss decreased (0.149620 --> 0.147858).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 19 cost time: 0.9406116008758545
Epoch: 19, Steps: 64 | Train Loss: 0.0798868 Vali Loss: 0.1498904 Test Loss: 0.1334166
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 20 cost time: 0.9289979934692383
Epoch: 20, Steps: 64 | Train Loss: 0.0801350 Vali Loss: 0.1487064 Test Loss: 0.1333526
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 21 cost time: 0.9266531467437744
Epoch: 21, Steps: 64 | Train Loss: 0.0796107 Vali Loss: 0.1498413 Test Loss: 0.1337623
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 22 cost time: 0.9114634990692139
Epoch: 22, Steps: 64 | Train Loss: 0.0794585 Vali Loss: 0.1483410 Test Loss: 0.1334781
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 23 cost time: 0.9018330574035645
Epoch: 23, Steps: 64 | Train Loss: 0.0796180 Vali Loss: 0.1498814 Test Loss: 0.1341803
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 24 cost time: 0.9005420207977295
Epoch: 24, Steps: 64 | Train Loss: 0.0795063 Vali Loss: 0.1499805 Test Loss: 0.1335876
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 25 cost time: 0.9009709358215332
Epoch: 25, Steps: 64 | Train Loss: 0.0794861 Vali Loss: 0.1466915 Test Loss: 0.1331326
Validation loss decreased (0.147858 --> 0.146692).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 26 cost time: 0.9160010814666748
Epoch: 26, Steps: 64 | Train Loss: 0.0793640 Vali Loss: 0.1472770 Test Loss: 0.1332827
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 27 cost time: 0.9110488891601562
Epoch: 27, Steps: 64 | Train Loss: 0.0796353 Vali Loss: 0.1494532 Test Loss: 0.1335762
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 28 cost time: 0.9174339771270752
Epoch: 28, Steps: 64 | Train Loss: 0.0790127 Vali Loss: 0.1477193 Test Loss: 0.1330140
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 29 cost time: 0.9183852672576904
Epoch: 29, Steps: 64 | Train Loss: 0.0788744 Vali Loss: 0.1469392 Test Loss: 0.1333541
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 30 cost time: 0.907461404800415
Epoch: 30, Steps: 64 | Train Loss: 0.0788183 Vali Loss: 0.1471842 Test Loss: 0.1328334
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 31 cost time: 0.9007494449615479
Epoch: 31, Steps: 64 | Train Loss: 0.0787650 Vali Loss: 0.1479357 Test Loss: 0.1330976
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 32 cost time: 0.9027395248413086
Epoch: 32, Steps: 64 | Train Loss: 0.0786747 Vali Loss: 0.1490784 Test Loss: 0.1333850
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 33 cost time: 0.9079995155334473
Epoch: 33, Steps: 64 | Train Loss: 0.0788074 Vali Loss: 0.1472156 Test Loss: 0.1331275
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 34 cost time: 0.9406492710113525
Epoch: 34, Steps: 64 | Train Loss: 0.0787413 Vali Loss: 0.1490832 Test Loss: 0.1334331
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 35 cost time: 0.9383933544158936
Epoch: 35, Steps: 64 | Train Loss: 0.0788345 Vali Loss: 0.1477372 Test Loss: 0.1328081
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 36 cost time: 0.9350259304046631
Epoch: 36, Steps: 64 | Train Loss: 0.0786277 Vali Loss: 0.1462707 Test Loss: 0.1335299
Validation loss decreased (0.146692 --> 0.146271).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 37 cost time: 0.942420244216919
Epoch: 37, Steps: 64 | Train Loss: 0.0783844 Vali Loss: 0.1480870 Test Loss: 0.1327783
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 38 cost time: 0.9097189903259277
Epoch: 38, Steps: 64 | Train Loss: 0.0787404 Vali Loss: 0.1472549 Test Loss: 0.1326632
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 39 cost time: 0.9153902530670166
Epoch: 39, Steps: 64 | Train Loss: 0.0789295 Vali Loss: 0.1474354 Test Loss: 0.1332065
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 40 cost time: 0.9242403507232666
Epoch: 40, Steps: 64 | Train Loss: 0.0784569 Vali Loss: 0.1484738 Test Loss: 0.1333306
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 41 cost time: 0.920001745223999
Epoch: 41, Steps: 64 | Train Loss: 0.0785903 Vali Loss: 0.1466798 Test Loss: 0.1327293
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 42 cost time: 0.9286808967590332
Epoch: 42, Steps: 64 | Train Loss: 0.0782672 Vali Loss: 0.1477154 Test Loss: 0.1331869
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 43 cost time: 0.9364941120147705
Epoch: 43, Steps: 64 | Train Loss: 0.0786972 Vali Loss: 0.1463247 Test Loss: 0.1334587
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 44 cost time: 0.9254012107849121
Epoch: 44, Steps: 64 | Train Loss: 0.0785464 Vali Loss: 0.1484252 Test Loss: 0.1331110
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 45 cost time: 0.9164187908172607
Epoch: 45, Steps: 64 | Train Loss: 0.0783548 Vali Loss: 0.1487836 Test Loss: 0.1329395
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 46 cost time: 0.9102001190185547
Epoch: 46, Steps: 64 | Train Loss: 0.0783326 Vali Loss: 0.1475758 Test Loss: 0.1329214
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 47 cost time: 0.9047584533691406
Epoch: 47, Steps: 64 | Train Loss: 0.0785624 Vali Loss: 0.1476682 Test Loss: 0.1331238
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 48 cost time: 0.9005410671234131
Epoch: 48, Steps: 64 | Train Loss: 0.0783600 Vali Loss: 0.1475753 Test Loss: 0.1329280
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 49 cost time: 0.9070000648498535
Epoch: 49, Steps: 64 | Train Loss: 0.0782312 Vali Loss: 0.1471708 Test Loss: 0.1326925
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 50 cost time: 0.9086153507232666
Epoch: 50, Steps: 64 | Train Loss: 0.0785410 Vali Loss: 0.1459396 Test Loss: 0.1329374
Validation loss decreased (0.146271 --> 0.145940).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 51 cost time: 0.9173977375030518
Epoch: 51, Steps: 64 | Train Loss: 0.0785269 Vali Loss: 0.1470208 Test Loss: 0.1331578
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 52 cost time: 0.9185569286346436
Epoch: 52, Steps: 64 | Train Loss: 0.0783425 Vali Loss: 0.1477463 Test Loss: 0.1334994
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 53 cost time: 0.9200284481048584
Epoch: 53, Steps: 64 | Train Loss: 0.0781965 Vali Loss: 0.1464144 Test Loss: 0.1330284
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 54 cost time: 0.9183881282806396
Epoch: 54, Steps: 64 | Train Loss: 0.0784079 Vali Loss: 0.1473106 Test Loss: 0.1329962
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 55 cost time: 0.9058239459991455
Epoch: 55, Steps: 64 | Train Loss: 0.0785207 Vali Loss: 0.1470627 Test Loss: 0.1329534
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 56 cost time: 0.928002119064331
Epoch: 56, Steps: 64 | Train Loss: 0.0783898 Vali Loss: 0.1479745 Test Loss: 0.1329901
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 57 cost time: 0.9306378364562988
Epoch: 57, Steps: 64 | Train Loss: 0.0785455 Vali Loss: 0.1472842 Test Loss: 0.1330006
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 58 cost time: 0.9306564331054688
Epoch: 58, Steps: 64 | Train Loss: 0.0782434 Vali Loss: 0.1477789 Test Loss: 0.1328968
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 59 cost time: 0.9323997497558594
Epoch: 59, Steps: 64 | Train Loss: 0.0781983 Vali Loss: 0.1467358 Test Loss: 0.1324825
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.019899368286132812 GB
GPU已分配内存的峰值：0.06007051467895508 GB
Epoch: 60 cost time: 0.938387393951416
Epoch: 60, Steps: 64 | Train Loss: 0.0786538 Vali Loss: 0.1464968 Test Loss: 0.1328289
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13293741643428802, mae:0.26079708337783813, rse:0.19406382739543915
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.062016963958740234 GB
Epoch: 1 cost time: 2.369741678237915
Epoch: 1, Steps: 64 | Train Loss: 0.7133499 Vali Loss: 1.6439906 Test Loss: 3.1005909
Validation loss decreased (inf --> 1.643991).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 2 cost time: 0.9676308631896973
Epoch: 2, Steps: 64 | Train Loss: 0.2830138 Vali Loss: 0.2290401 Test Loss: 0.2619767
Validation loss decreased (1.643991 --> 0.229040).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 3 cost time: 0.9524838924407959
Epoch: 3, Steps: 64 | Train Loss: 0.1007909 Vali Loss: 0.1679753 Test Loss: 0.1364372
Validation loss decreased (0.229040 --> 0.167975).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 4 cost time: 0.9703664779663086
Epoch: 4, Steps: 64 | Train Loss: 0.0908602 Vali Loss: 0.1600496 Test Loss: 0.1387447
Validation loss decreased (0.167975 --> 0.160050).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 5 cost time: 0.9185471534729004
Epoch: 5, Steps: 64 | Train Loss: 0.0878214 Vali Loss: 0.1594826 Test Loss: 0.1348883
Validation loss decreased (0.160050 --> 0.159483).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 6 cost time: 0.9228525161743164
Epoch: 6, Steps: 64 | Train Loss: 0.0857566 Vali Loss: 0.1551898 Test Loss: 0.1347091
Validation loss decreased (0.159483 --> 0.155190).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 7 cost time: 0.9214484691619873
Epoch: 7, Steps: 64 | Train Loss: 0.0845166 Vali Loss: 0.1548238 Test Loss: 0.1360136
Validation loss decreased (0.155190 --> 0.154824).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 8 cost time: 0.925753116607666
Epoch: 8, Steps: 64 | Train Loss: 0.0831882 Vali Loss: 0.1515087 Test Loss: 0.1357196
Validation loss decreased (0.154824 --> 0.151509).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 9 cost time: 0.9666376113891602
Epoch: 9, Steps: 64 | Train Loss: 0.0822901 Vali Loss: 0.1505082 Test Loss: 0.1341479
Validation loss decreased (0.151509 --> 0.150508).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 10 cost time: 0.9794800281524658
Epoch: 10, Steps: 64 | Train Loss: 0.0816717 Vali Loss: 0.1510101 Test Loss: 0.1341580
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 11 cost time: 0.9472160339355469
Epoch: 11, Steps: 64 | Train Loss: 0.0810097 Vali Loss: 0.1474025 Test Loss: 0.1356229
Validation loss decreased (0.150508 --> 0.147403).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 12 cost time: 0.9761474132537842
Epoch: 12, Steps: 64 | Train Loss: 0.0802160 Vali Loss: 0.1485911 Test Loss: 0.1335764
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 13 cost time: 0.9534142017364502
Epoch: 13, Steps: 64 | Train Loss: 0.0796146 Vali Loss: 0.1497115 Test Loss: 0.1347340
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 14 cost time: 0.9503879547119141
Epoch: 14, Steps: 64 | Train Loss: 0.0793078 Vali Loss: 0.1457490 Test Loss: 0.1345078
Validation loss decreased (0.147403 --> 0.145749).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 15 cost time: 0.9454271793365479
Epoch: 15, Steps: 64 | Train Loss: 0.0789802 Vali Loss: 0.1479395 Test Loss: 0.1357939
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 16 cost time: 0.9634280204772949
Epoch: 16, Steps: 64 | Train Loss: 0.0786644 Vali Loss: 0.1471775 Test Loss: 0.1338895
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 17 cost time: 0.9793863296508789
Epoch: 17, Steps: 64 | Train Loss: 0.0784657 Vali Loss: 0.1467085 Test Loss: 0.1347411
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 18 cost time: 0.9707422256469727
Epoch: 18, Steps: 64 | Train Loss: 0.0784388 Vali Loss: 0.1461603 Test Loss: 0.1348241
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 19 cost time: 0.9717795848846436
Epoch: 19, Steps: 64 | Train Loss: 0.0778410 Vali Loss: 0.1459830 Test Loss: 0.1342248
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 20 cost time: 0.9710004329681396
Epoch: 20, Steps: 64 | Train Loss: 0.0775376 Vali Loss: 0.1474009 Test Loss: 0.1349434
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 21 cost time: 0.949000358581543
Epoch: 21, Steps: 64 | Train Loss: 0.0775155 Vali Loss: 0.1471163 Test Loss: 0.1352020
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 22 cost time: 0.9250380992889404
Epoch: 22, Steps: 64 | Train Loss: 0.0777453 Vali Loss: 0.1469264 Test Loss: 0.1354778
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 23 cost time: 0.9273903369903564
Epoch: 23, Steps: 64 | Train Loss: 0.0766786 Vali Loss: 0.1443911 Test Loss: 0.1349363
Validation loss decreased (0.145749 --> 0.144391).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 24 cost time: 0.9664208889007568
Epoch: 24, Steps: 64 | Train Loss: 0.0771705 Vali Loss: 0.1470016 Test Loss: 0.1353952
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 25 cost time: 0.9614007472991943
Epoch: 25, Steps: 64 | Train Loss: 0.0772067 Vali Loss: 0.1466212 Test Loss: 0.1348837
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 26 cost time: 0.9614229202270508
Epoch: 26, Steps: 64 | Train Loss: 0.0771393 Vali Loss: 0.1441602 Test Loss: 0.1346818
Validation loss decreased (0.144391 --> 0.144160).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 27 cost time: 0.9534096717834473
Epoch: 27, Steps: 64 | Train Loss: 0.0769163 Vali Loss: 0.1450035 Test Loss: 0.1347328
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 28 cost time: 0.9404170513153076
Epoch: 28, Steps: 64 | Train Loss: 0.0768219 Vali Loss: 0.1448172 Test Loss: 0.1346394
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 29 cost time: 0.9097690582275391
Epoch: 29, Steps: 64 | Train Loss: 0.0767855 Vali Loss: 0.1449994 Test Loss: 0.1348888
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 30 cost time: 0.925452709197998
Epoch: 30, Steps: 64 | Train Loss: 0.0767162 Vali Loss: 0.1442835 Test Loss: 0.1352379
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 31 cost time: 0.9554011821746826
Epoch: 31, Steps: 64 | Train Loss: 0.0765770 Vali Loss: 0.1459194 Test Loss: 0.1348433
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 32 cost time: 0.9544806480407715
Epoch: 32, Steps: 64 | Train Loss: 0.0767662 Vali Loss: 0.1453259 Test Loss: 0.1344673
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 33 cost time: 0.9664323329925537
Epoch: 33, Steps: 64 | Train Loss: 0.0766694 Vali Loss: 0.1445939 Test Loss: 0.1344558
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 34 cost time: 0.9708900451660156
Epoch: 34, Steps: 64 | Train Loss: 0.0763118 Vali Loss: 0.1448452 Test Loss: 0.1350632
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 35 cost time: 0.9634058475494385
Epoch: 35, Steps: 64 | Train Loss: 0.0764228 Vali Loss: 0.1441146 Test Loss: 0.1348857
Validation loss decreased (0.144160 --> 0.144115).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 36 cost time: 0.9676961898803711
Epoch: 36, Steps: 64 | Train Loss: 0.0763712 Vali Loss: 0.1451659 Test Loss: 0.1348101
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 37 cost time: 0.9564344882965088
Epoch: 37, Steps: 64 | Train Loss: 0.0763905 Vali Loss: 0.1434416 Test Loss: 0.1349078
Validation loss decreased (0.144115 --> 0.143442).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 38 cost time: 0.949404239654541
Epoch: 38, Steps: 64 | Train Loss: 0.0762103 Vali Loss: 0.1431845 Test Loss: 0.1349899
Validation loss decreased (0.143442 --> 0.143184).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 39 cost time: 0.9487595558166504
Epoch: 39, Steps: 64 | Train Loss: 0.0762548 Vali Loss: 0.1448175 Test Loss: 0.1345895
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 40 cost time: 0.9538540840148926
Epoch: 40, Steps: 64 | Train Loss: 0.0760640 Vali Loss: 0.1451158 Test Loss: 0.1349717
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 41 cost time: 0.9670000076293945
Epoch: 41, Steps: 64 | Train Loss: 0.0765059 Vali Loss: 0.1439261 Test Loss: 0.1350753
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 42 cost time: 0.9610946178436279
Epoch: 42, Steps: 64 | Train Loss: 0.0761804 Vali Loss: 0.1441084 Test Loss: 0.1354138
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 43 cost time: 0.9666368961334229
Epoch: 43, Steps: 64 | Train Loss: 0.0760701 Vali Loss: 0.1443176 Test Loss: 0.1346606
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 44 cost time: 0.9455075263977051
Epoch: 44, Steps: 64 | Train Loss: 0.0761895 Vali Loss: 0.1451446 Test Loss: 0.1345783
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 45 cost time: 0.9264400005340576
Epoch: 45, Steps: 64 | Train Loss: 0.0763267 Vali Loss: 0.1443846 Test Loss: 0.1349896
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 46 cost time: 0.9301598072052002
Epoch: 46, Steps: 64 | Train Loss: 0.0763307 Vali Loss: 0.1449720 Test Loss: 0.1346962
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 47 cost time: 0.9444775581359863
Epoch: 47, Steps: 64 | Train Loss: 0.0763061 Vali Loss: 0.1442870 Test Loss: 0.1352620
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 48 cost time: 0.9354856014251709
Epoch: 48, Steps: 64 | Train Loss: 0.0758341 Vali Loss: 0.1456572 Test Loss: 0.1348291
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 49 cost time: 0.949815034866333
Epoch: 49, Steps: 64 | Train Loss: 0.0762809 Vali Loss: 0.1449647 Test Loss: 0.1344238
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 50 cost time: 0.9490008354187012
Epoch: 50, Steps: 64 | Train Loss: 0.0761225 Vali Loss: 0.1465246 Test Loss: 0.1347876
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 51 cost time: 0.9479985237121582
Epoch: 51, Steps: 64 | Train Loss: 0.0763463 Vali Loss: 0.1421637 Test Loss: 0.1346707
Validation loss decreased (0.143184 --> 0.142164).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 52 cost time: 0.9486081600189209
Epoch: 52, Steps: 64 | Train Loss: 0.0762230 Vali Loss: 0.1444167 Test Loss: 0.1348286
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 53 cost time: 0.926506757736206
Epoch: 53, Steps: 64 | Train Loss: 0.0760966 Vali Loss: 0.1434519 Test Loss: 0.1346503
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 54 cost time: 0.9483728408813477
Epoch: 54, Steps: 64 | Train Loss: 0.0759742 Vali Loss: 0.1452576 Test Loss: 0.1350536
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 55 cost time: 0.9543764591217041
Epoch: 55, Steps: 64 | Train Loss: 0.0760735 Vali Loss: 0.1428229 Test Loss: 0.1349836
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 56 cost time: 0.9483673572540283
Epoch: 56, Steps: 64 | Train Loss: 0.0761532 Vali Loss: 0.1439399 Test Loss: 0.1349246
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 57 cost time: 0.9683847427368164
Epoch: 57, Steps: 64 | Train Loss: 0.0761001 Vali Loss: 0.1453625 Test Loss: 0.1348742
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 58 cost time: 0.9628288745880127
Epoch: 58, Steps: 64 | Train Loss: 0.0761499 Vali Loss: 0.1443601 Test Loss: 0.1347564
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 59 cost time: 0.9683928489685059
Epoch: 59, Steps: 64 | Train Loss: 0.0761428 Vali Loss: 0.1441106 Test Loss: 0.1345896
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020883560180664062 GB
GPU已分配内存的峰值：0.06386137008666992 GB
Epoch: 60 cost time: 0.9638092517852783
Epoch: 60, Steps: 64 | Train Loss: 0.0760979 Vali Loss: 0.1445805 Test Loss: 0.1352098
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13467074930667877, mae:0.265271931886673, rse:0.19532489776611328
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054485321044921875 GB
Epoch: 1 cost time: 2.2697248458862305
Epoch: 1, Steps: 64 | Train Loss: 0.8916541 Vali Loss: 1.9923837 Test Loss: 3.7759547
Validation loss decreased (inf --> 1.992384).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 2 cost time: 0.8818302154541016
Epoch: 2, Steps: 64 | Train Loss: 0.5832051 Vali Loss: 0.7822284 Test Loss: 1.2517930
Validation loss decreased (1.992384 --> 0.782228).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 3 cost time: 0.9027276039123535
Epoch: 3, Steps: 64 | Train Loss: 0.3045168 Vali Loss: 0.5019207 Test Loss: 0.7116665
Validation loss decreased (0.782228 --> 0.501921).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 4 cost time: 0.8812341690063477
Epoch: 4, Steps: 64 | Train Loss: 0.1984036 Vali Loss: 0.3394503 Test Loss: 0.4115030
Validation loss decreased (0.501921 --> 0.339450).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 5 cost time: 0.8614852428436279
Epoch: 5, Steps: 64 | Train Loss: 0.1468046 Vali Loss: 0.2618671 Test Loss: 0.2804274
Validation loss decreased (0.339450 --> 0.261867).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 6 cost time: 0.8464641571044922
Epoch: 6, Steps: 64 | Train Loss: 0.1233456 Vali Loss: 0.2232795 Test Loss: 0.2167446
Validation loss decreased (0.261867 --> 0.223280).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 7 cost time: 0.8663721084594727
Epoch: 7, Steps: 64 | Train Loss: 0.1120312 Vali Loss: 0.2044936 Test Loss: 0.1874286
Validation loss decreased (0.223280 --> 0.204494).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 8 cost time: 0.8511419296264648
Epoch: 8, Steps: 64 | Train Loss: 0.1048278 Vali Loss: 0.1891548 Test Loss: 0.1663218
Validation loss decreased (0.204494 --> 0.189155).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 9 cost time: 0.8589997291564941
Epoch: 9, Steps: 64 | Train Loss: 0.1017426 Vali Loss: 0.1804680 Test Loss: 0.1614014
Validation loss decreased (0.189155 --> 0.180468).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 10 cost time: 0.8786506652832031
Epoch: 10, Steps: 64 | Train Loss: 0.0995452 Vali Loss: 0.1749552 Test Loss: 0.1540118
Validation loss decreased (0.180468 --> 0.174955).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 11 cost time: 0.8773388862609863
Epoch: 11, Steps: 64 | Train Loss: 0.0976542 Vali Loss: 0.1721497 Test Loss: 0.1519002
Validation loss decreased (0.174955 --> 0.172150).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 12 cost time: 0.8990867137908936
Epoch: 12, Steps: 64 | Train Loss: 0.0962163 Vali Loss: 0.1698870 Test Loss: 0.1493226
Validation loss decreased (0.172150 --> 0.169887).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 13 cost time: 0.9016335010528564
Epoch: 13, Steps: 64 | Train Loss: 0.0954715 Vali Loss: 0.1665603 Test Loss: 0.1481846
Validation loss decreased (0.169887 --> 0.166560).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 14 cost time: 0.8837532997131348
Epoch: 14, Steps: 64 | Train Loss: 0.0941819 Vali Loss: 0.1657640 Test Loss: 0.1465971
Validation loss decreased (0.166560 --> 0.165764).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 15 cost time: 0.8780021667480469
Epoch: 15, Steps: 64 | Train Loss: 0.0936582 Vali Loss: 0.1650275 Test Loss: 0.1450714
Validation loss decreased (0.165764 --> 0.165028).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 16 cost time: 0.8766379356384277
Epoch: 16, Steps: 64 | Train Loss: 0.0930296 Vali Loss: 0.1660523 Test Loss: 0.1449700
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 17 cost time: 0.87717604637146
Epoch: 17, Steps: 64 | Train Loss: 0.0921287 Vali Loss: 0.1640569 Test Loss: 0.1442427
Validation loss decreased (0.165028 --> 0.164057).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 18 cost time: 0.8920800685882568
Epoch: 18, Steps: 64 | Train Loss: 0.0918869 Vali Loss: 0.1614941 Test Loss: 0.1433087
Validation loss decreased (0.164057 --> 0.161494).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 19 cost time: 0.9004812240600586
Epoch: 19, Steps: 64 | Train Loss: 0.0916040 Vali Loss: 0.1605539 Test Loss: 0.1434928
Validation loss decreased (0.161494 --> 0.160554).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 20 cost time: 0.902918815612793
Epoch: 20, Steps: 64 | Train Loss: 0.0906460 Vali Loss: 0.1600720 Test Loss: 0.1436494
Validation loss decreased (0.160554 --> 0.160072).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 21 cost time: 0.9043622016906738
Epoch: 21, Steps: 64 | Train Loss: 0.0909904 Vali Loss: 0.1609558 Test Loss: 0.1430971
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 22 cost time: 0.8910012245178223
Epoch: 22, Steps: 64 | Train Loss: 0.0908875 Vali Loss: 0.1606396 Test Loss: 0.1425768
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 23 cost time: 0.8924000263214111
Epoch: 23, Steps: 64 | Train Loss: 0.0901271 Vali Loss: 0.1601520 Test Loss: 0.1423292
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 24 cost time: 0.8933665752410889
Epoch: 24, Steps: 64 | Train Loss: 0.0897861 Vali Loss: 0.1603011 Test Loss: 0.1426618
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 25 cost time: 0.8730695247650146
Epoch: 25, Steps: 64 | Train Loss: 0.0894596 Vali Loss: 0.1607244 Test Loss: 0.1419474
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 26 cost time: 0.8577578067779541
Epoch: 26, Steps: 64 | Train Loss: 0.0888567 Vali Loss: 0.1587240 Test Loss: 0.1424579
Validation loss decreased (0.160072 --> 0.158724).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 27 cost time: 0.8729996681213379
Epoch: 27, Steps: 64 | Train Loss: 0.0892799 Vali Loss: 0.1588583 Test Loss: 0.1419852
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 28 cost time: 0.8826284408569336
Epoch: 28, Steps: 64 | Train Loss: 0.0893474 Vali Loss: 0.1594484 Test Loss: 0.1417360
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 29 cost time: 0.8763782978057861
Epoch: 29, Steps: 64 | Train Loss: 0.0894042 Vali Loss: 0.1589382 Test Loss: 0.1420020
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 30 cost time: 0.8994367122650146
Epoch: 30, Steps: 64 | Train Loss: 0.0890896 Vali Loss: 0.1604385 Test Loss: 0.1416834
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 31 cost time: 0.8933939933776855
Epoch: 31, Steps: 64 | Train Loss: 0.0889417 Vali Loss: 0.1594515 Test Loss: 0.1419825
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 32 cost time: 0.8804152011871338
Epoch: 32, Steps: 64 | Train Loss: 0.0887113 Vali Loss: 0.1595763 Test Loss: 0.1419203
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 33 cost time: 0.8696467876434326
Epoch: 33, Steps: 64 | Train Loss: 0.0888723 Vali Loss: 0.1588649 Test Loss: 0.1417298
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 34 cost time: 0.8674023151397705
Epoch: 34, Steps: 64 | Train Loss: 0.0885733 Vali Loss: 0.1589244 Test Loss: 0.1413233
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 35 cost time: 0.8813762664794922
Epoch: 35, Steps: 64 | Train Loss: 0.0882738 Vali Loss: 0.1577424 Test Loss: 0.1415971
Validation loss decreased (0.158724 --> 0.157742).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 36 cost time: 0.9004006385803223
Epoch: 36, Steps: 64 | Train Loss: 0.0884456 Vali Loss: 0.1601886 Test Loss: 0.1409405
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 37 cost time: 0.8993699550628662
Epoch: 37, Steps: 64 | Train Loss: 0.0883822 Vali Loss: 0.1577786 Test Loss: 0.1411919
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 38 cost time: 0.9043803215026855
Epoch: 38, Steps: 64 | Train Loss: 0.0885470 Vali Loss: 0.1577302 Test Loss: 0.1410638
Validation loss decreased (0.157742 --> 0.157730).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 39 cost time: 0.9023776054382324
Epoch: 39, Steps: 64 | Train Loss: 0.0885940 Vali Loss: 0.1579385 Test Loss: 0.1412576
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 40 cost time: 0.8779990673065186
Epoch: 40, Steps: 64 | Train Loss: 0.0880049 Vali Loss: 0.1591730 Test Loss: 0.1413893
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 41 cost time: 0.8776426315307617
Epoch: 41, Steps: 64 | Train Loss: 0.0881618 Vali Loss: 0.1574070 Test Loss: 0.1413710
Validation loss decreased (0.157730 --> 0.157407).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 42 cost time: 0.8794641494750977
Epoch: 42, Steps: 64 | Train Loss: 0.0878706 Vali Loss: 0.1586812 Test Loss: 0.1411607
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 43 cost time: 0.8774440288543701
Epoch: 43, Steps: 64 | Train Loss: 0.0883205 Vali Loss: 0.1574606 Test Loss: 0.1412216
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 44 cost time: 0.8844037055969238
Epoch: 44, Steps: 64 | Train Loss: 0.0880145 Vali Loss: 0.1590997 Test Loss: 0.1411723
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 45 cost time: 0.8906898498535156
Epoch: 45, Steps: 64 | Train Loss: 0.0880865 Vali Loss: 0.1577103 Test Loss: 0.1409593
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 46 cost time: 0.9010019302368164
Epoch: 46, Steps: 64 | Train Loss: 0.0877019 Vali Loss: 0.1588040 Test Loss: 0.1410532
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 47 cost time: 0.8783824443817139
Epoch: 47, Steps: 64 | Train Loss: 0.0879237 Vali Loss: 0.1572876 Test Loss: 0.1411264
Validation loss decreased (0.157407 --> 0.157288).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 48 cost time: 0.8744277954101562
Epoch: 48, Steps: 64 | Train Loss: 0.0878072 Vali Loss: 0.1583041 Test Loss: 0.1406295
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 49 cost time: 0.858367919921875
Epoch: 49, Steps: 64 | Train Loss: 0.0878026 Vali Loss: 0.1574026 Test Loss: 0.1410324
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 50 cost time: 0.8653841018676758
Epoch: 50, Steps: 64 | Train Loss: 0.0878164 Vali Loss: 0.1577529 Test Loss: 0.1414031
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 51 cost time: 0.8639984130859375
Epoch: 51, Steps: 64 | Train Loss: 0.0875749 Vali Loss: 0.1587603 Test Loss: 0.1409613
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 52 cost time: 0.8654003143310547
Epoch: 52, Steps: 64 | Train Loss: 0.0877885 Vali Loss: 0.1590072 Test Loss: 0.1412063
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 53 cost time: 0.8823881149291992
Epoch: 53, Steps: 64 | Train Loss: 0.0872977 Vali Loss: 0.1569074 Test Loss: 0.1416214
Validation loss decreased (0.157288 --> 0.156907).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 54 cost time: 0.8983769416809082
Epoch: 54, Steps: 64 | Train Loss: 0.0875016 Vali Loss: 0.1563618 Test Loss: 0.1407516
Validation loss decreased (0.156907 --> 0.156362).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 55 cost time: 0.892432689666748
Epoch: 55, Steps: 64 | Train Loss: 0.0876725 Vali Loss: 0.1561934 Test Loss: 0.1406020
Validation loss decreased (0.156362 --> 0.156193).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 56 cost time: 0.898918628692627
Epoch: 56, Steps: 64 | Train Loss: 0.0880553 Vali Loss: 0.1556966 Test Loss: 0.1411280
Validation loss decreased (0.156193 --> 0.155697).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 57 cost time: 0.8987312316894531
Epoch: 57, Steps: 64 | Train Loss: 0.0876099 Vali Loss: 0.1565730 Test Loss: 0.1409860
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 58 cost time: 0.8780004978179932
Epoch: 58, Steps: 64 | Train Loss: 0.0875467 Vali Loss: 0.1565353 Test Loss: 0.1408872
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 59 cost time: 0.8766341209411621
Epoch: 59, Steps: 64 | Train Loss: 0.0879015 Vali Loss: 0.1570597 Test Loss: 0.1406540
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01795196533203125 GB
GPU已分配内存的峰值：0.054863929748535156 GB
Epoch: 60 cost time: 0.8753366470336914
Epoch: 60, Steps: 64 | Train Loss: 0.0880258 Vali Loss: 0.1580761 Test Loss: 0.1407594
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14112798869609833, mae:0.2733435034751892, rse:0.19995282590389252
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.058879852294921875 GB
Epoch: 1 cost time: 2.3235249519348145
Epoch: 1, Steps: 64 | Train Loss: 0.8404014 Vali Loss: 1.8789800 Test Loss: 3.6270969
Validation loss decreased (inf --> 1.878980).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 2 cost time: 0.9426424503326416
Epoch: 2, Steps: 64 | Train Loss: 0.3659061 Vali Loss: 0.1950594 Test Loss: 0.1587317
Validation loss decreased (1.878980 --> 0.195059).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 3 cost time: 0.9286224842071533
Epoch: 3, Steps: 64 | Train Loss: 0.1033817 Vali Loss: 0.1718323 Test Loss: 0.1495470
Validation loss decreased (0.195059 --> 0.171832).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 4 cost time: 0.9184412956237793
Epoch: 4, Steps: 64 | Train Loss: 0.0927815 Vali Loss: 0.1652447 Test Loss: 0.1404624
Validation loss decreased (0.171832 --> 0.165245).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 5 cost time: 0.8955087661743164
Epoch: 5, Steps: 64 | Train Loss: 0.0886980 Vali Loss: 0.1587138 Test Loss: 0.1392734
Validation loss decreased (0.165245 --> 0.158714).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 6 cost time: 0.922762393951416
Epoch: 6, Steps: 64 | Train Loss: 0.0863701 Vali Loss: 0.1566487 Test Loss: 0.1355494
Validation loss decreased (0.158714 --> 0.156649).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 7 cost time: 0.9034290313720703
Epoch: 7, Steps: 64 | Train Loss: 0.0850230 Vali Loss: 0.1540915 Test Loss: 0.1361720
Validation loss decreased (0.156649 --> 0.154091).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 8 cost time: 0.8940012454986572
Epoch: 8, Steps: 64 | Train Loss: 0.0834388 Vali Loss: 0.1508790 Test Loss: 0.1363601
Validation loss decreased (0.154091 --> 0.150879).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 9 cost time: 0.9176406860351562
Epoch: 9, Steps: 64 | Train Loss: 0.0828092 Vali Loss: 0.1502862 Test Loss: 0.1349176
Validation loss decreased (0.150879 --> 0.150286).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 10 cost time: 0.9232971668243408
Epoch: 10, Steps: 64 | Train Loss: 0.0821472 Vali Loss: 0.1488424 Test Loss: 0.1358046
Validation loss decreased (0.150286 --> 0.148842).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 11 cost time: 0.9174714088439941
Epoch: 11, Steps: 64 | Train Loss: 0.0812671 Vali Loss: 0.1502668 Test Loss: 0.1350998
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 12 cost time: 0.9393856525421143
Epoch: 12, Steps: 64 | Train Loss: 0.0806080 Vali Loss: 0.1498515 Test Loss: 0.1359095
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 13 cost time: 0.935417890548706
Epoch: 13, Steps: 64 | Train Loss: 0.0799592 Vali Loss: 0.1486349 Test Loss: 0.1357646
Validation loss decreased (0.148842 --> 0.148635).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 14 cost time: 0.9237916469573975
Epoch: 14, Steps: 64 | Train Loss: 0.0793035 Vali Loss: 0.1483945 Test Loss: 0.1357648
Validation loss decreased (0.148635 --> 0.148395).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 15 cost time: 0.9191348552703857
Epoch: 15, Steps: 64 | Train Loss: 0.0790311 Vali Loss: 0.1466292 Test Loss: 0.1354233
Validation loss decreased (0.148395 --> 0.146629).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 16 cost time: 0.918999195098877
Epoch: 16, Steps: 64 | Train Loss: 0.0786892 Vali Loss: 0.1478929 Test Loss: 0.1352640
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 17 cost time: 0.9412333965301514
Epoch: 17, Steps: 64 | Train Loss: 0.0783689 Vali Loss: 0.1447050 Test Loss: 0.1351890
Validation loss decreased (0.146629 --> 0.144705).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 18 cost time: 0.9402484893798828
Epoch: 18, Steps: 64 | Train Loss: 0.0779919 Vali Loss: 0.1436950 Test Loss: 0.1342348
Validation loss decreased (0.144705 --> 0.143695).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 19 cost time: 0.9323992729187012
Epoch: 19, Steps: 64 | Train Loss: 0.0779240 Vali Loss: 0.1440900 Test Loss: 0.1344285
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 20 cost time: 0.9323849678039551
Epoch: 20, Steps: 64 | Train Loss: 0.0772825 Vali Loss: 0.1451550 Test Loss: 0.1352319
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 21 cost time: 0.9255030155181885
Epoch: 21, Steps: 64 | Train Loss: 0.0777248 Vali Loss: 0.1449476 Test Loss: 0.1351342
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 22 cost time: 0.9124422073364258
Epoch: 22, Steps: 64 | Train Loss: 0.0772499 Vali Loss: 0.1438458 Test Loss: 0.1345426
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 23 cost time: 0.9004638195037842
Epoch: 23, Steps: 64 | Train Loss: 0.0768058 Vali Loss: 0.1438028 Test Loss: 0.1346541
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 24 cost time: 0.9120004177093506
Epoch: 24, Steps: 64 | Train Loss: 0.0769613 Vali Loss: 0.1428333 Test Loss: 0.1341783
Validation loss decreased (0.143695 --> 0.142833).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 25 cost time: 0.9306581020355225
Epoch: 25, Steps: 64 | Train Loss: 0.0764224 Vali Loss: 0.1422951 Test Loss: 0.1338610
Validation loss decreased (0.142833 --> 0.142295).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 26 cost time: 0.9316458702087402
Epoch: 26, Steps: 64 | Train Loss: 0.0764151 Vali Loss: 0.1416260 Test Loss: 0.1343615
Validation loss decreased (0.142295 --> 0.141626).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 27 cost time: 0.9464075565338135
Epoch: 27, Steps: 64 | Train Loss: 0.0764709 Vali Loss: 0.1420355 Test Loss: 0.1337675
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 28 cost time: 0.9154298305511475
Epoch: 28, Steps: 64 | Train Loss: 0.0767568 Vali Loss: 0.1427446 Test Loss: 0.1341137
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 29 cost time: 0.9204070568084717
Epoch: 29, Steps: 64 | Train Loss: 0.0761737 Vali Loss: 0.1418090 Test Loss: 0.1346180
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 30 cost time: 0.8999602794647217
Epoch: 30, Steps: 64 | Train Loss: 0.0764087 Vali Loss: 0.1412839 Test Loss: 0.1336608
Validation loss decreased (0.141626 --> 0.141284).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 31 cost time: 0.9074363708496094
Epoch: 31, Steps: 64 | Train Loss: 0.0762598 Vali Loss: 0.1403425 Test Loss: 0.1339506
Validation loss decreased (0.141284 --> 0.140343).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 32 cost time: 0.8940005302429199
Epoch: 32, Steps: 64 | Train Loss: 0.0762354 Vali Loss: 0.1427589 Test Loss: 0.1342787
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 33 cost time: 0.9066388607025146
Epoch: 33, Steps: 64 | Train Loss: 0.0760307 Vali Loss: 0.1425333 Test Loss: 0.1344936
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 34 cost time: 0.9483873844146729
Epoch: 34, Steps: 64 | Train Loss: 0.0763595 Vali Loss: 0.1412340 Test Loss: 0.1340258
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 35 cost time: 0.9366545677185059
Epoch: 35, Steps: 64 | Train Loss: 0.0758042 Vali Loss: 0.1420066 Test Loss: 0.1346100
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 36 cost time: 0.9364595413208008
Epoch: 36, Steps: 64 | Train Loss: 0.0761614 Vali Loss: 0.1414261 Test Loss: 0.1338754
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 37 cost time: 0.9474546909332275
Epoch: 37, Steps: 64 | Train Loss: 0.0757996 Vali Loss: 0.1401923 Test Loss: 0.1339291
Validation loss decreased (0.140343 --> 0.140192).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 38 cost time: 0.9284517765045166
Epoch: 38, Steps: 64 | Train Loss: 0.0757097 Vali Loss: 0.1416544 Test Loss: 0.1340623
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 39 cost time: 0.9207653999328613
Epoch: 39, Steps: 64 | Train Loss: 0.0757203 Vali Loss: 0.1417384 Test Loss: 0.1342559
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 40 cost time: 0.9133725166320801
Epoch: 40, Steps: 64 | Train Loss: 0.0760875 Vali Loss: 0.1414424 Test Loss: 0.1344325
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 41 cost time: 0.9106318950653076
Epoch: 41, Steps: 64 | Train Loss: 0.0761994 Vali Loss: 0.1408446 Test Loss: 0.1341385
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 42 cost time: 0.9373471736907959
Epoch: 42, Steps: 64 | Train Loss: 0.0756413 Vali Loss: 0.1405526 Test Loss: 0.1339509
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 43 cost time: 0.9423367977142334
Epoch: 43, Steps: 64 | Train Loss: 0.0755531 Vali Loss: 0.1428150 Test Loss: 0.1341378
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 44 cost time: 0.9254240989685059
Epoch: 44, Steps: 64 | Train Loss: 0.0754080 Vali Loss: 0.1422912 Test Loss: 0.1340405
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 45 cost time: 0.916424036026001
Epoch: 45, Steps: 64 | Train Loss: 0.0756993 Vali Loss: 0.1407152 Test Loss: 0.1340032
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 46 cost time: 0.9044041633605957
Epoch: 46, Steps: 64 | Train Loss: 0.0757810 Vali Loss: 0.1400642 Test Loss: 0.1336498
Validation loss decreased (0.140192 --> 0.140064).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 47 cost time: 0.9077849388122559
Epoch: 47, Steps: 64 | Train Loss: 0.0757788 Vali Loss: 0.1436785 Test Loss: 0.1351517
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 48 cost time: 0.9167428016662598
Epoch: 48, Steps: 64 | Train Loss: 0.0758393 Vali Loss: 0.1393796 Test Loss: 0.1340961
Validation loss decreased (0.140064 --> 0.139380).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 49 cost time: 0.9086577892303467
Epoch: 49, Steps: 64 | Train Loss: 0.0754939 Vali Loss: 0.1410030 Test Loss: 0.1340601
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 50 cost time: 0.9154596328735352
Epoch: 50, Steps: 64 | Train Loss: 0.0757210 Vali Loss: 0.1414003 Test Loss: 0.1339770
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 51 cost time: 0.9174928665161133
Epoch: 51, Steps: 64 | Train Loss: 0.0755736 Vali Loss: 0.1422141 Test Loss: 0.1348053
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 52 cost time: 0.9090702533721924
Epoch: 52, Steps: 64 | Train Loss: 0.0761403 Vali Loss: 0.1404469 Test Loss: 0.1339545
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 53 cost time: 0.918877363204956
Epoch: 53, Steps: 64 | Train Loss: 0.0756333 Vali Loss: 0.1407369 Test Loss: 0.1337086
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 54 cost time: 0.9047548770904541
Epoch: 54, Steps: 64 | Train Loss: 0.0755804 Vali Loss: 0.1392560 Test Loss: 0.1334814
Validation loss decreased (0.139380 --> 0.139256).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 55 cost time: 0.9227294921875
Epoch: 55, Steps: 64 | Train Loss: 0.0756249 Vali Loss: 0.1417664 Test Loss: 0.1338749
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 56 cost time: 0.923717737197876
Epoch: 56, Steps: 64 | Train Loss: 0.0757092 Vali Loss: 0.1419210 Test Loss: 0.1339903
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 57 cost time: 0.9202728271484375
Epoch: 57, Steps: 64 | Train Loss: 0.0757429 Vali Loss: 0.1401007 Test Loss: 0.1338280
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 58 cost time: 0.9373981952667236
Epoch: 58, Steps: 64 | Train Loss: 0.0755694 Vali Loss: 0.1407685 Test Loss: 0.1339613
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 59 cost time: 0.9430956840515137
Epoch: 59, Steps: 64 | Train Loss: 0.0753732 Vali Loss: 0.1412418 Test Loss: 0.1339251
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01990509033203125 GB
GPU已分配内存的峰值：0.060235023498535156 GB
Epoch: 60 cost time: 0.9433934688568115
Epoch: 60, Steps: 64 | Train Loss: 0.0755196 Vali Loss: 0.1413896 Test Loss: 0.1341598
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13348139822483063, mae:0.2640022337436676, rse:0.19446048140525818
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.062178611755371094 GB
Epoch: 1 cost time: 2.3463828563690186
Epoch: 1, Steps: 64 | Train Loss: 0.7469784 Vali Loss: 1.7162666 Test Loss: 3.2789648
Validation loss decreased (inf --> 1.716267).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 2 cost time: 0.9694986343383789
Epoch: 2, Steps: 64 | Train Loss: 0.2986114 Vali Loss: 0.2155007 Test Loss: 0.2462060
Validation loss decreased (1.716267 --> 0.215501).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 3 cost time: 0.9684450626373291
Epoch: 3, Steps: 64 | Train Loss: 0.0989587 Vali Loss: 0.1685487 Test Loss: 0.1426929
Validation loss decreased (0.215501 --> 0.168549).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 4 cost time: 0.9683372974395752
Epoch: 4, Steps: 64 | Train Loss: 0.0890363 Vali Loss: 0.1636656 Test Loss: 0.1412159
Validation loss decreased (0.168549 --> 0.163666).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 5 cost time: 0.9304699897766113
Epoch: 5, Steps: 64 | Train Loss: 0.0863506 Vali Loss: 0.1595411 Test Loss: 0.1401355
Validation loss decreased (0.163666 --> 0.159541).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 6 cost time: 0.9290647506713867
Epoch: 6, Steps: 64 | Train Loss: 0.0843139 Vali Loss: 0.1593142 Test Loss: 0.1384017
Validation loss decreased (0.159541 --> 0.159314).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 7 cost time: 0.9337632656097412
Epoch: 7, Steps: 64 | Train Loss: 0.0833595 Vali Loss: 0.1575126 Test Loss: 0.1368109
Validation loss decreased (0.159314 --> 0.157513).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 8 cost time: 0.9389984607696533
Epoch: 8, Steps: 64 | Train Loss: 0.0828496 Vali Loss: 0.1558679 Test Loss: 0.1364307
Validation loss decreased (0.157513 --> 0.155868).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 9 cost time: 0.9577314853668213
Epoch: 9, Steps: 64 | Train Loss: 0.0821370 Vali Loss: 0.1553171 Test Loss: 0.1366507
Validation loss decreased (0.155868 --> 0.155317).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 10 cost time: 0.9572672843933105
Epoch: 10, Steps: 64 | Train Loss: 0.0815036 Vali Loss: 0.1539727 Test Loss: 0.1365561
Validation loss decreased (0.155317 --> 0.153973).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 11 cost time: 0.9656467437744141
Epoch: 11, Steps: 64 | Train Loss: 0.0809968 Vali Loss: 0.1520689 Test Loss: 0.1356325
Validation loss decreased (0.153973 --> 0.152069).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 12 cost time: 0.9673812389373779
Epoch: 12, Steps: 64 | Train Loss: 0.0806938 Vali Loss: 0.1561895 Test Loss: 0.1364459
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 13 cost time: 0.9443798065185547
Epoch: 13, Steps: 64 | Train Loss: 0.0807318 Vali Loss: 0.1512853 Test Loss: 0.1348329
Validation loss decreased (0.152069 --> 0.151285).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 14 cost time: 0.9489822387695312
Epoch: 14, Steps: 64 | Train Loss: 0.0797531 Vali Loss: 0.1531076 Test Loss: 0.1361802
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 15 cost time: 0.9564948081970215
Epoch: 15, Steps: 64 | Train Loss: 0.0796867 Vali Loss: 0.1519610 Test Loss: 0.1353416
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 16 cost time: 0.9443714618682861
Epoch: 16, Steps: 64 | Train Loss: 0.0794856 Vali Loss: 0.1504896 Test Loss: 0.1354342
Validation loss decreased (0.151285 --> 0.150490).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 17 cost time: 0.9704601764678955
Epoch: 17, Steps: 64 | Train Loss: 0.0792313 Vali Loss: 0.1507550 Test Loss: 0.1351150
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 18 cost time: 0.9701533317565918
Epoch: 18, Steps: 64 | Train Loss: 0.0788634 Vali Loss: 0.1492596 Test Loss: 0.1347297
Validation loss decreased (0.150490 --> 0.149260).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 19 cost time: 0.9647250175476074
Epoch: 19, Steps: 64 | Train Loss: 0.0788373 Vali Loss: 0.1517930 Test Loss: 0.1354618
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 20 cost time: 0.9739997386932373
Epoch: 20, Steps: 64 | Train Loss: 0.0784996 Vali Loss: 0.1504106 Test Loss: 0.1348891
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 21 cost time: 0.9560010433197021
Epoch: 21, Steps: 64 | Train Loss: 0.0785774 Vali Loss: 0.1499897 Test Loss: 0.1339654
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 22 cost time: 0.9362618923187256
Epoch: 22, Steps: 64 | Train Loss: 0.0781260 Vali Loss: 0.1496496 Test Loss: 0.1351741
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 23 cost time: 0.9315023422241211
Epoch: 23, Steps: 64 | Train Loss: 0.0784701 Vali Loss: 0.1494223 Test Loss: 0.1347811
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 24 cost time: 0.9403426647186279
Epoch: 24, Steps: 64 | Train Loss: 0.0781313 Vali Loss: 0.1492876 Test Loss: 0.1351834
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 25 cost time: 0.9554815292358398
Epoch: 25, Steps: 64 | Train Loss: 0.0778152 Vali Loss: 0.1486132 Test Loss: 0.1343631
Validation loss decreased (0.149260 --> 0.148613).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 26 cost time: 0.9543635845184326
Epoch: 26, Steps: 64 | Train Loss: 0.0776832 Vali Loss: 0.1500885 Test Loss: 0.1355965
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 27 cost time: 0.9554111957550049
Epoch: 27, Steps: 64 | Train Loss: 0.0778490 Vali Loss: 0.1497594 Test Loss: 0.1345445
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 28 cost time: 0.9467058181762695
Epoch: 28, Steps: 64 | Train Loss: 0.0778626 Vali Loss: 0.1488269 Test Loss: 0.1346311
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 29 cost time: 0.9287950992584229
Epoch: 29, Steps: 64 | Train Loss: 0.0780535 Vali Loss: 0.1504677 Test Loss: 0.1350777
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 30 cost time: 0.9353563785552979
Epoch: 30, Steps: 64 | Train Loss: 0.0778356 Vali Loss: 0.1497862 Test Loss: 0.1348608
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 31 cost time: 0.9440000057220459
Epoch: 31, Steps: 64 | Train Loss: 0.0774913 Vali Loss: 0.1493369 Test Loss: 0.1347877
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 32 cost time: 0.9466419219970703
Epoch: 32, Steps: 64 | Train Loss: 0.0774443 Vali Loss: 0.1490570 Test Loss: 0.1347506
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 33 cost time: 0.9734199047088623
Epoch: 33, Steps: 64 | Train Loss: 0.0777065 Vali Loss: 0.1493361 Test Loss: 0.1347561
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 34 cost time: 0.9710001945495605
Epoch: 34, Steps: 64 | Train Loss: 0.0774457 Vali Loss: 0.1480326 Test Loss: 0.1346617
Validation loss decreased (0.148613 --> 0.148033).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 35 cost time: 0.9723403453826904
Epoch: 35, Steps: 64 | Train Loss: 0.0776823 Vali Loss: 0.1503099 Test Loss: 0.1345795
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 36 cost time: 0.9583966732025146
Epoch: 36, Steps: 64 | Train Loss: 0.0774699 Vali Loss: 0.1485649 Test Loss: 0.1346155
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 37 cost time: 0.9443545341491699
Epoch: 37, Steps: 64 | Train Loss: 0.0776601 Vali Loss: 0.1478826 Test Loss: 0.1344823
Validation loss decreased (0.148033 --> 0.147883).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 38 cost time: 0.9474022388458252
Epoch: 38, Steps: 64 | Train Loss: 0.0768353 Vali Loss: 0.1485517 Test Loss: 0.1346493
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 39 cost time: 0.9443130493164062
Epoch: 39, Steps: 64 | Train Loss: 0.0774102 Vali Loss: 0.1492857 Test Loss: 0.1346534
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 40 cost time: 0.9577071666717529
Epoch: 40, Steps: 64 | Train Loss: 0.0772351 Vali Loss: 0.1497395 Test Loss: 0.1348273
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 41 cost time: 0.9721531867980957
Epoch: 41, Steps: 64 | Train Loss: 0.0777530 Vali Loss: 0.1462777 Test Loss: 0.1343864
Validation loss decreased (0.147883 --> 0.146278).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 42 cost time: 0.9749948978424072
Epoch: 42, Steps: 64 | Train Loss: 0.0775556 Vali Loss: 0.1483265 Test Loss: 0.1345702
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 43 cost time: 0.9546399116516113
Epoch: 43, Steps: 64 | Train Loss: 0.0771311 Vali Loss: 0.1496895 Test Loss: 0.1345529
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 44 cost time: 0.946641206741333
Epoch: 44, Steps: 64 | Train Loss: 0.0773890 Vali Loss: 0.1484086 Test Loss: 0.1346077
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 45 cost time: 0.9433193206787109
Epoch: 45, Steps: 64 | Train Loss: 0.0769627 Vali Loss: 0.1498137 Test Loss: 0.1345857
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 46 cost time: 0.9358537197113037
Epoch: 46, Steps: 64 | Train Loss: 0.0775864 Vali Loss: 0.1473517 Test Loss: 0.1349304
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 47 cost time: 0.9323742389678955
Epoch: 47, Steps: 64 | Train Loss: 0.0773318 Vali Loss: 0.1488884 Test Loss: 0.1346432
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 48 cost time: 0.9463827610015869
Epoch: 48, Steps: 64 | Train Loss: 0.0773689 Vali Loss: 0.1480491 Test Loss: 0.1345742
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 49 cost time: 0.9524314403533936
Epoch: 49, Steps: 64 | Train Loss: 0.0770942 Vali Loss: 0.1486822 Test Loss: 0.1345113
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 50 cost time: 0.9523711204528809
Epoch: 50, Steps: 64 | Train Loss: 0.0771370 Vali Loss: 0.1482894 Test Loss: 0.1343958
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 51 cost time: 0.9539997577667236
Epoch: 51, Steps: 64 | Train Loss: 0.0770056 Vali Loss: 0.1492958 Test Loss: 0.1345536
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 52 cost time: 0.9369997978210449
Epoch: 52, Steps: 64 | Train Loss: 0.0773719 Vali Loss: 0.1473841 Test Loss: 0.1343594
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 53 cost time: 0.9366412162780762
Epoch: 53, Steps: 64 | Train Loss: 0.0771326 Vali Loss: 0.1488593 Test Loss: 0.1347445
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 54 cost time: 0.943213939666748
Epoch: 54, Steps: 64 | Train Loss: 0.0772795 Vali Loss: 0.1498406 Test Loss: 0.1346814
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 55 cost time: 0.9594957828521729
Epoch: 55, Steps: 64 | Train Loss: 0.0772441 Vali Loss: 0.1488789 Test Loss: 0.1346585
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 56 cost time: 0.9644310474395752
Epoch: 56, Steps: 64 | Train Loss: 0.0773932 Vali Loss: 0.1492357 Test Loss: 0.1346958
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 57 cost time: 0.9614474773406982
Epoch: 57, Steps: 64 | Train Loss: 0.0772668 Vali Loss: 0.1490834 Test Loss: 0.1343463
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 58 cost time: 0.9742248058319092
Epoch: 58, Steps: 64 | Train Loss: 0.0773497 Vali Loss: 0.1502865 Test Loss: 0.1346301
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 59 cost time: 0.9714517593383789
Epoch: 59, Steps: 64 | Train Loss: 0.0768772 Vali Loss: 0.1497970 Test Loss: 0.1344704
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0208892822265625 GB
GPU已分配内存的峰值：0.06402587890625 GB
Epoch: 60 cost time: 0.9627969264984131
Epoch: 60, Steps: 64 | Train Loss: 0.0774812 Vali Loss: 0.1487668 Test Loss: 0.1347641
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13438640534877777, mae:0.26641446352005005, rse:0.19511859118938446
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.05464744567871094 GB
Epoch: 1 cost time: 2.3011586666107178
Epoch: 1, Steps: 64 | Train Loss: 0.8856418 Vali Loss: 1.9046789 Test Loss: 3.7690754
Validation loss decreased (inf --> 1.904679).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 2 cost time: 0.9104642868041992
Epoch: 2, Steps: 64 | Train Loss: 0.6011922 Vali Loss: 0.8032199 Test Loss: 1.4018924
Validation loss decreased (1.904679 --> 0.803220).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 3 cost time: 0.911334753036499
Epoch: 3, Steps: 64 | Train Loss: 0.3297736 Vali Loss: 0.5155985 Test Loss: 0.7869394
Validation loss decreased (0.803220 --> 0.515598).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 4 cost time: 0.9089992046356201
Epoch: 4, Steps: 64 | Train Loss: 0.2131151 Vali Loss: 0.3516925 Test Loss: 0.4624093
Validation loss decreased (0.515598 --> 0.351692).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 5 cost time: 0.8766233921051025
Epoch: 5, Steps: 64 | Train Loss: 0.1525010 Vali Loss: 0.2671767 Test Loss: 0.3084070
Validation loss decreased (0.351692 --> 0.267177).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 6 cost time: 0.8694069385528564
Epoch: 6, Steps: 64 | Train Loss: 0.1252381 Vali Loss: 0.2250803 Test Loss: 0.2337886
Validation loss decreased (0.267177 --> 0.225080).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 7 cost time: 0.885784387588501
Epoch: 7, Steps: 64 | Train Loss: 0.1123150 Vali Loss: 0.1971546 Test Loss: 0.1927987
Validation loss decreased (0.225080 --> 0.197155).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 8 cost time: 0.8695704936981201
Epoch: 8, Steps: 64 | Train Loss: 0.1037953 Vali Loss: 0.1831532 Test Loss: 0.1713362
Validation loss decreased (0.197155 --> 0.183153).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 9 cost time: 0.8887591361999512
Epoch: 9, Steps: 64 | Train Loss: 0.1005768 Vali Loss: 0.1745781 Test Loss: 0.1610931
Validation loss decreased (0.183153 --> 0.174578).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 10 cost time: 0.8967242240905762
Epoch: 10, Steps: 64 | Train Loss: 0.0980221 Vali Loss: 0.1697148 Test Loss: 0.1548764
Validation loss decreased (0.174578 --> 0.169715).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 11 cost time: 0.8969993591308594
Epoch: 11, Steps: 64 | Train Loss: 0.0963692 Vali Loss: 0.1663677 Test Loss: 0.1517919
Validation loss decreased (0.169715 --> 0.166368).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 12 cost time: 0.9096264839172363
Epoch: 12, Steps: 64 | Train Loss: 0.0942867 Vali Loss: 0.1646700 Test Loss: 0.1491455
Validation loss decreased (0.166368 --> 0.164670).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 13 cost time: 0.9096453189849854
Epoch: 13, Steps: 64 | Train Loss: 0.0941007 Vali Loss: 0.1617121 Test Loss: 0.1466210
Validation loss decreased (0.164670 --> 0.161712).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 14 cost time: 0.8874778747558594
Epoch: 14, Steps: 64 | Train Loss: 0.0925412 Vali Loss: 0.1615373 Test Loss: 0.1460732
Validation loss decreased (0.161712 --> 0.161537).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 15 cost time: 0.8524131774902344
Epoch: 15, Steps: 64 | Train Loss: 0.0920099 Vali Loss: 0.1600196 Test Loss: 0.1454546
Validation loss decreased (0.161537 --> 0.160020).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 16 cost time: 0.884131669998169
Epoch: 16, Steps: 64 | Train Loss: 0.0911927 Vali Loss: 0.1564596 Test Loss: 0.1442350
Validation loss decreased (0.160020 --> 0.156460).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 17 cost time: 0.8810014724731445
Epoch: 17, Steps: 64 | Train Loss: 0.0905795 Vali Loss: 0.1581282 Test Loss: 0.1435651
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 18 cost time: 0.9086380004882812
Epoch: 18, Steps: 64 | Train Loss: 0.0898787 Vali Loss: 0.1584990 Test Loss: 0.1435070
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 19 cost time: 0.9134564399719238
Epoch: 19, Steps: 64 | Train Loss: 0.0898181 Vali Loss: 0.1578232 Test Loss: 0.1429704
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 20 cost time: 0.8990480899810791
Epoch: 20, Steps: 64 | Train Loss: 0.0891868 Vali Loss: 0.1570624 Test Loss: 0.1429163
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 21 cost time: 0.9113991260528564
Epoch: 21, Steps: 64 | Train Loss: 0.0893995 Vali Loss: 0.1552642 Test Loss: 0.1422554
Validation loss decreased (0.156460 --> 0.155264).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 22 cost time: 0.9024250507354736
Epoch: 22, Steps: 64 | Train Loss: 0.0892136 Vali Loss: 0.1562281 Test Loss: 0.1425243
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 23 cost time: 0.9008777141571045
Epoch: 23, Steps: 64 | Train Loss: 0.0887341 Vali Loss: 0.1562987 Test Loss: 0.1420479
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 24 cost time: 0.9009997844696045
Epoch: 24, Steps: 64 | Train Loss: 0.0880479 Vali Loss: 0.1560158 Test Loss: 0.1420997
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 25 cost time: 0.9041035175323486
Epoch: 25, Steps: 64 | Train Loss: 0.0878021 Vali Loss: 0.1541835 Test Loss: 0.1412751
Validation loss decreased (0.155264 --> 0.154183).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 26 cost time: 0.8873956203460693
Epoch: 26, Steps: 64 | Train Loss: 0.0876346 Vali Loss: 0.1564137 Test Loss: 0.1418636
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 27 cost time: 0.8964211940765381
Epoch: 27, Steps: 64 | Train Loss: 0.0876916 Vali Loss: 0.1548524 Test Loss: 0.1410823
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 28 cost time: 0.8970599174499512
Epoch: 28, Steps: 64 | Train Loss: 0.0876886 Vali Loss: 0.1541392 Test Loss: 0.1406743
Validation loss decreased (0.154183 --> 0.154139).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 29 cost time: 0.8908059597015381
Epoch: 29, Steps: 64 | Train Loss: 0.0874986 Vali Loss: 0.1556873 Test Loss: 0.1411411
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 30 cost time: 0.8858015537261963
Epoch: 30, Steps: 64 | Train Loss: 0.0869457 Vali Loss: 0.1553588 Test Loss: 0.1411684
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 31 cost time: 0.8719992637634277
Epoch: 31, Steps: 64 | Train Loss: 0.0873362 Vali Loss: 0.1533943 Test Loss: 0.1408286
Validation loss decreased (0.154139 --> 0.153394).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 32 cost time: 0.8790018558502197
Epoch: 32, Steps: 64 | Train Loss: 0.0865055 Vali Loss: 0.1532982 Test Loss: 0.1410860
Validation loss decreased (0.153394 --> 0.153298).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 33 cost time: 0.8968312740325928
Epoch: 33, Steps: 64 | Train Loss: 0.0867113 Vali Loss: 0.1539084 Test Loss: 0.1402423
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 34 cost time: 0.9017026424407959
Epoch: 34, Steps: 64 | Train Loss: 0.0867155 Vali Loss: 0.1538730 Test Loss: 0.1406420
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 35 cost time: 0.9135806560516357
Epoch: 35, Steps: 64 | Train Loss: 0.0866268 Vali Loss: 0.1548350 Test Loss: 0.1407435
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 36 cost time: 0.909398078918457
Epoch: 36, Steps: 64 | Train Loss: 0.0869147 Vali Loss: 0.1535708 Test Loss: 0.1404444
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 37 cost time: 0.9157588481903076
Epoch: 37, Steps: 64 | Train Loss: 0.0867629 Vali Loss: 0.1541984 Test Loss: 0.1408731
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 38 cost time: 0.9069979190826416
Epoch: 38, Steps: 64 | Train Loss: 0.0866003 Vali Loss: 0.1538860 Test Loss: 0.1405046
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 39 cost time: 0.8956284523010254
Epoch: 39, Steps: 64 | Train Loss: 0.0866110 Vali Loss: 0.1541920 Test Loss: 0.1406959
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 40 cost time: 0.8813903331756592
Epoch: 40, Steps: 64 | Train Loss: 0.0865717 Vali Loss: 0.1538624 Test Loss: 0.1403795
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 41 cost time: 0.8793683052062988
Epoch: 41, Steps: 64 | Train Loss: 0.0862181 Vali Loss: 0.1535142 Test Loss: 0.1402991
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 42 cost time: 0.8848190307617188
Epoch: 42, Steps: 64 | Train Loss: 0.0863137 Vali Loss: 0.1535955 Test Loss: 0.1404355
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 43 cost time: 0.898367166519165
Epoch: 43, Steps: 64 | Train Loss: 0.0862134 Vali Loss: 0.1540019 Test Loss: 0.1403591
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 44 cost time: 0.9088990688323975
Epoch: 44, Steps: 64 | Train Loss: 0.0861935 Vali Loss: 0.1547349 Test Loss: 0.1403009
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 45 cost time: 0.909930944442749
Epoch: 45, Steps: 64 | Train Loss: 0.0860446 Vali Loss: 0.1531465 Test Loss: 0.1401825
Validation loss decreased (0.153298 --> 0.153147).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 46 cost time: 0.8980846405029297
Epoch: 46, Steps: 64 | Train Loss: 0.0866098 Vali Loss: 0.1538513 Test Loss: 0.1401151
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 47 cost time: 0.8861382007598877
Epoch: 47, Steps: 64 | Train Loss: 0.0862035 Vali Loss: 0.1544944 Test Loss: 0.1401241
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 48 cost time: 0.8726685047149658
Epoch: 48, Steps: 64 | Train Loss: 0.0856797 Vali Loss: 0.1523174 Test Loss: 0.1399096
Validation loss decreased (0.153147 --> 0.152317).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 49 cost time: 0.8684535026550293
Epoch: 49, Steps: 64 | Train Loss: 0.0862851 Vali Loss: 0.1538075 Test Loss: 0.1403683
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 50 cost time: 0.8830001354217529
Epoch: 50, Steps: 64 | Train Loss: 0.0858461 Vali Loss: 0.1541721 Test Loss: 0.1407301
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 51 cost time: 0.8736395835876465
Epoch: 51, Steps: 64 | Train Loss: 0.0860693 Vali Loss: 0.1530592 Test Loss: 0.1402239
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 52 cost time: 0.8836419582366943
Epoch: 52, Steps: 64 | Train Loss: 0.0858532 Vali Loss: 0.1534967 Test Loss: 0.1402633
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 53 cost time: 0.8953709602355957
Epoch: 53, Steps: 64 | Train Loss: 0.0859316 Vali Loss: 0.1526582 Test Loss: 0.1400833
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 54 cost time: 0.8882448673248291
Epoch: 54, Steps: 64 | Train Loss: 0.0861329 Vali Loss: 0.1527881 Test Loss: 0.1400952
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 55 cost time: 0.882714033126831
Epoch: 55, Steps: 64 | Train Loss: 0.0861449 Vali Loss: 0.1529917 Test Loss: 0.1399200
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 56 cost time: 0.8777203559875488
Epoch: 56, Steps: 64 | Train Loss: 0.0861153 Vali Loss: 0.1522323 Test Loss: 0.1409603
Validation loss decreased (0.152317 --> 0.152232).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 57 cost time: 0.886002779006958
Epoch: 57, Steps: 64 | Train Loss: 0.0856937 Vali Loss: 0.1531915 Test Loss: 0.1399769
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 58 cost time: 0.8836300373077393
Epoch: 58, Steps: 64 | Train Loss: 0.0857438 Vali Loss: 0.1536643 Test Loss: 0.1401501
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 59 cost time: 0.8952758312225342
Epoch: 59, Steps: 64 | Train Loss: 0.0856772 Vali Loss: 0.1518709 Test Loss: 0.1404843
Validation loss decreased (0.152232 --> 0.151871).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0179595947265625 GB
GPU已分配内存的峰值：0.055029869079589844 GB
Epoch: 60 cost time: 0.8916037082672119
Epoch: 60, Steps: 64 | Train Loss: 0.0856975 Vali Loss: 0.1531006 Test Loss: 0.1407884
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1404842734336853, mae:0.2735082507133484, rse:0.1994962990283966
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.05904197692871094 GB
Epoch: 1 cost time: 2.3276617527008057
Epoch: 1, Steps: 64 | Train Loss: 0.6832930 Vali Loss: 1.5414690 Test Loss: 2.8884342
Validation loss decreased (inf --> 1.541469).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 2 cost time: 0.930976390838623
Epoch: 2, Steps: 64 | Train Loss: 0.2724712 Vali Loss: 0.2027305 Test Loss: 0.1897568
Validation loss decreased (1.541469 --> 0.202730).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 3 cost time: 0.9364447593688965
Epoch: 3, Steps: 64 | Train Loss: 0.0992312 Vali Loss: 0.1764072 Test Loss: 0.1545376
Validation loss decreased (0.202730 --> 0.176407).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 4 cost time: 0.9270689487457275
Epoch: 4, Steps: 64 | Train Loss: 0.0909406 Vali Loss: 0.1625141 Test Loss: 0.1394811
Validation loss decreased (0.176407 --> 0.162514).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 5 cost time: 0.906740665435791
Epoch: 5, Steps: 64 | Train Loss: 0.0877111 Vali Loss: 0.1608050 Test Loss: 0.1390691
Validation loss decreased (0.162514 --> 0.160805).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 6 cost time: 0.9059998989105225
Epoch: 6, Steps: 64 | Train Loss: 0.0855037 Vali Loss: 0.1571811 Test Loss: 0.1369500
Validation loss decreased (0.160805 --> 0.157181).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 7 cost time: 0.9129998683929443
Epoch: 7, Steps: 64 | Train Loss: 0.0845906 Vali Loss: 0.1548131 Test Loss: 0.1359502
Validation loss decreased (0.157181 --> 0.154813).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 8 cost time: 0.9020771980285645
Epoch: 8, Steps: 64 | Train Loss: 0.0829984 Vali Loss: 0.1517794 Test Loss: 0.1357441
Validation loss decreased (0.154813 --> 0.151779).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 9 cost time: 0.9324195384979248
Epoch: 9, Steps: 64 | Train Loss: 0.0821260 Vali Loss: 0.1513984 Test Loss: 0.1342605
Validation loss decreased (0.151779 --> 0.151398).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 10 cost time: 0.940438985824585
Epoch: 10, Steps: 64 | Train Loss: 0.0814548 Vali Loss: 0.1514965 Test Loss: 0.1348046
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 11 cost time: 0.9234657287597656
Epoch: 11, Steps: 64 | Train Loss: 0.0804516 Vali Loss: 0.1485028 Test Loss: 0.1332900
Validation loss decreased (0.151398 --> 0.148503).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 12 cost time: 0.9473862648010254
Epoch: 12, Steps: 64 | Train Loss: 0.0803493 Vali Loss: 0.1480846 Test Loss: 0.1333126
Validation loss decreased (0.148503 --> 0.148085).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 13 cost time: 0.9433693885803223
Epoch: 13, Steps: 64 | Train Loss: 0.0797183 Vali Loss: 0.1484143 Test Loss: 0.1338988
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 14 cost time: 0.9227457046508789
Epoch: 14, Steps: 64 | Train Loss: 0.0784671 Vali Loss: 0.1448805 Test Loss: 0.1330662
Validation loss decreased (0.148085 --> 0.144881).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 15 cost time: 0.9294261932373047
Epoch: 15, Steps: 64 | Train Loss: 0.0782532 Vali Loss: 0.1441298 Test Loss: 0.1326505
Validation loss decreased (0.144881 --> 0.144130).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 16 cost time: 0.9257304668426514
Epoch: 16, Steps: 64 | Train Loss: 0.0779086 Vali Loss: 0.1439988 Test Loss: 0.1340659
Validation loss decreased (0.144130 --> 0.143999).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 17 cost time: 0.924607515335083
Epoch: 17, Steps: 64 | Train Loss: 0.0778338 Vali Loss: 0.1424997 Test Loss: 0.1321447
Validation loss decreased (0.143999 --> 0.142500).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 18 cost time: 0.9443976879119873
Epoch: 18, Steps: 64 | Train Loss: 0.0775595 Vali Loss: 0.1421561 Test Loss: 0.1315956
Validation loss decreased (0.142500 --> 0.142156).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 19 cost time: 0.9425301551818848
Epoch: 19, Steps: 64 | Train Loss: 0.0771995 Vali Loss: 0.1430486 Test Loss: 0.1320535
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 20 cost time: 0.9563906192779541
Epoch: 20, Steps: 64 | Train Loss: 0.0770405 Vali Loss: 0.1414532 Test Loss: 0.1310100
Validation loss decreased (0.142156 --> 0.141453).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 21 cost time: 0.9280328750610352
Epoch: 21, Steps: 64 | Train Loss: 0.0772138 Vali Loss: 0.1399560 Test Loss: 0.1320062
Validation loss decreased (0.141453 --> 0.139956).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 22 cost time: 0.928389310836792
Epoch: 22, Steps: 64 | Train Loss: 0.0771051 Vali Loss: 0.1402660 Test Loss: 0.1312524
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 23 cost time: 0.9119994640350342
Epoch: 23, Steps: 64 | Train Loss: 0.0764370 Vali Loss: 0.1418870 Test Loss: 0.1319190
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 24 cost time: 0.9199235439300537
Epoch: 24, Steps: 64 | Train Loss: 0.0764940 Vali Loss: 0.1415235 Test Loss: 0.1321669
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 25 cost time: 0.9259400367736816
Epoch: 25, Steps: 64 | Train Loss: 0.0762495 Vali Loss: 0.1411949 Test Loss: 0.1314015
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 26 cost time: 0.9226386547088623
Epoch: 26, Steps: 64 | Train Loss: 0.0762287 Vali Loss: 0.1391095 Test Loss: 0.1304710
Validation loss decreased (0.139956 --> 0.139109).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 27 cost time: 0.9233806133270264
Epoch: 27, Steps: 64 | Train Loss: 0.0762062 Vali Loss: 0.1398813 Test Loss: 0.1316981
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 28 cost time: 0.920457124710083
Epoch: 28, Steps: 64 | Train Loss: 0.0757450 Vali Loss: 0.1400339 Test Loss: 0.1302546
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 29 cost time: 0.9394261837005615
Epoch: 29, Steps: 64 | Train Loss: 0.0762335 Vali Loss: 0.1399876 Test Loss: 0.1310951
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 30 cost time: 0.9333531856536865
Epoch: 30, Steps: 64 | Train Loss: 0.0756688 Vali Loss: 0.1401777 Test Loss: 0.1303517
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 31 cost time: 0.9043693542480469
Epoch: 31, Steps: 64 | Train Loss: 0.0754996 Vali Loss: 0.1401604 Test Loss: 0.1308331
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 32 cost time: 0.9067611694335938
Epoch: 32, Steps: 64 | Train Loss: 0.0757532 Vali Loss: 0.1397982 Test Loss: 0.1307819
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 33 cost time: 0.9333782196044922
Epoch: 33, Steps: 64 | Train Loss: 0.0756075 Vali Loss: 0.1394131 Test Loss: 0.1306030
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 34 cost time: 0.9506368637084961
Epoch: 34, Steps: 64 | Train Loss: 0.0755426 Vali Loss: 0.1394845 Test Loss: 0.1309889
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 35 cost time: 0.9446465969085693
Epoch: 35, Steps: 64 | Train Loss: 0.0756168 Vali Loss: 0.1393996 Test Loss: 0.1303749
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 36 cost time: 0.9445955753326416
Epoch: 36, Steps: 64 | Train Loss: 0.0756543 Vali Loss: 0.1377069 Test Loss: 0.1303729
Validation loss decreased (0.139109 --> 0.137707).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 37 cost time: 0.9388513565063477
Epoch: 37, Steps: 64 | Train Loss: 0.0756695 Vali Loss: 0.1385225 Test Loss: 0.1301479
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 38 cost time: 0.9213912487030029
Epoch: 38, Steps: 64 | Train Loss: 0.0755941 Vali Loss: 0.1400820 Test Loss: 0.1312193
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 39 cost time: 0.925405740737915
Epoch: 39, Steps: 64 | Train Loss: 0.0756320 Vali Loss: 0.1392287 Test Loss: 0.1299459
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 40 cost time: 0.9347455501556396
Epoch: 40, Steps: 64 | Train Loss: 0.0754344 Vali Loss: 0.1404574 Test Loss: 0.1307528
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 41 cost time: 0.9417769908905029
Epoch: 41, Steps: 64 | Train Loss: 0.0752524 Vali Loss: 0.1398925 Test Loss: 0.1308192
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 42 cost time: 0.9520018100738525
Epoch: 42, Steps: 64 | Train Loss: 0.0754843 Vali Loss: 0.1395108 Test Loss: 0.1300796
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 43 cost time: 0.9429991245269775
Epoch: 43, Steps: 64 | Train Loss: 0.0753642 Vali Loss: 0.1396524 Test Loss: 0.1310190
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 44 cost time: 0.9306342601776123
Epoch: 44, Steps: 64 | Train Loss: 0.0753118 Vali Loss: 0.1386027 Test Loss: 0.1302964
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 45 cost time: 0.9435513019561768
Epoch: 45, Steps: 64 | Train Loss: 0.0751282 Vali Loss: 0.1393120 Test Loss: 0.1305444
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 46 cost time: 0.9374799728393555
Epoch: 46, Steps: 64 | Train Loss: 0.0754074 Vali Loss: 0.1401115 Test Loss: 0.1315177
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 47 cost time: 0.9484152793884277
Epoch: 47, Steps: 64 | Train Loss: 0.0749647 Vali Loss: 0.1389722 Test Loss: 0.1302121
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 48 cost time: 0.912461519241333
Epoch: 48, Steps: 64 | Train Loss: 0.0753662 Vali Loss: 0.1391796 Test Loss: 0.1303614
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 49 cost time: 0.9183981418609619
Epoch: 49, Steps: 64 | Train Loss: 0.0752475 Vali Loss: 0.1395148 Test Loss: 0.1308438
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 50 cost time: 0.9304661750793457
Epoch: 50, Steps: 64 | Train Loss: 0.0757103 Vali Loss: 0.1400781 Test Loss: 0.1305828
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 51 cost time: 0.8990013599395752
Epoch: 51, Steps: 64 | Train Loss: 0.0751263 Vali Loss: 0.1384071 Test Loss: 0.1303786
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 52 cost time: 0.9506304264068604
Epoch: 52, Steps: 64 | Train Loss: 0.0752415 Vali Loss: 0.1385891 Test Loss: 0.1292247
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 53 cost time: 0.9496378898620605
Epoch: 53, Steps: 64 | Train Loss: 0.0753225 Vali Loss: 0.1405346 Test Loss: 0.1307185
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 54 cost time: 0.91139817237854
Epoch: 54, Steps: 64 | Train Loss: 0.0754064 Vali Loss: 0.1372047 Test Loss: 0.1293698
Validation loss decreased (0.137707 --> 0.137205).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 55 cost time: 0.913398027420044
Epoch: 55, Steps: 64 | Train Loss: 0.0751094 Vali Loss: 0.1389444 Test Loss: 0.1304128
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 56 cost time: 0.9254851341247559
Epoch: 56, Steps: 64 | Train Loss: 0.0753908 Vali Loss: 0.1381158 Test Loss: 0.1300359
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 57 cost time: 0.9353804588317871
Epoch: 57, Steps: 64 | Train Loss: 0.0752813 Vali Loss: 0.1375946 Test Loss: 0.1302583
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 58 cost time: 0.9480776786804199
Epoch: 58, Steps: 64 | Train Loss: 0.0751687 Vali Loss: 0.1394730 Test Loss: 0.1297560
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 59 cost time: 0.9538116455078125
Epoch: 59, Steps: 64 | Train Loss: 0.0747529 Vali Loss: 0.1372812 Test Loss: 0.1298061
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0199127197265625 GB
GPU已分配内存的峰值：0.060400962829589844 GB
Epoch: 60 cost time: 0.9500002861022949
Epoch: 60, Steps: 64 | Train Loss: 0.0752412 Vali Loss: 0.1393427 Test Loss: 0.1300756
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.12936978042125702, mae:0.2552119791507721, rse:0.1914420872926712
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=32, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.062340736389160156 GB
Epoch: 1 cost time: 2.3590312004089355
Epoch: 1, Steps: 64 | Train Loss: 0.7799986 Vali Loss: 1.7798688 Test Loss: 3.3923810
Validation loss decreased (inf --> 1.779869).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 2 cost time: 0.9621679782867432
Epoch: 2, Steps: 64 | Train Loss: 0.2910603 Vali Loss: 0.2353067 Test Loss: 0.3032395
Validation loss decreased (1.779869 --> 0.235307).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 3 cost time: 0.9550015926361084
Epoch: 3, Steps: 64 | Train Loss: 0.0997690 Vali Loss: 0.1646182 Test Loss: 0.1421324
Validation loss decreased (0.235307 --> 0.164618).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 4 cost time: 0.9730010032653809
Epoch: 4, Steps: 64 | Train Loss: 0.0893812 Vali Loss: 0.1591117 Test Loss: 0.1412925
Validation loss decreased (0.164618 --> 0.159112).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 5 cost time: 0.9370017051696777
Epoch: 5, Steps: 64 | Train Loss: 0.0861864 Vali Loss: 0.1533432 Test Loss: 0.1366526
Validation loss decreased (0.159112 --> 0.153343).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 6 cost time: 0.9373412132263184
Epoch: 6, Steps: 64 | Train Loss: 0.0846129 Vali Loss: 0.1512177 Test Loss: 0.1373675
Validation loss decreased (0.153343 --> 0.151218).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 7 cost time: 0.940345048904419
Epoch: 7, Steps: 64 | Train Loss: 0.0829395 Vali Loss: 0.1515197 Test Loss: 0.1360880
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 8 cost time: 0.9244248867034912
Epoch: 8, Steps: 64 | Train Loss: 0.0818743 Vali Loss: 0.1488886 Test Loss: 0.1347655
Validation loss decreased (0.151218 --> 0.148889).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 9 cost time: 0.9641320705413818
Epoch: 9, Steps: 64 | Train Loss: 0.0807645 Vali Loss: 0.1480077 Test Loss: 0.1368726
Validation loss decreased (0.148889 --> 0.148008).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 10 cost time: 0.9602434635162354
Epoch: 10, Steps: 64 | Train Loss: 0.0800265 Vali Loss: 0.1450245 Test Loss: 0.1345077
Validation loss decreased (0.148008 --> 0.145024).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 11 cost time: 0.9604141712188721
Epoch: 11, Steps: 64 | Train Loss: 0.0794467 Vali Loss: 0.1447637 Test Loss: 0.1330315
Validation loss decreased (0.145024 --> 0.144764).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 12 cost time: 0.9773976802825928
Epoch: 12, Steps: 64 | Train Loss: 0.0788244 Vali Loss: 0.1439708 Test Loss: 0.1341470
Validation loss decreased (0.144764 --> 0.143971).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 13 cost time: 0.9514541625976562
Epoch: 13, Steps: 64 | Train Loss: 0.0786031 Vali Loss: 0.1458123 Test Loss: 0.1344604
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 14 cost time: 0.9587647914886475
Epoch: 14, Steps: 64 | Train Loss: 0.0779150 Vali Loss: 0.1431956 Test Loss: 0.1339405
Validation loss decreased (0.143971 --> 0.143196).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 15 cost time: 0.9591169357299805
Epoch: 15, Steps: 64 | Train Loss: 0.0773796 Vali Loss: 0.1416532 Test Loss: 0.1323155
Validation loss decreased (0.143196 --> 0.141653).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 16 cost time: 0.9630022048950195
Epoch: 16, Steps: 64 | Train Loss: 0.0771428 Vali Loss: 0.1399567 Test Loss: 0.1326132
Validation loss decreased (0.141653 --> 0.139957).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 17 cost time: 0.9826488494873047
Epoch: 17, Steps: 64 | Train Loss: 0.0770072 Vali Loss: 0.1405646 Test Loss: 0.1316031
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 18 cost time: 0.9756424427032471
Epoch: 18, Steps: 64 | Train Loss: 0.0771180 Vali Loss: 0.1430119 Test Loss: 0.1329295
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 19 cost time: 0.9836325645446777
Epoch: 19, Steps: 64 | Train Loss: 0.0766726 Vali Loss: 0.1410289 Test Loss: 0.1323629
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 20 cost time: 0.9713637828826904
Epoch: 20, Steps: 64 | Train Loss: 0.0764479 Vali Loss: 0.1421935 Test Loss: 0.1328157
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 21 cost time: 0.9633738994598389
Epoch: 21, Steps: 64 | Train Loss: 0.0761321 Vali Loss: 0.1408553 Test Loss: 0.1320019
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 22 cost time: 0.9484355449676514
Epoch: 22, Steps: 64 | Train Loss: 0.0756037 Vali Loss: 0.1406889 Test Loss: 0.1326998
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 23 cost time: 0.9519906044006348
Epoch: 23, Steps: 64 | Train Loss: 0.0758290 Vali Loss: 0.1415251 Test Loss: 0.1323848
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 24 cost time: 0.9504694938659668
Epoch: 24, Steps: 64 | Train Loss: 0.0753624 Vali Loss: 0.1405465 Test Loss: 0.1329745
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 25 cost time: 0.9523725509643555
Epoch: 25, Steps: 64 | Train Loss: 0.0756007 Vali Loss: 0.1416055 Test Loss: 0.1325552
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 26 cost time: 0.958726167678833
Epoch: 26, Steps: 64 | Train Loss: 0.0756998 Vali Loss: 0.1408832 Test Loss: 0.1323120
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 27 cost time: 0.9396493434906006
Epoch: 27, Steps: 64 | Train Loss: 0.0754420 Vali Loss: 0.1387084 Test Loss: 0.1305174
Validation loss decreased (0.139957 --> 0.138708).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 28 cost time: 0.983001708984375
Epoch: 28, Steps: 64 | Train Loss: 0.0751508 Vali Loss: 0.1401926 Test Loss: 0.1309200
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 29 cost time: 0.9786372184753418
Epoch: 29, Steps: 64 | Train Loss: 0.0752962 Vali Loss: 0.1392495 Test Loss: 0.1314068
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 30 cost time: 0.9616568088531494
Epoch: 30, Steps: 64 | Train Loss: 0.0753750 Vali Loss: 0.1393403 Test Loss: 0.1319714
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 31 cost time: 0.9346580505371094
Epoch: 31, Steps: 64 | Train Loss: 0.0752757 Vali Loss: 0.1400699 Test Loss: 0.1319954
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 32 cost time: 0.9653768539428711
Epoch: 32, Steps: 64 | Train Loss: 0.0750363 Vali Loss: 0.1390526 Test Loss: 0.1317830
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 33 cost time: 0.9873719215393066
Epoch: 33, Steps: 64 | Train Loss: 0.0752067 Vali Loss: 0.1385578 Test Loss: 0.1313763
Validation loss decreased (0.138708 --> 0.138558).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 34 cost time: 0.9843847751617432
Epoch: 34, Steps: 64 | Train Loss: 0.0749508 Vali Loss: 0.1396378 Test Loss: 0.1312211
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 35 cost time: 0.9800734519958496
Epoch: 35, Steps: 64 | Train Loss: 0.0751337 Vali Loss: 0.1384929 Test Loss: 0.1324384
Validation loss decreased (0.138558 --> 0.138493).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 36 cost time: 0.9633724689483643
Epoch: 36, Steps: 64 | Train Loss: 0.0748285 Vali Loss: 0.1407427 Test Loss: 0.1318686
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 37 cost time: 0.9573805332183838
Epoch: 37, Steps: 64 | Train Loss: 0.0751800 Vali Loss: 0.1393361 Test Loss: 0.1311808
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 38 cost time: 0.9627876281738281
Epoch: 38, Steps: 64 | Train Loss: 0.0748212 Vali Loss: 0.1387508 Test Loss: 0.1311958
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 39 cost time: 0.9613595008850098
Epoch: 39, Steps: 64 | Train Loss: 0.0748339 Vali Loss: 0.1387788 Test Loss: 0.1313011
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 40 cost time: 0.9819974899291992
Epoch: 40, Steps: 64 | Train Loss: 0.0749223 Vali Loss: 0.1403254 Test Loss: 0.1318785
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 41 cost time: 0.9770004749298096
Epoch: 41, Steps: 64 | Train Loss: 0.0750343 Vali Loss: 0.1390704 Test Loss: 0.1315322
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 42 cost time: 0.979637861251831
Epoch: 42, Steps: 64 | Train Loss: 0.0747825 Vali Loss: 0.1395944 Test Loss: 0.1318575
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 43 cost time: 0.9636168479919434
Epoch: 43, Steps: 64 | Train Loss: 0.0748753 Vali Loss: 0.1405010 Test Loss: 0.1317584
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 44 cost time: 0.9455504417419434
Epoch: 44, Steps: 64 | Train Loss: 0.0744735 Vali Loss: 0.1388607 Test Loss: 0.1308758
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 45 cost time: 0.945378303527832
Epoch: 45, Steps: 64 | Train Loss: 0.0745265 Vali Loss: 0.1392947 Test Loss: 0.1307775
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 46 cost time: 0.9533874988555908
Epoch: 46, Steps: 64 | Train Loss: 0.0749205 Vali Loss: 0.1396264 Test Loss: 0.1316065
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 47 cost time: 0.9389801025390625
Epoch: 47, Steps: 64 | Train Loss: 0.0744540 Vali Loss: 0.1382729 Test Loss: 0.1311062
Validation loss decreased (0.138493 --> 0.138273).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 48 cost time: 0.9624195098876953
Epoch: 48, Steps: 64 | Train Loss: 0.0747855 Vali Loss: 0.1390150 Test Loss: 0.1311289
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 49 cost time: 0.9643979072570801
Epoch: 49, Steps: 64 | Train Loss: 0.0747766 Vali Loss: 0.1383971 Test Loss: 0.1318357
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 50 cost time: 0.9828057289123535
Epoch: 50, Steps: 64 | Train Loss: 0.0750882 Vali Loss: 0.1388357 Test Loss: 0.1318787
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 51 cost time: 0.9754002094268799
Epoch: 51, Steps: 64 | Train Loss: 0.0746111 Vali Loss: 0.1386708 Test Loss: 0.1312804
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 52 cost time: 0.9799988269805908
Epoch: 52, Steps: 64 | Train Loss: 0.0750298 Vali Loss: 0.1400531 Test Loss: 0.1312934
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 53 cost time: 0.9600000381469727
Epoch: 53, Steps: 64 | Train Loss: 0.0748626 Vali Loss: 0.1378359 Test Loss: 0.1306835
Validation loss decreased (0.138273 --> 0.137836).  Saving model ...
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 54 cost time: 0.9596438407897949
Epoch: 54, Steps: 64 | Train Loss: 0.0743837 Vali Loss: 0.1390825 Test Loss: 0.1307378
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 55 cost time: 0.9596245288848877
Epoch: 55, Steps: 64 | Train Loss: 0.0747016 Vali Loss: 0.1402753 Test Loss: 0.1315929
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 56 cost time: 0.9894006252288818
Epoch: 56, Steps: 64 | Train Loss: 0.0749987 Vali Loss: 0.1384464 Test Loss: 0.1315918
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 57 cost time: 0.9849519729614258
Epoch: 57, Steps: 64 | Train Loss: 0.0746995 Vali Loss: 0.1383231 Test Loss: 0.1311398
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 58 cost time: 0.9745006561279297
Epoch: 58, Steps: 64 | Train Loss: 0.0745670 Vali Loss: 0.1385662 Test Loss: 0.1309558
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 59 cost time: 0.981980562210083
Epoch: 59, Steps: 64 | Train Loss: 0.0748649 Vali Loss: 0.1388168 Test Loss: 0.1305653
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02089691162109375 GB
GPU已分配内存的峰值：0.06419181823730469 GB
Epoch: 60 cost time: 0.9593830108642578
Epoch: 60, Steps: 64 | Train Loss: 0.0746029 Vali Loss: 0.1385055 Test Loss: 0.1310253
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df32_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_32__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13068348169326782, mae:0.2568373680114746, rse:0.1924116164445877
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.057959556579589844 GB
Epoch: 1 cost time: 2.2681684494018555
Epoch: 1, Steps: 64 | Train Loss: 0.8267370 Vali Loss: 1.8219217 Test Loss: 3.5424495
Validation loss decreased (inf --> 1.821922).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 2 cost time: 0.8865053653717041
Epoch: 2, Steps: 64 | Train Loss: 0.6411499 Vali Loss: 1.0342441 Test Loss: 1.8473718
Validation loss decreased (1.821922 --> 1.034244).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 3 cost time: 0.8789925575256348
Epoch: 3, Steps: 64 | Train Loss: 0.3820301 Vali Loss: 0.6160107 Test Loss: 0.9549211
Validation loss decreased (1.034244 --> 0.616011).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 4 cost time: 0.8779149055480957
Epoch: 4, Steps: 64 | Train Loss: 0.2409052 Vali Loss: 0.4113615 Test Loss: 0.5680993
Validation loss decreased (0.616011 --> 0.411362).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 5 cost time: 0.8749990463256836
Epoch: 5, Steps: 64 | Train Loss: 0.1688648 Vali Loss: 0.2974628 Test Loss: 0.3660114
Validation loss decreased (0.411362 --> 0.297463).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 6 cost time: 0.8606526851654053
Epoch: 6, Steps: 64 | Train Loss: 0.1360190 Vali Loss: 0.2464484 Test Loss: 0.2728818
Validation loss decreased (0.297463 --> 0.246448).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 7 cost time: 0.8463950157165527
Epoch: 7, Steps: 64 | Train Loss: 0.1197585 Vali Loss: 0.2145309 Test Loss: 0.2195571
Validation loss decreased (0.246448 --> 0.214531).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 8 cost time: 0.8389949798583984
Epoch: 8, Steps: 64 | Train Loss: 0.1105957 Vali Loss: 0.1939198 Test Loss: 0.1905448
Validation loss decreased (0.214531 --> 0.193920).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 9 cost time: 0.849790096282959
Epoch: 9, Steps: 64 | Train Loss: 0.1064762 Vali Loss: 0.1842407 Test Loss: 0.1765206
Validation loss decreased (0.193920 --> 0.184241).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 10 cost time: 0.8619997501373291
Epoch: 10, Steps: 64 | Train Loss: 0.1030376 Vali Loss: 0.1789953 Test Loss: 0.1670182
Validation loss decreased (0.184241 --> 0.178995).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 11 cost time: 0.8656349182128906
Epoch: 11, Steps: 64 | Train Loss: 0.1010558 Vali Loss: 0.1731545 Test Loss: 0.1610090
Validation loss decreased (0.178995 --> 0.173155).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 12 cost time: 0.8747260570526123
Epoch: 12, Steps: 64 | Train Loss: 0.0991359 Vali Loss: 0.1691021 Test Loss: 0.1564942
Validation loss decreased (0.173155 --> 0.169102).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 13 cost time: 0.8845152854919434
Epoch: 13, Steps: 64 | Train Loss: 0.0979475 Vali Loss: 0.1646627 Test Loss: 0.1532829
Validation loss decreased (0.169102 --> 0.164663).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 14 cost time: 0.8643779754638672
Epoch: 14, Steps: 64 | Train Loss: 0.0966477 Vali Loss: 0.1646214 Test Loss: 0.1521819
Validation loss decreased (0.164663 --> 0.164621).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 15 cost time: 0.861793041229248
Epoch: 15, Steps: 64 | Train Loss: 0.0968043 Vali Loss: 0.1634623 Test Loss: 0.1511350
Validation loss decreased (0.164621 --> 0.163462).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 16 cost time: 0.8560001850128174
Epoch: 16, Steps: 64 | Train Loss: 0.0951111 Vali Loss: 0.1629650 Test Loss: 0.1500381
Validation loss decreased (0.163462 --> 0.162965).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 17 cost time: 0.8596265316009521
Epoch: 17, Steps: 64 | Train Loss: 0.0941876 Vali Loss: 0.1615292 Test Loss: 0.1489662
Validation loss decreased (0.162965 --> 0.161529).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 18 cost time: 0.8583858013153076
Epoch: 18, Steps: 64 | Train Loss: 0.0941583 Vali Loss: 0.1604650 Test Loss: 0.1488787
Validation loss decreased (0.161529 --> 0.160465).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 19 cost time: 0.8785693645477295
Epoch: 19, Steps: 64 | Train Loss: 0.0936420 Vali Loss: 0.1601885 Test Loss: 0.1475629
Validation loss decreased (0.160465 --> 0.160188).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 20 cost time: 0.8748242855072021
Epoch: 20, Steps: 64 | Train Loss: 0.0934167 Vali Loss: 0.1596791 Test Loss: 0.1473969
Validation loss decreased (0.160188 --> 0.159679).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 21 cost time: 0.8763604164123535
Epoch: 21, Steps: 64 | Train Loss: 0.0926071 Vali Loss: 0.1592376 Test Loss: 0.1472071
Validation loss decreased (0.159679 --> 0.159238).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 22 cost time: 0.8746466636657715
Epoch: 22, Steps: 64 | Train Loss: 0.0925050 Vali Loss: 0.1567705 Test Loss: 0.1471713
Validation loss decreased (0.159238 --> 0.156770).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 23 cost time: 0.8524322509765625
Epoch: 23, Steps: 64 | Train Loss: 0.0918387 Vali Loss: 0.1572919 Test Loss: 0.1463928
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 24 cost time: 0.8483724594116211
Epoch: 24, Steps: 64 | Train Loss: 0.0928698 Vali Loss: 0.1577220 Test Loss: 0.1463714
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 25 cost time: 0.8497521877288818
Epoch: 25, Steps: 64 | Train Loss: 0.0921362 Vali Loss: 0.1554575 Test Loss: 0.1461019
Validation loss decreased (0.156770 --> 0.155457).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 26 cost time: 0.8404092788696289
Epoch: 26, Steps: 64 | Train Loss: 0.0914954 Vali Loss: 0.1571645 Test Loss: 0.1455974
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 27 cost time: 0.843637228012085
Epoch: 27, Steps: 64 | Train Loss: 0.0912036 Vali Loss: 0.1554698 Test Loss: 0.1455150
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 28 cost time: 0.8511343002319336
Epoch: 28, Steps: 64 | Train Loss: 0.0915330 Vali Loss: 0.1559268 Test Loss: 0.1451739
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 29 cost time: 0.8287150859832764
Epoch: 29, Steps: 64 | Train Loss: 0.0912499 Vali Loss: 0.1546588 Test Loss: 0.1455020
Validation loss decreased (0.155457 --> 0.154659).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 30 cost time: 0.8603458404541016
Epoch: 30, Steps: 64 | Train Loss: 0.0909546 Vali Loss: 0.1546796 Test Loss: 0.1452006
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 31 cost time: 0.8509986400604248
Epoch: 31, Steps: 64 | Train Loss: 0.0909737 Vali Loss: 0.1570851 Test Loss: 0.1450401
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 32 cost time: 0.8786904811859131
Epoch: 32, Steps: 64 | Train Loss: 0.0911062 Vali Loss: 0.1556455 Test Loss: 0.1453755
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 33 cost time: 0.8283693790435791
Epoch: 33, Steps: 64 | Train Loss: 0.0908618 Vali Loss: 0.1570407 Test Loss: 0.1455128
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 34 cost time: 0.8547234535217285
Epoch: 34, Steps: 64 | Train Loss: 0.0907864 Vali Loss: 0.1566619 Test Loss: 0.1454336
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 35 cost time: 0.8657732009887695
Epoch: 35, Steps: 64 | Train Loss: 0.0904007 Vali Loss: 0.1559053 Test Loss: 0.1448622
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 36 cost time: 0.8600001335144043
Epoch: 36, Steps: 64 | Train Loss: 0.0904425 Vali Loss: 0.1548974 Test Loss: 0.1447295
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 37 cost time: 0.8826403617858887
Epoch: 37, Steps: 64 | Train Loss: 0.0905533 Vali Loss: 0.1548772 Test Loss: 0.1447495
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 38 cost time: 0.8844003677368164
Epoch: 38, Steps: 64 | Train Loss: 0.0903431 Vali Loss: 0.1540535 Test Loss: 0.1443856
Validation loss decreased (0.154659 --> 0.154054).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 39 cost time: 0.887286901473999
Epoch: 39, Steps: 64 | Train Loss: 0.0901137 Vali Loss: 0.1530923 Test Loss: 0.1447075
Validation loss decreased (0.154054 --> 0.153092).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 40 cost time: 0.8839950561523438
Epoch: 40, Steps: 64 | Train Loss: 0.0901307 Vali Loss: 0.1548166 Test Loss: 0.1445357
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 41 cost time: 0.8737225532531738
Epoch: 41, Steps: 64 | Train Loss: 0.0898473 Vali Loss: 0.1552574 Test Loss: 0.1447037
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 42 cost time: 0.8550026416778564
Epoch: 42, Steps: 64 | Train Loss: 0.0899065 Vali Loss: 0.1530452 Test Loss: 0.1444925
Validation loss decreased (0.153092 --> 0.153045).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 43 cost time: 0.8696291446685791
Epoch: 43, Steps: 64 | Train Loss: 0.0897618 Vali Loss: 0.1538895 Test Loss: 0.1442496
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 44 cost time: 0.8595354557037354
Epoch: 44, Steps: 64 | Train Loss: 0.0899609 Vali Loss: 0.1545046 Test Loss: 0.1450194
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 45 cost time: 0.8451201915740967
Epoch: 45, Steps: 64 | Train Loss: 0.0902238 Vali Loss: 0.1540635 Test Loss: 0.1441622
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 46 cost time: 0.8647582530975342
Epoch: 46, Steps: 64 | Train Loss: 0.0903229 Vali Loss: 0.1543205 Test Loss: 0.1444062
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 47 cost time: 0.8539996147155762
Epoch: 47, Steps: 64 | Train Loss: 0.0900292 Vali Loss: 0.1538527 Test Loss: 0.1442456
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 48 cost time: 0.8616478443145752
Epoch: 48, Steps: 64 | Train Loss: 0.0897690 Vali Loss: 0.1539465 Test Loss: 0.1441063
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 49 cost time: 0.8660440444946289
Epoch: 49, Steps: 64 | Train Loss: 0.0900899 Vali Loss: 0.1546991 Test Loss: 0.1447577
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 50 cost time: 0.864393949508667
Epoch: 50, Steps: 64 | Train Loss: 0.0899571 Vali Loss: 0.1544854 Test Loss: 0.1441881
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 51 cost time: 0.841724157333374
Epoch: 51, Steps: 64 | Train Loss: 0.0895201 Vali Loss: 0.1547818 Test Loss: 0.1444570
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 52 cost time: 0.8499999046325684
Epoch: 52, Steps: 64 | Train Loss: 0.0893998 Vali Loss: 0.1543642 Test Loss: 0.1441142
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 53 cost time: 0.848642110824585
Epoch: 53, Steps: 64 | Train Loss: 0.0898560 Vali Loss: 0.1535730 Test Loss: 0.1439875
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 54 cost time: 0.8512649536132812
Epoch: 54, Steps: 64 | Train Loss: 0.0895261 Vali Loss: 0.1548285 Test Loss: 0.1448377
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 55 cost time: 0.8583903312683105
Epoch: 55, Steps: 64 | Train Loss: 0.0898386 Vali Loss: 0.1541056 Test Loss: 0.1446201
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 56 cost time: 0.8608875274658203
Epoch: 56, Steps: 64 | Train Loss: 0.0898891 Vali Loss: 0.1545896 Test Loss: 0.1441139
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 57 cost time: 0.8759980201721191
Epoch: 57, Steps: 64 | Train Loss: 0.0897441 Vali Loss: 0.1551194 Test Loss: 0.1446532
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 58 cost time: 0.8800122737884521
Epoch: 58, Steps: 64 | Train Loss: 0.0895161 Vali Loss: 0.1544849 Test Loss: 0.1445458
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 59 cost time: 0.8744137287139893
Epoch: 59, Steps: 64 | Train Loss: 0.0896640 Vali Loss: 0.1554516 Test Loss: 0.1447855
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018115997314453125 GB
GPU已分配内存的峰值：0.05842018127441406 GB
Epoch: 60 cost time: 0.8754012584686279
Epoch: 60, Steps: 64 | Train Loss: 0.0894392 Vali Loss: 0.1542216 Test Loss: 0.1445108
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.144492506980896, mae:0.28078678250312805, rse:0.20232224464416504
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.062354087829589844 GB
Epoch: 1 cost time: 2.316382884979248
Epoch: 1, Steps: 64 | Train Loss: 0.7420815 Vali Loss: 1.7016383 Test Loss: 3.1864262
Validation loss decreased (inf --> 1.701638).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 2 cost time: 0.9035305976867676
Epoch: 2, Steps: 64 | Train Loss: 0.3483976 Vali Loss: 0.2456333 Test Loss: 0.1952313
Validation loss decreased (1.701638 --> 0.245633).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 3 cost time: 0.9003758430480957
Epoch: 3, Steps: 64 | Train Loss: 0.1058795 Vali Loss: 0.1786297 Test Loss: 0.1549645
Validation loss decreased (0.245633 --> 0.178630).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 4 cost time: 0.9083132743835449
Epoch: 4, Steps: 64 | Train Loss: 0.0957011 Vali Loss: 0.1708073 Test Loss: 0.1441285
Validation loss decreased (0.178630 --> 0.170807).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 5 cost time: 0.8827528953552246
Epoch: 5, Steps: 64 | Train Loss: 0.0917144 Vali Loss: 0.1634275 Test Loss: 0.1440250
Validation loss decreased (0.170807 --> 0.163428).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 6 cost time: 0.8839988708496094
Epoch: 6, Steps: 64 | Train Loss: 0.0890573 Vali Loss: 0.1611092 Test Loss: 0.1419449
Validation loss decreased (0.163428 --> 0.161109).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 7 cost time: 0.8843944072723389
Epoch: 7, Steps: 64 | Train Loss: 0.0870349 Vali Loss: 0.1563051 Test Loss: 0.1414181
Validation loss decreased (0.161109 --> 0.156305).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 8 cost time: 0.8876910209655762
Epoch: 8, Steps: 64 | Train Loss: 0.0850674 Vali Loss: 0.1528896 Test Loss: 0.1403259
Validation loss decreased (0.156305 --> 0.152890).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 9 cost time: 0.8953783512115479
Epoch: 9, Steps: 64 | Train Loss: 0.0844086 Vali Loss: 0.1518555 Test Loss: 0.1403495
Validation loss decreased (0.152890 --> 0.151855).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 10 cost time: 0.9043939113616943
Epoch: 10, Steps: 64 | Train Loss: 0.0830676 Vali Loss: 0.1509825 Test Loss: 0.1405460
Validation loss decreased (0.151855 --> 0.150982).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 11 cost time: 0.9061563014984131
Epoch: 11, Steps: 64 | Train Loss: 0.0825069 Vali Loss: 0.1489580 Test Loss: 0.1401416
Validation loss decreased (0.150982 --> 0.148958).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 12 cost time: 0.9134478569030762
Epoch: 12, Steps: 64 | Train Loss: 0.0816553 Vali Loss: 0.1515882 Test Loss: 0.1400766
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 13 cost time: 0.9229974746704102
Epoch: 13, Steps: 64 | Train Loss: 0.0810052 Vali Loss: 0.1478943 Test Loss: 0.1402182
Validation loss decreased (0.148958 --> 0.147894).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 14 cost time: 0.9116437435150146
Epoch: 14, Steps: 64 | Train Loss: 0.0803349 Vali Loss: 0.1484563 Test Loss: 0.1398878
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 15 cost time: 0.9084675312042236
Epoch: 15, Steps: 64 | Train Loss: 0.0803514 Vali Loss: 0.1464889 Test Loss: 0.1396628
Validation loss decreased (0.147894 --> 0.146489).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 16 cost time: 0.9004001617431641
Epoch: 16, Steps: 64 | Train Loss: 0.0796274 Vali Loss: 0.1475928 Test Loss: 0.1396625
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 17 cost time: 0.899451732635498
Epoch: 17, Steps: 64 | Train Loss: 0.0794318 Vali Loss: 0.1470486 Test Loss: 0.1394458
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 18 cost time: 0.9303550720214844
Epoch: 18, Steps: 64 | Train Loss: 0.0790232 Vali Loss: 0.1460055 Test Loss: 0.1396938
Validation loss decreased (0.146489 --> 0.146005).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 19 cost time: 0.9120297431945801
Epoch: 19, Steps: 64 | Train Loss: 0.0788010 Vali Loss: 0.1458736 Test Loss: 0.1397148
Validation loss decreased (0.146005 --> 0.145874).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 20 cost time: 0.920356035232544
Epoch: 20, Steps: 64 | Train Loss: 0.0785604 Vali Loss: 0.1476164 Test Loss: 0.1400848
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 21 cost time: 0.9136490821838379
Epoch: 21, Steps: 64 | Train Loss: 0.0781855 Vali Loss: 0.1462778 Test Loss: 0.1396699
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 22 cost time: 0.9154767990112305
Epoch: 22, Steps: 64 | Train Loss: 0.0780279 Vali Loss: 0.1448317 Test Loss: 0.1395537
Validation loss decreased (0.145874 --> 0.144832).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 23 cost time: 0.8884673118591309
Epoch: 23, Steps: 64 | Train Loss: 0.0778444 Vali Loss: 0.1468329 Test Loss: 0.1397082
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 24 cost time: 0.8823091983795166
Epoch: 24, Steps: 64 | Train Loss: 0.0778520 Vali Loss: 0.1462562 Test Loss: 0.1394555
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 25 cost time: 0.8954148292541504
Epoch: 25, Steps: 64 | Train Loss: 0.0776531 Vali Loss: 0.1472335 Test Loss: 0.1400556
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 26 cost time: 0.9003641605377197
Epoch: 26, Steps: 64 | Train Loss: 0.0772112 Vali Loss: 0.1454864 Test Loss: 0.1392522
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 27 cost time: 0.9030003547668457
Epoch: 27, Steps: 64 | Train Loss: 0.0771834 Vali Loss: 0.1459827 Test Loss: 0.1395391
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 28 cost time: 0.9036448001861572
Epoch: 28, Steps: 64 | Train Loss: 0.0771879 Vali Loss: 0.1451968 Test Loss: 0.1395776
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 29 cost time: 0.9074690341949463
Epoch: 29, Steps: 64 | Train Loss: 0.0768799 Vali Loss: 0.1457326 Test Loss: 0.1400692
EarlyStopping counter: 7 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 30 cost time: 0.891366720199585
Epoch: 30, Steps: 64 | Train Loss: 0.0772470 Vali Loss: 0.1434832 Test Loss: 0.1393150
Validation loss decreased (0.144832 --> 0.143483).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 31 cost time: 0.8853733539581299
Epoch: 31, Steps: 64 | Train Loss: 0.0768613 Vali Loss: 0.1436521 Test Loss: 0.1393758
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 32 cost time: 0.8947679996490479
Epoch: 32, Steps: 64 | Train Loss: 0.0767057 Vali Loss: 0.1451277 Test Loss: 0.1392736
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 33 cost time: 0.891394853591919
Epoch: 33, Steps: 64 | Train Loss: 0.0769112 Vali Loss: 0.1448109 Test Loss: 0.1393435
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 34 cost time: 0.9026503562927246
Epoch: 34, Steps: 64 | Train Loss: 0.0767541 Vali Loss: 0.1453426 Test Loss: 0.1397468
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 35 cost time: 0.9205582141876221
Epoch: 35, Steps: 64 | Train Loss: 0.0762893 Vali Loss: 0.1450565 Test Loss: 0.1398288
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 36 cost time: 0.9274020195007324
Epoch: 36, Steps: 64 | Train Loss: 0.0767408 Vali Loss: 0.1455187 Test Loss: 0.1392934
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 37 cost time: 0.9221806526184082
Epoch: 37, Steps: 64 | Train Loss: 0.0769357 Vali Loss: 0.1434076 Test Loss: 0.1393591
Validation loss decreased (0.143483 --> 0.143408).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 38 cost time: 0.9193990230560303
Epoch: 38, Steps: 64 | Train Loss: 0.0763997 Vali Loss: 0.1449978 Test Loss: 0.1393087
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 39 cost time: 0.9054689407348633
Epoch: 39, Steps: 64 | Train Loss: 0.0765521 Vali Loss: 0.1441054 Test Loss: 0.1394987
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 40 cost time: 0.8969998359680176
Epoch: 40, Steps: 64 | Train Loss: 0.0763152 Vali Loss: 0.1427903 Test Loss: 0.1392796
Validation loss decreased (0.143408 --> 0.142790).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 41 cost time: 0.8990590572357178
Epoch: 41, Steps: 64 | Train Loss: 0.0765799 Vali Loss: 0.1458178 Test Loss: 0.1394878
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 42 cost time: 0.8966464996337891
Epoch: 42, Steps: 64 | Train Loss: 0.0762863 Vali Loss: 0.1452173 Test Loss: 0.1397060
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 43 cost time: 0.9153833389282227
Epoch: 43, Steps: 64 | Train Loss: 0.0763248 Vali Loss: 0.1441808 Test Loss: 0.1395377
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 44 cost time: 0.9043591022491455
Epoch: 44, Steps: 64 | Train Loss: 0.0766751 Vali Loss: 0.1455090 Test Loss: 0.1397390
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 45 cost time: 0.8993914127349854
Epoch: 45, Steps: 64 | Train Loss: 0.0762753 Vali Loss: 0.1441347 Test Loss: 0.1391809
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 46 cost time: 0.9041910171508789
Epoch: 46, Steps: 64 | Train Loss: 0.0765236 Vali Loss: 0.1427916 Test Loss: 0.1392140
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 47 cost time: 0.921999454498291
Epoch: 47, Steps: 64 | Train Loss: 0.0762726 Vali Loss: 0.1434096 Test Loss: 0.1395439
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 48 cost time: 0.9086289405822754
Epoch: 48, Steps: 64 | Train Loss: 0.0764552 Vali Loss: 0.1440130 Test Loss: 0.1396580
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 49 cost time: 0.9144551753997803
Epoch: 49, Steps: 64 | Train Loss: 0.0762214 Vali Loss: 0.1442326 Test Loss: 0.1393462
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 50 cost time: 0.9098358154296875
Epoch: 50, Steps: 64 | Train Loss: 0.0764520 Vali Loss: 0.1444352 Test Loss: 0.1390357
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 51 cost time: 0.8844118118286133
Epoch: 51, Steps: 64 | Train Loss: 0.0762326 Vali Loss: 0.1447714 Test Loss: 0.1391683
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 52 cost time: 0.9003758430480957
Epoch: 52, Steps: 64 | Train Loss: 0.0766016 Vali Loss: 0.1445246 Test Loss: 0.1393698
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 53 cost time: 0.8960356712341309
Epoch: 53, Steps: 64 | Train Loss: 0.0766825 Vali Loss: 0.1442519 Test Loss: 0.1397031
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 54 cost time: 0.8930010795593262
Epoch: 54, Steps: 64 | Train Loss: 0.0763655 Vali Loss: 0.1449689 Test Loss: 0.1395893
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 55 cost time: 0.9126636981964111
Epoch: 55, Steps: 64 | Train Loss: 0.0759783 Vali Loss: 0.1442797 Test Loss: 0.1393950
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 56 cost time: 0.8983781337738037
Epoch: 56, Steps: 64 | Train Loss: 0.0759428 Vali Loss: 0.1455342 Test Loss: 0.1397158
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 57 cost time: 0.9003746509552002
Epoch: 57, Steps: 64 | Train Loss: 0.0764971 Vali Loss: 0.1427909 Test Loss: 0.1398700
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 58 cost time: 0.8933682441711426
Epoch: 58, Steps: 64 | Train Loss: 0.0762809 Vali Loss: 0.1448523 Test Loss: 0.1392710
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 59 cost time: 0.8911857604980469
Epoch: 59, Steps: 64 | Train Loss: 0.0761770 Vali Loss: 0.1427082 Test Loss: 0.1393686
Validation loss decreased (0.142790 --> 0.142708).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020069122314453125 GB
GPU已分配内存的峰值：0.06379127502441406 GB
Epoch: 60 cost time: 0.9069986343383789
Epoch: 60, Steps: 64 | Train Loss: 0.0760662 Vali Loss: 0.1447334 Test Loss: 0.1398231
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13936863839626312, mae:0.2764536142349243, rse:0.19870257377624512
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.06565284729003906 GB
Epoch: 1 cost time: 2.338106870651245
Epoch: 1, Steps: 64 | Train Loss: 0.7869353 Vali Loss: 1.8167483 Test Loss: 3.4581592
Validation loss decreased (inf --> 1.816748).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 2 cost time: 0.9452559947967529
Epoch: 2, Steps: 64 | Train Loss: 0.3303424 Vali Loss: 0.2503154 Test Loss: 0.2728018
Validation loss decreased (1.816748 --> 0.250315).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 3 cost time: 0.9498429298400879
Epoch: 3, Steps: 64 | Train Loss: 0.1063408 Vali Loss: 0.1792734 Test Loss: 0.1530574
Validation loss decreased (0.250315 --> 0.179273).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 4 cost time: 0.935617208480835
Epoch: 4, Steps: 64 | Train Loss: 0.0929428 Vali Loss: 0.1684294 Test Loss: 0.1457110
Validation loss decreased (0.179273 --> 0.168429).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 5 cost time: 0.9296135902404785
Epoch: 5, Steps: 64 | Train Loss: 0.0893125 Vali Loss: 0.1632606 Test Loss: 0.1408940
Validation loss decreased (0.168429 --> 0.163261).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 6 cost time: 0.9164044857025146
Epoch: 6, Steps: 64 | Train Loss: 0.0868828 Vali Loss: 0.1578621 Test Loss: 0.1387623
Validation loss decreased (0.163261 --> 0.157862).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 7 cost time: 0.9192636013031006
Epoch: 7, Steps: 64 | Train Loss: 0.0857475 Vali Loss: 0.1564121 Test Loss: 0.1380634
Validation loss decreased (0.157862 --> 0.156412).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 8 cost time: 0.9170370101928711
Epoch: 8, Steps: 64 | Train Loss: 0.0841345 Vali Loss: 0.1554478 Test Loss: 0.1370444
Validation loss decreased (0.156412 --> 0.155448).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 9 cost time: 0.9334051609039307
Epoch: 9, Steps: 64 | Train Loss: 0.0832497 Vali Loss: 0.1497598 Test Loss: 0.1368780
Validation loss decreased (0.155448 --> 0.149760).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 10 cost time: 0.9453635215759277
Epoch: 10, Steps: 64 | Train Loss: 0.0825435 Vali Loss: 0.1515634 Test Loss: 0.1363376
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 11 cost time: 0.9418606758117676
Epoch: 11, Steps: 64 | Train Loss: 0.0815047 Vali Loss: 0.1495797 Test Loss: 0.1364218
Validation loss decreased (0.149760 --> 0.149580).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 12 cost time: 0.946375846862793
Epoch: 12, Steps: 64 | Train Loss: 0.0810252 Vali Loss: 0.1494979 Test Loss: 0.1359471
Validation loss decreased (0.149580 --> 0.149498).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 13 cost time: 0.945000171661377
Epoch: 13, Steps: 64 | Train Loss: 0.0803273 Vali Loss: 0.1482342 Test Loss: 0.1361537
Validation loss decreased (0.149498 --> 0.148234).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 14 cost time: 0.9146411418914795
Epoch: 14, Steps: 64 | Train Loss: 0.0796138 Vali Loss: 0.1474781 Test Loss: 0.1359036
Validation loss decreased (0.148234 --> 0.147478).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 15 cost time: 0.931441068649292
Epoch: 15, Steps: 64 | Train Loss: 0.0793815 Vali Loss: 0.1487243 Test Loss: 0.1365918
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 16 cost time: 0.9320220947265625
Epoch: 16, Steps: 64 | Train Loss: 0.0790622 Vali Loss: 0.1476846 Test Loss: 0.1362072
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 17 cost time: 0.9353928565979004
Epoch: 17, Steps: 64 | Train Loss: 0.0788006 Vali Loss: 0.1443165 Test Loss: 0.1349957
Validation loss decreased (0.147478 --> 0.144316).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 18 cost time: 0.957489013671875
Epoch: 18, Steps: 64 | Train Loss: 0.0785988 Vali Loss: 0.1455090 Test Loss: 0.1359303
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 19 cost time: 0.9489431381225586
Epoch: 19, Steps: 64 | Train Loss: 0.0779135 Vali Loss: 0.1454464 Test Loss: 0.1357219
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 20 cost time: 0.9657361507415771
Epoch: 20, Steps: 64 | Train Loss: 0.0780020 Vali Loss: 0.1449097 Test Loss: 0.1358355
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 21 cost time: 0.9460000991821289
Epoch: 21, Steps: 64 | Train Loss: 0.0776151 Vali Loss: 0.1461720 Test Loss: 0.1350477
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 22 cost time: 0.9250006675720215
Epoch: 22, Steps: 64 | Train Loss: 0.0774315 Vali Loss: 0.1456340 Test Loss: 0.1353988
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 23 cost time: 0.9236183166503906
Epoch: 23, Steps: 64 | Train Loss: 0.0774950 Vali Loss: 0.1451396 Test Loss: 0.1359222
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 24 cost time: 0.9327652454376221
Epoch: 24, Steps: 64 | Train Loss: 0.0769824 Vali Loss: 0.1438090 Test Loss: 0.1345763
Validation loss decreased (0.144316 --> 0.143809).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 25 cost time: 0.9335248470306396
Epoch: 25, Steps: 64 | Train Loss: 0.0771691 Vali Loss: 0.1443357 Test Loss: 0.1348505
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 26 cost time: 0.9444541931152344
Epoch: 26, Steps: 64 | Train Loss: 0.0767030 Vali Loss: 0.1428994 Test Loss: 0.1348050
Validation loss decreased (0.143809 --> 0.142899).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 27 cost time: 0.9363992214202881
Epoch: 27, Steps: 64 | Train Loss: 0.0766456 Vali Loss: 0.1438387 Test Loss: 0.1346662
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 28 cost time: 0.9267241954803467
Epoch: 28, Steps: 64 | Train Loss: 0.0770592 Vali Loss: 0.1430984 Test Loss: 0.1352395
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 29 cost time: 0.9186336994171143
Epoch: 29, Steps: 64 | Train Loss: 0.0765462 Vali Loss: 0.1426133 Test Loss: 0.1346456
Validation loss decreased (0.142899 --> 0.142613).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 30 cost time: 0.9048094749450684
Epoch: 30, Steps: 64 | Train Loss: 0.0764359 Vali Loss: 0.1429470 Test Loss: 0.1349904
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 31 cost time: 0.8966419696807861
Epoch: 31, Steps: 64 | Train Loss: 0.0762028 Vali Loss: 0.1414275 Test Loss: 0.1348888
Validation loss decreased (0.142613 --> 0.141427).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 32 cost time: 0.9123737812042236
Epoch: 32, Steps: 64 | Train Loss: 0.0763562 Vali Loss: 0.1432872 Test Loss: 0.1352157
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 33 cost time: 0.9503824710845947
Epoch: 33, Steps: 64 | Train Loss: 0.0759913 Vali Loss: 0.1424709 Test Loss: 0.1350726
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 34 cost time: 0.961510181427002
Epoch: 34, Steps: 64 | Train Loss: 0.0763614 Vali Loss: 0.1425440 Test Loss: 0.1353049
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 35 cost time: 0.945385217666626
Epoch: 35, Steps: 64 | Train Loss: 0.0762287 Vali Loss: 0.1425200 Test Loss: 0.1344048
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 36 cost time: 0.9463908672332764
Epoch: 36, Steps: 64 | Train Loss: 0.0763899 Vali Loss: 0.1419532 Test Loss: 0.1346269
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 37 cost time: 0.9541149139404297
Epoch: 37, Steps: 64 | Train Loss: 0.0763063 Vali Loss: 0.1432794 Test Loss: 0.1350617
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 38 cost time: 0.937000036239624
Epoch: 38, Steps: 64 | Train Loss: 0.0761138 Vali Loss: 0.1409964 Test Loss: 0.1350052
Validation loss decreased (0.141427 --> 0.140996).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 39 cost time: 0.9396476745605469
Epoch: 39, Steps: 64 | Train Loss: 0.0761081 Vali Loss: 0.1434697 Test Loss: 0.1349086
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 40 cost time: 0.9306328296661377
Epoch: 40, Steps: 64 | Train Loss: 0.0759525 Vali Loss: 0.1446420 Test Loss: 0.1356853
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 41 cost time: 0.9410371780395508
Epoch: 41, Steps: 64 | Train Loss: 0.0764014 Vali Loss: 0.1420249 Test Loss: 0.1351769
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 42 cost time: 0.9523744583129883
Epoch: 42, Steps: 64 | Train Loss: 0.0757914 Vali Loss: 0.1426607 Test Loss: 0.1349617
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 43 cost time: 0.923396110534668
Epoch: 43, Steps: 64 | Train Loss: 0.0760250 Vali Loss: 0.1434252 Test Loss: 0.1346533
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 44 cost time: 0.938427209854126
Epoch: 44, Steps: 64 | Train Loss: 0.0761509 Vali Loss: 0.1425043 Test Loss: 0.1344130
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 45 cost time: 0.9247076511383057
Epoch: 45, Steps: 64 | Train Loss: 0.0758000 Vali Loss: 0.1411692 Test Loss: 0.1348406
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 46 cost time: 0.8980000019073486
Epoch: 46, Steps: 64 | Train Loss: 0.0758016 Vali Loss: 0.1426560 Test Loss: 0.1350124
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 47 cost time: 0.9046180248260498
Epoch: 47, Steps: 64 | Train Loss: 0.0756011 Vali Loss: 0.1433541 Test Loss: 0.1344958
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 48 cost time: 0.9186506271362305
Epoch: 48, Steps: 64 | Train Loss: 0.0759394 Vali Loss: 0.1423907 Test Loss: 0.1349422
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 49 cost time: 0.905360221862793
Epoch: 49, Steps: 64 | Train Loss: 0.0757939 Vali Loss: 0.1422712 Test Loss: 0.1349524
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 50 cost time: 0.9164361953735352
Epoch: 50, Steps: 64 | Train Loss: 0.0759555 Vali Loss: 0.1418514 Test Loss: 0.1346807
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 51 cost time: 0.9273819923400879
Epoch: 51, Steps: 64 | Train Loss: 0.0762652 Vali Loss: 0.1420436 Test Loss: 0.1349837
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 52 cost time: 0.9257786273956299
Epoch: 52, Steps: 64 | Train Loss: 0.0757684 Vali Loss: 0.1421960 Test Loss: 0.1351854
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 53 cost time: 0.9257240295410156
Epoch: 53, Steps: 64 | Train Loss: 0.0756650 Vali Loss: 0.1424116 Test Loss: 0.1349849
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 54 cost time: 0.9383728504180908
Epoch: 54, Steps: 64 | Train Loss: 0.0760235 Vali Loss: 0.1415306 Test Loss: 0.1348178
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 55 cost time: 0.9366388320922852
Epoch: 55, Steps: 64 | Train Loss: 0.0759668 Vali Loss: 0.1431074 Test Loss: 0.1350130
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 56 cost time: 0.9464192390441895
Epoch: 56, Steps: 64 | Train Loss: 0.0756543 Vali Loss: 0.1416914 Test Loss: 0.1349547
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 57 cost time: 0.9384546279907227
Epoch: 57, Steps: 64 | Train Loss: 0.0758769 Vali Loss: 0.1417845 Test Loss: 0.1349239
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 58 cost time: 0.9554316997528076
Epoch: 58, Steps: 64 | Train Loss: 0.0755267 Vali Loss: 0.1420343 Test Loss: 0.1351027
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 59 cost time: 0.9385452270507812
Epoch: 59, Steps: 64 | Train Loss: 0.0758423 Vali Loss: 0.1428801 Test Loss: 0.1351367
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021053314208984375 GB
GPU已分配内存的峰值：0.0675821304321289 GB
Epoch: 60 cost time: 0.9504432678222656
Epoch: 60, Steps: 64 | Train Loss: 0.0756702 Vali Loss: 0.1429091 Test Loss: 0.1345404
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13500525057315826, mae:0.2696894109249115, rse:0.19556733965873718
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.0581212043762207 GB
Epoch: 1 cost time: 2.2877461910247803
Epoch: 1, Steps: 64 | Train Loss: 0.9741762 Vali Loss: 2.1846917 Test Loss: 4.1351156
Validation loss decreased (inf --> 2.184692).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 2 cost time: 0.8650417327880859
Epoch: 2, Steps: 64 | Train Loss: 0.6778112 Vali Loss: 0.9331598 Test Loss: 1.5404507
Validation loss decreased (2.184692 --> 0.933160).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 3 cost time: 0.8653538227081299
Epoch: 3, Steps: 64 | Train Loss: 0.3418400 Vali Loss: 0.5361062 Test Loss: 0.7400058
Validation loss decreased (0.933160 --> 0.536106).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 4 cost time: 0.8649985790252686
Epoch: 4, Steps: 64 | Train Loss: 0.2122051 Vali Loss: 0.3612961 Test Loss: 0.4287463
Validation loss decreased (0.536106 --> 0.361296).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 5 cost time: 0.8486762046813965
Epoch: 5, Steps: 64 | Train Loss: 0.1574248 Vali Loss: 0.2804482 Test Loss: 0.2964886
Validation loss decreased (0.361296 --> 0.280448).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 6 cost time: 0.8424148559570312
Epoch: 6, Steps: 64 | Train Loss: 0.1320351 Vali Loss: 0.2361562 Test Loss: 0.2273422
Validation loss decreased (0.280448 --> 0.236156).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 7 cost time: 0.838407039642334
Epoch: 7, Steps: 64 | Train Loss: 0.1186722 Vali Loss: 0.2070626 Test Loss: 0.1887791
Validation loss decreased (0.236156 --> 0.207063).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 8 cost time: 0.8495442867279053
Epoch: 8, Steps: 64 | Train Loss: 0.1122102 Vali Loss: 0.1931339 Test Loss: 0.1726301
Validation loss decreased (0.207063 --> 0.193134).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 9 cost time: 0.841397762298584
Epoch: 9, Steps: 64 | Train Loss: 0.1074183 Vali Loss: 0.1841170 Test Loss: 0.1633277
Validation loss decreased (0.193134 --> 0.184117).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 10 cost time: 0.863605260848999
Epoch: 10, Steps: 64 | Train Loss: 0.1040786 Vali Loss: 0.1792248 Test Loss: 0.1567951
Validation loss decreased (0.184117 --> 0.179225).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 11 cost time: 0.865344762802124
Epoch: 11, Steps: 64 | Train Loss: 0.1026136 Vali Loss: 0.1750892 Test Loss: 0.1533969
Validation loss decreased (0.179225 --> 0.175089).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 12 cost time: 0.8831288814544678
Epoch: 12, Steps: 64 | Train Loss: 0.1009602 Vali Loss: 0.1715856 Test Loss: 0.1503099
Validation loss decreased (0.175089 --> 0.171586).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 13 cost time: 0.8823702335357666
Epoch: 13, Steps: 64 | Train Loss: 0.0984885 Vali Loss: 0.1669175 Test Loss: 0.1485364
Validation loss decreased (0.171586 --> 0.166917).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 14 cost time: 0.8687546253204346
Epoch: 14, Steps: 64 | Train Loss: 0.0983062 Vali Loss: 0.1646899 Test Loss: 0.1468107
Validation loss decreased (0.166917 --> 0.164690).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 15 cost time: 0.8710007667541504
Epoch: 15, Steps: 64 | Train Loss: 0.0971568 Vali Loss: 0.1646592 Test Loss: 0.1464802
Validation loss decreased (0.164690 --> 0.164659).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 16 cost time: 0.8630008697509766
Epoch: 16, Steps: 64 | Train Loss: 0.0966405 Vali Loss: 0.1635603 Test Loss: 0.1462409
Validation loss decreased (0.164659 --> 0.163560).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 17 cost time: 0.8694612979888916
Epoch: 17, Steps: 64 | Train Loss: 0.0958860 Vali Loss: 0.1622815 Test Loss: 0.1451841
Validation loss decreased (0.163560 --> 0.162282).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 18 cost time: 0.8683719635009766
Epoch: 18, Steps: 64 | Train Loss: 0.0946709 Vali Loss: 0.1618249 Test Loss: 0.1442773
Validation loss decreased (0.162282 --> 0.161825).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 19 cost time: 0.893545389175415
Epoch: 19, Steps: 64 | Train Loss: 0.0943537 Vali Loss: 0.1609385 Test Loss: 0.1438172
Validation loss decreased (0.161825 --> 0.160938).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 20 cost time: 0.8847579956054688
Epoch: 20, Steps: 64 | Train Loss: 0.0938521 Vali Loss: 0.1605133 Test Loss: 0.1440994
Validation loss decreased (0.160938 --> 0.160513).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 21 cost time: 0.885998010635376
Epoch: 21, Steps: 64 | Train Loss: 0.0936186 Vali Loss: 0.1590787 Test Loss: 0.1430211
Validation loss decreased (0.160513 --> 0.159079).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 22 cost time: 0.8776414394378662
Epoch: 22, Steps: 64 | Train Loss: 0.0936663 Vali Loss: 0.1587029 Test Loss: 0.1437086
Validation loss decreased (0.159079 --> 0.158703).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 23 cost time: 0.86737060546875
Epoch: 23, Steps: 64 | Train Loss: 0.0932197 Vali Loss: 0.1596994 Test Loss: 0.1435807
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 24 cost time: 0.8393964767456055
Epoch: 24, Steps: 64 | Train Loss: 0.0928326 Vali Loss: 0.1571867 Test Loss: 0.1429469
Validation loss decreased (0.158703 --> 0.157187).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 25 cost time: 0.8422644138336182
Epoch: 25, Steps: 64 | Train Loss: 0.0926270 Vali Loss: 0.1567284 Test Loss: 0.1427367
Validation loss decreased (0.157187 --> 0.156728).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 26 cost time: 0.8379993438720703
Epoch: 26, Steps: 64 | Train Loss: 0.0920732 Vali Loss: 0.1559500 Test Loss: 0.1423579
Validation loss decreased (0.156728 --> 0.155950).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 27 cost time: 0.8466396331787109
Epoch: 27, Steps: 64 | Train Loss: 0.0920548 Vali Loss: 0.1554812 Test Loss: 0.1425212
Validation loss decreased (0.155950 --> 0.155481).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 28 cost time: 0.867422342300415
Epoch: 28, Steps: 64 | Train Loss: 0.0915997 Vali Loss: 0.1583046 Test Loss: 0.1424488
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 29 cost time: 0.8641581535339355
Epoch: 29, Steps: 64 | Train Loss: 0.0915263 Vali Loss: 0.1561050 Test Loss: 0.1431277
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 30 cost time: 0.8744702339172363
Epoch: 30, Steps: 64 | Train Loss: 0.0910678 Vali Loss: 0.1569557 Test Loss: 0.1427623
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 31 cost time: 0.8259983062744141
Epoch: 31, Steps: 64 | Train Loss: 0.0913045 Vali Loss: 0.1567325 Test Loss: 0.1423833
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 32 cost time: 0.8756625652313232
Epoch: 32, Steps: 64 | Train Loss: 0.0908328 Vali Loss: 0.1562289 Test Loss: 0.1422344
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 33 cost time: 0.8744049072265625
Epoch: 33, Steps: 64 | Train Loss: 0.0908976 Vali Loss: 0.1549089 Test Loss: 0.1421387
Validation loss decreased (0.155481 --> 0.154909).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 34 cost time: 0.8624730110168457
Epoch: 34, Steps: 64 | Train Loss: 0.0904211 Vali Loss: 0.1563379 Test Loss: 0.1425833
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 35 cost time: 0.8647456169128418
Epoch: 35, Steps: 64 | Train Loss: 0.0901691 Vali Loss: 0.1551292 Test Loss: 0.1422248
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 36 cost time: 0.8737952709197998
Epoch: 36, Steps: 64 | Train Loss: 0.0905248 Vali Loss: 0.1572265 Test Loss: 0.1421893
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 37 cost time: 0.8779993057250977
Epoch: 37, Steps: 64 | Train Loss: 0.0907718 Vali Loss: 0.1558742 Test Loss: 0.1421545
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 38 cost time: 0.8903250694274902
Epoch: 38, Steps: 64 | Train Loss: 0.0904381 Vali Loss: 0.1547743 Test Loss: 0.1418934
Validation loss decreased (0.154909 --> 0.154774).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 39 cost time: 0.8864884376525879
Epoch: 39, Steps: 64 | Train Loss: 0.0901308 Vali Loss: 0.1555957 Test Loss: 0.1416752
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 40 cost time: 0.8825089931488037
Epoch: 40, Steps: 64 | Train Loss: 0.0897729 Vali Loss: 0.1556290 Test Loss: 0.1420157
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 41 cost time: 0.888418436050415
Epoch: 41, Steps: 64 | Train Loss: 0.0903318 Vali Loss: 0.1559737 Test Loss: 0.1418033
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 42 cost time: 0.8637216091156006
Epoch: 42, Steps: 64 | Train Loss: 0.0901037 Vali Loss: 0.1550161 Test Loss: 0.1419960
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 43 cost time: 0.8674314022064209
Epoch: 43, Steps: 64 | Train Loss: 0.0903270 Vali Loss: 0.1547518 Test Loss: 0.1418691
Validation loss decreased (0.154774 --> 0.154752).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 44 cost time: 0.8673660755157471
Epoch: 44, Steps: 64 | Train Loss: 0.0900259 Vali Loss: 0.1537249 Test Loss: 0.1418639
Validation loss decreased (0.154752 --> 0.153725).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 45 cost time: 0.87337327003479
Epoch: 45, Steps: 64 | Train Loss: 0.0900997 Vali Loss: 0.1554907 Test Loss: 0.1422194
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 46 cost time: 0.8774783611297607
Epoch: 46, Steps: 64 | Train Loss: 0.0901473 Vali Loss: 0.1544674 Test Loss: 0.1414983
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 47 cost time: 0.880852460861206
Epoch: 47, Steps: 64 | Train Loss: 0.0897488 Vali Loss: 0.1560937 Test Loss: 0.1416027
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 48 cost time: 0.8670005798339844
Epoch: 48, Steps: 64 | Train Loss: 0.0897684 Vali Loss: 0.1545271 Test Loss: 0.1420203
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 49 cost time: 0.8496387004852295
Epoch: 49, Steps: 64 | Train Loss: 0.0892814 Vali Loss: 0.1544759 Test Loss: 0.1417906
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 50 cost time: 0.8504080772399902
Epoch: 50, Steps: 64 | Train Loss: 0.0900472 Vali Loss: 0.1550899 Test Loss: 0.1415640
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 51 cost time: 0.8888561725616455
Epoch: 51, Steps: 64 | Train Loss: 0.0896120 Vali Loss: 0.1526347 Test Loss: 0.1414205
Validation loss decreased (0.153725 --> 0.152635).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 52 cost time: 0.8635408878326416
Epoch: 52, Steps: 64 | Train Loss: 0.0901710 Vali Loss: 0.1561945 Test Loss: 0.1421542
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 53 cost time: 0.8486812114715576
Epoch: 53, Steps: 64 | Train Loss: 0.0898123 Vali Loss: 0.1555109 Test Loss: 0.1415987
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 54 cost time: 0.8559989929199219
Epoch: 54, Steps: 64 | Train Loss: 0.0898965 Vali Loss: 0.1551967 Test Loss: 0.1414503
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 55 cost time: 0.8782742023468018
Epoch: 55, Steps: 64 | Train Loss: 0.0894919 Vali Loss: 0.1559031 Test Loss: 0.1420930
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 56 cost time: 0.8828299045562744
Epoch: 56, Steps: 64 | Train Loss: 0.0897904 Vali Loss: 0.1545750 Test Loss: 0.1420387
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 57 cost time: 0.8843815326690674
Epoch: 57, Steps: 64 | Train Loss: 0.0899777 Vali Loss: 0.1547287 Test Loss: 0.1417753
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 58 cost time: 0.8882977962493896
Epoch: 58, Steps: 64 | Train Loss: 0.0897773 Vali Loss: 0.1555888 Test Loss: 0.1424159
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 59 cost time: 0.8950023651123047
Epoch: 59, Steps: 64 | Train Loss: 0.0895568 Vali Loss: 0.1544735 Test Loss: 0.1413825
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018121719360351562 GB
GPU已分配内存的峰值：0.05858469009399414 GB
Epoch: 60 cost time: 0.8706634044647217
Epoch: 60, Steps: 64 | Train Loss: 0.0899473 Vali Loss: 0.1541962 Test Loss: 0.1419476
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14142049849033356, mae:0.27582427859306335, rse:0.2001599371433258
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.0625157356262207 GB
Epoch: 1 cost time: 2.2959139347076416
Epoch: 1, Steps: 64 | Train Loss: 0.7501378 Vali Loss: 1.7029760 Test Loss: 3.2004652
Validation loss decreased (inf --> 1.702976).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 2 cost time: 0.9196412563323975
Epoch: 2, Steps: 64 | Train Loss: 0.3192406 Vali Loss: 0.1992309 Test Loss: 0.1654139
Validation loss decreased (1.702976 --> 0.199231).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 3 cost time: 0.921644926071167
Epoch: 3, Steps: 64 | Train Loss: 0.1019983 Vali Loss: 0.1749238 Test Loss: 0.1454910
Validation loss decreased (0.199231 --> 0.174924).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 4 cost time: 0.9104287624359131
Epoch: 4, Steps: 64 | Train Loss: 0.0923975 Vali Loss: 0.1665245 Test Loss: 0.1376688
Validation loss decreased (0.174924 --> 0.166525).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 5 cost time: 0.8899960517883301
Epoch: 5, Steps: 64 | Train Loss: 0.0885436 Vali Loss: 0.1637367 Test Loss: 0.1371758
Validation loss decreased (0.166525 --> 0.163737).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 6 cost time: 0.8983943462371826
Epoch: 6, Steps: 64 | Train Loss: 0.0869638 Vali Loss: 0.1591773 Test Loss: 0.1354657
Validation loss decreased (0.163737 --> 0.159177).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 7 cost time: 0.9011232852935791
Epoch: 7, Steps: 64 | Train Loss: 0.0852752 Vali Loss: 0.1581391 Test Loss: 0.1356312
Validation loss decreased (0.159177 --> 0.158139).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 8 cost time: 0.8960015773773193
Epoch: 8, Steps: 64 | Train Loss: 0.0841734 Vali Loss: 0.1550454 Test Loss: 0.1353457
Validation loss decreased (0.158139 --> 0.155045).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 9 cost time: 0.9099981784820557
Epoch: 9, Steps: 64 | Train Loss: 0.0828092 Vali Loss: 0.1550798 Test Loss: 0.1348274
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 10 cost time: 0.9106407165527344
Epoch: 10, Steps: 64 | Train Loss: 0.0822432 Vali Loss: 0.1527831 Test Loss: 0.1343936
Validation loss decreased (0.155045 --> 0.152783).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 11 cost time: 0.9174952507019043
Epoch: 11, Steps: 64 | Train Loss: 0.0815147 Vali Loss: 0.1517290 Test Loss: 0.1346234
Validation loss decreased (0.152783 --> 0.151729).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 12 cost time: 0.9244370460510254
Epoch: 12, Steps: 64 | Train Loss: 0.0810523 Vali Loss: 0.1528609 Test Loss: 0.1348192
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 13 cost time: 0.9045791625976562
Epoch: 13, Steps: 64 | Train Loss: 0.0800374 Vali Loss: 0.1503319 Test Loss: 0.1335477
Validation loss decreased (0.151729 --> 0.150332).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 14 cost time: 0.9108109474182129
Epoch: 14, Steps: 64 | Train Loss: 0.0796400 Vali Loss: 0.1491927 Test Loss: 0.1334246
Validation loss decreased (0.150332 --> 0.149193).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 15 cost time: 0.9128708839416504
Epoch: 15, Steps: 64 | Train Loss: 0.0790755 Vali Loss: 0.1488546 Test Loss: 0.1340280
Validation loss decreased (0.149193 --> 0.148855).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 16 cost time: 0.9180002212524414
Epoch: 16, Steps: 64 | Train Loss: 0.0793538 Vali Loss: 0.1482635 Test Loss: 0.1335168
Validation loss decreased (0.148855 --> 0.148264).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 17 cost time: 0.9166383743286133
Epoch: 17, Steps: 64 | Train Loss: 0.0789369 Vali Loss: 0.1506898 Test Loss: 0.1343779
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 18 cost time: 0.9228827953338623
Epoch: 18, Steps: 64 | Train Loss: 0.0782317 Vali Loss: 0.1482288 Test Loss: 0.1335804
Validation loss decreased (0.148264 --> 0.148229).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 19 cost time: 0.9277479648590088
Epoch: 19, Steps: 64 | Train Loss: 0.0778562 Vali Loss: 0.1454220 Test Loss: 0.1333679
Validation loss decreased (0.148229 --> 0.145422).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 20 cost time: 0.9115691184997559
Epoch: 20, Steps: 64 | Train Loss: 0.0783533 Vali Loss: 0.1478042 Test Loss: 0.1331969
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 21 cost time: 0.9264073371887207
Epoch: 21, Steps: 64 | Train Loss: 0.0777106 Vali Loss: 0.1453516 Test Loss: 0.1334814
Validation loss decreased (0.145422 --> 0.145352).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 22 cost time: 0.9067761898040771
Epoch: 22, Steps: 64 | Train Loss: 0.0776677 Vali Loss: 0.1449136 Test Loss: 0.1331380
Validation loss decreased (0.145352 --> 0.144914).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 23 cost time: 0.9067764282226562
Epoch: 23, Steps: 64 | Train Loss: 0.0777147 Vali Loss: 0.1438410 Test Loss: 0.1337654
Validation loss decreased (0.144914 --> 0.143841).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 24 cost time: 0.9057552814483643
Epoch: 24, Steps: 64 | Train Loss: 0.0770433 Vali Loss: 0.1428150 Test Loss: 0.1330024
Validation loss decreased (0.143841 --> 0.142815).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 25 cost time: 0.8936357498168945
Epoch: 25, Steps: 64 | Train Loss: 0.0768513 Vali Loss: 0.1439485 Test Loss: 0.1328331
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 26 cost time: 0.906883716583252
Epoch: 26, Steps: 64 | Train Loss: 0.0772063 Vali Loss: 0.1446273 Test Loss: 0.1323103
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 27 cost time: 0.916834831237793
Epoch: 27, Steps: 64 | Train Loss: 0.0766807 Vali Loss: 0.1446980 Test Loss: 0.1327947
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 28 cost time: 0.9054245948791504
Epoch: 28, Steps: 64 | Train Loss: 0.0770849 Vali Loss: 0.1435943 Test Loss: 0.1323338
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 29 cost time: 0.9140441417694092
Epoch: 29, Steps: 64 | Train Loss: 0.0766413 Vali Loss: 0.1437266 Test Loss: 0.1321970
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 30 cost time: 0.8967926502227783
Epoch: 30, Steps: 64 | Train Loss: 0.0763299 Vali Loss: 0.1453703 Test Loss: 0.1331045
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 31 cost time: 0.9213907718658447
Epoch: 31, Steps: 64 | Train Loss: 0.0764142 Vali Loss: 0.1439458 Test Loss: 0.1322983
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 32 cost time: 0.918623685836792
Epoch: 32, Steps: 64 | Train Loss: 0.0760616 Vali Loss: 0.1420043 Test Loss: 0.1323479
Validation loss decreased (0.142815 --> 0.142004).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 33 cost time: 0.914487361907959
Epoch: 33, Steps: 64 | Train Loss: 0.0763218 Vali Loss: 0.1433969 Test Loss: 0.1323795
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 34 cost time: 0.9263925552368164
Epoch: 34, Steps: 64 | Train Loss: 0.0762183 Vali Loss: 0.1428826 Test Loss: 0.1324564
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 35 cost time: 0.9285697937011719
Epoch: 35, Steps: 64 | Train Loss: 0.0762060 Vali Loss: 0.1426758 Test Loss: 0.1324858
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 36 cost time: 0.9264206886291504
Epoch: 36, Steps: 64 | Train Loss: 0.0761060 Vali Loss: 0.1429925 Test Loss: 0.1323129
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 37 cost time: 0.9357199668884277
Epoch: 37, Steps: 64 | Train Loss: 0.0765441 Vali Loss: 0.1426469 Test Loss: 0.1325081
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 38 cost time: 0.9219977855682373
Epoch: 38, Steps: 64 | Train Loss: 0.0761774 Vali Loss: 0.1409692 Test Loss: 0.1318916
Validation loss decreased (0.142004 --> 0.140969).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 39 cost time: 0.9208254814147949
Epoch: 39, Steps: 64 | Train Loss: 0.0761243 Vali Loss: 0.1419319 Test Loss: 0.1320486
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 40 cost time: 0.9166367053985596
Epoch: 40, Steps: 64 | Train Loss: 0.0761452 Vali Loss: 0.1419899 Test Loss: 0.1322948
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 41 cost time: 0.9132382869720459
Epoch: 41, Steps: 64 | Train Loss: 0.0760213 Vali Loss: 0.1400061 Test Loss: 0.1321194
Validation loss decreased (0.140969 --> 0.140006).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 42 cost time: 0.9094541072845459
Epoch: 42, Steps: 64 | Train Loss: 0.0757038 Vali Loss: 0.1416008 Test Loss: 0.1321459
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 43 cost time: 0.9254121780395508
Epoch: 43, Steps: 64 | Train Loss: 0.0762141 Vali Loss: 0.1419044 Test Loss: 0.1318559
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 44 cost time: 0.9090449810028076
Epoch: 44, Steps: 64 | Train Loss: 0.0759993 Vali Loss: 0.1423599 Test Loss: 0.1325993
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 45 cost time: 0.9007549285888672
Epoch: 45, Steps: 64 | Train Loss: 0.0760180 Vali Loss: 0.1410815 Test Loss: 0.1323883
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 46 cost time: 0.9109981060028076
Epoch: 46, Steps: 64 | Train Loss: 0.0759217 Vali Loss: 0.1423558 Test Loss: 0.1318797
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 47 cost time: 0.896636962890625
Epoch: 47, Steps: 64 | Train Loss: 0.0758071 Vali Loss: 0.1407420 Test Loss: 0.1315465
EarlyStopping counter: 6 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 48 cost time: 0.9020133018493652
Epoch: 48, Steps: 64 | Train Loss: 0.0755657 Vali Loss: 0.1419683 Test Loss: 0.1322909
EarlyStopping counter: 7 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 49 cost time: 0.8944368362426758
Epoch: 49, Steps: 64 | Train Loss: 0.0757399 Vali Loss: 0.1424367 Test Loss: 0.1327545
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 50 cost time: 0.8980467319488525
Epoch: 50, Steps: 64 | Train Loss: 0.0756832 Vali Loss: 0.1430930 Test Loss: 0.1321413
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 51 cost time: 0.9057333469390869
Epoch: 51, Steps: 64 | Train Loss: 0.0758600 Vali Loss: 0.1417654 Test Loss: 0.1316859
EarlyStopping counter: 10 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 52 cost time: 0.9074070453643799
Epoch: 52, Steps: 64 | Train Loss: 0.0759120 Vali Loss: 0.1419965 Test Loss: 0.1319104
EarlyStopping counter: 11 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 53 cost time: 0.9020006656646729
Epoch: 53, Steps: 64 | Train Loss: 0.0760496 Vali Loss: 0.1411884 Test Loss: 0.1320831
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 54 cost time: 0.9066197872161865
Epoch: 54, Steps: 64 | Train Loss: 0.0758448 Vali Loss: 0.1416587 Test Loss: 0.1320212
EarlyStopping counter: 13 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 55 cost time: 0.9183647632598877
Epoch: 55, Steps: 64 | Train Loss: 0.0756738 Vali Loss: 0.1412931 Test Loss: 0.1324107
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 56 cost time: 0.9306900501251221
Epoch: 56, Steps: 64 | Train Loss: 0.0760822 Vali Loss: 0.1409127 Test Loss: 0.1322972
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 57 cost time: 0.9440195560455322
Epoch: 57, Steps: 64 | Train Loss: 0.0756027 Vali Loss: 0.1414228 Test Loss: 0.1321004
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 58 cost time: 0.9076125621795654
Epoch: 58, Steps: 64 | Train Loss: 0.0757149 Vali Loss: 0.1424595 Test Loss: 0.1324215
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 59 cost time: 0.9170007705688477
Epoch: 59, Steps: 64 | Train Loss: 0.0759892 Vali Loss: 0.1417108 Test Loss: 0.1322349
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020074844360351562 GB
GPU已分配内存的峰值：0.06395578384399414 GB
Epoch: 60 cost time: 0.9216432571411133
Epoch: 60, Steps: 64 | Train Loss: 0.0755351 Vali Loss: 0.1413837 Test Loss: 0.1319644
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13211946189403534, mae:0.26121819019317627, rse:0.19346587359905243
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06581449508666992 GB
Epoch: 1 cost time: 2.341487407684326
Epoch: 1, Steps: 64 | Train Loss: 0.7623749 Vali Loss: 1.7627484 Test Loss: 3.3294652
Validation loss decreased (inf --> 1.762748).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 2 cost time: 0.9374840259552002
Epoch: 2, Steps: 64 | Train Loss: 0.2956477 Vali Loss: 0.2214610 Test Loss: 0.2533556
Validation loss decreased (1.762748 --> 0.221461).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 3 cost time: 0.9370005130767822
Epoch: 3, Steps: 64 | Train Loss: 0.0986503 Vali Loss: 0.1706280 Test Loss: 0.1407449
Validation loss decreased (0.221461 --> 0.170628).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 4 cost time: 0.9495158195495605
Epoch: 4, Steps: 64 | Train Loss: 0.0891403 Vali Loss: 0.1649139 Test Loss: 0.1409651
Validation loss decreased (0.170628 --> 0.164914).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 5 cost time: 0.9206085205078125
Epoch: 5, Steps: 64 | Train Loss: 0.0863608 Vali Loss: 0.1587068 Test Loss: 0.1342997
Validation loss decreased (0.164914 --> 0.158707).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 6 cost time: 0.924464225769043
Epoch: 6, Steps: 64 | Train Loss: 0.0848033 Vali Loss: 0.1575773 Test Loss: 0.1356030
Validation loss decreased (0.158707 --> 0.157577).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 7 cost time: 0.9233813285827637
Epoch: 7, Steps: 64 | Train Loss: 0.0828129 Vali Loss: 0.1553953 Test Loss: 0.1355325
Validation loss decreased (0.157577 --> 0.155395).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 8 cost time: 0.9313621520996094
Epoch: 8, Steps: 64 | Train Loss: 0.0815410 Vali Loss: 0.1513985 Test Loss: 0.1343434
Validation loss decreased (0.155395 --> 0.151398).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 9 cost time: 0.9503719806671143
Epoch: 9, Steps: 64 | Train Loss: 0.0805535 Vali Loss: 0.1489433 Test Loss: 0.1340764
Validation loss decreased (0.151398 --> 0.148943).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 10 cost time: 0.9457311630249023
Epoch: 10, Steps: 64 | Train Loss: 0.0800059 Vali Loss: 0.1490267 Test Loss: 0.1320000
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 11 cost time: 0.9497487545013428
Epoch: 11, Steps: 64 | Train Loss: 0.0788652 Vali Loss: 0.1452768 Test Loss: 0.1322791
Validation loss decreased (0.148943 --> 0.145277).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 12 cost time: 0.9587349891662598
Epoch: 12, Steps: 64 | Train Loss: 0.0790609 Vali Loss: 0.1447569 Test Loss: 0.1327844
Validation loss decreased (0.145277 --> 0.144757).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 13 cost time: 0.937626838684082
Epoch: 13, Steps: 64 | Train Loss: 0.0780680 Vali Loss: 0.1410714 Test Loss: 0.1310018
Validation loss decreased (0.144757 --> 0.141071).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 14 cost time: 0.9450552463531494
Epoch: 14, Steps: 64 | Train Loss: 0.0775925 Vali Loss: 0.1414908 Test Loss: 0.1308290
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 15 cost time: 0.9394102096557617
Epoch: 15, Steps: 64 | Train Loss: 0.0773334 Vali Loss: 0.1425359 Test Loss: 0.1314933
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 16 cost time: 0.9373431205749512
Epoch: 16, Steps: 64 | Train Loss: 0.0766706 Vali Loss: 0.1404177 Test Loss: 0.1311074
Validation loss decreased (0.141071 --> 0.140418).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 17 cost time: 0.9543910026550293
Epoch: 17, Steps: 64 | Train Loss: 0.0763856 Vali Loss: 0.1392794 Test Loss: 0.1301908
Validation loss decreased (0.140418 --> 0.139279).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 18 cost time: 0.9694507122039795
Epoch: 18, Steps: 64 | Train Loss: 0.0766512 Vali Loss: 0.1379985 Test Loss: 0.1304882
Validation loss decreased (0.139279 --> 0.137999).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 19 cost time: 0.9593589305877686
Epoch: 19, Steps: 64 | Train Loss: 0.0762035 Vali Loss: 0.1396839 Test Loss: 0.1304766
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 20 cost time: 0.9593276977539062
Epoch: 20, Steps: 64 | Train Loss: 0.0758813 Vali Loss: 0.1380735 Test Loss: 0.1293482
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 21 cost time: 0.9537703990936279
Epoch: 21, Steps: 64 | Train Loss: 0.0759239 Vali Loss: 0.1379974 Test Loss: 0.1295859
Validation loss decreased (0.137999 --> 0.137997).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 22 cost time: 0.9244201183319092
Epoch: 22, Steps: 64 | Train Loss: 0.0756367 Vali Loss: 0.1360259 Test Loss: 0.1288404
Validation loss decreased (0.137997 --> 0.136026).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 23 cost time: 0.9190001487731934
Epoch: 23, Steps: 64 | Train Loss: 0.0754328 Vali Loss: 0.1381419 Test Loss: 0.1296555
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 24 cost time: 0.9316527843475342
Epoch: 24, Steps: 64 | Train Loss: 0.0751222 Vali Loss: 0.1368747 Test Loss: 0.1288568
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 25 cost time: 0.9343509674072266
Epoch: 25, Steps: 64 | Train Loss: 0.0752201 Vali Loss: 0.1373942 Test Loss: 0.1289521
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 26 cost time: 0.9417610168457031
Epoch: 26, Steps: 64 | Train Loss: 0.0750823 Vali Loss: 0.1380710 Test Loss: 0.1288075
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 27 cost time: 0.9433372020721436
Epoch: 27, Steps: 64 | Train Loss: 0.0749435 Vali Loss: 0.1374668 Test Loss: 0.1297860
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 28 cost time: 0.9213681221008301
Epoch: 28, Steps: 64 | Train Loss: 0.0751662 Vali Loss: 0.1369611 Test Loss: 0.1283601
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 29 cost time: 0.9235055446624756
Epoch: 29, Steps: 64 | Train Loss: 0.0746706 Vali Loss: 0.1353677 Test Loss: 0.1288583
Validation loss decreased (0.136026 --> 0.135368).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 30 cost time: 0.9297418594360352
Epoch: 30, Steps: 64 | Train Loss: 0.0746176 Vali Loss: 0.1365609 Test Loss: 0.1288721
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 31 cost time: 0.9294826984405518
Epoch: 31, Steps: 64 | Train Loss: 0.0749141 Vali Loss: 0.1351919 Test Loss: 0.1283621
Validation loss decreased (0.135368 --> 0.135192).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 32 cost time: 0.9276456832885742
Epoch: 32, Steps: 64 | Train Loss: 0.0744216 Vali Loss: 0.1358251 Test Loss: 0.1287866
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 33 cost time: 0.9566550254821777
Epoch: 33, Steps: 64 | Train Loss: 0.0747095 Vali Loss: 0.1355226 Test Loss: 0.1280048
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 34 cost time: 0.9563565254211426
Epoch: 34, Steps: 64 | Train Loss: 0.0742495 Vali Loss: 0.1361774 Test Loss: 0.1291339
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 35 cost time: 0.9650287628173828
Epoch: 35, Steps: 64 | Train Loss: 0.0743541 Vali Loss: 0.1351273 Test Loss: 0.1283921
Validation loss decreased (0.135192 --> 0.135127).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 36 cost time: 0.9528818130493164
Epoch: 36, Steps: 64 | Train Loss: 0.0744406 Vali Loss: 0.1348520 Test Loss: 0.1289423
Validation loss decreased (0.135127 --> 0.134852).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 37 cost time: 0.9594829082489014
Epoch: 37, Steps: 64 | Train Loss: 0.0740714 Vali Loss: 0.1369332 Test Loss: 0.1289176
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 38 cost time: 0.969449520111084
Epoch: 38, Steps: 64 | Train Loss: 0.0741399 Vali Loss: 0.1360366 Test Loss: 0.1282585
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 39 cost time: 0.9384274482727051
Epoch: 39, Steps: 64 | Train Loss: 0.0744019 Vali Loss: 0.1354283 Test Loss: 0.1282865
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 40 cost time: 0.9457311630249023
Epoch: 40, Steps: 64 | Train Loss: 0.0741388 Vali Loss: 0.1347723 Test Loss: 0.1275396
Validation loss decreased (0.134852 --> 0.134772).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 41 cost time: 0.9609999656677246
Epoch: 41, Steps: 64 | Train Loss: 0.0742662 Vali Loss: 0.1353760 Test Loss: 0.1285499
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 42 cost time: 0.966616153717041
Epoch: 42, Steps: 64 | Train Loss: 0.0741026 Vali Loss: 0.1364534 Test Loss: 0.1285647
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 43 cost time: 0.9566621780395508
Epoch: 43, Steps: 64 | Train Loss: 0.0744096 Vali Loss: 0.1353480 Test Loss: 0.1279120
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 44 cost time: 0.9574198722839355
Epoch: 44, Steps: 64 | Train Loss: 0.0740566 Vali Loss: 0.1361228 Test Loss: 0.1286435
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 45 cost time: 0.923377275466919
Epoch: 45, Steps: 64 | Train Loss: 0.0741211 Vali Loss: 0.1358279 Test Loss: 0.1291004
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 46 cost time: 0.9234633445739746
Epoch: 46, Steps: 64 | Train Loss: 0.0742303 Vali Loss: 0.1357616 Test Loss: 0.1287246
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 47 cost time: 0.9327256679534912
Epoch: 47, Steps: 64 | Train Loss: 0.0741317 Vali Loss: 0.1364721 Test Loss: 0.1287661
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 48 cost time: 0.9370026588439941
Epoch: 48, Steps: 64 | Train Loss: 0.0739854 Vali Loss: 0.1349504 Test Loss: 0.1283596
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 49 cost time: 0.9347970485687256
Epoch: 49, Steps: 64 | Train Loss: 0.0739510 Vali Loss: 0.1370604 Test Loss: 0.1286996
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 50 cost time: 0.940997838973999
Epoch: 50, Steps: 64 | Train Loss: 0.0738073 Vali Loss: 0.1361700 Test Loss: 0.1281832
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 51 cost time: 0.9454007148742676
Epoch: 51, Steps: 64 | Train Loss: 0.0741405 Vali Loss: 0.1360100 Test Loss: 0.1281788
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 52 cost time: 0.944627046585083
Epoch: 52, Steps: 64 | Train Loss: 0.0739126 Vali Loss: 0.1364906 Test Loss: 0.1285122
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 53 cost time: 0.9355430603027344
Epoch: 53, Steps: 64 | Train Loss: 0.0737156 Vali Loss: 0.1352821 Test Loss: 0.1278121
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 54 cost time: 0.9404747486114502
Epoch: 54, Steps: 64 | Train Loss: 0.0739512 Vali Loss: 0.1364112 Test Loss: 0.1282585
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 55 cost time: 0.9465019702911377
Epoch: 55, Steps: 64 | Train Loss: 0.0738154 Vali Loss: 0.1337978 Test Loss: 0.1282171
Validation loss decreased (0.134772 --> 0.133798).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 56 cost time: 0.9423904418945312
Epoch: 56, Steps: 64 | Train Loss: 0.0739704 Vali Loss: 0.1340986 Test Loss: 0.1297129
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 57 cost time: 0.9424006938934326
Epoch: 57, Steps: 64 | Train Loss: 0.0742098 Vali Loss: 0.1348105 Test Loss: 0.1283630
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 58 cost time: 0.961756706237793
Epoch: 58, Steps: 64 | Train Loss: 0.0740126 Vali Loss: 0.1344340 Test Loss: 0.1283188
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 59 cost time: 0.9624221324920654
Epoch: 59, Steps: 64 | Train Loss: 0.0736746 Vali Loss: 0.1346153 Test Loss: 0.1286320
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021059036254882812 GB
GPU已分配内存的峰值：0.06774663925170898 GB
Epoch: 60 cost time: 0.9529991149902344
Epoch: 60, Steps: 64 | Train Loss: 0.0740622 Vali Loss: 0.1363574 Test Loss: 0.1291462
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.12821713089942932, mae:0.2554680407047272, rse:0.19058732688426971
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.058283329010009766 GB
Epoch: 1 cost time: 2.277719497680664
Epoch: 1, Steps: 64 | Train Loss: 0.8077200 Vali Loss: 1.7828115 Test Loss: 3.3837857
Validation loss decreased (inf --> 1.782812).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 2 cost time: 0.8720006942749023
Epoch: 2, Steps: 64 | Train Loss: 0.6020246 Vali Loss: 0.9574404 Test Loss: 1.6490055
Validation loss decreased (1.782812 --> 0.957440).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 3 cost time: 0.891653299331665
Epoch: 3, Steps: 64 | Train Loss: 0.3558235 Vali Loss: 0.5684373 Test Loss: 0.8712007
Validation loss decreased (0.957440 --> 0.568437).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 4 cost time: 0.8929884433746338
Epoch: 4, Steps: 64 | Train Loss: 0.2211106 Vali Loss: 0.3616535 Test Loss: 0.4735266
Validation loss decreased (0.568437 --> 0.361654).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 5 cost time: 0.8583669662475586
Epoch: 5, Steps: 64 | Train Loss: 0.1542419 Vali Loss: 0.2619950 Test Loss: 0.2956808
Validation loss decreased (0.361654 --> 0.261995).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 6 cost time: 0.8533813953399658
Epoch: 6, Steps: 64 | Train Loss: 0.1250414 Vali Loss: 0.2206769 Test Loss: 0.2230155
Validation loss decreased (0.261995 --> 0.220677).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 7 cost time: 0.8548469543457031
Epoch: 7, Steps: 64 | Train Loss: 0.1109440 Vali Loss: 0.1971975 Test Loss: 0.1856392
Validation loss decreased (0.220677 --> 0.197198).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 8 cost time: 0.8599996566772461
Epoch: 8, Steps: 64 | Train Loss: 0.1035348 Vali Loss: 0.1854258 Test Loss: 0.1677701
Validation loss decreased (0.197198 --> 0.185426).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 9 cost time: 0.851651668548584
Epoch: 9, Steps: 64 | Train Loss: 0.0996734 Vali Loss: 0.1750179 Test Loss: 0.1566790
Validation loss decreased (0.185426 --> 0.175018).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 10 cost time: 0.8814065456390381
Epoch: 10, Steps: 64 | Train Loss: 0.0964104 Vali Loss: 0.1716352 Test Loss: 0.1518647
Validation loss decreased (0.175018 --> 0.171635).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 11 cost time: 0.8823821544647217
Epoch: 11, Steps: 64 | Train Loss: 0.0944292 Vali Loss: 0.1697441 Test Loss: 0.1490937
Validation loss decreased (0.171635 --> 0.169744).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 12 cost time: 0.8834390640258789
Epoch: 12, Steps: 64 | Train Loss: 0.0928570 Vali Loss: 0.1623882 Test Loss: 0.1471335
Validation loss decreased (0.169744 --> 0.162388).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 13 cost time: 0.8959634304046631
Epoch: 13, Steps: 64 | Train Loss: 0.0923266 Vali Loss: 0.1635177 Test Loss: 0.1452205
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 14 cost time: 0.8779993057250977
Epoch: 14, Steps: 64 | Train Loss: 0.0905863 Vali Loss: 0.1614018 Test Loss: 0.1444185
Validation loss decreased (0.162388 --> 0.161402).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 15 cost time: 0.8676388263702393
Epoch: 15, Steps: 64 | Train Loss: 0.0898744 Vali Loss: 0.1593184 Test Loss: 0.1441935
Validation loss decreased (0.161402 --> 0.159318).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 16 cost time: 0.8753702640533447
Epoch: 16, Steps: 64 | Train Loss: 0.0894506 Vali Loss: 0.1581298 Test Loss: 0.1432996
Validation loss decreased (0.159318 --> 0.158130).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 17 cost time: 0.8742244243621826
Epoch: 17, Steps: 64 | Train Loss: 0.0884710 Vali Loss: 0.1589491 Test Loss: 0.1433169
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 18 cost time: 0.8844497203826904
Epoch: 18, Steps: 64 | Train Loss: 0.0884226 Vali Loss: 0.1549655 Test Loss: 0.1420900
Validation loss decreased (0.158130 --> 0.154965).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 19 cost time: 0.8987913131713867
Epoch: 19, Steps: 64 | Train Loss: 0.0881276 Vali Loss: 0.1579900 Test Loss: 0.1417841
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 20 cost time: 0.8949999809265137
Epoch: 20, Steps: 64 | Train Loss: 0.0873143 Vali Loss: 0.1571130 Test Loss: 0.1419270
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 21 cost time: 0.8806393146514893
Epoch: 21, Steps: 64 | Train Loss: 0.0870175 Vali Loss: 0.1556458 Test Loss: 0.1408251
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 22 cost time: 0.8944375514984131
Epoch: 22, Steps: 64 | Train Loss: 0.0867612 Vali Loss: 0.1560214 Test Loss: 0.1411825
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 23 cost time: 0.8621389865875244
Epoch: 23, Steps: 64 | Train Loss: 0.0863670 Vali Loss: 0.1559944 Test Loss: 0.1407460
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 24 cost time: 0.8542394638061523
Epoch: 24, Steps: 64 | Train Loss: 0.0864271 Vali Loss: 0.1561134 Test Loss: 0.1408107
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 25 cost time: 0.8509984016418457
Epoch: 25, Steps: 64 | Train Loss: 0.0864839 Vali Loss: 0.1548047 Test Loss: 0.1406512
Validation loss decreased (0.154965 --> 0.154805).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 26 cost time: 0.8593857288360596
Epoch: 26, Steps: 64 | Train Loss: 0.0858373 Vali Loss: 0.1536153 Test Loss: 0.1404732
Validation loss decreased (0.154805 --> 0.153615).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 27 cost time: 0.8836190700531006
Epoch: 27, Steps: 64 | Train Loss: 0.0850161 Vali Loss: 0.1550177 Test Loss: 0.1403976
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 28 cost time: 0.8884267807006836
Epoch: 28, Steps: 64 | Train Loss: 0.0853425 Vali Loss: 0.1540216 Test Loss: 0.1403798
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 29 cost time: 0.8961238861083984
Epoch: 29, Steps: 64 | Train Loss: 0.0850893 Vali Loss: 0.1535685 Test Loss: 0.1407721
Validation loss decreased (0.153615 --> 0.153568).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 30 cost time: 0.8693811893463135
Epoch: 30, Steps: 64 | Train Loss: 0.0850734 Vali Loss: 0.1530378 Test Loss: 0.1403768
Validation loss decreased (0.153568 --> 0.153038).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 31 cost time: 0.8686394691467285
Epoch: 31, Steps: 64 | Train Loss: 0.0850523 Vali Loss: 0.1538316 Test Loss: 0.1398353
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 32 cost time: 0.8529994487762451
Epoch: 32, Steps: 64 | Train Loss: 0.0847470 Vali Loss: 0.1523489 Test Loss: 0.1399238
Validation loss decreased (0.153038 --> 0.152349).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 33 cost time: 0.853365421295166
Epoch: 33, Steps: 64 | Train Loss: 0.0847341 Vali Loss: 0.1515902 Test Loss: 0.1396683
Validation loss decreased (0.152349 --> 0.151590).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 34 cost time: 0.8584775924682617
Epoch: 34, Steps: 64 | Train Loss: 0.0846041 Vali Loss: 0.1536950 Test Loss: 0.1401701
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 35 cost time: 0.8763582706451416
Epoch: 35, Steps: 64 | Train Loss: 0.0847351 Vali Loss: 0.1530195 Test Loss: 0.1400652
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 36 cost time: 0.8988687992095947
Epoch: 36, Steps: 64 | Train Loss: 0.0841474 Vali Loss: 0.1529879 Test Loss: 0.1400802
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 37 cost time: 0.9029991626739502
Epoch: 37, Steps: 64 | Train Loss: 0.0841956 Vali Loss: 0.1536851 Test Loss: 0.1400779
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 38 cost time: 0.8936448097229004
Epoch: 38, Steps: 64 | Train Loss: 0.0836264 Vali Loss: 0.1508635 Test Loss: 0.1399113
Validation loss decreased (0.151590 --> 0.150864).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 39 cost time: 0.8913698196411133
Epoch: 39, Steps: 64 | Train Loss: 0.0844315 Vali Loss: 0.1518582 Test Loss: 0.1399445
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 40 cost time: 0.894108772277832
Epoch: 40, Steps: 64 | Train Loss: 0.0842889 Vali Loss: 0.1531590 Test Loss: 0.1397317
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 41 cost time: 0.8815183639526367
Epoch: 41, Steps: 64 | Train Loss: 0.0841769 Vali Loss: 0.1514951 Test Loss: 0.1399198
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 42 cost time: 0.8707342147827148
Epoch: 42, Steps: 64 | Train Loss: 0.0842456 Vali Loss: 0.1508774 Test Loss: 0.1393928
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 43 cost time: 0.8759984970092773
Epoch: 43, Steps: 64 | Train Loss: 0.0840512 Vali Loss: 0.1523103 Test Loss: 0.1396018
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 44 cost time: 0.8810420036315918
Epoch: 44, Steps: 64 | Train Loss: 0.0841571 Vali Loss: 0.1510428 Test Loss: 0.1397756
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 45 cost time: 0.8893880844116211
Epoch: 45, Steps: 64 | Train Loss: 0.0841146 Vali Loss: 0.1523259 Test Loss: 0.1401329
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 46 cost time: 0.8753983974456787
Epoch: 46, Steps: 64 | Train Loss: 0.0841920 Vali Loss: 0.1514325 Test Loss: 0.1394979
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 47 cost time: 0.8813905715942383
Epoch: 47, Steps: 64 | Train Loss: 0.0839030 Vali Loss: 0.1531959 Test Loss: 0.1396465
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 48 cost time: 0.8757736682891846
Epoch: 48, Steps: 64 | Train Loss: 0.0841374 Vali Loss: 0.1513546 Test Loss: 0.1401320
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 49 cost time: 0.8640005588531494
Epoch: 49, Steps: 64 | Train Loss: 0.0844438 Vali Loss: 0.1524937 Test Loss: 0.1402701
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 50 cost time: 0.8496699333190918
Epoch: 50, Steps: 64 | Train Loss: 0.0841152 Vali Loss: 0.1507402 Test Loss: 0.1397129
Validation loss decreased (0.150864 --> 0.150740).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 51 cost time: 0.853391170501709
Epoch: 51, Steps: 64 | Train Loss: 0.0835642 Vali Loss: 0.1507787 Test Loss: 0.1397918
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 52 cost time: 0.8584837913513184
Epoch: 52, Steps: 64 | Train Loss: 0.0840858 Vali Loss: 0.1522278 Test Loss: 0.1398968
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 53 cost time: 0.864898681640625
Epoch: 53, Steps: 64 | Train Loss: 0.0838373 Vali Loss: 0.1521209 Test Loss: 0.1395500
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 54 cost time: 0.8810005187988281
Epoch: 54, Steps: 64 | Train Loss: 0.0838339 Vali Loss: 0.1533259 Test Loss: 0.1397499
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 55 cost time: 0.879000186920166
Epoch: 55, Steps: 64 | Train Loss: 0.0839606 Vali Loss: 0.1511218 Test Loss: 0.1396462
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 56 cost time: 0.8746306896209717
Epoch: 56, Steps: 64 | Train Loss: 0.0839359 Vali Loss: 0.1522442 Test Loss: 0.1396227
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 57 cost time: 0.8971922397613525
Epoch: 57, Steps: 64 | Train Loss: 0.0838659 Vali Loss: 0.1528251 Test Loss: 0.1401529
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 58 cost time: 0.8910350799560547
Epoch: 58, Steps: 64 | Train Loss: 0.0841361 Vali Loss: 0.1527295 Test Loss: 0.1398248
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 59 cost time: 0.8884096145629883
Epoch: 59, Steps: 64 | Train Loss: 0.0839370 Vali Loss: 0.1515430 Test Loss: 0.1397657
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018129348754882812 GB
GPU已分配内存的峰值：0.05875062942504883 GB
Epoch: 60 cost time: 0.8680005073547363
Epoch: 60, Steps: 64 | Train Loss: 0.0834068 Vali Loss: 0.1503596 Test Loss: 0.1395305
Validation loss decreased (0.150740 --> 0.150360).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13953055441379547, mae:0.27121657133102417, rse:0.19881798326969147
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06267786026000977 GB
Epoch: 1 cost time: 2.323953628540039
Epoch: 1, Steps: 64 | Train Loss: 0.7732209 Vali Loss: 1.7312810 Test Loss: 3.3204255
Validation loss decreased (inf --> 1.731281).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 2 cost time: 0.9354619979858398
Epoch: 2, Steps: 64 | Train Loss: 0.3238936 Vali Loss: 0.1871916 Test Loss: 0.1664267
Validation loss decreased (1.731281 --> 0.187192).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 3 cost time: 0.9090001583099365
Epoch: 3, Steps: 64 | Train Loss: 0.1013213 Vali Loss: 0.1742438 Test Loss: 0.1453820
Validation loss decreased (0.187192 --> 0.174244).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 4 cost time: 0.909630537033081
Epoch: 4, Steps: 64 | Train Loss: 0.0926993 Vali Loss: 0.1622121 Test Loss: 0.1374212
Validation loss decreased (0.174244 --> 0.162212).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 5 cost time: 0.8930723667144775
Epoch: 5, Steps: 64 | Train Loss: 0.0892051 Vali Loss: 0.1602820 Test Loss: 0.1358368
Validation loss decreased (0.162212 --> 0.160282).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 6 cost time: 0.8843643665313721
Epoch: 6, Steps: 64 | Train Loss: 0.0867811 Vali Loss: 0.1595639 Test Loss: 0.1365240
Validation loss decreased (0.160282 --> 0.159564).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 7 cost time: 0.8951084613800049
Epoch: 7, Steps: 64 | Train Loss: 0.0854313 Vali Loss: 0.1565480 Test Loss: 0.1352646
Validation loss decreased (0.159564 --> 0.156548).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 8 cost time: 0.8853781223297119
Epoch: 8, Steps: 64 | Train Loss: 0.0839465 Vali Loss: 0.1532889 Test Loss: 0.1356808
Validation loss decreased (0.156548 --> 0.153289).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 9 cost time: 0.9137053489685059
Epoch: 9, Steps: 64 | Train Loss: 0.0826454 Vali Loss: 0.1526744 Test Loss: 0.1361569
Validation loss decreased (0.153289 --> 0.152674).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 10 cost time: 0.9139995574951172
Epoch: 10, Steps: 64 | Train Loss: 0.0822103 Vali Loss: 0.1536459 Test Loss: 0.1359123
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 11 cost time: 0.9156708717346191
Epoch: 11, Steps: 64 | Train Loss: 0.0814230 Vali Loss: 0.1508818 Test Loss: 0.1364767
Validation loss decreased (0.152674 --> 0.150882).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 12 cost time: 0.9396355152130127
Epoch: 12, Steps: 64 | Train Loss: 0.0806369 Vali Loss: 0.1523197 Test Loss: 0.1366768
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 13 cost time: 0.9163808822631836
Epoch: 13, Steps: 64 | Train Loss: 0.0804241 Vali Loss: 0.1514933 Test Loss: 0.1362821
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 14 cost time: 0.9093594551086426
Epoch: 14, Steps: 64 | Train Loss: 0.0797138 Vali Loss: 0.1489492 Test Loss: 0.1358665
Validation loss decreased (0.150882 --> 0.148949).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 15 cost time: 0.9104678630828857
Epoch: 15, Steps: 64 | Train Loss: 0.0793779 Vali Loss: 0.1496748 Test Loss: 0.1373614
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 16 cost time: 0.9100141525268555
Epoch: 16, Steps: 64 | Train Loss: 0.0786886 Vali Loss: 0.1498505 Test Loss: 0.1360433
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 17 cost time: 0.9147756099700928
Epoch: 17, Steps: 64 | Train Loss: 0.0789778 Vali Loss: 0.1477950 Test Loss: 0.1370884
Validation loss decreased (0.148949 --> 0.147795).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 18 cost time: 0.9359991550445557
Epoch: 18, Steps: 64 | Train Loss: 0.0783077 Vali Loss: 0.1464259 Test Loss: 0.1372741
Validation loss decreased (0.147795 --> 0.146426).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 19 cost time: 0.934999942779541
Epoch: 19, Steps: 64 | Train Loss: 0.0777984 Vali Loss: 0.1459066 Test Loss: 0.1367124
Validation loss decreased (0.146426 --> 0.145907).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 20 cost time: 0.9336400032043457
Epoch: 20, Steps: 64 | Train Loss: 0.0779558 Vali Loss: 0.1485529 Test Loss: 0.1370589
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 21 cost time: 0.9324049949645996
Epoch: 21, Steps: 64 | Train Loss: 0.0778315 Vali Loss: 0.1465473 Test Loss: 0.1372325
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 22 cost time: 0.9064347743988037
Epoch: 22, Steps: 64 | Train Loss: 0.0777582 Vali Loss: 0.1468574 Test Loss: 0.1377411
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 23 cost time: 0.8933579921722412
Epoch: 23, Steps: 64 | Train Loss: 0.0771108 Vali Loss: 0.1467712 Test Loss: 0.1373056
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 24 cost time: 0.8957705497741699
Epoch: 24, Steps: 64 | Train Loss: 0.0776518 Vali Loss: 0.1455422 Test Loss: 0.1377693
Validation loss decreased (0.145907 --> 0.145542).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 25 cost time: 0.89479660987854
Epoch: 25, Steps: 64 | Train Loss: 0.0769237 Vali Loss: 0.1477132 Test Loss: 0.1366796
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 26 cost time: 0.9029984474182129
Epoch: 26, Steps: 64 | Train Loss: 0.0770179 Vali Loss: 0.1459549 Test Loss: 0.1371074
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 27 cost time: 0.9376363754272461
Epoch: 27, Steps: 64 | Train Loss: 0.0771023 Vali Loss: 0.1470395 Test Loss: 0.1373478
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 28 cost time: 0.9339792728424072
Epoch: 28, Steps: 64 | Train Loss: 0.0765037 Vali Loss: 0.1461942 Test Loss: 0.1368571
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 29 cost time: 0.9404938220977783
Epoch: 29, Steps: 64 | Train Loss: 0.0766952 Vali Loss: 0.1455606 Test Loss: 0.1367155
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 30 cost time: 0.8894195556640625
Epoch: 30, Steps: 64 | Train Loss: 0.0763851 Vali Loss: 0.1448715 Test Loss: 0.1367790
Validation loss decreased (0.145542 --> 0.144872).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 31 cost time: 0.8933792114257812
Epoch: 31, Steps: 64 | Train Loss: 0.0767467 Vali Loss: 0.1457371 Test Loss: 0.1364918
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 32 cost time: 0.888723611831665
Epoch: 32, Steps: 64 | Train Loss: 0.0764680 Vali Loss: 0.1465458 Test Loss: 0.1372930
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 33 cost time: 0.9060006141662598
Epoch: 33, Steps: 64 | Train Loss: 0.0765569 Vali Loss: 0.1434056 Test Loss: 0.1368711
Validation loss decreased (0.144872 --> 0.143406).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 34 cost time: 0.9336605072021484
Epoch: 34, Steps: 64 | Train Loss: 0.0762359 Vali Loss: 0.1446732 Test Loss: 0.1370529
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 35 cost time: 0.9435923099517822
Epoch: 35, Steps: 64 | Train Loss: 0.0762150 Vali Loss: 0.1455296 Test Loss: 0.1368024
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 36 cost time: 0.9458837509155273
Epoch: 36, Steps: 64 | Train Loss: 0.0760478 Vali Loss: 0.1460004 Test Loss: 0.1376850
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 37 cost time: 0.9369425773620605
Epoch: 37, Steps: 64 | Train Loss: 0.0760284 Vali Loss: 0.1461452 Test Loss: 0.1377905
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 38 cost time: 0.9294378757476807
Epoch: 38, Steps: 64 | Train Loss: 0.0762017 Vali Loss: 0.1464716 Test Loss: 0.1375259
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 39 cost time: 0.9189281463623047
Epoch: 39, Steps: 64 | Train Loss: 0.0761628 Vali Loss: 0.1459928 Test Loss: 0.1374899
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 40 cost time: 0.9227664470672607
Epoch: 40, Steps: 64 | Train Loss: 0.0760064 Vali Loss: 0.1466540 Test Loss: 0.1375296
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 41 cost time: 0.9174208641052246
Epoch: 41, Steps: 64 | Train Loss: 0.0758973 Vali Loss: 0.1451372 Test Loss: 0.1368047
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 42 cost time: 0.9206469058990479
Epoch: 42, Steps: 64 | Train Loss: 0.0760864 Vali Loss: 0.1447004 Test Loss: 0.1377492
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 43 cost time: 0.934624433517456
Epoch: 43, Steps: 64 | Train Loss: 0.0761179 Vali Loss: 0.1446484 Test Loss: 0.1363052
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 44 cost time: 0.9214270114898682
Epoch: 44, Steps: 64 | Train Loss: 0.0756598 Vali Loss: 0.1445284 Test Loss: 0.1372379
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 45 cost time: 0.9144186973571777
Epoch: 45, Steps: 64 | Train Loss: 0.0760029 Vali Loss: 0.1452827 Test Loss: 0.1371930
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 46 cost time: 0.9073681831359863
Epoch: 46, Steps: 64 | Train Loss: 0.0762607 Vali Loss: 0.1444472 Test Loss: 0.1371702
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 47 cost time: 0.905785322189331
Epoch: 47, Steps: 64 | Train Loss: 0.0757464 Vali Loss: 0.1459242 Test Loss: 0.1370752
EarlyStopping counter: 14 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 48 cost time: 0.8849992752075195
Epoch: 48, Steps: 64 | Train Loss: 0.0758277 Vali Loss: 0.1439929 Test Loss: 0.1367741
EarlyStopping counter: 15 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 49 cost time: 0.890733003616333
Epoch: 49, Steps: 64 | Train Loss: 0.0762411 Vali Loss: 0.1445685 Test Loss: 0.1361342
EarlyStopping counter: 16 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 50 cost time: 0.9036333560943604
Epoch: 50, Steps: 64 | Train Loss: 0.0758988 Vali Loss: 0.1454600 Test Loss: 0.1370911
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 51 cost time: 0.9034645557403564
Epoch: 51, Steps: 64 | Train Loss: 0.0759121 Vali Loss: 0.1460671 Test Loss: 0.1372443
EarlyStopping counter: 18 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 52 cost time: 0.9136137962341309
Epoch: 52, Steps: 64 | Train Loss: 0.0758561 Vali Loss: 0.1442974 Test Loss: 0.1369407
EarlyStopping counter: 19 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 53 cost time: 0.9115579128265381
Epoch: 53, Steps: 64 | Train Loss: 0.0760201 Vali Loss: 0.1454620 Test Loss: 0.1374753
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 54 cost time: 0.919018030166626
Epoch: 54, Steps: 64 | Train Loss: 0.0759547 Vali Loss: 0.1452467 Test Loss: 0.1371779
EarlyStopping counter: 21 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 55 cost time: 0.9077916145324707
Epoch: 55, Steps: 64 | Train Loss: 0.0759541 Vali Loss: 0.1455487 Test Loss: 0.1374977
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 56 cost time: 0.9149987697601318
Epoch: 56, Steps: 64 | Train Loss: 0.0757568 Vali Loss: 0.1431061 Test Loss: 0.1368457
Validation loss decreased (0.143406 --> 0.143106).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 57 cost time: 0.9236619472503662
Epoch: 57, Steps: 64 | Train Loss: 0.0762090 Vali Loss: 0.1456209 Test Loss: 0.1370032
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 58 cost time: 0.9154093265533447
Epoch: 58, Steps: 64 | Train Loss: 0.0758236 Vali Loss: 0.1445789 Test Loss: 0.1372086
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 59 cost time: 0.9273958206176758
Epoch: 59, Steps: 64 | Train Loss: 0.0756461 Vali Loss: 0.1462200 Test Loss: 0.1372306
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020082473754882812 GB
GPU已分配内存的峰值：0.06412172317504883 GB
Epoch: 60 cost time: 0.9404122829437256
Epoch: 60, Steps: 64 | Train Loss: 0.0758396 Vali Loss: 0.1463974 Test Loss: 0.1372799
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1368456929922104, mae:0.26792779564857483, rse:0.19689583778381348
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06597661972045898 GB
Epoch: 1 cost time: 2.3368821144104004
Epoch: 1, Steps: 64 | Train Loss: 0.7653158 Vali Loss: 1.7649391 Test Loss: 3.3441715
Validation loss decreased (inf --> 1.764939).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 2 cost time: 0.9474585056304932
Epoch: 2, Steps: 64 | Train Loss: 0.3094856 Vali Loss: 0.2487047 Test Loss: 0.3041082
Validation loss decreased (1.764939 --> 0.248705).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 3 cost time: 0.9543864727020264
Epoch: 3, Steps: 64 | Train Loss: 0.1026694 Vali Loss: 0.1746711 Test Loss: 0.1419630
Validation loss decreased (0.248705 --> 0.174671).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 4 cost time: 0.9514057636260986
Epoch: 4, Steps: 64 | Train Loss: 0.0906412 Vali Loss: 0.1611746 Test Loss: 0.1395882
Validation loss decreased (0.174671 --> 0.161175).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 5 cost time: 0.926389217376709
Epoch: 5, Steps: 64 | Train Loss: 0.0872400 Vali Loss: 0.1576159 Test Loss: 0.1373681
Validation loss decreased (0.161175 --> 0.157616).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 6 cost time: 0.9328014850616455
Epoch: 6, Steps: 64 | Train Loss: 0.0857411 Vali Loss: 0.1566775 Test Loss: 0.1375161
Validation loss decreased (0.157616 --> 0.156677).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 7 cost time: 0.9405169486999512
Epoch: 7, Steps: 64 | Train Loss: 0.0841644 Vali Loss: 0.1555843 Test Loss: 0.1359190
Validation loss decreased (0.156677 --> 0.155584).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 8 cost time: 0.9379994869232178
Epoch: 8, Steps: 64 | Train Loss: 0.0827737 Vali Loss: 0.1538427 Test Loss: 0.1361721
Validation loss decreased (0.155584 --> 0.153843).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 9 cost time: 0.9576418399810791
Epoch: 9, Steps: 64 | Train Loss: 0.0817382 Vali Loss: 0.1527349 Test Loss: 0.1353970
Validation loss decreased (0.153843 --> 0.152735).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 10 cost time: 0.9646196365356445
Epoch: 10, Steps: 64 | Train Loss: 0.0807646 Vali Loss: 0.1512177 Test Loss: 0.1348693
Validation loss decreased (0.152735 --> 0.151218).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 11 cost time: 0.9592576026916504
Epoch: 11, Steps: 64 | Train Loss: 0.0803868 Vali Loss: 0.1515339 Test Loss: 0.1358493
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 12 cost time: 0.9754889011383057
Epoch: 12, Steps: 64 | Train Loss: 0.0798664 Vali Loss: 0.1492494 Test Loss: 0.1350065
Validation loss decreased (0.151218 --> 0.149249).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 13 cost time: 0.9504902362823486
Epoch: 13, Steps: 64 | Train Loss: 0.0792889 Vali Loss: 0.1493195 Test Loss: 0.1351114
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 14 cost time: 0.9493739604949951
Epoch: 14, Steps: 64 | Train Loss: 0.0789951 Vali Loss: 0.1483712 Test Loss: 0.1361560
Validation loss decreased (0.149249 --> 0.148371).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 15 cost time: 0.9529848098754883
Epoch: 15, Steps: 64 | Train Loss: 0.0787797 Vali Loss: 0.1499170 Test Loss: 0.1369601
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 16 cost time: 0.9510607719421387
Epoch: 16, Steps: 64 | Train Loss: 0.0781243 Vali Loss: 0.1464151 Test Loss: 0.1346433
Validation loss decreased (0.148371 --> 0.146415).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 17 cost time: 0.977787971496582
Epoch: 17, Steps: 64 | Train Loss: 0.0775148 Vali Loss: 0.1473708 Test Loss: 0.1352275
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 18 cost time: 0.9700040817260742
Epoch: 18, Steps: 64 | Train Loss: 0.0775952 Vali Loss: 0.1452318 Test Loss: 0.1348635
Validation loss decreased (0.146415 --> 0.145232).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 19 cost time: 0.9716484546661377
Epoch: 19, Steps: 64 | Train Loss: 0.0771812 Vali Loss: 0.1467128 Test Loss: 0.1359764
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 20 cost time: 0.9720001220703125
Epoch: 20, Steps: 64 | Train Loss: 0.0771154 Vali Loss: 0.1468755 Test Loss: 0.1353794
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 21 cost time: 0.9546613693237305
Epoch: 21, Steps: 64 | Train Loss: 0.0768662 Vali Loss: 0.1470733 Test Loss: 0.1348346
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 22 cost time: 0.9323575496673584
Epoch: 22, Steps: 64 | Train Loss: 0.0761304 Vali Loss: 0.1459287 Test Loss: 0.1352015
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 23 cost time: 0.9336411952972412
Epoch: 23, Steps: 64 | Train Loss: 0.0765574 Vali Loss: 0.1451989 Test Loss: 0.1346827
Validation loss decreased (0.145232 --> 0.145199).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 24 cost time: 0.9333415031433105
Epoch: 24, Steps: 64 | Train Loss: 0.0763494 Vali Loss: 0.1472792 Test Loss: 0.1354946
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 25 cost time: 0.9514491558074951
Epoch: 25, Steps: 64 | Train Loss: 0.0764452 Vali Loss: 0.1460379 Test Loss: 0.1359524
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 26 cost time: 0.9533801078796387
Epoch: 26, Steps: 64 | Train Loss: 0.0759715 Vali Loss: 0.1441231 Test Loss: 0.1346028
Validation loss decreased (0.145199 --> 0.144123).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 27 cost time: 0.9627830982208252
Epoch: 27, Steps: 64 | Train Loss: 0.0752060 Vali Loss: 0.1460059 Test Loss: 0.1355789
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 28 cost time: 0.9448812007904053
Epoch: 28, Steps: 64 | Train Loss: 0.0757370 Vali Loss: 0.1440079 Test Loss: 0.1348836
Validation loss decreased (0.144123 --> 0.144008).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 29 cost time: 0.932999849319458
Epoch: 29, Steps: 64 | Train Loss: 0.0759795 Vali Loss: 0.1456342 Test Loss: 0.1351643
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 30 cost time: 0.9496145248413086
Epoch: 30, Steps: 64 | Train Loss: 0.0758076 Vali Loss: 0.1447124 Test Loss: 0.1346607
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 31 cost time: 0.9652702808380127
Epoch: 31, Steps: 64 | Train Loss: 0.0754741 Vali Loss: 0.1455218 Test Loss: 0.1364461
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 32 cost time: 0.969620943069458
Epoch: 32, Steps: 64 | Train Loss: 0.0754539 Vali Loss: 0.1449308 Test Loss: 0.1349698
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 33 cost time: 0.98651123046875
Epoch: 33, Steps: 64 | Train Loss: 0.0751456 Vali Loss: 0.1457687 Test Loss: 0.1355429
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 34 cost time: 0.9743857383728027
Epoch: 34, Steps: 64 | Train Loss: 0.0752678 Vali Loss: 0.1439127 Test Loss: 0.1351950
Validation loss decreased (0.144008 --> 0.143913).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 35 cost time: 0.9714033603668213
Epoch: 35, Steps: 64 | Train Loss: 0.0750992 Vali Loss: 0.1437094 Test Loss: 0.1354465
Validation loss decreased (0.143913 --> 0.143709).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 36 cost time: 0.9674646854400635
Epoch: 36, Steps: 64 | Train Loss: 0.0752119 Vali Loss: 0.1420900 Test Loss: 0.1350723
Validation loss decreased (0.143709 --> 0.142090).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 37 cost time: 0.9556264877319336
Epoch: 37, Steps: 64 | Train Loss: 0.0753838 Vali Loss: 0.1445190 Test Loss: 0.1355029
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 38 cost time: 0.9573929309844971
Epoch: 38, Steps: 64 | Train Loss: 0.0747586 Vali Loss: 0.1438919 Test Loss: 0.1359249
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 39 cost time: 0.9591302871704102
Epoch: 39, Steps: 64 | Train Loss: 0.0751811 Vali Loss: 0.1452679 Test Loss: 0.1354214
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 40 cost time: 0.9687497615814209
Epoch: 40, Steps: 64 | Train Loss: 0.0751789 Vali Loss: 0.1445253 Test Loss: 0.1358688
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 41 cost time: 0.9760000705718994
Epoch: 41, Steps: 64 | Train Loss: 0.0749258 Vali Loss: 0.1436599 Test Loss: 0.1346002
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 42 cost time: 0.9723317623138428
Epoch: 42, Steps: 64 | Train Loss: 0.0752752 Vali Loss: 0.1446470 Test Loss: 0.1349224
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 43 cost time: 0.9610140323638916
Epoch: 43, Steps: 64 | Train Loss: 0.0750684 Vali Loss: 0.1430408 Test Loss: 0.1354123
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 44 cost time: 0.946394681930542
Epoch: 44, Steps: 64 | Train Loss: 0.0747390 Vali Loss: 0.1450484 Test Loss: 0.1355477
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 45 cost time: 0.9374325275421143
Epoch: 45, Steps: 64 | Train Loss: 0.0750332 Vali Loss: 0.1457969 Test Loss: 0.1355444
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 46 cost time: 0.9413557052612305
Epoch: 46, Steps: 64 | Train Loss: 0.0752815 Vali Loss: 0.1457237 Test Loss: 0.1350507
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 47 cost time: 0.9404456615447998
Epoch: 47, Steps: 64 | Train Loss: 0.0743760 Vali Loss: 0.1435127 Test Loss: 0.1351654
EarlyStopping counter: 11 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 48 cost time: 0.94940185546875
Epoch: 48, Steps: 64 | Train Loss: 0.0747383 Vali Loss: 0.1425830 Test Loss: 0.1348351
EarlyStopping counter: 12 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 49 cost time: 0.9527888298034668
Epoch: 49, Steps: 64 | Train Loss: 0.0750867 Vali Loss: 0.1437315 Test Loss: 0.1354698
EarlyStopping counter: 13 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 50 cost time: 0.9448146820068359
Epoch: 50, Steps: 64 | Train Loss: 0.0749854 Vali Loss: 0.1437999 Test Loss: 0.1349426
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 51 cost time: 0.9573860168457031
Epoch: 51, Steps: 64 | Train Loss: 0.0751961 Vali Loss: 0.1450431 Test Loss: 0.1349717
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 52 cost time: 0.9440000057220459
Epoch: 52, Steps: 64 | Train Loss: 0.0748310 Vali Loss: 0.1446489 Test Loss: 0.1350795
EarlyStopping counter: 16 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 53 cost time: 0.9546380043029785
Epoch: 53, Steps: 64 | Train Loss: 0.0748043 Vali Loss: 0.1439197 Test Loss: 0.1361040
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 54 cost time: 0.9533772468566895
Epoch: 54, Steps: 64 | Train Loss: 0.0749610 Vali Loss: 0.1448175 Test Loss: 0.1353992
EarlyStopping counter: 18 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 55 cost time: 0.946843147277832
Epoch: 55, Steps: 64 | Train Loss: 0.0749807 Vali Loss: 0.1442297 Test Loss: 0.1351795
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 56 cost time: 0.965416669845581
Epoch: 56, Steps: 64 | Train Loss: 0.0747322 Vali Loss: 0.1438018 Test Loss: 0.1347989
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 57 cost time: 0.9703826904296875
Epoch: 57, Steps: 64 | Train Loss: 0.0749144 Vali Loss: 0.1434378 Test Loss: 0.1347702
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 58 cost time: 0.9674196243286133
Epoch: 58, Steps: 64 | Train Loss: 0.0748049 Vali Loss: 0.1441336 Test Loss: 0.1352532
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 59 cost time: 0.9734246730804443
Epoch: 59, Steps: 64 | Train Loss: 0.0750571 Vali Loss: 0.1439060 Test Loss: 0.1353048
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021066665649414062 GB
GPU已分配内存的峰值：0.06791257858276367 GB
Epoch: 60 cost time: 0.9677369594573975
Epoch: 60, Steps: 64 | Train Loss: 0.0747470 Vali Loss: 0.1436564 Test Loss: 0.1352477
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13507232069969177, mae:0.2644321322441101, rse:0.19561588764190674
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058444976806640625 GB
Epoch: 1 cost time: 2.284666061401367
Epoch: 1, Steps: 64 | Train Loss: 0.9195333 Vali Loss: 2.0499725 Test Loss: 3.9522963
Validation loss decreased (inf --> 2.049973).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 2 cost time: 0.8984978199005127
Epoch: 2, Steps: 64 | Train Loss: 0.6793402 Vali Loss: 0.9546540 Test Loss: 1.6303551
Validation loss decreased (2.049973 --> 0.954654).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 3 cost time: 0.8976898193359375
Epoch: 3, Steps: 64 | Train Loss: 0.3611940 Vali Loss: 0.5784219 Test Loss: 0.8544917
Validation loss decreased (0.954654 --> 0.578422).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 4 cost time: 0.8983573913574219
Epoch: 4, Steps: 64 | Train Loss: 0.2246277 Vali Loss: 0.3897477 Test Loss: 0.5026388
Validation loss decreased (0.578422 --> 0.389748).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 5 cost time: 0.8756415843963623
Epoch: 5, Steps: 64 | Train Loss: 0.1596117 Vali Loss: 0.2923781 Test Loss: 0.3291572
Validation loss decreased (0.389748 --> 0.292378).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 6 cost time: 0.8784034252166748
Epoch: 6, Steps: 64 | Train Loss: 0.1287348 Vali Loss: 0.2370613 Test Loss: 0.2401413
Validation loss decreased (0.292378 --> 0.237061).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 7 cost time: 0.8644278049468994
Epoch: 7, Steps: 64 | Train Loss: 0.1142419 Vali Loss: 0.2089764 Test Loss: 0.1983230
Validation loss decreased (0.237061 --> 0.208976).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 8 cost time: 0.8743510246276855
Epoch: 8, Steps: 64 | Train Loss: 0.1061934 Vali Loss: 0.1899797 Test Loss: 0.1736028
Validation loss decreased (0.208976 --> 0.189980).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 9 cost time: 0.8835849761962891
Epoch: 9, Steps: 64 | Train Loss: 0.1010406 Vali Loss: 0.1823985 Test Loss: 0.1628952
Validation loss decreased (0.189980 --> 0.182398).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 10 cost time: 0.9056315422058105
Epoch: 10, Steps: 64 | Train Loss: 0.0981516 Vali Loss: 0.1727469 Test Loss: 0.1557144
Validation loss decreased (0.182398 --> 0.172747).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 11 cost time: 0.9016380310058594
Epoch: 11, Steps: 64 | Train Loss: 0.0959863 Vali Loss: 0.1721317 Test Loss: 0.1519511
Validation loss decreased (0.172747 --> 0.172132).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 12 cost time: 0.9094583988189697
Epoch: 12, Steps: 64 | Train Loss: 0.0953662 Vali Loss: 0.1677034 Test Loss: 0.1485183
Validation loss decreased (0.172132 --> 0.167703).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 13 cost time: 0.9103438854217529
Epoch: 13, Steps: 64 | Train Loss: 0.0930462 Vali Loss: 0.1660723 Test Loss: 0.1472594
Validation loss decreased (0.167703 --> 0.166072).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 14 cost time: 0.8900249004364014
Epoch: 14, Steps: 64 | Train Loss: 0.0925044 Vali Loss: 0.1645015 Test Loss: 0.1462652
Validation loss decreased (0.166072 --> 0.164501).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 15 cost time: 0.885669469833374
Epoch: 15, Steps: 64 | Train Loss: 0.0916241 Vali Loss: 0.1629543 Test Loss: 0.1456750
Validation loss decreased (0.164501 --> 0.162954).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 16 cost time: 0.8837318420410156
Epoch: 16, Steps: 64 | Train Loss: 0.0912468 Vali Loss: 0.1618497 Test Loss: 0.1441759
Validation loss decreased (0.162954 --> 0.161850).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 17 cost time: 0.8923904895782471
Epoch: 17, Steps: 64 | Train Loss: 0.0909306 Vali Loss: 0.1599926 Test Loss: 0.1435797
Validation loss decreased (0.161850 --> 0.159993).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 18 cost time: 0.9066722393035889
Epoch: 18, Steps: 64 | Train Loss: 0.0899953 Vali Loss: 0.1582953 Test Loss: 0.1432365
Validation loss decreased (0.159993 --> 0.158295).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 19 cost time: 0.9083695411682129
Epoch: 19, Steps: 64 | Train Loss: 0.0897611 Vali Loss: 0.1577878 Test Loss: 0.1420399
Validation loss decreased (0.158295 --> 0.157788).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 20 cost time: 0.9164884090423584
Epoch: 20, Steps: 64 | Train Loss: 0.0888787 Vali Loss: 0.1589662 Test Loss: 0.1420034
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 21 cost time: 0.9093565940856934
Epoch: 21, Steps: 64 | Train Loss: 0.0884877 Vali Loss: 0.1566848 Test Loss: 0.1419434
Validation loss decreased (0.157788 --> 0.156685).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 22 cost time: 0.8938145637512207
Epoch: 22, Steps: 64 | Train Loss: 0.0881467 Vali Loss: 0.1577682 Test Loss: 0.1421148
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 23 cost time: 0.8720018863677979
Epoch: 23, Steps: 64 | Train Loss: 0.0879739 Vali Loss: 0.1574689 Test Loss: 0.1416544
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 24 cost time: 0.8826098442077637
Epoch: 24, Steps: 64 | Train Loss: 0.0876630 Vali Loss: 0.1568567 Test Loss: 0.1414680
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 25 cost time: 0.8803791999816895
Epoch: 25, Steps: 64 | Train Loss: 0.0872087 Vali Loss: 0.1553145 Test Loss: 0.1408958
Validation loss decreased (0.156685 --> 0.155314).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 26 cost time: 0.8774328231811523
Epoch: 26, Steps: 64 | Train Loss: 0.0874282 Vali Loss: 0.1541726 Test Loss: 0.1406546
Validation loss decreased (0.155314 --> 0.154173).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 27 cost time: 0.8933587074279785
Epoch: 27, Steps: 64 | Train Loss: 0.0873216 Vali Loss: 0.1544421 Test Loss: 0.1405177
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 28 cost time: 0.899449348449707
Epoch: 28, Steps: 64 | Train Loss: 0.0867966 Vali Loss: 0.1561470 Test Loss: 0.1408073
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 29 cost time: 0.8998243808746338
Epoch: 29, Steps: 64 | Train Loss: 0.0865271 Vali Loss: 0.1534877 Test Loss: 0.1403824
Validation loss decreased (0.154173 --> 0.153488).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 30 cost time: 0.8929996490478516
Epoch: 30, Steps: 64 | Train Loss: 0.0862533 Vali Loss: 0.1533853 Test Loss: 0.1406870
Validation loss decreased (0.153488 --> 0.153385).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 31 cost time: 0.8856291770935059
Epoch: 31, Steps: 64 | Train Loss: 0.0863824 Vali Loss: 0.1530927 Test Loss: 0.1405238
Validation loss decreased (0.153385 --> 0.153093).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 32 cost time: 0.9015417098999023
Epoch: 32, Steps: 64 | Train Loss: 0.0863805 Vali Loss: 0.1553848 Test Loss: 0.1408163
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 33 cost time: 0.8994886875152588
Epoch: 33, Steps: 64 | Train Loss: 0.0864968 Vali Loss: 0.1544490 Test Loss: 0.1400179
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 34 cost time: 0.9065394401550293
Epoch: 34, Steps: 64 | Train Loss: 0.0859681 Vali Loss: 0.1524757 Test Loss: 0.1399171
Validation loss decreased (0.153093 --> 0.152476).  Saving model ...
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 35 cost time: 0.906203031539917
Epoch: 35, Steps: 64 | Train Loss: 0.0862018 Vali Loss: 0.1518266 Test Loss: 0.1396430
Validation loss decreased (0.152476 --> 0.151827).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 36 cost time: 0.9069993495941162
Epoch: 36, Steps: 64 | Train Loss: 0.0862652 Vali Loss: 0.1541577 Test Loss: 0.1399353
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 37 cost time: 0.908001184463501
Epoch: 37, Steps: 64 | Train Loss: 0.0859516 Vali Loss: 0.1537145 Test Loss: 0.1399828
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 38 cost time: 0.9186267852783203
Epoch: 38, Steps: 64 | Train Loss: 0.0860256 Vali Loss: 0.1511310 Test Loss: 0.1396710
Validation loss decreased (0.151827 --> 0.151131).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 39 cost time: 0.9109201431274414
Epoch: 39, Steps: 64 | Train Loss: 0.0860691 Vali Loss: 0.1532284 Test Loss: 0.1399438
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 40 cost time: 0.9026460647583008
Epoch: 40, Steps: 64 | Train Loss: 0.0860292 Vali Loss: 0.1514371 Test Loss: 0.1395763
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 41 cost time: 0.8974804878234863
Epoch: 41, Steps: 64 | Train Loss: 0.0858340 Vali Loss: 0.1528860 Test Loss: 0.1399642
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 42 cost time: 0.8992514610290527
Epoch: 42, Steps: 64 | Train Loss: 0.0855358 Vali Loss: 0.1518593 Test Loss: 0.1399164
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 43 cost time: 0.8899998664855957
Epoch: 43, Steps: 64 | Train Loss: 0.0857237 Vali Loss: 0.1527861 Test Loss: 0.1398895
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 44 cost time: 0.9056458473205566
Epoch: 44, Steps: 64 | Train Loss: 0.0858414 Vali Loss: 0.1546288 Test Loss: 0.1399533
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 45 cost time: 0.8959755897521973
Epoch: 45, Steps: 64 | Train Loss: 0.0856995 Vali Loss: 0.1522958 Test Loss: 0.1396124
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 46 cost time: 0.8957498073577881
Epoch: 46, Steps: 64 | Train Loss: 0.0855626 Vali Loss: 0.1526193 Test Loss: 0.1395656
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 47 cost time: 0.8905026912689209
Epoch: 47, Steps: 64 | Train Loss: 0.0856144 Vali Loss: 0.1521374 Test Loss: 0.1397421
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 48 cost time: 0.8748795986175537
Epoch: 48, Steps: 64 | Train Loss: 0.0857183 Vali Loss: 0.1516024 Test Loss: 0.1394533
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 49 cost time: 0.8857886791229248
Epoch: 49, Steps: 64 | Train Loss: 0.0852748 Vali Loss: 0.1519956 Test Loss: 0.1400866
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 50 cost time: 0.8799998760223389
Epoch: 50, Steps: 64 | Train Loss: 0.0857133 Vali Loss: 0.1526804 Test Loss: 0.1395261
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 51 cost time: 0.8586201667785645
Epoch: 51, Steps: 64 | Train Loss: 0.0854034 Vali Loss: 0.1524930 Test Loss: 0.1394141
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 52 cost time: 0.8778433799743652
Epoch: 52, Steps: 64 | Train Loss: 0.0854894 Vali Loss: 0.1527534 Test Loss: 0.1395150
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 53 cost time: 0.8914675712585449
Epoch: 53, Steps: 64 | Train Loss: 0.0853971 Vali Loss: 0.1528014 Test Loss: 0.1397658
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 54 cost time: 0.8940484523773193
Epoch: 54, Steps: 64 | Train Loss: 0.0855351 Vali Loss: 0.1531622 Test Loss: 0.1399792
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 55 cost time: 0.8958826065063477
Epoch: 55, Steps: 64 | Train Loss: 0.0854219 Vali Loss: 0.1509860 Test Loss: 0.1393127
Validation loss decreased (0.151131 --> 0.150986).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 56 cost time: 0.9219982624053955
Epoch: 56, Steps: 64 | Train Loss: 0.0853998 Vali Loss: 0.1527170 Test Loss: 0.1398079
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 57 cost time: 0.8876426219940186
Epoch: 57, Steps: 64 | Train Loss: 0.0851901 Vali Loss: 0.1525604 Test Loss: 0.1395657
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 58 cost time: 0.8854751586914062
Epoch: 58, Steps: 64 | Train Loss: 0.0854767 Vali Loss: 0.1533167 Test Loss: 0.1400393
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 59 cost time: 0.8904285430908203
Epoch: 59, Steps: 64 | Train Loss: 0.0852621 Vali Loss: 0.1530812 Test Loss: 0.1397060
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01813507080078125 GB
GPU已分配内存的峰值：0.058915138244628906 GB
Epoch: 60 cost time: 0.8793683052062988
Epoch: 60, Steps: 64 | Train Loss: 0.0851691 Vali Loss: 0.1525774 Test Loss: 0.1398669
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.139312744140625, mae:0.271248459815979, rse:0.19866274297237396
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.06283950805664062 GB
Epoch: 1 cost time: 2.323840618133545
Epoch: 1, Steps: 64 | Train Loss: 0.7720352 Vali Loss: 1.7429152 Test Loss: 3.3031077
Validation loss decreased (inf --> 1.742915).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 2 cost time: 0.9239985942840576
Epoch: 2, Steps: 64 | Train Loss: 0.3182399 Vali Loss: 0.2009336 Test Loss: 0.1652486
Validation loss decreased (1.742915 --> 0.200934).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 3 cost time: 0.9243812561035156
Epoch: 3, Steps: 64 | Train Loss: 0.0994474 Vali Loss: 0.1648901 Test Loss: 0.1448785
Validation loss decreased (0.200934 --> 0.164890).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 4 cost time: 0.9257552623748779
Epoch: 4, Steps: 64 | Train Loss: 0.0910731 Vali Loss: 0.1582555 Test Loss: 0.1402743
Validation loss decreased (0.164890 --> 0.158255).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 5 cost time: 0.9029998779296875
Epoch: 5, Steps: 64 | Train Loss: 0.0875123 Vali Loss: 0.1563189 Test Loss: 0.1375332
Validation loss decreased (0.158255 --> 0.156319).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 6 cost time: 0.9160270690917969
Epoch: 6, Steps: 64 | Train Loss: 0.0857815 Vali Loss: 0.1529793 Test Loss: 0.1349682
Validation loss decreased (0.156319 --> 0.152979).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 7 cost time: 0.9096238613128662
Epoch: 7, Steps: 64 | Train Loss: 0.0840346 Vali Loss: 0.1518028 Test Loss: 0.1367038
Validation loss decreased (0.152979 --> 0.151803).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 8 cost time: 0.9113814830780029
Epoch: 8, Steps: 64 | Train Loss: 0.0833555 Vali Loss: 0.1520138 Test Loss: 0.1369535
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 9 cost time: 0.9343729019165039
Epoch: 9, Steps: 64 | Train Loss: 0.0822095 Vali Loss: 0.1498960 Test Loss: 0.1352139
Validation loss decreased (0.151803 --> 0.149896).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 10 cost time: 0.9291768074035645
Epoch: 10, Steps: 64 | Train Loss: 0.0809592 Vali Loss: 0.1487238 Test Loss: 0.1343769
Validation loss decreased (0.149896 --> 0.148724).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 11 cost time: 0.9313514232635498
Epoch: 11, Steps: 64 | Train Loss: 0.0803899 Vali Loss: 0.1446802 Test Loss: 0.1335039
Validation loss decreased (0.148724 --> 0.144680).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 12 cost time: 0.9458441734313965
Epoch: 12, Steps: 64 | Train Loss: 0.0801556 Vali Loss: 0.1446995 Test Loss: 0.1333673
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 13 cost time: 0.9257526397705078
Epoch: 13, Steps: 64 | Train Loss: 0.0796498 Vali Loss: 0.1438365 Test Loss: 0.1327799
Validation loss decreased (0.144680 --> 0.143836).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 14 cost time: 0.9180006980895996
Epoch: 14, Steps: 64 | Train Loss: 0.0790099 Vali Loss: 0.1419630 Test Loss: 0.1326936
Validation loss decreased (0.143836 --> 0.141963).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 15 cost time: 0.9166355133056641
Epoch: 15, Steps: 64 | Train Loss: 0.0785321 Vali Loss: 0.1415931 Test Loss: 0.1319888
Validation loss decreased (0.141963 --> 0.141593).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 16 cost time: 0.9284002780914307
Epoch: 16, Steps: 64 | Train Loss: 0.0781998 Vali Loss: 0.1410413 Test Loss: 0.1322469
Validation loss decreased (0.141593 --> 0.141041).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 17 cost time: 0.9333739280700684
Epoch: 17, Steps: 64 | Train Loss: 0.0782813 Vali Loss: 0.1412406 Test Loss: 0.1315976
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 18 cost time: 0.9344577789306641
Epoch: 18, Steps: 64 | Train Loss: 0.0775339 Vali Loss: 0.1391447 Test Loss: 0.1313580
Validation loss decreased (0.141041 --> 0.139145).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 19 cost time: 0.9377574920654297
Epoch: 19, Steps: 64 | Train Loss: 0.0774702 Vali Loss: 0.1381437 Test Loss: 0.1304547
Validation loss decreased (0.139145 --> 0.138144).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 20 cost time: 0.9343936443328857
Epoch: 20, Steps: 64 | Train Loss: 0.0770285 Vali Loss: 0.1411908 Test Loss: 0.1326352
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 21 cost time: 0.9207322597503662
Epoch: 21, Steps: 64 | Train Loss: 0.0769936 Vali Loss: 0.1386626 Test Loss: 0.1311803
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 22 cost time: 0.9109859466552734
Epoch: 22, Steps: 64 | Train Loss: 0.0766437 Vali Loss: 0.1383156 Test Loss: 0.1308355
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 23 cost time: 0.9180243015289307
Epoch: 23, Steps: 64 | Train Loss: 0.0762896 Vali Loss: 0.1382371 Test Loss: 0.1315311
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 24 cost time: 0.9146509170532227
Epoch: 24, Steps: 64 | Train Loss: 0.0764251 Vali Loss: 0.1400482 Test Loss: 0.1323542
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 25 cost time: 0.9168071746826172
Epoch: 25, Steps: 64 | Train Loss: 0.0765854 Vali Loss: 0.1363650 Test Loss: 0.1312215
Validation loss decreased (0.138144 --> 0.136365).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 26 cost time: 0.9234664440155029
Epoch: 26, Steps: 64 | Train Loss: 0.0761473 Vali Loss: 0.1391155 Test Loss: 0.1308152
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 27 cost time: 0.9184408187866211
Epoch: 27, Steps: 64 | Train Loss: 0.0760265 Vali Loss: 0.1396021 Test Loss: 0.1316980
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 28 cost time: 0.9273791313171387
Epoch: 28, Steps: 64 | Train Loss: 0.0760030 Vali Loss: 0.1395539 Test Loss: 0.1303884
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 29 cost time: 0.9147534370422363
Epoch: 29, Steps: 64 | Train Loss: 0.0763173 Vali Loss: 0.1379870 Test Loss: 0.1315972
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 30 cost time: 0.9160010814666748
Epoch: 30, Steps: 64 | Train Loss: 0.0757417 Vali Loss: 0.1381256 Test Loss: 0.1308196
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 31 cost time: 0.9063723087310791
Epoch: 31, Steps: 64 | Train Loss: 0.0763333 Vali Loss: 0.1382571 Test Loss: 0.1305392
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 32 cost time: 0.9013965129852295
Epoch: 32, Steps: 64 | Train Loss: 0.0758979 Vali Loss: 0.1354994 Test Loss: 0.1303716
Validation loss decreased (0.136365 --> 0.135499).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 33 cost time: 0.9273788928985596
Epoch: 33, Steps: 64 | Train Loss: 0.0759638 Vali Loss: 0.1357315 Test Loss: 0.1298021
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 34 cost time: 0.9424829483032227
Epoch: 34, Steps: 64 | Train Loss: 0.0759576 Vali Loss: 0.1390308 Test Loss: 0.1315312
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 35 cost time: 0.9373953342437744
Epoch: 35, Steps: 64 | Train Loss: 0.0755135 Vali Loss: 0.1388789 Test Loss: 0.1305450
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 36 cost time: 0.9384727478027344
Epoch: 36, Steps: 64 | Train Loss: 0.0755102 Vali Loss: 0.1394251 Test Loss: 0.1312554
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 37 cost time: 0.9397435188293457
Epoch: 37, Steps: 64 | Train Loss: 0.0755973 Vali Loss: 0.1381542 Test Loss: 0.1307222
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 38 cost time: 0.925001859664917
Epoch: 38, Steps: 64 | Train Loss: 0.0751531 Vali Loss: 0.1381160 Test Loss: 0.1312258
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 39 cost time: 0.9136359691619873
Epoch: 39, Steps: 64 | Train Loss: 0.0756839 Vali Loss: 0.1380322 Test Loss: 0.1304449
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 40 cost time: 0.9263839721679688
Epoch: 40, Steps: 64 | Train Loss: 0.0754256 Vali Loss: 0.1379085 Test Loss: 0.1309890
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 41 cost time: 0.9243636131286621
Epoch: 41, Steps: 64 | Train Loss: 0.0755869 Vali Loss: 0.1358001 Test Loss: 0.1301425
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 42 cost time: 0.944366455078125
Epoch: 42, Steps: 64 | Train Loss: 0.0752069 Vali Loss: 0.1386650 Test Loss: 0.1308381
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 43 cost time: 0.9433727264404297
Epoch: 43, Steps: 64 | Train Loss: 0.0755103 Vali Loss: 0.1379799 Test Loss: 0.1309597
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 44 cost time: 0.9147143363952637
Epoch: 44, Steps: 64 | Train Loss: 0.0752972 Vali Loss: 0.1361489 Test Loss: 0.1303072
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 45 cost time: 0.921748161315918
Epoch: 45, Steps: 64 | Train Loss: 0.0751912 Vali Loss: 0.1385670 Test Loss: 0.1307451
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 46 cost time: 0.9110021591186523
Epoch: 46, Steps: 64 | Train Loss: 0.0755375 Vali Loss: 0.1366747 Test Loss: 0.1306171
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 47 cost time: 0.9136414527893066
Epoch: 47, Steps: 64 | Train Loss: 0.0751389 Vali Loss: 0.1376931 Test Loss: 0.1307829
EarlyStopping counter: 15 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 48 cost time: 0.9090778827667236
Epoch: 48, Steps: 64 | Train Loss: 0.0752086 Vali Loss: 0.1368293 Test Loss: 0.1307686
EarlyStopping counter: 16 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 49 cost time: 0.8993957042694092
Epoch: 49, Steps: 64 | Train Loss: 0.0750370 Vali Loss: 0.1358608 Test Loss: 0.1305729
EarlyStopping counter: 17 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 50 cost time: 0.9284186363220215
Epoch: 50, Steps: 64 | Train Loss: 0.0754628 Vali Loss: 0.1385290 Test Loss: 0.1310537
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 51 cost time: 0.9264066219329834
Epoch: 51, Steps: 64 | Train Loss: 0.0754539 Vali Loss: 0.1379591 Test Loss: 0.1303294
EarlyStopping counter: 19 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 52 cost time: 0.9207785129547119
Epoch: 52, Steps: 64 | Train Loss: 0.0756017 Vali Loss: 0.1395597 Test Loss: 0.1309886
EarlyStopping counter: 20 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 53 cost time: 0.9268088340759277
Epoch: 53, Steps: 64 | Train Loss: 0.0750367 Vali Loss: 0.1384579 Test Loss: 0.1306293
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 54 cost time: 0.9100008010864258
Epoch: 54, Steps: 64 | Train Loss: 0.0752444 Vali Loss: 0.1369866 Test Loss: 0.1308739
EarlyStopping counter: 22 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 55 cost time: 0.9156322479248047
Epoch: 55, Steps: 64 | Train Loss: 0.0750479 Vali Loss: 0.1391784 Test Loss: 0.1308699
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 56 cost time: 0.9204118251800537
Epoch: 56, Steps: 64 | Train Loss: 0.0752939 Vali Loss: 0.1379386 Test Loss: 0.1309113
EarlyStopping counter: 24 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 57 cost time: 0.9181652069091797
Epoch: 57, Steps: 64 | Train Loss: 0.0752495 Vali Loss: 0.1375236 Test Loss: 0.1303793
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 58 cost time: 0.9323759078979492
Epoch: 58, Steps: 64 | Train Loss: 0.0750979 Vali Loss: 0.1376719 Test Loss: 0.1307500
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 59 cost time: 0.9364814758300781
Epoch: 59, Steps: 64 | Train Loss: 0.0753349 Vali Loss: 0.1370487 Test Loss: 0.1298922
EarlyStopping counter: 27 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02008819580078125 GB
GPU已分配内存的峰值：0.0642862319946289 GB
Epoch: 60 cost time: 0.9383761882781982
Epoch: 60, Steps: 64 | Train Loss: 0.0753579 Vali Loss: 0.1373239 Test Loss: 0.1303551
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13037154078483582, mae:0.2587897479534149, rse:0.19218185544013977
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06613826751708984 GB
Epoch: 1 cost time: 2.3600881099700928
Epoch: 1, Steps: 64 | Train Loss: 0.7509377 Vali Loss: 1.7040815 Test Loss: 3.2470555
Validation loss decreased (inf --> 1.704082).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 2 cost time: 0.9551272392272949
Epoch: 2, Steps: 64 | Train Loss: 0.2742425 Vali Loss: 0.2260631 Test Loss: 0.2592095
Validation loss decreased (1.704082 --> 0.226063).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 3 cost time: 0.9575526714324951
Epoch: 3, Steps: 64 | Train Loss: 0.0973166 Vali Loss: 0.1693972 Test Loss: 0.1391104
Validation loss decreased (0.226063 --> 0.169397).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 4 cost time: 0.9517910480499268
Epoch: 4, Steps: 64 | Train Loss: 0.0881339 Vali Loss: 0.1629622 Test Loss: 0.1380457
Validation loss decreased (0.169397 --> 0.162962).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 5 cost time: 0.9321727752685547
Epoch: 5, Steps: 64 | Train Loss: 0.0855782 Vali Loss: 0.1601473 Test Loss: 0.1376992
Validation loss decreased (0.162962 --> 0.160147).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 6 cost time: 0.939997673034668
Epoch: 6, Steps: 64 | Train Loss: 0.0834680 Vali Loss: 0.1544185 Test Loss: 0.1363355
Validation loss decreased (0.160147 --> 0.154418).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 7 cost time: 0.9431257247924805
Epoch: 7, Steps: 64 | Train Loss: 0.0820661 Vali Loss: 0.1546956 Test Loss: 0.1368272
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 8 cost time: 0.9366331100463867
Epoch: 8, Steps: 64 | Train Loss: 0.0813846 Vali Loss: 0.1512296 Test Loss: 0.1381740
Validation loss decreased (0.154418 --> 0.151230).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 9 cost time: 0.9588367938995361
Epoch: 9, Steps: 64 | Train Loss: 0.0803766 Vali Loss: 0.1509157 Test Loss: 0.1359897
Validation loss decreased (0.151230 --> 0.150916).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 10 cost time: 0.9603705406188965
Epoch: 10, Steps: 64 | Train Loss: 0.0800359 Vali Loss: 0.1533332 Test Loss: 0.1371666
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 11 cost time: 0.9643700122833252
Epoch: 11, Steps: 64 | Train Loss: 0.0792320 Vali Loss: 0.1491567 Test Loss: 0.1370388
Validation loss decreased (0.150916 --> 0.149157).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 12 cost time: 0.9763681888580322
Epoch: 12, Steps: 64 | Train Loss: 0.0786652 Vali Loss: 0.1460961 Test Loss: 0.1364893
Validation loss decreased (0.149157 --> 0.146096).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 13 cost time: 0.9864609241485596
Epoch: 13, Steps: 64 | Train Loss: 0.0780400 Vali Loss: 0.1471119 Test Loss: 0.1365015
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 14 cost time: 0.9584572315216064
Epoch: 14, Steps: 64 | Train Loss: 0.0773377 Vali Loss: 0.1480107 Test Loss: 0.1374721
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 15 cost time: 0.9534902572631836
Epoch: 15, Steps: 64 | Train Loss: 0.0772789 Vali Loss: 0.1458804 Test Loss: 0.1368907
Validation loss decreased (0.146096 --> 0.145880).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 16 cost time: 0.9537415504455566
Epoch: 16, Steps: 64 | Train Loss: 0.0761685 Vali Loss: 0.1444828 Test Loss: 0.1371280
Validation loss decreased (0.145880 --> 0.144483).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 17 cost time: 0.9594242572784424
Epoch: 17, Steps: 64 | Train Loss: 0.0764367 Vali Loss: 0.1416481 Test Loss: 0.1359749
Validation loss decreased (0.144483 --> 0.141648).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 18 cost time: 0.9649980068206787
Epoch: 18, Steps: 64 | Train Loss: 0.0763046 Vali Loss: 0.1429349 Test Loss: 0.1352251
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 19 cost time: 0.9715175628662109
Epoch: 19, Steps: 64 | Train Loss: 0.0760814 Vali Loss: 0.1407154 Test Loss: 0.1363027
Validation loss decreased (0.141648 --> 0.140715).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 20 cost time: 0.9686079025268555
Epoch: 20, Steps: 64 | Train Loss: 0.0756352 Vali Loss: 0.1415356 Test Loss: 0.1360185
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 21 cost time: 0.9550065994262695
Epoch: 21, Steps: 64 | Train Loss: 0.0758403 Vali Loss: 0.1426655 Test Loss: 0.1361736
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 22 cost time: 0.9454004764556885
Epoch: 22, Steps: 64 | Train Loss: 0.0748642 Vali Loss: 0.1430403 Test Loss: 0.1366199
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 23 cost time: 0.9433727264404297
Epoch: 23, Steps: 64 | Train Loss: 0.0747285 Vali Loss: 0.1409486 Test Loss: 0.1363290
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 24 cost time: 0.9463779926300049
Epoch: 24, Steps: 64 | Train Loss: 0.0748434 Vali Loss: 0.1416839 Test Loss: 0.1355341
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 25 cost time: 0.956425666809082
Epoch: 25, Steps: 64 | Train Loss: 0.0748964 Vali Loss: 0.1395758 Test Loss: 0.1355100
Validation loss decreased (0.140715 --> 0.139576).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 26 cost time: 0.9583740234375
Epoch: 26, Steps: 64 | Train Loss: 0.0747962 Vali Loss: 0.1393388 Test Loss: 0.1356899
Validation loss decreased (0.139576 --> 0.139339).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 27 cost time: 0.9638230800628662
Epoch: 27, Steps: 64 | Train Loss: 0.0743489 Vali Loss: 0.1398148 Test Loss: 0.1359496
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 28 cost time: 0.9408249855041504
Epoch: 28, Steps: 64 | Train Loss: 0.0749950 Vali Loss: 0.1402356 Test Loss: 0.1360012
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 29 cost time: 0.9434232711791992
Epoch: 29, Steps: 64 | Train Loss: 0.0744728 Vali Loss: 0.1398952 Test Loss: 0.1360022
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 30 cost time: 0.9516515731811523
Epoch: 30, Steps: 64 | Train Loss: 0.0741757 Vali Loss: 0.1410525 Test Loss: 0.1359324
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 31 cost time: 0.934645414352417
Epoch: 31, Steps: 64 | Train Loss: 0.0738315 Vali Loss: 0.1398959 Test Loss: 0.1352948
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 32 cost time: 0.966374397277832
Epoch: 32, Steps: 64 | Train Loss: 0.0742151 Vali Loss: 0.1396378 Test Loss: 0.1358138
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 33 cost time: 0.9781241416931152
Epoch: 33, Steps: 64 | Train Loss: 0.0738770 Vali Loss: 0.1390230 Test Loss: 0.1360877
Validation loss decreased (0.139339 --> 0.139023).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 34 cost time: 0.9773805141448975
Epoch: 34, Steps: 64 | Train Loss: 0.0740046 Vali Loss: 0.1411314 Test Loss: 0.1368159
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 35 cost time: 0.9773972034454346
Epoch: 35, Steps: 64 | Train Loss: 0.0739795 Vali Loss: 0.1402566 Test Loss: 0.1353281
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 36 cost time: 0.9683690071105957
Epoch: 36, Steps: 64 | Train Loss: 0.0738254 Vali Loss: 0.1403851 Test Loss: 0.1355102
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 37 cost time: 0.9597363471984863
Epoch: 37, Steps: 64 | Train Loss: 0.0737263 Vali Loss: 0.1385615 Test Loss: 0.1359719
Validation loss decreased (0.139023 --> 0.138562).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 38 cost time: 0.9575066566467285
Epoch: 38, Steps: 64 | Train Loss: 0.0740963 Vali Loss: 0.1373132 Test Loss: 0.1355541
Validation loss decreased (0.138562 --> 0.137313).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 39 cost time: 0.9619033336639404
Epoch: 39, Steps: 64 | Train Loss: 0.0740086 Vali Loss: 0.1403303 Test Loss: 0.1357291
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 40 cost time: 0.974717378616333
Epoch: 40, Steps: 64 | Train Loss: 0.0739053 Vali Loss: 0.1393262 Test Loss: 0.1353601
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 41 cost time: 0.972731351852417
Epoch: 41, Steps: 64 | Train Loss: 0.0741375 Vali Loss: 0.1388655 Test Loss: 0.1349078
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 42 cost time: 0.9726424217224121
Epoch: 42, Steps: 64 | Train Loss: 0.0737400 Vali Loss: 0.1399424 Test Loss: 0.1351722
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 43 cost time: 0.9376437664031982
Epoch: 43, Steps: 64 | Train Loss: 0.0735326 Vali Loss: 0.1403799 Test Loss: 0.1356443
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 44 cost time: 0.9756960868835449
Epoch: 44, Steps: 64 | Train Loss: 0.0738281 Vali Loss: 0.1377043 Test Loss: 0.1357236
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 45 cost time: 0.9692695140838623
Epoch: 45, Steps: 64 | Train Loss: 0.0734607 Vali Loss: 0.1393234 Test Loss: 0.1359898
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 46 cost time: 0.9663703441619873
Epoch: 46, Steps: 64 | Train Loss: 0.0737071 Vali Loss: 0.1389788 Test Loss: 0.1351368
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 47 cost time: 0.9750304222106934
Epoch: 47, Steps: 64 | Train Loss: 0.0733495 Vali Loss: 0.1392945 Test Loss: 0.1359236
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 48 cost time: 0.9757697582244873
Epoch: 48, Steps: 64 | Train Loss: 0.0737411 Vali Loss: 0.1392454 Test Loss: 0.1359073
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 49 cost time: 0.980520486831665
Epoch: 49, Steps: 64 | Train Loss: 0.0735495 Vali Loss: 0.1391194 Test Loss: 0.1352886
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 50 cost time: 0.9543919563293457
Epoch: 50, Steps: 64 | Train Loss: 0.0738035 Vali Loss: 0.1384123 Test Loss: 0.1351101
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 51 cost time: 0.9637610912322998
Epoch: 51, Steps: 64 | Train Loss: 0.0738942 Vali Loss: 0.1394469 Test Loss: 0.1346465
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 52 cost time: 0.93399977684021
Epoch: 52, Steps: 64 | Train Loss: 0.0736400 Vali Loss: 0.1387409 Test Loss: 0.1345162
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 53 cost time: 0.9517543315887451
Epoch: 53, Steps: 64 | Train Loss: 0.0735751 Vali Loss: 0.1392173 Test Loss: 0.1351471
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 54 cost time: 0.9486367702484131
Epoch: 54, Steps: 64 | Train Loss: 0.0739519 Vali Loss: 0.1394032 Test Loss: 0.1353146
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 55 cost time: 0.9614341259002686
Epoch: 55, Steps: 64 | Train Loss: 0.0736858 Vali Loss: 0.1386064 Test Loss: 0.1353994
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 56 cost time: 0.9865422248840332
Epoch: 56, Steps: 64 | Train Loss: 0.0733748 Vali Loss: 0.1394270 Test Loss: 0.1348874
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 57 cost time: 0.9743096828460693
Epoch: 57, Steps: 64 | Train Loss: 0.0736633 Vali Loss: 0.1393097 Test Loss: 0.1353883
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 58 cost time: 0.976494312286377
Epoch: 58, Steps: 64 | Train Loss: 0.0737616 Vali Loss: 0.1390987 Test Loss: 0.1356389
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 59 cost time: 0.9754586219787598
Epoch: 59, Steps: 64 | Train Loss: 0.0735824 Vali Loss: 0.1396911 Test Loss: 0.1356431
EarlyStopping counter: 21 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0210723876953125 GB
GPU已分配内存的峰值：0.06807708740234375 GB
Epoch: 60 cost time: 0.9544017314910889
Epoch: 60, Steps: 64 | Train Loss: 0.0730615 Vali Loss: 0.1393606 Test Loss: 0.1348194
EarlyStopping counter: 22 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13555407524108887, mae:0.26775452494621277, rse:0.19596442580223083
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.05860710144042969 GB
Epoch: 1 cost time: 2.279252052307129
Epoch: 1, Steps: 64 | Train Loss: 0.8738274 Vali Loss: 1.9361438 Test Loss: 3.6615856
Validation loss decreased (inf --> 1.936144).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 2 cost time: 0.8963766098022461
Epoch: 2, Steps: 64 | Train Loss: 0.5927220 Vali Loss: 0.8111328 Test Loss: 1.3300745
Validation loss decreased (1.936144 --> 0.811133).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 3 cost time: 0.8929550647735596
Epoch: 3, Steps: 64 | Train Loss: 0.3060633 Vali Loss: 0.4764532 Test Loss: 0.6619740
Validation loss decreased (0.811133 --> 0.476453).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 4 cost time: 0.8857238292694092
Epoch: 4, Steps: 64 | Train Loss: 0.1933705 Vali Loss: 0.3158941 Test Loss: 0.3628617
Validation loss decreased (0.476453 --> 0.315894).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 5 cost time: 0.8640005588531494
Epoch: 5, Steps: 64 | Train Loss: 0.1413955 Vali Loss: 0.2424310 Test Loss: 0.2396387
Validation loss decreased (0.315894 --> 0.242431).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 6 cost time: 0.8730068206787109
Epoch: 6, Steps: 64 | Train Loss: 0.1188773 Vali Loss: 0.2081732 Test Loss: 0.1850189
Validation loss decreased (0.242431 --> 0.208173).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 7 cost time: 0.8644521236419678
Epoch: 7, Steps: 64 | Train Loss: 0.1091309 Vali Loss: 0.1914784 Test Loss: 0.1629036
Validation loss decreased (0.208173 --> 0.191478).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 8 cost time: 0.8673558235168457
Epoch: 8, Steps: 64 | Train Loss: 0.1037025 Vali Loss: 0.1806578 Test Loss: 0.1511707
Validation loss decreased (0.191478 --> 0.180658).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 9 cost time: 0.886439323425293
Epoch: 9, Steps: 64 | Train Loss: 0.0992859 Vali Loss: 0.1723429 Test Loss: 0.1461723
Validation loss decreased (0.180658 --> 0.172343).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 10 cost time: 0.8887364864349365
Epoch: 10, Steps: 64 | Train Loss: 0.0979257 Vali Loss: 0.1714389 Test Loss: 0.1432578
Validation loss decreased (0.172343 --> 0.171439).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 11 cost time: 0.8896338939666748
Epoch: 11, Steps: 64 | Train Loss: 0.0963657 Vali Loss: 0.1679281 Test Loss: 0.1412758
Validation loss decreased (0.171439 --> 0.167928).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 12 cost time: 0.9096345901489258
Epoch: 12, Steps: 64 | Train Loss: 0.0949078 Vali Loss: 0.1643158 Test Loss: 0.1402476
Validation loss decreased (0.167928 --> 0.164316).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 13 cost time: 0.908649206161499
Epoch: 13, Steps: 64 | Train Loss: 0.0942717 Vali Loss: 0.1647015 Test Loss: 0.1397382
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 14 cost time: 0.8854491710662842
Epoch: 14, Steps: 64 | Train Loss: 0.0928771 Vali Loss: 0.1620628 Test Loss: 0.1386687
Validation loss decreased (0.164316 --> 0.162063).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 15 cost time: 0.8853743076324463
Epoch: 15, Steps: 64 | Train Loss: 0.0924878 Vali Loss: 0.1619908 Test Loss: 0.1384820
Validation loss decreased (0.162063 --> 0.161991).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 16 cost time: 0.8904380798339844
Epoch: 16, Steps: 64 | Train Loss: 0.0923583 Vali Loss: 0.1610861 Test Loss: 0.1378310
Validation loss decreased (0.161991 --> 0.161086).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 17 cost time: 0.8827788829803467
Epoch: 17, Steps: 64 | Train Loss: 0.0910905 Vali Loss: 0.1560365 Test Loss: 0.1370674
Validation loss decreased (0.161086 --> 0.156036).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 18 cost time: 0.9049994945526123
Epoch: 18, Steps: 64 | Train Loss: 0.0909885 Vali Loss: 0.1599973 Test Loss: 0.1374801
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 19 cost time: 0.9060242176055908
Epoch: 19, Steps: 64 | Train Loss: 0.0898488 Vali Loss: 0.1593380 Test Loss: 0.1370250
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 20 cost time: 0.9044742584228516
Epoch: 20, Steps: 64 | Train Loss: 0.0897724 Vali Loss: 0.1591663 Test Loss: 0.1369649
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 21 cost time: 0.9013772010803223
Epoch: 21, Steps: 64 | Train Loss: 0.0896665 Vali Loss: 0.1569490 Test Loss: 0.1366016
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 22 cost time: 0.8903474807739258
Epoch: 22, Steps: 64 | Train Loss: 0.0888088 Vali Loss: 0.1586190 Test Loss: 0.1368607
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 23 cost time: 0.8718278408050537
Epoch: 23, Steps: 64 | Train Loss: 0.0887775 Vali Loss: 0.1567502 Test Loss: 0.1366339
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 24 cost time: 0.8696377277374268
Epoch: 24, Steps: 64 | Train Loss: 0.0886588 Vali Loss: 0.1575642 Test Loss: 0.1363272
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 25 cost time: 0.8686189651489258
Epoch: 25, Steps: 64 | Train Loss: 0.0881603 Vali Loss: 0.1562401 Test Loss: 0.1366848
EarlyStopping counter: 8 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 26 cost time: 0.8793771266937256
Epoch: 26, Steps: 64 | Train Loss: 0.0886373 Vali Loss: 0.1547553 Test Loss: 0.1366175
Validation loss decreased (0.156036 --> 0.154755).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 27 cost time: 0.887413501739502
Epoch: 27, Steps: 64 | Train Loss: 0.0883639 Vali Loss: 0.1565058 Test Loss: 0.1364447
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 28 cost time: 0.886420488357544
Epoch: 28, Steps: 64 | Train Loss: 0.0877751 Vali Loss: 0.1554688 Test Loss: 0.1363900
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 29 cost time: 0.9216160774230957
Epoch: 29, Steps: 64 | Train Loss: 0.0876398 Vali Loss: 0.1555431 Test Loss: 0.1365304
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 30 cost time: 0.8767409324645996
Epoch: 30, Steps: 64 | Train Loss: 0.0875035 Vali Loss: 0.1557888 Test Loss: 0.1363811
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 31 cost time: 0.8580000400543213
Epoch: 31, Steps: 64 | Train Loss: 0.0875100 Vali Loss: 0.1540357 Test Loss: 0.1360399
Validation loss decreased (0.154755 --> 0.154036).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 32 cost time: 0.8563764095306396
Epoch: 32, Steps: 64 | Train Loss: 0.0869927 Vali Loss: 0.1550846 Test Loss: 0.1363337
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 33 cost time: 0.8559854030609131
Epoch: 33, Steps: 64 | Train Loss: 0.0870490 Vali Loss: 0.1563002 Test Loss: 0.1364393
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 34 cost time: 0.8724679946899414
Epoch: 34, Steps: 64 | Train Loss: 0.0873081 Vali Loss: 0.1542821 Test Loss: 0.1362523
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 35 cost time: 0.9118309020996094
Epoch: 35, Steps: 64 | Train Loss: 0.0869173 Vali Loss: 0.1550132 Test Loss: 0.1360771
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 36 cost time: 0.9052786827087402
Epoch: 36, Steps: 64 | Train Loss: 0.0869348 Vali Loss: 0.1555727 Test Loss: 0.1363136
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 37 cost time: 0.9083652496337891
Epoch: 37, Steps: 64 | Train Loss: 0.0867621 Vali Loss: 0.1545865 Test Loss: 0.1362868
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 38 cost time: 0.9186460971832275
Epoch: 38, Steps: 64 | Train Loss: 0.0874519 Vali Loss: 0.1525141 Test Loss: 0.1360953
Validation loss decreased (0.154036 --> 0.152514).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 39 cost time: 0.9004607200622559
Epoch: 39, Steps: 64 | Train Loss: 0.0868435 Vali Loss: 0.1527317 Test Loss: 0.1362940
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 40 cost time: 0.9025101661682129
Epoch: 40, Steps: 64 | Train Loss: 0.0865420 Vali Loss: 0.1545967 Test Loss: 0.1360838
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 41 cost time: 0.9054648876190186
Epoch: 41, Steps: 64 | Train Loss: 0.0868177 Vali Loss: 0.1539393 Test Loss: 0.1360872
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 42 cost time: 0.8867859840393066
Epoch: 42, Steps: 64 | Train Loss: 0.0863807 Vali Loss: 0.1529098 Test Loss: 0.1360093
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 43 cost time: 0.8883788585662842
Epoch: 43, Steps: 64 | Train Loss: 0.0867871 Vali Loss: 0.1534331 Test Loss: 0.1361211
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 44 cost time: 0.8976233005523682
Epoch: 44, Steps: 64 | Train Loss: 0.0865225 Vali Loss: 0.1549149 Test Loss: 0.1361795
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 45 cost time: 0.9126722812652588
Epoch: 45, Steps: 64 | Train Loss: 0.0866524 Vali Loss: 0.1548164 Test Loss: 0.1360956
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 46 cost time: 0.9034454822540283
Epoch: 46, Steps: 64 | Train Loss: 0.0865410 Vali Loss: 0.1557815 Test Loss: 0.1362531
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 47 cost time: 0.898374080657959
Epoch: 47, Steps: 64 | Train Loss: 0.0863618 Vali Loss: 0.1545027 Test Loss: 0.1360260
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 48 cost time: 0.9004611968994141
Epoch: 48, Steps: 64 | Train Loss: 0.0859057 Vali Loss: 0.1518512 Test Loss: 0.1359101
Validation loss decreased (0.152514 --> 0.151851).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 49 cost time: 0.8585317134857178
Epoch: 49, Steps: 64 | Train Loss: 0.0867097 Vali Loss: 0.1522018 Test Loss: 0.1361409
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 50 cost time: 0.860403299331665
Epoch: 50, Steps: 64 | Train Loss: 0.0861058 Vali Loss: 0.1509139 Test Loss: 0.1360575
Validation loss decreased (0.151851 --> 0.150914).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 51 cost time: 0.8586628437042236
Epoch: 51, Steps: 64 | Train Loss: 0.0867622 Vali Loss: 0.1544787 Test Loss: 0.1361446
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 52 cost time: 0.8805394172668457
Epoch: 52, Steps: 64 | Train Loss: 0.0864321 Vali Loss: 0.1556695 Test Loss: 0.1362561
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 53 cost time: 0.8833460807800293
Epoch: 53, Steps: 64 | Train Loss: 0.0864366 Vali Loss: 0.1535662 Test Loss: 0.1361082
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 54 cost time: 0.8823747634887695
Epoch: 54, Steps: 64 | Train Loss: 0.0862790 Vali Loss: 0.1544112 Test Loss: 0.1361561
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 55 cost time: 0.8837943077087402
Epoch: 55, Steps: 64 | Train Loss: 0.0862849 Vali Loss: 0.1537465 Test Loss: 0.1361725
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 56 cost time: 0.8709990978240967
Epoch: 56, Steps: 64 | Train Loss: 0.0861749 Vali Loss: 0.1531925 Test Loss: 0.1359052
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 57 cost time: 0.8776311874389648
Epoch: 57, Steps: 64 | Train Loss: 0.0860611 Vali Loss: 0.1554042 Test Loss: 0.1361575
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 58 cost time: 0.8764495849609375
Epoch: 58, Steps: 64 | Train Loss: 0.0862310 Vali Loss: 0.1531597 Test Loss: 0.1362288
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 59 cost time: 0.8850569725036621
Epoch: 59, Steps: 64 | Train Loss: 0.0861876 Vali Loss: 0.1522216 Test Loss: 0.1361786
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0181427001953125 GB
GPU已分配内存的峰值：0.059081077575683594 GB
Epoch: 60 cost time: 0.8854234218597412
Epoch: 60, Steps: 64 | Train Loss: 0.0867148 Vali Loss: 0.1547261 Test Loss: 0.1361222
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1360575258731842, mae:0.26442041993141174, rse:0.19632801413536072
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.06300163269042969 GB
Epoch: 1 cost time: 2.3456692695617676
Epoch: 1, Steps: 64 | Train Loss: 0.8497980 Vali Loss: 1.9282666 Test Loss: 3.6987338
Validation loss decreased (inf --> 1.928267).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 2 cost time: 0.959453821182251
Epoch: 2, Steps: 64 | Train Loss: 0.4138985 Vali Loss: 0.2129031 Test Loss: 0.1638564
Validation loss decreased (1.928267 --> 0.212903).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 3 cost time: 0.919358491897583
Epoch: 3, Steps: 64 | Train Loss: 0.1024521 Vali Loss: 0.1771984 Test Loss: 0.1447740
Validation loss decreased (0.212903 --> 0.177198).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 4 cost time: 0.9408292770385742
Epoch: 4, Steps: 64 | Train Loss: 0.0912225 Vali Loss: 0.1656911 Test Loss: 0.1389565
Validation loss decreased (0.177198 --> 0.165691).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 5 cost time: 0.9460000991821289
Epoch: 5, Steps: 64 | Train Loss: 0.0870896 Vali Loss: 0.1609643 Test Loss: 0.1390675
Validation loss decreased (0.165691 --> 0.160964).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 6 cost time: 0.8999981880187988
Epoch: 6, Steps: 64 | Train Loss: 0.0850759 Vali Loss: 0.1578158 Test Loss: 0.1385328
Validation loss decreased (0.160964 --> 0.157816).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 7 cost time: 0.8980963230133057
Epoch: 7, Steps: 64 | Train Loss: 0.0843095 Vali Loss: 0.1566992 Test Loss: 0.1371346
Validation loss decreased (0.157816 --> 0.156699).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 8 cost time: 0.9036359786987305
Epoch: 8, Steps: 64 | Train Loss: 0.0823591 Vali Loss: 0.1510674 Test Loss: 0.1372700
Validation loss decreased (0.156699 --> 0.151067).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 9 cost time: 0.9393928050994873
Epoch: 9, Steps: 64 | Train Loss: 0.0813979 Vali Loss: 0.1507095 Test Loss: 0.1355102
Validation loss decreased (0.151067 --> 0.150709).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 10 cost time: 0.9243483543395996
Epoch: 10, Steps: 64 | Train Loss: 0.0804786 Vali Loss: 0.1529287 Test Loss: 0.1380202
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 11 cost time: 0.9304144382476807
Epoch: 11, Steps: 64 | Train Loss: 0.0797291 Vali Loss: 0.1509269 Test Loss: 0.1379032
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 12 cost time: 0.9560337066650391
Epoch: 12, Steps: 64 | Train Loss: 0.0791766 Vali Loss: 0.1484490 Test Loss: 0.1368668
Validation loss decreased (0.150709 --> 0.148449).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 13 cost time: 0.9307796955108643
Epoch: 13, Steps: 64 | Train Loss: 0.0786887 Vali Loss: 0.1484543 Test Loss: 0.1365330
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 14 cost time: 0.9249985218048096
Epoch: 14, Steps: 64 | Train Loss: 0.0784640 Vali Loss: 0.1494153 Test Loss: 0.1387552
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 15 cost time: 0.9240000247955322
Epoch: 15, Steps: 64 | Train Loss: 0.0777338 Vali Loss: 0.1468612 Test Loss: 0.1363273
Validation loss decreased (0.148449 --> 0.146861).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 16 cost time: 0.910006046295166
Epoch: 16, Steps: 64 | Train Loss: 0.0777175 Vali Loss: 0.1484171 Test Loss: 0.1376127
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 17 cost time: 0.9486339092254639
Epoch: 17, Steps: 64 | Train Loss: 0.0772142 Vali Loss: 0.1466373 Test Loss: 0.1369950
Validation loss decreased (0.146861 --> 0.146637).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 18 cost time: 0.9503908157348633
Epoch: 18, Steps: 64 | Train Loss: 0.0768977 Vali Loss: 0.1445261 Test Loss: 0.1370671
Validation loss decreased (0.146637 --> 0.144526).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 19 cost time: 0.9544222354888916
Epoch: 19, Steps: 64 | Train Loss: 0.0767021 Vali Loss: 0.1458976 Test Loss: 0.1371860
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 20 cost time: 0.9464766979217529
Epoch: 20, Steps: 64 | Train Loss: 0.0760746 Vali Loss: 0.1466938 Test Loss: 0.1373528
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 21 cost time: 0.9438331127166748
Epoch: 21, Steps: 64 | Train Loss: 0.0759942 Vali Loss: 0.1467388 Test Loss: 0.1371418
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 22 cost time: 0.9457449913024902
Epoch: 22, Steps: 64 | Train Loss: 0.0757638 Vali Loss: 0.1452280 Test Loss: 0.1373329
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 23 cost time: 0.9019999504089355
Epoch: 23, Steps: 64 | Train Loss: 0.0758434 Vali Loss: 0.1466670 Test Loss: 0.1382862
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 24 cost time: 0.9027488231658936
Epoch: 24, Steps: 64 | Train Loss: 0.0762703 Vali Loss: 0.1451979 Test Loss: 0.1371129
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 25 cost time: 0.9246490001678467
Epoch: 25, Steps: 64 | Train Loss: 0.0756703 Vali Loss: 0.1443159 Test Loss: 0.1369587
Validation loss decreased (0.144526 --> 0.144316).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 26 cost time: 0.9344301223754883
Epoch: 26, Steps: 64 | Train Loss: 0.0756240 Vali Loss: 0.1449610 Test Loss: 0.1373325
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 27 cost time: 0.923382043838501
Epoch: 27, Steps: 64 | Train Loss: 0.0751417 Vali Loss: 0.1460156 Test Loss: 0.1380956
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 28 cost time: 0.9203925132751465
Epoch: 28, Steps: 64 | Train Loss: 0.0753483 Vali Loss: 0.1446343 Test Loss: 0.1374364
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 29 cost time: 0.9121379852294922
Epoch: 29, Steps: 64 | Train Loss: 0.0749762 Vali Loss: 0.1448987 Test Loss: 0.1369418
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 30 cost time: 0.8937568664550781
Epoch: 30, Steps: 64 | Train Loss: 0.0754627 Vali Loss: 0.1452687 Test Loss: 0.1373185
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 31 cost time: 0.9060008525848389
Epoch: 31, Steps: 64 | Train Loss: 0.0749613 Vali Loss: 0.1432775 Test Loss: 0.1367520
Validation loss decreased (0.144316 --> 0.143278).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 32 cost time: 0.9040000438690186
Epoch: 32, Steps: 64 | Train Loss: 0.0751148 Vali Loss: 0.1453113 Test Loss: 0.1373630
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 33 cost time: 0.9332606792449951
Epoch: 33, Steps: 64 | Train Loss: 0.0752457 Vali Loss: 0.1448088 Test Loss: 0.1372801
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 34 cost time: 0.9473757743835449
Epoch: 34, Steps: 64 | Train Loss: 0.0751817 Vali Loss: 0.1448266 Test Loss: 0.1372741
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 35 cost time: 0.9554316997528076
Epoch: 35, Steps: 64 | Train Loss: 0.0750332 Vali Loss: 0.1417794 Test Loss: 0.1371084
Validation loss decreased (0.143278 --> 0.141779).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 36 cost time: 0.95560622215271
Epoch: 36, Steps: 64 | Train Loss: 0.0747887 Vali Loss: 0.1456688 Test Loss: 0.1374554
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 37 cost time: 0.9300234317779541
Epoch: 37, Steps: 64 | Train Loss: 0.0750308 Vali Loss: 0.1455080 Test Loss: 0.1374546
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 38 cost time: 0.9253771305084229
Epoch: 38, Steps: 64 | Train Loss: 0.0748084 Vali Loss: 0.1450133 Test Loss: 0.1375733
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 39 cost time: 0.9317681789398193
Epoch: 39, Steps: 64 | Train Loss: 0.0747682 Vali Loss: 0.1448784 Test Loss: 0.1373768
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 40 cost time: 0.9269993305206299
Epoch: 40, Steps: 64 | Train Loss: 0.0751137 Vali Loss: 0.1442352 Test Loss: 0.1379485
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 41 cost time: 0.938352108001709
Epoch: 41, Steps: 64 | Train Loss: 0.0747838 Vali Loss: 0.1442891 Test Loss: 0.1372703
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 42 cost time: 0.9566268920898438
Epoch: 42, Steps: 64 | Train Loss: 0.0747096 Vali Loss: 0.1443036 Test Loss: 0.1374699
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 43 cost time: 0.9493875503540039
Epoch: 43, Steps: 64 | Train Loss: 0.0748928 Vali Loss: 0.1448815 Test Loss: 0.1373945
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 44 cost time: 0.9443819522857666
Epoch: 44, Steps: 64 | Train Loss: 0.0747886 Vali Loss: 0.1449286 Test Loss: 0.1371042
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 45 cost time: 0.9463052749633789
Epoch: 45, Steps: 64 | Train Loss: 0.0748541 Vali Loss: 0.1447099 Test Loss: 0.1375447
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 46 cost time: 0.919370174407959
Epoch: 46, Steps: 64 | Train Loss: 0.0746242 Vali Loss: 0.1444464 Test Loss: 0.1377285
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 47 cost time: 0.9094090461730957
Epoch: 47, Steps: 64 | Train Loss: 0.0745742 Vali Loss: 0.1450025 Test Loss: 0.1370886
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 48 cost time: 0.9097321033477783
Epoch: 48, Steps: 64 | Train Loss: 0.0747873 Vali Loss: 0.1434459 Test Loss: 0.1372960
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 49 cost time: 0.9158201217651367
Epoch: 49, Steps: 64 | Train Loss: 0.0744652 Vali Loss: 0.1415983 Test Loss: 0.1373101
Validation loss decreased (0.141779 --> 0.141598).  Saving model ...
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 50 cost time: 0.9226417541503906
Epoch: 50, Steps: 64 | Train Loss: 0.0744486 Vali Loss: 0.1423159 Test Loss: 0.1370517
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 51 cost time: 0.9310197830200195
Epoch: 51, Steps: 64 | Train Loss: 0.0743774 Vali Loss: 0.1451513 Test Loss: 0.1375907
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 52 cost time: 0.9274599552154541
Epoch: 52, Steps: 64 | Train Loss: 0.0743346 Vali Loss: 0.1452618 Test Loss: 0.1371961
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 53 cost time: 0.917382001876831
Epoch: 53, Steps: 64 | Train Loss: 0.0744433 Vali Loss: 0.1448515 Test Loss: 0.1373877
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 54 cost time: 0.9050018787384033
Epoch: 54, Steps: 64 | Train Loss: 0.0747887 Vali Loss: 0.1435533 Test Loss: 0.1368506
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 55 cost time: 0.9213855266571045
Epoch: 55, Steps: 64 | Train Loss: 0.0746910 Vali Loss: 0.1437264 Test Loss: 0.1368690
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 56 cost time: 0.9317328929901123
Epoch: 56, Steps: 64 | Train Loss: 0.0746717 Vali Loss: 0.1430912 Test Loss: 0.1372478
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 57 cost time: 0.9250001907348633
Epoch: 57, Steps: 64 | Train Loss: 0.0745389 Vali Loss: 0.1449511 Test Loss: 0.1371098
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 58 cost time: 0.9443967342376709
Epoch: 58, Steps: 64 | Train Loss: 0.0747055 Vali Loss: 0.1436232 Test Loss: 0.1370779
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 59 cost time: 0.9446403980255127
Epoch: 59, Steps: 64 | Train Loss: 0.0742398 Vali Loss: 0.1443982 Test Loss: 0.1372346
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0200958251953125 GB
GPU已分配内存的峰值：0.0644521713256836 GB
Epoch: 60 cost time: 0.9463651180267334
Epoch: 60, Steps: 64 | Train Loss: 0.0745990 Vali Loss: 0.1453508 Test Loss: 0.1372097
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13731007277965546, mae:0.26839569211006165, rse:0.19722962379455566
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=64, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=64, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.0663003921508789 GB
Epoch: 1 cost time: 2.3482589721679688
Epoch: 1, Steps: 64 | Train Loss: 0.7804071 Vali Loss: 1.7868080 Test Loss: 3.4115019
Validation loss decreased (inf --> 1.786808).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 2 cost time: 0.9622128009796143
Epoch: 2, Steps: 64 | Train Loss: 0.3061446 Vali Loss: 0.2615528 Test Loss: 0.3537809
Validation loss decreased (1.786808 --> 0.261553).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 3 cost time: 0.9706323146820068
Epoch: 3, Steps: 64 | Train Loss: 0.0998035 Vali Loss: 0.1603463 Test Loss: 0.1373576
Validation loss decreased (0.261553 --> 0.160346).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 4 cost time: 0.9583518505096436
Epoch: 4, Steps: 64 | Train Loss: 0.0888703 Vali Loss: 0.1616969 Test Loss: 0.1381158
EarlyStopping counter: 1 out of 100
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 5 cost time: 0.930351972579956
Epoch: 5, Steps: 64 | Train Loss: 0.0864752 Vali Loss: 0.1595519 Test Loss: 0.1361364
Validation loss decreased (0.160346 --> 0.159552).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 6 cost time: 0.9433376789093018
Epoch: 6, Steps: 64 | Train Loss: 0.0845143 Vali Loss: 0.1529318 Test Loss: 0.1347027
Validation loss decreased (0.159552 --> 0.152932).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 7 cost time: 0.9350180625915527
Epoch: 7, Steps: 64 | Train Loss: 0.0830076 Vali Loss: 0.1525141 Test Loss: 0.1349227
Validation loss decreased (0.152932 --> 0.152514).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 8 cost time: 0.9524059295654297
Epoch: 8, Steps: 64 | Train Loss: 0.0816106 Vali Loss: 0.1529721 Test Loss: 0.1347433
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 9 cost time: 0.986396074295044
Epoch: 9, Steps: 64 | Train Loss: 0.0808451 Vali Loss: 0.1485670 Test Loss: 0.1338922
Validation loss decreased (0.152514 --> 0.148567).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 10 cost time: 0.9587242603302002
Epoch: 10, Steps: 64 | Train Loss: 0.0802238 Vali Loss: 0.1491932 Test Loss: 0.1339030
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 11 cost time: 0.9663643836975098
Epoch: 11, Steps: 64 | Train Loss: 0.0797543 Vali Loss: 0.1475488 Test Loss: 0.1337547
Validation loss decreased (0.148567 --> 0.147549).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 12 cost time: 0.9737246036529541
Epoch: 12, Steps: 64 | Train Loss: 0.0789217 Vali Loss: 0.1472128 Test Loss: 0.1343117
Validation loss decreased (0.147549 --> 0.147213).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 13 cost time: 0.9619998931884766
Epoch: 13, Steps: 64 | Train Loss: 0.0783922 Vali Loss: 0.1463426 Test Loss: 0.1340799
Validation loss decreased (0.147213 --> 0.146343).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 14 cost time: 0.9526183605194092
Epoch: 14, Steps: 64 | Train Loss: 0.0776639 Vali Loss: 0.1448980 Test Loss: 0.1335415
Validation loss decreased (0.146343 --> 0.144898).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 15 cost time: 0.9636468887329102
Epoch: 15, Steps: 64 | Train Loss: 0.0774611 Vali Loss: 0.1454645 Test Loss: 0.1337438
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 16 cost time: 0.9716408252716064
Epoch: 16, Steps: 64 | Train Loss: 0.0772599 Vali Loss: 0.1423634 Test Loss: 0.1335325
Validation loss decreased (0.144898 --> 0.142363).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 17 cost time: 0.9823892116546631
Epoch: 17, Steps: 64 | Train Loss: 0.0767884 Vali Loss: 0.1442751 Test Loss: 0.1336099
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 18 cost time: 0.9433932304382324
Epoch: 18, Steps: 64 | Train Loss: 0.0767171 Vali Loss: 0.1417070 Test Loss: 0.1340407
Validation loss decreased (0.142363 --> 0.141707).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 19 cost time: 0.9940197467803955
Epoch: 19, Steps: 64 | Train Loss: 0.0763509 Vali Loss: 0.1417129 Test Loss: 0.1334820
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 20 cost time: 0.9734776020050049
Epoch: 20, Steps: 64 | Train Loss: 0.0760257 Vali Loss: 0.1425520 Test Loss: 0.1339366
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 21 cost time: 0.9593608379364014
Epoch: 21, Steps: 64 | Train Loss: 0.0760176 Vali Loss: 0.1416436 Test Loss: 0.1337530
Validation loss decreased (0.141707 --> 0.141644).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 22 cost time: 0.944523811340332
Epoch: 22, Steps: 64 | Train Loss: 0.0754683 Vali Loss: 0.1411164 Test Loss: 0.1336507
Validation loss decreased (0.141644 --> 0.141116).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 23 cost time: 0.9378910064697266
Epoch: 23, Steps: 64 | Train Loss: 0.0755796 Vali Loss: 0.1402728 Test Loss: 0.1339346
Validation loss decreased (0.141116 --> 0.140273).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 24 cost time: 0.9527559280395508
Epoch: 24, Steps: 64 | Train Loss: 0.0753580 Vali Loss: 0.1400239 Test Loss: 0.1337000
Validation loss decreased (0.140273 --> 0.140024).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 25 cost time: 0.9629983901977539
Epoch: 25, Steps: 64 | Train Loss: 0.0753287 Vali Loss: 0.1387464 Test Loss: 0.1335259
Validation loss decreased (0.140024 --> 0.138746).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 26 cost time: 0.955998420715332
Epoch: 26, Steps: 64 | Train Loss: 0.0753920 Vali Loss: 0.1402703 Test Loss: 0.1337009
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 27 cost time: 0.9556667804718018
Epoch: 27, Steps: 64 | Train Loss: 0.0745891 Vali Loss: 0.1403449 Test Loss: 0.1337193
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 28 cost time: 0.936368465423584
Epoch: 28, Steps: 64 | Train Loss: 0.0750929 Vali Loss: 0.1403862 Test Loss: 0.1332681
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 29 cost time: 0.9405992031097412
Epoch: 29, Steps: 64 | Train Loss: 0.0747848 Vali Loss: 0.1400994 Test Loss: 0.1336655
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 30 cost time: 0.9313592910766602
Epoch: 30, Steps: 64 | Train Loss: 0.0750155 Vali Loss: 0.1394887 Test Loss: 0.1334298
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 31 cost time: 0.976043701171875
Epoch: 31, Steps: 64 | Train Loss: 0.0748908 Vali Loss: 0.1400063 Test Loss: 0.1338253
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 32 cost time: 0.9764935970306396
Epoch: 32, Steps: 64 | Train Loss: 0.0746511 Vali Loss: 0.1385556 Test Loss: 0.1335985
Validation loss decreased (0.138746 --> 0.138556).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 33 cost time: 0.9853687286376953
Epoch: 33, Steps: 64 | Train Loss: 0.0743186 Vali Loss: 0.1403495 Test Loss: 0.1341303
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 34 cost time: 0.9864671230316162
Epoch: 34, Steps: 64 | Train Loss: 0.0746197 Vali Loss: 0.1393932 Test Loss: 0.1338882
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 35 cost time: 0.9925036430358887
Epoch: 35, Steps: 64 | Train Loss: 0.0745281 Vali Loss: 0.1387410 Test Loss: 0.1340584
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 36 cost time: 0.9568123817443848
Epoch: 36, Steps: 64 | Train Loss: 0.0745569 Vali Loss: 0.1389841 Test Loss: 0.1343509
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 37 cost time: 0.9680004119873047
Epoch: 37, Steps: 64 | Train Loss: 0.0746160 Vali Loss: 0.1398338 Test Loss: 0.1335748
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 38 cost time: 0.9567036628723145
Epoch: 38, Steps: 64 | Train Loss: 0.0744208 Vali Loss: 0.1375942 Test Loss: 0.1340733
Validation loss decreased (0.138556 --> 0.137594).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 39 cost time: 0.9606709480285645
Epoch: 39, Steps: 64 | Train Loss: 0.0746312 Vali Loss: 0.1377239 Test Loss: 0.1341987
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 40 cost time: 0.9864101409912109
Epoch: 40, Steps: 64 | Train Loss: 0.0744478 Vali Loss: 0.1388379 Test Loss: 0.1335005
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 41 cost time: 0.9794559478759766
Epoch: 41, Steps: 64 | Train Loss: 0.0746280 Vali Loss: 0.1395778 Test Loss: 0.1337999
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 42 cost time: 0.9924337863922119
Epoch: 42, Steps: 64 | Train Loss: 0.0744735 Vali Loss: 0.1400518 Test Loss: 0.1337227
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 43 cost time: 0.9734127521514893
Epoch: 43, Steps: 64 | Train Loss: 0.0743757 Vali Loss: 0.1373929 Test Loss: 0.1343386
Validation loss decreased (0.137594 --> 0.137393).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 44 cost time: 0.9364449977874756
Epoch: 44, Steps: 64 | Train Loss: 0.0742572 Vali Loss: 0.1397133 Test Loss: 0.1333545
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 45 cost time: 0.9474995136260986
Epoch: 45, Steps: 64 | Train Loss: 0.0742590 Vali Loss: 0.1386960 Test Loss: 0.1339590
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 46 cost time: 0.9374003410339355
Epoch: 46, Steps: 64 | Train Loss: 0.0746938 Vali Loss: 0.1386841 Test Loss: 0.1331010
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 47 cost time: 0.9294400215148926
Epoch: 47, Steps: 64 | Train Loss: 0.0740794 Vali Loss: 0.1385975 Test Loss: 0.1339376
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 48 cost time: 0.9638943672180176
Epoch: 48, Steps: 64 | Train Loss: 0.0742759 Vali Loss: 0.1387029 Test Loss: 0.1342723
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 49 cost time: 0.9599997997283936
Epoch: 49, Steps: 64 | Train Loss: 0.0742135 Vali Loss: 0.1378397 Test Loss: 0.1337192
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 50 cost time: 0.9606332778930664
Epoch: 50, Steps: 64 | Train Loss: 0.0742035 Vali Loss: 0.1386468 Test Loss: 0.1331650
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 51 cost time: 0.9616315364837646
Epoch: 51, Steps: 64 | Train Loss: 0.0743599 Vali Loss: 0.1383931 Test Loss: 0.1340479
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 52 cost time: 0.9673755168914795
Epoch: 52, Steps: 64 | Train Loss: 0.0744089 Vali Loss: 0.1385226 Test Loss: 0.1338416
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 53 cost time: 0.978388786315918
Epoch: 53, Steps: 64 | Train Loss: 0.0740234 Vali Loss: 0.1376190 Test Loss: 0.1334087
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 54 cost time: 0.9775831699371338
Epoch: 54, Steps: 64 | Train Loss: 0.0740068 Vali Loss: 0.1392657 Test Loss: 0.1336046
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 55 cost time: 0.9881229400634766
Epoch: 55, Steps: 64 | Train Loss: 0.0742244 Vali Loss: 0.1371429 Test Loss: 0.1338236
Validation loss decreased (0.137393 --> 0.137143).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 56 cost time: 0.9803452491760254
Epoch: 56, Steps: 64 | Train Loss: 0.0739295 Vali Loss: 0.1388820 Test Loss: 0.1333920
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 57 cost time: 0.9873900413513184
Epoch: 57, Steps: 64 | Train Loss: 0.0742675 Vali Loss: 0.1389443 Test Loss: 0.1336033
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 58 cost time: 0.9943222999572754
Epoch: 58, Steps: 64 | Train Loss: 0.0739030 Vali Loss: 0.1383688 Test Loss: 0.1333725
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 59 cost time: 0.9804365634918213
Epoch: 59, Steps: 64 | Train Loss: 0.0741230 Vali Loss: 0.1371014 Test Loss: 0.1337023
Validation loss decreased (0.137143 --> 0.137101).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02108001708984375 GB
GPU已分配内存的峰值：0.06824302673339844 GB
Epoch: 60 cost time: 0.959747314453125
Epoch: 60, Steps: 64 | Train Loss: 0.0741396 Vali Loss: 0.1384622 Test Loss: 0.1339346
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df64_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_64__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13370226323604584, mae:0.26252132654190063, rse:0.19462129473686218
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06551265716552734 GB
Epoch: 1 cost time: 2.2681655883789062
Epoch: 1, Steps: 64 | Train Loss: 0.8247869 Vali Loss: 1.8042966 Test Loss: 3.4808698
Validation loss decreased (inf --> 1.804297).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 2 cost time: 0.8663935661315918
Epoch: 2, Steps: 64 | Train Loss: 0.6079978 Vali Loss: 0.8858038 Test Loss: 1.5360334
Validation loss decreased (1.804297 --> 0.885804).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 3 cost time: 0.8757765293121338
Epoch: 3, Steps: 64 | Train Loss: 0.3263100 Vali Loss: 0.4582801 Test Loss: 0.6591652
Validation loss decreased (0.885804 --> 0.458280).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 4 cost time: 0.8588988780975342
Epoch: 4, Steps: 64 | Train Loss: 0.1934984 Vali Loss: 0.2979243 Test Loss: 0.3521479
Validation loss decreased (0.458280 --> 0.297924).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 5 cost time: 0.8525650501251221
Epoch: 5, Steps: 64 | Train Loss: 0.1399418 Vali Loss: 0.2283059 Test Loss: 0.2358209
Validation loss decreased (0.297924 --> 0.228306).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 6 cost time: 0.8449854850769043
Epoch: 6, Steps: 64 | Train Loss: 0.1178034 Vali Loss: 0.1980478 Test Loss: 0.1892574
Validation loss decreased (0.228306 --> 0.198048).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 7 cost time: 0.8487565517425537
Epoch: 7, Steps: 64 | Train Loss: 0.1085198 Vali Loss: 0.1837257 Test Loss: 0.1681994
Validation loss decreased (0.198048 --> 0.183726).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 8 cost time: 0.8533647060394287
Epoch: 8, Steps: 64 | Train Loss: 0.1029243 Vali Loss: 0.1783768 Test Loss: 0.1588659
Validation loss decreased (0.183726 --> 0.178377).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 9 cost time: 0.843998908996582
Epoch: 9, Steps: 64 | Train Loss: 0.0996575 Vali Loss: 0.1708142 Test Loss: 0.1543328
Validation loss decreased (0.178377 --> 0.170814).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 10 cost time: 0.8716492652893066
Epoch: 10, Steps: 64 | Train Loss: 0.0975859 Vali Loss: 0.1683705 Test Loss: 0.1530990
Validation loss decreased (0.170814 --> 0.168371).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 11 cost time: 0.8683626651763916
Epoch: 11, Steps: 64 | Train Loss: 0.0957881 Vali Loss: 0.1649531 Test Loss: 0.1501062
Validation loss decreased (0.168371 --> 0.164953).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 12 cost time: 0.8915667533874512
Epoch: 12, Steps: 64 | Train Loss: 0.0938276 Vali Loss: 0.1651322 Test Loss: 0.1493562
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 13 cost time: 0.8893640041351318
Epoch: 13, Steps: 64 | Train Loss: 0.0934044 Vali Loss: 0.1630839 Test Loss: 0.1487065
Validation loss decreased (0.164953 --> 0.163084).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 14 cost time: 0.8790013790130615
Epoch: 14, Steps: 64 | Train Loss: 0.0921657 Vali Loss: 0.1597874 Test Loss: 0.1477209
Validation loss decreased (0.163084 --> 0.159787).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 15 cost time: 0.8800005912780762
Epoch: 15, Steps: 64 | Train Loss: 0.0914640 Vali Loss: 0.1599443 Test Loss: 0.1480342
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 16 cost time: 0.8629999160766602
Epoch: 16, Steps: 64 | Train Loss: 0.0908681 Vali Loss: 0.1577414 Test Loss: 0.1473767
Validation loss decreased (0.159787 --> 0.157741).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 17 cost time: 0.867102861404419
Epoch: 17, Steps: 64 | Train Loss: 0.0905225 Vali Loss: 0.1573821 Test Loss: 0.1469310
Validation loss decreased (0.157741 --> 0.157382).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 18 cost time: 0.8713736534118652
Epoch: 18, Steps: 64 | Train Loss: 0.0896280 Vali Loss: 0.1547237 Test Loss: 0.1464985
Validation loss decreased (0.157382 --> 0.154724).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 19 cost time: 0.8897669315338135
Epoch: 19, Steps: 64 | Train Loss: 0.0889168 Vali Loss: 0.1563875 Test Loss: 0.1463492
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 20 cost time: 0.8849997520446777
Epoch: 20, Steps: 64 | Train Loss: 0.0884542 Vali Loss: 0.1552884 Test Loss: 0.1465376
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 21 cost time: 0.893094539642334
Epoch: 21, Steps: 64 | Train Loss: 0.0881847 Vali Loss: 0.1542496 Test Loss: 0.1462210
Validation loss decreased (0.154724 --> 0.154250).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 22 cost time: 0.8834879398345947
Epoch: 22, Steps: 64 | Train Loss: 0.0883331 Vali Loss: 0.1556577 Test Loss: 0.1461219
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 23 cost time: 0.8583943843841553
Epoch: 23, Steps: 64 | Train Loss: 0.0878084 Vali Loss: 0.1520169 Test Loss: 0.1464456
Validation loss decreased (0.154250 --> 0.152017).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 24 cost time: 0.8484151363372803
Epoch: 24, Steps: 64 | Train Loss: 0.0868711 Vali Loss: 0.1513394 Test Loss: 0.1457089
Validation loss decreased (0.152017 --> 0.151339).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 25 cost time: 0.8497893810272217
Epoch: 25, Steps: 64 | Train Loss: 0.0869119 Vali Loss: 0.1532662 Test Loss: 0.1456337
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 26 cost time: 0.8466227054595947
Epoch: 26, Steps: 64 | Train Loss: 0.0867208 Vali Loss: 0.1528686 Test Loss: 0.1451254
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 27 cost time: 0.8506436347961426
Epoch: 27, Steps: 64 | Train Loss: 0.0862879 Vali Loss: 0.1539311 Test Loss: 0.1456711
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 28 cost time: 0.8844525814056396
Epoch: 28, Steps: 64 | Train Loss: 0.0864843 Vali Loss: 0.1533662 Test Loss: 0.1451398
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 29 cost time: 0.8825573921203613
Epoch: 29, Steps: 64 | Train Loss: 0.0862959 Vali Loss: 0.1532114 Test Loss: 0.1456333
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 30 cost time: 0.889279842376709
Epoch: 30, Steps: 64 | Train Loss: 0.0863434 Vali Loss: 0.1526121 Test Loss: 0.1450453
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 31 cost time: 0.8659982681274414
Epoch: 31, Steps: 64 | Train Loss: 0.0864406 Vali Loss: 0.1508644 Test Loss: 0.1451952
Validation loss decreased (0.151339 --> 0.150864).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 32 cost time: 0.8396561145782471
Epoch: 32, Steps: 64 | Train Loss: 0.0854287 Vali Loss: 0.1515742 Test Loss: 0.1454248
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 33 cost time: 0.8433659076690674
Epoch: 33, Steps: 64 | Train Loss: 0.0858299 Vali Loss: 0.1507611 Test Loss: 0.1454720
Validation loss decreased (0.150864 --> 0.150761).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 34 cost time: 0.8614161014556885
Epoch: 34, Steps: 64 | Train Loss: 0.0852821 Vali Loss: 0.1516548 Test Loss: 0.1453336
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 35 cost time: 0.8624730110168457
Epoch: 35, Steps: 64 | Train Loss: 0.0856172 Vali Loss: 0.1504408 Test Loss: 0.1454931
Validation loss decreased (0.150761 --> 0.150441).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 36 cost time: 0.8729994297027588
Epoch: 36, Steps: 64 | Train Loss: 0.0853132 Vali Loss: 0.1519458 Test Loss: 0.1452273
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 37 cost time: 0.8836381435394287
Epoch: 37, Steps: 64 | Train Loss: 0.0855313 Vali Loss: 0.1511735 Test Loss: 0.1449132
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 38 cost time: 0.8903586864471436
Epoch: 38, Steps: 64 | Train Loss: 0.0848930 Vali Loss: 0.1481616 Test Loss: 0.1449142
Validation loss decreased (0.150441 --> 0.148162).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 39 cost time: 0.887364387512207
Epoch: 39, Steps: 64 | Train Loss: 0.0854274 Vali Loss: 0.1506232 Test Loss: 0.1449312
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 40 cost time: 0.8814170360565186
Epoch: 40, Steps: 64 | Train Loss: 0.0852782 Vali Loss: 0.1507022 Test Loss: 0.1451807
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 41 cost time: 0.8827824592590332
Epoch: 41, Steps: 64 | Train Loss: 0.0851488 Vali Loss: 0.1483519 Test Loss: 0.1449822
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 42 cost time: 0.8639998435974121
Epoch: 42, Steps: 64 | Train Loss: 0.0851012 Vali Loss: 0.1501268 Test Loss: 0.1450691
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 43 cost time: 0.8636488914489746
Epoch: 43, Steps: 64 | Train Loss: 0.0851286 Vali Loss: 0.1498176 Test Loss: 0.1456233
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 44 cost time: 0.8699102401733398
Epoch: 44, Steps: 64 | Train Loss: 0.0849334 Vali Loss: 0.1505174 Test Loss: 0.1448726
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 45 cost time: 0.8654632568359375
Epoch: 45, Steps: 64 | Train Loss: 0.0847582 Vali Loss: 0.1508058 Test Loss: 0.1449868
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 46 cost time: 0.864501953125
Epoch: 46, Steps: 64 | Train Loss: 0.0847766 Vali Loss: 0.1495938 Test Loss: 0.1451508
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 47 cost time: 0.8590002059936523
Epoch: 47, Steps: 64 | Train Loss: 0.0848353 Vali Loss: 0.1486716 Test Loss: 0.1449380
EarlyStopping counter: 9 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 48 cost time: 0.8713762760162354
Epoch: 48, Steps: 64 | Train Loss: 0.0851130 Vali Loss: 0.1518217 Test Loss: 0.1450792
EarlyStopping counter: 10 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 49 cost time: 0.8703782558441162
Epoch: 49, Steps: 64 | Train Loss: 0.0850819 Vali Loss: 0.1498917 Test Loss: 0.1451274
EarlyStopping counter: 11 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 50 cost time: 0.8454511165618896
Epoch: 50, Steps: 64 | Train Loss: 0.0849272 Vali Loss: 0.1494589 Test Loss: 0.1455408
EarlyStopping counter: 12 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 51 cost time: 0.8523995876312256
Epoch: 51, Steps: 64 | Train Loss: 0.0846792 Vali Loss: 0.1512112 Test Loss: 0.1451644
EarlyStopping counter: 13 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 52 cost time: 0.8577456474304199
Epoch: 52, Steps: 64 | Train Loss: 0.0849953 Vali Loss: 0.1491133 Test Loss: 0.1445503
EarlyStopping counter: 14 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 53 cost time: 0.8476545810699463
Epoch: 53, Steps: 64 | Train Loss: 0.0846902 Vali Loss: 0.1497718 Test Loss: 0.1449536
EarlyStopping counter: 15 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 54 cost time: 0.8516395092010498
Epoch: 54, Steps: 64 | Train Loss: 0.0847576 Vali Loss: 0.1486381 Test Loss: 0.1449742
EarlyStopping counter: 16 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 55 cost time: 0.8669588565826416
Epoch: 55, Steps: 64 | Train Loss: 0.0853127 Vali Loss: 0.1488731 Test Loss: 0.1448321
EarlyStopping counter: 17 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 56 cost time: 0.8613879680633545
Epoch: 56, Steps: 64 | Train Loss: 0.0850035 Vali Loss: 0.1503814 Test Loss: 0.1450703
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 57 cost time: 0.8783669471740723
Epoch: 57, Steps: 64 | Train Loss: 0.0847870 Vali Loss: 0.1514533 Test Loss: 0.1450562
EarlyStopping counter: 19 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 58 cost time: 0.8440003395080566
Epoch: 58, Steps: 64 | Train Loss: 0.0845768 Vali Loss: 0.1502856 Test Loss: 0.1451044
EarlyStopping counter: 20 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 59 cost time: 0.8736412525177002
Epoch: 59, Steps: 64 | Train Loss: 0.0851615 Vali Loss: 0.1480416 Test Loss: 0.1449314
Validation loss decreased (0.148162 --> 0.148042).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018726348876953125 GB
GPU已分配内存的峰值：0.06640052795410156 GB
Epoch: 60 cost time: 0.8553340435028076
Epoch: 60, Steps: 64 | Train Loss: 0.0843354 Vali Loss: 0.1475853 Test Loss: 0.1447526
Validation loss decreased (0.148042 --> 0.147585).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1447526216506958, mae:0.2764929234981537, rse:0.20250427722930908
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.06978511810302734 GB
Epoch: 1 cost time: 2.3181939125061035
Epoch: 1, Steps: 64 | Train Loss: 0.7397011 Vali Loss: 1.6866541 Test Loss: 3.1531901
Validation loss decreased (inf --> 1.686654).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 2 cost time: 0.9157857894897461
Epoch: 2, Steps: 64 | Train Loss: 0.3179633 Vali Loss: 0.2167403 Test Loss: 0.1890260
Validation loss decreased (1.686654 --> 0.216740).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 3 cost time: 0.9213926792144775
Epoch: 3, Steps: 64 | Train Loss: 0.1051303 Vali Loss: 0.1776242 Test Loss: 0.1589396
Validation loss decreased (0.216740 --> 0.177624).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 4 cost time: 0.9014101028442383
Epoch: 4, Steps: 64 | Train Loss: 0.0949715 Vali Loss: 0.1672686 Test Loss: 0.1443876
Validation loss decreased (0.177624 --> 0.167269).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 5 cost time: 0.884803295135498
Epoch: 5, Steps: 64 | Train Loss: 0.0909757 Vali Loss: 0.1642712 Test Loss: 0.1439102
Validation loss decreased (0.167269 --> 0.164271).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 6 cost time: 0.8897864818572998
Epoch: 6, Steps: 64 | Train Loss: 0.0883941 Vali Loss: 0.1596845 Test Loss: 0.1406215
Validation loss decreased (0.164271 --> 0.159684).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 7 cost time: 0.8799986839294434
Epoch: 7, Steps: 64 | Train Loss: 0.0870924 Vali Loss: 0.1567022 Test Loss: 0.1407734
Validation loss decreased (0.159684 --> 0.156702).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 8 cost time: 0.8766567707061768
Epoch: 8, Steps: 64 | Train Loss: 0.0857065 Vali Loss: 0.1561860 Test Loss: 0.1397548
Validation loss decreased (0.156702 --> 0.156186).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 9 cost time: 0.894362211227417
Epoch: 9, Steps: 64 | Train Loss: 0.0843403 Vali Loss: 0.1551879 Test Loss: 0.1386785
Validation loss decreased (0.156186 --> 0.155188).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 10 cost time: 0.9083981513977051
Epoch: 10, Steps: 64 | Train Loss: 0.0832713 Vali Loss: 0.1518018 Test Loss: 0.1389600
Validation loss decreased (0.155188 --> 0.151802).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 11 cost time: 0.9095988273620605
Epoch: 11, Steps: 64 | Train Loss: 0.0830282 Vali Loss: 0.1518688 Test Loss: 0.1387400
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 12 cost time: 0.9167928695678711
Epoch: 12, Steps: 64 | Train Loss: 0.0820884 Vali Loss: 0.1501092 Test Loss: 0.1379264
Validation loss decreased (0.151802 --> 0.150109).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 13 cost time: 0.9227511882781982
Epoch: 13, Steps: 64 | Train Loss: 0.0815750 Vali Loss: 0.1497473 Test Loss: 0.1382818
Validation loss decreased (0.150109 --> 0.149747).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 14 cost time: 0.9059979915618896
Epoch: 14, Steps: 64 | Train Loss: 0.0814815 Vali Loss: 0.1490377 Test Loss: 0.1376358
Validation loss decreased (0.149747 --> 0.149038).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 15 cost time: 0.9094269275665283
Epoch: 15, Steps: 64 | Train Loss: 0.0802972 Vali Loss: 0.1473686 Test Loss: 0.1371498
Validation loss decreased (0.149038 --> 0.147369).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 16 cost time: 0.9044396877288818
Epoch: 16, Steps: 64 | Train Loss: 0.0802180 Vali Loss: 0.1477381 Test Loss: 0.1372699
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 17 cost time: 0.9094619750976562
Epoch: 17, Steps: 64 | Train Loss: 0.0800608 Vali Loss: 0.1491450 Test Loss: 0.1374725
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 18 cost time: 0.9233715534210205
Epoch: 18, Steps: 64 | Train Loss: 0.0797315 Vali Loss: 0.1479989 Test Loss: 0.1367172
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 19 cost time: 0.9193792343139648
Epoch: 19, Steps: 64 | Train Loss: 0.0792880 Vali Loss: 0.1457088 Test Loss: 0.1366292
Validation loss decreased (0.147369 --> 0.145709).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 20 cost time: 0.9351060390472412
Epoch: 20, Steps: 64 | Train Loss: 0.0787761 Vali Loss: 0.1469853 Test Loss: 0.1370462
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 21 cost time: 0.9269998073577881
Epoch: 21, Steps: 64 | Train Loss: 0.0786013 Vali Loss: 0.1463910 Test Loss: 0.1371097
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 22 cost time: 0.8956279754638672
Epoch: 22, Steps: 64 | Train Loss: 0.0785160 Vali Loss: 0.1469372 Test Loss: 0.1366707
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 23 cost time: 0.8874294757843018
Epoch: 23, Steps: 64 | Train Loss: 0.0781039 Vali Loss: 0.1435818 Test Loss: 0.1370446
Validation loss decreased (0.145709 --> 0.143582).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 24 cost time: 0.8930075168609619
Epoch: 24, Steps: 64 | Train Loss: 0.0783340 Vali Loss: 0.1445060 Test Loss: 0.1364281
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 25 cost time: 0.8804094791412354
Epoch: 25, Steps: 64 | Train Loss: 0.0781529 Vali Loss: 0.1452634 Test Loss: 0.1368936
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 26 cost time: 0.8937780857086182
Epoch: 26, Steps: 64 | Train Loss: 0.0781440 Vali Loss: 0.1465523 Test Loss: 0.1365468
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 27 cost time: 0.9129996299743652
Epoch: 27, Steps: 64 | Train Loss: 0.0775039 Vali Loss: 0.1448294 Test Loss: 0.1363721
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 28 cost time: 0.896728515625
Epoch: 28, Steps: 64 | Train Loss: 0.0775970 Vali Loss: 0.1447801 Test Loss: 0.1363194
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 29 cost time: 0.9056446552276611
Epoch: 29, Steps: 64 | Train Loss: 0.0774029 Vali Loss: 0.1440231 Test Loss: 0.1362421
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 30 cost time: 0.9233906269073486
Epoch: 30, Steps: 64 | Train Loss: 0.0771429 Vali Loss: 0.1449189 Test Loss: 0.1363813
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 31 cost time: 0.8925356864929199
Epoch: 31, Steps: 64 | Train Loss: 0.0772074 Vali Loss: 0.1439222 Test Loss: 0.1360198
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 32 cost time: 0.8783557415008545
Epoch: 32, Steps: 64 | Train Loss: 0.0771446 Vali Loss: 0.1415874 Test Loss: 0.1361509
Validation loss decreased (0.143582 --> 0.141587).  Saving model ...
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 33 cost time: 0.8896698951721191
Epoch: 33, Steps: 64 | Train Loss: 0.0769280 Vali Loss: 0.1448836 Test Loss: 0.1361678
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 34 cost time: 0.9049990177154541
Epoch: 34, Steps: 64 | Train Loss: 0.0769698 Vali Loss: 0.1428600 Test Loss: 0.1362374
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 35 cost time: 0.9206399917602539
Epoch: 35, Steps: 64 | Train Loss: 0.0770133 Vali Loss: 0.1449078 Test Loss: 0.1355999
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 36 cost time: 0.915360689163208
Epoch: 36, Steps: 64 | Train Loss: 0.0769865 Vali Loss: 0.1444412 Test Loss: 0.1362669
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 37 cost time: 0.9223918914794922
Epoch: 37, Steps: 64 | Train Loss: 0.0767270 Vali Loss: 0.1423728 Test Loss: 0.1356615
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 38 cost time: 0.9271793365478516
Epoch: 38, Steps: 64 | Train Loss: 0.0768376 Vali Loss: 0.1433626 Test Loss: 0.1360886
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 39 cost time: 0.9044234752655029
Epoch: 39, Steps: 64 | Train Loss: 0.0765696 Vali Loss: 0.1434827 Test Loss: 0.1354647
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 40 cost time: 0.9068470001220703
Epoch: 40, Steps: 64 | Train Loss: 0.0767006 Vali Loss: 0.1419693 Test Loss: 0.1357469
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 41 cost time: 0.9090018272399902
Epoch: 41, Steps: 64 | Train Loss: 0.0766641 Vali Loss: 0.1430336 Test Loss: 0.1356556
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 42 cost time: 0.9194047451019287
Epoch: 42, Steps: 64 | Train Loss: 0.0767561 Vali Loss: 0.1429657 Test Loss: 0.1363058
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 43 cost time: 0.9156346321105957
Epoch: 43, Steps: 64 | Train Loss: 0.0767677 Vali Loss: 0.1432779 Test Loss: 0.1359624
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 44 cost time: 0.9174468517303467
Epoch: 44, Steps: 64 | Train Loss: 0.0764207 Vali Loss: 0.1439056 Test Loss: 0.1357670
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 45 cost time: 0.9054195880889893
Epoch: 45, Steps: 64 | Train Loss: 0.0759851 Vali Loss: 0.1413613 Test Loss: 0.1358508
Validation loss decreased (0.141587 --> 0.141361).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 46 cost time: 0.8964173793792725
Epoch: 46, Steps: 64 | Train Loss: 0.0763498 Vali Loss: 0.1431796 Test Loss: 0.1362403
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 47 cost time: 0.8917510509490967
Epoch: 47, Steps: 64 | Train Loss: 0.0766112 Vali Loss: 0.1434994 Test Loss: 0.1354571
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 48 cost time: 0.8889973163604736
Epoch: 48, Steps: 64 | Train Loss: 0.0767042 Vali Loss: 0.1445194 Test Loss: 0.1355436
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 49 cost time: 0.8817601203918457
Epoch: 49, Steps: 64 | Train Loss: 0.0764563 Vali Loss: 0.1434288 Test Loss: 0.1359187
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 50 cost time: 0.8792557716369629
Epoch: 50, Steps: 64 | Train Loss: 0.0762391 Vali Loss: 0.1439972 Test Loss: 0.1355525
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 51 cost time: 0.8830132484436035
Epoch: 51, Steps: 64 | Train Loss: 0.0766583 Vali Loss: 0.1446455 Test Loss: 0.1363159
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 52 cost time: 0.903867244720459
Epoch: 52, Steps: 64 | Train Loss: 0.0763358 Vali Loss: 0.1434188 Test Loss: 0.1358292
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 53 cost time: 0.9094557762145996
Epoch: 53, Steps: 64 | Train Loss: 0.0762756 Vali Loss: 0.1429560 Test Loss: 0.1361425
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 54 cost time: 0.9178106784820557
Epoch: 54, Steps: 64 | Train Loss: 0.0762627 Vali Loss: 0.1422212 Test Loss: 0.1357008
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 55 cost time: 0.9163947105407715
Epoch: 55, Steps: 64 | Train Loss: 0.0761686 Vali Loss: 0.1439026 Test Loss: 0.1361712
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 56 cost time: 0.9116353988647461
Epoch: 56, Steps: 64 | Train Loss: 0.0762181 Vali Loss: 0.1434495 Test Loss: 0.1355696
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 57 cost time: 0.9083807468414307
Epoch: 57, Steps: 64 | Train Loss: 0.0764550 Vali Loss: 0.1436331 Test Loss: 0.1364469
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 58 cost time: 0.9104361534118652
Epoch: 58, Steps: 64 | Train Loss: 0.0764997 Vali Loss: 0.1430349 Test Loss: 0.1361572
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 59 cost time: 0.9113702774047852
Epoch: 59, Steps: 64 | Train Loss: 0.0766205 Vali Loss: 0.1434879 Test Loss: 0.1359364
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020435333251953125 GB
GPU已分配内存的峰值：0.07079505920410156 GB
Epoch: 60 cost time: 0.9180300235748291
Epoch: 60, Steps: 64 | Train Loss: 0.0762559 Vali Loss: 0.1429298 Test Loss: 0.1361905
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13585081696510315, mae:0.265148401260376, rse:0.19617880880832672
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=1, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.07290077209472656 GB
Epoch: 1 cost time: 2.324221611022949
Epoch: 1, Steps: 64 | Train Loss: 0.7537837 Vali Loss: 1.7385501 Test Loss: 3.2922127
Validation loss decreased (inf --> 1.738550).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 2 cost time: 0.9374418258666992
Epoch: 2, Steps: 64 | Train Loss: 0.2980154 Vali Loss: 0.2356609 Test Loss: 0.2771486
Validation loss decreased (1.738550 --> 0.235661).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 3 cost time: 0.926743745803833
Epoch: 3, Steps: 64 | Train Loss: 0.1012431 Vali Loss: 0.1703040 Test Loss: 0.1438193
Validation loss decreased (0.235661 --> 0.170304).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 4 cost time: 0.9264061450958252
Epoch: 4, Steps: 64 | Train Loss: 0.0914290 Vali Loss: 0.1640756 Test Loss: 0.1424315
Validation loss decreased (0.170304 --> 0.164076).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 5 cost time: 0.9146084785461426
Epoch: 5, Steps: 64 | Train Loss: 0.0879721 Vali Loss: 0.1582318 Test Loss: 0.1401017
Validation loss decreased (0.164076 --> 0.158232).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 6 cost time: 0.9026234149932861
Epoch: 6, Steps: 64 | Train Loss: 0.0862983 Vali Loss: 0.1555867 Test Loss: 0.1399407
Validation loss decreased (0.158232 --> 0.155587).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 7 cost time: 0.9053699970245361
Epoch: 7, Steps: 64 | Train Loss: 0.0844586 Vali Loss: 0.1535675 Test Loss: 0.1376598
Validation loss decreased (0.155587 --> 0.153567).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 8 cost time: 0.921165943145752
Epoch: 8, Steps: 64 | Train Loss: 0.0829759 Vali Loss: 0.1504535 Test Loss: 0.1363364
Validation loss decreased (0.153567 --> 0.150453).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 9 cost time: 0.9275767803192139
Epoch: 9, Steps: 64 | Train Loss: 0.0820110 Vali Loss: 0.1481847 Test Loss: 0.1359266
Validation loss decreased (0.150453 --> 0.148185).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 10 cost time: 0.9568891525268555
Epoch: 10, Steps: 64 | Train Loss: 0.0806854 Vali Loss: 0.1482851 Test Loss: 0.1363073
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 11 cost time: 0.9543952941894531
Epoch: 11, Steps: 64 | Train Loss: 0.0799534 Vali Loss: 0.1470366 Test Loss: 0.1356722
Validation loss decreased (0.148185 --> 0.147037).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 12 cost time: 0.9518144130706787
Epoch: 12, Steps: 64 | Train Loss: 0.0794984 Vali Loss: 0.1497502 Test Loss: 0.1381768
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 13 cost time: 0.9399533271789551
Epoch: 13, Steps: 64 | Train Loss: 0.0787817 Vali Loss: 0.1451127 Test Loss: 0.1359190
Validation loss decreased (0.147037 --> 0.145113).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 14 cost time: 0.9409999847412109
Epoch: 14, Steps: 64 | Train Loss: 0.0785075 Vali Loss: 0.1470393 Test Loss: 0.1359892
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 15 cost time: 0.9566199779510498
Epoch: 15, Steps: 64 | Train Loss: 0.0777849 Vali Loss: 0.1446511 Test Loss: 0.1347758
Validation loss decreased (0.145113 --> 0.144651).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 16 cost time: 0.9366474151611328
Epoch: 16, Steps: 64 | Train Loss: 0.0770807 Vali Loss: 0.1431401 Test Loss: 0.1351773
Validation loss decreased (0.144651 --> 0.143140).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 17 cost time: 0.9482347965240479
Epoch: 17, Steps: 64 | Train Loss: 0.0765694 Vali Loss: 0.1429769 Test Loss: 0.1357873
Validation loss decreased (0.143140 --> 0.142977).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 18 cost time: 0.9573590755462646
Epoch: 18, Steps: 64 | Train Loss: 0.0765671 Vali Loss: 0.1409999 Test Loss: 0.1353937
Validation loss decreased (0.142977 --> 0.141000).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 19 cost time: 0.9590184688568115
Epoch: 19, Steps: 64 | Train Loss: 0.0758979 Vali Loss: 0.1414472 Test Loss: 0.1345913
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 20 cost time: 0.952380895614624
Epoch: 20, Steps: 64 | Train Loss: 0.0759343 Vali Loss: 0.1410228 Test Loss: 0.1353061
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 21 cost time: 0.9429948329925537
Epoch: 21, Steps: 64 | Train Loss: 0.0757329 Vali Loss: 0.1429826 Test Loss: 0.1346724
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 22 cost time: 0.9157869815826416
Epoch: 22, Steps: 64 | Train Loss: 0.0751296 Vali Loss: 0.1411630 Test Loss: 0.1337313
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 23 cost time: 0.9080016613006592
Epoch: 23, Steps: 64 | Train Loss: 0.0750077 Vali Loss: 0.1412957 Test Loss: 0.1337529
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 24 cost time: 0.908642053604126
Epoch: 24, Steps: 64 | Train Loss: 0.0748416 Vali Loss: 0.1414000 Test Loss: 0.1344015
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 25 cost time: 0.9230589866638184
Epoch: 25, Steps: 64 | Train Loss: 0.0745671 Vali Loss: 0.1406851 Test Loss: 0.1339187
Validation loss decreased (0.141000 --> 0.140685).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 26 cost time: 0.9253818988800049
Epoch: 26, Steps: 64 | Train Loss: 0.0746663 Vali Loss: 0.1400614 Test Loss: 0.1332607
Validation loss decreased (0.140685 --> 0.140061).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 27 cost time: 0.9284300804138184
Epoch: 27, Steps: 64 | Train Loss: 0.0743620 Vali Loss: 0.1417440 Test Loss: 0.1340563
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 28 cost time: 0.9238071441650391
Epoch: 28, Steps: 64 | Train Loss: 0.0744302 Vali Loss: 0.1419194 Test Loss: 0.1347248
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 29 cost time: 0.9220142364501953
Epoch: 29, Steps: 64 | Train Loss: 0.0738429 Vali Loss: 0.1408296 Test Loss: 0.1343805
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 30 cost time: 0.907738208770752
Epoch: 30, Steps: 64 | Train Loss: 0.0742825 Vali Loss: 0.1396997 Test Loss: 0.1336462
Validation loss decreased (0.140061 --> 0.139700).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 31 cost time: 0.9009997844696045
Epoch: 31, Steps: 64 | Train Loss: 0.0738135 Vali Loss: 0.1433423 Test Loss: 0.1351105
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 32 cost time: 0.9126260280609131
Epoch: 32, Steps: 64 | Train Loss: 0.0738706 Vali Loss: 0.1410726 Test Loss: 0.1342934
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 33 cost time: 0.945188045501709
Epoch: 33, Steps: 64 | Train Loss: 0.0739091 Vali Loss: 0.1423926 Test Loss: 0.1335662
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 34 cost time: 0.9603841304779053
Epoch: 34, Steps: 64 | Train Loss: 0.0736980 Vali Loss: 0.1413327 Test Loss: 0.1347975
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 35 cost time: 0.9514036178588867
Epoch: 35, Steps: 64 | Train Loss: 0.0735766 Vali Loss: 0.1427787 Test Loss: 0.1336115
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 36 cost time: 0.9585089683532715
Epoch: 36, Steps: 64 | Train Loss: 0.0734126 Vali Loss: 0.1420030 Test Loss: 0.1346740
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 37 cost time: 0.9430451393127441
Epoch: 37, Steps: 64 | Train Loss: 0.0737217 Vali Loss: 0.1433862 Test Loss: 0.1347872
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 38 cost time: 0.9506733417510986
Epoch: 38, Steps: 64 | Train Loss: 0.0732756 Vali Loss: 0.1411618 Test Loss: 0.1344884
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 39 cost time: 0.9547796249389648
Epoch: 39, Steps: 64 | Train Loss: 0.0730496 Vali Loss: 0.1428195 Test Loss: 0.1341682
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 40 cost time: 0.9397811889648438
Epoch: 40, Steps: 64 | Train Loss: 0.0732431 Vali Loss: 0.1414457 Test Loss: 0.1337536
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 41 cost time: 0.9366455078125
Epoch: 41, Steps: 64 | Train Loss: 0.0734446 Vali Loss: 0.1412748 Test Loss: 0.1335090
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 42 cost time: 0.9622640609741211
Epoch: 42, Steps: 64 | Train Loss: 0.0733302 Vali Loss: 0.1429642 Test Loss: 0.1353724
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 43 cost time: 0.9373865127563477
Epoch: 43, Steps: 64 | Train Loss: 0.0730881 Vali Loss: 0.1412886 Test Loss: 0.1341098
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 44 cost time: 0.9254088401794434
Epoch: 44, Steps: 64 | Train Loss: 0.0735140 Vali Loss: 0.1406188 Test Loss: 0.1333179
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 45 cost time: 0.9204025268554688
Epoch: 45, Steps: 64 | Train Loss: 0.0732591 Vali Loss: 0.1431904 Test Loss: 0.1347408
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 46 cost time: 0.9158096313476562
Epoch: 46, Steps: 64 | Train Loss: 0.0731427 Vali Loss: 0.1416941 Test Loss: 0.1344399
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 47 cost time: 0.9207456111907959
Epoch: 47, Steps: 64 | Train Loss: 0.0731493 Vali Loss: 0.1426295 Test Loss: 0.1343579
EarlyStopping counter: 17 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 48 cost time: 0.9489994049072266
Epoch: 48, Steps: 64 | Train Loss: 0.0731153 Vali Loss: 0.1406699 Test Loss: 0.1344953
EarlyStopping counter: 18 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 49 cost time: 0.9556374549865723
Epoch: 49, Steps: 64 | Train Loss: 0.0732845 Vali Loss: 0.1411911 Test Loss: 0.1334289
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 50 cost time: 0.9302823543548584
Epoch: 50, Steps: 64 | Train Loss: 0.0731747 Vali Loss: 0.1427432 Test Loss: 0.1333524
EarlyStopping counter: 20 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 51 cost time: 0.9313619136810303
Epoch: 51, Steps: 64 | Train Loss: 0.0732555 Vali Loss: 0.1415441 Test Loss: 0.1337428
EarlyStopping counter: 21 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 52 cost time: 0.9303989410400391
Epoch: 52, Steps: 64 | Train Loss: 0.0730306 Vali Loss: 0.1419025 Test Loss: 0.1338968
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 53 cost time: 0.9233777523040771
Epoch: 53, Steps: 64 | Train Loss: 0.0732389 Vali Loss: 0.1408431 Test Loss: 0.1341742
EarlyStopping counter: 23 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 54 cost time: 0.9364039897918701
Epoch: 54, Steps: 64 | Train Loss: 0.0730177 Vali Loss: 0.1419796 Test Loss: 0.1341541
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 55 cost time: 0.9357619285583496
Epoch: 55, Steps: 64 | Train Loss: 0.0735438 Vali Loss: 0.1413189 Test Loss: 0.1343944
EarlyStopping counter: 25 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 56 cost time: 0.9347784519195557
Epoch: 56, Steps: 64 | Train Loss: 0.0731486 Vali Loss: 0.1403545 Test Loss: 0.1345095
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 57 cost time: 0.9340000152587891
Epoch: 57, Steps: 64 | Train Loss: 0.0733067 Vali Loss: 0.1416892 Test Loss: 0.1344796
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 58 cost time: 0.9544503688812256
Epoch: 58, Steps: 64 | Train Loss: 0.0730976 Vali Loss: 0.1421848 Test Loss: 0.1333677
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 59 cost time: 0.9653880596160889
Epoch: 59, Steps: 64 | Train Loss: 0.0731482 Vali Loss: 0.1402688 Test Loss: 0.1344634
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021419525146484375 GB
GPU已分配内存的峰值：0.0759286880493164 GB
Epoch: 60 cost time: 0.949409008026123
Epoch: 60, Steps: 64 | Train Loss: 0.0730571 Vali Loss: 0.1427543 Test Loss: 0.1345517
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.133646160364151, mae:0.2635548412799835, rse:0.19458045065402985
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.0656743049621582 GB
Epoch: 1 cost time: 2.270965099334717
Epoch: 1, Steps: 64 | Train Loss: 0.8094043 Vali Loss: 1.8041716 Test Loss: 3.3590734
Validation loss decreased (inf --> 1.804172).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 2 cost time: 0.8766381740570068
Epoch: 2, Steps: 64 | Train Loss: 0.5521680 Vali Loss: 0.7614604 Test Loss: 1.1987654
Validation loss decreased (1.804172 --> 0.761460).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 3 cost time: 0.8763933181762695
Epoch: 3, Steps: 64 | Train Loss: 0.2863007 Vali Loss: 0.4455327 Test Loss: 0.5746568
Validation loss decreased (0.761460 --> 0.445533).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 4 cost time: 0.8664407730102539
Epoch: 4, Steps: 64 | Train Loss: 0.1823771 Vali Loss: 0.3149052 Test Loss: 0.3438838
Validation loss decreased (0.445533 --> 0.314905).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 5 cost time: 0.8557603359222412
Epoch: 5, Steps: 64 | Train Loss: 0.1371732 Vali Loss: 0.2474813 Test Loss: 0.2397336
Validation loss decreased (0.314905 --> 0.247481).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 6 cost time: 0.8596351146697998
Epoch: 6, Steps: 64 | Train Loss: 0.1179058 Vali Loss: 0.2110049 Test Loss: 0.1926303
Validation loss decreased (0.247481 --> 0.211005).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 7 cost time: 0.8584558963775635
Epoch: 7, Steps: 64 | Train Loss: 0.1078428 Vali Loss: 0.1883028 Test Loss: 0.1677599
Validation loss decreased (0.211005 --> 0.188303).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 8 cost time: 0.8505184650421143
Epoch: 8, Steps: 64 | Train Loss: 0.1021342 Vali Loss: 0.1768177 Test Loss: 0.1559433
Validation loss decreased (0.188303 --> 0.176818).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 9 cost time: 0.8534402847290039
Epoch: 9, Steps: 64 | Train Loss: 0.0989692 Vali Loss: 0.1700883 Test Loss: 0.1497535
Validation loss decreased (0.176818 --> 0.170088).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 10 cost time: 0.8853826522827148
Epoch: 10, Steps: 64 | Train Loss: 0.0967559 Vali Loss: 0.1665051 Test Loss: 0.1474019
Validation loss decreased (0.170088 --> 0.166505).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 11 cost time: 0.8787481784820557
Epoch: 11, Steps: 64 | Train Loss: 0.0951729 Vali Loss: 0.1623374 Test Loss: 0.1444057
Validation loss decreased (0.166505 --> 0.162337).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 12 cost time: 0.8923859596252441
Epoch: 12, Steps: 64 | Train Loss: 0.0936844 Vali Loss: 0.1596156 Test Loss: 0.1436141
Validation loss decreased (0.162337 --> 0.159616).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 13 cost time: 0.9076364040374756
Epoch: 13, Steps: 64 | Train Loss: 0.0925620 Vali Loss: 0.1572304 Test Loss: 0.1441286
Validation loss decreased (0.159616 --> 0.157230).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 14 cost time: 0.8824741840362549
Epoch: 14, Steps: 64 | Train Loss: 0.0913813 Vali Loss: 0.1566204 Test Loss: 0.1428028
Validation loss decreased (0.157230 --> 0.156620).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 15 cost time: 0.8743782043457031
Epoch: 15, Steps: 64 | Train Loss: 0.0904854 Vali Loss: 0.1556085 Test Loss: 0.1427721
Validation loss decreased (0.156620 --> 0.155609).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 16 cost time: 0.8747599124908447
Epoch: 16, Steps: 64 | Train Loss: 0.0897370 Vali Loss: 0.1555603 Test Loss: 0.1424921
Validation loss decreased (0.155609 --> 0.155560).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 17 cost time: 0.889087438583374
Epoch: 17, Steps: 64 | Train Loss: 0.0896194 Vali Loss: 0.1513224 Test Loss: 0.1418850
Validation loss decreased (0.155560 --> 0.151322).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 18 cost time: 0.8910000324249268
Epoch: 18, Steps: 64 | Train Loss: 0.0889220 Vali Loss: 0.1509141 Test Loss: 0.1414376
Validation loss decreased (0.151322 --> 0.150914).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 19 cost time: 0.8866400718688965
Epoch: 19, Steps: 64 | Train Loss: 0.0887058 Vali Loss: 0.1508317 Test Loss: 0.1415431
Validation loss decreased (0.150914 --> 0.150832).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 20 cost time: 0.9053497314453125
Epoch: 20, Steps: 64 | Train Loss: 0.0872038 Vali Loss: 0.1483005 Test Loss: 0.1422085
Validation loss decreased (0.150832 --> 0.148300).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 21 cost time: 0.8870699405670166
Epoch: 21, Steps: 64 | Train Loss: 0.0874805 Vali Loss: 0.1505027 Test Loss: 0.1419523
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 22 cost time: 0.886035680770874
Epoch: 22, Steps: 64 | Train Loss: 0.0873117 Vali Loss: 0.1490616 Test Loss: 0.1418507
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 23 cost time: 0.8637871742248535
Epoch: 23, Steps: 64 | Train Loss: 0.0865772 Vali Loss: 0.1493586 Test Loss: 0.1421617
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 24 cost time: 0.8700001239776611
Epoch: 24, Steps: 64 | Train Loss: 0.0861110 Vali Loss: 0.1484812 Test Loss: 0.1419568
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 25 cost time: 0.8490397930145264
Epoch: 25, Steps: 64 | Train Loss: 0.0862653 Vali Loss: 0.1481796 Test Loss: 0.1419226
Validation loss decreased (0.148300 --> 0.148180).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 26 cost time: 0.8424012660980225
Epoch: 26, Steps: 64 | Train Loss: 0.0857250 Vali Loss: 0.1466010 Test Loss: 0.1412459
Validation loss decreased (0.148180 --> 0.146601).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 27 cost time: 0.8594274520874023
Epoch: 27, Steps: 64 | Train Loss: 0.0855958 Vali Loss: 0.1480007 Test Loss: 0.1419103
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 28 cost time: 0.8508176803588867
Epoch: 28, Steps: 64 | Train Loss: 0.0852956 Vali Loss: 0.1472653 Test Loss: 0.1417924
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 29 cost time: 0.8650000095367432
Epoch: 29, Steps: 64 | Train Loss: 0.0848522 Vali Loss: 0.1458576 Test Loss: 0.1415329
Validation loss decreased (0.146601 --> 0.145858).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 30 cost time: 0.8666543960571289
Epoch: 30, Steps: 64 | Train Loss: 0.0849624 Vali Loss: 0.1479009 Test Loss: 0.1425558
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 31 cost time: 0.8754863739013672
Epoch: 31, Steps: 64 | Train Loss: 0.0848644 Vali Loss: 0.1461300 Test Loss: 0.1421172
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 32 cost time: 0.8384051322937012
Epoch: 32, Steps: 64 | Train Loss: 0.0851350 Vali Loss: 0.1464765 Test Loss: 0.1420765
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 33 cost time: 0.8403632640838623
Epoch: 33, Steps: 64 | Train Loss: 0.0847841 Vali Loss: 0.1445536 Test Loss: 0.1408053
Validation loss decreased (0.145858 --> 0.144554).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 34 cost time: 0.8553917407989502
Epoch: 34, Steps: 64 | Train Loss: 0.0844542 Vali Loss: 0.1451862 Test Loss: 0.1429556
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 35 cost time: 0.8776473999023438
Epoch: 35, Steps: 64 | Train Loss: 0.0841876 Vali Loss: 0.1452393 Test Loss: 0.1412284
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 36 cost time: 0.8923933506011963
Epoch: 36, Steps: 64 | Train Loss: 0.0843796 Vali Loss: 0.1446004 Test Loss: 0.1407945
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 37 cost time: 0.8923633098602295
Epoch: 37, Steps: 64 | Train Loss: 0.0837961 Vali Loss: 0.1453882 Test Loss: 0.1427146
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 38 cost time: 0.8963718414306641
Epoch: 38, Steps: 64 | Train Loss: 0.0839562 Vali Loss: 0.1444500 Test Loss: 0.1414969
Validation loss decreased (0.144554 --> 0.144450).  Saving model ...
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 39 cost time: 0.9020626544952393
Epoch: 39, Steps: 64 | Train Loss: 0.0838464 Vali Loss: 0.1450895 Test Loss: 0.1413016
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 40 cost time: 0.8958346843719482
Epoch: 40, Steps: 64 | Train Loss: 0.0839002 Vali Loss: 0.1435650 Test Loss: 0.1411872
Validation loss decreased (0.144450 --> 0.143565).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 41 cost time: 0.8819990158081055
Epoch: 41, Steps: 64 | Train Loss: 0.0844336 Vali Loss: 0.1446633 Test Loss: 0.1408972
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 42 cost time: 0.8776412010192871
Epoch: 42, Steps: 64 | Train Loss: 0.0841241 Vali Loss: 0.1432918 Test Loss: 0.1413184
Validation loss decreased (0.143565 --> 0.143292).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 43 cost time: 0.878471851348877
Epoch: 43, Steps: 64 | Train Loss: 0.0839770 Vali Loss: 0.1443817 Test Loss: 0.1414128
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 44 cost time: 0.873497724533081
Epoch: 44, Steps: 64 | Train Loss: 0.0835624 Vali Loss: 0.1450588 Test Loss: 0.1417637
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 45 cost time: 0.8827548027038574
Epoch: 45, Steps: 64 | Train Loss: 0.0837488 Vali Loss: 0.1440622 Test Loss: 0.1415091
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 46 cost time: 0.8860006332397461
Epoch: 46, Steps: 64 | Train Loss: 0.0839424 Vali Loss: 0.1445212 Test Loss: 0.1407227
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 47 cost time: 0.8726367950439453
Epoch: 47, Steps: 64 | Train Loss: 0.0835816 Vali Loss: 0.1423807 Test Loss: 0.1412019
Validation loss decreased (0.143292 --> 0.142381).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 48 cost time: 0.8662416934967041
Epoch: 48, Steps: 64 | Train Loss: 0.0833243 Vali Loss: 0.1452812 Test Loss: 0.1417126
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 49 cost time: 0.8834145069122314
Epoch: 49, Steps: 64 | Train Loss: 0.0835519 Vali Loss: 0.1452241 Test Loss: 0.1425446
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 50 cost time: 0.852405309677124
Epoch: 50, Steps: 64 | Train Loss: 0.0837112 Vali Loss: 0.1445023 Test Loss: 0.1405681
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 51 cost time: 0.8467452526092529
Epoch: 51, Steps: 64 | Train Loss: 0.0835177 Vali Loss: 0.1437143 Test Loss: 0.1418015
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 52 cost time: 0.850447416305542
Epoch: 52, Steps: 64 | Train Loss: 0.0835976 Vali Loss: 0.1418307 Test Loss: 0.1408781
Validation loss decreased (0.142381 --> 0.141831).  Saving model ...
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 53 cost time: 0.8556332588195801
Epoch: 53, Steps: 64 | Train Loss: 0.0832745 Vali Loss: 0.1432355 Test Loss: 0.1415301
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 54 cost time: 0.8925089836120605
Epoch: 54, Steps: 64 | Train Loss: 0.0840180 Vali Loss: 0.1433820 Test Loss: 0.1409756
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 55 cost time: 0.8874480724334717
Epoch: 55, Steps: 64 | Train Loss: 0.0839457 Vali Loss: 0.1440700 Test Loss: 0.1411043
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 56 cost time: 0.8904237747192383
Epoch: 56, Steps: 64 | Train Loss: 0.0839335 Vali Loss: 0.1436846 Test Loss: 0.1410818
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 57 cost time: 0.9087786674499512
Epoch: 57, Steps: 64 | Train Loss: 0.0835210 Vali Loss: 0.1436707 Test Loss: 0.1409937
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 58 cost time: 0.8870015144348145
Epoch: 58, Steps: 64 | Train Loss: 0.0833970 Vali Loss: 0.1444198 Test Loss: 0.1413389
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 59 cost time: 0.8912441730499268
Epoch: 59, Steps: 64 | Train Loss: 0.0837559 Vali Loss: 0.1430122 Test Loss: 0.1412796
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018732070922851562 GB
GPU已分配内存的峰值：0.06656503677368164 GB
Epoch: 60 cost time: 0.8774135112762451
Epoch: 60, Steps: 64 | Train Loss: 0.0835527 Vali Loss: 0.1417440 Test Loss: 0.1412001
Validation loss decreased (0.141831 --> 0.141744).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14120009541511536, mae:0.2751649022102356, rse:0.20000389218330383
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.0699467658996582 GB
Epoch: 1 cost time: 2.309114694595337
Epoch: 1, Steps: 64 | Train Loss: 0.8006635 Vali Loss: 1.8091455 Test Loss: 3.4479871
Validation loss decreased (inf --> 1.809145).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 2 cost time: 0.9196200370788574
Epoch: 2, Steps: 64 | Train Loss: 0.3287216 Vali Loss: 0.2017664 Test Loss: 0.1733852
Validation loss decreased (1.809145 --> 0.201766).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 3 cost time: 0.9414103031158447
Epoch: 3, Steps: 64 | Train Loss: 0.1000364 Vali Loss: 0.1730334 Test Loss: 0.1453656
Validation loss decreased (0.201766 --> 0.173033).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 4 cost time: 0.9216446876525879
Epoch: 4, Steps: 64 | Train Loss: 0.0912149 Vali Loss: 0.1651765 Test Loss: 0.1384586
Validation loss decreased (0.173033 --> 0.165176).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 5 cost time: 0.9043760299682617
Epoch: 5, Steps: 64 | Train Loss: 0.0873914 Vali Loss: 0.1621081 Test Loss: 0.1372245
Validation loss decreased (0.165176 --> 0.162108).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 6 cost time: 0.9027974605560303
Epoch: 6, Steps: 64 | Train Loss: 0.0850188 Vali Loss: 0.1569078 Test Loss: 0.1364857
Validation loss decreased (0.162108 --> 0.156908).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 7 cost time: 0.9060020446777344
Epoch: 7, Steps: 64 | Train Loss: 0.0841641 Vali Loss: 0.1534287 Test Loss: 0.1358892
Validation loss decreased (0.156908 --> 0.153429).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 8 cost time: 0.8946404457092285
Epoch: 8, Steps: 64 | Train Loss: 0.0827747 Vali Loss: 0.1529899 Test Loss: 0.1358685
Validation loss decreased (0.153429 --> 0.152990).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 9 cost time: 0.9183523654937744
Epoch: 9, Steps: 64 | Train Loss: 0.0815682 Vali Loss: 0.1505673 Test Loss: 0.1363332
Validation loss decreased (0.152990 --> 0.150567).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 10 cost time: 0.9306275844573975
Epoch: 10, Steps: 64 | Train Loss: 0.0810914 Vali Loss: 0.1484428 Test Loss: 0.1353844
Validation loss decreased (0.150567 --> 0.148443).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 11 cost time: 0.9204037189483643
Epoch: 11, Steps: 64 | Train Loss: 0.0801293 Vali Loss: 0.1474144 Test Loss: 0.1356401
Validation loss decreased (0.148443 --> 0.147414).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 12 cost time: 0.943519115447998
Epoch: 12, Steps: 64 | Train Loss: 0.0794415 Vali Loss: 0.1443589 Test Loss: 0.1354039
Validation loss decreased (0.147414 --> 0.144359).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 13 cost time: 0.9273808002471924
Epoch: 13, Steps: 64 | Train Loss: 0.0790780 Vali Loss: 0.1443229 Test Loss: 0.1350824
Validation loss decreased (0.144359 --> 0.144323).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 14 cost time: 0.9257385730743408
Epoch: 14, Steps: 64 | Train Loss: 0.0785956 Vali Loss: 0.1448627 Test Loss: 0.1352845
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 15 cost time: 0.91499924659729
Epoch: 15, Steps: 64 | Train Loss: 0.0782384 Vali Loss: 0.1445634 Test Loss: 0.1362062
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 16 cost time: 0.9176456928253174
Epoch: 16, Steps: 64 | Train Loss: 0.0780780 Vali Loss: 0.1414526 Test Loss: 0.1349167
Validation loss decreased (0.144323 --> 0.141453).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 17 cost time: 0.929408073425293
Epoch: 17, Steps: 64 | Train Loss: 0.0776371 Vali Loss: 0.1420319 Test Loss: 0.1356502
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 18 cost time: 0.930422306060791
Epoch: 18, Steps: 64 | Train Loss: 0.0769767 Vali Loss: 0.1405948 Test Loss: 0.1353319
Validation loss decreased (0.141453 --> 0.140595).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 19 cost time: 0.9361155033111572
Epoch: 19, Steps: 64 | Train Loss: 0.0769777 Vali Loss: 0.1399503 Test Loss: 0.1349861
Validation loss decreased (0.140595 --> 0.139950).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 20 cost time: 0.9373395442962646
Epoch: 20, Steps: 64 | Train Loss: 0.0767262 Vali Loss: 0.1404316 Test Loss: 0.1361924
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 21 cost time: 0.9343783855438232
Epoch: 21, Steps: 64 | Train Loss: 0.0768019 Vali Loss: 0.1409722 Test Loss: 0.1353123
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 22 cost time: 0.9117403030395508
Epoch: 22, Steps: 64 | Train Loss: 0.0760506 Vali Loss: 0.1391153 Test Loss: 0.1347682
Validation loss decreased (0.139950 --> 0.139115).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 23 cost time: 0.8963725566864014
Epoch: 23, Steps: 64 | Train Loss: 0.0762739 Vali Loss: 0.1414988 Test Loss: 0.1359653
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 24 cost time: 0.9046571254730225
Epoch: 24, Steps: 64 | Train Loss: 0.0757672 Vali Loss: 0.1381764 Test Loss: 0.1351629
Validation loss decreased (0.139115 --> 0.138176).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 25 cost time: 0.9033911228179932
Epoch: 25, Steps: 64 | Train Loss: 0.0757528 Vali Loss: 0.1403087 Test Loss: 0.1356272
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 26 cost time: 0.9203660488128662
Epoch: 26, Steps: 64 | Train Loss: 0.0758891 Vali Loss: 0.1398525 Test Loss: 0.1349935
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 27 cost time: 0.9173963069915771
Epoch: 27, Steps: 64 | Train Loss: 0.0753202 Vali Loss: 0.1394056 Test Loss: 0.1354028
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 28 cost time: 0.9113626480102539
Epoch: 28, Steps: 64 | Train Loss: 0.0754913 Vali Loss: 0.1395596 Test Loss: 0.1354893
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 29 cost time: 0.9227423667907715
Epoch: 29, Steps: 64 | Train Loss: 0.0755572 Vali Loss: 0.1385705 Test Loss: 0.1351755
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 30 cost time: 0.8929994106292725
Epoch: 30, Steps: 64 | Train Loss: 0.0755022 Vali Loss: 0.1386188 Test Loss: 0.1352675
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 31 cost time: 0.9027540683746338
Epoch: 31, Steps: 64 | Train Loss: 0.0753499 Vali Loss: 0.1376498 Test Loss: 0.1345748
Validation loss decreased (0.138176 --> 0.137650).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 32 cost time: 0.8946290016174316
Epoch: 32, Steps: 64 | Train Loss: 0.0751236 Vali Loss: 0.1385738 Test Loss: 0.1351994
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 33 cost time: 0.9094185829162598
Epoch: 33, Steps: 64 | Train Loss: 0.0754421 Vali Loss: 0.1373145 Test Loss: 0.1346150
Validation loss decreased (0.137650 --> 0.137314).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 34 cost time: 0.9334239959716797
Epoch: 34, Steps: 64 | Train Loss: 0.0750728 Vali Loss: 0.1383134 Test Loss: 0.1358661
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 35 cost time: 0.93253493309021
Epoch: 35, Steps: 64 | Train Loss: 0.0751233 Vali Loss: 0.1379211 Test Loss: 0.1347422
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 36 cost time: 0.9372742176055908
Epoch: 36, Steps: 64 | Train Loss: 0.0750040 Vali Loss: 0.1377013 Test Loss: 0.1345743
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 37 cost time: 0.9368748664855957
Epoch: 37, Steps: 64 | Train Loss: 0.0749422 Vali Loss: 0.1383383 Test Loss: 0.1345824
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 38 cost time: 0.9269981384277344
Epoch: 38, Steps: 64 | Train Loss: 0.0749627 Vali Loss: 0.1383194 Test Loss: 0.1350258
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 39 cost time: 0.9176490306854248
Epoch: 39, Steps: 64 | Train Loss: 0.0749859 Vali Loss: 0.1382138 Test Loss: 0.1343571
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 40 cost time: 0.9223575592041016
Epoch: 40, Steps: 64 | Train Loss: 0.0749676 Vali Loss: 0.1369966 Test Loss: 0.1340017
Validation loss decreased (0.137314 --> 0.136997).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 41 cost time: 0.9243838787078857
Epoch: 41, Steps: 64 | Train Loss: 0.0751211 Vali Loss: 0.1387684 Test Loss: 0.1348910
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 42 cost time: 0.9334366321563721
Epoch: 42, Steps: 64 | Train Loss: 0.0750778 Vali Loss: 0.1375505 Test Loss: 0.1343503
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 43 cost time: 0.9314148426055908
Epoch: 43, Steps: 64 | Train Loss: 0.0747654 Vali Loss: 0.1377973 Test Loss: 0.1343518
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 44 cost time: 0.9352443218231201
Epoch: 44, Steps: 64 | Train Loss: 0.0748068 Vali Loss: 0.1375285 Test Loss: 0.1346501
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 45 cost time: 0.9297492504119873
Epoch: 45, Steps: 64 | Train Loss: 0.0745773 Vali Loss: 0.1357636 Test Loss: 0.1343386
Validation loss decreased (0.136997 --> 0.135764).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 46 cost time: 0.9128129482269287
Epoch: 46, Steps: 64 | Train Loss: 0.0748792 Vali Loss: 0.1375020 Test Loss: 0.1342520
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 47 cost time: 0.8976211547851562
Epoch: 47, Steps: 64 | Train Loss: 0.0746998 Vali Loss: 0.1376757 Test Loss: 0.1345585
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 48 cost time: 0.9059109687805176
Epoch: 48, Steps: 64 | Train Loss: 0.0747224 Vali Loss: 0.1379081 Test Loss: 0.1355318
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 49 cost time: 0.9063725471496582
Epoch: 49, Steps: 64 | Train Loss: 0.0745893 Vali Loss: 0.1365576 Test Loss: 0.1344535
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 50 cost time: 0.9003627300262451
Epoch: 50, Steps: 64 | Train Loss: 0.0746091 Vali Loss: 0.1364102 Test Loss: 0.1345156
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 51 cost time: 0.91949462890625
Epoch: 51, Steps: 64 | Train Loss: 0.0746271 Vali Loss: 0.1381991 Test Loss: 0.1346023
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 52 cost time: 0.9207465648651123
Epoch: 52, Steps: 64 | Train Loss: 0.0745954 Vali Loss: 0.1366884 Test Loss: 0.1345874
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 53 cost time: 0.9159998893737793
Epoch: 53, Steps: 64 | Train Loss: 0.0747501 Vali Loss: 0.1370377 Test Loss: 0.1344357
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 54 cost time: 0.9176375865936279
Epoch: 54, Steps: 64 | Train Loss: 0.0747221 Vali Loss: 0.1367193 Test Loss: 0.1343158
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 55 cost time: 0.9077959060668945
Epoch: 55, Steps: 64 | Train Loss: 0.0746913 Vali Loss: 0.1357505 Test Loss: 0.1341687
Validation loss decreased (0.135764 --> 0.135751).  Saving model ...
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 56 cost time: 0.9154086112976074
Epoch: 56, Steps: 64 | Train Loss: 0.0748228 Vali Loss: 0.1382098 Test Loss: 0.1348962
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 57 cost time: 0.9138138294219971
Epoch: 57, Steps: 64 | Train Loss: 0.0745533 Vali Loss: 0.1379989 Test Loss: 0.1347966
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 58 cost time: 0.9204585552215576
Epoch: 58, Steps: 64 | Train Loss: 0.0748026 Vali Loss: 0.1374667 Test Loss: 0.1351537
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 59 cost time: 0.9307386875152588
Epoch: 59, Steps: 64 | Train Loss: 0.0753209 Vali Loss: 0.1362186 Test Loss: 0.1343574
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020441055297851562 GB
GPU已分配内存的峰值：0.07095956802368164 GB
Epoch: 60 cost time: 0.9349982738494873
Epoch: 60, Steps: 64 | Train Loss: 0.0747247 Vali Loss: 0.1384157 Test Loss: 0.1346759
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13416872918605804, mae:0.2654529809951782, rse:0.19496050477027893
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=2, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07306241989135742 GB
Epoch: 1 cost time: 2.3634889125823975
Epoch: 1, Steps: 64 | Train Loss: 0.7540256 Vali Loss: 1.7219567 Test Loss: 3.2823141
Validation loss decreased (inf --> 1.721957).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 2 cost time: 0.9397387504577637
Epoch: 2, Steps: 64 | Train Loss: 0.2882566 Vali Loss: 0.2294241 Test Loss: 0.2875713
Validation loss decreased (1.721957 --> 0.229424).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 3 cost time: 0.9388277530670166
Epoch: 3, Steps: 64 | Train Loss: 0.0965016 Vali Loss: 0.1639594 Test Loss: 0.1369556
Validation loss decreased (0.229424 --> 0.163959).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 4 cost time: 0.9309985637664795
Epoch: 4, Steps: 64 | Train Loss: 0.0862585 Vali Loss: 0.1545072 Test Loss: 0.1361763
Validation loss decreased (0.163959 --> 0.154507).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 5 cost time: 0.9423995018005371
Epoch: 5, Steps: 64 | Train Loss: 0.0834616 Vali Loss: 0.1525368 Test Loss: 0.1333111
Validation loss decreased (0.154507 --> 0.152537).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 6 cost time: 0.9196364879608154
Epoch: 6, Steps: 64 | Train Loss: 0.0812812 Vali Loss: 0.1469223 Test Loss: 0.1341009
Validation loss decreased (0.152537 --> 0.146922).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 7 cost time: 0.924375057220459
Epoch: 7, Steps: 64 | Train Loss: 0.0803262 Vali Loss: 0.1470943 Test Loss: 0.1348577
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 8 cost time: 0.9243717193603516
Epoch: 8, Steps: 64 | Train Loss: 0.0789560 Vali Loss: 0.1427328 Test Loss: 0.1330225
Validation loss decreased (0.146922 --> 0.142733).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 9 cost time: 0.9393799304962158
Epoch: 9, Steps: 64 | Train Loss: 0.0779482 Vali Loss: 0.1407728 Test Loss: 0.1320476
Validation loss decreased (0.142733 --> 0.140773).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 10 cost time: 0.9460971355438232
Epoch: 10, Steps: 64 | Train Loss: 0.0775699 Vali Loss: 0.1399086 Test Loss: 0.1335378
Validation loss decreased (0.140773 --> 0.139909).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 11 cost time: 0.9454410076141357
Epoch: 11, Steps: 64 | Train Loss: 0.0765318 Vali Loss: 0.1388043 Test Loss: 0.1329941
Validation loss decreased (0.139909 --> 0.138804).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 12 cost time: 0.9607172012329102
Epoch: 12, Steps: 64 | Train Loss: 0.0761650 Vali Loss: 0.1390854 Test Loss: 0.1336662
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 13 cost time: 0.950000524520874
Epoch: 13, Steps: 64 | Train Loss: 0.0753599 Vali Loss: 0.1369062 Test Loss: 0.1336058
Validation loss decreased (0.138804 --> 0.136906).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 14 cost time: 0.937619686126709
Epoch: 14, Steps: 64 | Train Loss: 0.0754130 Vali Loss: 0.1368757 Test Loss: 0.1345634
Validation loss decreased (0.136906 --> 0.136876).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 15 cost time: 0.9376349449157715
Epoch: 15, Steps: 64 | Train Loss: 0.0749580 Vali Loss: 0.1369044 Test Loss: 0.1332851
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 16 cost time: 0.9464342594146729
Epoch: 16, Steps: 64 | Train Loss: 0.0747491 Vali Loss: 0.1350932 Test Loss: 0.1331959
Validation loss decreased (0.136876 --> 0.135093).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 17 cost time: 0.9644589424133301
Epoch: 17, Steps: 64 | Train Loss: 0.0745507 Vali Loss: 0.1369527 Test Loss: 0.1339540
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 18 cost time: 0.9582796096801758
Epoch: 18, Steps: 64 | Train Loss: 0.0736835 Vali Loss: 0.1351991 Test Loss: 0.1334872
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 19 cost time: 0.957740068435669
Epoch: 19, Steps: 64 | Train Loss: 0.0738607 Vali Loss: 0.1363254 Test Loss: 0.1331369
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 20 cost time: 0.9634041786193848
Epoch: 20, Steps: 64 | Train Loss: 0.0734684 Vali Loss: 0.1338775 Test Loss: 0.1333721
Validation loss decreased (0.135093 --> 0.133877).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 21 cost time: 0.9524829387664795
Epoch: 21, Steps: 64 | Train Loss: 0.0733951 Vali Loss: 0.1358071 Test Loss: 0.1331666
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 22 cost time: 0.9281308650970459
Epoch: 22, Steps: 64 | Train Loss: 0.0727241 Vali Loss: 0.1358332 Test Loss: 0.1327712
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 23 cost time: 0.9269979000091553
Epoch: 23, Steps: 64 | Train Loss: 0.0731986 Vali Loss: 0.1349868 Test Loss: 0.1332504
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 24 cost time: 0.9220013618469238
Epoch: 24, Steps: 64 | Train Loss: 0.0728306 Vali Loss: 0.1341520 Test Loss: 0.1329879
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 25 cost time: 0.9456512928009033
Epoch: 25, Steps: 64 | Train Loss: 0.0728517 Vali Loss: 0.1333394 Test Loss: 0.1335095
Validation loss decreased (0.133877 --> 0.133339).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 26 cost time: 0.9424052238464355
Epoch: 26, Steps: 64 | Train Loss: 0.0730518 Vali Loss: 0.1343890 Test Loss: 0.1327123
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 27 cost time: 0.9473497867584229
Epoch: 27, Steps: 64 | Train Loss: 0.0726050 Vali Loss: 0.1317261 Test Loss: 0.1327205
Validation loss decreased (0.133339 --> 0.131726).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 28 cost time: 0.952486515045166
Epoch: 28, Steps: 64 | Train Loss: 0.0720836 Vali Loss: 0.1344597 Test Loss: 0.1332374
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 29 cost time: 0.9213693141937256
Epoch: 29, Steps: 64 | Train Loss: 0.0724111 Vali Loss: 0.1354172 Test Loss: 0.1335508
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 30 cost time: 0.917975902557373
Epoch: 30, Steps: 64 | Train Loss: 0.0725418 Vali Loss: 0.1330293 Test Loss: 0.1329178
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 31 cost time: 0.9174706935882568
Epoch: 31, Steps: 64 | Train Loss: 0.0725002 Vali Loss: 0.1355453 Test Loss: 0.1336049
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 32 cost time: 0.9316411018371582
Epoch: 32, Steps: 64 | Train Loss: 0.0723009 Vali Loss: 0.1336357 Test Loss: 0.1335118
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 33 cost time: 0.9566478729248047
Epoch: 33, Steps: 64 | Train Loss: 0.0719559 Vali Loss: 0.1338539 Test Loss: 0.1332395
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 34 cost time: 0.9651162624359131
Epoch: 34, Steps: 64 | Train Loss: 0.0719133 Vali Loss: 0.1345685 Test Loss: 0.1329365
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 35 cost time: 0.9803805351257324
Epoch: 35, Steps: 64 | Train Loss: 0.0721118 Vali Loss: 0.1350703 Test Loss: 0.1335610
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 36 cost time: 0.9654357433319092
Epoch: 36, Steps: 64 | Train Loss: 0.0720551 Vali Loss: 0.1347622 Test Loss: 0.1330609
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 37 cost time: 0.9433934688568115
Epoch: 37, Steps: 64 | Train Loss: 0.0718209 Vali Loss: 0.1342816 Test Loss: 0.1331308
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 38 cost time: 0.9530477523803711
Epoch: 38, Steps: 64 | Train Loss: 0.0720009 Vali Loss: 0.1345314 Test Loss: 0.1334507
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 39 cost time: 0.9443554878234863
Epoch: 39, Steps: 64 | Train Loss: 0.0721025 Vali Loss: 0.1338390 Test Loss: 0.1332322
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 40 cost time: 0.9547324180603027
Epoch: 40, Steps: 64 | Train Loss: 0.0718519 Vali Loss: 0.1334681 Test Loss: 0.1335653
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 41 cost time: 0.9617371559143066
Epoch: 41, Steps: 64 | Train Loss: 0.0721283 Vali Loss: 0.1341203 Test Loss: 0.1331599
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 42 cost time: 0.9647078514099121
Epoch: 42, Steps: 64 | Train Loss: 0.0718991 Vali Loss: 0.1341091 Test Loss: 0.1332962
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 43 cost time: 0.9480013847351074
Epoch: 43, Steps: 64 | Train Loss: 0.0719722 Vali Loss: 0.1348579 Test Loss: 0.1333020
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 44 cost time: 0.9402627944946289
Epoch: 44, Steps: 64 | Train Loss: 0.0720527 Vali Loss: 0.1335859 Test Loss: 0.1333205
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 45 cost time: 0.9304487705230713
Epoch: 45, Steps: 64 | Train Loss: 0.0716648 Vali Loss: 0.1334068 Test Loss: 0.1332398
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 46 cost time: 0.9292588233947754
Epoch: 46, Steps: 64 | Train Loss: 0.0719360 Vali Loss: 0.1329720 Test Loss: 0.1335589
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 47 cost time: 0.9240069389343262
Epoch: 47, Steps: 64 | Train Loss: 0.0720269 Vali Loss: 0.1344952 Test Loss: 0.1333003
EarlyStopping counter: 20 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 48 cost time: 0.9314661026000977
Epoch: 48, Steps: 64 | Train Loss: 0.0712861 Vali Loss: 0.1347434 Test Loss: 0.1331586
EarlyStopping counter: 21 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 49 cost time: 0.9374678134918213
Epoch: 49, Steps: 64 | Train Loss: 0.0718943 Vali Loss: 0.1345247 Test Loss: 0.1334015
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 50 cost time: 0.9368007183074951
Epoch: 50, Steps: 64 | Train Loss: 0.0715790 Vali Loss: 0.1338744 Test Loss: 0.1334470
EarlyStopping counter: 23 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 51 cost time: 0.943615198135376
Epoch: 51, Steps: 64 | Train Loss: 0.0719537 Vali Loss: 0.1332517 Test Loss: 0.1331379
EarlyStopping counter: 24 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 52 cost time: 0.9500007629394531
Epoch: 52, Steps: 64 | Train Loss: 0.0719537 Vali Loss: 0.1327534 Test Loss: 0.1335722
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 53 cost time: 0.9289166927337646
Epoch: 53, Steps: 64 | Train Loss: 0.0714567 Vali Loss: 0.1339031 Test Loss: 0.1332785
EarlyStopping counter: 26 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 54 cost time: 0.9493985176086426
Epoch: 54, Steps: 64 | Train Loss: 0.0716208 Vali Loss: 0.1336671 Test Loss: 0.1337536
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 55 cost time: 0.9484121799468994
Epoch: 55, Steps: 64 | Train Loss: 0.0718698 Vali Loss: 0.1337970 Test Loss: 0.1331173
EarlyStopping counter: 28 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 56 cost time: 0.9403982162475586
Epoch: 56, Steps: 64 | Train Loss: 0.0719585 Vali Loss: 0.1344981 Test Loss: 0.1335275
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 57 cost time: 0.9674315452575684
Epoch: 57, Steps: 64 | Train Loss: 0.0717286 Vali Loss: 0.1340715 Test Loss: 0.1334984
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 58 cost time: 0.9663796424865723
Epoch: 58, Steps: 64 | Train Loss: 0.0717791 Vali Loss: 0.1330509 Test Loss: 0.1330797
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 59 cost time: 0.9657113552093506
Epoch: 59, Steps: 64 | Train Loss: 0.0720574 Vali Loss: 0.1342126 Test Loss: 0.1329078
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021425247192382812 GB
GPU已分配内存的峰值：0.07609319686889648 GB
Epoch: 60 cost time: 0.9647324085235596
Epoch: 60, Steps: 64 | Train Loss: 0.0717342 Vali Loss: 0.1340187 Test Loss: 0.1332609
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_2_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13272050023078918, mae:0.2672020494937897, rse:0.19390542805194855
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06583642959594727 GB
Epoch: 1 cost time: 2.286151647567749
Epoch: 1, Steps: 64 | Train Loss: 0.8464442 Vali Loss: 1.8569403 Test Loss: 3.5013690
Validation loss decreased (inf --> 1.856940).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 2 cost time: 0.8747410774230957
Epoch: 2, Steps: 64 | Train Loss: 0.5451700 Vali Loss: 0.6662155 Test Loss: 1.0641264
Validation loss decreased (1.856940 --> 0.666215).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 3 cost time: 0.8811745643615723
Epoch: 3, Steps: 64 | Train Loss: 0.2592444 Vali Loss: 0.3611588 Test Loss: 0.4707552
Validation loss decreased (0.666215 --> 0.361159).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 4 cost time: 0.8816254138946533
Epoch: 4, Steps: 64 | Train Loss: 0.1605142 Vali Loss: 0.2503198 Test Loss: 0.2660569
Validation loss decreased (0.361159 --> 0.250320).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 5 cost time: 0.8725638389587402
Epoch: 5, Steps: 64 | Train Loss: 0.1233857 Vali Loss: 0.2036074 Test Loss: 0.1990527
Validation loss decreased (0.250320 --> 0.203607).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 6 cost time: 0.861037015914917
Epoch: 6, Steps: 64 | Train Loss: 0.1100011 Vali Loss: 0.1838472 Test Loss: 0.1707752
Validation loss decreased (0.203607 --> 0.183847).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 7 cost time: 0.8583943843841553
Epoch: 7, Steps: 64 | Train Loss: 0.1033700 Vali Loss: 0.1737625 Test Loss: 0.1585401
Validation loss decreased (0.183847 --> 0.173763).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 8 cost time: 0.8580434322357178
Epoch: 8, Steps: 64 | Train Loss: 0.1005245 Vali Loss: 0.1712410 Test Loss: 0.1528183
Validation loss decreased (0.173763 --> 0.171241).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 9 cost time: 0.8799967765808105
Epoch: 9, Steps: 64 | Train Loss: 0.0977918 Vali Loss: 0.1658542 Test Loss: 0.1494635
Validation loss decreased (0.171241 --> 0.165854).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 10 cost time: 0.8846452236175537
Epoch: 10, Steps: 64 | Train Loss: 0.0956659 Vali Loss: 0.1651373 Test Loss: 0.1487392
Validation loss decreased (0.165854 --> 0.165137).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 11 cost time: 0.884392499923706
Epoch: 11, Steps: 64 | Train Loss: 0.0943762 Vali Loss: 0.1629493 Test Loss: 0.1462071
Validation loss decreased (0.165137 --> 0.162949).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 12 cost time: 0.9080548286437988
Epoch: 12, Steps: 64 | Train Loss: 0.0930510 Vali Loss: 0.1605113 Test Loss: 0.1461904
Validation loss decreased (0.162949 --> 0.160511).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 13 cost time: 0.8979265689849854
Epoch: 13, Steps: 64 | Train Loss: 0.0919149 Vali Loss: 0.1601735 Test Loss: 0.1451263
Validation loss decreased (0.160511 --> 0.160174).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 14 cost time: 0.87886643409729
Epoch: 14, Steps: 64 | Train Loss: 0.0916251 Vali Loss: 0.1591532 Test Loss: 0.1452087
Validation loss decreased (0.160174 --> 0.159153).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 15 cost time: 0.8799998760223389
Epoch: 15, Steps: 64 | Train Loss: 0.0908044 Vali Loss: 0.1562342 Test Loss: 0.1441220
Validation loss decreased (0.159153 --> 0.156234).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 16 cost time: 0.8826446533203125
Epoch: 16, Steps: 64 | Train Loss: 0.0900756 Vali Loss: 0.1555458 Test Loss: 0.1437047
Validation loss decreased (0.156234 --> 0.155546).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 17 cost time: 0.8816318511962891
Epoch: 17, Steps: 64 | Train Loss: 0.0897361 Vali Loss: 0.1563862 Test Loss: 0.1440960
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 18 cost time: 0.8936657905578613
Epoch: 18, Steps: 64 | Train Loss: 0.0886632 Vali Loss: 0.1576861 Test Loss: 0.1435429
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 19 cost time: 0.8994541168212891
Epoch: 19, Steps: 64 | Train Loss: 0.0882168 Vali Loss: 0.1543533 Test Loss: 0.1436515
Validation loss decreased (0.155546 --> 0.154353).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 20 cost time: 0.8977513313293457
Epoch: 20, Steps: 64 | Train Loss: 0.0879384 Vali Loss: 0.1543693 Test Loss: 0.1429176
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 21 cost time: 0.8949999809265137
Epoch: 21, Steps: 64 | Train Loss: 0.0880079 Vali Loss: 0.1544520 Test Loss: 0.1434439
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 22 cost time: 0.894625186920166
Epoch: 22, Steps: 64 | Train Loss: 0.0875221 Vali Loss: 0.1534913 Test Loss: 0.1431183
Validation loss decreased (0.154353 --> 0.153491).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 23 cost time: 0.8716537952423096
Epoch: 23, Steps: 64 | Train Loss: 0.0876406 Vali Loss: 0.1524352 Test Loss: 0.1426215
Validation loss decreased (0.153491 --> 0.152435).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 24 cost time: 0.8733875751495361
Epoch: 24, Steps: 64 | Train Loss: 0.0869869 Vali Loss: 0.1549916 Test Loss: 0.1426311
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 25 cost time: 0.8644511699676514
Epoch: 25, Steps: 64 | Train Loss: 0.0867067 Vali Loss: 0.1529534 Test Loss: 0.1427652
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 26 cost time: 0.8621988296508789
Epoch: 26, Steps: 64 | Train Loss: 0.0866267 Vali Loss: 0.1513540 Test Loss: 0.1425341
Validation loss decreased (0.152435 --> 0.151354).  Saving model ...
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 27 cost time: 0.8829996585845947
Epoch: 27, Steps: 64 | Train Loss: 0.0865041 Vali Loss: 0.1537523 Test Loss: 0.1422512
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 28 cost time: 0.8726222515106201
Epoch: 28, Steps: 64 | Train Loss: 0.0862130 Vali Loss: 0.1527866 Test Loss: 0.1424120
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 29 cost time: 0.9024214744567871
Epoch: 29, Steps: 64 | Train Loss: 0.0858902 Vali Loss: 0.1530632 Test Loss: 0.1417461
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 30 cost time: 0.8941826820373535
Epoch: 30, Steps: 64 | Train Loss: 0.0859839 Vali Loss: 0.1523756 Test Loss: 0.1418999
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 31 cost time: 0.8664572238922119
Epoch: 31, Steps: 64 | Train Loss: 0.0860046 Vali Loss: 0.1539153 Test Loss: 0.1431438
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 32 cost time: 0.8535723686218262
Epoch: 32, Steps: 64 | Train Loss: 0.0856618 Vali Loss: 0.1535542 Test Loss: 0.1415856
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 33 cost time: 0.8539993762969971
Epoch: 33, Steps: 64 | Train Loss: 0.0859488 Vali Loss: 0.1517907 Test Loss: 0.1422813
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 34 cost time: 0.8726367950439453
Epoch: 34, Steps: 64 | Train Loss: 0.0851844 Vali Loss: 0.1525079 Test Loss: 0.1411320
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 35 cost time: 0.8768067359924316
Epoch: 35, Steps: 64 | Train Loss: 0.0853262 Vali Loss: 0.1508290 Test Loss: 0.1416798
Validation loss decreased (0.151354 --> 0.150829).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 36 cost time: 0.9046998023986816
Epoch: 36, Steps: 64 | Train Loss: 0.0850349 Vali Loss: 0.1521614 Test Loss: 0.1424337
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 37 cost time: 0.9113640785217285
Epoch: 37, Steps: 64 | Train Loss: 0.0848474 Vali Loss: 0.1520760 Test Loss: 0.1416909
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 38 cost time: 0.8977968692779541
Epoch: 38, Steps: 64 | Train Loss: 0.0851808 Vali Loss: 0.1516684 Test Loss: 0.1421796
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 39 cost time: 0.8994066715240479
Epoch: 39, Steps: 64 | Train Loss: 0.0849670 Vali Loss: 0.1525992 Test Loss: 0.1410634
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 40 cost time: 0.8851628303527832
Epoch: 40, Steps: 64 | Train Loss: 0.0852229 Vali Loss: 0.1510741 Test Loss: 0.1417695
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 41 cost time: 0.894219160079956
Epoch: 41, Steps: 64 | Train Loss: 0.0849164 Vali Loss: 0.1524191 Test Loss: 0.1417552
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 42 cost time: 0.8824639320373535
Epoch: 42, Steps: 64 | Train Loss: 0.0850703 Vali Loss: 0.1510682 Test Loss: 0.1426135
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 43 cost time: 0.8814566135406494
Epoch: 43, Steps: 64 | Train Loss: 0.0848871 Vali Loss: 0.1526918 Test Loss: 0.1419684
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 44 cost time: 0.8823704719543457
Epoch: 44, Steps: 64 | Train Loss: 0.0846935 Vali Loss: 0.1534454 Test Loss: 0.1420528
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 45 cost time: 0.8920142650604248
Epoch: 45, Steps: 64 | Train Loss: 0.0843976 Vali Loss: 0.1505999 Test Loss: 0.1419145
Validation loss decreased (0.150829 --> 0.150600).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 46 cost time: 0.8786478042602539
Epoch: 46, Steps: 64 | Train Loss: 0.0848631 Vali Loss: 0.1517385 Test Loss: 0.1414693
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 47 cost time: 0.8753695487976074
Epoch: 47, Steps: 64 | Train Loss: 0.0845892 Vali Loss: 0.1519427 Test Loss: 0.1420466
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 48 cost time: 0.8783831596374512
Epoch: 48, Steps: 64 | Train Loss: 0.0849434 Vali Loss: 0.1523764 Test Loss: 0.1416036
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 49 cost time: 0.85740065574646
Epoch: 49, Steps: 64 | Train Loss: 0.0849615 Vali Loss: 0.1517741 Test Loss: 0.1418616
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 50 cost time: 0.862297773361206
Epoch: 50, Steps: 64 | Train Loss: 0.0846793 Vali Loss: 0.1500574 Test Loss: 0.1415072
Validation loss decreased (0.150600 --> 0.150057).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 51 cost time: 0.8620004653930664
Epoch: 51, Steps: 64 | Train Loss: 0.0847040 Vali Loss: 0.1512572 Test Loss: 0.1416267
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 52 cost time: 0.865642786026001
Epoch: 52, Steps: 64 | Train Loss: 0.0848399 Vali Loss: 0.1520997 Test Loss: 0.1416818
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 53 cost time: 0.8643054962158203
Epoch: 53, Steps: 64 | Train Loss: 0.0846344 Vali Loss: 0.1512795 Test Loss: 0.1414563
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 54 cost time: 0.8783793449401855
Epoch: 54, Steps: 64 | Train Loss: 0.0849352 Vali Loss: 0.1521005 Test Loss: 0.1422150
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 55 cost time: 0.8814113140106201
Epoch: 55, Steps: 64 | Train Loss: 0.0848367 Vali Loss: 0.1513095 Test Loss: 0.1424457
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 56 cost time: 0.8827319145202637
Epoch: 56, Steps: 64 | Train Loss: 0.0847050 Vali Loss: 0.1521097 Test Loss: 0.1418266
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 57 cost time: 0.8973889350891113
Epoch: 57, Steps: 64 | Train Loss: 0.0844023 Vali Loss: 0.1511847 Test Loss: 0.1410897
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 58 cost time: 0.8766481876373291
Epoch: 58, Steps: 64 | Train Loss: 0.0850080 Vali Loss: 0.1515111 Test Loss: 0.1418968
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 59 cost time: 0.8634505271911621
Epoch: 59, Steps: 64 | Train Loss: 0.0851148 Vali Loss: 0.1527762 Test Loss: 0.1424091
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.018739700317382812 GB
GPU已分配内存的峰值：0.06673097610473633 GB
Epoch: 60 cost time: 0.8763489723205566
Epoch: 60, Steps: 64 | Train Loss: 0.0843004 Vali Loss: 0.1517330 Test Loss: 0.1420029
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.14150716364383698, mae:0.27315428853034973, rse:0.20022127032279968
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07010889053344727 GB
Epoch: 1 cost time: 2.303877353668213
Epoch: 1, Steps: 64 | Train Loss: 0.7578857 Vali Loss: 1.7098653 Test Loss: 3.2478015
Validation loss decreased (inf --> 1.709865).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 2 cost time: 0.9163963794708252
Epoch: 2, Steps: 64 | Train Loss: 0.3433652 Vali Loss: 0.1881852 Test Loss: 0.1553652
Validation loss decreased (1.709865 --> 0.188185).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 3 cost time: 0.9074068069458008
Epoch: 3, Steps: 64 | Train Loss: 0.1005528 Vali Loss: 0.1672993 Test Loss: 0.1413790
Validation loss decreased (0.188185 --> 0.167299).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 4 cost time: 0.9183640480041504
Epoch: 4, Steps: 64 | Train Loss: 0.0911781 Vali Loss: 0.1572026 Test Loss: 0.1369346
Validation loss decreased (0.167299 --> 0.157203).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 5 cost time: 0.893998384475708
Epoch: 5, Steps: 64 | Train Loss: 0.0877487 Vali Loss: 0.1537353 Test Loss: 0.1382025
Validation loss decreased (0.157203 --> 0.153735).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 6 cost time: 0.8990898132324219
Epoch: 6, Steps: 64 | Train Loss: 0.0857571 Vali Loss: 0.1534807 Test Loss: 0.1363020
Validation loss decreased (0.153735 --> 0.153481).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 7 cost time: 0.8994259834289551
Epoch: 7, Steps: 64 | Train Loss: 0.0838251 Vali Loss: 0.1499032 Test Loss: 0.1378042
Validation loss decreased (0.153481 --> 0.149903).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 8 cost time: 0.8934025764465332
Epoch: 8, Steps: 64 | Train Loss: 0.0825925 Vali Loss: 0.1482985 Test Loss: 0.1358099
Validation loss decreased (0.149903 --> 0.148298).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 9 cost time: 0.9155163764953613
Epoch: 9, Steps: 64 | Train Loss: 0.0817427 Vali Loss: 0.1467282 Test Loss: 0.1358108
Validation loss decreased (0.148298 --> 0.146728).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 10 cost time: 0.917426586151123
Epoch: 10, Steps: 64 | Train Loss: 0.0808305 Vali Loss: 0.1468148 Test Loss: 0.1361008
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 11 cost time: 0.9092714786529541
Epoch: 11, Steps: 64 | Train Loss: 0.0800888 Vali Loss: 0.1471436 Test Loss: 0.1357208
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 12 cost time: 0.93672776222229
Epoch: 12, Steps: 64 | Train Loss: 0.0796986 Vali Loss: 0.1453491 Test Loss: 0.1349339
Validation loss decreased (0.146728 --> 0.145349).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 13 cost time: 0.9269998073577881
Epoch: 13, Steps: 64 | Train Loss: 0.0787507 Vali Loss: 0.1445915 Test Loss: 0.1366018
Validation loss decreased (0.145349 --> 0.144592).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 14 cost time: 0.9126367568969727
Epoch: 14, Steps: 64 | Train Loss: 0.0783287 Vali Loss: 0.1445872 Test Loss: 0.1355721
Validation loss decreased (0.144592 --> 0.144587).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 15 cost time: 0.9194374084472656
Epoch: 15, Steps: 64 | Train Loss: 0.0780260 Vali Loss: 0.1455084 Test Loss: 0.1350541
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 16 cost time: 0.9164464473724365
Epoch: 16, Steps: 64 | Train Loss: 0.0772994 Vali Loss: 0.1452106 Test Loss: 0.1362901
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 17 cost time: 0.9181637763977051
Epoch: 17, Steps: 64 | Train Loss: 0.0771271 Vali Loss: 0.1446164 Test Loss: 0.1351291
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 18 cost time: 0.9363551139831543
Epoch: 18, Steps: 64 | Train Loss: 0.0767215 Vali Loss: 0.1445118 Test Loss: 0.1359473
Validation loss decreased (0.144587 --> 0.144512).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 19 cost time: 0.945746898651123
Epoch: 19, Steps: 64 | Train Loss: 0.0764456 Vali Loss: 0.1438927 Test Loss: 0.1343908
Validation loss decreased (0.144512 --> 0.143893).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 20 cost time: 0.9277453422546387
Epoch: 20, Steps: 64 | Train Loss: 0.0760051 Vali Loss: 0.1430369 Test Loss: 0.1346022
Validation loss decreased (0.143893 --> 0.143037).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 21 cost time: 0.9250006675720215
Epoch: 21, Steps: 64 | Train Loss: 0.0759401 Vali Loss: 0.1406709 Test Loss: 0.1346106
Validation loss decreased (0.143037 --> 0.140671).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 22 cost time: 0.9096643924713135
Epoch: 22, Steps: 64 | Train Loss: 0.0760509 Vali Loss: 0.1444806 Test Loss: 0.1347791
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 23 cost time: 0.9068119525909424
Epoch: 23, Steps: 64 | Train Loss: 0.0755305 Vali Loss: 0.1419396 Test Loss: 0.1347831
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 24 cost time: 0.8934340476989746
Epoch: 24, Steps: 64 | Train Loss: 0.0756400 Vali Loss: 0.1423379 Test Loss: 0.1344961
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 25 cost time: 0.8926293849945068
Epoch: 25, Steps: 64 | Train Loss: 0.0751909 Vali Loss: 0.1426330 Test Loss: 0.1346885
EarlyStopping counter: 4 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 26 cost time: 0.9194512367248535
Epoch: 26, Steps: 64 | Train Loss: 0.0752225 Vali Loss: 0.1432517 Test Loss: 0.1344192
EarlyStopping counter: 5 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 27 cost time: 0.9208083152770996
Epoch: 27, Steps: 64 | Train Loss: 0.0749432 Vali Loss: 0.1424669 Test Loss: 0.1349682
EarlyStopping counter: 6 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 28 cost time: 0.9167895317077637
Epoch: 28, Steps: 64 | Train Loss: 0.0747542 Vali Loss: 0.1408559 Test Loss: 0.1353587
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 29 cost time: 0.9169986248016357
Epoch: 29, Steps: 64 | Train Loss: 0.0750141 Vali Loss: 0.1408915 Test Loss: 0.1345516
EarlyStopping counter: 8 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 30 cost time: 0.8946397304534912
Epoch: 30, Steps: 64 | Train Loss: 0.0745525 Vali Loss: 0.1410681 Test Loss: 0.1342743
EarlyStopping counter: 9 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 31 cost time: 0.8913695812225342
Epoch: 31, Steps: 64 | Train Loss: 0.0745892 Vali Loss: 0.1416992 Test Loss: 0.1345548
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 32 cost time: 0.8920125961303711
Epoch: 32, Steps: 64 | Train Loss: 0.0744206 Vali Loss: 0.1415297 Test Loss: 0.1344651
EarlyStopping counter: 11 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 33 cost time: 0.9013943672180176
Epoch: 33, Steps: 64 | Train Loss: 0.0745734 Vali Loss: 0.1414490 Test Loss: 0.1347189
EarlyStopping counter: 12 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 34 cost time: 0.9397366046905518
Epoch: 34, Steps: 64 | Train Loss: 0.0743539 Vali Loss: 0.1421365 Test Loss: 0.1345999
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 35 cost time: 0.932999849319458
Epoch: 35, Steps: 64 | Train Loss: 0.0744674 Vali Loss: 0.1409919 Test Loss: 0.1338644
EarlyStopping counter: 14 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 36 cost time: 0.9354033470153809
Epoch: 36, Steps: 64 | Train Loss: 0.0743222 Vali Loss: 0.1417429 Test Loss: 0.1343943
EarlyStopping counter: 15 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 37 cost time: 0.9536256790161133
Epoch: 37, Steps: 64 | Train Loss: 0.0743985 Vali Loss: 0.1430220 Test Loss: 0.1341114
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 38 cost time: 0.9233746528625488
Epoch: 38, Steps: 64 | Train Loss: 0.0739632 Vali Loss: 0.1417519 Test Loss: 0.1342870
EarlyStopping counter: 17 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 39 cost time: 0.9124608039855957
Epoch: 39, Steps: 64 | Train Loss: 0.0742849 Vali Loss: 0.1409416 Test Loss: 0.1340022
EarlyStopping counter: 18 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 40 cost time: 0.9184837341308594
Epoch: 40, Steps: 64 | Train Loss: 0.0742138 Vali Loss: 0.1405634 Test Loss: 0.1344050
Validation loss decreased (0.140671 --> 0.140563).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 41 cost time: 0.9122443199157715
Epoch: 41, Steps: 64 | Train Loss: 0.0739922 Vali Loss: 0.1422207 Test Loss: 0.1339477
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 42 cost time: 0.921722412109375
Epoch: 42, Steps: 64 | Train Loss: 0.0739058 Vali Loss: 0.1401405 Test Loss: 0.1342055
Validation loss decreased (0.140563 --> 0.140141).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 43 cost time: 0.9290001392364502
Epoch: 43, Steps: 64 | Train Loss: 0.0740906 Vali Loss: 0.1408999 Test Loss: 0.1339807
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 44 cost time: 0.919360876083374
Epoch: 44, Steps: 64 | Train Loss: 0.0740714 Vali Loss: 0.1406031 Test Loss: 0.1341991
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 45 cost time: 0.9116301536560059
Epoch: 45, Steps: 64 | Train Loss: 0.0740859 Vali Loss: 0.1420553 Test Loss: 0.1345997
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 46 cost time: 0.9134020805358887
Epoch: 46, Steps: 64 | Train Loss: 0.0736439 Vali Loss: 0.1399256 Test Loss: 0.1341383
Validation loss decreased (0.140141 --> 0.139926).  Saving model ...
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 47 cost time: 0.9053912162780762
Epoch: 47, Steps: 64 | Train Loss: 0.0741527 Vali Loss: 0.1416252 Test Loss: 0.1342730
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 48 cost time: 0.8983669281005859
Epoch: 48, Steps: 64 | Train Loss: 0.0739002 Vali Loss: 0.1398402 Test Loss: 0.1340527
Validation loss decreased (0.139926 --> 0.139840).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 49 cost time: 0.8920106887817383
Epoch: 49, Steps: 64 | Train Loss: 0.0739857 Vali Loss: 0.1417585 Test Loss: 0.1343074
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 50 cost time: 0.896082878112793
Epoch: 50, Steps: 64 | Train Loss: 0.0737682 Vali Loss: 0.1411036 Test Loss: 0.1343998
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 51 cost time: 0.9140019416809082
Epoch: 51, Steps: 64 | Train Loss: 0.0738603 Vali Loss: 0.1424897 Test Loss: 0.1343496
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 52 cost time: 0.9146435260772705
Epoch: 52, Steps: 64 | Train Loss: 0.0736492 Vali Loss: 0.1414007 Test Loss: 0.1338939
EarlyStopping counter: 4 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 53 cost time: 0.9105620384216309
Epoch: 53, Steps: 64 | Train Loss: 0.0738970 Vali Loss: 0.1415716 Test Loss: 0.1339988
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 54 cost time: 0.9234097003936768
Epoch: 54, Steps: 64 | Train Loss: 0.0739882 Vali Loss: 0.1409641 Test Loss: 0.1338641
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 55 cost time: 0.9053831100463867
Epoch: 55, Steps: 64 | Train Loss: 0.0737799 Vali Loss: 0.1411466 Test Loss: 0.1343430
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 56 cost time: 0.9173903465270996
Epoch: 56, Steps: 64 | Train Loss: 0.0736427 Vali Loss: 0.1412856 Test Loss: 0.1340133
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 57 cost time: 0.9111239910125732
Epoch: 57, Steps: 64 | Train Loss: 0.0738927 Vali Loss: 0.1397829 Test Loss: 0.1339163
Validation loss decreased (0.139840 --> 0.139783).  Saving model ...
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 58 cost time: 0.9079198837280273
Epoch: 58, Steps: 64 | Train Loss: 0.0738464 Vali Loss: 0.1409354 Test Loss: 0.1340188
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 59 cost time: 0.9286332130432129
Epoch: 59, Steps: 64 | Train Loss: 0.0734532 Vali Loss: 0.1426546 Test Loss: 0.1346926
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.020448684692382812 GB
GPU已分配内存的峰值：0.07112550735473633 GB
Epoch: 60 cost time: 0.9374022483825684
Epoch: 60, Steps: 64 | Train Loss: 0.0737507 Vali Loss: 0.1392129 Test Loss: 0.1341854
Validation loss decreased (0.139783 --> 0.139213).  Saving model ...
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13418541848659515, mae:0.26485687494277954, rse:0.19497261941432953
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=3, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07322454452514648 GB
Epoch: 1 cost time: 2.3455848693847656
Epoch: 1, Steps: 64 | Train Loss: 0.7463608 Vali Loss: 1.7356929 Test Loss: 3.2527661
Validation loss decreased (inf --> 1.735693).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 2 cost time: 0.9426431655883789
Epoch: 2, Steps: 64 | Train Loss: 0.3002808 Vali Loss: 0.2425544 Test Loss: 0.3005681
Validation loss decreased (1.735693 --> 0.242554).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 3 cost time: 0.9466149806976318
Epoch: 3, Steps: 64 | Train Loss: 0.0990743 Vali Loss: 0.1664084 Test Loss: 0.1349720
Validation loss decreased (0.242554 --> 0.166408).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 4 cost time: 0.9523577690124512
Epoch: 4, Steps: 64 | Train Loss: 0.0898125 Vali Loss: 0.1597619 Test Loss: 0.1348501
Validation loss decreased (0.166408 --> 0.159762).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 5 cost time: 0.9303767681121826
Epoch: 5, Steps: 64 | Train Loss: 0.0859786 Vali Loss: 0.1571216 Test Loss: 0.1352202
Validation loss decreased (0.159762 --> 0.157122).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 6 cost time: 0.9247455596923828
Epoch: 6, Steps: 64 | Train Loss: 0.0842764 Vali Loss: 0.1526239 Test Loss: 0.1345562
Validation loss decreased (0.157122 --> 0.152624).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 7 cost time: 0.9363839626312256
Epoch: 7, Steps: 64 | Train Loss: 0.0825663 Vali Loss: 0.1533199 Test Loss: 0.1335176
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 8 cost time: 0.9300098419189453
Epoch: 8, Steps: 64 | Train Loss: 0.0812372 Vali Loss: 0.1497618 Test Loss: 0.1328812
Validation loss decreased (0.152624 --> 0.149762).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 9 cost time: 0.9488091468811035
Epoch: 9, Steps: 64 | Train Loss: 0.0803485 Vali Loss: 0.1493452 Test Loss: 0.1336310
Validation loss decreased (0.149762 --> 0.149345).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 10 cost time: 0.9441142082214355
Epoch: 10, Steps: 64 | Train Loss: 0.0797298 Vali Loss: 0.1503525 Test Loss: 0.1363751
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 11 cost time: 0.9470014572143555
Epoch: 11, Steps: 64 | Train Loss: 0.0792131 Vali Loss: 0.1468927 Test Loss: 0.1338667
Validation loss decreased (0.149345 --> 0.146893).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 12 cost time: 0.9626412391662598
Epoch: 12, Steps: 64 | Train Loss: 0.0783891 Vali Loss: 0.1473215 Test Loss: 0.1333265
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 13 cost time: 0.9436116218566895
Epoch: 13, Steps: 64 | Train Loss: 0.0777610 Vali Loss: 0.1471142 Test Loss: 0.1342683
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 14 cost time: 0.957533597946167
Epoch: 14, Steps: 64 | Train Loss: 0.0773101 Vali Loss: 0.1469797 Test Loss: 0.1344712
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 15 cost time: 0.95334792137146
Epoch: 15, Steps: 64 | Train Loss: 0.0770866 Vali Loss: 0.1438745 Test Loss: 0.1342825
Validation loss decreased (0.146893 --> 0.143875).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 16 cost time: 0.9564473628997803
Epoch: 16, Steps: 64 | Train Loss: 0.0765911 Vali Loss: 0.1452948 Test Loss: 0.1347724
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 17 cost time: 0.9654297828674316
Epoch: 17, Steps: 64 | Train Loss: 0.0761871 Vali Loss: 0.1446367 Test Loss: 0.1334958
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 18 cost time: 0.9610471725463867
Epoch: 18, Steps: 64 | Train Loss: 0.0761089 Vali Loss: 0.1430064 Test Loss: 0.1337636
Validation loss decreased (0.143875 --> 0.143006).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 19 cost time: 0.9623818397521973
Epoch: 19, Steps: 64 | Train Loss: 0.0754005 Vali Loss: 0.1437486 Test Loss: 0.1342757
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 20 cost time: 0.9653654098510742
Epoch: 20, Steps: 64 | Train Loss: 0.0757411 Vali Loss: 0.1443508 Test Loss: 0.1350712
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 21 cost time: 0.953000545501709
Epoch: 21, Steps: 64 | Train Loss: 0.0751313 Vali Loss: 0.1444672 Test Loss: 0.1346213
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 22 cost time: 0.9173662662506104
Epoch: 22, Steps: 64 | Train Loss: 0.0747537 Vali Loss: 0.1426126 Test Loss: 0.1345138
Validation loss decreased (0.143006 --> 0.142613).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 23 cost time: 0.9196445941925049
Epoch: 23, Steps: 64 | Train Loss: 0.0746220 Vali Loss: 0.1429339 Test Loss: 0.1341019
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 24 cost time: 0.9334266185760498
Epoch: 24, Steps: 64 | Train Loss: 0.0747273 Vali Loss: 0.1432260 Test Loss: 0.1338931
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 25 cost time: 0.9453976154327393
Epoch: 25, Steps: 64 | Train Loss: 0.0745504 Vali Loss: 0.1424777 Test Loss: 0.1347167
Validation loss decreased (0.142613 --> 0.142478).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 26 cost time: 0.9384167194366455
Epoch: 26, Steps: 64 | Train Loss: 0.0741835 Vali Loss: 0.1434680 Test Loss: 0.1346581
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 27 cost time: 0.9453871250152588
Epoch: 27, Steps: 64 | Train Loss: 0.0742126 Vali Loss: 0.1412701 Test Loss: 0.1335273
Validation loss decreased (0.142478 --> 0.141270).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 28 cost time: 0.9383981227874756
Epoch: 28, Steps: 64 | Train Loss: 0.0741345 Vali Loss: 0.1413284 Test Loss: 0.1342081
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 29 cost time: 0.9197406768798828
Epoch: 29, Steps: 64 | Train Loss: 0.0739418 Vali Loss: 0.1432887 Test Loss: 0.1342471
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 30 cost time: 0.9174032211303711
Epoch: 30, Steps: 64 | Train Loss: 0.0736355 Vali Loss: 0.1397907 Test Loss: 0.1331120
Validation loss decreased (0.141270 --> 0.139791).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 31 cost time: 0.9209997653961182
Epoch: 31, Steps: 64 | Train Loss: 0.0735806 Vali Loss: 0.1437143 Test Loss: 0.1343720
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 32 cost time: 0.9206380844116211
Epoch: 32, Steps: 64 | Train Loss: 0.0734881 Vali Loss: 0.1415821 Test Loss: 0.1334106
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 33 cost time: 0.9663662910461426
Epoch: 33, Steps: 64 | Train Loss: 0.0736138 Vali Loss: 0.1412921 Test Loss: 0.1342137
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 34 cost time: 0.9731400012969971
Epoch: 34, Steps: 64 | Train Loss: 0.0736237 Vali Loss: 0.1427982 Test Loss: 0.1345290
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 35 cost time: 0.9624865055084229
Epoch: 35, Steps: 64 | Train Loss: 0.0736090 Vali Loss: 0.1417798 Test Loss: 0.1347016
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 36 cost time: 0.9644286632537842
Epoch: 36, Steps: 64 | Train Loss: 0.0731231 Vali Loss: 0.1425162 Test Loss: 0.1337519
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 37 cost time: 0.9719367027282715
Epoch: 37, Steps: 64 | Train Loss: 0.0733406 Vali Loss: 0.1395829 Test Loss: 0.1339865
Validation loss decreased (0.139791 --> 0.139583).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 38 cost time: 0.9585707187652588
Epoch: 38, Steps: 64 | Train Loss: 0.0735663 Vali Loss: 0.1406568 Test Loss: 0.1333425
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 39 cost time: 0.9704067707061768
Epoch: 39, Steps: 64 | Train Loss: 0.0730707 Vali Loss: 0.1403917 Test Loss: 0.1339637
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 40 cost time: 0.9799258708953857
Epoch: 40, Steps: 64 | Train Loss: 0.0732843 Vali Loss: 0.1415527 Test Loss: 0.1345091
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 41 cost time: 0.9669992923736572
Epoch: 41, Steps: 64 | Train Loss: 0.0731550 Vali Loss: 0.1400957 Test Loss: 0.1338737
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 42 cost time: 0.9717445373535156
Epoch: 42, Steps: 64 | Train Loss: 0.0731767 Vali Loss: 0.1411574 Test Loss: 0.1334707
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 43 cost time: 0.959449052810669
Epoch: 43, Steps: 64 | Train Loss: 0.0732458 Vali Loss: 0.1415325 Test Loss: 0.1339322
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 44 cost time: 0.9406182765960693
Epoch: 44, Steps: 64 | Train Loss: 0.0731013 Vali Loss: 0.1404359 Test Loss: 0.1338662
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 45 cost time: 0.92041015625
Epoch: 45, Steps: 64 | Train Loss: 0.0732393 Vali Loss: 0.1394498 Test Loss: 0.1331036
Validation loss decreased (0.139583 --> 0.139450).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 46 cost time: 0.9207420349121094
Epoch: 46, Steps: 64 | Train Loss: 0.0729155 Vali Loss: 0.1418840 Test Loss: 0.1335981
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 47 cost time: 0.9350831508636475
Epoch: 47, Steps: 64 | Train Loss: 0.0736008 Vali Loss: 0.1406659 Test Loss: 0.1336909
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 48 cost time: 0.9231410026550293
Epoch: 48, Steps: 64 | Train Loss: 0.0726329 Vali Loss: 0.1418002 Test Loss: 0.1333792
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 49 cost time: 0.941741943359375
Epoch: 49, Steps: 64 | Train Loss: 0.0728586 Vali Loss: 0.1424395 Test Loss: 0.1335992
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 50 cost time: 0.9448378086090088
Epoch: 50, Steps: 64 | Train Loss: 0.0730586 Vali Loss: 0.1422928 Test Loss: 0.1348886
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 51 cost time: 0.9484412670135498
Epoch: 51, Steps: 64 | Train Loss: 0.0730726 Vali Loss: 0.1409707 Test Loss: 0.1333846
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 52 cost time: 0.9456138610839844
Epoch: 52, Steps: 64 | Train Loss: 0.0728889 Vali Loss: 0.1414956 Test Loss: 0.1333783
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 53 cost time: 0.9286272525787354
Epoch: 53, Steps: 64 | Train Loss: 0.0729000 Vali Loss: 0.1408652 Test Loss: 0.1331439
EarlyStopping counter: 8 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 54 cost time: 0.9485893249511719
Epoch: 54, Steps: 64 | Train Loss: 0.0733064 Vali Loss: 0.1416081 Test Loss: 0.1341207
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 55 cost time: 0.95438551902771
Epoch: 55, Steps: 64 | Train Loss: 0.0728632 Vali Loss: 0.1395974 Test Loss: 0.1335165
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 56 cost time: 0.9563701152801514
Epoch: 56, Steps: 64 | Train Loss: 0.0730192 Vali Loss: 0.1408081 Test Loss: 0.1328370
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 57 cost time: 0.9670898914337158
Epoch: 57, Steps: 64 | Train Loss: 0.0731757 Vali Loss: 0.1404421 Test Loss: 0.1329403
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 58 cost time: 0.9713895320892334
Epoch: 58, Steps: 64 | Train Loss: 0.0728251 Vali Loss: 0.1425454 Test Loss: 0.1337360
EarlyStopping counter: 13 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 59 cost time: 0.9717676639556885
Epoch: 59, Steps: 64 | Train Loss: 0.0732909 Vali Loss: 0.1412762 Test Loss: 0.1337226
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.021432876586914062 GB
GPU已分配内存的峰值：0.07625913619995117 GB
Epoch: 60 cost time: 0.9687881469726562
Epoch: 60, Steps: 64 | Train Loss: 0.0729434 Vali Loss: 0.1408362 Test Loss: 0.1339733
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_3_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13310356438159943, mae:0.2625844478607178, rse:0.1941850632429123
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.06599807739257812 GB
Epoch: 1 cost time: 2.297879219055176
Epoch: 1, Steps: 64 | Train Loss: 1.0007390 Vali Loss: 2.1867518 Test Loss: 4.2675481
Validation loss decreased (inf --> 2.186752).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 2 cost time: 0.9157638549804688
Epoch: 2, Steps: 64 | Train Loss: 0.6406155 Vali Loss: 0.8556227 Test Loss: 1.4745691
Validation loss decreased (2.186752 --> 0.855623).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 3 cost time: 0.9058375358581543
Epoch: 3, Steps: 64 | Train Loss: 0.3242343 Vali Loss: 0.5014982 Test Loss: 0.7658043
Validation loss decreased (0.855623 --> 0.501498).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 4 cost time: 0.8939986228942871
Epoch: 4, Steps: 64 | Train Loss: 0.2094724 Vali Loss: 0.3379214 Test Loss: 0.4553318
Validation loss decreased (0.501498 --> 0.337921).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 5 cost time: 0.8686461448669434
Epoch: 5, Steps: 64 | Train Loss: 0.1515712 Vali Loss: 0.2580036 Test Loss: 0.3101687
Validation loss decreased (0.337921 --> 0.258004).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 6 cost time: 0.8654229640960693
Epoch: 6, Steps: 64 | Train Loss: 0.1240490 Vali Loss: 0.2144609 Test Loss: 0.2348647
Validation loss decreased (0.258004 --> 0.214461).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 7 cost time: 0.876518964767456
Epoch: 7, Steps: 64 | Train Loss: 0.1101907 Vali Loss: 0.1905773 Test Loss: 0.1930186
Validation loss decreased (0.214461 --> 0.190577).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 8 cost time: 0.8700723648071289
Epoch: 8, Steps: 64 | Train Loss: 0.1028972 Vali Loss: 0.1772582 Test Loss: 0.1719873
Validation loss decreased (0.190577 --> 0.177258).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 9 cost time: 0.8858387470245361
Epoch: 9, Steps: 64 | Train Loss: 0.0985020 Vali Loss: 0.1696675 Test Loss: 0.1603583
Validation loss decreased (0.177258 --> 0.169668).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 10 cost time: 0.889000415802002
Epoch: 10, Steps: 64 | Train Loss: 0.0962989 Vali Loss: 0.1655471 Test Loss: 0.1541197
Validation loss decreased (0.169668 --> 0.165547).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 11 cost time: 0.9016668796539307
Epoch: 11, Steps: 64 | Train Loss: 0.0944688 Vali Loss: 0.1619458 Test Loss: 0.1503038
Validation loss decreased (0.165547 --> 0.161946).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 12 cost time: 0.9158165454864502
Epoch: 12, Steps: 64 | Train Loss: 0.0925440 Vali Loss: 0.1599010 Test Loss: 0.1475582
Validation loss decreased (0.161946 --> 0.159901).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 13 cost time: 0.9133870601654053
Epoch: 13, Steps: 64 | Train Loss: 0.0916276 Vali Loss: 0.1567876 Test Loss: 0.1459839
Validation loss decreased (0.159901 --> 0.156788).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 14 cost time: 0.8994719982147217
Epoch: 14, Steps: 64 | Train Loss: 0.0911782 Vali Loss: 0.1555318 Test Loss: 0.1444528
Validation loss decreased (0.156788 --> 0.155532).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 15 cost time: 0.8874175548553467
Epoch: 15, Steps: 64 | Train Loss: 0.0895006 Vali Loss: 0.1533295 Test Loss: 0.1434750
Validation loss decreased (0.155532 --> 0.153330).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 16 cost time: 0.8867557048797607
Epoch: 16, Steps: 64 | Train Loss: 0.0892194 Vali Loss: 0.1538128 Test Loss: 0.1428050
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 17 cost time: 0.8853442668914795
Epoch: 17, Steps: 64 | Train Loss: 0.0889369 Vali Loss: 0.1533986 Test Loss: 0.1427283
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 18 cost time: 0.8866784572601318
Epoch: 18, Steps: 64 | Train Loss: 0.0884795 Vali Loss: 0.1512345 Test Loss: 0.1420539
Validation loss decreased (0.153330 --> 0.151235).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 19 cost time: 0.9114091396331787
Epoch: 19, Steps: 64 | Train Loss: 0.0880263 Vali Loss: 0.1517399 Test Loss: 0.1414294
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 20 cost time: 0.9094839096069336
Epoch: 20, Steps: 64 | Train Loss: 0.0870453 Vali Loss: 0.1501319 Test Loss: 0.1417603
Validation loss decreased (0.151235 --> 0.150132).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 21 cost time: 0.9288208484649658
Epoch: 21, Steps: 64 | Train Loss: 0.0870802 Vali Loss: 0.1500864 Test Loss: 0.1406501
Validation loss decreased (0.150132 --> 0.150086).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 22 cost time: 0.8967440128326416
Epoch: 22, Steps: 64 | Train Loss: 0.0867708 Vali Loss: 0.1488644 Test Loss: 0.1403746
Validation loss decreased (0.150086 --> 0.148864).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 23 cost time: 0.8769998550415039
Epoch: 23, Steps: 64 | Train Loss: 0.0867854 Vali Loss: 0.1517752 Test Loss: 0.1407536
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 24 cost time: 0.8880102634429932
Epoch: 24, Steps: 64 | Train Loss: 0.0864682 Vali Loss: 0.1489495 Test Loss: 0.1396789
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 25 cost time: 0.9639241695404053
Epoch: 25, Steps: 64 | Train Loss: 0.0862725 Vali Loss: 0.1480948 Test Loss: 0.1397870
Validation loss decreased (0.148864 --> 0.148095).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 26 cost time: 0.8716452121734619
Epoch: 26, Steps: 64 | Train Loss: 0.0860379 Vali Loss: 0.1489298 Test Loss: 0.1397138
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 27 cost time: 0.8950026035308838
Epoch: 27, Steps: 64 | Train Loss: 0.0858363 Vali Loss: 0.1485049 Test Loss: 0.1391329
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 28 cost time: 0.9045388698577881
Epoch: 28, Steps: 64 | Train Loss: 0.0851985 Vali Loss: 0.1476361 Test Loss: 0.1401140
Validation loss decreased (0.148095 --> 0.147636).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 29 cost time: 0.9036903381347656
Epoch: 29, Steps: 64 | Train Loss: 0.0853914 Vali Loss: 0.1478215 Test Loss: 0.1392533
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 30 cost time: 0.8868889808654785
Epoch: 30, Steps: 64 | Train Loss: 0.0851247 Vali Loss: 0.1463272 Test Loss: 0.1391211
Validation loss decreased (0.147636 --> 0.146327).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 31 cost time: 0.8590023517608643
Epoch: 31, Steps: 64 | Train Loss: 0.0847992 Vali Loss: 0.1457425 Test Loss: 0.1403280
Validation loss decreased (0.146327 --> 0.145743).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 32 cost time: 0.8575644493103027
Epoch: 32, Steps: 64 | Train Loss: 0.0849971 Vali Loss: 0.1473954 Test Loss: 0.1396543
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 33 cost time: 0.859572172164917
Epoch: 33, Steps: 64 | Train Loss: 0.0851459 Vali Loss: 0.1465022 Test Loss: 0.1398096
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 34 cost time: 0.8778016567230225
Epoch: 34, Steps: 64 | Train Loss: 0.0849131 Vali Loss: 0.1473253 Test Loss: 0.1387191
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 35 cost time: 0.9127624034881592
Epoch: 35, Steps: 64 | Train Loss: 0.0848057 Vali Loss: 0.1458057 Test Loss: 0.1393346
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 36 cost time: 0.9050002098083496
Epoch: 36, Steps: 64 | Train Loss: 0.0847572 Vali Loss: 0.1449788 Test Loss: 0.1397959
Validation loss decreased (0.145743 --> 0.144979).  Saving model ...
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 37 cost time: 0.9119999408721924
Epoch: 37, Steps: 64 | Train Loss: 0.0848770 Vali Loss: 0.1447631 Test Loss: 0.1389714
Validation loss decreased (0.144979 --> 0.144763).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 38 cost time: 0.9031789302825928
Epoch: 38, Steps: 64 | Train Loss: 0.0847687 Vali Loss: 0.1455098 Test Loss: 0.1390588
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 39 cost time: 0.9047236442565918
Epoch: 39, Steps: 64 | Train Loss: 0.0842771 Vali Loss: 0.1445371 Test Loss: 0.1385015
Validation loss decreased (0.144763 --> 0.144537).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 40 cost time: 0.8874521255493164
Epoch: 40, Steps: 64 | Train Loss: 0.0842637 Vali Loss: 0.1454408 Test Loss: 0.1389581
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 41 cost time: 0.8874101638793945
Epoch: 41, Steps: 64 | Train Loss: 0.0843756 Vali Loss: 0.1457989 Test Loss: 0.1388295
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 42 cost time: 0.8957862854003906
Epoch: 42, Steps: 64 | Train Loss: 0.0843891 Vali Loss: 0.1461716 Test Loss: 0.1396264
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 43 cost time: 0.8879990577697754
Epoch: 43, Steps: 64 | Train Loss: 0.0847425 Vali Loss: 0.1450203 Test Loss: 0.1389372
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 44 cost time: 0.9056291580200195
Epoch: 44, Steps: 64 | Train Loss: 0.0838696 Vali Loss: 0.1444798 Test Loss: 0.1392136
Validation loss decreased (0.144537 --> 0.144480).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 45 cost time: 0.9043905735015869
Epoch: 45, Steps: 64 | Train Loss: 0.0842321 Vali Loss: 0.1461143 Test Loss: 0.1386986
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 46 cost time: 0.9060912132263184
Epoch: 46, Steps: 64 | Train Loss: 0.0845322 Vali Loss: 0.1454575 Test Loss: 0.1392211
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 47 cost time: 0.8889050483703613
Epoch: 47, Steps: 64 | Train Loss: 0.0838087 Vali Loss: 0.1443964 Test Loss: 0.1391381
Validation loss decreased (0.144480 --> 0.144396).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 48 cost time: 0.8598489761352539
Epoch: 48, Steps: 64 | Train Loss: 0.0840374 Vali Loss: 0.1457011 Test Loss: 0.1392998
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 49 cost time: 0.8600006103515625
Epoch: 49, Steps: 64 | Train Loss: 0.0838329 Vali Loss: 0.1445320 Test Loss: 0.1391726
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 50 cost time: 0.8536767959594727
Epoch: 50, Steps: 64 | Train Loss: 0.0845608 Vali Loss: 0.1441035 Test Loss: 0.1386101
Validation loss decreased (0.144396 --> 0.144104).  Saving model ...
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 51 cost time: 0.869901180267334
Epoch: 51, Steps: 64 | Train Loss: 0.0840145 Vali Loss: 0.1445424 Test Loss: 0.1389535
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 52 cost time: 0.891416072845459
Epoch: 52, Steps: 64 | Train Loss: 0.0841146 Vali Loss: 0.1447910 Test Loss: 0.1393983
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 53 cost time: 0.9094529151916504
Epoch: 53, Steps: 64 | Train Loss: 0.0839931 Vali Loss: 0.1461123 Test Loss: 0.1386088
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 54 cost time: 0.9025170803070068
Epoch: 54, Steps: 64 | Train Loss: 0.0838283 Vali Loss: 0.1434651 Test Loss: 0.1383808
Validation loss decreased (0.144104 --> 0.143465).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 55 cost time: 0.9060003757476807
Epoch: 55, Steps: 64 | Train Loss: 0.0843863 Vali Loss: 0.1459911 Test Loss: 0.1395332
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 56 cost time: 0.9076499938964844
Epoch: 56, Steps: 64 | Train Loss: 0.0837613 Vali Loss: 0.1443799 Test Loss: 0.1388731
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 57 cost time: 0.8856446743011475
Epoch: 57, Steps: 64 | Train Loss: 0.0837329 Vali Loss: 0.1451481 Test Loss: 0.1388010
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 58 cost time: 0.8853960037231445
Epoch: 58, Steps: 64 | Train Loss: 0.0841775 Vali Loss: 0.1449656 Test Loss: 0.1389422
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 59 cost time: 0.8853909969329834
Epoch: 59, Steps: 64 | Train Loss: 0.0838449 Vali Loss: 0.1446073 Test Loss: 0.1384654
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.01874542236328125 GB
GPU已分配内存的峰值：0.0668954849243164 GB
Epoch: 60 cost time: 0.8918712139129639
Epoch: 60, Steps: 64 | Train Loss: 0.0837230 Vali Loss: 0.1446117 Test Loss: 0.1381214
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1383807361125946, mae:0.2716887593269348, rse:0.1979970782995224
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.07027053833007812 GB
Epoch: 1 cost time: 2.3525171279907227
Epoch: 1, Steps: 64 | Train Loss: 0.8069427 Vali Loss: 1.8167042 Test Loss: 3.4613590
Validation loss decreased (inf --> 1.816704).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 2 cost time: 0.9504368305206299
Epoch: 2, Steps: 64 | Train Loss: 0.3444291 Vali Loss: 0.1880080 Test Loss: 0.1706674
Validation loss decreased (1.816704 --> 0.188008).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 3 cost time: 0.9498918056488037
Epoch: 3, Steps: 64 | Train Loss: 0.1011891 Vali Loss: 0.1795770 Test Loss: 0.1536371
Validation loss decreased (0.188008 --> 0.179577).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 4 cost time: 0.9327642917633057
Epoch: 4, Steps: 64 | Train Loss: 0.0920306 Vali Loss: 0.1634684 Test Loss: 0.1387473
Validation loss decreased (0.179577 --> 0.163468).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 5 cost time: 0.8980007171630859
Epoch: 5, Steps: 64 | Train Loss: 0.0874787 Vali Loss: 0.1563407 Test Loss: 0.1371714
Validation loss decreased (0.163468 --> 0.156341).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 6 cost time: 0.9050731658935547
Epoch: 6, Steps: 64 | Train Loss: 0.0854486 Vali Loss: 0.1526738 Test Loss: 0.1368745
Validation loss decreased (0.156341 --> 0.152674).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 7 cost time: 0.9046168327331543
Epoch: 7, Steps: 64 | Train Loss: 0.0837000 Vali Loss: 0.1520935 Test Loss: 0.1356894
Validation loss decreased (0.152674 --> 0.152093).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 8 cost time: 0.9053418636322021
Epoch: 8, Steps: 64 | Train Loss: 0.0826556 Vali Loss: 0.1495920 Test Loss: 0.1367361
Validation loss decreased (0.152093 --> 0.149592).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 9 cost time: 0.9306225776672363
Epoch: 9, Steps: 64 | Train Loss: 0.0815148 Vali Loss: 0.1475300 Test Loss: 0.1342562
Validation loss decreased (0.149592 --> 0.147530).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 10 cost time: 0.9523622989654541
Epoch: 10, Steps: 64 | Train Loss: 0.0803914 Vali Loss: 0.1455105 Test Loss: 0.1343113
Validation loss decreased (0.147530 --> 0.145510).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 11 cost time: 0.9333930015563965
Epoch: 11, Steps: 64 | Train Loss: 0.0798471 Vali Loss: 0.1423274 Test Loss: 0.1356242
Validation loss decreased (0.145510 --> 0.142327).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 12 cost time: 0.9581069946289062
Epoch: 12, Steps: 64 | Train Loss: 0.0794851 Vali Loss: 0.1450008 Test Loss: 0.1345021
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 13 cost time: 0.937171459197998
Epoch: 13, Steps: 64 | Train Loss: 0.0786365 Vali Loss: 0.1420328 Test Loss: 0.1338838
Validation loss decreased (0.142327 --> 0.142033).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 14 cost time: 0.9229998588562012
Epoch: 14, Steps: 64 | Train Loss: 0.0778508 Vali Loss: 0.1415971 Test Loss: 0.1330684
Validation loss decreased (0.142033 --> 0.141597).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 15 cost time: 0.9296162128448486
Epoch: 15, Steps: 64 | Train Loss: 0.0772899 Vali Loss: 0.1403569 Test Loss: 0.1333430
Validation loss decreased (0.141597 --> 0.140357).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 16 cost time: 0.9296436309814453
Epoch: 16, Steps: 64 | Train Loss: 0.0770364 Vali Loss: 0.1409167 Test Loss: 0.1345549
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 17 cost time: 0.9112141132354736
Epoch: 17, Steps: 64 | Train Loss: 0.0765266 Vali Loss: 0.1397629 Test Loss: 0.1340884
Validation loss decreased (0.140357 --> 0.139763).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 18 cost time: 0.8964247703552246
Epoch: 18, Steps: 64 | Train Loss: 0.0763210 Vali Loss: 0.1391571 Test Loss: 0.1328791
Validation loss decreased (0.139763 --> 0.139157).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 19 cost time: 0.9464690685272217
Epoch: 19, Steps: 64 | Train Loss: 0.0761611 Vali Loss: 0.1370776 Test Loss: 0.1336870
Validation loss decreased (0.139157 --> 0.137078).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 20 cost time: 0.94138503074646
Epoch: 20, Steps: 64 | Train Loss: 0.0759666 Vali Loss: 0.1387041 Test Loss: 0.1337900
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 21 cost time: 0.9318447113037109
Epoch: 21, Steps: 64 | Train Loss: 0.0754786 Vali Loss: 0.1402218 Test Loss: 0.1333913
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 22 cost time: 0.9240002632141113
Epoch: 22, Steps: 64 | Train Loss: 0.0750645 Vali Loss: 0.1386476 Test Loss: 0.1326556
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 23 cost time: 0.9079999923706055
Epoch: 23, Steps: 64 | Train Loss: 0.0750450 Vali Loss: 0.1378145 Test Loss: 0.1329637
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 24 cost time: 0.9066464900970459
Epoch: 24, Steps: 64 | Train Loss: 0.0748781 Vali Loss: 0.1355494 Test Loss: 0.1324127
Validation loss decreased (0.137078 --> 0.135549).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 25 cost time: 0.9201903343200684
Epoch: 25, Steps: 64 | Train Loss: 0.0749668 Vali Loss: 0.1383206 Test Loss: 0.1329175
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 26 cost time: 0.9353537559509277
Epoch: 26, Steps: 64 | Train Loss: 0.0746654 Vali Loss: 0.1386740 Test Loss: 0.1329109
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 27 cost time: 0.9262344837188721
Epoch: 27, Steps: 64 | Train Loss: 0.0742834 Vali Loss: 0.1372499 Test Loss: 0.1327100
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 28 cost time: 0.9494192600250244
Epoch: 28, Steps: 64 | Train Loss: 0.0745455 Vali Loss: 0.1371206 Test Loss: 0.1322276
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 29 cost time: 0.9457783699035645
Epoch: 29, Steps: 64 | Train Loss: 0.0745724 Vali Loss: 0.1371929 Test Loss: 0.1323477
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 30 cost time: 0.9448275566101074
Epoch: 30, Steps: 64 | Train Loss: 0.0740975 Vali Loss: 0.1362764 Test Loss: 0.1325859
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 31 cost time: 0.9310026168823242
Epoch: 31, Steps: 64 | Train Loss: 0.0745468 Vali Loss: 0.1379872 Test Loss: 0.1325416
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 32 cost time: 0.9086203575134277
Epoch: 32, Steps: 64 | Train Loss: 0.0742410 Vali Loss: 0.1372389 Test Loss: 0.1326337
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 33 cost time: 0.9226391315460205
Epoch: 33, Steps: 64 | Train Loss: 0.0739109 Vali Loss: 0.1382424 Test Loss: 0.1330009
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 34 cost time: 0.9574477672576904
Epoch: 34, Steps: 64 | Train Loss: 0.0739593 Vali Loss: 0.1373283 Test Loss: 0.1326455
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 35 cost time: 0.960371732711792
Epoch: 35, Steps: 64 | Train Loss: 0.0738412 Vali Loss: 0.1383341 Test Loss: 0.1323200
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 36 cost time: 0.9575426578521729
Epoch: 36, Steps: 64 | Train Loss: 0.0738874 Vali Loss: 0.1380755 Test Loss: 0.1331817
EarlyStopping counter: 12 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 37 cost time: 0.9544196128845215
Epoch: 37, Steps: 64 | Train Loss: 0.0737691 Vali Loss: 0.1379914 Test Loss: 0.1327341
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 38 cost time: 0.9351658821105957
Epoch: 38, Steps: 64 | Train Loss: 0.0738880 Vali Loss: 0.1358731 Test Loss: 0.1326887
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 39 cost time: 0.928800106048584
Epoch: 39, Steps: 64 | Train Loss: 0.0734754 Vali Loss: 0.1372967 Test Loss: 0.1326640
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 40 cost time: 0.931002140045166
Epoch: 40, Steps: 64 | Train Loss: 0.0738318 Vali Loss: 0.1379087 Test Loss: 0.1323418
EarlyStopping counter: 16 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 41 cost time: 0.9426364898681641
Epoch: 41, Steps: 64 | Train Loss: 0.0736229 Vali Loss: 0.1356955 Test Loss: 0.1319891
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 42 cost time: 0.9537887573242188
Epoch: 42, Steps: 64 | Train Loss: 0.0740024 Vali Loss: 0.1371476 Test Loss: 0.1321566
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 43 cost time: 0.95639967918396
Epoch: 43, Steps: 64 | Train Loss: 0.0734113 Vali Loss: 0.1374782 Test Loss: 0.1321689
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 44 cost time: 0.9373822212219238
Epoch: 44, Steps: 64 | Train Loss: 0.0737110 Vali Loss: 0.1372600 Test Loss: 0.1325697
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 45 cost time: 0.929368257522583
Epoch: 45, Steps: 64 | Train Loss: 0.0737769 Vali Loss: 0.1372977 Test Loss: 0.1323768
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 46 cost time: 0.9175026416778564
Epoch: 46, Steps: 64 | Train Loss: 0.0736759 Vali Loss: 0.1362966 Test Loss: 0.1317097
EarlyStopping counter: 22 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 47 cost time: 0.9190378189086914
Epoch: 47, Steps: 64 | Train Loss: 0.0734587 Vali Loss: 0.1383368 Test Loss: 0.1327241
EarlyStopping counter: 23 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 48 cost time: 0.9179997444152832
Epoch: 48, Steps: 64 | Train Loss: 0.0735015 Vali Loss: 0.1357705 Test Loss: 0.1325810
EarlyStopping counter: 24 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 49 cost time: 0.9129996299743652
Epoch: 49, Steps: 64 | Train Loss: 0.0736116 Vali Loss: 0.1362592 Test Loss: 0.1322657
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 50 cost time: 0.9376533031463623
Epoch: 50, Steps: 64 | Train Loss: 0.0738649 Vali Loss: 0.1358186 Test Loss: 0.1325408
EarlyStopping counter: 26 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 51 cost time: 0.933424711227417
Epoch: 51, Steps: 64 | Train Loss: 0.0733345 Vali Loss: 0.1363560 Test Loss: 0.1319398
EarlyStopping counter: 27 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 52 cost time: 0.935438871383667
Epoch: 52, Steps: 64 | Train Loss: 0.0734300 Vali Loss: 0.1378708 Test Loss: 0.1330684
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 53 cost time: 0.9294648170471191
Epoch: 53, Steps: 64 | Train Loss: 0.0736912 Vali Loss: 0.1362272 Test Loss: 0.1325803
EarlyStopping counter: 29 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 54 cost time: 0.9213838577270508
Epoch: 54, Steps: 64 | Train Loss: 0.0734808 Vali Loss: 0.1361773 Test Loss: 0.1316386
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 55 cost time: 0.9274368286132812
Epoch: 55, Steps: 64 | Train Loss: 0.0735810 Vali Loss: 0.1356901 Test Loss: 0.1325259
EarlyStopping counter: 31 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 56 cost time: 0.9337577819824219
Epoch: 56, Steps: 64 | Train Loss: 0.0738179 Vali Loss: 0.1376908 Test Loss: 0.1320134
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 57 cost time: 0.9390017986297607
Epoch: 57, Steps: 64 | Train Loss: 0.0733273 Vali Loss: 0.1361780 Test Loss: 0.1331299
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 58 cost time: 0.9466700553894043
Epoch: 58, Steps: 64 | Train Loss: 0.0736533 Vali Loss: 0.1372848 Test Loss: 0.1322196
EarlyStopping counter: 34 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 59 cost time: 0.952653169631958
Epoch: 59, Steps: 64 | Train Loss: 0.0736024 Vali Loss: 0.1381475 Test Loss: 0.1326768
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02045440673828125 GB
GPU已分配内存的峰值：0.0712900161743164 GB
Epoch: 60 cost time: 0.9534127712249756
Epoch: 60, Steps: 64 | Train Loss: 0.0730076 Vali Loss: 0.1368211 Test Loss: 0.1318595
EarlyStopping counter: 36 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13241276144981384, mae:0.2621213495731354, rse:0.19368049502372742
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=4, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07338619232177734 GB
Epoch: 1 cost time: 2.359093427658081
Epoch: 1, Steps: 64 | Train Loss: 0.7479925 Vali Loss: 1.7259823 Test Loss: 3.2601166
Validation loss decreased (inf --> 1.725982).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 2 cost time: 0.9606363773345947
Epoch: 2, Steps: 64 | Train Loss: 0.2865457 Vali Loss: 0.2273225 Test Loss: 0.2763513
Validation loss decreased (1.725982 --> 0.227322).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 3 cost time: 0.9561862945556641
Epoch: 3, Steps: 64 | Train Loss: 0.0968327 Vali Loss: 0.1672536 Test Loss: 0.1386007
Validation loss decreased (0.227322 --> 0.167254).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 4 cost time: 0.9600052833557129
Epoch: 4, Steps: 64 | Train Loss: 0.0878735 Vali Loss: 0.1586990 Test Loss: 0.1389098
Validation loss decreased (0.167254 --> 0.158699).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 5 cost time: 0.9444127082824707
Epoch: 5, Steps: 64 | Train Loss: 0.0847415 Vali Loss: 0.1583990 Test Loss: 0.1376547
Validation loss decreased (0.158699 --> 0.158399).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 6 cost time: 0.9724619388580322
Epoch: 6, Steps: 64 | Train Loss: 0.0828902 Vali Loss: 0.1574425 Test Loss: 0.1395854
Validation loss decreased (0.158399 --> 0.157443).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 7 cost time: 0.9540865421295166
Epoch: 7, Steps: 64 | Train Loss: 0.0812377 Vali Loss: 0.1531217 Test Loss: 0.1367552
Validation loss decreased (0.157443 --> 0.153122).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 8 cost time: 0.926727294921875
Epoch: 8, Steps: 64 | Train Loss: 0.0799390 Vali Loss: 0.1518172 Test Loss: 0.1374848
Validation loss decreased (0.153122 --> 0.151817).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 9 cost time: 0.966392993927002
Epoch: 9, Steps: 64 | Train Loss: 0.0796100 Vali Loss: 0.1475764 Test Loss: 0.1373916
Validation loss decreased (0.151817 --> 0.147576).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 10 cost time: 0.9792702198028564
Epoch: 10, Steps: 64 | Train Loss: 0.0786175 Vali Loss: 0.1485720 Test Loss: 0.1361219
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 11 cost time: 0.9634618759155273
Epoch: 11, Steps: 64 | Train Loss: 0.0779870 Vali Loss: 0.1461537 Test Loss: 0.1365585
Validation loss decreased (0.147576 --> 0.146154).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 12 cost time: 0.979001522064209
Epoch: 12, Steps: 64 | Train Loss: 0.0771826 Vali Loss: 0.1442095 Test Loss: 0.1356065
Validation loss decreased (0.146154 --> 0.144210).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 13 cost time: 0.9625985622406006
Epoch: 13, Steps: 64 | Train Loss: 0.0763655 Vali Loss: 0.1443395 Test Loss: 0.1360293
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 14 cost time: 0.9596292972564697
Epoch: 14, Steps: 64 | Train Loss: 0.0759951 Vali Loss: 0.1417897 Test Loss: 0.1363892
Validation loss decreased (0.144210 --> 0.141790).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 15 cost time: 0.9627230167388916
Epoch: 15, Steps: 64 | Train Loss: 0.0755864 Vali Loss: 0.1406768 Test Loss: 0.1363058
Validation loss decreased (0.141790 --> 0.140677).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 16 cost time: 0.9633841514587402
Epoch: 16, Steps: 64 | Train Loss: 0.0751647 Vali Loss: 0.1404660 Test Loss: 0.1358792
Validation loss decreased (0.140677 --> 0.140466).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 17 cost time: 0.9834153652191162
Epoch: 17, Steps: 64 | Train Loss: 0.0748147 Vali Loss: 0.1386937 Test Loss: 0.1370379
Validation loss decreased (0.140466 --> 0.138694).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 18 cost time: 0.9864075183868408
Epoch: 18, Steps: 64 | Train Loss: 0.0746776 Vali Loss: 0.1383135 Test Loss: 0.1362046
Validation loss decreased (0.138694 --> 0.138313).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 19 cost time: 0.985008716583252
Epoch: 19, Steps: 64 | Train Loss: 0.0746504 Vali Loss: 0.1380570 Test Loss: 0.1363441
Validation loss decreased (0.138313 --> 0.138057).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 20 cost time: 0.9753720760345459
Epoch: 20, Steps: 64 | Train Loss: 0.0738478 Vali Loss: 0.1394735 Test Loss: 0.1366842
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 21 cost time: 0.9623861312866211
Epoch: 21, Steps: 64 | Train Loss: 0.0738186 Vali Loss: 0.1387305 Test Loss: 0.1362793
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 22 cost time: 0.9373781681060791
Epoch: 22, Steps: 64 | Train Loss: 0.0734504 Vali Loss: 0.1371905 Test Loss: 0.1354106
Validation loss decreased (0.138057 --> 0.137190).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 23 cost time: 0.9504354000091553
Epoch: 23, Steps: 64 | Train Loss: 0.0735066 Vali Loss: 0.1385413 Test Loss: 0.1359259
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 24 cost time: 0.9493460655212402
Epoch: 24, Steps: 64 | Train Loss: 0.0731526 Vali Loss: 0.1378775 Test Loss: 0.1356480
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 25 cost time: 0.9540011882781982
Epoch: 25, Steps: 64 | Train Loss: 0.0728754 Vali Loss: 0.1350235 Test Loss: 0.1348106
Validation loss decreased (0.137190 --> 0.135024).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 26 cost time: 0.9556529521942139
Epoch: 26, Steps: 64 | Train Loss: 0.0726208 Vali Loss: 0.1382762 Test Loss: 0.1357528
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 27 cost time: 0.9490323066711426
Epoch: 27, Steps: 64 | Train Loss: 0.0730988 Vali Loss: 0.1372066 Test Loss: 0.1359559
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 28 cost time: 0.9364006519317627
Epoch: 28, Steps: 64 | Train Loss: 0.0725021 Vali Loss: 0.1378208 Test Loss: 0.1355064
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 29 cost time: 0.9233677387237549
Epoch: 29, Steps: 64 | Train Loss: 0.0725909 Vali Loss: 0.1378374 Test Loss: 0.1354802
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 30 cost time: 0.9314663410186768
Epoch: 30, Steps: 64 | Train Loss: 0.0723052 Vali Loss: 0.1364057 Test Loss: 0.1358867
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 31 cost time: 0.9474763870239258
Epoch: 31, Steps: 64 | Train Loss: 0.0724878 Vali Loss: 0.1369094 Test Loss: 0.1347523
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 32 cost time: 0.9700496196746826
Epoch: 32, Steps: 64 | Train Loss: 0.0722925 Vali Loss: 0.1367341 Test Loss: 0.1358728
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 33 cost time: 0.990750789642334
Epoch: 33, Steps: 64 | Train Loss: 0.0720134 Vali Loss: 0.1377057 Test Loss: 0.1362957
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 34 cost time: 0.9877479076385498
Epoch: 34, Steps: 64 | Train Loss: 0.0719557 Vali Loss: 0.1377218 Test Loss: 0.1359228
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 35 cost time: 0.9809999465942383
Epoch: 35, Steps: 64 | Train Loss: 0.0724132 Vali Loss: 0.1394715 Test Loss: 0.1368202
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 36 cost time: 0.9806418418884277
Epoch: 36, Steps: 64 | Train Loss: 0.0721079 Vali Loss: 0.1362580 Test Loss: 0.1342821
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 37 cost time: 0.9596366882324219
Epoch: 37, Steps: 64 | Train Loss: 0.0720285 Vali Loss: 0.1358839 Test Loss: 0.1351521
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 38 cost time: 0.9586541652679443
Epoch: 38, Steps: 64 | Train Loss: 0.0720814 Vali Loss: 0.1369830 Test Loss: 0.1352338
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 39 cost time: 0.9603631496429443
Epoch: 39, Steps: 64 | Train Loss: 0.0722166 Vali Loss: 0.1372744 Test Loss: 0.1354080
EarlyStopping counter: 14 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 40 cost time: 0.9766643047332764
Epoch: 40, Steps: 64 | Train Loss: 0.0721003 Vali Loss: 0.1365476 Test Loss: 0.1354339
EarlyStopping counter: 15 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 41 cost time: 0.9753677845001221
Epoch: 41, Steps: 64 | Train Loss: 0.0717990 Vali Loss: 0.1379034 Test Loss: 0.1357993
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 42 cost time: 0.9804329872131348
Epoch: 42, Steps: 64 | Train Loss: 0.0717709 Vali Loss: 0.1369540 Test Loss: 0.1355055
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 43 cost time: 0.9674153327941895
Epoch: 43, Steps: 64 | Train Loss: 0.0716786 Vali Loss: 0.1379350 Test Loss: 0.1348727
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 44 cost time: 0.9370107650756836
Epoch: 44, Steps: 64 | Train Loss: 0.0717004 Vali Loss: 0.1369206 Test Loss: 0.1356775
EarlyStopping counter: 19 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 45 cost time: 0.932218074798584
Epoch: 45, Steps: 64 | Train Loss: 0.0714993 Vali Loss: 0.1370390 Test Loss: 0.1356279
EarlyStopping counter: 20 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 46 cost time: 0.9529993534088135
Epoch: 46, Steps: 64 | Train Loss: 0.0717639 Vali Loss: 0.1368420 Test Loss: 0.1349455
EarlyStopping counter: 21 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 47 cost time: 0.9489996433258057
Epoch: 47, Steps: 64 | Train Loss: 0.0718520 Vali Loss: 0.1370244 Test Loss: 0.1361846
EarlyStopping counter: 22 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 48 cost time: 0.9652791023254395
Epoch: 48, Steps: 64 | Train Loss: 0.0715079 Vali Loss: 0.1369625 Test Loss: 0.1359510
EarlyStopping counter: 23 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 49 cost time: 0.9596452713012695
Epoch: 49, Steps: 64 | Train Loss: 0.0715657 Vali Loss: 0.1371671 Test Loss: 0.1357024
EarlyStopping counter: 24 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 50 cost time: 0.9624323844909668
Epoch: 50, Steps: 64 | Train Loss: 0.0717705 Vali Loss: 0.1366469 Test Loss: 0.1360540
EarlyStopping counter: 25 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 51 cost time: 0.9701030254364014
Epoch: 51, Steps: 64 | Train Loss: 0.0716679 Vali Loss: 0.1365178 Test Loss: 0.1353054
EarlyStopping counter: 26 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 52 cost time: 0.941382646560669
Epoch: 52, Steps: 64 | Train Loss: 0.0719717 Vali Loss: 0.1384377 Test Loss: 0.1350526
EarlyStopping counter: 27 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 53 cost time: 0.9554944038391113
Epoch: 53, Steps: 64 | Train Loss: 0.0718747 Vali Loss: 0.1368163 Test Loss: 0.1352205
EarlyStopping counter: 28 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 54 cost time: 0.9584746360778809
Epoch: 54, Steps: 64 | Train Loss: 0.0717576 Vali Loss: 0.1373860 Test Loss: 0.1351169
EarlyStopping counter: 29 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 55 cost time: 0.9594614505767822
Epoch: 55, Steps: 64 | Train Loss: 0.0714128 Vali Loss: 0.1368530 Test Loss: 0.1353352
EarlyStopping counter: 30 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 56 cost time: 0.9711349010467529
Epoch: 56, Steps: 64 | Train Loss: 0.0720518 Vali Loss: 0.1354991 Test Loss: 0.1363003
EarlyStopping counter: 31 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 57 cost time: 0.9807381629943848
Epoch: 57, Steps: 64 | Train Loss: 0.0717845 Vali Loss: 0.1374726 Test Loss: 0.1357163
EarlyStopping counter: 32 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 58 cost time: 0.9870007038116455
Epoch: 58, Steps: 64 | Train Loss: 0.0714252 Vali Loss: 0.1363787 Test Loss: 0.1357043
EarlyStopping counter: 33 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 59 cost time: 0.982001781463623
Epoch: 59, Steps: 64 | Train Loss: 0.0715839 Vali Loss: 0.1376670 Test Loss: 0.1355411
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0214385986328125 GB
GPU已分配内存的峰值：0.07642364501953125 GB
Epoch: 60 cost time: 0.9662618637084961
Epoch: 60, Steps: 64 | Train Loss: 0.0715278 Vali Loss: 0.1375070 Test Loss: 0.1351925
EarlyStopping counter: 35 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_4_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13481062650680542, mae:0.2680567502975464, rse:0.1954263150691986
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=1, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 1028
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.06616020202636719 GB
Epoch: 1 cost time: 2.2924790382385254
Epoch: 1, Steps: 64 | Train Loss: 0.8963743 Vali Loss: 1.9827416 Test Loss: 3.7450228
Validation loss decreased (inf --> 1.982742).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 2 cost time: 0.9266209602355957
Epoch: 2, Steps: 64 | Train Loss: 0.5843324 Vali Loss: 0.7905287 Test Loss: 1.3114412
Validation loss decreased (1.982742 --> 0.790529).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 3 cost time: 0.8993363380432129
Epoch: 3, Steps: 64 | Train Loss: 0.2951758 Vali Loss: 0.4347770 Test Loss: 0.6021773
Validation loss decreased (0.790529 --> 0.434777).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 4 cost time: 0.9011399745941162
Epoch: 4, Steps: 64 | Train Loss: 0.1830342 Vali Loss: 0.3010517 Test Loss: 0.3550946
Validation loss decreased (0.434777 --> 0.301052).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 5 cost time: 0.8823652267456055
Epoch: 5, Steps: 64 | Train Loss: 0.1356878 Vali Loss: 0.2313890 Test Loss: 0.2419391
Validation loss decreased (0.301052 --> 0.231389).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 6 cost time: 0.8803739547729492
Epoch: 6, Steps: 64 | Train Loss: 0.1157250 Vali Loss: 0.2009488 Test Loss: 0.1950507
Validation loss decreased (0.231389 --> 0.200949).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 7 cost time: 0.8717737197875977
Epoch: 7, Steps: 64 | Train Loss: 0.1061240 Vali Loss: 0.1833680 Test Loss: 0.1681689
Validation loss decreased (0.200949 --> 0.183368).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 8 cost time: 0.875999927520752
Epoch: 8, Steps: 64 | Train Loss: 0.1005156 Vali Loss: 0.1738357 Test Loss: 0.1585960
Validation loss decreased (0.183368 --> 0.173836).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 9 cost time: 0.888383150100708
Epoch: 9, Steps: 64 | Train Loss: 0.0979752 Vali Loss: 0.1699860 Test Loss: 0.1520597
Validation loss decreased (0.173836 --> 0.169986).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 10 cost time: 0.8976564407348633
Epoch: 10, Steps: 64 | Train Loss: 0.0955708 Vali Loss: 0.1660413 Test Loss: 0.1489612
Validation loss decreased (0.169986 --> 0.166041).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 11 cost time: 0.8975026607513428
Epoch: 11, Steps: 64 | Train Loss: 0.0948340 Vali Loss: 0.1599954 Test Loss: 0.1461590
Validation loss decreased (0.166041 --> 0.159995).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 12 cost time: 0.9124019145965576
Epoch: 12, Steps: 64 | Train Loss: 0.0934943 Vali Loss: 0.1606680 Test Loss: 0.1449682
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 13 cost time: 0.9184920787811279
Epoch: 13, Steps: 64 | Train Loss: 0.0922796 Vali Loss: 0.1608993 Test Loss: 0.1440644
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 14 cost time: 0.8934061527252197
Epoch: 14, Steps: 64 | Train Loss: 0.0915532 Vali Loss: 0.1573194 Test Loss: 0.1437732
Validation loss decreased (0.159995 --> 0.157319).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 15 cost time: 0.8949995040893555
Epoch: 15, Steps: 64 | Train Loss: 0.0906105 Vali Loss: 0.1563903 Test Loss: 0.1426526
Validation loss decreased (0.157319 --> 0.156390).  Saving model ...
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 16 cost time: 0.8739993572235107
Epoch: 16, Steps: 64 | Train Loss: 0.0900242 Vali Loss: 0.1570391 Test Loss: 0.1415788
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 17 cost time: 0.8885493278503418
Epoch: 17, Steps: 64 | Train Loss: 0.0895433 Vali Loss: 0.1561154 Test Loss: 0.1416114
Validation loss decreased (0.156390 --> 0.156115).  Saving model ...
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 18 cost time: 0.906475305557251
Epoch: 18, Steps: 64 | Train Loss: 0.0893967 Vali Loss: 0.1548390 Test Loss: 0.1413792
Validation loss decreased (0.156115 --> 0.154839).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 19 cost time: 0.9143662452697754
Epoch: 19, Steps: 64 | Train Loss: 0.0884561 Vali Loss: 0.1557590 Test Loss: 0.1416728
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 20 cost time: 0.9193768501281738
Epoch: 20, Steps: 64 | Train Loss: 0.0879734 Vali Loss: 0.1547041 Test Loss: 0.1412300
Validation loss decreased (0.154839 --> 0.154704).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 21 cost time: 0.9127600193023682
Epoch: 21, Steps: 64 | Train Loss: 0.0878594 Vali Loss: 0.1533067 Test Loss: 0.1407829
Validation loss decreased (0.154704 --> 0.153307).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 22 cost time: 0.8910000324249268
Epoch: 22, Steps: 64 | Train Loss: 0.0875955 Vali Loss: 0.1519780 Test Loss: 0.1401507
Validation loss decreased (0.153307 --> 0.151978).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 23 cost time: 0.894237756729126
Epoch: 23, Steps: 64 | Train Loss: 0.0871015 Vali Loss: 0.1514606 Test Loss: 0.1404145
Validation loss decreased (0.151978 --> 0.151461).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 24 cost time: 0.8776345252990723
Epoch: 24, Steps: 64 | Train Loss: 0.0872517 Vali Loss: 0.1511805 Test Loss: 0.1400750
Validation loss decreased (0.151461 --> 0.151181).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 25 cost time: 0.8805015087127686
Epoch: 25, Steps: 64 | Train Loss: 0.0868482 Vali Loss: 0.1513691 Test Loss: 0.1401102
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 26 cost time: 0.8864195346832275
Epoch: 26, Steps: 64 | Train Loss: 0.0866125 Vali Loss: 0.1533693 Test Loss: 0.1399862
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 27 cost time: 0.9023706912994385
Epoch: 27, Steps: 64 | Train Loss: 0.0864809 Vali Loss: 0.1507317 Test Loss: 0.1398534
Validation loss decreased (0.151181 --> 0.150732).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 28 cost time: 0.9007525444030762
Epoch: 28, Steps: 64 | Train Loss: 0.0863741 Vali Loss: 0.1526507 Test Loss: 0.1401212
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 29 cost time: 0.9010000228881836
Epoch: 29, Steps: 64 | Train Loss: 0.0860581 Vali Loss: 0.1521867 Test Loss: 0.1398315
EarlyStopping counter: 2 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 30 cost time: 0.8936333656311035
Epoch: 30, Steps: 64 | Train Loss: 0.0862766 Vali Loss: 0.1512601 Test Loss: 0.1397226
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 31 cost time: 0.8777248859405518
Epoch: 31, Steps: 64 | Train Loss: 0.0861732 Vali Loss: 0.1499132 Test Loss: 0.1395428
Validation loss decreased (0.150732 --> 0.149913).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 32 cost time: 0.8684723377227783
Epoch: 32, Steps: 64 | Train Loss: 0.0860985 Vali Loss: 0.1514249 Test Loss: 0.1400551
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 33 cost time: 0.8733987808227539
Epoch: 33, Steps: 64 | Train Loss: 0.0856142 Vali Loss: 0.1501762 Test Loss: 0.1399636
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 34 cost time: 0.897381067276001
Epoch: 34, Steps: 64 | Train Loss: 0.0857925 Vali Loss: 0.1502422 Test Loss: 0.1393374
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 35 cost time: 0.9160008430480957
Epoch: 35, Steps: 64 | Train Loss: 0.0855094 Vali Loss: 0.1495244 Test Loss: 0.1390784
Validation loss decreased (0.149913 --> 0.149524).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 36 cost time: 0.9180195331573486
Epoch: 36, Steps: 64 | Train Loss: 0.0853190 Vali Loss: 0.1510903 Test Loss: 0.1396073
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 37 cost time: 0.9186255931854248
Epoch: 37, Steps: 64 | Train Loss: 0.0855150 Vali Loss: 0.1496226 Test Loss: 0.1393146
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 38 cost time: 0.9210126399993896
Epoch: 38, Steps: 64 | Train Loss: 0.0852106 Vali Loss: 0.1524114 Test Loss: 0.1394242
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 39 cost time: 0.8944246768951416
Epoch: 39, Steps: 64 | Train Loss: 0.0855012 Vali Loss: 0.1497341 Test Loss: 0.1396857
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 40 cost time: 0.889446496963501
Epoch: 40, Steps: 64 | Train Loss: 0.0851006 Vali Loss: 0.1506732 Test Loss: 0.1389611
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 41 cost time: 0.9008162021636963
Epoch: 41, Steps: 64 | Train Loss: 0.0851110 Vali Loss: 0.1515187 Test Loss: 0.1398112
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 42 cost time: 0.8870007991790771
Epoch: 42, Steps: 64 | Train Loss: 0.0851148 Vali Loss: 0.1502724 Test Loss: 0.1389590
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 43 cost time: 0.9056413173675537
Epoch: 43, Steps: 64 | Train Loss: 0.0847101 Vali Loss: 0.1502305 Test Loss: 0.1392126
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 44 cost time: 0.9185864925384521
Epoch: 44, Steps: 64 | Train Loss: 0.0846212 Vali Loss: 0.1484718 Test Loss: 0.1392050
Validation loss decreased (0.149524 --> 0.148472).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 45 cost time: 0.9004576206207275
Epoch: 45, Steps: 64 | Train Loss: 0.0852601 Vali Loss: 0.1497611 Test Loss: 0.1398938
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 46 cost time: 0.891629695892334
Epoch: 46, Steps: 64 | Train Loss: 0.0851000 Vali Loss: 0.1516305 Test Loss: 0.1391022
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 47 cost time: 0.8934013843536377
Epoch: 47, Steps: 64 | Train Loss: 0.0850439 Vali Loss: 0.1502684 Test Loss: 0.1390463
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 48 cost time: 0.8907337188720703
Epoch: 48, Steps: 64 | Train Loss: 0.0850688 Vali Loss: 0.1484610 Test Loss: 0.1391223
Validation loss decreased (0.148472 --> 0.148461).  Saving model ...
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 49 cost time: 0.8884365558624268
Epoch: 49, Steps: 64 | Train Loss: 0.0847567 Vali Loss: 0.1488821 Test Loss: 0.1391183
EarlyStopping counter: 1 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 50 cost time: 0.8766412734985352
Epoch: 50, Steps: 64 | Train Loss: 0.0848382 Vali Loss: 0.1513004 Test Loss: 0.1393222
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 51 cost time: 0.8793978691101074
Epoch: 51, Steps: 64 | Train Loss: 0.0847980 Vali Loss: 0.1479156 Test Loss: 0.1391724
Validation loss decreased (0.148461 --> 0.147916).  Saving model ...
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 52 cost time: 0.9054114818572998
Epoch: 52, Steps: 64 | Train Loss: 0.0851729 Vali Loss: 0.1500404 Test Loss: 0.1396188
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 53 cost time: 0.8953626155853271
Epoch: 53, Steps: 64 | Train Loss: 0.0850895 Vali Loss: 0.1514088 Test Loss: 0.1391015
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 54 cost time: 0.8994252681732178
Epoch: 54, Steps: 64 | Train Loss: 0.0846257 Vali Loss: 0.1504060 Test Loss: 0.1391333
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 55 cost time: 0.9079997539520264
Epoch: 55, Steps: 64 | Train Loss: 0.0849984 Vali Loss: 0.1501592 Test Loss: 0.1389607
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 56 cost time: 0.8830001354217529
Epoch: 56, Steps: 64 | Train Loss: 0.0849720 Vali Loss: 0.1501639 Test Loss: 0.1392655
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 57 cost time: 0.8936381340026855
Epoch: 57, Steps: 64 | Train Loss: 0.0851437 Vali Loss: 0.1513219 Test Loss: 0.1389489
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 58 cost time: 0.8984243869781494
Epoch: 58, Steps: 64 | Train Loss: 0.0849456 Vali Loss: 0.1495723 Test Loss: 0.1391898
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 59 cost time: 0.8916211128234863
Epoch: 59, Steps: 64 | Train Loss: 0.0845525 Vali Loss: 0.1500107 Test Loss: 0.1387473
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0187530517578125 GB
GPU已分配内存的峰值：0.0670614242553711 GB
Epoch: 60 cost time: 0.8983504772186279
Epoch: 60, Steps: 64 | Train Loss: 0.0852424 Vali Loss: 0.1491282 Test Loss: 0.1393257
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_1_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13917236030101776, mae:0.2702788710594177, rse:0.1985626071691513
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=2, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 132100
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.07043266296386719 GB
Epoch: 1 cost time: 2.324183225631714
Epoch: 1, Steps: 64 | Train Loss: 0.7061702 Vali Loss: 1.5762892 Test Loss: 2.9679699
Validation loss decreased (inf --> 1.576289).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 2 cost time: 0.9483764171600342
Epoch: 2, Steps: 64 | Train Loss: 0.2782872 Vali Loss: 0.2014942 Test Loss: 0.2058951
Validation loss decreased (1.576289 --> 0.201494).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 3 cost time: 0.9324700832366943
Epoch: 3, Steps: 64 | Train Loss: 0.0992267 Vali Loss: 0.1660002 Test Loss: 0.1475912
Validation loss decreased (0.201494 --> 0.166000).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 4 cost time: 0.9418208599090576
Epoch: 4, Steps: 64 | Train Loss: 0.0909465 Vali Loss: 0.1600190 Test Loss: 0.1387148
Validation loss decreased (0.166000 --> 0.160019).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 5 cost time: 0.9279994964599609
Epoch: 5, Steps: 64 | Train Loss: 0.0878115 Vali Loss: 0.1570029 Test Loss: 0.1382869
Validation loss decreased (0.160019 --> 0.157003).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 6 cost time: 0.9404065608978271
Epoch: 6, Steps: 64 | Train Loss: 0.0857241 Vali Loss: 0.1533307 Test Loss: 0.1363628
Validation loss decreased (0.157003 --> 0.153331).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 7 cost time: 0.9506425857543945
Epoch: 7, Steps: 64 | Train Loss: 0.0838276 Vali Loss: 0.1526223 Test Loss: 0.1364507
Validation loss decreased (0.153331 --> 0.152622).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 8 cost time: 0.9306268692016602
Epoch: 8, Steps: 64 | Train Loss: 0.0831178 Vali Loss: 0.1515724 Test Loss: 0.1369016
Validation loss decreased (0.152622 --> 0.151572).  Saving model ...
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 9 cost time: 0.9373328685760498
Epoch: 9, Steps: 64 | Train Loss: 0.0822690 Vali Loss: 0.1496825 Test Loss: 0.1350876
Validation loss decreased (0.151572 --> 0.149682).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 10 cost time: 0.9360091686248779
Epoch: 10, Steps: 64 | Train Loss: 0.0810309 Vali Loss: 0.1490784 Test Loss: 0.1342937
Validation loss decreased (0.149682 --> 0.149078).  Saving model ...
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 11 cost time: 0.9413750171661377
Epoch: 11, Steps: 64 | Train Loss: 0.0804777 Vali Loss: 0.1486076 Test Loss: 0.1349514
Validation loss decreased (0.149078 --> 0.148608).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 12 cost time: 0.9593930244445801
Epoch: 12, Steps: 64 | Train Loss: 0.0799322 Vali Loss: 0.1483500 Test Loss: 0.1352922
Validation loss decreased (0.148608 --> 0.148350).  Saving model ...
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 13 cost time: 0.9304075241088867
Epoch: 13, Steps: 64 | Train Loss: 0.0795992 Vali Loss: 0.1452608 Test Loss: 0.1339856
Validation loss decreased (0.148350 --> 0.145261).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 14 cost time: 0.9365205764770508
Epoch: 14, Steps: 64 | Train Loss: 0.0788670 Vali Loss: 0.1433839 Test Loss: 0.1345136
Validation loss decreased (0.145261 --> 0.143384).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 15 cost time: 0.9357497692108154
Epoch: 15, Steps: 64 | Train Loss: 0.0782693 Vali Loss: 0.1437857 Test Loss: 0.1356072
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 16 cost time: 0.9329986572265625
Epoch: 16, Steps: 64 | Train Loss: 0.0780026 Vali Loss: 0.1430860 Test Loss: 0.1340552
Validation loss decreased (0.143384 --> 0.143086).  Saving model ...
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 17 cost time: 0.9566364288330078
Epoch: 17, Steps: 64 | Train Loss: 0.0779393 Vali Loss: 0.1438302 Test Loss: 0.1353216
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 18 cost time: 0.955639123916626
Epoch: 18, Steps: 64 | Train Loss: 0.0775542 Vali Loss: 0.1427934 Test Loss: 0.1346404
Validation loss decreased (0.143086 --> 0.142793).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 19 cost time: 0.945483922958374
Epoch: 19, Steps: 64 | Train Loss: 0.0766903 Vali Loss: 0.1429759 Test Loss: 0.1348208
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 20 cost time: 0.954352855682373
Epoch: 20, Steps: 64 | Train Loss: 0.0770583 Vali Loss: 0.1426505 Test Loss: 0.1343028
Validation loss decreased (0.142793 --> 0.142651).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 21 cost time: 0.9395134449005127
Epoch: 21, Steps: 64 | Train Loss: 0.0768090 Vali Loss: 0.1426471 Test Loss: 0.1340439
Validation loss decreased (0.142651 --> 0.142647).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 22 cost time: 0.9313786029815674
Epoch: 22, Steps: 64 | Train Loss: 0.0766246 Vali Loss: 0.1422039 Test Loss: 0.1334393
Validation loss decreased (0.142647 --> 0.142204).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 23 cost time: 0.9170138835906982
Epoch: 23, Steps: 64 | Train Loss: 0.0759055 Vali Loss: 0.1420513 Test Loss: 0.1340473
Validation loss decreased (0.142204 --> 0.142051).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 24 cost time: 0.9177684783935547
Epoch: 24, Steps: 64 | Train Loss: 0.0762848 Vali Loss: 0.1417348 Test Loss: 0.1349788
Validation loss decreased (0.142051 --> 0.141735).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 25 cost time: 0.9481093883514404
Epoch: 25, Steps: 64 | Train Loss: 0.0757093 Vali Loss: 0.1418486 Test Loss: 0.1342677
EarlyStopping counter: 1 out of 100
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 26 cost time: 0.9409999847412109
Epoch: 26, Steps: 64 | Train Loss: 0.0762428 Vali Loss: 0.1420660 Test Loss: 0.1343956
EarlyStopping counter: 2 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 27 cost time: 0.9336159229278564
Epoch: 27, Steps: 64 | Train Loss: 0.0757893 Vali Loss: 0.1408529 Test Loss: 0.1343569
Validation loss decreased (0.141735 --> 0.140853).  Saving model ...
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 28 cost time: 0.9443674087524414
Epoch: 28, Steps: 64 | Train Loss: 0.0753743 Vali Loss: 0.1405978 Test Loss: 0.1354748
Validation loss decreased (0.140853 --> 0.140598).  Saving model ...
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 29 cost time: 0.923468828201294
Epoch: 29, Steps: 64 | Train Loss: 0.0753589 Vali Loss: 0.1397920 Test Loss: 0.1341309
Validation loss decreased (0.140598 --> 0.139792).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 30 cost time: 0.9114174842834473
Epoch: 30, Steps: 64 | Train Loss: 0.0751565 Vali Loss: 0.1416797 Test Loss: 0.1334980
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 31 cost time: 0.907761812210083
Epoch: 31, Steps: 64 | Train Loss: 0.0749748 Vali Loss: 0.1411605 Test Loss: 0.1335103
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 32 cost time: 0.9184157848358154
Epoch: 32, Steps: 64 | Train Loss: 0.0754283 Vali Loss: 0.1410970 Test Loss: 0.1340244
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 33 cost time: 0.9458239078521729
Epoch: 33, Steps: 64 | Train Loss: 0.0751003 Vali Loss: 0.1388250 Test Loss: 0.1345071
Validation loss decreased (0.139792 --> 0.138825).  Saving model ...
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 34 cost time: 0.9506430625915527
Epoch: 34, Steps: 64 | Train Loss: 0.0750039 Vali Loss: 0.1412251 Test Loss: 0.1337570
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 35 cost time: 0.9594120979309082
Epoch: 35, Steps: 64 | Train Loss: 0.0750449 Vali Loss: 0.1406634 Test Loss: 0.1336540
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 36 cost time: 0.9566419124603271
Epoch: 36, Steps: 64 | Train Loss: 0.0750378 Vali Loss: 0.1417672 Test Loss: 0.1335856
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 37 cost time: 0.9357771873474121
Epoch: 37, Steps: 64 | Train Loss: 0.0746527 Vali Loss: 0.1396480 Test Loss: 0.1337595
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 38 cost time: 0.9383909702301025
Epoch: 38, Steps: 64 | Train Loss: 0.0748487 Vali Loss: 0.1420849 Test Loss: 0.1344217
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 39 cost time: 0.9314055442810059
Epoch: 39, Steps: 64 | Train Loss: 0.0751106 Vali Loss: 0.1397545 Test Loss: 0.1340218
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 40 cost time: 0.9294123649597168
Epoch: 40, Steps: 64 | Train Loss: 0.0748222 Vali Loss: 0.1386844 Test Loss: 0.1334351
Validation loss decreased (0.138825 --> 0.138684).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 41 cost time: 0.9503605365753174
Epoch: 41, Steps: 64 | Train Loss: 0.0747572 Vali Loss: 0.1414898 Test Loss: 0.1339101
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 42 cost time: 0.9577677249908447
Epoch: 42, Steps: 64 | Train Loss: 0.0748730 Vali Loss: 0.1401343 Test Loss: 0.1331768
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 43 cost time: 0.9477639198303223
Epoch: 43, Steps: 64 | Train Loss: 0.0747624 Vali Loss: 0.1409256 Test Loss: 0.1343303
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 44 cost time: 0.9360001087188721
Epoch: 44, Steps: 64 | Train Loss: 0.0744911 Vali Loss: 0.1410431 Test Loss: 0.1341519
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 45 cost time: 0.9240067005157471
Epoch: 45, Steps: 64 | Train Loss: 0.0746635 Vali Loss: 0.1422487 Test Loss: 0.1346218
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 46 cost time: 0.9166357517242432
Epoch: 46, Steps: 64 | Train Loss: 0.0743008 Vali Loss: 0.1403686 Test Loss: 0.1342732
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 47 cost time: 0.9214239120483398
Epoch: 47, Steps: 64 | Train Loss: 0.0747200 Vali Loss: 0.1416185 Test Loss: 0.1334291
EarlyStopping counter: 7 out of 100
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 48 cost time: 0.9273452758789062
Epoch: 48, Steps: 64 | Train Loss: 0.0744319 Vali Loss: 0.1402514 Test Loss: 0.1340246
EarlyStopping counter: 8 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 49 cost time: 0.9297881126403809
Epoch: 49, Steps: 64 | Train Loss: 0.0742553 Vali Loss: 0.1407747 Test Loss: 0.1344506
EarlyStopping counter: 9 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 50 cost time: 0.9254050254821777
Epoch: 50, Steps: 64 | Train Loss: 0.0743987 Vali Loss: 0.1404751 Test Loss: 0.1339900
EarlyStopping counter: 10 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 51 cost time: 0.9257662296295166
Epoch: 51, Steps: 64 | Train Loss: 0.0744423 Vali Loss: 0.1406736 Test Loss: 0.1338071
EarlyStopping counter: 11 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 52 cost time: 0.9354207515716553
Epoch: 52, Steps: 64 | Train Loss: 0.0743194 Vali Loss: 0.1397132 Test Loss: 0.1333728
EarlyStopping counter: 12 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 53 cost time: 0.9130003452301025
Epoch: 53, Steps: 64 | Train Loss: 0.0744289 Vali Loss: 0.1399427 Test Loss: 0.1336487
EarlyStopping counter: 13 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 54 cost time: 0.9136581420898438
Epoch: 54, Steps: 64 | Train Loss: 0.0745387 Vali Loss: 0.1407264 Test Loss: 0.1338978
EarlyStopping counter: 14 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 55 cost time: 0.9523715972900391
Epoch: 55, Steps: 64 | Train Loss: 0.0745669 Vali Loss: 0.1417316 Test Loss: 0.1336648
EarlyStopping counter: 15 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 56 cost time: 0.9303953647613525
Epoch: 56, Steps: 64 | Train Loss: 0.0747796 Vali Loss: 0.1401764 Test Loss: 0.1341630
EarlyStopping counter: 16 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 57 cost time: 0.9454059600830078
Epoch: 57, Steps: 64 | Train Loss: 0.0748784 Vali Loss: 0.1401266 Test Loss: 0.1339672
EarlyStopping counter: 17 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 58 cost time: 0.9525682926177979
Epoch: 58, Steps: 64 | Train Loss: 0.0745866 Vali Loss: 0.1410017 Test Loss: 0.1337792
EarlyStopping counter: 18 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 59 cost time: 0.950474739074707
Epoch: 59, Steps: 64 | Train Loss: 0.0748726 Vali Loss: 0.1409198 Test Loss: 0.1335631
EarlyStopping counter: 19 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.0204620361328125 GB
GPU已分配内存的峰值：0.0714559555053711 GB
Epoch: 60 cost time: 0.9502217769622803
Epoch: 60, Steps: 64 | Train Loss: 0.0747315 Vali Loss: 0.1408954 Test Loss: 0.1343075
EarlyStopping counter: 20 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_2_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.13343510031700134, mae:0.2597564160823822, rse:0.1944267451763153
Args in experiment:
Namespace(random_seed=2024, is_training=1, model_id='CityAh_336_96', model='PerioDformer', data='CityAh', root_path='./dataset/', data_path='CityAh.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, w=5, C=24, mlp_num=3, d_model2=32, d_ff2=128, experiment=2, dimension=16, percent=0, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=1, dec_in=7, c_out=7, d_model=32, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, itr=1, train_epochs=60, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
线性头的参数量为： 198148
>>>>>>>start training : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp2_dim16_0_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.0735483169555664 GB
Epoch: 1 cost time: 2.3799519538879395
Epoch: 1, Steps: 64 | Train Loss: 0.7497932 Vali Loss: 1.7296597 Test Loss: 3.2738433
Validation loss decreased (inf --> 1.729660).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 2 cost time: 0.9610409736633301
Epoch: 2, Steps: 64 | Train Loss: 0.2819256 Vali Loss: 0.2297033 Test Loss: 0.2787728
Validation loss decreased (1.729660 --> 0.229703).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 3 cost time: 0.9627358913421631
Epoch: 3, Steps: 64 | Train Loss: 0.0950908 Vali Loss: 0.1631014 Test Loss: 0.1394432
Validation loss decreased (0.229703 --> 0.163101).  Saving model ...
Updating learning rate to 0.0001
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 4 cost time: 0.9583864212036133
Epoch: 4, Steps: 64 | Train Loss: 0.0868562 Vali Loss: 0.1596040 Test Loss: 0.1407247
Validation loss decreased (0.163101 --> 0.159604).  Saving model ...
Updating learning rate to 9e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 5 cost time: 0.9467947483062744
Epoch: 5, Steps: 64 | Train Loss: 0.0841013 Vali Loss: 0.1560208 Test Loss: 0.1374204
Validation loss decreased (0.159604 --> 0.156021).  Saving model ...
Updating learning rate to 8.1e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 6 cost time: 0.9346415996551514
Epoch: 6, Steps: 64 | Train Loss: 0.0828649 Vali Loss: 0.1541592 Test Loss: 0.1372753
Validation loss decreased (0.156021 --> 0.154159).  Saving model ...
Updating learning rate to 7.290000000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 7 cost time: 0.9390017986297607
Epoch: 7, Steps: 64 | Train Loss: 0.0812192 Vali Loss: 0.1493150 Test Loss: 0.1344677
Validation loss decreased (0.154159 --> 0.149315).  Saving model ...
Updating learning rate to 6.561e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 8 cost time: 0.9706201553344727
Epoch: 8, Steps: 64 | Train Loss: 0.0801345 Vali Loss: 0.1503292 Test Loss: 0.1335885
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.904900000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 9 cost time: 0.9636380672454834
Epoch: 9, Steps: 64 | Train Loss: 0.0795616 Vali Loss: 0.1503240 Test Loss: 0.1365113
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.3144100000000005e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 10 cost time: 0.9892253875732422
Epoch: 10, Steps: 64 | Train Loss: 0.0786267 Vali Loss: 0.1497042 Test Loss: 0.1346409
EarlyStopping counter: 3 out of 100
Updating learning rate to 4.782969000000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 11 cost time: 0.9926619529724121
Epoch: 11, Steps: 64 | Train Loss: 0.0779062 Vali Loss: 0.1467315 Test Loss: 0.1346931
Validation loss decreased (0.149315 --> 0.146732).  Saving model ...
Updating learning rate to 4.304672100000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 12 cost time: 0.9783976078033447
Epoch: 12, Steps: 64 | Train Loss: 0.0777490 Vali Loss: 0.1471693 Test Loss: 0.1365695
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.874204890000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 13 cost time: 0.9714016914367676
Epoch: 13, Steps: 64 | Train Loss: 0.0770675 Vali Loss: 0.1466371 Test Loss: 0.1355812
Validation loss decreased (0.146732 --> 0.146637).  Saving model ...
Updating learning rate to 3.486784401000001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 14 cost time: 0.9680218696594238
Epoch: 14, Steps: 64 | Train Loss: 0.0766407 Vali Loss: 0.1437883 Test Loss: 0.1352852
Validation loss decreased (0.146637 --> 0.143788).  Saving model ...
Updating learning rate to 3.138105960900001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 15 cost time: 0.9504046440124512
Epoch: 15, Steps: 64 | Train Loss: 0.0759709 Vali Loss: 0.1442166 Test Loss: 0.1344335
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 16 cost time: 0.9693887233734131
Epoch: 16, Steps: 64 | Train Loss: 0.0760777 Vali Loss: 0.1441357 Test Loss: 0.1345296
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 17 cost time: 0.990410566329956
Epoch: 17, Steps: 64 | Train Loss: 0.0754257 Vali Loss: 0.1452990 Test Loss: 0.1339078
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 18 cost time: 0.9643943309783936
Epoch: 18, Steps: 64 | Train Loss: 0.0751376 Vali Loss: 0.1441374 Test Loss: 0.1350543
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 19 cost time: 0.9807536602020264
Epoch: 19, Steps: 64 | Train Loss: 0.0749153 Vali Loss: 0.1416975 Test Loss: 0.1336832
Validation loss decreased (0.143788 --> 0.141697).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 20 cost time: 0.970001220703125
Epoch: 20, Steps: 64 | Train Loss: 0.0745405 Vali Loss: 0.1422809 Test Loss: 0.1342551
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.6677181699666577e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 21 cost time: 0.9739975929260254
Epoch: 21, Steps: 64 | Train Loss: 0.0744913 Vali Loss: 0.1421833 Test Loss: 0.1340054
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.5009463529699919e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 22 cost time: 0.9416370391845703
Epoch: 22, Steps: 64 | Train Loss: 0.0739748 Vali Loss: 0.1413521 Test Loss: 0.1340888
Validation loss decreased (0.141697 --> 0.141352).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 23 cost time: 0.940422773361206
Epoch: 23, Steps: 64 | Train Loss: 0.0740280 Vali Loss: 0.1416949 Test Loss: 0.1326648
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 24 cost time: 0.9684662818908691
Epoch: 24, Steps: 64 | Train Loss: 0.0736367 Vali Loss: 0.1416195 Test Loss: 0.1341179
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 25 cost time: 0.9694550037384033
Epoch: 25, Steps: 64 | Train Loss: 0.0735198 Vali Loss: 0.1391445 Test Loss: 0.1327659
Validation loss decreased (0.141352 --> 0.139145).  Saving model ...
Updating learning rate to 9.847709021836118e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 26 cost time: 0.9660129547119141
Epoch: 26, Steps: 64 | Train Loss: 0.0734898 Vali Loss: 0.1397578 Test Loss: 0.1339973
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.862938119652508e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 27 cost time: 0.9703571796417236
Epoch: 27, Steps: 64 | Train Loss: 0.0733329 Vali Loss: 0.1395822 Test Loss: 0.1326846
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.976644307687255e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 28 cost time: 0.9594683647155762
Epoch: 28, Steps: 64 | Train Loss: 0.0732754 Vali Loss: 0.1418440 Test Loss: 0.1338646
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.178979876918531e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 29 cost time: 0.9794256687164307
Epoch: 29, Steps: 64 | Train Loss: 0.0729047 Vali Loss: 0.1397907 Test Loss: 0.1328549
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.4610818892266776e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 30 cost time: 0.9771022796630859
Epoch: 30, Steps: 64 | Train Loss: 0.0730175 Vali Loss: 0.1419865 Test Loss: 0.1344663
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.8149737003040096e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 31 cost time: 0.9638004302978516
Epoch: 31, Steps: 64 | Train Loss: 0.0727802 Vali Loss: 0.1391007 Test Loss: 0.1330937
Validation loss decreased (0.139145 --> 0.139101).  Saving model ...
Updating learning rate to 5.23347633027361e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 32 cost time: 0.9800019264221191
Epoch: 32, Steps: 64 | Train Loss: 0.0726980 Vali Loss: 0.1408713 Test Loss: 0.1337148
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 33 cost time: 0.9889984130859375
Epoch: 33, Steps: 64 | Train Loss: 0.0730084 Vali Loss: 0.1411314 Test Loss: 0.1346825
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 34 cost time: 0.9929571151733398
Epoch: 34, Steps: 64 | Train Loss: 0.0731130 Vali Loss: 0.1409395 Test Loss: 0.1331740
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 35 cost time: 0.9876325130462646
Epoch: 35, Steps: 64 | Train Loss: 0.0728219 Vali Loss: 0.1386232 Test Loss: 0.1322915
Validation loss decreased (0.139101 --> 0.138623).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 36 cost time: 0.9606404304504395
Epoch: 36, Steps: 64 | Train Loss: 0.0728147 Vali Loss: 0.1402871 Test Loss: 0.1329507
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.090315438263264e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 37 cost time: 0.9734563827514648
Epoch: 37, Steps: 64 | Train Loss: 0.0727696 Vali Loss: 0.1403213 Test Loss: 0.1337932
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7812838944369375e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 38 cost time: 0.9700696468353271
Epoch: 38, Steps: 64 | Train Loss: 0.0721441 Vali Loss: 0.1397231 Test Loss: 0.1326536
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.503155504993244e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 39 cost time: 0.9613373279571533
Epoch: 39, Steps: 64 | Train Loss: 0.0726799 Vali Loss: 0.1387996 Test Loss: 0.1337866
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.2528399544939195e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 40 cost time: 0.9873437881469727
Epoch: 40, Steps: 64 | Train Loss: 0.0727551 Vali Loss: 0.1398614 Test Loss: 0.1333901
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0275559590445276e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 41 cost time: 0.98838210105896
Epoch: 41, Steps: 64 | Train Loss: 0.0723893 Vali Loss: 0.1400334 Test Loss: 0.1328199
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8248003631400751e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 42 cost time: 0.9860889911651611
Epoch: 42, Steps: 64 | Train Loss: 0.0725987 Vali Loss: 0.1398439 Test Loss: 0.1332343
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6423203268260676e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 43 cost time: 0.9653785228729248
Epoch: 43, Steps: 64 | Train Loss: 0.0724865 Vali Loss: 0.1387260 Test Loss: 0.1326126
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4780882941434609e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 44 cost time: 0.9437358379364014
Epoch: 44, Steps: 64 | Train Loss: 0.0726934 Vali Loss: 0.1395219 Test Loss: 0.1330214
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3302794647291146e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 45 cost time: 0.9357867240905762
Epoch: 45, Steps: 64 | Train Loss: 0.0721883 Vali Loss: 0.1405612 Test Loss: 0.1336463
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1972515182562034e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 46 cost time: 0.9439995288848877
Epoch: 46, Steps: 64 | Train Loss: 0.0724816 Vali Loss: 0.1386851 Test Loss: 0.1322989
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.077526366430583e-06
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 47 cost time: 0.9536216259002686
Epoch: 47, Steps: 64 | Train Loss: 0.0724728 Vali Loss: 0.1384786 Test Loss: 0.1322702
Validation loss decreased (0.138623 --> 0.138479).  Saving model ...
Updating learning rate to 9.697737297875248e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 48 cost time: 0.9666447639465332
Epoch: 48, Steps: 64 | Train Loss: 0.0722585 Vali Loss: 0.1393781 Test Loss: 0.1329495
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 49 cost time: 0.9653449058532715
Epoch: 49, Steps: 64 | Train Loss: 0.0722425 Vali Loss: 0.1405541 Test Loss: 0.1330990
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 50 cost time: 0.9674510955810547
Epoch: 50, Steps: 64 | Train Loss: 0.0722063 Vali Loss: 0.1409567 Test Loss: 0.1332276
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 51 cost time: 0.9753949642181396
Epoch: 51, Steps: 64 | Train Loss: 0.0723964 Vali Loss: 0.1393481 Test Loss: 0.1336584
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 52 cost time: 0.9855482578277588
Epoch: 52, Steps: 64 | Train Loss: 0.0727318 Vali Loss: 0.1406133 Test Loss: 0.1335661
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 53 cost time: 0.9836232662200928
Epoch: 53, Steps: 64 | Train Loss: 0.0721709 Vali Loss: 0.1387311 Test Loss: 0.1332993
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 54 cost time: 0.9623997211456299
Epoch: 54, Steps: 64 | Train Loss: 0.0725459 Vali Loss: 0.1398901 Test Loss: 0.1329208
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 55 cost time: 0.9764764308929443
Epoch: 55, Steps: 64 | Train Loss: 0.0722329 Vali Loss: 0.1395387 Test Loss: 0.1328237
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 56 cost time: 0.9864981174468994
Epoch: 56, Steps: 64 | Train Loss: 0.0723419 Vali Loss: 0.1400377 Test Loss: 0.1333658
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 57 cost time: 0.9967520236968994
Epoch: 57, Steps: 64 | Train Loss: 0.0724801 Vali Loss: 0.1399794 Test Loss: 0.1325044
EarlyStopping counter: 10 out of 100
Updating learning rate to 3.381391913522731e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 58 cost time: 0.9785704612731934
Epoch: 58, Steps: 64 | Train Loss: 0.0720887 Vali Loss: 0.1402533 Test Loss: 0.1339667
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.043252722170458e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 59 cost time: 0.9623329639434814
Epoch: 59, Steps: 64 | Train Loss: 0.0720975 Vali Loss: 0.1393637 Test Loss: 0.1325525
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.7389274499534124e-07
0
Training with all the variates.
当前GPU已分配内存：0.02144622802734375 GB
GPU已分配内存的峰值：0.07658958435058594 GB
Epoch: 60 cost time: 0.9710016250610352
Epoch: 60, Steps: 64 | Train Loss: 0.0721005 Vali Loss: 0.1399711 Test Loss: 0.1328649
EarlyStopping counter: 13 out of 100
Updating learning rate to 2.465034704958071e-07
>>>>>>>testing : CityAh_336_96_PerioDformer_CityAh_ftS_sl336_ll48_pl96_dm32_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_5_24_3_32_128__exp2_dim16_0_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test-mse:0.1322701871395111, mae:0.2613939940929413, rse:0.19357620179653168
